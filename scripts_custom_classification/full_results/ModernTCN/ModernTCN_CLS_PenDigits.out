Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0694605
	speed: 0.1057s/iter; left time: 2468.4018s
	iters: 200, epoch: 1 | loss: 0.3856060
	speed: 0.0828s/iter; left time: 1926.0600s
	iters: 300, epoch: 1 | loss: 0.0886914
	speed: 0.0780s/iter; left time: 1805.1412s
	iters: 400, epoch: 1 | loss: 0.1322533
	speed: 0.0836s/iter; left time: 1926.6989s
Epoch: 1 cost time: 40.670809745788574
Epoch: 1, Steps: 469 | Train Loss: 0.599 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (inf --> -0.959118).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0797530
	speed: 0.4288s/iter; left time: 9812.6656s
	iters: 200, epoch: 2 | loss: 0.1131181
	speed: 0.0775s/iter; left time: 1765.2385s
	iters: 300, epoch: 2 | loss: 0.1616549
	speed: 0.0733s/iter; left time: 1662.8658s
	iters: 400, epoch: 2 | loss: 0.0307927
	speed: 0.0827s/iter; left time: 1866.4471s
Epoch: 2 cost time: 37.683250188827515
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1893787
	speed: 0.4322s/iter; left time: 9685.8993s
	iters: 200, epoch: 3 | loss: 0.0037442
	speed: 0.0716s/iter; left time: 1598.4312s
	iters: 300, epoch: 3 | loss: 0.0149188
	speed: 0.0780s/iter; left time: 1733.2104s
	iters: 400, epoch: 3 | loss: 0.0028646
	speed: 0.0810s/iter; left time: 1790.7816s
Epoch: 3 cost time: 36.79432702064514
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0770245
	speed: 0.4422s/iter; left time: 9704.2967s
	iters: 200, epoch: 4 | loss: 0.0229463
	speed: 0.0750s/iter; left time: 1638.1334s
	iters: 300, epoch: 4 | loss: 0.0222846
	speed: 0.0738s/iter; left time: 1605.0913s
	iters: 400, epoch: 4 | loss: 0.0068284
	speed: 0.0739s/iter; left time: 1600.0582s
Epoch: 4 cost time: 36.07523012161255
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.959118 --> -0.975985).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0477215
	speed: 0.4057s/iter; left time: 8713.4518s
	iters: 200, epoch: 5 | loss: 0.0012174
	speed: 0.0739s/iter; left time: 1579.1693s
	iters: 300, epoch: 5 | loss: 0.0009004
	speed: 0.0745s/iter; left time: 1585.6040s
	iters: 400, epoch: 5 | loss: 0.0003241
	speed: 0.0784s/iter; left time: 1659.2976s
Epoch: 5 cost time: 36.3998920917511
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1070885
	speed: 0.4028s/iter; left time: 8461.8398s
	iters: 200, epoch: 6 | loss: 0.0019826
	speed: 0.0710s/iter; left time: 1484.0557s
	iters: 300, epoch: 6 | loss: 0.0003831
	speed: 0.0674s/iter; left time: 1401.7876s
	iters: 400, epoch: 6 | loss: 0.0771377
	speed: 0.0682s/iter; left time: 1412.0956s
Epoch: 6 cost time: 33.180745363235474
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0035624
	speed: 0.3891s/iter; left time: 7990.4689s
	iters: 200, epoch: 7 | loss: 0.0088372
	speed: 0.0968s/iter; left time: 1979.2969s
	iters: 300, epoch: 7 | loss: 0.0532949
	speed: 0.1003s/iter; left time: 2039.1562s
	iters: 400, epoch: 7 | loss: 0.0035139
	speed: 0.1042s/iter; left time: 2109.2232s
Epoch: 7 cost time: 45.42432641983032
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0004354
	speed: 0.5660s/iter; left time: 11358.9296s
	iters: 200, epoch: 8 | loss: 0.0014585
	speed: 0.1015s/iter; left time: 2026.3229s
	iters: 300, epoch: 8 | loss: 0.0023956
	speed: 0.1037s/iter; left time: 2060.3255s
	iters: 400, epoch: 8 | loss: 0.0011415
	speed: 0.0928s/iter; left time: 1835.2249s
Epoch: 8 cost time: 48.16861033439636
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0087170
	speed: 0.5535s/iter; left time: 10847.6667s
	iters: 200, epoch: 9 | loss: 0.0153089
	speed: 0.0845s/iter; left time: 1648.4142s
	iters: 300, epoch: 9 | loss: 0.4479248
	speed: 0.0947s/iter; left time: 1837.9567s
	iters: 400, epoch: 9 | loss: 0.0007127
	speed: 0.0812s/iter; left time: 1567.6045s
Epoch: 9 cost time: 41.64557456970215
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.192 Vali Acc: 0.965 Test Loss: 0.192 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000072
	speed: 0.4915s/iter; left time: 9402.1150s
	iters: 200, epoch: 10 | loss: 0.0000040
	speed: 0.0896s/iter; left time: 1705.0539s
	iters: 300, epoch: 10 | loss: 0.0001978
	speed: 0.0881s/iter; left time: 1667.3869s
	iters: 400, epoch: 10 | loss: 0.0009681
	speed: 0.0931s/iter; left time: 1753.6810s
Epoch: 10 cost time: 42.711005449295044
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976557).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1159350
	speed: 0.5167s/iter; left time: 9642.7223s
	iters: 200, epoch: 11 | loss: 0.0133096
	speed: 0.0879s/iter; left time: 1631.2308s
	iters: 300, epoch: 11 | loss: 0.1141150
	speed: 0.0873s/iter; left time: 1611.2322s
	iters: 400, epoch: 11 | loss: 0.0002613
	speed: 0.0891s/iter; left time: 1636.1219s
Epoch: 11 cost time: 42.33909845352173
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001396
	speed: 0.4859s/iter; left time: 8840.3713s
	iters: 200, epoch: 12 | loss: 0.0450573
	speed: 0.0849s/iter; left time: 1535.4256s
	iters: 300, epoch: 12 | loss: 0.0000218
	speed: 0.0851s/iter; left time: 1530.7834s
	iters: 400, epoch: 12 | loss: 0.0000099
	speed: 0.0794s/iter; left time: 1421.2452s
Epoch: 12 cost time: 40.05031228065491
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.970 Test Loss: 0.238 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0002802
	speed: 0.4988s/iter; left time: 8840.5083s
	iters: 200, epoch: 13 | loss: 0.0613220
	speed: 0.0901s/iter; left time: 1587.6899s
	iters: 300, epoch: 13 | loss: 0.0018547
	speed: 0.0977s/iter; left time: 1712.1611s
	iters: 400, epoch: 13 | loss: 0.0003752
	speed: 0.0962s/iter; left time: 1675.9576s
Epoch: 13 cost time: 45.58639478683472
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.979 Test Loss: 0.144 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.978844).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0071205
	speed: 0.5830s/iter; left time: 10059.6793s
	iters: 200, epoch: 14 | loss: 0.0001163
	speed: 0.0897s/iter; left time: 1539.2658s
	iters: 300, epoch: 14 | loss: 0.0001425
	speed: 0.1012s/iter; left time: 1726.4346s
	iters: 400, epoch: 14 | loss: 0.0036683
	speed: 0.1045s/iter; left time: 1772.5162s
Epoch: 14 cost time: 47.25424146652222
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.254 Vali Acc: 0.972 Test Loss: 0.254 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0005176
	speed: 0.5516s/iter; left time: 9258.5413s
	iters: 200, epoch: 15 | loss: 0.0000154
	speed: 0.0980s/iter; left time: 1635.4086s
	iters: 300, epoch: 15 | loss: 0.0973808
	speed: 0.1014s/iter; left time: 1681.2232s
	iters: 400, epoch: 15 | loss: 0.0279719
	speed: 0.1112s/iter; left time: 1832.8451s
Epoch: 15 cost time: 49.12265181541443
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0004390
	speed: 0.5553s/iter; left time: 9060.9822s
	iters: 200, epoch: 16 | loss: 0.0323850
	speed: 0.0893s/iter; left time: 1448.6008s
	iters: 300, epoch: 16 | loss: 0.0008194
	speed: 0.0921s/iter; left time: 1484.3310s
	iters: 400, epoch: 16 | loss: 0.0008214
	speed: 0.0989s/iter; left time: 1583.8205s
Epoch: 16 cost time: 44.45996809005737
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.972 Test Loss: 0.227 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0189547
	speed: 0.5534s/iter; left time: 8770.3369s
	iters: 200, epoch: 17 | loss: 0.0044157
	speed: 0.1025s/iter; left time: 1613.6548s
	iters: 300, epoch: 17 | loss: 0.0000476
	speed: 0.0978s/iter; left time: 1530.6827s
	iters: 400, epoch: 17 | loss: 0.0005946
	speed: 0.1069s/iter; left time: 1661.9926s
Epoch: 17 cost time: 49.35852360725403
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0002423
	speed: 0.5621s/iter; left time: 8643.5173s
	iters: 200, epoch: 18 | loss: 0.0584512
	speed: 0.0996s/iter; left time: 1521.9765s
	iters: 300, epoch: 18 | loss: 0.0012556
	speed: 0.0934s/iter; left time: 1417.6765s
	iters: 400, epoch: 18 | loss: 0.0036331
	speed: 0.0990s/iter; left time: 1492.0598s
Epoch: 18 cost time: 45.461920738220215
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979701).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0509887
	speed: 0.5205s/iter; left time: 7759.6547s
	iters: 200, epoch: 19 | loss: 0.0000158
	speed: 0.0950s/iter; left time: 1406.8604s
	iters: 300, epoch: 19 | loss: 0.0000128
	speed: 0.0930s/iter; left time: 1367.6047s
	iters: 400, epoch: 19 | loss: 0.0000343
	speed: 0.0959s/iter; left time: 1400.8493s
Epoch: 19 cost time: 45.43995213508606
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0002664
	speed: 0.5287s/iter; left time: 7634.9123s
	iters: 200, epoch: 20 | loss: 0.0001061
	speed: 0.0896s/iter; left time: 1284.9144s
	iters: 300, epoch: 20 | loss: 0.0122635
	speed: 0.1002s/iter; left time: 1427.0825s
	iters: 400, epoch: 20 | loss: 0.0002814
	speed: 0.0929s/iter; left time: 1313.5192s
Epoch: 20 cost time: 44.44023895263672
Epoch: 20, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000378
	speed: 0.5439s/iter; left time: 7598.6178s
	iters: 200, epoch: 21 | loss: 0.0000364
	speed: 0.0976s/iter; left time: 1353.1657s
	iters: 300, epoch: 21 | loss: 0.0000147
	speed: 0.0992s/iter; left time: 1366.3032s
	iters: 400, epoch: 21 | loss: 0.0000052
	speed: 0.0963s/iter; left time: 1316.0040s
Epoch: 21 cost time: 45.65295481681824
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0006895
	speed: 0.5178s/iter; left time: 6991.1478s
	iters: 200, epoch: 22 | loss: 0.1336914
	speed: 0.0978s/iter; left time: 1311.1312s
	iters: 300, epoch: 22 | loss: 0.0000017
	speed: 0.1011s/iter; left time: 1344.3372s
	iters: 400, epoch: 22 | loss: 0.0000016
	speed: 0.0995s/iter; left time: 1314.1816s
Epoch: 22 cost time: 45.49939155578613
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0003276
	speed: 0.5134s/iter; left time: 6690.7108s
	iters: 200, epoch: 23 | loss: 0.0003322
	speed: 0.0975s/iter; left time: 1261.1373s
	iters: 300, epoch: 23 | loss: 0.0001069
	speed: 0.0940s/iter; left time: 1206.4655s
	iters: 400, epoch: 23 | loss: 0.0000735
	speed: 0.1057s/iter; left time: 1345.8242s
Epoch: 23 cost time: 45.83946943283081
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.985 Test Loss: 0.132 Test Acc: 0.985
Validation loss decreased (-0.979701 --> -0.984561).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0012538
	speed: 0.5278s/iter; left time: 6631.5910s
	iters: 200, epoch: 24 | loss: 0.3250104
	speed: 0.0974s/iter; left time: 1213.7345s
	iters: 300, epoch: 24 | loss: 0.0757843
	speed: 0.1033s/iter; left time: 1277.3213s
	iters: 400, epoch: 24 | loss: 0.0000013
	speed: 0.0941s/iter; left time: 1154.3983s
Epoch: 24 cost time: 45.722203969955444
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.981 Test Loss: 0.187 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000774
	speed: 0.5536s/iter; left time: 6695.7011s
	iters: 200, epoch: 25 | loss: 0.0000057
	speed: 0.1022s/iter; left time: 1225.4797s
	iters: 300, epoch: 25 | loss: 0.0012277
	speed: 0.1052s/iter; left time: 1251.3598s
	iters: 400, epoch: 25 | loss: 0.0039723
	speed: 0.1032s/iter; left time: 1216.8778s
Epoch: 25 cost time: 48.32011270523071
Epoch: 25, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000255
	speed: 0.5191s/iter; left time: 6035.1334s
	iters: 200, epoch: 26 | loss: 0.0000092
	speed: 0.0842s/iter; left time: 970.6582s
	iters: 300, epoch: 26 | loss: 0.0636686
	speed: 0.0953s/iter; left time: 1088.3305s
	iters: 400, epoch: 26 | loss: 0.0000206
	speed: 0.0939s/iter; left time: 1063.0629s
Epoch: 26 cost time: 43.98470854759216
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.969 Test Loss: 0.205 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.1242925
	speed: 0.5505s/iter; left time: 6141.8378s
	iters: 200, epoch: 27 | loss: 0.0003543
	speed: 0.1035s/iter; left time: 1144.4917s
	iters: 300, epoch: 27 | loss: 0.0000202
	speed: 0.1002s/iter; left time: 1098.3019s
	iters: 400, epoch: 27 | loss: 0.0002439
	speed: 0.0986s/iter; left time: 1070.9180s
Epoch: 27 cost time: 47.38703012466431
Epoch: 27, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000791
	speed: 0.5350s/iter; left time: 5718.5378s
	iters: 200, epoch: 28 | loss: 0.3520238
	speed: 0.0834s/iter; left time: 883.4793s
	iters: 300, epoch: 28 | loss: 0.0018689
	speed: 0.0916s/iter; left time: 961.0086s
	iters: 400, epoch: 28 | loss: 0.0003926
	speed: 0.0934s/iter; left time: 970.5860s
Epoch: 28 cost time: 42.84521532058716
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000018
	speed: 0.5609s/iter; left time: 5732.3014s
	iters: 200, epoch: 29 | loss: 0.0000024
	speed: 0.0970s/iter; left time: 981.8537s
	iters: 300, epoch: 29 | loss: 0.0000962
	speed: 0.0980s/iter; left time: 981.7027s
	iters: 400, epoch: 29 | loss: 0.0000041
	speed: 0.0962s/iter; left time: 954.6963s
Epoch: 29 cost time: 46.38569188117981
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0003875
	speed: 0.5289s/iter; left time: 5156.8265s
	iters: 200, epoch: 30 | loss: 0.0000358
	speed: 0.0938s/iter; left time: 905.1180s
	iters: 300, epoch: 30 | loss: 0.0000001
	speed: 0.1000s/iter; left time: 954.9727s
	iters: 400, epoch: 30 | loss: 0.0000277
	speed: 0.1051s/iter; left time: 993.3670s
Epoch: 30 cost time: 47.603919506073
Epoch: 30, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.979 Test Loss: 0.159 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0001065
	speed: 0.4796s/iter; left time: 4450.7766s
	iters: 200, epoch: 31 | loss: 0.0000161
	speed: 0.0887s/iter; left time: 814.6571s
	iters: 300, epoch: 31 | loss: 0.0143558
	speed: 0.0812s/iter; left time: 737.2024s
	iters: 400, epoch: 31 | loss: 0.0000741
	speed: 0.0799s/iter; left time: 717.1483s
Epoch: 31 cost time: 38.95790696144104
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000098
	speed: 0.4509s/iter; left time: 3973.2120s
	iters: 200, epoch: 32 | loss: 0.0000921
	speed: 0.0742s/iter; left time: 646.0342s
	iters: 300, epoch: 32 | loss: 0.0000072
	speed: 0.0739s/iter; left time: 636.4104s
	iters: 400, epoch: 32 | loss: 0.0053963
	speed: 0.0789s/iter; left time: 671.8122s
Epoch: 32 cost time: 37.08134722709656
Epoch: 32, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.273 Vali Acc: 0.969 Test Loss: 0.273 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000036
	speed: 0.4600s/iter; left time: 3838.1151s
	iters: 200, epoch: 33 | loss: 0.0052077
	speed: 0.0816s/iter; left time: 672.8531s
	iters: 300, epoch: 33 | loss: 0.0000108
	speed: 0.0858s/iter; left time: 698.2700s
	iters: 400, epoch: 33 | loss: 0.0000313
	speed: 0.0852s/iter; left time: 685.6648s
Epoch: 33 cost time: 40.09001159667969
Epoch: 33, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.241 Vali Acc: 0.968 Test Loss: 0.241 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 392138
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8328063
	speed: 0.1049s/iter; left time: 2450.4042s
	iters: 200, epoch: 1 | loss: 0.1540310
	speed: 0.0742s/iter; left time: 1725.8688s
	iters: 300, epoch: 1 | loss: 0.0680586
	speed: 0.0797s/iter; left time: 1845.1905s
	iters: 400, epoch: 1 | loss: 0.0336749
	speed: 0.0844s/iter; left time: 1944.7420s
Epoch: 1 cost time: 40.09886646270752
Epoch: 1, Steps: 469 | Train Loss: 0.578 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
Validation loss decreased (inf --> -0.954830).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1242787
	speed: 0.4902s/iter; left time: 11217.0577s
	iters: 200, epoch: 2 | loss: 0.0085886
	speed: 0.0819s/iter; left time: 1864.7826s
	iters: 300, epoch: 2 | loss: 0.0776634
	speed: 0.0827s/iter; left time: 1876.5920s
	iters: 400, epoch: 2 | loss: 0.0475384
	speed: 0.0857s/iter; left time: 1934.9380s
Epoch: 2 cost time: 40.096471548080444
Epoch: 2, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.954830 --> -0.955973).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0018751
	speed: 0.5225s/iter; left time: 11711.3418s
	iters: 200, epoch: 3 | loss: 0.0069283
	speed: 0.0878s/iter; left time: 1959.9833s
	iters: 300, epoch: 3 | loss: 0.1726885
	speed: 0.0813s/iter; left time: 1806.1306s
	iters: 400, epoch: 3 | loss: 0.0089788
	speed: 0.0741s/iter; left time: 1638.8961s
Epoch: 3 cost time: 39.45475506782532
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.215 Vali Acc: 0.955 Test Loss: 0.215 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0685275
	speed: 0.4739s/iter; left time: 10399.0113s
	iters: 200, epoch: 4 | loss: 0.0023137
	speed: 0.0950s/iter; left time: 2076.2483s
	iters: 300, epoch: 4 | loss: 0.0273401
	speed: 0.0769s/iter; left time: 1671.1486s
	iters: 400, epoch: 4 | loss: 0.0089039
	speed: 0.0873s/iter; left time: 1888.8878s
Epoch: 4 cost time: 40.566718339920044
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
Validation loss decreased (-0.955973 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0030749
	speed: 0.5162s/iter; left time: 11084.6178s
	iters: 200, epoch: 5 | loss: 0.0046324
	speed: 0.0876s/iter; left time: 1872.0125s
	iters: 300, epoch: 5 | loss: 0.0407743
	speed: 0.0889s/iter; left time: 1890.8228s
	iters: 400, epoch: 5 | loss: 0.0008898
	speed: 0.0878s/iter; left time: 1859.1125s
Epoch: 5 cost time: 42.591681480407715
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.165 Vali Acc: 0.966 Test Loss: 0.165 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0006600
	speed: 0.5310s/iter; left time: 11153.3623s
	iters: 200, epoch: 6 | loss: 0.0024891
	speed: 0.0937s/iter; left time: 1959.8604s
	iters: 300, epoch: 6 | loss: 0.0017578
	speed: 0.0911s/iter; left time: 1894.8624s
	iters: 400, epoch: 6 | loss: 0.0004230
	speed: 0.0942s/iter; left time: 1951.2258s
Epoch: 6 cost time: 43.71621632575989
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
Validation loss decreased (-0.971983 --> -0.974270).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002019
	speed: 0.5255s/iter; left time: 10792.5213s
	iters: 200, epoch: 7 | loss: 0.0004480
	speed: 0.0884s/iter; left time: 1806.5399s
	iters: 300, epoch: 7 | loss: 0.1205972
	speed: 0.0797s/iter; left time: 1621.0566s
	iters: 400, epoch: 7 | loss: 0.0001067
	speed: 0.0901s/iter; left time: 1823.1078s
Epoch: 7 cost time: 42.216469287872314
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.971 Test Loss: 0.191 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0003590
	speed: 0.5420s/iter; left time: 10876.4287s
	iters: 200, epoch: 8 | loss: 0.0068528
	speed: 0.1141s/iter; left time: 2278.8483s
	iters: 300, epoch: 8 | loss: 0.0000061
	speed: 0.1073s/iter; left time: 2132.7151s
	iters: 400, epoch: 8 | loss: 0.0000919
	speed: 0.0892s/iter; left time: 1764.1139s
Epoch: 8 cost time: 47.8399338722229
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.971 Test Loss: 0.226 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0063083
	speed: 0.5393s/iter; left time: 10569.2703s
	iters: 200, epoch: 9 | loss: 0.0026562
	speed: 0.1019s/iter; left time: 1987.7168s
	iters: 300, epoch: 9 | loss: 0.0011743
	speed: 0.0986s/iter; left time: 1912.1262s
	iters: 400, epoch: 9 | loss: 0.0000719
	speed: 0.0986s/iter; left time: 1902.9857s
Epoch: 9 cost time: 45.502450466156006
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0068793
	speed: 0.5233s/iter; left time: 10010.1684s
	iters: 200, epoch: 10 | loss: 0.0008537
	speed: 0.0917s/iter; left time: 1745.9504s
	iters: 300, epoch: 10 | loss: 0.0136276
	speed: 0.0983s/iter; left time: 1860.1323s
	iters: 400, epoch: 10 | loss: 0.0003692
	speed: 0.0897s/iter; left time: 1688.7417s
Epoch: 10 cost time: 44.69773292541504
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.270 Vali Acc: 0.960 Test Loss: 0.270 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000039
	speed: 0.5137s/iter; left time: 9585.5638s
	iters: 200, epoch: 11 | loss: 0.0005217
	speed: 0.0892s/iter; left time: 1655.6065s
	iters: 300, epoch: 11 | loss: 0.0380189
	speed: 0.0910s/iter; left time: 1679.0747s
	iters: 400, epoch: 11 | loss: 0.0002660
	speed: 0.0910s/iter; left time: 1670.6378s
Epoch: 11 cost time: 42.46692609786987
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.967 Test Loss: 0.225 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0003366
	speed: 0.5480s/iter; left time: 9969.4037s
	iters: 200, epoch: 12 | loss: 0.0006145
	speed: 0.0915s/iter; left time: 1654.6143s
	iters: 300, epoch: 12 | loss: 0.0000119
	speed: 0.0808s/iter; left time: 1454.5533s
	iters: 400, epoch: 12 | loss: 0.0501715
	speed: 0.0881s/iter; left time: 1575.6465s
Epoch: 12 cost time: 42.949947357177734
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.237 Vali Acc: 0.970 Test Loss: 0.237 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0010763
	speed: 0.5363s/iter; left time: 9504.0218s
	iters: 200, epoch: 13 | loss: 0.0847922
	speed: 0.0866s/iter; left time: 1526.1340s
	iters: 300, epoch: 13 | loss: 0.0000056
	speed: 0.0818s/iter; left time: 1433.0331s
	iters: 400, epoch: 13 | loss: 0.0032928
	speed: 0.0924s/iter; left time: 1609.9910s
Epoch: 13 cost time: 43.79326558113098
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0468847
	speed: 0.5277s/iter; left time: 9104.8007s
	iters: 200, epoch: 14 | loss: 0.0001638
	speed: 0.0926s/iter; left time: 1588.3849s
	iters: 300, epoch: 14 | loss: 0.4533750
	speed: 0.0891s/iter; left time: 1520.1288s
	iters: 400, epoch: 14 | loss: 0.0000386
	speed: 0.0870s/iter; left time: 1474.1944s
Epoch: 14 cost time: 42.193422079086304
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0146294
	speed: 0.5183s/iter; left time: 8700.4044s
	iters: 200, epoch: 15 | loss: 0.0001113
	speed: 0.1070s/iter; left time: 1785.1837s
	iters: 300, epoch: 15 | loss: 0.0010948
	speed: 0.1014s/iter; left time: 1681.4850s
	iters: 400, epoch: 15 | loss: 0.0073067
	speed: 0.1033s/iter; left time: 1702.7860s
Epoch: 15 cost time: 47.99375867843628
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.280 Vali Acc: 0.970 Test Loss: 0.280 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0038764
	speed: 0.5515s/iter; left time: 8997.6238s
	iters: 200, epoch: 16 | loss: 0.0001061
	speed: 0.1022s/iter; left time: 1656.6638s
	iters: 300, epoch: 16 | loss: 0.0013124
	speed: 0.1041s/iter; left time: 1678.3325s
	iters: 400, epoch: 16 | loss: 0.0029723
	speed: 0.0874s/iter; left time: 1399.8202s
Epoch: 16 cost time: 46.786277532577515
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.269 Vali Acc: 0.970 Test Loss: 0.269 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9742710120068611
model parameter : 392170
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9145257
	speed: 0.1250s/iter; left time: 2917.8301s
	iters: 200, epoch: 1 | loss: 0.4604968
	speed: 0.0858s/iter; left time: 1994.0852s
	iters: 300, epoch: 1 | loss: 0.3339323
	speed: 0.0995s/iter; left time: 2303.8593s
	iters: 400, epoch: 1 | loss: 0.0419642
	speed: 0.0973s/iter; left time: 2243.1949s
Epoch: 1 cost time: 48.05221724510193
Epoch: 1, Steps: 469 | Train Loss: 0.608 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (inf --> -0.940535).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1095410
	speed: 0.5700s/iter; left time: 13042.9714s
	iters: 200, epoch: 2 | loss: 0.0652260
	speed: 0.1106s/iter; left time: 2520.7875s
	iters: 300, epoch: 2 | loss: 0.1279347
	speed: 0.0978s/iter; left time: 2217.4005s
	iters: 400, epoch: 2 | loss: 0.0347218
	speed: 0.0944s/iter; left time: 2132.4451s
Epoch: 2 cost time: 48.2904908657074
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.940535 --> -0.962263).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0003919
	speed: 0.5402s/iter; left time: 12106.6632s
	iters: 200, epoch: 3 | loss: 0.0185063
	speed: 0.0788s/iter; left time: 1757.3348s
	iters: 300, epoch: 3 | loss: 0.2902445
	speed: 0.0738s/iter; left time: 1638.2450s
	iters: 400, epoch: 3 | loss: 0.0022031
	speed: 0.0794s/iter; left time: 1755.9193s
Epoch: 3 cost time: 40.841594219207764
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.962263 --> -0.966837).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0252406
	speed: 0.5759s/iter; left time: 12637.9498s
	iters: 200, epoch: 4 | loss: 0.0025452
	speed: 0.0954s/iter; left time: 2084.5273s
	iters: 300, epoch: 4 | loss: 0.0654127
	speed: 0.1024s/iter; left time: 2226.1710s
	iters: 400, epoch: 4 | loss: 0.0013929
	speed: 0.0949s/iter; left time: 2054.8972s
Epoch: 4 cost time: 47.73319125175476
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0012995
	speed: 0.5860s/iter; left time: 12583.3862s
	iters: 200, epoch: 5 | loss: 0.0257646
	speed: 0.0932s/iter; left time: 1992.3144s
	iters: 300, epoch: 5 | loss: 0.0847821
	speed: 0.1047s/iter; left time: 2226.9969s
	iters: 400, epoch: 5 | loss: 0.0036521
	speed: 0.1046s/iter; left time: 2215.3549s
Epoch: 5 cost time: 47.47908902168274
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0180106
	speed: 0.5665s/iter; left time: 11900.4092s
	iters: 200, epoch: 6 | loss: 0.0005806
	speed: 0.1070s/iter; left time: 2237.3333s
	iters: 300, epoch: 6 | loss: 0.0091382
	speed: 0.1098s/iter; left time: 2285.3919s
	iters: 400, epoch: 6 | loss: 0.0027511
	speed: 0.1057s/iter; left time: 2188.0934s
Epoch: 6 cost time: 51.36998534202576
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.966837 --> -0.975985).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000828
	speed: 0.5762s/iter; left time: 11834.1447s
	iters: 200, epoch: 7 | loss: 0.0042074
	speed: 0.1093s/iter; left time: 2233.7826s
	iters: 300, epoch: 7 | loss: 0.0079406
	speed: 0.0991s/iter; left time: 2014.7970s
	iters: 400, epoch: 7 | loss: 0.0005581
	speed: 0.1020s/iter; left time: 2063.3949s
Epoch: 7 cost time: 48.58651280403137
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0018548
	speed: 0.5872s/iter; left time: 11783.0055s
	iters: 200, epoch: 8 | loss: 0.0004249
	speed: 0.1032s/iter; left time: 2061.3860s
	iters: 300, epoch: 8 | loss: 0.0030718
	speed: 0.1120s/iter; left time: 2224.4267s
	iters: 400, epoch: 8 | loss: 0.0053507
	speed: 0.1148s/iter; left time: 2269.9494s
Epoch: 8 cost time: 52.121153831481934
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.961 Test Loss: 0.208 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0103015
	speed: 0.5891s/iter; left time: 11546.3314s
	iters: 200, epoch: 9 | loss: 0.0010052
	speed: 0.0910s/iter; left time: 1774.6432s
	iters: 300, epoch: 9 | loss: 0.0000147
	speed: 0.0772s/iter; left time: 1497.6491s
	iters: 400, epoch: 9 | loss: 0.0000934
	speed: 0.0846s/iter; left time: 1632.4998s
Epoch: 9 cost time: 42.8294723033905
Epoch: 9, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.210 Vali Acc: 0.961 Test Loss: 0.210 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0461591
	speed: 0.5778s/iter; left time: 11054.1285s
	iters: 200, epoch: 10 | loss: 0.0364297
	speed: 0.0983s/iter; left time: 1871.1473s
	iters: 300, epoch: 10 | loss: 0.0199634
	speed: 0.0976s/iter; left time: 1848.4362s
	iters: 400, epoch: 10 | loss: 0.0001041
	speed: 0.0929s/iter; left time: 1749.3149s
Epoch: 10 cost time: 46.9094455242157
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.300 Vali Acc: 0.963 Test Loss: 0.300 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0192688
	speed: 0.5431s/iter; left time: 10134.0662s
	iters: 200, epoch: 11 | loss: 0.0002100
	speed: 0.0996s/iter; left time: 1849.2420s
	iters: 300, epoch: 11 | loss: 0.0000722
	speed: 0.0958s/iter; left time: 1769.4743s
	iters: 400, epoch: 11 | loss: 0.0064965
	speed: 0.0931s/iter; left time: 1710.0676s
Epoch: 11 cost time: 46.03661561012268
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000345
	speed: 0.5199s/iter; left time: 9458.1179s
	iters: 200, epoch: 12 | loss: 0.0001184
	speed: 0.1049s/iter; left time: 1897.6821s
	iters: 300, epoch: 12 | loss: 0.0002711
	speed: 0.0917s/iter; left time: 1649.4471s
	iters: 400, epoch: 12 | loss: 0.0124300
	speed: 0.1037s/iter; left time: 1854.8157s
Epoch: 12 cost time: 47.50513219833374
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.965 Test Loss: 0.237 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.2075273
	speed: 0.5639s/iter; left time: 9993.4721s
	iters: 200, epoch: 13 | loss: 0.0002005
	speed: 0.0991s/iter; left time: 1745.9908s
	iters: 300, epoch: 13 | loss: 0.0056636
	speed: 0.1016s/iter; left time: 1780.1586s
	iters: 400, epoch: 13 | loss: 0.0000335
	speed: 0.1010s/iter; left time: 1760.0856s
Epoch: 13 cost time: 47.81967639923096
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.259 Vali Acc: 0.968 Test Loss: 0.259 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000365
	speed: 0.5157s/iter; left time: 8897.7709s
	iters: 200, epoch: 14 | loss: 0.0762275
	speed: 0.0917s/iter; left time: 1572.4587s
	iters: 300, epoch: 14 | loss: 0.1390016
	speed: 0.1014s/iter; left time: 1729.5422s
	iters: 400, epoch: 14 | loss: 0.0015121
	speed: 0.0950s/iter; left time: 1610.8330s
Epoch: 14 cost time: 44.43345022201538
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000212
	speed: 0.5395s/iter; left time: 9055.6841s
	iters: 200, epoch: 15 | loss: 0.0000200
	speed: 0.0976s/iter; left time: 1628.9137s
	iters: 300, epoch: 15 | loss: 0.0000382
	speed: 0.1018s/iter; left time: 1687.5737s
	iters: 400, epoch: 15 | loss: 0.0000155
	speed: 0.0972s/iter; left time: 1602.8936s
Epoch: 15 cost time: 46.77917742729187
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0005332
	speed: 0.5390s/iter; left time: 8795.0741s
	iters: 200, epoch: 16 | loss: 0.0002511
	speed: 0.0779s/iter; left time: 1262.9127s
	iters: 300, epoch: 16 | loss: 0.0000491
	speed: 0.0831s/iter; left time: 1338.7680s
	iters: 400, epoch: 16 | loss: 0.0018913
	speed: 0.0989s/iter; left time: 1583.7004s
Epoch: 16 cost time: 42.371623277664185
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 390346
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1672084
	speed: 0.1307s/iter; left time: 3051.5750s
	iters: 200, epoch: 1 | loss: 0.3986171
	speed: 0.1020s/iter; left time: 2372.5729s
	iters: 300, epoch: 1 | loss: 0.1530709
	speed: 0.1019s/iter; left time: 2359.8158s
	iters: 400, epoch: 1 | loss: 0.0784302
	speed: 0.1011s/iter; left time: 2331.4680s
Epoch: 1 cost time: 50.29733729362488
Epoch: 1, Steps: 469 | Train Loss: 0.593 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (inf --> -0.940821).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1944645
	speed: 0.5613s/iter; left time: 12842.8756s
	iters: 200, epoch: 2 | loss: 0.0030826
	speed: 0.0877s/iter; left time: 1996.8424s
	iters: 300, epoch: 2 | loss: 0.0061614
	speed: 0.1044s/iter; left time: 2367.3453s
	iters: 400, epoch: 2 | loss: 0.0258962
	speed: 0.1001s/iter; left time: 2259.4321s
Epoch: 2 cost time: 46.7436957359314
Epoch: 2, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.940821 --> -0.971411).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0144554
	speed: 0.5448s/iter; left time: 12211.3360s
	iters: 200, epoch: 3 | loss: 0.0251665
	speed: 0.1081s/iter; left time: 2412.6450s
	iters: 300, epoch: 3 | loss: 0.0827251
	speed: 0.1009s/iter; left time: 2241.0296s
	iters: 400, epoch: 3 | loss: 0.0394258
	speed: 0.0987s/iter; left time: 2181.4971s
Epoch: 3 cost time: 48.73180174827576
Epoch: 3, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.173 Vali Acc: 0.969 Test Loss: 0.173 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1501245
	speed: 0.5410s/iter; left time: 11872.4150s
	iters: 200, epoch: 4 | loss: 0.0110134
	speed: 0.0844s/iter; left time: 1842.7396s
	iters: 300, epoch: 4 | loss: 0.0433583
	speed: 0.0936s/iter; left time: 2036.2279s
	iters: 400, epoch: 4 | loss: 0.0037190
	speed: 0.0879s/iter; left time: 1902.3303s
Epoch: 4 cost time: 42.21701622009277
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0237816
	speed: 0.5180s/iter; left time: 11124.9281s
	iters: 200, epoch: 5 | loss: 0.0021153
	speed: 0.0990s/iter; left time: 2116.8393s
	iters: 300, epoch: 5 | loss: 0.0008697
	speed: 0.0978s/iter; left time: 2081.6013s
	iters: 400, epoch: 5 | loss: 0.0098860
	speed: 0.1018s/iter; left time: 2154.9620s
Epoch: 5 cost time: 46.968122243881226
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.280 Vali Acc: 0.951 Test Loss: 0.280 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0076852
	speed: 0.5260s/iter; left time: 11048.5539s
	iters: 200, epoch: 6 | loss: 0.0033022
	speed: 0.0840s/iter; left time: 1756.3239s
	iters: 300, epoch: 6 | loss: 0.0009281
	speed: 0.0894s/iter; left time: 1860.5074s
	iters: 400, epoch: 6 | loss: 0.0005553
	speed: 0.0773s/iter; left time: 1600.6396s
Epoch: 6 cost time: 39.80261015892029
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.273 Vali Acc: 0.960 Test Loss: 0.273 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1531769
	speed: 0.4814s/iter; left time: 9885.6810s
	iters: 200, epoch: 7 | loss: 0.0004865
	speed: 0.0896s/iter; left time: 1831.4918s
	iters: 300, epoch: 7 | loss: 0.0132809
	speed: 0.1009s/iter; left time: 2052.9651s
	iters: 400, epoch: 7 | loss: 0.0053692
	speed: 0.0987s/iter; left time: 1996.8215s
Epoch: 7 cost time: 44.66073250770569
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.966 Test Loss: 0.233 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0003450
	speed: 0.5140s/iter; left time: 10314.1940s
	iters: 200, epoch: 8 | loss: 0.0004700
	speed: 0.0884s/iter; left time: 1765.3212s
	iters: 300, epoch: 8 | loss: 0.0523544
	speed: 0.0896s/iter; left time: 1781.1348s
	iters: 400, epoch: 8 | loss: 0.0147273
	speed: 0.0912s/iter; left time: 1802.3979s
Epoch: 8 cost time: 43.07751822471619
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.261 Vali Acc: 0.957 Test Loss: 0.261 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0946754
	speed: 0.4986s/iter; left time: 9771.8490s
	iters: 200, epoch: 9 | loss: 0.0106626
	speed: 0.0856s/iter; left time: 1670.0598s
	iters: 300, epoch: 9 | loss: 0.0015116
	speed: 0.0862s/iter; left time: 1672.6451s
	iters: 400, epoch: 9 | loss: 0.0000888
	speed: 0.0896s/iter; left time: 1728.5140s
Epoch: 9 cost time: 42.106297969818115
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0001339
	speed: 0.5333s/iter; left time: 10201.8518s
	iters: 200, epoch: 10 | loss: 0.1595633
	speed: 0.0829s/iter; left time: 1576.6764s
	iters: 300, epoch: 10 | loss: 0.0035905
	speed: 0.0816s/iter; left time: 1543.7720s
	iters: 400, epoch: 10 | loss: 0.0001074
	speed: 0.0942s/iter; left time: 1773.0404s
Epoch: 10 cost time: 41.50030446052551
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0003228
	speed: 0.5193s/iter; left time: 9691.1291s
	iters: 200, epoch: 11 | loss: 0.0085079
	speed: 0.0933s/iter; left time: 1732.4364s
	iters: 300, epoch: 11 | loss: 0.0177663
	speed: 0.0924s/iter; left time: 1705.2637s
	iters: 400, epoch: 11 | loss: 0.0000039
	speed: 0.0876s/iter; left time: 1609.1586s
Epoch: 11 cost time: 43.857229709625244
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.288 Vali Acc: 0.965 Test Loss: 0.288 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0007405
	speed: 0.4719s/iter; left time: 8585.7003s
	iters: 200, epoch: 12 | loss: 0.0001468
	speed: 0.0811s/iter; left time: 1467.4156s
	iters: 300, epoch: 12 | loss: 0.0001208
	speed: 0.0916s/iter; left time: 1647.5278s
	iters: 400, epoch: 12 | loss: 0.0001432
	speed: 0.0934s/iter; left time: 1670.7829s
Epoch: 12 cost time: 41.1269748210907
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.965 Test Loss: 0.211 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9714122355631789
model parameter : 390378
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2706108
	speed: 0.1225s/iter; left time: 2859.7933s
	iters: 200, epoch: 1 | loss: 0.1385278
	speed: 0.0973s/iter; left time: 2261.8937s
	iters: 300, epoch: 1 | loss: 0.0670754
	speed: 0.0962s/iter; left time: 2227.9953s
	iters: 400, epoch: 1 | loss: 0.0169310
	speed: 0.0961s/iter; left time: 2214.4031s
Epoch: 1 cost time: 48.71392464637756
Epoch: 1, Steps: 469 | Train Loss: 0.362 Vali Loss: 0.255 Vali Acc: 0.938 Test Loss: 0.255 Test Acc: 0.938
Validation loss decreased (inf --> -0.937962).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0630651
	speed: 0.5303s/iter; left time: 12134.7238s
	iters: 200, epoch: 2 | loss: 0.0072990
	speed: 0.1108s/iter; left time: 2524.7882s
	iters: 300, epoch: 2 | loss: 0.0427471
	speed: 0.1058s/iter; left time: 2400.1156s
	iters: 400, epoch: 2 | loss: 0.0324326
	speed: 0.1106s/iter; left time: 2498.2392s
Epoch: 2 cost time: 50.689733266830444
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
Validation loss decreased (-0.937962 --> -0.945967).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0068675
	speed: 0.5942s/iter; left time: 13317.4837s
	iters: 200, epoch: 3 | loss: 0.1113000
	speed: 0.1014s/iter; left time: 2262.3773s
	iters: 300, epoch: 3 | loss: 0.2808764
	speed: 0.1045s/iter; left time: 2322.1526s
	iters: 400, epoch: 3 | loss: 0.1758576
	speed: 0.0990s/iter; left time: 2189.2854s
Epoch: 3 cost time: 48.86848163604736
Epoch: 3, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
Validation loss decreased (-0.945967 --> -0.964263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0431255
	speed: 0.4745s/iter; left time: 10411.8545s
	iters: 200, epoch: 4 | loss: 0.0017601
	speed: 0.0993s/iter; left time: 2169.4292s
	iters: 300, epoch: 4 | loss: 0.0006618
	speed: 0.1074s/iter; left time: 2335.6482s
	iters: 400, epoch: 4 | loss: 0.1433437
	speed: 0.1091s/iter; left time: 2360.4061s
Epoch: 4 cost time: 49.67878484725952
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0004893
	speed: 0.5483s/iter; left time: 11774.8088s
	iters: 200, epoch: 5 | loss: 0.0000103
	speed: 0.1053s/iter; left time: 2250.3756s
	iters: 300, epoch: 5 | loss: 0.0002884
	speed: 0.1073s/iter; left time: 2283.6762s
	iters: 400, epoch: 5 | loss: 0.0003988
	speed: 0.1122s/iter; left time: 2375.7584s
Epoch: 5 cost time: 49.836291790008545
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.964263 --> -0.972554).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0088934
	speed: 0.5330s/iter; left time: 11195.6877s
	iters: 200, epoch: 6 | loss: 0.0017824
	speed: 0.1040s/iter; left time: 2173.6916s
	iters: 300, epoch: 6 | loss: 0.0201631
	speed: 0.1067s/iter; left time: 2219.3319s
	iters: 400, epoch: 6 | loss: 0.1279320
	speed: 0.1013s/iter; left time: 2097.8790s
Epoch: 6 cost time: 48.79668664932251
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.297 Vali Acc: 0.949 Test Loss: 0.297 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0010012
	speed: 0.5797s/iter; left time: 11904.2848s
	iters: 200, epoch: 7 | loss: 0.0003970
	speed: 0.0976s/iter; left time: 1995.5730s
	iters: 300, epoch: 7 | loss: 0.0013095
	speed: 0.0957s/iter; left time: 1946.0057s
	iters: 400, epoch: 7 | loss: 0.0038131
	speed: 0.1050s/iter; left time: 2124.5847s
Epoch: 7 cost time: 48.73673462867737
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1230762
	speed: 0.5659s/iter; left time: 11356.2018s
	iters: 200, epoch: 8 | loss: 0.0031515
	speed: 0.1135s/iter; left time: 2266.9389s
	iters: 300, epoch: 8 | loss: 0.0004731
	speed: 0.1068s/iter; left time: 2122.2552s
	iters: 400, epoch: 8 | loss: 0.0008816
	speed: 0.0992s/iter; left time: 1960.8190s
Epoch: 8 cost time: 49.50191569328308
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0336554
	speed: 0.5432s/iter; left time: 10647.1490s
	iters: 200, epoch: 9 | loss: 0.0005807
	speed: 0.1009s/iter; left time: 1967.5118s
	iters: 300, epoch: 9 | loss: 0.2420109
	speed: 0.1013s/iter; left time: 1964.8764s
	iters: 400, epoch: 9 | loss: 0.0000217
	speed: 0.1000s/iter; left time: 1929.7061s
Epoch: 9 cost time: 48.48060655593872
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.2055929
	speed: 0.5176s/iter; left time: 9901.5826s
	iters: 200, epoch: 10 | loss: 0.0045074
	speed: 0.0959s/iter; left time: 1825.6819s
	iters: 300, epoch: 10 | loss: 0.0023318
	speed: 0.1025s/iter; left time: 1940.0338s
	iters: 400, epoch: 10 | loss: 0.0019476
	speed: 0.1086s/iter; left time: 2044.6665s
Epoch: 10 cost time: 47.77036952972412
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.972554 --> -0.976557).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0096159
	speed: 0.5329s/iter; left time: 9944.1322s
	iters: 200, epoch: 11 | loss: 0.2634737
	speed: 0.0948s/iter; left time: 1759.3626s
	iters: 300, epoch: 11 | loss: 0.0014919
	speed: 0.1017s/iter; left time: 1878.3953s
	iters: 400, epoch: 11 | loss: 0.0001171
	speed: 0.0989s/iter; left time: 1816.6930s
Epoch: 11 cost time: 46.097179889678955
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.979 Test Loss: 0.158 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.979415).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002026
	speed: 0.5427s/iter; left time: 9873.0258s
	iters: 200, epoch: 12 | loss: 0.0000313
	speed: 0.0967s/iter; left time: 1748.7887s
	iters: 300, epoch: 12 | loss: 0.0000256
	speed: 0.0972s/iter; left time: 1748.6792s
	iters: 400, epoch: 12 | loss: 0.0000007
	speed: 0.0969s/iter; left time: 1733.5229s
Epoch: 12 cost time: 45.274619579315186
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2027272
	speed: 0.5422s/iter; left time: 9608.6370s
	iters: 200, epoch: 13 | loss: 0.0000035
	speed: 0.0904s/iter; left time: 1592.7807s
	iters: 300, epoch: 13 | loss: 0.0020097
	speed: 0.0920s/iter; left time: 1611.7410s
	iters: 400, epoch: 13 | loss: 0.0001251
	speed: 0.0924s/iter; left time: 1609.3885s
Epoch: 13 cost time: 45.4827344417572
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
Validation loss decreased (-0.979415 --> -0.981131).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003746
	speed: 0.5313s/iter; left time: 9166.4025s
	iters: 200, epoch: 14 | loss: 0.0267030
	speed: 0.0946s/iter; left time: 1623.0812s
	iters: 300, epoch: 14 | loss: 0.0077705
	speed: 0.0964s/iter; left time: 1643.7576s
	iters: 400, epoch: 14 | loss: 0.0039898
	speed: 0.0824s/iter; left time: 1397.2944s
Epoch: 14 cost time: 44.973904609680176
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.255 Vali Acc: 0.965 Test Loss: 0.255 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.5258s/iter; left time: 8825.8684s
	iters: 200, epoch: 15 | loss: 0.2203695
	speed: 0.0930s/iter; left time: 1551.5007s
	iters: 300, epoch: 15 | loss: 0.0001184
	speed: 0.0993s/iter; left time: 1647.4726s
	iters: 400, epoch: 15 | loss: 0.0000057
	speed: 0.0892s/iter; left time: 1470.0250s
Epoch: 15 cost time: 44.573107957839966
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.253 Vali Acc: 0.959 Test Loss: 0.253 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000331
	speed: 0.5426s/iter; left time: 8853.8210s
	iters: 200, epoch: 16 | loss: 0.0000044
	speed: 0.0984s/iter; left time: 1596.3311s
	iters: 300, epoch: 16 | loss: 0.0000014
	speed: 0.0971s/iter; left time: 1565.2029s
	iters: 400, epoch: 16 | loss: 0.0062045
	speed: 0.0945s/iter; left time: 1512.7193s
Epoch: 16 cost time: 46.185102462768555
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0003795
	speed: 0.5438s/iter; left time: 8617.8190s
	iters: 200, epoch: 17 | loss: 0.0012445
	speed: 0.1031s/iter; left time: 1624.1721s
	iters: 300, epoch: 17 | loss: 0.0000046
	speed: 0.1040s/iter; left time: 1627.0203s
	iters: 400, epoch: 17 | loss: 0.0003391
	speed: 0.1081s/iter; left time: 1680.0973s
Epoch: 17 cost time: 49.736674547195435
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000450
	speed: 0.5489s/iter; left time: 8440.8775s
	iters: 200, epoch: 18 | loss: 0.0014474
	speed: 0.0970s/iter; left time: 1481.5089s
	iters: 300, epoch: 18 | loss: 0.0000023
	speed: 0.1105s/iter; left time: 1676.9875s
	iters: 400, epoch: 18 | loss: 0.0000012
	speed: 0.1056s/iter; left time: 1591.9229s
Epoch: 18 cost time: 49.62255239486694
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0002191
	speed: 0.5696s/iter; left time: 8491.7741s
	iters: 200, epoch: 19 | loss: 0.0016361
	speed: 0.0999s/iter; left time: 1479.5650s
	iters: 300, epoch: 19 | loss: 0.0000005
	speed: 0.0911s/iter; left time: 1339.3238s
	iters: 400, epoch: 19 | loss: 0.0000025
	speed: 0.0944s/iter; left time: 1378.7089s
Epoch: 19 cost time: 46.43382167816162
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.258 Vali Acc: 0.962 Test Loss: 0.258 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.3310525
	speed: 0.5574s/iter; left time: 8049.1268s
	iters: 200, epoch: 20 | loss: 0.0000365
	speed: 0.1034s/iter; left time: 1483.2658s
	iters: 300, epoch: 20 | loss: 0.0000012
	speed: 0.1137s/iter; left time: 1619.0075s
	iters: 400, epoch: 20 | loss: 0.0009140
	speed: 0.1077s/iter; left time: 1522.2722s
Epoch: 20 cost time: 49.91103792190552
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000038
	speed: 0.5780s/iter; left time: 8075.0693s
	iters: 200, epoch: 21 | loss: 0.0000093
	speed: 0.1122s/iter; left time: 1556.6984s
	iters: 300, epoch: 21 | loss: 0.0000005
	speed: 0.1098s/iter; left time: 1511.9313s
	iters: 400, epoch: 21 | loss: 0.0000288
	speed: 0.1139s/iter; left time: 1557.5344s
Epoch: 21 cost time: 52.603885650634766
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.181 Vali Acc: 0.976 Test Loss: 0.181 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0008933
	speed: 0.5646s/iter; left time: 7622.8500s
	iters: 200, epoch: 22 | loss: 0.0004579
	speed: 0.0902s/iter; left time: 1208.2696s
	iters: 300, epoch: 22 | loss: 0.0000021
	speed: 0.0899s/iter; left time: 1195.9004s
	iters: 400, epoch: 22 | loss: 0.0000044
	speed: 0.1033s/iter; left time: 1364.2528s
Epoch: 22 cost time: 45.64781928062439
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.175 Vali Acc: 0.979 Test Loss: 0.175 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0015901
	speed: 0.5551s/iter; left time: 7234.1515s
	iters: 200, epoch: 23 | loss: 0.0027234
	speed: 0.1027s/iter; left time: 1328.3497s
	iters: 300, epoch: 23 | loss: 0.0000111
	speed: 0.1058s/iter; left time: 1357.3094s
	iters: 400, epoch: 23 | loss: 0.0001634
	speed: 0.0976s/iter; left time: 1242.6702s
Epoch: 23 cost time: 49.18917465209961
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.973 Test Loss: 0.234 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 1435402
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5077600
	speed: 0.1246s/iter; left time: 2909.0303s
	iters: 200, epoch: 1 | loss: 0.1184107
	speed: 0.0780s/iter; left time: 1813.1280s
	iters: 300, epoch: 1 | loss: 0.0108274
	speed: 0.0781s/iter; left time: 1807.6706s
	iters: 400, epoch: 1 | loss: 0.1642657
	speed: 0.0819s/iter; left time: 1886.7584s
Epoch: 1 cost time: 43.51427412033081
Epoch: 1, Steps: 469 | Train Loss: 0.372 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
Validation loss decreased (inf --> -0.957117).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0382051
	speed: 0.5461s/iter; left time: 12496.6872s
	iters: 200, epoch: 2 | loss: 0.0704197
	speed: 0.1038s/iter; left time: 2364.0039s
	iters: 300, epoch: 2 | loss: 0.0009609
	speed: 0.1054s/iter; left time: 2390.0732s
	iters: 400, epoch: 2 | loss: 0.0007143
	speed: 0.1113s/iter; left time: 2513.7929s
Epoch: 2 cost time: 50.497591972351074
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.204 Vali Acc: 0.955 Test Loss: 0.204 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0453599
	speed: 0.5615s/iter; left time: 12585.7745s
	iters: 200, epoch: 3 | loss: 0.0527048
	speed: 0.1016s/iter; left time: 2266.5630s
	iters: 300, epoch: 3 | loss: 0.0081629
	speed: 0.0883s/iter; left time: 1960.9437s
	iters: 400, epoch: 3 | loss: 0.0178954
	speed: 0.0996s/iter; left time: 2201.4082s
Epoch: 3 cost time: 47.25480246543884
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
Validation loss decreased (-0.957117 --> -0.973126).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3201982
	speed: 0.5596s/iter; left time: 12280.2548s
	iters: 200, epoch: 4 | loss: 0.0000424
	speed: 0.0880s/iter; left time: 1921.7729s
	iters: 300, epoch: 4 | loss: 0.0009302
	speed: 0.0903s/iter; left time: 1962.6464s
	iters: 400, epoch: 4 | loss: 0.0418011
	speed: 0.0956s/iter; left time: 2068.3135s
Epoch: 4 cost time: 44.30292248725891
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0006717
	speed: 0.5654s/iter; left time: 12141.6661s
	iters: 200, epoch: 5 | loss: 0.0000514
	speed: 0.0944s/iter; left time: 2016.9953s
	iters: 300, epoch: 5 | loss: 0.0000104
	speed: 0.0885s/iter; left time: 1882.0245s
	iters: 400, epoch: 5 | loss: 0.0058455
	speed: 0.0988s/iter; left time: 2092.7607s
Epoch: 5 cost time: 46.95933222770691
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0022650
	speed: 0.5373s/iter; left time: 11285.8447s
	iters: 200, epoch: 6 | loss: 0.0110432
	speed: 0.0894s/iter; left time: 1868.0175s
	iters: 300, epoch: 6 | loss: 0.0000256
	speed: 0.0856s/iter; left time: 1780.6869s
	iters: 400, epoch: 6 | loss: 0.0001807
	speed: 0.0875s/iter; left time: 1811.8460s
Epoch: 6 cost time: 43.239991426467896
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.302 Vali Acc: 0.949 Test Loss: 0.302 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0002680
	speed: 0.5249s/iter; left time: 10779.0168s
	iters: 200, epoch: 7 | loss: 0.0190830
	speed: 0.1025s/iter; left time: 2093.8873s
	iters: 300, epoch: 7 | loss: 0.0017254
	speed: 0.0997s/iter; left time: 2028.2369s
	iters: 400, epoch: 7 | loss: 0.4918665
	speed: 0.1047s/iter; left time: 2117.8247s
Epoch: 7 cost time: 48.665013790130615
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0001298
	speed: 0.5341s/iter; left time: 10718.1746s
	iters: 200, epoch: 8 | loss: 0.0000061
	speed: 0.0913s/iter; left time: 1823.8343s
	iters: 300, epoch: 8 | loss: 0.0002745
	speed: 0.1000s/iter; left time: 1986.6707s
	iters: 400, epoch: 8 | loss: 0.5214787
	speed: 0.1015s/iter; left time: 2006.0369s
Epoch: 8 cost time: 45.953821420669556
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.973126 --> -0.974841).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000272
	speed: 0.5176s/iter; left time: 10145.0107s
	iters: 200, epoch: 9 | loss: 0.0001176
	speed: 0.0933s/iter; left time: 1818.5998s
	iters: 300, epoch: 9 | loss: 0.0000040
	speed: 0.0923s/iter; left time: 1791.3954s
	iters: 400, epoch: 9 | loss: 0.0000468
	speed: 0.0915s/iter; left time: 1765.0044s
Epoch: 9 cost time: 45.008524656295776
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000017
	speed: 0.5298s/iter; left time: 10135.5555s
	iters: 200, epoch: 10 | loss: 0.0007781
	speed: 0.0989s/iter; left time: 1882.6805s
	iters: 300, epoch: 10 | loss: 0.0000813
	speed: 0.0890s/iter; left time: 1684.0015s
	iters: 400, epoch: 10 | loss: 0.0004378
	speed: 0.0870s/iter; left time: 1638.5011s
Epoch: 10 cost time: 43.794811487197876
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000214
	speed: 0.5424s/iter; left time: 10120.9807s
	iters: 200, epoch: 11 | loss: 0.0029440
	speed: 0.1057s/iter; left time: 1961.0495s
	iters: 300, epoch: 11 | loss: 0.0000018
	speed: 0.1048s/iter; left time: 1934.3220s
	iters: 400, epoch: 11 | loss: 0.0000261
	speed: 0.1050s/iter; left time: 1927.1631s
Epoch: 11 cost time: 49.861867904663086
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.969 Test Loss: 0.227 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000010
	speed: 0.5638s/iter; left time: 10257.1743s
	iters: 200, epoch: 12 | loss: 0.0006141
	speed: 0.0977s/iter; left time: 1767.2897s
	iters: 300, epoch: 12 | loss: 0.2368513
	speed: 0.0951s/iter; left time: 1710.6984s
	iters: 400, epoch: 12 | loss: 0.0000514
	speed: 0.0963s/iter; left time: 1723.5984s
Epoch: 12 cost time: 46.73124957084656
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.246 Vali Acc: 0.962 Test Loss: 0.246 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0010632
	speed: 0.5213s/iter; left time: 9238.6981s
	iters: 200, epoch: 13 | loss: 0.1773868
	speed: 0.0926s/iter; left time: 1632.3358s
	iters: 300, epoch: 13 | loss: 0.0000091
	speed: 0.1010s/iter; left time: 1769.8593s
	iters: 400, epoch: 13 | loss: 0.0014332
	speed: 0.1004s/iter; left time: 1748.5103s
Epoch: 13 cost time: 46.18136167526245
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.271 Vali Acc: 0.969 Test Loss: 0.271 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000006
	speed: 0.5472s/iter; left time: 9441.7637s
	iters: 200, epoch: 14 | loss: 0.0007388
	speed: 0.0963s/iter; left time: 1652.0520s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.0911s/iter; left time: 1553.8410s
	iters: 400, epoch: 14 | loss: 0.0794760
	speed: 0.0876s/iter; left time: 1485.3120s
Epoch: 14 cost time: 45.236316442489624
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000137
	speed: 0.5157s/iter; left time: 8655.8872s
	iters: 200, epoch: 15 | loss: 0.0000344
	speed: 0.0956s/iter; left time: 1595.7329s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0918s/iter; left time: 1521.9455s
	iters: 400, epoch: 15 | loss: 0.0006522
	speed: 0.0944s/iter; left time: 1555.9323s
Epoch: 15 cost time: 45.22686719894409
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.320 Vali Acc: 0.969 Test Loss: 0.320 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001013
	speed: 0.5056s/iter; left time: 8248.6890s
	iters: 200, epoch: 16 | loss: 0.0001921
	speed: 0.0874s/iter; left time: 1417.3454s
	iters: 300, epoch: 16 | loss: 0.0001003
	speed: 0.0973s/iter; left time: 1567.9088s
	iters: 400, epoch: 16 | loss: 0.0000191
	speed: 0.1009s/iter; left time: 1616.8003s
Epoch: 16 cost time: 44.37644290924072
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.387 Vali Acc: 0.966 Test Loss: 0.387 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0002224
	speed: 0.5321s/iter; left time: 8431.6884s
	iters: 200, epoch: 17 | loss: 0.0000193
	speed: 0.0999s/iter; left time: 1573.4459s
	iters: 300, epoch: 17 | loss: 0.0046476
	speed: 0.0907s/iter; left time: 1419.4691s
	iters: 400, epoch: 17 | loss: 0.1692342
	speed: 0.0911s/iter; left time: 1416.3325s
Epoch: 17 cost time: 45.52631402015686
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.315 Vali Acc: 0.971 Test Loss: 0.315 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000003
	speed: 0.5230s/iter; left time: 8042.3928s
	iters: 200, epoch: 18 | loss: 0.0316152
	speed: 0.0965s/iter; left time: 1474.8706s
	iters: 300, epoch: 18 | loss: 0.0000027
	speed: 0.0961s/iter; left time: 1457.9441s
	iters: 400, epoch: 18 | loss: 0.0000001
	speed: 0.0920s/iter; left time: 1387.5790s
Epoch: 18 cost time: 46.61088538169861
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.974 Test Loss: 0.249 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 1435530
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7468329
	speed: 0.0988s/iter; left time: 2308.0768s
	iters: 200, epoch: 1 | loss: 0.5836327
	speed: 0.0780s/iter; left time: 1813.8783s
	iters: 300, epoch: 1 | loss: 0.1835257
	speed: 0.0795s/iter; left time: 1841.5405s
	iters: 400, epoch: 1 | loss: 0.2204992
	speed: 0.0811s/iter; left time: 1870.3584s
Epoch: 1 cost time: 39.05259847640991
Epoch: 1, Steps: 469 | Train Loss: 0.528 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
Validation loss decreased (inf --> -0.957116).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0540052
	speed: 0.4701s/iter; left time: 10757.9444s
	iters: 200, epoch: 2 | loss: 0.0123413
	speed: 0.0815s/iter; left time: 1855.8459s
	iters: 300, epoch: 2 | loss: 0.0327791
	speed: 0.0766s/iter; left time: 1736.6549s
	iters: 400, epoch: 2 | loss: 0.0247422
	speed: 0.0767s/iter; left time: 1731.1421s
Epoch: 2 cost time: 36.98972225189209
Epoch: 2, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
Validation loss decreased (-0.957116 --> -0.963978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0566194
	speed: 0.4296s/iter; left time: 9627.6925s
	iters: 200, epoch: 3 | loss: 0.0763895
	speed: 0.0658s/iter; left time: 1467.8664s
	iters: 300, epoch: 3 | loss: 0.0035907
	speed: 0.0710s/iter; left time: 1578.2110s
	iters: 400, epoch: 3 | loss: 0.0014861
	speed: 0.0719s/iter; left time: 1590.7619s
Epoch: 3 cost time: 33.527695655822754
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.963978 --> -0.967980).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0017575
	speed: 0.4442s/iter; left time: 9746.9843s
	iters: 200, epoch: 4 | loss: 0.0030569
	speed: 0.0723s/iter; left time: 1579.8154s
	iters: 300, epoch: 4 | loss: 0.0005999
	speed: 0.0758s/iter; left time: 1648.6483s
	iters: 400, epoch: 4 | loss: 0.0069668
	speed: 0.0766s/iter; left time: 1658.0046s
Epoch: 4 cost time: 35.70854091644287
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
Validation loss decreased (-0.967980 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0014096
	speed: 0.4531s/iter; left time: 9731.2390s
	iters: 200, epoch: 5 | loss: 0.0001725
	speed: 0.0711s/iter; left time: 1519.5841s
	iters: 300, epoch: 5 | loss: 0.0031553
	speed: 0.0735s/iter; left time: 1564.0782s
	iters: 400, epoch: 5 | loss: 0.0020123
	speed: 0.0689s/iter; left time: 1458.2720s
Epoch: 5 cost time: 34.25791358947754
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0014879
	speed: 0.4531s/iter; left time: 9517.6881s
	iters: 200, epoch: 6 | loss: 0.0110776
	speed: 0.0724s/iter; left time: 1513.1660s
	iters: 300, epoch: 6 | loss: 0.1283100
	speed: 0.0733s/iter; left time: 1524.9225s
	iters: 400, epoch: 6 | loss: 0.0028296
	speed: 0.0767s/iter; left time: 1587.5142s
Epoch: 6 cost time: 34.845942735672
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
Validation loss decreased (-0.971125 --> -0.973698).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0189016
	speed: 0.4629s/iter; left time: 9507.4317s
	iters: 200, epoch: 7 | loss: 0.0015537
	speed: 0.0818s/iter; left time: 1670.8542s
	iters: 300, epoch: 7 | loss: 0.0004286
	speed: 0.0837s/iter; left time: 1702.0044s
	iters: 400, epoch: 7 | loss: 0.0010299
	speed: 0.0718s/iter; left time: 1452.7088s
Epoch: 7 cost time: 37.11217260360718
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.973698 --> -0.978272).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4416951
	speed: 0.4093s/iter; left time: 8213.6028s
	iters: 200, epoch: 8 | loss: 0.0009218
	speed: 0.0728s/iter; left time: 1453.2421s
	iters: 300, epoch: 8 | loss: 0.0008157
	speed: 0.0756s/iter; left time: 1501.4895s
	iters: 400, epoch: 8 | loss: 0.0048287
	speed: 0.0695s/iter; left time: 1373.5053s
Epoch: 8 cost time: 34.872467041015625
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2930237
	speed: 0.4220s/iter; left time: 8269.9201s
	iters: 200, epoch: 9 | loss: 0.0000573
	speed: 0.0749s/iter; left time: 1461.3850s
	iters: 300, epoch: 9 | loss: 0.0005139
	speed: 0.0687s/iter; left time: 1331.8171s
	iters: 400, epoch: 9 | loss: 0.0017477
	speed: 0.0697s/iter; left time: 1345.1943s
Epoch: 9 cost time: 34.55868649482727
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.966 Test Loss: 0.190 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0448544
	speed: 0.4320s/iter; left time: 8263.5374s
	iters: 200, epoch: 10 | loss: 0.0145159
	speed: 0.0705s/iter; left time: 1341.5852s
	iters: 300, epoch: 10 | loss: 0.0002412
	speed: 0.0708s/iter; left time: 1339.8240s
	iters: 400, epoch: 10 | loss: 0.0006037
	speed: 0.0705s/iter; left time: 1326.7427s
Epoch: 10 cost time: 34.08133625984192
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000061
	speed: 0.3994s/iter; left time: 7453.9381s
	iters: 200, epoch: 11 | loss: 0.0000129
	speed: 0.0478s/iter; left time: 887.5758s
	iters: 300, epoch: 11 | loss: 0.0046942
	speed: 0.0506s/iter; left time: 934.9654s
	iters: 400, epoch: 11 | loss: 0.0006807
	speed: 0.0682s/iter; left time: 1252.2028s
Epoch: 11 cost time: 27.38752055168152
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0497902
	speed: 0.4350s/iter; left time: 7913.0488s
	iters: 200, epoch: 12 | loss: 0.0053663
	speed: 0.0724s/iter; left time: 1309.9852s
	iters: 300, epoch: 12 | loss: 0.2278595
	speed: 0.0673s/iter; left time: 1210.7399s
	iters: 400, epoch: 12 | loss: 0.0382407
	speed: 0.0675s/iter; left time: 1208.4502s
Epoch: 12 cost time: 33.55714249610901
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.170 Vali Acc: 0.974 Test Loss: 0.170 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0001461
	speed: 0.4276s/iter; left time: 7578.1803s
	iters: 200, epoch: 13 | loss: 0.0117676
	speed: 0.0652s/iter; left time: 1149.1728s
	iters: 300, epoch: 13 | loss: 0.0004442
	speed: 0.0667s/iter; left time: 1168.2917s
	iters: 400, epoch: 13 | loss: 0.0001508
	speed: 0.0657s/iter; left time: 1144.0225s
Epoch: 13 cost time: 32.21520233154297
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.982 Test Loss: 0.156 Test Acc: 0.982
Validation loss decreased (-0.978272 --> -0.981702).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003087
	speed: 0.4064s/iter; left time: 7011.5763s
	iters: 200, epoch: 14 | loss: 0.0105769
	speed: 0.0700s/iter; left time: 1200.8967s
	iters: 300, epoch: 14 | loss: 0.0000643
	speed: 0.0664s/iter; left time: 1131.6911s
	iters: 400, epoch: 14 | loss: 0.0003137
	speed: 0.0610s/iter; left time: 1033.9726s
Epoch: 14 cost time: 31.539750576019287
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.965 Test Loss: 0.217 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0001595
	speed: 0.3733s/iter; left time: 6265.6652s
	iters: 200, epoch: 15 | loss: 0.1001568
	speed: 0.0735s/iter; left time: 1225.8408s
	iters: 300, epoch: 15 | loss: 0.0012910
	speed: 0.0731s/iter; left time: 1211.7945s
	iters: 400, epoch: 15 | loss: 0.0021620
	speed: 0.0719s/iter; left time: 1184.7988s
Epoch: 15 cost time: 34.45139789581299
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0287291
	speed: 0.3951s/iter; left time: 6446.9135s
	iters: 200, epoch: 16 | loss: 0.0010007
	speed: 0.0741s/iter; left time: 1201.2122s
	iters: 300, epoch: 16 | loss: 0.0006797
	speed: 0.0807s/iter; left time: 1300.2267s
	iters: 400, epoch: 16 | loss: 0.0093765
	speed: 0.0794s/iter; left time: 1272.2976s
Epoch: 16 cost time: 36.68591547012329
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
Validation loss decreased (-0.981702 --> -0.981989).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0003545
	speed: 0.4249s/iter; left time: 6733.1582s
	iters: 200, epoch: 17 | loss: 0.0312667
	speed: 0.0673s/iter; left time: 1060.3264s
	iters: 300, epoch: 17 | loss: 0.0055130
	speed: 0.0717s/iter; left time: 1122.3908s
	iters: 400, epoch: 17 | loss: 0.0016793
	speed: 0.0738s/iter; left time: 1147.9412s
Epoch: 17 cost time: 33.932825803756714
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001869
	speed: 0.4229s/iter; left time: 6503.3279s
	iters: 200, epoch: 18 | loss: 0.0000482
	speed: 0.0728s/iter; left time: 1112.7716s
	iters: 300, epoch: 18 | loss: 0.0030881
	speed: 0.0741s/iter; left time: 1124.5726s
	iters: 400, epoch: 18 | loss: 0.0000054
	speed: 0.0792s/iter; left time: 1194.0976s
Epoch: 18 cost time: 35.33116292953491
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.976 Test Loss: 0.206 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0051515
	speed: 0.4170s/iter; left time: 6217.2723s
	iters: 200, epoch: 19 | loss: 0.0000010
	speed: 0.0651s/iter; left time: 964.3810s
	iters: 300, epoch: 19 | loss: 0.0000610
	speed: 0.0640s/iter; left time: 941.6181s
	iters: 400, epoch: 19 | loss: 0.0024082
	speed: 0.0716s/iter; left time: 1045.7448s
Epoch: 19 cost time: 32.16098356246948
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.228 Vali Acc: 0.965 Test Loss: 0.228 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000042
	speed: 0.4146s/iter; left time: 5986.6892s
	iters: 200, epoch: 20 | loss: 0.0025811
	speed: 0.0651s/iter; left time: 934.0361s
	iters: 300, epoch: 20 | loss: 0.0021001
	speed: 0.0711s/iter; left time: 1011.9420s
	iters: 400, epoch: 20 | loss: 0.0001237
	speed: 0.0719s/iter; left time: 1016.0428s
Epoch: 20 cost time: 32.3174946308136
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0005043
	speed: 0.4107s/iter; left time: 5738.5277s
	iters: 200, epoch: 21 | loss: 0.0001543
	speed: 0.0781s/iter; left time: 1083.8386s
	iters: 300, epoch: 21 | loss: 0.0000024
	speed: 0.0774s/iter; left time: 1065.2890s
	iters: 400, epoch: 21 | loss: 0.0000036
	speed: 0.0768s/iter; left time: 1050.2430s
Epoch: 21 cost time: 36.30980849266052
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.979 Test Loss: 0.171 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000628
	speed: 0.4023s/iter; left time: 5431.6391s
	iters: 200, epoch: 22 | loss: 0.0578515
	speed: 0.0576s/iter; left time: 772.1268s
	iters: 300, epoch: 22 | loss: 0.0000770
	speed: 0.0597s/iter; left time: 793.9340s
	iters: 400, epoch: 22 | loss: 0.0000027
	speed: 0.0582s/iter; left time: 768.0950s
Epoch: 22 cost time: 27.780445098876953
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.974 Test Loss: 0.193 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000274
	speed: 0.4227s/iter; left time: 5509.1935s
	iters: 200, epoch: 23 | loss: 0.0000451
	speed: 0.0782s/iter; left time: 1010.9683s
	iters: 300, epoch: 23 | loss: 0.0000028
	speed: 0.0808s/iter; left time: 1036.5502s
	iters: 400, epoch: 23 | loss: 0.2367291
	speed: 0.0788s/iter; left time: 1003.5866s
Epoch: 23 cost time: 37.040695667266846
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000574
	speed: 0.4255s/iter; left time: 5345.4980s
	iters: 200, epoch: 24 | loss: 0.0000098
	speed: 0.0646s/iter; left time: 804.9603s
	iters: 300, epoch: 24 | loss: 0.0000687
	speed: 0.0709s/iter; left time: 876.6736s
	iters: 400, epoch: 24 | loss: 0.0395575
	speed: 0.0763s/iter; left time: 936.0756s
Epoch: 24 cost time: 34.874457359313965
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0003284
	speed: 0.4804s/iter; left time: 5811.0276s
	iters: 200, epoch: 25 | loss: 0.0232544
	speed: 0.0881s/iter; left time: 1056.2142s
	iters: 300, epoch: 25 | loss: 0.0020142
	speed: 0.0918s/iter; left time: 1091.7533s
	iters: 400, epoch: 25 | loss: 0.0003227
	speed: 0.0901s/iter; left time: 1062.8689s
Epoch: 25 cost time: 42.17807602882385
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0003766
	speed: 0.4980s/iter; left time: 5789.3572s
	iters: 200, epoch: 26 | loss: 0.0001466
	speed: 0.0738s/iter; left time: 850.3579s
	iters: 300, epoch: 26 | loss: 0.0004162
	speed: 0.0773s/iter; left time: 883.7435s
	iters: 400, epoch: 26 | loss: 0.0047107
	speed: 0.0914s/iter; left time: 1035.4697s
Epoch: 26 cost time: 38.07851600646973
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 373642
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5289491
	speed: 0.1076s/iter; left time: 2511.5754s
	iters: 200, epoch: 1 | loss: 0.2261187
	speed: 0.0837s/iter; left time: 1945.1417s
	iters: 300, epoch: 1 | loss: 0.1494276
	speed: 0.0833s/iter; left time: 1928.1817s
	iters: 400, epoch: 1 | loss: 0.1404987
	speed: 0.0886s/iter; left time: 2042.0493s
Epoch: 1 cost time: 42.81729578971863
Epoch: 1, Steps: 469 | Train Loss: 0.530 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (inf --> -0.958546).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1552815
	speed: 0.4542s/iter; left time: 10393.4129s
	iters: 200, epoch: 2 | loss: 0.1183835
	speed: 0.0817s/iter; left time: 1862.3951s
	iters: 300, epoch: 2 | loss: 0.0342161
	speed: 0.0849s/iter; left time: 1925.0442s
	iters: 400, epoch: 2 | loss: 0.0817651
	speed: 0.0854s/iter; left time: 1929.1961s
Epoch: 2 cost time: 40.83809494972229
Epoch: 2, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.958546 --> -0.971697).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0193193
	speed: 0.4829s/iter; left time: 10822.7939s
	iters: 200, epoch: 3 | loss: 0.0048352
	speed: 0.0850s/iter; left time: 1895.7623s
	iters: 300, epoch: 3 | loss: 0.0346025
	speed: 0.0795s/iter; left time: 1765.3326s
	iters: 400, epoch: 3 | loss: 0.0021967
	speed: 0.0761s/iter; left time: 1683.3988s
Epoch: 3 cost time: 38.096529960632324
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.973126).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0359142
	speed: 0.4519s/iter; left time: 9916.1891s
	iters: 200, epoch: 4 | loss: 0.0067178
	speed: 0.0761s/iter; left time: 1661.8865s
	iters: 300, epoch: 4 | loss: 0.0513961
	speed: 0.0769s/iter; left time: 1673.0967s
	iters: 400, epoch: 4 | loss: 0.0008169
	speed: 0.0813s/iter; left time: 1760.5339s
Epoch: 4 cost time: 38.09243392944336
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0025170
	speed: 0.4214s/iter; left time: 9050.5711s
	iters: 200, epoch: 5 | loss: 0.0017041
	speed: 0.0861s/iter; left time: 1841.0118s
	iters: 300, epoch: 5 | loss: 0.0017282
	speed: 0.0798s/iter; left time: 1697.5646s
	iters: 400, epoch: 5 | loss: 0.0001192
	speed: 0.0761s/iter; left time: 1611.3997s
Epoch: 5 cost time: 38.5877959728241
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0258780
	speed: 0.4406s/iter; left time: 9255.0874s
	iters: 200, epoch: 6 | loss: 0.0003898
	speed: 0.0750s/iter; left time: 1566.9130s
	iters: 300, epoch: 6 | loss: 0.0005366
	speed: 0.0783s/iter; left time: 1628.9098s
	iters: 400, epoch: 6 | loss: 0.0061623
	speed: 0.0664s/iter; left time: 1373.9418s
Epoch: 6 cost time: 34.589972496032715
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.973126 --> -0.975413).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0037697
	speed: 0.4304s/iter; left time: 8840.1279s
	iters: 200, epoch: 7 | loss: 0.0062502
	speed: 0.0636s/iter; left time: 1299.8550s
	iters: 300, epoch: 7 | loss: 0.1829174
	speed: 0.0607s/iter; left time: 1234.7516s
	iters: 400, epoch: 7 | loss: 0.0004874
	speed: 0.0645s/iter; left time: 1304.6765s
Epoch: 7 cost time: 31.124605894088745
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0020502
	speed: 0.4134s/iter; left time: 8295.8852s
	iters: 200, epoch: 8 | loss: 0.0017879
	speed: 0.0841s/iter; left time: 1679.4882s
	iters: 300, epoch: 8 | loss: 0.0012504
	speed: 0.0823s/iter; left time: 1634.1608s
	iters: 400, epoch: 8 | loss: 0.2006523
	speed: 0.0761s/iter; left time: 1505.0451s
Epoch: 8 cost time: 37.863157510757446
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0013237
	speed: 0.4223s/iter; left time: 8276.8415s
	iters: 200, epoch: 9 | loss: 0.0115426
	speed: 0.0800s/iter; left time: 1560.2642s
	iters: 300, epoch: 9 | loss: 0.0280072
	speed: 0.0801s/iter; left time: 1554.0248s
	iters: 400, epoch: 9 | loss: 0.0035581
	speed: 0.0761s/iter; left time: 1468.8472s
Epoch: 9 cost time: 36.829195737838745
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.304 Vali Acc: 0.952 Test Loss: 0.304 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000446
	speed: 0.4391s/iter; left time: 8399.6654s
	iters: 200, epoch: 10 | loss: 0.0000293
	speed: 0.0754s/iter; left time: 1433.9510s
	iters: 300, epoch: 10 | loss: 0.0014469
	speed: 0.0828s/iter; left time: 1566.6366s
	iters: 400, epoch: 10 | loss: 0.0000074
	speed: 0.0725s/iter; left time: 1365.5001s
Epoch: 10 cost time: 36.43530344963074
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.195 Vali Acc: 0.968 Test Loss: 0.195 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0001515
	speed: 0.3988s/iter; left time: 7442.4278s
	iters: 200, epoch: 11 | loss: 0.0000405
	speed: 0.0581s/iter; left time: 1079.0023s
	iters: 300, epoch: 11 | loss: 0.0000215
	speed: 0.0598s/iter; left time: 1103.1624s
	iters: 400, epoch: 11 | loss: 0.0088936
	speed: 0.0635s/iter; left time: 1166.2831s
Epoch: 11 cost time: 29.265429258346558
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0001824
	speed: 0.4344s/iter; left time: 7901.7867s
	iters: 200, epoch: 12 | loss: 0.0000767
	speed: 0.0805s/iter; left time: 1457.2396s
	iters: 300, epoch: 12 | loss: 0.0000323
	speed: 0.0815s/iter; left time: 1467.0942s
	iters: 400, epoch: 12 | loss: 0.0000980
	speed: 0.0742s/iter; left time: 1327.8689s
Epoch: 12 cost time: 36.66378116607666
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.968 Test Loss: 0.194 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000604
	speed: 0.4315s/iter; left time: 7648.2005s
	iters: 200, epoch: 13 | loss: 0.0001959
	speed: 0.0712s/iter; left time: 1253.9949s
	iters: 300, epoch: 13 | loss: 0.0002759
	speed: 0.0743s/iter; left time: 1302.3495s
	iters: 400, epoch: 13 | loss: 0.0018637
	speed: 0.0726s/iter; left time: 1265.5601s
Epoch: 13 cost time: 34.27879190444946
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.246 Vali Acc: 0.969 Test Loss: 0.246 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0013189
	speed: 0.4307s/iter; left time: 7431.1114s
	iters: 200, epoch: 14 | loss: 0.0102263
	speed: 0.0878s/iter; left time: 1505.9318s
	iters: 300, epoch: 14 | loss: 0.0012982
	speed: 0.0813s/iter; left time: 1387.0957s
	iters: 400, epoch: 14 | loss: 0.0004790
	speed: 0.0780s/iter; left time: 1322.4854s
Epoch: 14 cost time: 38.73370313644409
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.223 Vali Acc: 0.973 Test Loss: 0.223 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000039
	speed: 0.4240s/iter; left time: 7116.7627s
	iters: 200, epoch: 15 | loss: 0.0000065
	speed: 0.0807s/iter; left time: 1346.9776s
	iters: 300, epoch: 15 | loss: 0.0092770
	speed: 0.0780s/iter; left time: 1293.1732s
	iters: 400, epoch: 15 | loss: 0.0987921
	speed: 0.0759s/iter; left time: 1250.4997s
Epoch: 15 cost time: 36.96319246292114
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.193 Vali Acc: 0.976 Test Loss: 0.193 Test Acc: 0.976
Validation loss decreased (-0.975413 --> -0.975984).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0006174
	speed: 0.4229s/iter; left time: 6900.4913s
	iters: 200, epoch: 16 | loss: 0.7073406
	speed: 0.0769s/iter; left time: 1246.4477s
	iters: 300, epoch: 16 | loss: 0.0003811
	speed: 0.0707s/iter; left time: 1139.5269s
	iters: 400, epoch: 16 | loss: 0.0006771
	speed: 0.0694s/iter; left time: 1112.2409s
Epoch: 16 cost time: 34.62408185005188
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.245 Vali Acc: 0.971 Test Loss: 0.245 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0010393
	speed: 0.4256s/iter; left time: 6743.8246s
	iters: 200, epoch: 17 | loss: 0.0000066
	speed: 0.0614s/iter; left time: 967.4722s
	iters: 300, epoch: 17 | loss: 0.0104926
	speed: 0.0630s/iter; left time: 985.6807s
	iters: 400, epoch: 17 | loss: 0.0001563
	speed: 0.0582s/iter; left time: 904.8499s
Epoch: 17 cost time: 29.64888596534729
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.287 Vali Acc: 0.971 Test Loss: 0.287 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000062
	speed: 0.4262s/iter; left time: 6553.7991s
	iters: 200, epoch: 18 | loss: 0.0000532
	speed: 0.0781s/iter; left time: 1192.7178s
	iters: 300, epoch: 18 | loss: 0.0092017
	speed: 0.0740s/iter; left time: 1123.0889s
	iters: 400, epoch: 18 | loss: 0.0007400
	speed: 0.0780s/iter; left time: 1176.5043s
Epoch: 18 cost time: 36.551573753356934
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.978 Test Loss: 0.183 Test Acc: 0.978
Validation loss decreased (-0.975984 --> -0.977986).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000006
	speed: 0.4457s/iter; left time: 6644.2305s
	iters: 200, epoch: 19 | loss: 0.0001060
	speed: 0.0805s/iter; left time: 1191.4114s
	iters: 300, epoch: 19 | loss: 0.0012370
	speed: 0.0720s/iter; left time: 1059.6572s
	iters: 400, epoch: 19 | loss: 0.0449767
	speed: 0.0712s/iter; left time: 1040.0294s
Epoch: 19 cost time: 35.73374891281128
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.971 Test Loss: 0.242 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000800
	speed: 0.4273s/iter; left time: 6170.8037s
	iters: 200, epoch: 20 | loss: 0.0000555
	speed: 0.0704s/iter; left time: 1009.7922s
	iters: 300, epoch: 20 | loss: 0.0000148
	speed: 0.0701s/iter; left time: 998.2793s
	iters: 400, epoch: 20 | loss: 0.0000009
	speed: 0.0705s/iter; left time: 996.9419s
Epoch: 20 cost time: 32.86049151420593
Epoch: 20, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.974 Test Loss: 0.188 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000012
	speed: 0.4046s/iter; left time: 5652.1044s
	iters: 200, epoch: 21 | loss: 0.0010880
	speed: 0.0751s/iter; left time: 1041.4610s
	iters: 300, epoch: 21 | loss: 0.0821961
	speed: 0.0716s/iter; left time: 985.9163s
	iters: 400, epoch: 21 | loss: 0.0000114
	speed: 0.0692s/iter; left time: 946.1814s
Epoch: 21 cost time: 33.932690382003784
Epoch: 21, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0001594
	speed: 0.4217s/iter; left time: 5693.5964s
	iters: 200, epoch: 22 | loss: 0.0000041
	speed: 0.0749s/iter; left time: 1004.3904s
	iters: 300, epoch: 22 | loss: 0.0124587
	speed: 0.0722s/iter; left time: 960.2428s
	iters: 400, epoch: 22 | loss: 0.9821409
	speed: 0.0751s/iter; left time: 991.7696s
Epoch: 22 cost time: 35.49517226219177
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.284 Vali Acc: 0.971 Test Loss: 0.284 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000035
	speed: 0.4156s/iter; left time: 5416.4487s
	iters: 200, epoch: 23 | loss: 0.0558129
	speed: 0.0653s/iter; left time: 844.0854s
	iters: 300, epoch: 23 | loss: 0.0000013
	speed: 0.0707s/iter; left time: 907.5000s
	iters: 400, epoch: 23 | loss: 0.0910604
	speed: 0.0724s/iter; left time: 921.5215s
Epoch: 23 cost time: 32.55638909339905
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.268 Vali Acc: 0.967 Test Loss: 0.268 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000086
	speed: 0.3926s/iter; left time: 4932.3836s
	iters: 200, epoch: 24 | loss: 0.0008004
	speed: 0.0683s/iter; left time: 850.7957s
	iters: 300, epoch: 24 | loss: 0.0000045
	speed: 0.0718s/iter; left time: 888.3441s
	iters: 400, epoch: 24 | loss: 0.0007580
	speed: 0.0760s/iter; left time: 932.0920s
Epoch: 24 cost time: 33.97179865837097
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0002048
	speed: 0.3959s/iter; left time: 4787.9355s
	iters: 200, epoch: 25 | loss: 0.0009708
	speed: 0.0711s/iter; left time: 853.4329s
	iters: 300, epoch: 25 | loss: 0.0015564
	speed: 0.0734s/iter; left time: 872.7653s
	iters: 400, epoch: 25 | loss: 0.0001219
	speed: 0.0741s/iter; left time: 874.4509s
Epoch: 25 cost time: 34.47373032569885
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.978 Test Loss: 0.242 Test Acc: 0.978
Validation loss decreased (-0.977986 --> -0.978271).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000167
	speed: 0.4147s/iter; left time: 4821.1306s
	iters: 200, epoch: 26 | loss: 0.0015510
	speed: 0.0671s/iter; left time: 773.6227s
	iters: 300, epoch: 26 | loss: 0.0000007
	speed: 0.0644s/iter; left time: 735.9746s
	iters: 400, epoch: 26 | loss: 0.0000397
	speed: 0.0662s/iter; left time: 750.3318s
Epoch: 26 cost time: 32.34730505943298
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.280 Vali Acc: 0.977 Test Loss: 0.280 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0008627
	speed: 0.4302s/iter; left time: 4800.2814s
	iters: 200, epoch: 27 | loss: 0.0000677
	speed: 0.0752s/iter; left time: 831.1609s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.0668s/iter; left time: 731.4858s
	iters: 400, epoch: 27 | loss: 0.0000665
	speed: 0.0618s/iter; left time: 670.4503s
Epoch: 27 cost time: 32.82662844657898
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.368 Vali Acc: 0.967 Test Loss: 0.368 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0000143
	speed: 0.3976s/iter; left time: 4249.6414s
	iters: 200, epoch: 28 | loss: 0.0000019
	speed: 0.0685s/iter; left time: 725.0838s
	iters: 300, epoch: 28 | loss: 0.0226461
	speed: 0.0692s/iter; left time: 725.6536s
	iters: 400, epoch: 28 | loss: 0.0000135
	speed: 0.0631s/iter; left time: 655.6066s
Epoch: 28 cost time: 31.76327896118164
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.290 Vali Acc: 0.978 Test Loss: 0.290 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0000010
	speed: 0.3787s/iter; left time: 3870.3023s
	iters: 200, epoch: 29 | loss: 0.0004208
	speed: 0.0649s/iter; left time: 656.4392s
	iters: 300, epoch: 29 | loss: 0.0000151
	speed: 0.0618s/iter; left time: 619.3824s
	iters: 400, epoch: 29 | loss: 0.0000760
	speed: 0.0698s/iter; left time: 692.3202s
Epoch: 29 cost time: 31.330552339553833
Epoch: 29, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.303 Vali Acc: 0.973 Test Loss: 0.303 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000165
	speed: 0.4078s/iter; left time: 3976.1750s
	iters: 200, epoch: 30 | loss: 0.0000224
	speed: 0.0677s/iter; left time: 653.6373s
	iters: 300, epoch: 30 | loss: 0.0000174
	speed: 0.0626s/iter; left time: 597.5019s
	iters: 400, epoch: 30 | loss: 0.0002292
	speed: 0.0614s/iter; left time: 580.3384s
Epoch: 30 cost time: 31.44573473930359
Epoch: 30, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.352 Vali Acc: 0.971 Test Loss: 0.352 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0002087
	speed: 0.3932s/iter; left time: 3649.0619s
	iters: 200, epoch: 31 | loss: 0.0006222
	speed: 0.0653s/iter; left time: 599.5216s
	iters: 300, epoch: 31 | loss: 0.0004008
	speed: 0.0630s/iter; left time: 571.8256s
	iters: 400, epoch: 31 | loss: 0.0000556
	speed: 0.0625s/iter; left time: 561.4253s
Epoch: 31 cost time: 31.22010588645935
Epoch: 31, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.271 Vali Acc: 0.974 Test Loss: 0.271 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0001013
	speed: 0.3906s/iter; left time: 3441.6069s
	iters: 200, epoch: 32 | loss: 0.0099462
	speed: 0.0695s/iter; left time: 605.4717s
	iters: 300, epoch: 32 | loss: 0.0000026
	speed: 0.0676s/iter; left time: 582.5559s
	iters: 400, epoch: 32 | loss: 0.0010200
	speed: 0.0654s/iter; left time: 556.6061s
Epoch: 32 cost time: 31.924862146377563
Epoch: 32, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.351 Vali Acc: 0.967 Test Loss: 0.351 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0010523
	speed: 0.4249s/iter; left time: 3545.3065s
	iters: 200, epoch: 33 | loss: 0.0000034
	speed: 0.0725s/iter; left time: 597.6169s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0719s/iter; left time: 585.7756s
	iters: 400, epoch: 33 | loss: 0.0000003
	speed: 0.0724s/iter; left time: 582.4217s
Epoch: 33 cost time: 34.73809885978699
Epoch: 33, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.301 Vali Acc: 0.977 Test Loss: 0.301 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000002
	speed: 0.3938s/iter; left time: 3100.9641s
	iters: 200, epoch: 34 | loss: 0.0000016
	speed: 0.0685s/iter; left time: 532.7378s
	iters: 300, epoch: 34 | loss: 0.0000564
	speed: 0.0659s/iter; left time: 506.0498s
	iters: 400, epoch: 34 | loss: 0.0000095
	speed: 0.0664s/iter; left time: 503.2759s
Epoch: 34 cost time: 31.505232095718384
Epoch: 34, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.262 Vali Acc: 0.977 Test Loss: 0.262 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0002018
	speed: 0.4033s/iter; left time: 2986.4310s
	iters: 200, epoch: 35 | loss: 0.0000131
	speed: 0.0639s/iter; left time: 467.0466s
	iters: 300, epoch: 35 | loss: 0.0000439
	speed: 0.0580s/iter; left time: 417.9628s
	iters: 400, epoch: 35 | loss: 0.0587921
	speed: 0.0602s/iter; left time: 427.5888s
Epoch: 35 cost time: 30.117446660995483
Epoch: 35, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.241 Vali Acc: 0.981 Test Loss: 0.241 Test Acc: 0.981
Validation loss decreased (-0.978271 --> -0.980844).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000028
	speed: 0.3964s/iter; left time: 2749.5941s
	iters: 200, epoch: 36 | loss: 0.0004077
	speed: 0.0683s/iter; left time: 466.8484s
	iters: 300, epoch: 36 | loss: 0.0010872
	speed: 0.0707s/iter; left time: 476.3693s
	iters: 400, epoch: 36 | loss: 0.0000013
	speed: 0.0722s/iter; left time: 479.1407s
Epoch: 36 cost time: 33.660775899887085
Epoch: 36, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.268 Vali Acc: 0.976 Test Loss: 0.268 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0000023
	speed: 0.4045s/iter; left time: 2615.7760s
	iters: 200, epoch: 37 | loss: 0.0064033
	speed: 0.0647s/iter; left time: 411.7195s
	iters: 300, epoch: 37 | loss: 0.0000499
	speed: 0.0678s/iter; left time: 425.0897s
	iters: 400, epoch: 37 | loss: 0.0000663
	speed: 0.0764s/iter; left time: 471.1715s
Epoch: 37 cost time: 32.86434888839722
Epoch: 37, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.277 Vali Acc: 0.973 Test Loss: 0.277 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0002294
	speed: 0.3879s/iter; left time: 2326.8597s
	iters: 200, epoch: 38 | loss: 0.0000523
	speed: 0.0699s/iter; left time: 412.1103s
	iters: 300, epoch: 38 | loss: 0.0001093
	speed: 0.0688s/iter; left time: 398.9264s
	iters: 400, epoch: 38 | loss: 0.0000029
	speed: 0.0711s/iter; left time: 405.3737s
Epoch: 38 cost time: 33.20092225074768
Epoch: 38, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.285 Vali Acc: 0.974 Test Loss: 0.285 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000103
	speed: 0.4008s/iter; left time: 2216.1823s
	iters: 200, epoch: 39 | loss: 0.0000012
	speed: 0.0623s/iter; left time: 338.1222s
	iters: 300, epoch: 39 | loss: 0.0000005
	speed: 0.0630s/iter; left time: 335.7635s
	iters: 400, epoch: 39 | loss: 0.0000057
	speed: 0.0660s/iter; left time: 345.0359s
Epoch: 39 cost time: 30.934293746948242
Epoch: 39, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.347 Vali Acc: 0.970 Test Loss: 0.347 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0000003
	speed: 0.4008s/iter; left time: 2027.9463s
	iters: 200, epoch: 40 | loss: 0.0008188
	speed: 0.0694s/iter; left time: 344.4606s
	iters: 300, epoch: 40 | loss: 0.0015225
	speed: 0.0737s/iter; left time: 358.1145s
	iters: 400, epoch: 40 | loss: 0.0000532
	speed: 0.0663s/iter; left time: 315.3725s
Epoch: 40 cost time: 32.98890256881714
Epoch: 40, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0000006
	speed: 0.3897s/iter; left time: 1788.9039s
	iters: 200, epoch: 41 | loss: 0.0000828
	speed: 0.0695s/iter; left time: 311.9782s
	iters: 300, epoch: 41 | loss: 0.0001405
	speed: 0.0677s/iter; left time: 297.3060s
	iters: 400, epoch: 41 | loss: 0.0000821
	speed: 0.0634s/iter; left time: 272.0317s
Epoch: 41 cost time: 31.506959199905396
Epoch: 41, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.347 Vali Acc: 0.974 Test Loss: 0.347 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0000411
	speed: 0.3857s/iter; left time: 1589.8193s
	iters: 200, epoch: 42 | loss: 0.0000127
	speed: 0.0683s/iter; left time: 274.5178s
	iters: 300, epoch: 42 | loss: 0.0035528
	speed: 0.0684s/iter; left time: 268.2121s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0702s/iter; left time: 268.3785s
Epoch: 42 cost time: 33.0449960231781
Epoch: 42, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.252 Vali Acc: 0.976 Test Loss: 0.252 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0000925
	speed: 0.3799s/iter; left time: 1387.6059s
	iters: 200, epoch: 43 | loss: 0.0001141
	speed: 0.0692s/iter; left time: 245.8178s
	iters: 300, epoch: 43 | loss: 0.0000618
	speed: 0.0679s/iter; left time: 234.6297s
	iters: 400, epoch: 43 | loss: 0.0000014
	speed: 0.0690s/iter; left time: 231.2045s
Epoch: 43 cost time: 32.33559560775757
Epoch: 43, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.977 Test Loss: 0.285 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0000004
	speed: 0.3744s/iter; left time: 1192.1980s
	iters: 200, epoch: 44 | loss: 0.0001221
	speed: 0.0670s/iter; left time: 206.4866s
	iters: 300, epoch: 44 | loss: 0.0000004
	speed: 0.0650s/iter; left time: 194.0661s
	iters: 400, epoch: 44 | loss: 0.0000000
	speed: 0.0633s/iter; left time: 182.4454s
Epoch: 44 cost time: 30.56445598602295
Epoch: 44, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.978 Test Loss: 0.295 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0000001
	speed: 0.3619s/iter; left time: 982.6412s
	iters: 200, epoch: 45 | loss: 0.0000015
	speed: 0.0654s/iter; left time: 171.0169s
	iters: 300, epoch: 45 | loss: 0.0000000
	speed: 0.0674s/iter; left time: 169.4757s
	iters: 400, epoch: 45 | loss: 0.0006447
	speed: 0.0687s/iter; left time: 165.8649s
Epoch: 45 cost time: 31.767162084579468
Epoch: 45, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.257 Vali Acc: 0.979 Test Loss: 0.257 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 373706
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7445823
	speed: 0.0736s/iter; left time: 1718.6668s
	iters: 200, epoch: 1 | loss: 0.9757059
	speed: 0.0539s/iter; left time: 1252.2754s
	iters: 300, epoch: 1 | loss: 0.2711311
	speed: 0.0537s/iter; left time: 1242.4549s
	iters: 400, epoch: 1 | loss: 0.1333307
	speed: 0.0500s/iter; left time: 1151.4807s
Epoch: 1 cost time: 26.762713193893433
Epoch: 1, Steps: 469 | Train Loss: 0.875 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
Validation loss decreased (inf --> -0.925097).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1233402
	speed: 0.3096s/iter; left time: 7083.9313s
	iters: 200, epoch: 2 | loss: 0.1044033
	speed: 0.0511s/iter; left time: 1163.3051s
	iters: 300, epoch: 2 | loss: 0.0608519
	speed: 0.0541s/iter; left time: 1227.2429s
	iters: 400, epoch: 2 | loss: 0.0023891
	speed: 0.0514s/iter; left time: 1161.4905s
Epoch: 2 cost time: 24.876166582107544
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.925097 --> -0.963120).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0153966
	speed: 0.3338s/iter; left time: 7482.0363s
	iters: 200, epoch: 3 | loss: 0.0916241
	speed: 0.0557s/iter; left time: 1243.6933s
	iters: 300, epoch: 3 | loss: 0.0471395
	speed: 0.0553s/iter; left time: 1228.5901s
	iters: 400, epoch: 3 | loss: 0.2341221
	speed: 0.0528s/iter; left time: 1166.8140s
Epoch: 3 cost time: 26.234570741653442
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
Validation loss decreased (-0.963120 --> -0.970839).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0013306
	speed: 0.3323s/iter; left time: 7292.4970s
	iters: 200, epoch: 4 | loss: 0.0487124
	speed: 0.0532s/iter; left time: 1161.1055s
	iters: 300, epoch: 4 | loss: 0.0014028
	speed: 0.0584s/iter; left time: 1270.6445s
	iters: 400, epoch: 4 | loss: 0.1615869
	speed: 0.0549s/iter; left time: 1189.3249s
Epoch: 4 cost time: 26.51967477798462
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.970839 --> -0.975985).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0132366
	speed: 0.3351s/iter; left time: 7197.2025s
	iters: 200, epoch: 5 | loss: 0.0025474
	speed: 0.0529s/iter; left time: 1130.1161s
	iters: 300, epoch: 5 | loss: 0.0003467
	speed: 0.0548s/iter; left time: 1165.4362s
	iters: 400, epoch: 5 | loss: 0.0180621
	speed: 0.0540s/iter; left time: 1142.9123s
Epoch: 5 cost time: 25.438282012939453
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.961 Test Loss: 0.241 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0011070
	speed: 0.3147s/iter; left time: 6610.9473s
	iters: 200, epoch: 6 | loss: 0.0007148
	speed: 0.0528s/iter; left time: 1102.9476s
	iters: 300, epoch: 6 | loss: 0.0257375
	speed: 0.0493s/iter; left time: 1025.0769s
	iters: 400, epoch: 6 | loss: 0.0120493
	speed: 0.0545s/iter; left time: 1128.1804s
Epoch: 6 cost time: 24.81807804107666
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0003811
	speed: 0.3364s/iter; left time: 6909.0058s
	iters: 200, epoch: 7 | loss: 0.0010100
	speed: 0.0542s/iter; left time: 1107.0430s
	iters: 300, epoch: 7 | loss: 0.0068708
	speed: 0.0517s/iter; left time: 1051.4594s
	iters: 400, epoch: 7 | loss: 0.0008680
	speed: 0.0554s/iter; left time: 1120.9212s
Epoch: 7 cost time: 25.169957876205444
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0118584
	speed: 0.3251s/iter; left time: 6524.5158s
	iters: 200, epoch: 8 | loss: 0.5899699
	speed: 0.0539s/iter; left time: 1076.1863s
	iters: 300, epoch: 8 | loss: 0.0003027
	speed: 0.0519s/iter; left time: 1031.2825s
	iters: 400, epoch: 8 | loss: 0.0012435
	speed: 0.0572s/iter; left time: 1130.1002s
Epoch: 8 cost time: 25.40177869796753
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.978272).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0039418
	speed: 0.3189s/iter; left time: 6250.3786s
	iters: 200, epoch: 9 | loss: 0.3386526
	speed: 0.0530s/iter; left time: 1033.0960s
	iters: 300, epoch: 9 | loss: 0.0128885
	speed: 0.0511s/iter; left time: 991.2033s
	iters: 400, epoch: 9 | loss: 0.0939345
	speed: 0.0531s/iter; left time: 1024.0030s
Epoch: 9 cost time: 25.212485790252686
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0013461
	speed: 0.3146s/iter; left time: 6018.7610s
	iters: 200, epoch: 10 | loss: 0.0004498
	speed: 0.0417s/iter; left time: 794.0741s
	iters: 300, epoch: 10 | loss: 0.0002490
	speed: 0.0422s/iter; left time: 799.0927s
	iters: 400, epoch: 10 | loss: 0.0001851
	speed: 0.0427s/iter; left time: 803.8133s
Epoch: 10 cost time: 21.276585340499878
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0203953
	speed: 0.3101s/iter; left time: 5787.1432s
	iters: 200, epoch: 11 | loss: 0.0006940
	speed: 0.0496s/iter; left time: 919.8560s
	iters: 300, epoch: 11 | loss: 0.0083467
	speed: 0.0475s/iter; left time: 877.2909s
	iters: 400, epoch: 11 | loss: 0.0013202
	speed: 0.0438s/iter; left time: 803.9990s
Epoch: 11 cost time: 22.94215726852417
Epoch: 11, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0005733
	speed: 0.3083s/iter; left time: 5608.3649s
	iters: 200, epoch: 12 | loss: 0.0001113
	speed: 0.0429s/iter; left time: 775.7205s
	iters: 300, epoch: 12 | loss: 0.0001006
	speed: 0.0432s/iter; left time: 777.9703s
	iters: 400, epoch: 12 | loss: 0.0158409
	speed: 0.0459s/iter; left time: 820.9676s
Epoch: 12 cost time: 21.334851026535034
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0061181
	speed: 0.2644s/iter; left time: 4686.3557s
	iters: 200, epoch: 13 | loss: 0.0123603
	speed: 0.0463s/iter; left time: 815.7252s
	iters: 300, epoch: 13 | loss: 0.0003901
	speed: 0.0431s/iter; left time: 754.9671s
	iters: 400, epoch: 13 | loss: 0.0000192
	speed: 0.0452s/iter; left time: 787.8637s
Epoch: 13 cost time: 21.157350540161133
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0003753
	speed: 0.3015s/iter; left time: 5202.9242s
	iters: 200, epoch: 14 | loss: 0.0005312
	speed: 0.0500s/iter; left time: 857.6719s
	iters: 300, epoch: 14 | loss: 0.0344368
	speed: 0.0493s/iter; left time: 839.9377s
	iters: 400, epoch: 14 | loss: 0.0002617
	speed: 0.0498s/iter; left time: 843.8029s
Epoch: 14 cost time: 23.784618377685547
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0014110
	speed: 0.2990s/iter; left time: 5018.9419s
	iters: 200, epoch: 15 | loss: 0.0010934
	speed: 0.0484s/iter; left time: 807.5678s
	iters: 300, epoch: 15 | loss: 0.0002377
	speed: 0.0486s/iter; left time: 806.1436s
	iters: 400, epoch: 15 | loss: 0.0010147
	speed: 0.0477s/iter; left time: 787.0153s
Epoch: 15 cost time: 23.232946634292603
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0024199
	speed: 0.3041s/iter; left time: 4961.2588s
	iters: 200, epoch: 16 | loss: 0.0000506
	speed: 0.0522s/iter; left time: 846.7905s
	iters: 300, epoch: 16 | loss: 0.0013115
	speed: 0.0499s/iter; left time: 804.6542s
	iters: 400, epoch: 16 | loss: 0.0006355
	speed: 0.0491s/iter; left time: 786.9683s
Epoch: 16 cost time: 24.20525884628296
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0005283
	speed: 0.2772s/iter; left time: 4393.4048s
	iters: 200, epoch: 17 | loss: 0.0061172
	speed: 0.0431s/iter; left time: 679.1295s
	iters: 300, epoch: 17 | loss: 0.0019865
	speed: 0.0444s/iter; left time: 694.7261s
	iters: 400, epoch: 17 | loss: 0.0000929
	speed: 0.0492s/iter; left time: 764.9639s
Epoch: 17 cost time: 21.68514108657837
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0274074
	speed: 0.2939s/iter; left time: 4519.0573s
	iters: 200, epoch: 18 | loss: 0.0000562
	speed: 0.0443s/iter; left time: 677.5511s
	iters: 300, epoch: 18 | loss: 0.0000231
	speed: 0.0484s/iter; left time: 733.9575s
	iters: 400, epoch: 18 | loss: 0.0142291
	speed: 0.0495s/iter; left time: 746.4322s
Epoch: 18 cost time: 22.769503116607666
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 100810
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3380246
	speed: 0.0759s/iter; left time: 1771.5654s
	iters: 200, epoch: 1 | loss: 0.6358418
	speed: 0.0550s/iter; left time: 1278.6944s
	iters: 300, epoch: 1 | loss: 0.1984451
	speed: 0.0529s/iter; left time: 1224.1539s
	iters: 400, epoch: 1 | loss: 0.1813694
	speed: 0.0502s/iter; left time: 1156.1542s
Epoch: 1 cost time: 26.530972719192505
Epoch: 1, Steps: 469 | Train Loss: 0.735 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (inf --> -0.919094).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1113418
	speed: 0.2869s/iter; left time: 6565.0687s
	iters: 200, epoch: 2 | loss: 0.0683779
	speed: 0.0518s/iter; left time: 1179.5660s
	iters: 300, epoch: 2 | loss: 0.0103889
	speed: 0.0508s/iter; left time: 1152.5123s
	iters: 400, epoch: 2 | loss: 0.0274127
	speed: 0.0517s/iter; left time: 1167.4314s
Epoch: 2 cost time: 24.90626311302185
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
Validation loss decreased (-0.919094 --> -0.963406).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0132186
	speed: 0.3051s/iter; left time: 6838.5017s
	iters: 200, epoch: 3 | loss: 0.0135451
	speed: 0.0520s/iter; left time: 1161.3914s
	iters: 300, epoch: 3 | loss: 0.0381059
	speed: 0.0477s/iter; left time: 1059.2275s
	iters: 400, epoch: 3 | loss: 0.0085280
	speed: 0.0506s/iter; left time: 1118.9582s
Epoch: 3 cost time: 24.252230167388916
Epoch: 3, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.963406 --> -0.971983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0185312
	speed: 0.3023s/iter; left time: 6632.6824s
	iters: 200, epoch: 4 | loss: 0.2850378
	speed: 0.0507s/iter; left time: 1107.7715s
	iters: 300, epoch: 4 | loss: 0.0076261
	speed: 0.0541s/iter; left time: 1176.9463s
	iters: 400, epoch: 4 | loss: 0.0161361
	speed: 0.0544s/iter; left time: 1177.1655s
Epoch: 4 cost time: 25.249186038970947
Epoch: 4, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0519104
	speed: 0.2914s/iter; left time: 6257.1621s
	iters: 200, epoch: 5 | loss: 0.0036307
	speed: 0.0496s/iter; left time: 1060.2080s
	iters: 300, epoch: 5 | loss: 0.1508786
	speed: 0.0500s/iter; left time: 1064.4041s
	iters: 400, epoch: 5 | loss: 0.0507135
	speed: 0.0528s/iter; left time: 1118.5088s
Epoch: 5 cost time: 23.73236632347107
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.971983 --> -0.974555).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0004534
	speed: 0.2870s/iter; left time: 6028.7966s
	iters: 200, epoch: 6 | loss: 0.0016912
	speed: 0.0487s/iter; left time: 1018.7319s
	iters: 300, epoch: 6 | loss: 0.0052875
	speed: 0.0490s/iter; left time: 1020.4910s
	iters: 400, epoch: 6 | loss: 0.0002342
	speed: 0.0496s/iter; left time: 1027.5629s
Epoch: 6 cost time: 23.555431127548218
Epoch: 6, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
Validation loss decreased (-0.974555 --> -0.976271).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0199190
	speed: 0.2972s/iter; left time: 6102.8405s
	iters: 200, epoch: 7 | loss: 0.0005713
	speed: 0.0457s/iter; left time: 934.2738s
	iters: 300, epoch: 7 | loss: 0.0126411
	speed: 0.0477s/iter; left time: 970.9799s
	iters: 400, epoch: 7 | loss: 0.0011893
	speed: 0.0497s/iter; left time: 1005.1577s
Epoch: 7 cost time: 23.340071201324463
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.195 Vali Acc: 0.972 Test Loss: 0.195 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0016197
	speed: 0.3033s/iter; left time: 6087.2063s
	iters: 200, epoch: 8 | loss: 0.0002877
	speed: 0.0494s/iter; left time: 985.7274s
	iters: 300, epoch: 8 | loss: 0.0026776
	speed: 0.0508s/iter; left time: 1010.0902s
	iters: 400, epoch: 8 | loss: 0.0055800
	speed: 0.0504s/iter; left time: 995.7941s
Epoch: 8 cost time: 23.92523717880249
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0013326
	speed: 0.3072s/iter; left time: 6020.9627s
	iters: 200, epoch: 9 | loss: 0.0070164
	speed: 0.0432s/iter; left time: 842.6589s
	iters: 300, epoch: 9 | loss: 0.0003458
	speed: 0.0431s/iter; left time: 835.8011s
	iters: 400, epoch: 9 | loss: 0.0038499
	speed: 0.0450s/iter; left time: 868.2882s
Epoch: 9 cost time: 22.442210912704468
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.978844).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0005252
	speed: 0.3051s/iter; left time: 5836.1747s
	iters: 200, epoch: 10 | loss: 0.0005977
	speed: 0.0518s/iter; left time: 986.0708s
	iters: 300, epoch: 10 | loss: 0.0009068
	speed: 0.0500s/iter; left time: 946.4529s
	iters: 400, epoch: 10 | loss: 0.0005567
	speed: 0.0543s/iter; left time: 1021.7836s
Epoch: 10 cost time: 25.034216165542603
Epoch: 10, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0003310
	speed: 0.3216s/iter; left time: 6001.5973s
	iters: 200, epoch: 11 | loss: 0.2367270
	speed: 0.0516s/iter; left time: 957.9452s
	iters: 300, epoch: 11 | loss: 0.0016766
	speed: 0.0496s/iter; left time: 916.5741s
	iters: 400, epoch: 11 | loss: 0.0763516
	speed: 0.0491s/iter; left time: 902.1307s
Epoch: 11 cost time: 24.749909162521362
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0002671
	speed: 0.3213s/iter; left time: 5845.7737s
	iters: 200, epoch: 12 | loss: 0.0002984
	speed: 0.0509s/iter; left time: 920.3240s
	iters: 300, epoch: 12 | loss: 0.0204878
	speed: 0.0493s/iter; left time: 886.3245s
	iters: 400, epoch: 12 | loss: 0.0011080
	speed: 0.0492s/iter; left time: 880.1327s
Epoch: 12 cost time: 24.442596197128296
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000993
	speed: 0.3213s/iter; left time: 5694.4123s
	iters: 200, epoch: 13 | loss: 0.0007238
	speed: 0.0563s/iter; left time: 992.8805s
	iters: 300, epoch: 13 | loss: 0.0005413
	speed: 0.0555s/iter; left time: 972.3339s
	iters: 400, epoch: 13 | loss: 0.0014125
	speed: 0.0574s/iter; left time: 999.7795s
Epoch: 13 cost time: 27.23323106765747
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0044478
	speed: 0.3254s/iter; left time: 5614.3082s
	iters: 200, epoch: 14 | loss: 0.0010960
	speed: 0.0581s/iter; left time: 995.9527s
	iters: 300, epoch: 14 | loss: 0.0008774
	speed: 0.0601s/iter; left time: 1025.0057s
	iters: 400, epoch: 14 | loss: 0.0095500
	speed: 0.0517s/iter; left time: 877.1665s
Epoch: 14 cost time: 27.09108567237854
Epoch: 14, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.973 Test Loss: 0.202 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0010441
	speed: 0.3107s/iter; left time: 5215.5643s
	iters: 200, epoch: 15 | loss: 0.0000235
	speed: 0.0527s/iter; left time: 879.1438s
	iters: 300, epoch: 15 | loss: 0.0012630
	speed: 0.0530s/iter; left time: 878.5228s
	iters: 400, epoch: 15 | loss: 0.0002014
	speed: 0.0526s/iter; left time: 867.7345s
Epoch: 15 cost time: 25.30337691307068
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0003880
	speed: 0.3117s/iter; left time: 5085.2639s
	iters: 200, epoch: 16 | loss: 0.0021225
	speed: 0.0562s/iter; left time: 911.7390s
	iters: 300, epoch: 16 | loss: 0.0062281
	speed: 0.0573s/iter; left time: 923.2065s
	iters: 400, epoch: 16 | loss: 0.0001388
	speed: 0.0539s/iter; left time: 862.9484s
Epoch: 16 cost time: 26.265239715576172
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0003907
	speed: 0.3186s/iter; left time: 5049.4944s
	iters: 200, epoch: 17 | loss: 0.0006972
	speed: 0.0541s/iter; left time: 852.6476s
	iters: 300, epoch: 17 | loss: 0.0012954
	speed: 0.0543s/iter; left time: 849.3593s
	iters: 400, epoch: 17 | loss: 0.0071178
	speed: 0.0520s/iter; left time: 807.9272s
Epoch: 17 cost time: 25.485851764678955
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0029163
	speed: 0.2926s/iter; left time: 4498.9408s
	iters: 200, epoch: 18 | loss: 0.0311741
	speed: 0.0518s/iter; left time: 791.8851s
	iters: 300, epoch: 18 | loss: 0.0004105
	speed: 0.0541s/iter; left time: 820.9833s
	iters: 400, epoch: 18 | loss: 0.0124520
	speed: 0.0546s/iter; left time: 823.3933s
Epoch: 18 cost time: 25.348912715911865
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0001359
	speed: 0.2948s/iter; left time: 4394.9963s
	iters: 200, epoch: 19 | loss: 0.0000175
	speed: 0.0520s/iter; left time: 770.4811s
	iters: 300, epoch: 19 | loss: 0.0000182
	speed: 0.0489s/iter; left time: 719.5245s
	iters: 400, epoch: 19 | loss: 0.0000522
	speed: 0.0544s/iter; left time: 795.0637s
Epoch: 19 cost time: 24.79822301864624
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 100842
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1479722
	speed: 0.1089s/iter; left time: 2543.5028s
	iters: 200, epoch: 1 | loss: 0.8735563
	speed: 0.0886s/iter; left time: 2059.3486s
	iters: 300, epoch: 1 | loss: 0.1100832
	speed: 0.0857s/iter; left time: 1983.4082s
	iters: 400, epoch: 1 | loss: 0.0622332
	speed: 0.0821s/iter; left time: 1892.9885s
Epoch: 1 cost time: 42.14491629600525
Epoch: 1, Steps: 469 | Train Loss: 0.369 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (inf --> -0.950255).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2504369
	speed: 0.4281s/iter; left time: 9794.8628s
	iters: 200, epoch: 2 | loss: 0.0078997
	speed: 0.0811s/iter; left time: 1848.5263s
	iters: 300, epoch: 2 | loss: 0.0134074
	speed: 0.0850s/iter; left time: 1928.2003s
	iters: 400, epoch: 2 | loss: 0.0069370
	speed: 0.0904s/iter; left time: 2041.2802s
Epoch: 2 cost time: 39.97368574142456
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4788347
	speed: 0.4282s/iter; left time: 9596.5452s
	iters: 200, epoch: 3 | loss: 0.0003786
	speed: 0.0895s/iter; left time: 1996.8993s
	iters: 300, epoch: 3 | loss: 0.0033985
	speed: 0.0871s/iter; left time: 1934.5624s
	iters: 400, epoch: 3 | loss: 0.0513074
	speed: 0.0844s/iter; left time: 1865.7103s
Epoch: 3 cost time: 40.27238321304321
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.205 Vali Acc: 0.965 Test Loss: 0.205 Test Acc: 0.965
Validation loss decreased (-0.950255 --> -0.964549).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0033285
	speed: 0.3753s/iter; left time: 8234.6256s
	iters: 200, epoch: 4 | loss: 0.0002726
	speed: 0.0768s/iter; left time: 1676.8284s
	iters: 300, epoch: 4 | loss: 0.0084162
	speed: 0.0902s/iter; left time: 1962.1586s
	iters: 400, epoch: 4 | loss: 0.0925871
	speed: 0.0906s/iter; left time: 1960.2562s
Epoch: 4 cost time: 39.213730812072754
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.188 Vali Acc: 0.964 Test Loss: 0.188 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0036461
	speed: 0.4447s/iter; left time: 9549.8282s
	iters: 200, epoch: 5 | loss: 0.0000062
	speed: 0.0900s/iter; left time: 1924.3388s
	iters: 300, epoch: 5 | loss: 0.0039036
	speed: 0.0856s/iter; left time: 1820.2971s
	iters: 400, epoch: 5 | loss: 0.0033518
	speed: 0.0805s/iter; left time: 1704.1374s
Epoch: 5 cost time: 40.86940288543701
Epoch: 5, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.319 Vali Acc: 0.945 Test Loss: 0.319 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0001725
	speed: 0.4197s/iter; left time: 8815.3580s
	iters: 200, epoch: 6 | loss: 0.1023539
	speed: 0.0785s/iter; left time: 1640.1090s
	iters: 300, epoch: 6 | loss: 0.0013059
	speed: 0.0891s/iter; left time: 1854.7547s
	iters: 400, epoch: 6 | loss: 0.0001395
	speed: 0.0923s/iter; left time: 1910.4613s
Epoch: 6 cost time: 40.418702125549316
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
Validation loss decreased (-0.964549 --> -0.964835).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005460
	speed: 0.4405s/iter; left time: 9046.1015s
	iters: 200, epoch: 7 | loss: 0.4934915
	speed: 0.0823s/iter; left time: 1681.9542s
	iters: 300, epoch: 7 | loss: 0.0004748
	speed: 0.0785s/iter; left time: 1597.2701s
	iters: 400, epoch: 7 | loss: 0.0000023
	speed: 0.0804s/iter; left time: 1627.8609s
Epoch: 7 cost time: 38.56906342506409
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.0693164
	speed: 0.4144s/iter; left time: 8315.2212s
	iters: 200, epoch: 8 | loss: 0.5598176
	speed: 0.0790s/iter; left time: 1578.3173s
	iters: 300, epoch: 8 | loss: 0.0297470
	speed: 0.0806s/iter; left time: 1601.8282s
	iters: 400, epoch: 8 | loss: 0.0000107
	speed: 0.0820s/iter; left time: 1621.3177s
Epoch: 8 cost time: 38.44978475570679
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.206 Vali Acc: 0.965 Test Loss: 0.206 Test Acc: 0.965
Validation loss decreased (-0.964835 --> -0.965121).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003171
	speed: 0.4182s/iter; left time: 8196.1260s
	iters: 200, epoch: 9 | loss: 0.0000012
	speed: 0.0833s/iter; left time: 1623.5524s
	iters: 300, epoch: 9 | loss: 0.0001435
	speed: 0.0864s/iter; left time: 1676.1668s
	iters: 400, epoch: 9 | loss: 0.0187594
	speed: 0.0854s/iter; left time: 1648.2690s
Epoch: 9 cost time: 39.1495099067688
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
Validation loss decreased (-0.965121 --> -0.966550).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3967094
	speed: 0.4261s/iter; left time: 8151.8790s
	iters: 200, epoch: 10 | loss: 0.0136617
	speed: 0.0819s/iter; left time: 1557.6507s
	iters: 300, epoch: 10 | loss: 0.0030033
	speed: 0.0817s/iter; left time: 1545.7754s
	iters: 400, epoch: 10 | loss: 0.0359037
	speed: 0.0889s/iter; left time: 1673.3913s
Epoch: 10 cost time: 40.5247323513031
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
Validation loss decreased (-0.966550 --> -0.982560).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0196588
	speed: 0.4264s/iter; left time: 7957.3135s
	iters: 200, epoch: 11 | loss: 0.0012446
	speed: 0.0832s/iter; left time: 1544.0155s
	iters: 300, epoch: 11 | loss: 0.0000021
	speed: 0.0828s/iter; left time: 1528.2513s
	iters: 400, epoch: 11 | loss: 0.0185843
	speed: 0.0773s/iter; left time: 1418.5816s
Epoch: 11 cost time: 38.4887855052948
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004321
	speed: 0.3996s/iter; left time: 7270.2249s
	iters: 200, epoch: 12 | loss: 0.0118209
	speed: 0.0739s/iter; left time: 1337.6285s
	iters: 300, epoch: 12 | loss: 0.0000920
	speed: 0.0754s/iter; left time: 1356.3215s
	iters: 400, epoch: 12 | loss: 0.0125004
	speed: 0.0797s/iter; left time: 1425.7978s
Epoch: 12 cost time: 36.80889415740967
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000668
	speed: 0.4285s/iter; left time: 7593.9728s
	iters: 200, epoch: 13 | loss: 0.0010621
	speed: 0.0849s/iter; left time: 1496.4653s
	iters: 300, epoch: 13 | loss: 0.0000014
	speed: 0.0762s/iter; left time: 1334.7665s
	iters: 400, epoch: 13 | loss: 0.0000110
	speed: 0.0776s/iter; left time: 1351.9480s
Epoch: 13 cost time: 38.671273708343506
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.230 Vali Acc: 0.967 Test Loss: 0.230 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000204
	speed: 0.4342s/iter; left time: 7492.4325s
	iters: 200, epoch: 14 | loss: 0.0000031
	speed: 0.0851s/iter; left time: 1460.2386s
	iters: 300, epoch: 14 | loss: 0.0106927
	speed: 0.0764s/iter; left time: 1303.3243s
	iters: 400, epoch: 14 | loss: 0.0173219
	speed: 0.0807s/iter; left time: 1367.6117s
Epoch: 14 cost time: 39.27877449989319
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000020
	speed: 0.4129s/iter; left time: 6930.9803s
	iters: 200, epoch: 15 | loss: 0.0037339
	speed: 0.0846s/iter; left time: 1410.9942s
	iters: 300, epoch: 15 | loss: 0.0030649
	speed: 0.0744s/iter; left time: 1234.5928s
	iters: 400, epoch: 15 | loss: 0.0000478
	speed: 0.0683s/iter; left time: 1125.3431s
Epoch: 15 cost time: 37.01442193984985
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.292 Vali Acc: 0.968 Test Loss: 0.292 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0001816
	speed: 0.4083s/iter; left time: 6661.4374s
	iters: 200, epoch: 16 | loss: 0.0000439
	speed: 0.0727s/iter; left time: 1179.2315s
	iters: 300, epoch: 16 | loss: 0.0426343
	speed: 0.0742s/iter; left time: 1196.1360s
	iters: 400, epoch: 16 | loss: 0.0000034
	speed: 0.0787s/iter; left time: 1259.8580s
Epoch: 16 cost time: 36.52765440940857
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000360
	speed: 0.4131s/iter; left time: 6546.7383s
	iters: 200, epoch: 17 | loss: 0.0001988
	speed: 0.0821s/iter; left time: 1292.8359s
	iters: 300, epoch: 17 | loss: 0.0000879
	speed: 0.0837s/iter; left time: 1309.4204s
	iters: 400, epoch: 17 | loss: 0.0000910
	speed: 0.0814s/iter; left time: 1265.4280s
Epoch: 17 cost time: 38.66739010810852
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.976 Test Loss: 0.194 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000764
	speed: 0.4238s/iter; left time: 6517.5234s
	iters: 200, epoch: 18 | loss: 0.0000226
	speed: 0.0740s/iter; left time: 1130.0596s
	iters: 300, epoch: 18 | loss: 0.0055066
	speed: 0.0695s/iter; left time: 1055.3155s
	iters: 400, epoch: 18 | loss: 0.0000033
	speed: 0.0754s/iter; left time: 1136.4428s
Epoch: 18 cost time: 36.19374227523804
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2672181
	speed: 0.4365s/iter; left time: 6508.1636s
	iters: 200, epoch: 19 | loss: 0.0000906
	speed: 0.0897s/iter; left time: 1328.0036s
	iters: 300, epoch: 19 | loss: 0.4216824
	speed: 0.0851s/iter; left time: 1251.7386s
	iters: 400, epoch: 19 | loss: 0.0009974
	speed: 0.0843s/iter; left time: 1232.0907s
Epoch: 19 cost time: 40.59570574760437
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.238 Vali Acc: 0.966 Test Loss: 0.238 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000032
	speed: 0.4200s/iter; left time: 6065.2740s
	iters: 200, epoch: 20 | loss: 0.7718053
	speed: 0.0788s/iter; left time: 1130.4040s
	iters: 300, epoch: 20 | loss: 0.2157021
	speed: 0.0814s/iter; left time: 1159.0406s
	iters: 400, epoch: 20 | loss: 0.0018078
	speed: 0.0787s/iter; left time: 1112.7715s
Epoch: 20 cost time: 38.33910298347473
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.251 Vali Acc: 0.971 Test Loss: 0.251 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 1432330
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4656289
	speed: 0.1093s/iter; left time: 2551.6848s
	iters: 200, epoch: 1 | loss: 0.2379197
	speed: 0.0886s/iter; left time: 2060.7857s
	iters: 300, epoch: 1 | loss: 0.0533361
	speed: 0.0907s/iter; left time: 2099.1344s
	iters: 400, epoch: 1 | loss: 0.1339427
	speed: 0.0927s/iter; left time: 2137.1504s
Epoch: 1 cost time: 44.96502947807312
Epoch: 1, Steps: 469 | Train Loss: 0.379 Vali Loss: 0.199 Vali Acc: 0.955 Test Loss: 0.199 Test Acc: 0.955
Validation loss decreased (inf --> -0.955401).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0091417
	speed: 0.4363s/iter; left time: 9982.9877s
	iters: 200, epoch: 2 | loss: 0.0398810
	speed: 0.0897s/iter; left time: 2042.9627s
	iters: 300, epoch: 2 | loss: 0.0430142
	speed: 0.0928s/iter; left time: 2104.4068s
	iters: 400, epoch: 2 | loss: 0.0146572
	speed: 0.0945s/iter; left time: 2134.6562s
Epoch: 2 cost time: 43.35503625869751
Epoch: 2, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.955401 --> -0.964835).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0841273
	speed: 0.4476s/iter; left time: 10031.9736s
	iters: 200, epoch: 3 | loss: 0.0194208
	speed: 0.0916s/iter; left time: 2043.2593s
	iters: 300, epoch: 3 | loss: 0.0080439
	speed: 0.0864s/iter; left time: 1919.7036s
	iters: 400, epoch: 3 | loss: 0.0194422
	speed: 0.0918s/iter; left time: 2029.1518s
Epoch: 3 cost time: 43.53219485282898
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0059726
	speed: 0.4450s/iter; left time: 9765.2874s
	iters: 200, epoch: 4 | loss: 0.9909986
	speed: 0.0972s/iter; left time: 2122.6977s
	iters: 300, epoch: 4 | loss: 0.2202399
	speed: 0.0986s/iter; left time: 2143.0088s
	iters: 400, epoch: 4 | loss: 0.0007538
	speed: 0.1002s/iter; left time: 2169.7887s
Epoch: 4 cost time: 45.88986420631409
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
Validation loss decreased (-0.964835 --> -0.965121).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0093153
	speed: 0.4573s/iter; left time: 9819.6742s
	iters: 200, epoch: 5 | loss: 0.3493776
	speed: 0.0919s/iter; left time: 1965.3416s
	iters: 300, epoch: 5 | loss: 0.2866804
	speed: 0.0931s/iter; left time: 1980.8663s
	iters: 400, epoch: 5 | loss: 0.0000312
	speed: 0.1000s/iter; left time: 2118.4257s
Epoch: 5 cost time: 45.29219079017639
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.313 Vali Acc: 0.961 Test Loss: 0.313 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0013868
	speed: 0.4440s/iter; left time: 9325.7165s
	iters: 200, epoch: 6 | loss: 0.0008707
	speed: 0.1018s/iter; left time: 2127.7536s
	iters: 300, epoch: 6 | loss: 0.0037126
	speed: 0.1010s/iter; left time: 2101.6793s
	iters: 400, epoch: 6 | loss: 0.0022314
	speed: 0.0983s/iter; left time: 2036.0142s
Epoch: 6 cost time: 46.8604040145874
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.301 Vali Acc: 0.955 Test Loss: 0.301 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0021326
	speed: 0.4625s/iter; left time: 9497.8802s
	iters: 200, epoch: 7 | loss: 0.0150411
	speed: 0.0968s/iter; left time: 1977.3248s
	iters: 300, epoch: 7 | loss: 0.0000021
	speed: 0.0961s/iter; left time: 1955.3053s
	iters: 400, epoch: 7 | loss: 0.0000010
	speed: 0.0937s/iter; left time: 1896.0126s
Epoch: 7 cost time: 45.53348207473755
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.323 Vali Acc: 0.961 Test Loss: 0.323 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000685
	speed: 0.4621s/iter; left time: 9272.5767s
	iters: 200, epoch: 8 | loss: 0.0517839
	speed: 0.0958s/iter; left time: 1913.1134s
	iters: 300, epoch: 8 | loss: 0.0000013
	speed: 0.0951s/iter; left time: 1889.4183s
	iters: 400, epoch: 8 | loss: 0.0000734
	speed: 0.0934s/iter; left time: 1846.9045s
Epoch: 8 cost time: 45.158621072769165
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.235 Vali Acc: 0.971 Test Loss: 0.235 Test Acc: 0.971
Validation loss decreased (-0.965121 --> -0.970552).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0016237
	speed: 0.4421s/iter; left time: 8664.7114s
	iters: 200, epoch: 9 | loss: 0.0058778
	speed: 0.0865s/iter; left time: 1686.8587s
	iters: 300, epoch: 9 | loss: 0.0003651
	speed: 0.0838s/iter; left time: 1625.1785s
	iters: 400, epoch: 9 | loss: 0.0754184
	speed: 0.0845s/iter; left time: 1630.1418s
Epoch: 9 cost time: 41.28218936920166
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.222 Vali Acc: 0.974 Test Loss: 0.222 Test Acc: 0.974
Validation loss decreased (-0.970552 --> -0.973983).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000565
	speed: 0.4944s/iter; left time: 9457.1531s
	iters: 200, epoch: 10 | loss: 0.0001268
	speed: 0.1083s/iter; left time: 2061.5447s
	iters: 300, epoch: 10 | loss: 0.0038173
	speed: 0.1085s/iter; left time: 2054.3984s
	iters: 400, epoch: 10 | loss: 0.0006781
	speed: 0.1100s/iter; left time: 2071.7727s
Epoch: 10 cost time: 50.94564700126648
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.324 Vali Acc: 0.969 Test Loss: 0.324 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000008
	speed: 0.4840s/iter; left time: 9032.7059s
	iters: 200, epoch: 11 | loss: 0.0051343
	speed: 0.1083s/iter; left time: 2010.0704s
	iters: 300, epoch: 11 | loss: 0.0166566
	speed: 0.1061s/iter; left time: 1957.9303s
	iters: 400, epoch: 11 | loss: 0.0001330
	speed: 0.1010s/iter; left time: 1853.9847s
Epoch: 11 cost time: 49.346760749816895
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.973983 --> -0.974555).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.9688109
	speed: 0.4877s/iter; left time: 8871.3440s
	iters: 200, epoch: 12 | loss: 0.0010602
	speed: 0.0918s/iter; left time: 1660.3336s
	iters: 300, epoch: 12 | loss: 0.0000038
	speed: 0.0942s/iter; left time: 1694.1660s
	iters: 400, epoch: 12 | loss: 0.0000260
	speed: 0.0922s/iter; left time: 1649.5452s
Epoch: 12 cost time: 44.39104628562927
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.255 Vali Acc: 0.972 Test Loss: 0.255 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0859575
	speed: 0.4721s/iter; left time: 8366.8124s
	iters: 200, epoch: 13 | loss: 0.0952981
	speed: 0.1025s/iter; left time: 1805.9782s
	iters: 300, epoch: 13 | loss: 0.0000008
	speed: 0.0964s/iter; left time: 1689.7896s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.1032s/iter; left time: 1798.6115s
Epoch: 13 cost time: 48.0341796875
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.376 Vali Acc: 0.963 Test Loss: 0.376 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000295
	speed: 0.3858s/iter; left time: 6656.0464s
	iters: 200, epoch: 14 | loss: 0.0000005
	speed: 0.0636s/iter; left time: 1090.2749s
	iters: 300, epoch: 14 | loss: 0.0000417
	speed: 0.0934s/iter; left time: 1593.2493s
	iters: 400, epoch: 14 | loss: 0.0000788
	speed: 0.1036s/iter; left time: 1756.9086s
Epoch: 14 cost time: 38.93766140937805
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.333 Vali Acc: 0.972 Test Loss: 0.333 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000526
	speed: 0.5056s/iter; left time: 8486.5301s
	iters: 200, epoch: 15 | loss: 0.0000023
	speed: 0.0942s/iter; left time: 1571.7334s
	iters: 300, epoch: 15 | loss: 0.0006046
	speed: 0.0981s/iter; left time: 1627.8152s
	iters: 400, epoch: 15 | loss: 0.0000620
	speed: 0.0968s/iter; left time: 1595.1022s
Epoch: 15 cost time: 46.088550329208374
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.300 Vali Acc: 0.972 Test Loss: 0.300 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.4853s/iter; left time: 7918.8349s
	iters: 200, epoch: 16 | loss: 0.0000000
	speed: 0.1008s/iter; left time: 1633.7727s
	iters: 300, epoch: 16 | loss: 0.0000005
	speed: 0.1007s/iter; left time: 1623.3059s
	iters: 400, epoch: 16 | loss: 0.0026429
	speed: 0.1073s/iter; left time: 1718.9838s
Epoch: 16 cost time: 48.797571897506714
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0002786
	speed: 0.4686s/iter; left time: 7425.1616s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0896s/iter; left time: 1411.5574s
	iters: 300, epoch: 17 | loss: 0.0005865
	speed: 0.1016s/iter; left time: 1589.2532s
	iters: 400, epoch: 17 | loss: 0.0000396
	speed: 0.0987s/iter; left time: 1533.8134s
Epoch: 17 cost time: 44.674147844314575
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974555 --> -0.974840).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000184
	speed: 0.4769s/iter; left time: 7333.2125s
	iters: 200, epoch: 18 | loss: 0.0002726
	speed: 0.0970s/iter; left time: 1481.4045s
	iters: 300, epoch: 18 | loss: 0.0000022
	speed: 0.0878s/iter; left time: 1333.1487s
	iters: 400, epoch: 18 | loss: 0.0000000
	speed: 0.0910s/iter; left time: 1371.3775s
Epoch: 18 cost time: 44.52105689048767
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.413 Vali Acc: 0.955 Test Loss: 0.413 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0006370
	speed: 0.4974s/iter; left time: 7415.6755s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.1066s/iter; left time: 1579.1608s
	iters: 300, epoch: 19 | loss: 0.0000003
	speed: 0.1050s/iter; left time: 1544.2462s
	iters: 400, epoch: 19 | loss: 0.0000703
	speed: 0.1058s/iter; left time: 1545.8156s
Epoch: 19 cost time: 50.033660650253296
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.369 Vali Acc: 0.976 Test Loss: 0.369 Test Acc: 0.976
Validation loss decreased (-0.974840 --> -0.975697).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0021661
	speed: 0.4678s/iter; left time: 6755.1294s
	iters: 200, epoch: 20 | loss: 0.0000072
	speed: 0.0998s/iter; left time: 1430.5006s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.1042s/iter; left time: 1483.1974s
	iters: 400, epoch: 20 | loss: 0.2293208
	speed: 0.1044s/iter; left time: 1476.5657s
Epoch: 20 cost time: 47.61285328865051
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.454 Vali Acc: 0.977 Test Loss: 0.454 Test Acc: 0.977
Validation loss decreased (-0.975697 --> -0.976553).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2553470
	speed: 0.4763s/iter; left time: 6654.2069s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0987s/iter; left time: 1369.3142s
	iters: 300, epoch: 21 | loss: 0.0156020
	speed: 0.0950s/iter; left time: 1308.6103s
	iters: 400, epoch: 21 | loss: 0.0004371
	speed: 0.0956s/iter; left time: 1307.0243s
Epoch: 21 cost time: 45.753652811050415
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.539 Vali Acc: 0.969 Test Loss: 0.539 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.4734s/iter; left time: 6391.3209s
	iters: 200, epoch: 22 | loss: 0.0027149
	speed: 0.1028s/iter; left time: 1377.8478s
	iters: 300, epoch: 22 | loss: 0.0000011
	speed: 0.1058s/iter; left time: 1407.8321s
	iters: 400, epoch: 22 | loss: 0.0975048
	speed: 0.1024s/iter; left time: 1352.0869s
Epoch: 22 cost time: 48.25517749786377
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.416 Vali Acc: 0.973 Test Loss: 0.416 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.2084551
	speed: 0.4562s/iter; left time: 5946.1966s
	iters: 200, epoch: 23 | loss: 0.0000008
	speed: 0.0967s/iter; left time: 1250.1599s
	iters: 300, epoch: 23 | loss: 0.0000929
	speed: 0.1024s/iter; left time: 1314.3910s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.1013s/iter; left time: 1289.7755s
Epoch: 23 cost time: 46.250418186187744
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.332 Vali Acc: 0.977 Test Loss: 0.332 Test Acc: 0.977
Validation loss decreased (-0.976553 --> -0.976841).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000044
	speed: 0.4756s/iter; left time: 5974.8358s
	iters: 200, epoch: 24 | loss: 0.0000047
	speed: 0.1014s/iter; left time: 1264.1492s
	iters: 300, epoch: 24 | loss: 0.0000124
	speed: 0.0990s/iter; left time: 1224.4544s
	iters: 400, epoch: 24 | loss: 0.0000228
	speed: 0.0922s/iter; left time: 1131.0667s
Epoch: 24 cost time: 46.24882197380066
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.517 Vali Acc: 0.972 Test Loss: 0.517 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000004
	speed: 0.4629s/iter; left time: 5598.6746s
	iters: 200, epoch: 25 | loss: 0.0000016
	speed: 0.1004s/iter; left time: 1204.0518s
	iters: 300, epoch: 25 | loss: 0.0000170
	speed: 0.1029s/iter; left time: 1223.5301s
	iters: 400, epoch: 25 | loss: 0.3663108
	speed: 0.1041s/iter; left time: 1228.0120s
Epoch: 25 cost time: 48.27202868461609
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.446 Vali Acc: 0.965 Test Loss: 0.446 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000001
	speed: 0.4719s/iter; left time: 5485.9047s
	iters: 200, epoch: 26 | loss: 0.1066719
	speed: 0.0912s/iter; left time: 1050.6954s
	iters: 300, epoch: 26 | loss: 0.0001657
	speed: 0.0992s/iter; left time: 1133.5516s
	iters: 400, epoch: 26 | loss: 0.0000009
	speed: 0.1080s/iter; left time: 1223.2332s
Epoch: 26 cost time: 46.97665452957153
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.490 Vali Acc: 0.961 Test Loss: 0.490 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.4856s/iter; left time: 5418.2592s
	iters: 200, epoch: 27 | loss: 0.0000000
	speed: 0.0963s/iter; left time: 1064.5152s
	iters: 300, epoch: 27 | loss: 0.0000099
	speed: 0.1018s/iter; left time: 1115.9256s
	iters: 400, epoch: 27 | loss: 0.0000673
	speed: 0.0975s/iter; left time: 1058.3158s
Epoch: 27 cost time: 46.18218207359314
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.524 Vali Acc: 0.969 Test Loss: 0.524 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.4663s/iter; left time: 4983.6451s
	iters: 200, epoch: 28 | loss: 0.0003484
	speed: 0.1025s/iter; left time: 1085.3452s
	iters: 300, epoch: 28 | loss: 0.0000719
	speed: 0.1066s/iter; left time: 1117.6335s
	iters: 400, epoch: 28 | loss: 0.1432232
	speed: 0.1057s/iter; left time: 1098.3181s
Epoch: 28 cost time: 49.5172553062439
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.365 Vali Acc: 0.971 Test Loss: 0.365 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.4784s/iter; left time: 4888.8955s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.1014s/iter; left time: 1025.6053s
	iters: 300, epoch: 29 | loss: 0.0000003
	speed: 0.1064s/iter; left time: 1066.3047s
	iters: 400, epoch: 29 | loss: 0.0000095
	speed: 0.1029s/iter; left time: 1020.5470s
Epoch: 29 cost time: 48.09965372085571
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.379 Vali Acc: 0.973 Test Loss: 0.379 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0002876
	speed: 0.5030s/iter; left time: 4904.3724s
	iters: 200, epoch: 30 | loss: 0.0000017
	speed: 0.0976s/iter; left time: 941.3589s
	iters: 300, epoch: 30 | loss: 0.0000014
	speed: 0.1038s/iter; left time: 990.8913s
	iters: 400, epoch: 30 | loss: 0.0000063
	speed: 0.0983s/iter; left time: 929.1393s
Epoch: 30 cost time: 48.401979207992554
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.349 Vali Acc: 0.971 Test Loss: 0.349 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0127570
	speed: 0.5053s/iter; left time: 4689.8056s
	iters: 200, epoch: 31 | loss: 0.0000007
	speed: 0.1127s/iter; left time: 1034.9045s
	iters: 300, epoch: 31 | loss: 0.0000071
	speed: 0.1128s/iter; left time: 1024.2875s
	iters: 400, epoch: 31 | loss: 0.0001022
	speed: 0.1102s/iter; left time: 990.1098s
Epoch: 31 cost time: 52.60016894340515
Epoch: 31, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.483 Vali Acc: 0.968 Test Loss: 0.483 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.4950s/iter; left time: 4361.9958s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.1042s/iter; left time: 908.0369s
	iters: 300, epoch: 32 | loss: 0.0000477
	speed: 0.1088s/iter; left time: 936.6377s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.1059s/iter; left time: 901.7035s
Epoch: 32 cost time: 49.172908306121826
Epoch: 32, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.352 Vali Acc: 0.969 Test Loss: 0.352 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.4951s/iter; left time: 4130.8213s
	iters: 200, epoch: 33 | loss: 0.1067863
	speed: 0.1051s/iter; left time: 866.2403s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.1004s/iter; left time: 817.1855s
	iters: 400, epoch: 33 | loss: 0.0439527
	speed: 0.0977s/iter; left time: 786.0956s
Epoch: 33 cost time: 47.68711972236633
Epoch: 33, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.974 Test Loss: 0.596 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 1432458
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8782935
	speed: 0.0849s/iter; left time: 1981.6832s
	iters: 200, epoch: 1 | loss: 0.3045014
	speed: 0.0685s/iter; left time: 1591.8996s
	iters: 300, epoch: 1 | loss: 0.2143526
	speed: 0.0705s/iter; left time: 1631.2946s
	iters: 400, epoch: 1 | loss: 0.1362256
	speed: 0.0729s/iter; left time: 1679.4127s
Epoch: 1 cost time: 34.91172456741333
Epoch: 1, Steps: 469 | Train Loss: 0.550 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (inf --> -0.962549).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0236776
	speed: 0.3753s/iter; left time: 8587.2070s
	iters: 200, epoch: 2 | loss: 0.0756329
	speed: 0.0623s/iter; left time: 1419.6309s
	iters: 300, epoch: 2 | loss: 0.0260411
	speed: 0.0705s/iter; left time: 1598.6689s
	iters: 400, epoch: 2 | loss: 0.0103026
	speed: 0.0706s/iter; left time: 1595.0535s
Epoch: 2 cost time: 31.99668049812317
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.962549 --> -0.969982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0817361
	speed: 0.3891s/iter; left time: 8722.0047s
	iters: 200, epoch: 3 | loss: 0.0020138
	speed: 0.0667s/iter; left time: 1488.6567s
	iters: 300, epoch: 3 | loss: 0.1494250
	speed: 0.0685s/iter; left time: 1522.5576s
	iters: 400, epoch: 3 | loss: 0.0873147
	speed: 0.0716s/iter; left time: 1584.1466s
Epoch: 3 cost time: 33.433521032333374
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.969982 --> -0.970839).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0080066
	speed: 0.3757s/iter; left time: 8244.6696s
	iters: 200, epoch: 4 | loss: 0.0027695
	speed: 0.0680s/iter; left time: 1486.4036s
	iters: 300, epoch: 4 | loss: 0.0036694
	speed: 0.0749s/iter; left time: 1627.8769s
	iters: 400, epoch: 4 | loss: 0.1676055
	speed: 0.0723s/iter; left time: 1564.4699s
Epoch: 4 cost time: 33.99326801300049
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.970839 --> -0.975985).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0309229
	speed: 0.3863s/iter; left time: 8296.5839s
	iters: 200, epoch: 5 | loss: 0.1245879
	speed: 0.0725s/iter; left time: 1549.4311s
	iters: 300, epoch: 5 | loss: 0.0040417
	speed: 0.0731s/iter; left time: 1554.5936s
	iters: 400, epoch: 5 | loss: 0.0158527
	speed: 0.0737s/iter; left time: 1560.4601s
Epoch: 5 cost time: 34.21261978149414
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0009088
	speed: 0.3623s/iter; left time: 7610.0893s
	iters: 200, epoch: 6 | loss: 0.0456964
	speed: 0.0592s/iter; left time: 1237.5619s
	iters: 300, epoch: 6 | loss: 0.0000978
	speed: 0.0647s/iter; left time: 1346.5500s
	iters: 400, epoch: 6 | loss: 0.0005596
	speed: 0.0695s/iter; left time: 1439.4920s
Epoch: 6 cost time: 31.118602514266968
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.181 Vali Acc: 0.968 Test Loss: 0.181 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0027283
	speed: 0.3805s/iter; left time: 7814.8442s
	iters: 200, epoch: 7 | loss: 0.0188084
	speed: 0.0741s/iter; left time: 1513.4952s
	iters: 300, epoch: 7 | loss: 0.2785649
	speed: 0.0749s/iter; left time: 1523.8747s
	iters: 400, epoch: 7 | loss: 0.0009091
	speed: 0.0720s/iter; left time: 1457.4759s
Epoch: 7 cost time: 34.95975136756897
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0245185
	speed: 0.3620s/iter; left time: 7264.4695s
	iters: 200, epoch: 8 | loss: 0.0002930
	speed: 0.0674s/iter; left time: 1346.6610s
	iters: 300, epoch: 8 | loss: 0.0000140
	speed: 0.0712s/iter; left time: 1415.1303s
	iters: 400, epoch: 8 | loss: 0.0051342
	speed: 0.0722s/iter; left time: 1426.9483s
Epoch: 8 cost time: 33.160624980926514
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0004746
	speed: 0.3778s/iter; left time: 7405.4061s
	iters: 200, epoch: 9 | loss: 0.2182944
	speed: 0.0691s/iter; left time: 1347.5218s
	iters: 300, epoch: 9 | loss: 0.0001313
	speed: 0.0699s/iter; left time: 1355.9052s
	iters: 400, epoch: 9 | loss: 0.1907882
	speed: 0.0711s/iter; left time: 1372.6547s
Epoch: 9 cost time: 33.18460392951965
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0056018
	speed: 0.3658s/iter; left time: 6998.5133s
	iters: 200, epoch: 10 | loss: 0.0020827
	speed: 0.0641s/iter; left time: 1220.7009s
	iters: 300, epoch: 10 | loss: 0.0056427
	speed: 0.0658s/iter; left time: 1244.8261s
	iters: 400, epoch: 10 | loss: 0.0000479
	speed: 0.0683s/iter; left time: 1285.3169s
Epoch: 10 cost time: 31.480072021484375
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
Validation loss decreased (-0.975985 --> -0.978844).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0005677
	speed: 0.3760s/iter; left time: 7017.4459s
	iters: 200, epoch: 11 | loss: 0.0054467
	speed: 0.0748s/iter; left time: 1388.3516s
	iters: 300, epoch: 11 | loss: 0.0001057
	speed: 0.0761s/iter; left time: 1404.6745s
	iters: 400, epoch: 11 | loss: 0.0010154
	speed: 0.0745s/iter; left time: 1367.9114s
Epoch: 11 cost time: 34.83546566963196
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0011257
	speed: 0.3714s/iter; left time: 6756.6460s
	iters: 200, epoch: 12 | loss: 0.0018460
	speed: 0.0658s/iter; left time: 1189.9482s
	iters: 300, epoch: 12 | loss: 0.0011383
	speed: 0.0733s/iter; left time: 1319.2960s
	iters: 400, epoch: 12 | loss: 0.0001587
	speed: 0.0772s/iter; left time: 1382.1154s
Epoch: 12 cost time: 33.98158502578735
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0769900
	speed: 0.4071s/iter; left time: 7214.8477s
	iters: 200, epoch: 13 | loss: 0.0004858
	speed: 0.0822s/iter; left time: 1449.1495s
	iters: 300, epoch: 13 | loss: 0.0001623
	speed: 0.0818s/iter; left time: 1433.7026s
	iters: 400, epoch: 13 | loss: 0.0036570
	speed: 0.0788s/iter; left time: 1373.5737s
Epoch: 13 cost time: 36.93248414993286
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002242
	speed: 0.4099s/iter; left time: 7072.6675s
	iters: 200, epoch: 14 | loss: 0.2852437
	speed: 0.0755s/iter; left time: 1294.3177s
	iters: 300, epoch: 14 | loss: 0.0011694
	speed: 0.0796s/iter; left time: 1358.0574s
	iters: 400, epoch: 14 | loss: 0.0009928
	speed: 0.0802s/iter; left time: 1360.1955s
Epoch: 14 cost time: 37.331520318984985
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
Validation loss decreased (-0.978844 --> -0.980559).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001409
	speed: 0.4433s/iter; left time: 7441.3868s
	iters: 200, epoch: 15 | loss: 0.0004382
	speed: 0.0793s/iter; left time: 1322.9822s
	iters: 300, epoch: 15 | loss: 0.0007478
	speed: 0.0751s/iter; left time: 1244.7675s
	iters: 400, epoch: 15 | loss: 0.0417772
	speed: 0.0717s/iter; left time: 1181.7682s
Epoch: 15 cost time: 36.2681028842926
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000274
	speed: 0.3931s/iter; left time: 6413.3978s
	iters: 200, epoch: 16 | loss: 0.0000093
	speed: 0.0790s/iter; left time: 1281.3900s
	iters: 300, epoch: 16 | loss: 0.0017621
	speed: 0.0802s/iter; left time: 1292.9484s
	iters: 400, epoch: 16 | loss: 0.0000495
	speed: 0.0822s/iter; left time: 1317.2477s
Epoch: 16 cost time: 37.251887798309326
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0107044
	speed: 0.4214s/iter; left time: 6677.9571s
	iters: 200, epoch: 17 | loss: 0.0003371
	speed: 0.0787s/iter; left time: 1238.6570s
	iters: 300, epoch: 17 | loss: 0.0003648
	speed: 0.0775s/iter; left time: 1212.4906s
	iters: 400, epoch: 17 | loss: 0.0000609
	speed: 0.0769s/iter; left time: 1196.3263s
Epoch: 17 cost time: 36.50634407997131
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.213 Vali Acc: 0.967 Test Loss: 0.213 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000612
	speed: 0.4105s/iter; left time: 6313.1159s
	iters: 200, epoch: 18 | loss: 0.0224892
	speed: 0.0809s/iter; left time: 1235.2292s
	iters: 300, epoch: 18 | loss: 0.1999916
	speed: 0.0775s/iter; left time: 1176.3616s
	iters: 400, epoch: 18 | loss: 0.1092706
	speed: 0.0715s/iter; left time: 1078.4943s
Epoch: 18 cost time: 36.0103325843811
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000177
	speed: 0.4227s/iter; left time: 6302.6227s
	iters: 200, epoch: 19 | loss: 0.0008943
	speed: 0.0773s/iter; left time: 1144.6562s
	iters: 300, epoch: 19 | loss: 0.0006321
	speed: 0.0727s/iter; left time: 1069.7294s
	iters: 400, epoch: 19 | loss: 0.0000137
	speed: 0.0737s/iter; left time: 1076.2269s
Epoch: 19 cost time: 35.44854426383972
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000059
	speed: 0.4104s/iter; left time: 5925.7624s
	iters: 200, epoch: 20 | loss: 0.0000117
	speed: 0.0808s/iter; left time: 1159.2994s
	iters: 300, epoch: 20 | loss: 0.0029701
	speed: 0.0796s/iter; left time: 1132.8760s
	iters: 400, epoch: 20 | loss: 0.0000179
	speed: 0.0810s/iter; left time: 1144.9386s
Epoch: 20 cost time: 37.23582053184509
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000245
	speed: 0.4105s/iter; left time: 5735.6038s
	iters: 200, epoch: 21 | loss: 0.0050315
	speed: 0.0800s/iter; left time: 1110.3166s
	iters: 300, epoch: 21 | loss: 0.0000086
	speed: 0.0794s/iter; left time: 1093.5349s
	iters: 400, epoch: 21 | loss: 0.0000252
	speed: 0.0732s/iter; left time: 1000.9926s
Epoch: 21 cost time: 36.63334679603577
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000315
	speed: 0.3850s/iter; left time: 5198.3862s
	iters: 200, epoch: 22 | loss: 0.0020289
	speed: 0.0817s/iter; left time: 1094.9500s
	iters: 300, epoch: 22 | loss: 0.0001380
	speed: 0.0802s/iter; left time: 1066.1755s
	iters: 400, epoch: 22 | loss: 0.0000011
	speed: 0.0790s/iter; left time: 1043.3837s
Epoch: 22 cost time: 37.13146185874939
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.1582015
	speed: 0.4202s/iter; left time: 5475.8169s
	iters: 200, epoch: 23 | loss: 0.0000608
	speed: 0.0755s/iter; left time: 976.5805s
	iters: 300, epoch: 23 | loss: 0.0054472
	speed: 0.0716s/iter; left time: 919.4006s
	iters: 400, epoch: 23 | loss: 0.0000119
	speed: 0.0640s/iter; left time: 814.4947s
Epoch: 23 cost time: 33.769248962402344
Epoch: 23, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.211 Vali Acc: 0.976 Test Loss: 0.211 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000258
	speed: 0.3898s/iter; left time: 4897.3328s
	iters: 200, epoch: 24 | loss: 0.0018786
	speed: 0.0765s/iter; left time: 953.0989s
	iters: 300, epoch: 24 | loss: 0.0003344
	speed: 0.0755s/iter; left time: 933.0893s
	iters: 400, epoch: 24 | loss: 0.0002112
	speed: 0.0717s/iter; left time: 879.3826s
Epoch: 24 cost time: 35.96618866920471
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 372106
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6904342
	speed: 0.0920s/iter; left time: 2148.2622s
	iters: 200, epoch: 1 | loss: 0.1011076
	speed: 0.0724s/iter; left time: 1684.2189s
	iters: 300, epoch: 1 | loss: 0.0610738
	speed: 0.0725s/iter; left time: 1679.3551s
	iters: 400, epoch: 1 | loss: 0.0481558
	speed: 0.0745s/iter; left time: 1717.5193s
Epoch: 1 cost time: 36.431867361068726
Epoch: 1, Steps: 469 | Train Loss: 0.535 Vali Loss: 0.218 Vali Acc: 0.945 Test Loss: 0.218 Test Acc: 0.945
Validation loss decreased (inf --> -0.944538).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0155787
	speed: 0.4154s/iter; left time: 9504.9962s
	iters: 200, epoch: 2 | loss: 0.0377920
	speed: 0.0743s/iter; left time: 1691.8754s
	iters: 300, epoch: 2 | loss: 0.2755145
	speed: 0.0763s/iter; left time: 1730.5829s
	iters: 400, epoch: 2 | loss: 0.1600961
	speed: 0.0754s/iter; left time: 1703.0139s
Epoch: 2 cost time: 35.81477737426758
Epoch: 2, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.944538 --> -0.971697).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0025222
	speed: 0.3840s/iter; left time: 8606.1454s
	iters: 200, epoch: 3 | loss: 0.0029649
	speed: 0.0680s/iter; left time: 1517.9887s
	iters: 300, epoch: 3 | loss: 0.0051177
	speed: 0.0688s/iter; left time: 1527.9225s
	iters: 400, epoch: 3 | loss: 0.0119866
	speed: 0.0636s/iter; left time: 1407.2219s
Epoch: 3 cost time: 31.00298571586609
Epoch: 3, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0030221
	speed: 0.4051s/iter; left time: 8890.2373s
	iters: 200, epoch: 4 | loss: 0.0074761
	speed: 0.0766s/iter; left time: 1672.5854s
	iters: 300, epoch: 4 | loss: 0.0049355
	speed: 0.0788s/iter; left time: 1712.7165s
	iters: 400, epoch: 4 | loss: 0.2720596
	speed: 0.0774s/iter; left time: 1674.3440s
Epoch: 4 cost time: 36.95665907859802
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0014326
	speed: 0.4027s/iter; left time: 8647.1900s
	iters: 200, epoch: 5 | loss: 0.0068056
	speed: 0.0682s/iter; left time: 1456.9766s
	iters: 300, epoch: 5 | loss: 0.0031782
	speed: 0.0633s/iter; left time: 1347.2753s
	iters: 400, epoch: 5 | loss: 0.0050443
	speed: 0.0623s/iter; left time: 1320.2481s
Epoch: 5 cost time: 31.598153352737427
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.974270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0010784
	speed: 0.3891s/iter; left time: 8174.2492s
	iters: 200, epoch: 6 | loss: 0.1941286
	speed: 0.0702s/iter; left time: 1468.6377s
	iters: 300, epoch: 6 | loss: 0.0011637
	speed: 0.0716s/iter; left time: 1490.0018s
	iters: 400, epoch: 6 | loss: 0.0001892
	speed: 0.0706s/iter; left time: 1462.5064s
Epoch: 6 cost time: 33.87773299217224
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0005027
	speed: 0.3926s/iter; left time: 8062.9126s
	iters: 200, epoch: 7 | loss: 0.0150519
	speed: 0.0723s/iter; left time: 1476.7713s
	iters: 300, epoch: 7 | loss: 0.0002154
	speed: 0.0709s/iter; left time: 1441.1026s
	iters: 400, epoch: 7 | loss: 0.0784309
	speed: 0.0713s/iter; left time: 1442.8670s
Epoch: 7 cost time: 34.24771976470947
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0003829
	speed: 0.4195s/iter; left time: 8417.5876s
	iters: 200, epoch: 8 | loss: 0.0000257
	speed: 0.0775s/iter; left time: 1547.6027s
	iters: 300, epoch: 8 | loss: 0.0000779
	speed: 0.0786s/iter; left time: 1562.5760s
	iters: 400, epoch: 8 | loss: 0.0028862
	speed: 0.0763s/iter; left time: 1507.6870s
Epoch: 8 cost time: 36.70644187927246
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2401094
	speed: 0.4150s/iter; left time: 8134.2560s
	iters: 200, epoch: 9 | loss: 0.0002145
	speed: 0.0749s/iter; left time: 1460.9932s
	iters: 300, epoch: 9 | loss: 0.0013278
	speed: 0.0753s/iter; left time: 1461.7081s
	iters: 400, epoch: 9 | loss: 0.0003567
	speed: 0.0749s/iter; left time: 1445.3505s
Epoch: 9 cost time: 35.326972007751465
Epoch: 9, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0001446
	speed: 0.4132s/iter; left time: 7905.2113s
	iters: 200, epoch: 10 | loss: 0.0026247
	speed: 0.0730s/iter; left time: 1388.3023s
	iters: 300, epoch: 10 | loss: 0.0003155
	speed: 0.0665s/iter; left time: 1259.7547s
	iters: 400, epoch: 10 | loss: 0.1549719
	speed: 0.0686s/iter; left time: 1291.6402s
Epoch: 10 cost time: 33.98179244995117
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.972 Test Loss: 0.200 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0002720
	speed: 0.3981s/iter; left time: 7429.8013s
	iters: 200, epoch: 11 | loss: 0.0030163
	speed: 0.0670s/iter; left time: 1243.3965s
	iters: 300, epoch: 11 | loss: 0.0044556
	speed: 0.0657s/iter; left time: 1213.6759s
	iters: 400, epoch: 11 | loss: 0.0000853
	speed: 0.0659s/iter; left time: 1209.7993s
Epoch: 11 cost time: 30.990307092666626
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001363
	speed: 0.3936s/iter; left time: 7160.0491s
	iters: 200, epoch: 12 | loss: 0.0006565
	speed: 0.0738s/iter; left time: 1335.7449s
	iters: 300, epoch: 12 | loss: 0.0008499
	speed: 0.0720s/iter; left time: 1295.8863s
	iters: 400, epoch: 12 | loss: 0.0000568
	speed: 0.0776s/iter; left time: 1388.5413s
Epoch: 12 cost time: 35.58796429634094
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0003975
	speed: 0.3876s/iter; left time: 6869.1712s
	iters: 200, epoch: 13 | loss: 0.0001099
	speed: 0.0722s/iter; left time: 1272.3229s
	iters: 300, epoch: 13 | loss: 0.0000141
	speed: 0.0707s/iter; left time: 1239.1378s
	iters: 400, epoch: 13 | loss: 0.0010779
	speed: 0.0718s/iter; left time: 1251.5177s
Epoch: 13 cost time: 34.0544056892395
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
Validation loss decreased (-0.975699 --> -0.980559).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000037
	speed: 0.4120s/iter; left time: 7109.1258s
	iters: 200, epoch: 14 | loss: 0.0000203
	speed: 0.0789s/iter; left time: 1353.5123s
	iters: 300, epoch: 14 | loss: 0.0000331
	speed: 0.0771s/iter; left time: 1315.1829s
	iters: 400, epoch: 14 | loss: 0.0000111
	speed: 0.0748s/iter; left time: 1267.4849s
Epoch: 14 cost time: 36.58976411819458
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.976 Test Loss: 0.210 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0001639
	speed: 0.3913s/iter; left time: 6568.4709s
	iters: 200, epoch: 15 | loss: 0.0001393
	speed: 0.0614s/iter; left time: 1024.9313s
	iters: 300, epoch: 15 | loss: 0.0000081
	speed: 0.0621s/iter; left time: 1029.4475s
	iters: 400, epoch: 15 | loss: 0.0004317
	speed: 0.0699s/iter; left time: 1152.6879s
Epoch: 15 cost time: 30.832523345947266
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.974 Test Loss: 0.229 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0161052
	speed: 0.4098s/iter; left time: 6685.6914s
	iters: 200, epoch: 16 | loss: 0.0001783
	speed: 0.0797s/iter; left time: 1292.3596s
	iters: 300, epoch: 16 | loss: 0.0002360
	speed: 0.0738s/iter; left time: 1188.8939s
	iters: 400, epoch: 16 | loss: 0.0001439
	speed: 0.0736s/iter; left time: 1178.8195s
Epoch: 16 cost time: 36.18619203567505
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.319 Vali Acc: 0.970 Test Loss: 0.319 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000456
	speed: 0.4031s/iter; left time: 6388.3520s
	iters: 200, epoch: 17 | loss: 0.0000202
	speed: 0.0730s/iter; left time: 1149.8554s
	iters: 300, epoch: 17 | loss: 0.0200298
	speed: 0.0687s/iter; left time: 1074.2869s
	iters: 400, epoch: 17 | loss: 0.0000033
	speed: 0.0716s/iter; left time: 1112.5438s
Epoch: 17 cost time: 33.68933701515198
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.974 Test Loss: 0.235 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.2686632
	speed: 0.3930s/iter; left time: 6043.5072s
	iters: 200, epoch: 18 | loss: 0.0000099
	speed: 0.0681s/iter; left time: 1040.2986s
	iters: 300, epoch: 18 | loss: 0.0215522
	speed: 0.0732s/iter; left time: 1110.3780s
	iters: 400, epoch: 18 | loss: 0.0007676
	speed: 0.0769s/iter; left time: 1159.0362s
Epoch: 18 cost time: 34.08169460296631
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.273 Vali Acc: 0.968 Test Loss: 0.273 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0016502
	speed: 0.3926s/iter; left time: 5852.8941s
	iters: 200, epoch: 19 | loss: 0.0000011
	speed: 0.0687s/iter; left time: 1016.6516s
	iters: 300, epoch: 19 | loss: 0.3593443
	speed: 0.0701s/iter; left time: 1031.7296s
	iters: 400, epoch: 19 | loss: 0.0000254
	speed: 0.0714s/iter; left time: 1042.4975s
Epoch: 19 cost time: 33.14979362487793
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.268 Vali Acc: 0.965 Test Loss: 0.268 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0002341
	speed: 0.4017s/iter; left time: 5801.1790s
	iters: 200, epoch: 20 | loss: 0.0000011
	speed: 0.0741s/iter; left time: 1062.2694s
	iters: 300, epoch: 20 | loss: 0.0000361
	speed: 0.0741s/iter; left time: 1055.3750s
	iters: 400, epoch: 20 | loss: 0.0048344
	speed: 0.0769s/iter; left time: 1087.5011s
Epoch: 20 cost time: 35.62341833114624
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.336 Vali Acc: 0.964 Test Loss: 0.336 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0004335
	speed: 0.3946s/iter; left time: 5512.8293s
	iters: 200, epoch: 21 | loss: 0.0000028
	speed: 0.0697s/iter; left time: 967.2700s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0669s/iter; left time: 920.9283s
	iters: 400, epoch: 21 | loss: 0.0113615
	speed: 0.0670s/iter; left time: 916.4646s
Epoch: 21 cost time: 31.98262095451355
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.976 Test Loss: 0.181 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000076
	speed: 0.3586s/iter; left time: 4841.8284s
	iters: 200, epoch: 22 | loss: 0.0167034
	speed: 0.0682s/iter; left time: 913.9966s
	iters: 300, epoch: 22 | loss: 0.0334486
	speed: 0.0743s/iter; left time: 988.5212s
	iters: 400, epoch: 22 | loss: 0.0000549
	speed: 0.0674s/iter; left time: 889.6648s
Epoch: 22 cost time: 32.033371925354004
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.976 Test Loss: 0.241 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000026
	speed: 0.3737s/iter; left time: 4870.8503s
	iters: 200, epoch: 23 | loss: 0.0000022
	speed: 0.0701s/iter; left time: 906.5580s
	iters: 300, epoch: 23 | loss: 0.0003901
	speed: 0.0701s/iter; left time: 899.5629s
	iters: 400, epoch: 23 | loss: 0.0000406
	speed: 0.0675s/iter; left time: 860.0906s
Epoch: 23 cost time: 32.569398641586304
Epoch: 23, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.967 Test Loss: 0.301 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 372170
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4502716
	speed: 0.0717s/iter; left time: 1673.8124s
	iters: 200, epoch: 1 | loss: 0.5899040
	speed: 0.0523s/iter; left time: 1216.1213s
	iters: 300, epoch: 1 | loss: 0.1648196
	speed: 0.0562s/iter; left time: 1301.6828s
	iters: 400, epoch: 1 | loss: 0.2749286
	speed: 0.0549s/iter; left time: 1265.7285s
Epoch: 1 cost time: 27.201087713241577
Epoch: 1, Steps: 469 | Train Loss: 0.761 Vali Loss: 0.288 Vali Acc: 0.923 Test Loss: 0.288 Test Acc: 0.923
Validation loss decreased (inf --> -0.923382).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2268973
	speed: 0.3265s/iter; left time: 7472.0871s
	iters: 200, epoch: 2 | loss: 0.0221805
	speed: 0.0541s/iter; left time: 1231.3881s
	iters: 300, epoch: 2 | loss: 0.0365120
	speed: 0.0520s/iter; left time: 1178.4636s
	iters: 400, epoch: 2 | loss: 0.0033703
	speed: 0.0529s/iter; left time: 1194.0778s
Epoch: 2 cost time: 25.269357204437256
Epoch: 2, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.923382 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0470018
	speed: 0.3073s/iter; left time: 6886.6886s
	iters: 200, epoch: 3 | loss: 0.0890795
	speed: 0.0553s/iter; left time: 1234.6179s
	iters: 300, epoch: 3 | loss: 0.0089848
	speed: 0.0553s/iter; left time: 1228.0548s
	iters: 400, epoch: 3 | loss: 0.0048406
	speed: 0.0558s/iter; left time: 1233.8662s
Epoch: 3 cost time: 26.323370695114136
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.957974 --> -0.966837).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0245779
	speed: 0.3319s/iter; left time: 7284.1465s
	iters: 200, epoch: 4 | loss: 0.0117460
	speed: 0.0554s/iter; left time: 1209.1714s
	iters: 300, epoch: 4 | loss: 0.0028171
	speed: 0.0531s/iter; left time: 1154.9296s
	iters: 400, epoch: 4 | loss: 0.0076695
	speed: 0.0525s/iter; left time: 1135.8335s
Epoch: 4 cost time: 26.06166648864746
Epoch: 4, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.966837 --> -0.972555).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0069232
	speed: 0.3174s/iter; left time: 6815.7480s
	iters: 200, epoch: 5 | loss: 0.0050333
	speed: 0.0570s/iter; left time: 1217.4530s
	iters: 300, epoch: 5 | loss: 0.0032960
	speed: 0.0610s/iter; left time: 1297.5375s
	iters: 400, epoch: 5 | loss: 0.0035201
	speed: 0.0628s/iter; left time: 1328.8643s
Epoch: 5 cost time: 28.049821853637695
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0011190
	speed: 0.2932s/iter; left time: 6158.4777s
	iters: 200, epoch: 6 | loss: 0.0008335
	speed: 0.0468s/iter; left time: 978.7063s
	iters: 300, epoch: 6 | loss: 0.0046177
	speed: 0.0515s/iter; left time: 1072.4166s
	iters: 400, epoch: 6 | loss: 0.0018285
	speed: 0.0525s/iter; left time: 1087.9696s
Epoch: 6 cost time: 23.547935724258423
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0322786
	speed: 0.3210s/iter; left time: 6592.8751s
	iters: 200, epoch: 7 | loss: 0.0297005
	speed: 0.0585s/iter; left time: 1195.9662s
	iters: 300, epoch: 7 | loss: 0.0030866
	speed: 0.0567s/iter; left time: 1153.4722s
	iters: 400, epoch: 7 | loss: 0.0002487
	speed: 0.0540s/iter; left time: 1093.4106s
Epoch: 7 cost time: 26.850077152252197
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0144394
	speed: 0.3022s/iter; left time: 6064.3546s
	iters: 200, epoch: 8 | loss: 0.2206530
	speed: 0.0533s/iter; left time: 1064.5670s
	iters: 300, epoch: 8 | loss: 0.3228421
	speed: 0.0603s/iter; left time: 1197.7926s
	iters: 400, epoch: 8 | loss: 0.0226160
	speed: 0.0603s/iter; left time: 1192.0527s
Epoch: 8 cost time: 26.928128957748413
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.972555 --> -0.974841).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0061622
	speed: 0.3143s/iter; left time: 6160.6413s
	iters: 200, epoch: 9 | loss: 0.0089568
	speed: 0.0519s/iter; left time: 1012.0817s
	iters: 300, epoch: 9 | loss: 0.0011918
	speed: 0.0480s/iter; left time: 930.7107s
	iters: 400, epoch: 9 | loss: 0.0530857
	speed: 0.0476s/iter; left time: 919.4010s
Epoch: 9 cost time: 23.89739751815796
Epoch: 9, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0004388
	speed: 0.2931s/iter; left time: 5607.7065s
	iters: 200, epoch: 10 | loss: 0.0006784
	speed: 0.0557s/iter; left time: 1059.2155s
	iters: 300, epoch: 10 | loss: 0.0002538
	speed: 0.0610s/iter; left time: 1154.8413s
	iters: 400, epoch: 10 | loss: 0.0003967
	speed: 0.0582s/iter; left time: 1096.5751s
Epoch: 10 cost time: 26.90355944633484
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974841 --> -0.975127).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0004994
	speed: 0.3020s/iter; left time: 5636.2284s
	iters: 200, epoch: 11 | loss: 0.0003698
	speed: 0.0505s/iter; left time: 937.1310s
	iters: 300, epoch: 11 | loss: 0.0030854
	speed: 0.0559s/iter; left time: 1032.3762s
	iters: 400, epoch: 11 | loss: 0.0016315
	speed: 0.0540s/iter; left time: 991.6237s
Epoch: 11 cost time: 25.333691358566284
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001191
	speed: 0.3088s/iter; left time: 5617.0044s
	iters: 200, epoch: 12 | loss: 0.0002009
	speed: 0.0511s/iter; left time: 924.0662s
	iters: 300, epoch: 12 | loss: 0.0001318
	speed: 0.0529s/iter; left time: 951.1407s
	iters: 400, epoch: 12 | loss: 0.0067494
	speed: 0.0530s/iter; left time: 948.6250s
Epoch: 12 cost time: 25.154887676239014
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
Validation loss decreased (-0.975127 --> -0.977414).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000890
	speed: 0.2991s/iter; left time: 5301.1354s
	iters: 200, epoch: 13 | loss: 0.0017343
	speed: 0.0483s/iter; left time: 851.3786s
	iters: 300, epoch: 13 | loss: 0.0011450
	speed: 0.0524s/iter; left time: 917.9804s
	iters: 400, epoch: 13 | loss: 0.0018566
	speed: 0.0554s/iter; left time: 964.5443s
Epoch: 13 cost time: 25.57772135734558
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000655
	speed: 0.3044s/iter; left time: 5252.2075s
	iters: 200, epoch: 14 | loss: 0.0878750
	speed: 0.0537s/iter; left time: 920.8237s
	iters: 300, epoch: 14 | loss: 0.0004051
	speed: 0.0512s/iter; left time: 872.3470s
	iters: 400, epoch: 14 | loss: 0.0009135
	speed: 0.0483s/iter; left time: 818.8625s
Epoch: 14 cost time: 24.580713748931885
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0006099
	speed: 0.3123s/iter; left time: 5242.6129s
	iters: 200, epoch: 15 | loss: 0.0001492
	speed: 0.0545s/iter; left time: 910.0750s
	iters: 300, epoch: 15 | loss: 0.0003474
	speed: 0.0535s/iter; left time: 887.6776s
	iters: 400, epoch: 15 | loss: 0.0000161
	speed: 0.0488s/iter; left time: 805.2008s
Epoch: 15 cost time: 25.320542335510254
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
Validation loss decreased (-0.977414 --> -0.979130).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0092711
	speed: 0.2787s/iter; left time: 4546.8020s
	iters: 200, epoch: 16 | loss: 0.0076284
	speed: 0.0540s/iter; left time: 875.3566s
	iters: 300, epoch: 16 | loss: 0.0001510
	speed: 0.0582s/iter; left time: 937.3966s
	iters: 400, epoch: 16 | loss: 0.0309826
	speed: 0.0578s/iter; left time: 925.3655s
Epoch: 16 cost time: 26.23584508895874
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000793
	speed: 0.3213s/iter; left time: 5092.1082s
	iters: 200, epoch: 17 | loss: 0.0001520
	speed: 0.0536s/iter; left time: 843.3617s
	iters: 300, epoch: 17 | loss: 0.0001589
	speed: 0.0526s/iter; left time: 822.3929s
	iters: 400, epoch: 17 | loss: 0.0010943
	speed: 0.0500s/iter; left time: 776.8877s
Epoch: 17 cost time: 25.073030471801758
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0002519
	speed: 0.2967s/iter; left time: 4563.1747s
	iters: 200, epoch: 18 | loss: 0.0014412
	speed: 0.0567s/iter; left time: 865.8605s
	iters: 300, epoch: 18 | loss: 0.0015677
	speed: 0.0561s/iter; left time: 850.7562s
	iters: 400, epoch: 18 | loss: 0.0138946
	speed: 0.0558s/iter; left time: 841.2888s
Epoch: 18 cost time: 26.51761770248413
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.979 Test Loss: 0.141 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0001049
	speed: 0.3031s/iter; left time: 4518.9707s
	iters: 200, epoch: 19 | loss: 0.0001195
	speed: 0.0517s/iter; left time: 765.4664s
	iters: 300, epoch: 19 | loss: 0.3517692
	speed: 0.0477s/iter; left time: 701.3800s
	iters: 400, epoch: 19 | loss: 0.0000798
	speed: 0.0491s/iter; left time: 716.9648s
Epoch: 19 cost time: 23.517725944519043
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0001593
	speed: 0.2890s/iter; left time: 4173.0205s
	iters: 200, epoch: 20 | loss: 0.0028771
	speed: 0.0563s/iter; left time: 807.0493s
	iters: 300, epoch: 20 | loss: 0.0026048
	speed: 0.0566s/iter; left time: 806.6186s
	iters: 400, epoch: 20 | loss: 0.0000400
	speed: 0.0563s/iter; left time: 796.3105s
Epoch: 20 cost time: 26.979718446731567
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0016656
	speed: 0.3112s/iter; left time: 4347.1165s
	iters: 200, epoch: 21 | loss: 0.0002232
	speed: 0.0523s/iter; left time: 725.8888s
	iters: 300, epoch: 21 | loss: 0.0000776
	speed: 0.0531s/iter; left time: 731.6051s
	iters: 400, epoch: 21 | loss: 0.0000055
	speed: 0.0520s/iter; left time: 710.8646s
Epoch: 21 cost time: 25.267852306365967
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0057971
	speed: 0.3114s/iter; left time: 4203.9515s
	iters: 200, epoch: 22 | loss: 0.0001468
	speed: 0.0508s/iter; left time: 681.2798s
	iters: 300, epoch: 22 | loss: 0.0009668
	speed: 0.0484s/iter; left time: 644.4148s
	iters: 400, epoch: 22 | loss: 0.0006055
	speed: 0.0494s/iter; left time: 652.5626s
Epoch: 22 cost time: 24.06194019317627
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0001336
	speed: 0.3043s/iter; left time: 3965.8128s
	iters: 200, epoch: 23 | loss: 0.0000642
	speed: 0.0567s/iter; left time: 732.8144s
	iters: 300, epoch: 23 | loss: 0.0078463
	speed: 0.0561s/iter; left time: 719.3732s
	iters: 400, epoch: 23 | loss: 0.0001252
	speed: 0.0571s/iter; left time: 727.2437s
Epoch: 23 cost time: 27.047555208206177
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0005324
	speed: 0.3093s/iter; left time: 3885.5818s
	iters: 200, epoch: 24 | loss: 0.0000023
	speed: 0.0535s/iter; left time: 667.2802s
	iters: 300, epoch: 24 | loss: 0.0000135
	speed: 0.0549s/iter; left time: 679.2245s
	iters: 400, epoch: 24 | loss: 0.0000182
	speed: 0.0543s/iter; left time: 665.3381s
Epoch: 24 cost time: 26.08052945137024
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0009561
	speed: 0.3069s/iter; left time: 3711.4576s
	iters: 200, epoch: 25 | loss: 0.0002122
	speed: 0.0483s/iter; left time: 579.8324s
	iters: 300, epoch: 25 | loss: 0.1920844
	speed: 0.0505s/iter; left time: 601.0480s
	iters: 400, epoch: 25 | loss: 0.0001864
	speed: 0.0494s/iter; left time: 582.5392s
Epoch: 25 cost time: 23.504356384277344
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 100042
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4351459
	speed: 0.0720s/iter; left time: 1680.6773s
	iters: 200, epoch: 1 | loss: 0.4063238
	speed: 0.0510s/iter; left time: 1185.7720s
	iters: 300, epoch: 1 | loss: 0.2641137
	speed: 0.0502s/iter; left time: 1162.5951s
	iters: 400, epoch: 1 | loss: 0.1916853
	speed: 0.0491s/iter; left time: 1131.5447s
Epoch: 1 cost time: 25.684669733047485
Epoch: 1, Steps: 469 | Train Loss: 0.732 Vali Loss: 0.254 Vali Acc: 0.929 Test Loss: 0.254 Test Acc: 0.929
Validation loss decreased (inf --> -0.928814).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0562344
	speed: 0.2984s/iter; left time: 6827.4592s
	iters: 200, epoch: 2 | loss: 0.2120581
	speed: 0.0526s/iter; left time: 1197.6094s
	iters: 300, epoch: 2 | loss: 0.0111262
	speed: 0.0510s/iter; left time: 1157.7459s
	iters: 400, epoch: 2 | loss: 0.1232484
	speed: 0.0497s/iter; left time: 1122.5053s
Epoch: 2 cost time: 25.0954008102417
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
Validation loss decreased (-0.928814 --> -0.965693).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0184773
	speed: 0.2991s/iter; left time: 6703.9521s
	iters: 200, epoch: 3 | loss: 0.0380531
	speed: 0.0504s/iter; left time: 1123.9368s
	iters: 300, epoch: 3 | loss: 0.0229268
	speed: 0.0521s/iter; left time: 1156.9691s
	iters: 400, epoch: 3 | loss: 0.0012574
	speed: 0.0555s/iter; left time: 1226.6139s
Epoch: 3 cost time: 24.978763341903687
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
Validation loss decreased (-0.965693 --> -0.968552).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0171425
	speed: 0.3136s/iter; left time: 6881.6738s
	iters: 200, epoch: 4 | loss: 0.2280801
	speed: 0.0524s/iter; left time: 1144.1756s
	iters: 300, epoch: 4 | loss: 0.1833575
	speed: 0.0504s/iter; left time: 1096.5698s
	iters: 400, epoch: 4 | loss: 0.0096834
	speed: 0.0508s/iter; left time: 1098.5851s
Epoch: 4 cost time: 24.45249342918396
Epoch: 4, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
Validation loss decreased (-0.968552 --> -0.970839).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0222614
	speed: 0.3029s/iter; left time: 6505.6857s
	iters: 200, epoch: 5 | loss: 0.0037852
	speed: 0.0559s/iter; left time: 1194.1196s
	iters: 300, epoch: 5 | loss: 0.0002528
	speed: 0.0554s/iter; left time: 1178.8538s
	iters: 400, epoch: 5 | loss: 0.0015612
	speed: 0.0533s/iter; left time: 1129.6813s
Epoch: 5 cost time: 26.276973724365234
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0068547
	speed: 0.2889s/iter; left time: 6069.0046s
	iters: 200, epoch: 6 | loss: 0.0030393
	speed: 0.0512s/iter; left time: 1070.0289s
	iters: 300, epoch: 6 | loss: 0.0011303
	speed: 0.0517s/iter; left time: 1075.0636s
	iters: 400, epoch: 6 | loss: 0.0012166
	speed: 0.0538s/iter; left time: 1113.8609s
Epoch: 6 cost time: 24.96043086051941
Epoch: 6, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.972554).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0084026
	speed: 0.3089s/iter; left time: 6344.1952s
	iters: 200, epoch: 7 | loss: 0.0023492
	speed: 0.0506s/iter; left time: 1034.6249s
	iters: 300, epoch: 7 | loss: 0.0126171
	speed: 0.0521s/iter; left time: 1058.7264s
	iters: 400, epoch: 7 | loss: 0.0003682
	speed: 0.0485s/iter; left time: 981.2805s
Epoch: 7 cost time: 24.017030000686646
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0030749
	speed: 0.2849s/iter; left time: 5717.6972s
	iters: 200, epoch: 8 | loss: 0.0005249
	speed: 0.0488s/iter; left time: 975.1656s
	iters: 300, epoch: 8 | loss: 0.0000709
	speed: 0.0500s/iter; left time: 993.5648s
	iters: 400, epoch: 8 | loss: 0.0002564
	speed: 0.0511s/iter; left time: 1010.2555s
Epoch: 8 cost time: 24.153613328933716
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.969 Test Loss: 0.193 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0004607
	speed: 0.2968s/iter; left time: 5816.7167s
	iters: 200, epoch: 9 | loss: 0.1676688
	speed: 0.0509s/iter; left time: 992.0219s
	iters: 300, epoch: 9 | loss: 0.0004186
	speed: 0.0504s/iter; left time: 977.0747s
	iters: 400, epoch: 9 | loss: 0.0003807
	speed: 0.0520s/iter; left time: 1004.2811s
Epoch: 9 cost time: 24.622461795806885
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000952
	speed: 0.3037s/iter; left time: 5809.9185s
	iters: 200, epoch: 10 | loss: 0.0007433
	speed: 0.0471s/iter; left time: 897.2644s
	iters: 300, epoch: 10 | loss: 0.0279517
	speed: 0.0453s/iter; left time: 857.1183s
	iters: 400, epoch: 10 | loss: 0.0002858
	speed: 0.0496s/iter; left time: 933.3943s
Epoch: 10 cost time: 22.98569917678833
Epoch: 10, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
Validation loss decreased (-0.972554 --> -0.974269).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0037183
	speed: 0.2923s/iter; left time: 5455.2059s
	iters: 200, epoch: 11 | loss: 0.0005462
	speed: 0.0533s/iter; left time: 988.5950s
	iters: 300, epoch: 11 | loss: 0.0001050
	speed: 0.0549s/iter; left time: 1013.4415s
	iters: 400, epoch: 11 | loss: 0.0002809
	speed: 0.0515s/iter; left time: 944.8803s
Epoch: 11 cost time: 25.0601863861084
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.974269 --> -0.977414).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0043359
	speed: 0.2863s/iter; left time: 5208.3724s
	iters: 200, epoch: 12 | loss: 0.0053472
	speed: 0.0502s/iter; left time: 908.3573s
	iters: 300, epoch: 12 | loss: 0.0000565
	speed: 0.0506s/iter; left time: 910.1003s
	iters: 400, epoch: 12 | loss: 0.0039168
	speed: 0.0516s/iter; left time: 923.3775s
Epoch: 12 cost time: 23.95656991004944
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.974 Test Loss: 0.215 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000332
	speed: 0.2972s/iter; left time: 5267.3881s
	iters: 200, epoch: 13 | loss: 0.0031245
	speed: 0.0494s/iter; left time: 871.2245s
	iters: 300, epoch: 13 | loss: 0.0000133
	speed: 0.0467s/iter; left time: 818.9127s
	iters: 400, epoch: 13 | loss: 0.0164960
	speed: 0.0511s/iter; left time: 889.7648s
Epoch: 13 cost time: 23.69869112968445
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0009831
	speed: 0.3061s/iter; left time: 5280.8427s
	iters: 200, epoch: 14 | loss: 0.0048031
	speed: 0.0555s/iter; left time: 952.9032s
	iters: 300, epoch: 14 | loss: 0.0000302
	speed: 0.0541s/iter; left time: 922.7136s
	iters: 400, epoch: 14 | loss: 0.0003785
	speed: 0.0533s/iter; left time: 903.6566s
Epoch: 14 cost time: 26.05355668067932
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.981 Test Loss: 0.149 Test Acc: 0.981
Validation loss decreased (-0.977414 --> -0.980559).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000456
	speed: 0.3042s/iter; left time: 5106.2647s
	iters: 200, epoch: 15 | loss: 0.0023281
	speed: 0.0516s/iter; left time: 861.3367s
	iters: 300, epoch: 15 | loss: 0.1211061
	speed: 0.0512s/iter; left time: 849.4798s
	iters: 400, epoch: 15 | loss: 0.0005365
	speed: 0.0455s/iter; left time: 749.3132s
Epoch: 15 cost time: 23.686915636062622
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001672
	speed: 0.2635s/iter; left time: 4298.9238s
	iters: 200, epoch: 16 | loss: 0.0003938
	speed: 0.0472s/iter; left time: 764.7200s
	iters: 300, epoch: 16 | loss: 0.1564268
	speed: 0.0508s/iter; left time: 818.5560s
	iters: 400, epoch: 16 | loss: 0.0000253
	speed: 0.0513s/iter; left time: 821.9050s
Epoch: 16 cost time: 22.92409086227417
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.974 Test Loss: 0.212 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0049560
	speed: 0.2975s/iter; left time: 4714.5641s
	iters: 200, epoch: 17 | loss: 0.0035608
	speed: 0.0519s/iter; left time: 816.8170s
	iters: 300, epoch: 17 | loss: 0.0009925
	speed: 0.0496s/iter; left time: 776.4996s
	iters: 400, epoch: 17 | loss: 0.0000145
	speed: 0.0463s/iter; left time: 719.3166s
Epoch: 17 cost time: 23.37433362007141
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0049263
	speed: 0.2977s/iter; left time: 4578.5732s
	iters: 200, epoch: 18 | loss: 0.0005075
	speed: 0.0540s/iter; left time: 824.8830s
	iters: 300, epoch: 18 | loss: 0.0000906
	speed: 0.0532s/iter; left time: 807.8143s
	iters: 400, epoch: 18 | loss: 0.0012497
	speed: 0.0496s/iter; left time: 748.0542s
Epoch: 18 cost time: 25.02921462059021
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.974 Test Loss: 0.189 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000292
	speed: 0.2790s/iter; left time: 4160.1522s
	iters: 200, epoch: 19 | loss: 0.0000024
	speed: 0.0488s/iter; left time: 723.2827s
	iters: 300, epoch: 19 | loss: 0.0002513
	speed: 0.0498s/iter; left time: 732.1552s
	iters: 400, epoch: 19 | loss: 0.0016321
	speed: 0.0510s/iter; left time: 745.1847s
Epoch: 19 cost time: 22.54775357246399
Epoch: 19, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.298 Vali Acc: 0.971 Test Loss: 0.298 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001231
	speed: 0.2712s/iter; left time: 3916.6793s
	iters: 200, epoch: 20 | loss: 0.0000023
	speed: 0.0516s/iter; left time: 739.9987s
	iters: 300, epoch: 20 | loss: 0.0061319
	speed: 0.0502s/iter; left time: 714.7360s
	iters: 400, epoch: 20 | loss: 0.0002384
	speed: 0.0517s/iter; left time: 730.5488s
Epoch: 20 cost time: 24.145354747772217
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0214637
	speed: 0.2978s/iter; left time: 4160.8907s
	iters: 200, epoch: 21 | loss: 0.0010128
	speed: 0.0478s/iter; left time: 662.9016s
	iters: 300, epoch: 21 | loss: 0.0237342
	speed: 0.0491s/iter; left time: 675.6664s
	iters: 400, epoch: 21 | loss: 0.0042533
	speed: 0.0486s/iter; left time: 663.8875s
Epoch: 21 cost time: 23.553294897079468
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
Validation loss decreased (-0.980559 --> -0.981702).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0052165
	speed: 0.2979s/iter; left time: 4021.8031s
	iters: 200, epoch: 22 | loss: 0.0004993
	speed: 0.0530s/iter; left time: 710.0035s
	iters: 300, epoch: 22 | loss: 0.0000148
	speed: 0.0543s/iter; left time: 721.8087s
	iters: 400, epoch: 22 | loss: 0.0001933
	speed: 0.0507s/iter; left time: 669.5189s
Epoch: 22 cost time: 25.13405203819275
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0011294
	speed: 0.2870s/iter; left time: 3740.7845s
	iters: 200, epoch: 23 | loss: 0.0000203
	speed: 0.0491s/iter; left time: 634.9443s
	iters: 300, epoch: 23 | loss: 0.0000128
	speed: 0.0478s/iter; left time: 612.8320s
	iters: 400, epoch: 23 | loss: 0.0000270
	speed: 0.0477s/iter; left time: 607.5727s
Epoch: 23 cost time: 23.123873233795166
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0005150
	speed: 0.2892s/iter; left time: 3633.4137s
	iters: 200, epoch: 24 | loss: 0.0000421
	speed: 0.0461s/iter; left time: 574.2885s
	iters: 300, epoch: 24 | loss: 0.0012706
	speed: 0.0482s/iter; left time: 595.6820s
	iters: 400, epoch: 24 | loss: 0.0002968
	speed: 0.0486s/iter; left time: 595.9454s
Epoch: 24 cost time: 23.046736240386963
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.980 Test Loss: 0.167 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0336544
	speed: 0.3063s/iter; left time: 3704.2116s
	iters: 200, epoch: 25 | loss: 0.0005695
	speed: 0.0503s/iter; left time: 603.2927s
	iters: 300, epoch: 25 | loss: 0.0000534
	speed: 0.0471s/iter; left time: 560.5963s
	iters: 400, epoch: 25 | loss: 0.0000268
	speed: 0.0464s/iter; left time: 547.2886s
Epoch: 25 cost time: 23.381149291992188
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.977 Test Loss: 0.231 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000010
	speed: 0.2805s/iter; left time: 3260.9609s
	iters: 200, epoch: 26 | loss: 0.0631740
	speed: 0.0502s/iter; left time: 578.9312s
	iters: 300, epoch: 26 | loss: 0.0034110
	speed: 0.0511s/iter; left time: 583.6011s
	iters: 400, epoch: 26 | loss: 0.0000037
	speed: 0.0520s/iter; left time: 588.9189s
Epoch: 26 cost time: 24.593302726745605
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.974 Test Loss: 0.228 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000975
	speed: 0.2779s/iter; left time: 3100.9770s
	iters: 200, epoch: 27 | loss: 0.0038953
	speed: 0.0472s/iter; left time: 522.2519s
	iters: 300, epoch: 27 | loss: 0.0000275
	speed: 0.0505s/iter; left time: 553.6306s
	iters: 400, epoch: 27 | loss: 0.0000136
	speed: 0.0544s/iter; left time: 590.7872s
Epoch: 27 cost time: 24.082303762435913
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0002608
	speed: 0.3197s/iter; left time: 3417.0879s
	iters: 200, epoch: 28 | loss: 0.0000995
	speed: 0.0521s/iter; left time: 551.9980s
	iters: 300, epoch: 28 | loss: 0.0006488
	speed: 0.0492s/iter; left time: 516.4410s
	iters: 400, epoch: 28 | loss: 0.0002685
	speed: 0.0499s/iter; left time: 518.4542s
Epoch: 28 cost time: 24.1072359085083
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.971 Test Loss: 0.247 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000045
	speed: 0.3194s/iter; left time: 3264.1356s
	iters: 200, epoch: 29 | loss: 0.0000078
	speed: 0.0516s/iter; left time: 521.7870s
	iters: 300, epoch: 29 | loss: 0.0002976
	speed: 0.0511s/iter; left time: 511.9218s
	iters: 400, epoch: 29 | loss: 0.0005161
	speed: 0.0512s/iter; left time: 507.6278s
Epoch: 29 cost time: 24.791693925857544
Epoch: 29, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.979 Test Loss: 0.219 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0001172
	speed: 0.3107s/iter; left time: 3029.5660s
	iters: 200, epoch: 30 | loss: 0.0000203
	speed: 0.0554s/iter; left time: 534.7385s
	iters: 300, epoch: 30 | loss: 0.0000005
	speed: 0.0546s/iter; left time: 521.7176s
	iters: 400, epoch: 30 | loss: 0.0001506
	speed: 0.0525s/iter; left time: 495.8442s
Epoch: 30 cost time: 25.791885375976562
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.253 Vali Acc: 0.976 Test Loss: 0.253 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000186
	speed: 0.3263s/iter; left time: 3028.2971s
	iters: 200, epoch: 31 | loss: 0.0000401
	speed: 0.0501s/iter; left time: 459.5188s
	iters: 300, epoch: 31 | loss: 1.3198700
	speed: 0.0516s/iter; left time: 468.8172s
	iters: 400, epoch: 31 | loss: 0.0009033
	speed: 0.0513s/iter; left time: 461.0142s
Epoch: 31 cost time: 24.91291308403015
Epoch: 31, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.259 Vali Acc: 0.967 Test Loss: 0.259 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 100074
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4469811
	speed: 0.0891s/iter; left time: 2080.7607s
	iters: 200, epoch: 1 | loss: 0.1729700
	speed: 0.0726s/iter; left time: 1687.5832s
	iters: 300, epoch: 1 | loss: 0.0209695
	speed: 0.0702s/iter; left time: 1626.0339s
	iters: 400, epoch: 1 | loss: 0.0386877
	speed: 0.0675s/iter; left time: 1555.3786s
Epoch: 1 cost time: 34.858107805252075
Epoch: 1, Steps: 469 | Train Loss: 0.315 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
Validation loss decreased (inf --> -0.965693).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0143455
	speed: 0.3980s/iter; left time: 9107.3468s
	iters: 200, epoch: 2 | loss: 0.0016117
	speed: 0.0652s/iter; left time: 1485.7139s
	iters: 300, epoch: 2 | loss: 0.0207038
	speed: 0.0693s/iter; left time: 1571.8585s
	iters: 400, epoch: 2 | loss: 0.0812757
	speed: 0.0714s/iter; left time: 1612.0367s
Epoch: 2 cost time: 32.73810172080994
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
Validation loss decreased (-0.965693 --> -0.965979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1084861
	speed: 0.3918s/iter; left time: 8781.6123s
	iters: 200, epoch: 3 | loss: 0.0066371
	speed: 0.0662s/iter; left time: 1476.1182s
	iters: 300, epoch: 3 | loss: 0.1243883
	speed: 0.0664s/iter; left time: 1474.6862s
	iters: 400, epoch: 3 | loss: 0.0004065
	speed: 0.0656s/iter; left time: 1450.0896s
Epoch: 3 cost time: 31.60823345184326
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0083908
	speed: 0.4015s/iter; left time: 8809.6210s
	iters: 200, epoch: 4 | loss: 0.0001356
	speed: 0.0628s/iter; left time: 1370.9799s
	iters: 300, epoch: 4 | loss: 0.0003159
	speed: 0.0569s/iter; left time: 1237.4103s
	iters: 400, epoch: 4 | loss: 0.2292843
	speed: 0.0547s/iter; left time: 1183.6263s
Epoch: 4 cost time: 29.376442193984985
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
Validation loss decreased (-0.965979 --> -0.969409).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0540399
	speed: 0.3492s/iter; left time: 7498.9603s
	iters: 200, epoch: 5 | loss: 0.0006804
	speed: 0.0563s/iter; left time: 1202.4868s
	iters: 300, epoch: 5 | loss: 0.0002994
	speed: 0.0689s/iter; left time: 1465.1703s
	iters: 400, epoch: 5 | loss: 0.5619057
	speed: 0.0680s/iter; left time: 1439.9140s
Epoch: 5 cost time: 30.17794442176819
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0008628
	speed: 0.3749s/iter; left time: 7876.0835s
	iters: 200, epoch: 6 | loss: 0.0017936
	speed: 0.0608s/iter; left time: 1271.4236s
	iters: 300, epoch: 6 | loss: 0.0105402
	speed: 0.0637s/iter; left time: 1324.5939s
	iters: 400, epoch: 6 | loss: 0.0215342
	speed: 0.0672s/iter; left time: 1392.3799s
Epoch: 6 cost time: 30.442421913146973
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.969409 --> -0.975413).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0849986
	speed: 0.3984s/iter; left time: 8182.8761s
	iters: 200, epoch: 7 | loss: 0.0001409
	speed: 0.0597s/iter; left time: 1220.4455s
	iters: 300, epoch: 7 | loss: 0.0000852
	speed: 0.0596s/iter; left time: 1212.3772s
	iters: 400, epoch: 7 | loss: 0.0000396
	speed: 0.0612s/iter; left time: 1239.3682s
Epoch: 7 cost time: 29.547661542892456
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.286 Vali Acc: 0.946 Test Loss: 0.286 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000299
	speed: 0.3687s/iter; left time: 7398.9146s
	iters: 200, epoch: 8 | loss: 0.0002234
	speed: 0.0627s/iter; left time: 1252.7894s
	iters: 300, epoch: 8 | loss: 0.0029214
	speed: 0.0599s/iter; left time: 1190.2595s
	iters: 400, epoch: 8 | loss: 0.0218672
	speed: 0.0603s/iter; left time: 1191.5182s
Epoch: 8 cost time: 29.507928609848022
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
Validation loss decreased (-0.975413 --> -0.976271).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0015188
	speed: 0.3920s/iter; left time: 7683.3818s
	iters: 200, epoch: 9 | loss: 0.0000004
	speed: 0.0634s/iter; left time: 1236.1371s
	iters: 300, epoch: 9 | loss: 0.0000274
	speed: 0.0616s/iter; left time: 1195.8861s
	iters: 400, epoch: 9 | loss: 0.0000013
	speed: 0.0569s/iter; left time: 1097.3727s
Epoch: 9 cost time: 29.500853776931763
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.351 Vali Acc: 0.945 Test Loss: 0.351 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0008578
	speed: 0.3929s/iter; left time: 7516.6085s
	iters: 200, epoch: 10 | loss: 0.1679658
	speed: 0.0657s/iter; left time: 1250.7830s
	iters: 300, epoch: 10 | loss: 0.6391001
	speed: 0.0652s/iter; left time: 1233.9315s
	iters: 400, epoch: 10 | loss: 0.0002444
	speed: 0.0636s/iter; left time: 1198.4902s
Epoch: 10 cost time: 30.986841201782227
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.257 Vali Acc: 0.962 Test Loss: 0.257 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0002442
	speed: 0.3997s/iter; left time: 7459.2875s
	iters: 200, epoch: 11 | loss: 0.0001142
	speed: 0.0650s/iter; left time: 1205.9562s
	iters: 300, epoch: 11 | loss: 0.0000011
	speed: 0.0640s/iter; left time: 1181.7584s
	iters: 400, epoch: 11 | loss: 0.0001782
	speed: 0.0656s/iter; left time: 1204.4011s
Epoch: 11 cost time: 31.80540180206299
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0003585
	speed: 0.3782s/iter; left time: 6879.8940s
	iters: 200, epoch: 12 | loss: 0.0002449
	speed: 0.0679s/iter; left time: 1229.1512s
	iters: 300, epoch: 12 | loss: 0.0000329
	speed: 0.0704s/iter; left time: 1266.8942s
	iters: 400, epoch: 12 | loss: 0.0024346
	speed: 0.0637s/iter; left time: 1139.8907s
Epoch: 12 cost time: 32.28295826911926
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.981 Test Loss: 0.154 Test Acc: 0.981
Validation loss decreased (-0.976271 --> -0.980559).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000192
	speed: 0.3931s/iter; left time: 6966.7997s
	iters: 200, epoch: 13 | loss: 0.0000242
	speed: 0.0677s/iter; left time: 1193.3997s
	iters: 300, epoch: 13 | loss: 0.0000030
	speed: 0.0689s/iter; left time: 1207.1750s
	iters: 400, epoch: 13 | loss: 0.0022778
	speed: 0.0656s/iter; left time: 1143.0027s
Epoch: 13 cost time: 31.832680463790894
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.253 Vali Acc: 0.967 Test Loss: 0.253 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000313
	speed: 0.3970s/iter; left time: 6849.9284s
	iters: 200, epoch: 14 | loss: 0.0024349
	speed: 0.0645s/iter; left time: 1105.8672s
	iters: 300, epoch: 14 | loss: 0.0006211
	speed: 0.0605s/iter; left time: 1031.1618s
	iters: 400, epoch: 14 | loss: 0.0014569
	speed: 0.0609s/iter; left time: 1033.0356s
Epoch: 14 cost time: 30.380404949188232
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000059
	speed: 0.3942s/iter; left time: 6617.0177s
	iters: 200, epoch: 15 | loss: 0.0002168
	speed: 0.0663s/iter; left time: 1105.8450s
	iters: 300, epoch: 15 | loss: 0.0030519
	speed: 0.0675s/iter; left time: 1118.8960s
	iters: 400, epoch: 15 | loss: 0.2213425
	speed: 0.0709s/iter; left time: 1169.1059s
Epoch: 15 cost time: 32.72509789466858
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.327 Vali Acc: 0.969 Test Loss: 0.327 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0699642
	speed: 0.4065s/iter; left time: 6633.1836s
	iters: 200, epoch: 16 | loss: 0.0005388
	speed: 0.0668s/iter; left time: 1083.8881s
	iters: 300, epoch: 16 | loss: 0.0001039
	speed: 0.0681s/iter; left time: 1097.9186s
	iters: 400, epoch: 16 | loss: 0.7543958
	speed: 0.0694s/iter; left time: 1112.2415s
Epoch: 16 cost time: 32.45977854728699
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.340 Vali Acc: 0.955 Test Loss: 0.340 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000316
	speed: 0.4032s/iter; left time: 6389.8950s
	iters: 200, epoch: 17 | loss: 0.1083794
	speed: 0.0590s/iter; left time: 928.3549s
	iters: 300, epoch: 17 | loss: 0.0002570
	speed: 0.0669s/iter; left time: 1047.2726s
	iters: 400, epoch: 17 | loss: 0.0000006
	speed: 0.0683s/iter; left time: 1061.1559s
Epoch: 17 cost time: 31.07151699066162
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.341 Vali Acc: 0.968 Test Loss: 0.341 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000071
	speed: 0.3925s/iter; left time: 6035.2398s
	iters: 200, epoch: 18 | loss: 0.0038392
	speed: 0.0574s/iter; left time: 876.4036s
	iters: 300, epoch: 18 | loss: 0.0000204
	speed: 0.0625s/iter; left time: 948.8794s
	iters: 400, epoch: 18 | loss: 0.1199510
	speed: 0.0708s/iter; left time: 1067.6037s
Epoch: 18 cost time: 30.056470155715942
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.974 Test Loss: 0.207 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000032
	speed: 0.4150s/iter; left time: 6187.1722s
	iters: 200, epoch: 19 | loss: 0.0000020
	speed: 0.0622s/iter; left time: 921.0978s
	iters: 300, epoch: 19 | loss: 0.0210484
	speed: 0.0603s/iter; left time: 887.2215s
	iters: 400, epoch: 19 | loss: 0.2957062
	speed: 0.0632s/iter; left time: 922.6149s
Epoch: 19 cost time: 30.424007654190063
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.973 Test Loss: 0.241 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0442492
	speed: 0.4066s/iter; left time: 5871.7420s
	iters: 200, epoch: 20 | loss: 0.0000103
	speed: 0.0653s/iter; left time: 936.9225s
	iters: 300, epoch: 20 | loss: 0.0033521
	speed: 0.0661s/iter; left time: 941.9286s
	iters: 400, epoch: 20 | loss: 0.0129832
	speed: 0.0634s/iter; left time: 896.1539s
Epoch: 20 cost time: 30.730774641036987
Epoch: 20, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.974 Test Loss: 0.207 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000141
	speed: 0.4105s/iter; left time: 5735.3416s
	iters: 200, epoch: 21 | loss: 0.0567674
	speed: 0.0645s/iter; left time: 895.0511s
	iters: 300, epoch: 21 | loss: 0.0000007
	speed: 0.0646s/iter; left time: 890.0804s
	iters: 400, epoch: 21 | loss: 0.0000009
	speed: 0.0629s/iter; left time: 859.8867s
Epoch: 21 cost time: 31.021520614624023
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.250 Vali Acc: 0.968 Test Loss: 0.250 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0039139
	speed: 0.3528s/iter; left time: 4763.9614s
	iters: 200, epoch: 22 | loss: 0.0000573
	speed: 0.0520s/iter; left time: 696.5622s
	iters: 300, epoch: 22 | loss: 0.0017385
	speed: 0.0618s/iter; left time: 822.1626s
	iters: 400, epoch: 22 | loss: 0.0000265
	speed: 0.0699s/iter; left time: 922.4735s
Epoch: 22 cost time: 29.4561984539032
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 1115658
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2264265
	speed: 0.0901s/iter; left time: 2104.2740s
	iters: 200, epoch: 1 | loss: 0.0545828
	speed: 0.0650s/iter; left time: 1511.4839s
	iters: 300, epoch: 1 | loss: 0.0347722
	speed: 0.0745s/iter; left time: 1725.4708s
	iters: 400, epoch: 1 | loss: 0.1647686
	speed: 0.0701s/iter; left time: 1616.9839s
Epoch: 1 cost time: 34.30384612083435
Epoch: 1, Steps: 469 | Train Loss: 0.305 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (inf --> -0.946253).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0032931
	speed: 0.3835s/iter; left time: 8775.4810s
	iters: 200, epoch: 2 | loss: 0.0919433
	speed: 0.0691s/iter; left time: 1574.7079s
	iters: 300, epoch: 2 | loss: 0.0105941
	speed: 0.0707s/iter; left time: 1603.4869s
	iters: 400, epoch: 2 | loss: 0.0846545
	speed: 0.0698s/iter; left time: 1576.2421s
Epoch: 2 cost time: 33.10039663314819
Epoch: 2, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.946253 --> -0.976843).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0052997
	speed: 0.3985s/iter; left time: 8932.6158s
	iters: 200, epoch: 3 | loss: 0.0588925
	speed: 0.0640s/iter; left time: 1427.5083s
	iters: 300, epoch: 3 | loss: 0.0907422
	speed: 0.0672s/iter; left time: 1491.8236s
	iters: 400, epoch: 3 | loss: 0.0226078
	speed: 0.0671s/iter; left time: 1483.0525s
Epoch: 3 cost time: 31.154059171676636
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0805612
	speed: 0.3945s/iter; left time: 8657.1821s
	iters: 200, epoch: 4 | loss: 0.0021650
	speed: 0.0664s/iter; left time: 1451.3511s
	iters: 300, epoch: 4 | loss: 0.0035202
	speed: 0.0617s/iter; left time: 1341.4063s
	iters: 400, epoch: 4 | loss: 0.0567888
	speed: 0.0635s/iter; left time: 1374.0363s
Epoch: 4 cost time: 30.77231502532959
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.293 Vali Acc: 0.938 Test Loss: 0.293 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0035199
	speed: 0.4063s/iter; left time: 8724.3436s
	iters: 200, epoch: 5 | loss: 0.0004647
	speed: 0.0674s/iter; left time: 1440.6014s
	iters: 300, epoch: 5 | loss: 0.0021127
	speed: 0.0684s/iter; left time: 1455.1286s
	iters: 400, epoch: 5 | loss: 0.1272933
	speed: 0.0651s/iter; left time: 1378.0176s
Epoch: 5 cost time: 32.33694577217102
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.207 Vali Acc: 0.960 Test Loss: 0.207 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002199
	speed: 0.4220s/iter; left time: 8864.9924s
	iters: 200, epoch: 6 | loss: 0.0001449
	speed: 0.0667s/iter; left time: 1395.1576s
	iters: 300, epoch: 6 | loss: 0.0000585
	speed: 0.0676s/iter; left time: 1406.7418s
	iters: 400, epoch: 6 | loss: 0.0006356
	speed: 0.0658s/iter; left time: 1363.2118s
Epoch: 6 cost time: 32.070040225982666
Epoch: 6, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977700).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005059
	speed: 0.4262s/iter; left time: 8753.2219s
	iters: 200, epoch: 7 | loss: 0.0014269
	speed: 0.0661s/iter; left time: 1351.6300s
	iters: 300, epoch: 7 | loss: 0.0264321
	speed: 0.0667s/iter; left time: 1356.3609s
	iters: 400, epoch: 7 | loss: 0.0802098
	speed: 0.0668s/iter; left time: 1351.9754s
Epoch: 7 cost time: 32.22428345680237
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0008987
	speed: 0.4050s/iter; left time: 8126.6317s
	iters: 200, epoch: 8 | loss: 0.0036382
	speed: 0.0663s/iter; left time: 1323.9663s
	iters: 300, epoch: 8 | loss: 0.6930241
	speed: 0.0673s/iter; left time: 1336.3472s
	iters: 400, epoch: 8 | loss: 0.0321340
	speed: 0.0669s/iter; left time: 1321.5205s
Epoch: 8 cost time: 31.877117395401
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0093294
	speed: 0.4131s/iter; left time: 8095.5788s
	iters: 200, epoch: 9 | loss: 0.0217037
	speed: 0.0698s/iter; left time: 1361.7387s
	iters: 300, epoch: 9 | loss: 0.0000139
	speed: 0.0660s/iter; left time: 1280.7188s
	iters: 400, epoch: 9 | loss: 0.0024683
	speed: 0.0652s/iter; left time: 1257.5628s
Epoch: 9 cost time: 31.98611092567444
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0015184
	speed: 0.4087s/iter; left time: 7819.3538s
	iters: 200, epoch: 10 | loss: 0.0000077
	speed: 0.0656s/iter; left time: 1247.5384s
	iters: 300, epoch: 10 | loss: 0.0000065
	speed: 0.0653s/iter; left time: 1236.4603s
	iters: 400, epoch: 10 | loss: 0.0000278
	speed: 0.0650s/iter; left time: 1224.0917s
Epoch: 10 cost time: 31.26468276977539
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.971 Test Loss: 0.213 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000009
	speed: 0.3976s/iter; left time: 7419.4829s
	iters: 200, epoch: 11 | loss: 0.0005935
	speed: 0.0659s/iter; left time: 1223.7763s
	iters: 300, epoch: 11 | loss: 0.0003745
	speed: 0.0655s/iter; left time: 1209.3556s
	iters: 400, epoch: 11 | loss: 0.0010963
	speed: 0.0640s/iter; left time: 1175.6289s
Epoch: 11 cost time: 30.937628984451294
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0015579
	speed: 0.4036s/iter; left time: 7341.5232s
	iters: 200, epoch: 12 | loss: 0.0001024
	speed: 0.0638s/iter; left time: 1154.4067s
	iters: 300, epoch: 12 | loss: 0.0064857
	speed: 0.0642s/iter; left time: 1155.3553s
	iters: 400, epoch: 12 | loss: 0.0001053
	speed: 0.0673s/iter; left time: 1204.5307s
Epoch: 12 cost time: 31.721118927001953
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.979 Test Loss: 0.151 Test Acc: 0.979
Validation loss decreased (-0.977700 --> -0.978558).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0415333
	speed: 0.4081s/iter; left time: 7231.8850s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0711s/iter; left time: 1253.2110s
	iters: 300, epoch: 13 | loss: 0.0000069
	speed: 0.0684s/iter; left time: 1198.3268s
	iters: 400, epoch: 13 | loss: 0.0008145
	speed: 0.0712s/iter; left time: 1240.2859s
Epoch: 13 cost time: 33.00074124336243
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0023734
	speed: 0.4125s/iter; left time: 7117.2615s
	iters: 200, epoch: 14 | loss: 0.0007017
	speed: 0.0656s/iter; left time: 1125.6965s
	iters: 300, epoch: 14 | loss: 0.0000022
	speed: 0.0714s/iter; left time: 1217.1846s
	iters: 400, epoch: 14 | loss: 0.0202855
	speed: 0.0713s/iter; left time: 1207.9790s
Epoch: 14 cost time: 33.36202120780945
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.969 Test Loss: 0.202 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0002478
	speed: 0.4032s/iter; left time: 6768.0567s
	iters: 200, epoch: 15 | loss: 0.0092426
	speed: 0.0649s/iter; left time: 1083.4252s
	iters: 300, epoch: 15 | loss: 0.0000512
	speed: 0.0652s/iter; left time: 1080.6826s
	iters: 400, epoch: 15 | loss: 0.0000034
	speed: 0.0713s/iter; left time: 1175.5586s
Epoch: 15 cost time: 31.69518208503723
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.322 Vali Acc: 0.964 Test Loss: 0.322 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000684
	speed: 0.4156s/iter; left time: 6781.5369s
	iters: 200, epoch: 16 | loss: 0.0026016
	speed: 0.0629s/iter; left time: 1020.1284s
	iters: 300, epoch: 16 | loss: 0.0008414
	speed: 0.0646s/iter; left time: 1041.2677s
	iters: 400, epoch: 16 | loss: 0.0000169
	speed: 0.0676s/iter; left time: 1083.0007s
Epoch: 16 cost time: 31.08392596244812
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.181 Vali Acc: 0.976 Test Loss: 0.181 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000008
	speed: 0.3912s/iter; left time: 6199.0400s
	iters: 200, epoch: 17 | loss: 0.0000025
	speed: 0.0582s/iter; left time: 916.1162s
	iters: 300, epoch: 17 | loss: 0.0000483
	speed: 0.0590s/iter; left time: 922.5481s
	iters: 400, epoch: 17 | loss: 0.0000009
	speed: 0.0597s/iter; left time: 928.3080s
Epoch: 17 cost time: 28.30625891685486
Epoch: 17, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.970 Test Loss: 0.224 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0536155
	speed: 0.3587s/iter; left time: 5516.1651s
	iters: 200, epoch: 18 | loss: 0.0000186
	speed: 0.0600s/iter; left time: 916.7519s
	iters: 300, epoch: 18 | loss: 0.0007901
	speed: 0.0601s/iter; left time: 911.8262s
	iters: 400, epoch: 18 | loss: 0.0084272
	speed: 0.0628s/iter; left time: 947.2869s
Epoch: 18 cost time: 28.678356409072876
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.259 Vali Acc: 0.969 Test Loss: 0.259 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1631670
	speed: 0.3878s/iter; left time: 5781.1017s
	iters: 200, epoch: 19 | loss: 0.0000014
	speed: 0.0621s/iter; left time: 919.1850s
	iters: 300, epoch: 19 | loss: 0.0000380
	speed: 0.0640s/iter; left time: 941.3430s
	iters: 400, epoch: 19 | loss: 0.0000052
	speed: 0.0644s/iter; left time: 940.2969s
Epoch: 19 cost time: 30.52962899208069
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.968 Test Loss: 0.242 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000280
	speed: 0.3938s/iter; left time: 5686.9509s
	iters: 200, epoch: 20 | loss: 0.0606250
	speed: 0.0624s/iter; left time: 895.0509s
	iters: 300, epoch: 20 | loss: 0.0000102
	speed: 0.0652s/iter; left time: 927.8806s
	iters: 400, epoch: 20 | loss: 0.0001279
	speed: 0.0620s/iter; left time: 876.8011s
Epoch: 20 cost time: 30.385979652404785
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000122
	speed: 0.3726s/iter; left time: 5206.2243s
	iters: 200, epoch: 21 | loss: 0.0000367
	speed: 0.0578s/iter; left time: 801.3820s
	iters: 300, epoch: 21 | loss: 0.0000004
	speed: 0.0664s/iter; left time: 914.3208s
	iters: 400, epoch: 21 | loss: 0.0000812
	speed: 0.0668s/iter; left time: 913.8976s
Epoch: 21 cost time: 30.31974983215332
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.976 Test Loss: 0.181 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000954
	speed: 0.3843s/iter; left time: 5189.2327s
	iters: 200, epoch: 22 | loss: 0.0000324
	speed: 0.0532s/iter; left time: 713.0070s
	iters: 300, epoch: 22 | loss: 0.0000003
	speed: 0.0605s/iter; left time: 804.5699s
	iters: 400, epoch: 22 | loss: 0.0000010
	speed: 0.0576s/iter; left time: 760.2144s
Epoch: 22 cost time: 27.342907667160034
Epoch: 22, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.249 Vali Acc: 0.974 Test Loss: 0.249 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 1115914
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5259823
	speed: 0.0776s/iter; left time: 1811.3324s
	iters: 200, epoch: 1 | loss: 0.2344018
	speed: 0.0564s/iter; left time: 1312.4044s
	iters: 300, epoch: 1 | loss: 0.0418392
	speed: 0.0540s/iter; left time: 1251.0697s
	iters: 400, epoch: 1 | loss: 0.1320684
	speed: 0.0537s/iter; left time: 1238.3168s
Epoch: 1 cost time: 27.89432191848755
Epoch: 1, Steps: 469 | Train Loss: 0.428 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
Validation loss decreased (inf --> -0.963406).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0112998
	speed: 0.3266s/iter; left time: 7472.4068s
	iters: 200, epoch: 2 | loss: 0.0833580
	speed: 0.0584s/iter; left time: 1330.3022s
	iters: 300, epoch: 2 | loss: 0.0023316
	speed: 0.0564s/iter; left time: 1280.3855s
	iters: 400, epoch: 2 | loss: 0.0031790
	speed: 0.0521s/iter; left time: 1176.2905s
Epoch: 2 cost time: 26.09659194946289
Epoch: 2, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.963406 --> -0.969696).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034028
	speed: 0.3251s/iter; left time: 7285.5949s
	iters: 200, epoch: 3 | loss: 0.0251799
	speed: 0.0542s/iter; left time: 1208.4527s
	iters: 300, epoch: 3 | loss: 0.0071335
	speed: 0.0540s/iter; left time: 1199.8300s
	iters: 400, epoch: 3 | loss: 0.0069190
	speed: 0.0552s/iter; left time: 1220.7978s
Epoch: 3 cost time: 26.292211055755615
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.969696 --> -0.974841).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5828561
	speed: 0.3404s/iter; left time: 7469.4618s
	iters: 200, epoch: 4 | loss: 0.0984994
	speed: 0.0569s/iter; left time: 1241.9634s
	iters: 300, epoch: 4 | loss: 0.0312173
	speed: 0.0568s/iter; left time: 1234.6155s
	iters: 400, epoch: 4 | loss: 0.0004651
	speed: 0.0530s/iter; left time: 1146.8738s
Epoch: 4 cost time: 26.227715015411377
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0126937
	speed: 0.3261s/iter; left time: 7002.3259s
	iters: 200, epoch: 5 | loss: 0.0723452
	speed: 0.0525s/iter; left time: 1121.6572s
	iters: 300, epoch: 5 | loss: 0.4309473
	speed: 0.0579s/iter; left time: 1231.3806s
	iters: 400, epoch: 5 | loss: 0.0249890
	speed: 0.0542s/iter; left time: 1147.1014s
Epoch: 5 cost time: 25.93463444709778
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0007447
	speed: 0.3376s/iter; left time: 7091.2715s
	iters: 200, epoch: 6 | loss: 0.2261116
	speed: 0.0516s/iter; left time: 1079.2914s
	iters: 300, epoch: 6 | loss: 0.0004330
	speed: 0.0548s/iter; left time: 1139.2030s
	iters: 400, epoch: 6 | loss: 0.0314830
	speed: 0.0573s/iter; left time: 1186.0384s
Epoch: 6 cost time: 26.004068851470947
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0029305
	speed: 0.3403s/iter; left time: 6988.8123s
	iters: 200, epoch: 7 | loss: 0.0016701
	speed: 0.0564s/iter; left time: 1151.9730s
	iters: 300, epoch: 7 | loss: 0.0071620
	speed: 0.0538s/iter; left time: 1094.1251s
	iters: 400, epoch: 7 | loss: 0.0088455
	speed: 0.0543s/iter; left time: 1098.8993s
Epoch: 7 cost time: 26.607717514038086
Epoch: 7, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.194 Vali Acc: 0.973 Test Loss: 0.194 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0003266
	speed: 0.3516s/iter; left time: 7056.5789s
	iters: 200, epoch: 8 | loss: 0.0216223
	speed: 0.0517s/iter; left time: 1031.9339s
	iters: 300, epoch: 8 | loss: 0.0013290
	speed: 0.0484s/iter; left time: 962.0231s
	iters: 400, epoch: 8 | loss: 0.0369858
	speed: 0.0508s/iter; left time: 1003.7970s
Epoch: 8 cost time: 24.38039803504944
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
Validation loss decreased (-0.974841 --> -0.975985).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0459791
	speed: 0.3547s/iter; left time: 6951.8003s
	iters: 200, epoch: 9 | loss: 0.0008411
	speed: 0.0540s/iter; left time: 1053.0996s
	iters: 300, epoch: 9 | loss: 0.0016664
	speed: 0.0557s/iter; left time: 1081.3356s
	iters: 400, epoch: 9 | loss: 0.0139849
	speed: 0.0499s/iter; left time: 962.6728s
Epoch: 9 cost time: 26.07610559463501
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000499
	speed: 0.3476s/iter; left time: 6648.6691s
	iters: 200, epoch: 10 | loss: 0.0000982
	speed: 0.0591s/iter; left time: 1124.3809s
	iters: 300, epoch: 10 | loss: 0.0028013
	speed: 0.0553s/iter; left time: 1046.3942s
	iters: 400, epoch: 10 | loss: 0.0015151
	speed: 0.0550s/iter; left time: 1034.9088s
Epoch: 10 cost time: 26.755307912826538
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.968 Test Loss: 0.196 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0019767
	speed: 0.3538s/iter; left time: 6603.1234s
	iters: 200, epoch: 11 | loss: 0.0046986
	speed: 0.0570s/iter; left time: 1058.4361s
	iters: 300, epoch: 11 | loss: 0.0811343
	speed: 0.0567s/iter; left time: 1047.2374s
	iters: 400, epoch: 11 | loss: 0.1732652
	speed: 0.0592s/iter; left time: 1086.9653s
Epoch: 11 cost time: 27.44365954399109
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977128).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0045960
	speed: 0.3360s/iter; left time: 6112.0439s
	iters: 200, epoch: 12 | loss: 0.0094855
	speed: 0.0542s/iter; left time: 981.2588s
	iters: 300, epoch: 12 | loss: 0.0003874
	speed: 0.0554s/iter; left time: 996.2849s
	iters: 400, epoch: 12 | loss: 0.0432889
	speed: 0.0572s/iter; left time: 1024.2989s
Epoch: 12 cost time: 26.668333768844604
Epoch: 12, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000192
	speed: 0.3349s/iter; left time: 5934.7879s
	iters: 200, epoch: 13 | loss: 0.1083367
	speed: 0.0482s/iter; left time: 849.2131s
	iters: 300, epoch: 13 | loss: 0.0017993
	speed: 0.0533s/iter; left time: 933.3254s
	iters: 400, epoch: 13 | loss: 0.0024494
	speed: 0.0554s/iter; left time: 965.9118s
Epoch: 13 cost time: 25.024226665496826
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.966 Test Loss: 0.209 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0002524
	speed: 0.3377s/iter; left time: 5827.2522s
	iters: 200, epoch: 14 | loss: 0.0065376
	speed: 0.0503s/iter; left time: 863.2681s
	iters: 300, epoch: 14 | loss: 0.0000106
	speed: 0.0513s/iter; left time: 874.9444s
	iters: 400, epoch: 14 | loss: 0.0000822
	speed: 0.0534s/iter; left time: 905.3301s
Epoch: 14 cost time: 24.659713983535767
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0055075
	speed: 0.3285s/iter; left time: 5514.5458s
	iters: 200, epoch: 15 | loss: 0.0000265
	speed: 0.0508s/iter; left time: 846.9637s
	iters: 300, epoch: 15 | loss: 0.0001856
	speed: 0.0538s/iter; left time: 891.8895s
	iters: 400, epoch: 15 | loss: 0.0000783
	speed: 0.0546s/iter; left time: 900.1968s
Epoch: 15 cost time: 25.730222463607788
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.977128 --> -0.979987).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0005767
	speed: 0.3455s/iter; left time: 5636.3652s
	iters: 200, epoch: 16 | loss: 0.0009019
	speed: 0.0487s/iter; left time: 790.2086s
	iters: 300, epoch: 16 | loss: 0.0000695
	speed: 0.0488s/iter; left time: 786.8512s
	iters: 400, epoch: 16 | loss: 0.0054061
	speed: 0.0534s/iter; left time: 854.6173s
Epoch: 16 cost time: 24.190367221832275
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000252
	speed: 0.3502s/iter; left time: 5550.2214s
	iters: 200, epoch: 17 | loss: 0.0001160
	speed: 0.0515s/iter; left time: 810.5588s
	iters: 300, epoch: 17 | loss: 0.0149668
	speed: 0.0456s/iter; left time: 713.9158s
	iters: 400, epoch: 17 | loss: 0.0027670
	speed: 0.0485s/iter; left time: 754.5060s
Epoch: 17 cost time: 24.05098247528076
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
Validation loss decreased (-0.979987 --> -0.982274).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0003443
	speed: 0.3305s/iter; left time: 5082.3072s
	iters: 200, epoch: 18 | loss: 0.0001819
	speed: 0.0578s/iter; left time: 883.0687s
	iters: 300, epoch: 18 | loss: 0.0002728
	speed: 0.0548s/iter; left time: 831.4193s
	iters: 400, epoch: 18 | loss: 0.0004681
	speed: 0.0511s/iter; left time: 770.1631s
Epoch: 18 cost time: 25.828277587890625
Epoch: 18, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.144 Vali Acc: 0.982 Test Loss: 0.144 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0001217
	speed: 0.3265s/iter; left time: 4867.0512s
	iters: 200, epoch: 19 | loss: 0.0151235
	speed: 0.0562s/iter; left time: 832.7550s
	iters: 300, epoch: 19 | loss: 0.0007301
	speed: 0.0574s/iter; left time: 844.6190s
	iters: 400, epoch: 19 | loss: 0.0022505
	speed: 0.0565s/iter; left time: 825.4004s
Epoch: 19 cost time: 26.86463689804077
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000056
	speed: 0.3350s/iter; left time: 4836.8909s
	iters: 200, epoch: 20 | loss: 0.0000243
	speed: 0.0534s/iter; left time: 766.0562s
	iters: 300, epoch: 20 | loss: 0.0000591
	speed: 0.0573s/iter; left time: 815.7943s
	iters: 400, epoch: 20 | loss: 0.0006059
	speed: 0.0573s/iter; left time: 810.4581s
Epoch: 20 cost time: 26.63565993309021
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0085912
	speed: 0.3291s/iter; left time: 4598.1549s
	iters: 200, epoch: 21 | loss: 0.0621925
	speed: 0.0482s/iter; left time: 669.0011s
	iters: 300, epoch: 21 | loss: 0.0000365
	speed: 0.0515s/iter; left time: 709.0541s
	iters: 400, epoch: 21 | loss: 0.0027155
	speed: 0.0520s/iter; left time: 711.3151s
Epoch: 21 cost time: 23.937242031097412
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000869
	speed: 0.3105s/iter; left time: 4191.8273s
	iters: 200, epoch: 22 | loss: 0.0591782
	speed: 0.0523s/iter; left time: 701.4040s
	iters: 300, epoch: 22 | loss: 0.0009834
	speed: 0.0570s/iter; left time: 758.8558s
	iters: 400, epoch: 22 | loss: 0.0036733
	speed: 0.0573s/iter; left time: 756.6409s
Epoch: 22 cost time: 26.501315116882324
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0015826
	speed: 0.3267s/iter; left time: 4257.5421s
	iters: 200, epoch: 23 | loss: 0.1731000
	speed: 0.0579s/iter; left time: 748.7226s
	iters: 300, epoch: 23 | loss: 0.0000011
	speed: 0.0580s/iter; left time: 743.7002s
	iters: 400, epoch: 23 | loss: 0.0021356
	speed: 0.0540s/iter; left time: 687.5375s
Epoch: 23 cost time: 26.599975109100342
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.974 Test Loss: 0.171 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000193
	speed: 0.3354s/iter; left time: 4213.6176s
	iters: 200, epoch: 24 | loss: 0.0000017
	speed: 0.0529s/iter; left time: 659.5843s
	iters: 300, epoch: 24 | loss: 0.0004480
	speed: 0.0533s/iter; left time: 658.8519s
	iters: 400, epoch: 24 | loss: 0.0019676
	speed: 0.0559s/iter; left time: 685.7807s
Epoch: 24 cost time: 25.31807589530945
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0224531
	speed: 0.3220s/iter; left time: 3894.2701s
	iters: 200, epoch: 25 | loss: 0.0000021
	speed: 0.0504s/iter; left time: 604.6139s
	iters: 300, epoch: 25 | loss: 0.0014359
	speed: 0.0495s/iter; left time: 588.4843s
	iters: 400, epoch: 25 | loss: 0.0078218
	speed: 0.0522s/iter; left time: 615.3504s
Epoch: 25 cost time: 24.45489764213562
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.967 Test Loss: 0.264 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000004
	speed: 0.3385s/iter; left time: 3935.3511s
	iters: 200, epoch: 26 | loss: 0.0000323
	speed: 0.0534s/iter; left time: 615.1421s
	iters: 300, epoch: 26 | loss: 0.0000143
	speed: 0.0499s/iter; left time: 570.3767s
	iters: 400, epoch: 26 | loss: 0.0000395
	speed: 0.0525s/iter; left time: 594.2969s
Epoch: 26 cost time: 25.016441822052002
Epoch: 26, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.978 Test Loss: 0.189 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0005752
	speed: 0.3302s/iter; left time: 3684.2327s
	iters: 200, epoch: 27 | loss: 0.0002152
	speed: 0.0555s/iter; left time: 613.1161s
	iters: 300, epoch: 27 | loss: 0.0004444
	speed: 0.0549s/iter; left time: 601.3658s
	iters: 400, epoch: 27 | loss: 0.0000560
	speed: 0.0562s/iter; left time: 609.8563s
Epoch: 27 cost time: 26.4680814743042
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 295690
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3494579
	speed: 0.0780s/iter; left time: 1820.9755s
	iters: 200, epoch: 1 | loss: 0.4641294
	speed: 0.0585s/iter; left time: 1360.0622s
	iters: 300, epoch: 1 | loss: 0.1633256
	speed: 0.0544s/iter; left time: 1260.1863s
	iters: 400, epoch: 1 | loss: 0.0553030
	speed: 0.0532s/iter; left time: 1226.4528s
Epoch: 1 cost time: 28.11695957183838
Epoch: 1, Steps: 469 | Train Loss: 0.410 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
Validation loss decreased (inf --> -0.959690).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0680189
	speed: 0.3467s/iter; left time: 7932.3094s
	iters: 200, epoch: 2 | loss: 0.0627130
	speed: 0.0586s/iter; left time: 1335.1185s
	iters: 300, epoch: 2 | loss: 0.0051059
	speed: 0.0594s/iter; left time: 1347.3356s
	iters: 400, epoch: 2 | loss: 0.0709080
	speed: 0.0533s/iter; left time: 1204.2595s
Epoch: 2 cost time: 26.918137788772583
Epoch: 2, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0146396
	speed: 0.3317s/iter; left time: 7434.5996s
	iters: 200, epoch: 3 | loss: 0.0039332
	speed: 0.0567s/iter; left time: 1266.0502s
	iters: 300, epoch: 3 | loss: 0.1744595
	speed: 0.0536s/iter; left time: 1191.4838s
	iters: 400, epoch: 3 | loss: 0.3078903
	speed: 0.0530s/iter; left time: 1170.9786s
Epoch: 3 cost time: 26.383436918258667
Epoch: 3, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0002479
	speed: 0.3518s/iter; left time: 7720.9139s
	iters: 200, epoch: 4 | loss: 0.0018385
	speed: 0.0619s/iter; left time: 1351.1081s
	iters: 300, epoch: 4 | loss: 0.0028376
	speed: 0.0629s/iter; left time: 1367.2415s
	iters: 400, epoch: 4 | loss: 0.0032602
	speed: 0.0602s/iter; left time: 1302.5080s
Epoch: 4 cost time: 28.20319962501526
Epoch: 4, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.959690 --> -0.965121).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0008878
	speed: 0.3442s/iter; left time: 7391.3455s
	iters: 200, epoch: 5 | loss: 0.1023756
	speed: 0.0526s/iter; left time: 1124.9485s
	iters: 300, epoch: 5 | loss: 0.0008663
	speed: 0.0537s/iter; left time: 1142.1554s
	iters: 400, epoch: 5 | loss: 0.0003856
	speed: 0.0581s/iter; left time: 1230.1908s
Epoch: 5 cost time: 26.640419960021973
Epoch: 5, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
Validation loss decreased (-0.965121 --> -0.973698).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003992
	speed: 0.3516s/iter; left time: 7385.1996s
	iters: 200, epoch: 6 | loss: 0.2068037
	speed: 0.0517s/iter; left time: 1080.8140s
	iters: 300, epoch: 6 | loss: 0.0001824
	speed: 0.0484s/iter; left time: 1007.2528s
	iters: 400, epoch: 6 | loss: 0.0143296
	speed: 0.0464s/iter; left time: 961.7261s
Epoch: 6 cost time: 23.530861616134644
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2407491
	speed: 0.3484s/iter; left time: 7154.6559s
	iters: 200, epoch: 7 | loss: 0.5086476
	speed: 0.0546s/iter; left time: 1115.8642s
	iters: 300, epoch: 7 | loss: 0.0011104
	speed: 0.0528s/iter; left time: 1073.9198s
	iters: 400, epoch: 7 | loss: 0.0008962
	speed: 0.0547s/iter; left time: 1107.4470s
Epoch: 7 cost time: 26.4520525932312
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.973698 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0006127
	speed: 0.3441s/iter; left time: 6905.6794s
	iters: 200, epoch: 8 | loss: 0.0006358
	speed: 0.0588s/iter; left time: 1175.0655s
	iters: 300, epoch: 8 | loss: 0.0001861
	speed: 0.0548s/iter; left time: 1088.8767s
	iters: 400, epoch: 8 | loss: 0.0053621
	speed: 0.0535s/iter; left time: 1057.0361s
Epoch: 8 cost time: 26.65957260131836
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0314865
	speed: 0.3108s/iter; left time: 6091.7873s
	iters: 200, epoch: 9 | loss: 0.0000218
	speed: 0.0612s/iter; left time: 1193.7285s
	iters: 300, epoch: 9 | loss: 0.0000380
	speed: 0.0650s/iter; left time: 1260.5976s
	iters: 400, epoch: 9 | loss: 0.0068945
	speed: 0.0627s/iter; left time: 1210.5369s
Epoch: 9 cost time: 29.537291526794434
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.979130).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000143
	speed: 0.3866s/iter; left time: 7396.0637s
	iters: 200, epoch: 10 | loss: 0.0000422
	speed: 0.0692s/iter; left time: 1316.3251s
	iters: 300, epoch: 10 | loss: 0.0000416
	speed: 0.0728s/iter; left time: 1378.4948s
	iters: 400, epoch: 10 | loss: 0.0019543
	speed: 0.0685s/iter; left time: 1290.7268s
Epoch: 10 cost time: 33.15753173828125
Epoch: 10, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001473
	speed: 0.3942s/iter; left time: 7356.8273s
	iters: 200, epoch: 11 | loss: 0.0012027
	speed: 0.0636s/iter; left time: 1180.4327s
	iters: 300, epoch: 11 | loss: 0.0001113
	speed: 0.0629s/iter; left time: 1161.2732s
	iters: 400, epoch: 11 | loss: 0.0002185
	speed: 0.0591s/iter; left time: 1085.6749s
Epoch: 11 cost time: 30.591670751571655
Epoch: 11, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0258320
	speed: 0.4055s/iter; left time: 7376.5889s
	iters: 200, epoch: 12 | loss: 0.0071325
	speed: 0.0678s/iter; left time: 1226.1587s
	iters: 300, epoch: 12 | loss: 0.0004435
	speed: 0.0643s/iter; left time: 1156.7687s
	iters: 400, epoch: 12 | loss: 0.1223262
	speed: 0.0599s/iter; left time: 1072.3957s
Epoch: 12 cost time: 31.328325033187866
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1818630
	speed: 0.4019s/iter; left time: 7123.5429s
	iters: 200, epoch: 13 | loss: 0.0024777
	speed: 0.0694s/iter; left time: 1222.6625s
	iters: 300, epoch: 13 | loss: 0.0002233
	speed: 0.0743s/iter; left time: 1302.4442s
	iters: 400, epoch: 13 | loss: 0.0010644
	speed: 0.0711s/iter; left time: 1239.5683s
Epoch: 13 cost time: 34.284616231918335
Epoch: 13, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0440080
	speed: 0.4013s/iter; left time: 6923.4508s
	iters: 200, epoch: 14 | loss: 0.0002755
	speed: 0.0694s/iter; left time: 1190.2746s
	iters: 300, epoch: 14 | loss: 0.0006756
	speed: 0.0722s/iter; left time: 1231.3718s
	iters: 400, epoch: 14 | loss: 0.3317368
	speed: 0.0731s/iter; left time: 1238.7067s
Epoch: 14 cost time: 33.83960485458374
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000211
	speed: 0.3998s/iter; left time: 6710.4194s
	iters: 200, epoch: 15 | loss: 0.0002611
	speed: 0.0706s/iter; left time: 1177.5586s
	iters: 300, epoch: 15 | loss: 0.0522769
	speed: 0.0716s/iter; left time: 1187.1157s
	iters: 400, epoch: 15 | loss: 0.0001409
	speed: 0.0735s/iter; left time: 1211.6551s
Epoch: 15 cost time: 33.693350076675415
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000383
	speed: 0.3589s/iter; left time: 5855.5339s
	iters: 200, epoch: 16 | loss: 0.0005201
	speed: 0.0646s/iter; left time: 1047.6769s
	iters: 300, epoch: 16 | loss: 0.0037335
	speed: 0.0654s/iter; left time: 1053.4639s
	iters: 400, epoch: 16 | loss: 0.0004516
	speed: 0.0697s/iter; left time: 1116.1877s
Epoch: 16 cost time: 31.540830373764038
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000533
	speed: 0.4157s/iter; left time: 6587.6860s
	iters: 200, epoch: 17 | loss: 0.0119253
	speed: 0.0652s/iter; left time: 1026.7460s
	iters: 300, epoch: 17 | loss: 0.0014346
	speed: 0.0647s/iter; left time: 1011.8090s
	iters: 400, epoch: 17 | loss: 0.0063474
	speed: 0.0632s/iter; left time: 983.3437s
Epoch: 17 cost time: 30.869804620742798
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000232
	speed: 0.3998s/iter; left time: 6148.4716s
	iters: 200, epoch: 18 | loss: 0.0002191
	speed: 0.0735s/iter; left time: 1123.3161s
	iters: 300, epoch: 18 | loss: 0.0029985
	speed: 0.0668s/iter; left time: 1013.2612s
	iters: 400, epoch: 18 | loss: 0.0012879
	speed: 0.0644s/iter; left time: 970.9090s
Epoch: 18 cost time: 32.683080434799194
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0485806
	speed: 0.3894s/iter; left time: 5805.0439s
	iters: 200, epoch: 19 | loss: 0.0000551
	speed: 0.0714s/iter; left time: 1057.5366s
	iters: 300, epoch: 19 | loss: 0.0012523
	speed: 0.0669s/iter; left time: 984.2359s
	iters: 400, epoch: 19 | loss: 0.0000231
	speed: 0.0668s/iter; left time: 976.6081s
Epoch: 19 cost time: 32.98060846328735
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 295818
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7475119
	speed: 0.0762s/iter; left time: 1778.2365s
	iters: 200, epoch: 1 | loss: 0.6332765
	speed: 0.0553s/iter; left time: 1286.3861s
	iters: 300, epoch: 1 | loss: 0.2153871
	speed: 0.0521s/iter; left time: 1205.1911s
	iters: 400, epoch: 1 | loss: 0.2353549
	speed: 0.0511s/iter; left time: 1178.9536s
Epoch: 1 cost time: 26.62787938117981
Epoch: 1, Steps: 469 | Train Loss: 0.586 Vali Loss: 0.263 Vali Acc: 0.928 Test Loss: 0.263 Test Acc: 0.928
Validation loss decreased (inf --> -0.927670).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0816103
	speed: 0.3070s/iter; left time: 7023.7335s
	iters: 200, epoch: 2 | loss: 0.0065691
	speed: 0.0466s/iter; left time: 1060.6805s
	iters: 300, epoch: 2 | loss: 0.1229439
	speed: 0.0473s/iter; left time: 1071.7767s
	iters: 400, epoch: 2 | loss: 0.0794939
	speed: 0.0541s/iter; left time: 1220.8607s
Epoch: 2 cost time: 23.706140518188477
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
Validation loss decreased (-0.927670 --> -0.967408).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0025522
	speed: 0.3505s/iter; left time: 7855.3061s
	iters: 200, epoch: 3 | loss: 0.1664141
	speed: 0.0473s/iter; left time: 1054.3925s
	iters: 300, epoch: 3 | loss: 0.0132517
	speed: 0.0470s/iter; left time: 1043.4398s
	iters: 400, epoch: 3 | loss: 0.1050153
	speed: 0.0488s/iter; left time: 1078.1779s
Epoch: 3 cost time: 23.40609908103943
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.967408 --> -0.974841).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0062126
	speed: 0.3399s/iter; left time: 7458.0055s
	iters: 200, epoch: 4 | loss: 0.0157808
	speed: 0.0468s/iter; left time: 1023.2132s
	iters: 300, epoch: 4 | loss: 0.3843659
	speed: 0.0481s/iter; left time: 1046.0897s
	iters: 400, epoch: 4 | loss: 0.0110778
	speed: 0.0499s/iter; left time: 1079.4772s
Epoch: 4 cost time: 22.847370862960815
Epoch: 4, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0104870
	speed: 0.3073s/iter; left time: 6600.1723s
	iters: 200, epoch: 5 | loss: 0.0026390
	speed: 0.0503s/iter; left time: 1075.4605s
	iters: 300, epoch: 5 | loss: 0.0012333
	speed: 0.0534s/iter; left time: 1135.4992s
	iters: 400, epoch: 5 | loss: 0.0056998
	speed: 0.0523s/iter; left time: 1107.1866s
Epoch: 5 cost time: 24.570376873016357
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0108957
	speed: 0.3235s/iter; left time: 6795.2508s
	iters: 200, epoch: 6 | loss: 0.0046583
	speed: 0.0448s/iter; left time: 936.3885s
	iters: 300, epoch: 6 | loss: 0.0659900
	speed: 0.0450s/iter; left time: 937.0042s
	iters: 400, epoch: 6 | loss: 0.0008868
	speed: 0.0516s/iter; left time: 1067.6791s
Epoch: 6 cost time: 22.82502031326294
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0020083
	speed: 0.3375s/iter; left time: 6930.6537s
	iters: 200, epoch: 7 | loss: 0.1033894
	speed: 0.0531s/iter; left time: 1085.7514s
	iters: 300, epoch: 7 | loss: 0.0002467
	speed: 0.0494s/iter; left time: 1004.9762s
	iters: 400, epoch: 7 | loss: 0.0004975
	speed: 0.0485s/iter; left time: 980.8277s
Epoch: 7 cost time: 24.134061813354492
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0779920
	speed: 0.2940s/iter; left time: 5900.5350s
	iters: 200, epoch: 8 | loss: 0.0010626
	speed: 0.0326s/iter; left time: 651.9489s
	iters: 300, epoch: 8 | loss: 0.0089570
	speed: 0.0323s/iter; left time: 640.9480s
	iters: 400, epoch: 8 | loss: 0.0267577
	speed: 0.0352s/iter; left time: 696.6210s
Epoch: 8 cost time: 16.367698907852173
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0279757
	speed: 0.3142s/iter; left time: 6158.9692s
	iters: 200, epoch: 9 | loss: 0.0013241
	speed: 0.0477s/iter; left time: 931.0096s
	iters: 300, epoch: 9 | loss: 0.0144873
	speed: 0.0492s/iter; left time: 953.5303s
	iters: 400, epoch: 9 | loss: 0.0046560
	speed: 0.0462s/iter; left time: 891.1321s
Epoch: 9 cost time: 23.211305856704712
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0002877
	speed: 0.3290s/iter; left time: 6294.0756s
	iters: 200, epoch: 10 | loss: 0.0024762
	speed: 0.0491s/iter; left time: 934.9370s
	iters: 300, epoch: 10 | loss: 0.0074288
	speed: 0.0445s/iter; left time: 841.4415s
	iters: 400, epoch: 10 | loss: 0.5468944
	speed: 0.0443s/iter; left time: 834.8483s
Epoch: 10 cost time: 22.202656269073486
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974841 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0623385
	speed: 0.3148s/iter; left time: 5873.7206s
	iters: 200, epoch: 11 | loss: 0.0218626
	speed: 0.0530s/iter; left time: 983.5454s
	iters: 300, epoch: 11 | loss: 0.0203478
	speed: 0.0515s/iter; left time: 950.7159s
	iters: 400, epoch: 11 | loss: 0.0019425
	speed: 0.0489s/iter; left time: 897.4350s
Epoch: 11 cost time: 24.37360119819641
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0011184
	speed: 0.3140s/iter; left time: 5712.6203s
	iters: 200, epoch: 12 | loss: 0.0001134
	speed: 0.0488s/iter; left time: 882.7515s
	iters: 300, epoch: 12 | loss: 0.0016188
	speed: 0.0472s/iter; left time: 848.3230s
	iters: 400, epoch: 12 | loss: 0.3303413
	speed: 0.0420s/iter; left time: 751.1986s
Epoch: 12 cost time: 22.28674626350403
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0013590
	speed: 0.2884s/iter; left time: 5111.3502s
	iters: 200, epoch: 13 | loss: 0.0017905
	speed: 0.0519s/iter; left time: 914.3083s
	iters: 300, epoch: 13 | loss: 0.0128982
	speed: 0.0504s/iter; left time: 883.2452s
	iters: 400, epoch: 13 | loss: 0.0019115
	speed: 0.0502s/iter; left time: 874.1166s
Epoch: 13 cost time: 23.734440565109253
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0004216
	speed: 0.3192s/iter; left time: 5508.0308s
	iters: 200, epoch: 14 | loss: 0.0011694
	speed: 0.0458s/iter; left time: 785.5057s
	iters: 300, epoch: 14 | loss: 0.0001872
	speed: 0.0447s/iter; left time: 762.6344s
	iters: 400, epoch: 14 | loss: 0.0009593
	speed: 0.0467s/iter; left time: 792.3870s
Epoch: 14 cost time: 22.68829345703125
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.977128).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0010579
	speed: 0.3192s/iter; left time: 5357.0245s
	iters: 200, epoch: 15 | loss: 0.0001040
	speed: 0.0468s/iter; left time: 780.3817s
	iters: 300, epoch: 15 | loss: 0.0000445
	speed: 0.0479s/iter; left time: 794.1444s
	iters: 400, epoch: 15 | loss: 0.0003888
	speed: 0.0478s/iter; left time: 787.3678s
Epoch: 15 cost time: 22.96920871734619
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0008306
	speed: 0.3194s/iter; left time: 5211.9732s
	iters: 200, epoch: 16 | loss: 0.0011009
	speed: 0.0451s/iter; left time: 730.8960s
	iters: 300, epoch: 16 | loss: 0.0005242
	speed: 0.0400s/iter; left time: 645.2689s
	iters: 400, epoch: 16 | loss: 0.0001575
	speed: 0.0439s/iter; left time: 702.3574s
Epoch: 16 cost time: 20.94201135635376
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000438
	speed: 0.3055s/iter; left time: 4841.9894s
	iters: 200, epoch: 17 | loss: 0.0009140
	speed: 0.0480s/iter; left time: 755.9939s
	iters: 300, epoch: 17 | loss: 0.0003800
	speed: 0.0469s/iter; left time: 734.4548s
	iters: 400, epoch: 17 | loss: 0.0000304
	speed: 0.0467s/iter; left time: 726.5694s
Epoch: 17 cost time: 22.926573753356934
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0001555
	speed: 0.3242s/iter; left time: 4984.8739s
	iters: 200, epoch: 18 | loss: 0.0148035
	speed: 0.0499s/iter; left time: 762.3099s
	iters: 300, epoch: 18 | loss: 0.0001191
	speed: 0.0501s/iter; left time: 761.0247s
	iters: 400, epoch: 18 | loss: 0.0000413
	speed: 0.0427s/iter; left time: 644.1252s
Epoch: 18 cost time: 22.96728801727295
Epoch: 18, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.972 Test Loss: 0.236 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0006337
	speed: 0.3073s/iter; left time: 4581.2455s
	iters: 200, epoch: 19 | loss: 0.0000544
	speed: 0.0504s/iter; left time: 746.6399s
	iters: 300, epoch: 19 | loss: 0.0000541
	speed: 0.0516s/iter; left time: 758.4750s
	iters: 400, epoch: 19 | loss: 0.1134578
	speed: 0.0501s/iter; left time: 731.7619s
Epoch: 19 cost time: 24.15365982055664
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0001344
	speed: 0.2977s/iter; left time: 4299.0119s
	iters: 200, epoch: 20 | loss: 0.0000626
	speed: 0.0445s/iter; left time: 638.5373s
	iters: 300, epoch: 20 | loss: 0.0001207
	speed: 0.0512s/iter; left time: 728.9921s
	iters: 400, epoch: 20 | loss: 0.0002639
	speed: 0.0490s/iter; left time: 693.2441s
Epoch: 20 cost time: 22.69065833091736
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000681
	speed: 0.3051s/iter; left time: 4262.3649s
	iters: 200, epoch: 21 | loss: 0.0006003
	speed: 0.0501s/iter; left time: 694.5807s
	iters: 300, epoch: 21 | loss: 0.0004261
	speed: 0.0520s/iter; left time: 716.3061s
	iters: 400, epoch: 21 | loss: 0.0121880
	speed: 0.0498s/iter; left time: 681.2572s
Epoch: 21 cost time: 23.935376167297363
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0001406
	speed: 0.3137s/iter; left time: 4236.0607s
	iters: 200, epoch: 22 | loss: 0.0005957
	speed: 0.0457s/iter; left time: 612.2072s
	iters: 300, epoch: 22 | loss: 0.0000166
	speed: 0.0473s/iter; left time: 628.9751s
	iters: 400, epoch: 22 | loss: 0.0000355
	speed: 0.0483s/iter; left time: 637.7041s
Epoch: 22 cost time: 22.69258165359497
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000041
	speed: 0.3024s/iter; left time: 3940.8264s
	iters: 200, epoch: 23 | loss: 0.0019360
	speed: 0.0460s/iter; left time: 595.3652s
	iters: 300, epoch: 23 | loss: 0.2860959
	speed: 0.0447s/iter; left time: 573.6837s
	iters: 400, epoch: 23 | loss: 0.0005663
	speed: 0.0450s/iter; left time: 573.3810s
Epoch: 23 cost time: 22.044705152511597
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0004018
	speed: 0.3215s/iter; left time: 4038.7790s
	iters: 200, epoch: 24 | loss: 0.0005586
	speed: 0.0421s/iter; left time: 524.1356s
	iters: 300, epoch: 24 | loss: 0.0001782
	speed: 0.0407s/iter; left time: 502.9249s
	iters: 400, epoch: 24 | loss: 0.0090096
	speed: 0.0390s/iter; left time: 478.3317s
Epoch: 24 cost time: 20.34572124481201
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 82314
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1752582
	speed: 0.0671s/iter; left time: 1567.9533s
	iters: 200, epoch: 1 | loss: 0.3931391
	speed: 0.0455s/iter; left time: 1058.5319s
	iters: 300, epoch: 1 | loss: 0.1867983
	speed: 0.0467s/iter; left time: 1080.9297s
	iters: 400, epoch: 1 | loss: 0.3561638
	speed: 0.0477s/iter; left time: 1098.5930s
Epoch: 1 cost time: 24.17335820198059
Epoch: 1, Steps: 469 | Train Loss: 0.606 Vali Loss: 0.234 Vali Acc: 0.935 Test Loss: 0.234 Test Acc: 0.935
Validation loss decreased (inf --> -0.935103).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0466400
	speed: 0.3125s/iter; left time: 7150.6670s
	iters: 200, epoch: 2 | loss: 0.0431709
	speed: 0.0416s/iter; left time: 947.9553s
	iters: 300, epoch: 2 | loss: 0.0945581
	speed: 0.0407s/iter; left time: 922.3171s
	iters: 400, epoch: 2 | loss: 0.0870559
	speed: 0.0395s/iter; left time: 890.8816s
Epoch: 2 cost time: 20.08493733406067
Epoch: 2, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.935103 --> -0.970267).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4137227
	speed: 0.2912s/iter; left time: 6525.7673s
	iters: 200, epoch: 3 | loss: 0.1219877
	speed: 0.0455s/iter; left time: 1014.6206s
	iters: 300, epoch: 3 | loss: 0.0062035
	speed: 0.0438s/iter; left time: 972.2915s
	iters: 400, epoch: 3 | loss: 0.0174790
	speed: 0.0451s/iter; left time: 997.3450s
Epoch: 3 cost time: 21.295321702957153
Epoch: 3, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0275131
	speed: 0.2674s/iter; left time: 5866.9915s
	iters: 200, epoch: 4 | loss: 0.0034332
	speed: 0.0376s/iter; left time: 821.7520s
	iters: 300, epoch: 4 | loss: 0.0027930
	speed: 0.0393s/iter; left time: 855.5754s
	iters: 400, epoch: 4 | loss: 0.2637955
	speed: 0.0452s/iter; left time: 977.3543s
Epoch: 4 cost time: 19.728989124298096
Epoch: 4, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.971411).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0189892
	speed: 0.2851s/iter; left time: 6121.5218s
	iters: 200, epoch: 5 | loss: 0.0922235
	speed: 0.0415s/iter; left time: 887.0429s
	iters: 300, epoch: 5 | loss: 0.0221654
	speed: 0.0421s/iter; left time: 895.3104s
	iters: 400, epoch: 5 | loss: 0.0066857
	speed: 0.0440s/iter; left time: 932.0644s
Epoch: 5 cost time: 20.707849979400635
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971983).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0585263
	speed: 0.2956s/iter; left time: 6209.2708s
	iters: 200, epoch: 6 | loss: 0.0017847
	speed: 0.0432s/iter; left time: 903.1071s
	iters: 300, epoch: 6 | loss: 0.0008917
	speed: 0.0421s/iter; left time: 876.3568s
	iters: 400, epoch: 6 | loss: 0.0234755
	speed: 0.0410s/iter; left time: 848.9011s
Epoch: 6 cost time: 20.19218683242798
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0016124
	speed: 0.2624s/iter; left time: 5388.0607s
	iters: 200, epoch: 7 | loss: 0.0004536
	speed: 0.0336s/iter; left time: 685.9655s
	iters: 300, epoch: 7 | loss: 0.0018936
	speed: 0.0337s/iter; left time: 684.3998s
	iters: 400, epoch: 7 | loss: 0.0299843
	speed: 0.0339s/iter; left time: 686.8498s
Epoch: 7 cost time: 16.313940048217773
Epoch: 7, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
Validation loss decreased (-0.971983 --> -0.974270).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0032972
	speed: 0.2631s/iter; left time: 5280.8823s
	iters: 200, epoch: 8 | loss: 0.0010116
	speed: 0.0467s/iter; left time: 933.3088s
	iters: 300, epoch: 8 | loss: 0.0085300
	speed: 0.0467s/iter; left time: 928.1281s
	iters: 400, epoch: 8 | loss: 0.0159483
	speed: 0.0409s/iter; left time: 809.3417s
Epoch: 8 cost time: 21.13710069656372
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.976557).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0011687
	speed: 0.2798s/iter; left time: 5483.2653s
	iters: 200, epoch: 9 | loss: 0.0010282
	speed: 0.0459s/iter; left time: 895.0980s
	iters: 300, epoch: 9 | loss: 0.0055907
	speed: 0.0474s/iter; left time: 920.1604s
	iters: 400, epoch: 9 | loss: 0.0006548
	speed: 0.0465s/iter; left time: 897.0224s
Epoch: 9 cost time: 22.523381233215332
Epoch: 9, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0016383
	speed: 0.2821s/iter; left time: 5395.7754s
	iters: 200, epoch: 10 | loss: 0.0173025
	speed: 0.0476s/iter; left time: 905.3487s
	iters: 300, epoch: 10 | loss: 0.0023154
	speed: 0.0463s/iter; left time: 875.9748s
	iters: 400, epoch: 10 | loss: 0.0008194
	speed: 0.0421s/iter; left time: 793.5348s
Epoch: 10 cost time: 21.220518350601196
Epoch: 10, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.976557 --> -0.979701).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1867636
	speed: 0.2745s/iter; left time: 5123.0981s
	iters: 200, epoch: 11 | loss: 0.0002913
	speed: 0.0427s/iter; left time: 792.2209s
	iters: 300, epoch: 11 | loss: 0.0006829
	speed: 0.0446s/iter; left time: 823.8622s
	iters: 400, epoch: 11 | loss: 0.1306746
	speed: 0.0474s/iter; left time: 870.4648s
Epoch: 11 cost time: 21.466089963912964
Epoch: 11, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001402
	speed: 0.2959s/iter; left time: 5383.0435s
	iters: 200, epoch: 12 | loss: 0.0005723
	speed: 0.0417s/iter; left time: 755.2373s
	iters: 300, epoch: 12 | loss: 0.0069765
	speed: 0.0435s/iter; left time: 783.2642s
	iters: 400, epoch: 12 | loss: 0.0000500
	speed: 0.0433s/iter; left time: 775.1772s
Epoch: 12 cost time: 20.61641216278076
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000098
	speed: 0.2782s/iter; left time: 4930.7405s
	iters: 200, epoch: 13 | loss: 0.0134797
	speed: 0.0404s/iter; left time: 711.4036s
	iters: 300, epoch: 13 | loss: 0.0111242
	speed: 0.0391s/iter; left time: 685.0641s
	iters: 400, epoch: 13 | loss: 0.0435899
	speed: 0.0428s/iter; left time: 745.7277s
Epoch: 13 cost time: 19.58783984184265
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0575918
	speed: 0.2884s/iter; left time: 4976.0384s
	iters: 200, epoch: 14 | loss: 0.0021975
	speed: 0.0449s/iter; left time: 770.0052s
	iters: 300, epoch: 14 | loss: 0.0000967
	speed: 0.0415s/iter; left time: 708.4360s
	iters: 400, epoch: 14 | loss: 0.0003290
	speed: 0.0427s/iter; left time: 723.8846s
Epoch: 14 cost time: 20.71754789352417
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000128
	speed: 0.2769s/iter; left time: 4647.1067s
	iters: 200, epoch: 15 | loss: 0.0001188
	speed: 0.0463s/iter; left time: 771.9949s
	iters: 300, epoch: 15 | loss: 0.0000279
	speed: 0.0449s/iter; left time: 744.5385s
	iters: 400, epoch: 15 | loss: 0.0007495
	speed: 0.0418s/iter; left time: 689.3235s
Epoch: 15 cost time: 21.075156211853027
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0013747
	speed: 0.2744s/iter; left time: 4477.7687s
	iters: 200, epoch: 16 | loss: 0.0018618
	speed: 0.0431s/iter; left time: 698.4554s
	iters: 300, epoch: 16 | loss: 0.0000747
	speed: 0.0459s/iter; left time: 740.3092s
	iters: 400, epoch: 16 | loss: 0.0001324
	speed: 0.0456s/iter; left time: 729.8772s
Epoch: 16 cost time: 21.32422137260437
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0002625
	speed: 0.2569s/iter; left time: 4070.4092s
	iters: 200, epoch: 17 | loss: 0.0323803
	speed: 0.0451s/iter; left time: 710.4322s
	iters: 300, epoch: 17 | loss: 0.0002312
	speed: 0.0424s/iter; left time: 663.8098s
	iters: 400, epoch: 17 | loss: 0.0000138
	speed: 0.0369s/iter; left time: 573.8691s
Epoch: 17 cost time: 19.326979637145996
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0382374
	speed: 0.2517s/iter; left time: 3871.2651s
	iters: 200, epoch: 18 | loss: 0.0015998
	speed: 0.0422s/iter; left time: 645.3450s
	iters: 300, epoch: 18 | loss: 0.0001127
	speed: 0.0436s/iter; left time: 662.3836s
	iters: 400, epoch: 18 | loss: 0.0003745
	speed: 0.0457s/iter; left time: 688.7224s
Epoch: 18 cost time: 20.92110300064087
Epoch: 18, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0166920
	speed: 0.2816s/iter; left time: 4198.2504s
	iters: 200, epoch: 19 | loss: 0.0000894
	speed: 0.0424s/iter; left time: 627.1867s
	iters: 300, epoch: 19 | loss: 0.0009858
	speed: 0.0406s/iter; left time: 597.8997s
	iters: 400, epoch: 19 | loss: 0.0045633
	speed: 0.0408s/iter; left time: 596.4424s
Epoch: 19 cost time: 20.077624797821045
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000399
	speed: 0.2740s/iter; left time: 3957.2315s
	iters: 200, epoch: 20 | loss: 0.0000566
	speed: 0.0404s/iter; left time: 578.7284s
	iters: 300, epoch: 20 | loss: 0.0001357
	speed: 0.0399s/iter; left time: 567.5364s
	iters: 400, epoch: 20 | loss: 0.0054147
	speed: 0.0431s/iter; left time: 610.0359s
Epoch: 20 cost time: 19.720796585083008
Epoch: 20, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 82378
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3570473
	speed: 0.0617s/iter; left time: 1440.5380s
	iters: 200, epoch: 1 | loss: 0.9458280
	speed: 0.0427s/iter; left time: 992.2882s
	iters: 300, epoch: 1 | loss: 0.7607743
	speed: 0.0479s/iter; left time: 1109.5484s
	iters: 400, epoch: 1 | loss: 0.2764956
	speed: 0.0504s/iter; left time: 1162.6815s
Epoch: 1 cost time: 23.762484073638916
Epoch: 1, Steps: 469 | Train Loss: 0.833 Vali Loss: 0.357 Vali Acc: 0.897 Test Loss: 0.357 Test Acc: 0.897
Validation loss decreased (inf --> -0.897080).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0575475
	speed: 0.2914s/iter; left time: 6668.4316s
	iters: 200, epoch: 2 | loss: 0.0338989
	speed: 0.0485s/iter; left time: 1105.1020s
	iters: 300, epoch: 2 | loss: 0.1410581
	speed: 0.0467s/iter; left time: 1059.4260s
	iters: 400, epoch: 2 | loss: 0.0236206
	speed: 0.0504s/iter; left time: 1137.1096s
Epoch: 2 cost time: 23.27755618095398
Epoch: 2, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
Validation loss decreased (-0.897080 --> -0.948254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4954991
	speed: 0.2752s/iter; left time: 6168.6949s
	iters: 200, epoch: 3 | loss: 0.0326415
	speed: 0.0435s/iter; left time: 971.1529s
	iters: 300, epoch: 3 | loss: 0.0399245
	speed: 0.0416s/iter; left time: 923.0179s
	iters: 400, epoch: 3 | loss: 0.0328414
	speed: 0.0466s/iter; left time: 1031.3931s
Epoch: 3 cost time: 20.698150157928467
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.177 Vali Acc: 0.961 Test Loss: 0.177 Test Acc: 0.961
Validation loss decreased (-0.948254 --> -0.960547).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0181964
	speed: 0.2857s/iter; left time: 6270.0075s
	iters: 200, epoch: 4 | loss: 0.0048871
	speed: 0.0521s/iter; left time: 1138.8428s
	iters: 300, epoch: 4 | loss: 0.2133455
	speed: 0.0498s/iter; left time: 1082.9556s
	iters: 400, epoch: 4 | loss: 0.1871831
	speed: 0.0533s/iter; left time: 1154.0518s
Epoch: 4 cost time: 24.018204927444458
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
Validation loss decreased (-0.960547 --> -0.966551).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0929745
	speed: 0.2926s/iter; left time: 6282.8221s
	iters: 200, epoch: 5 | loss: 0.0816206
	speed: 0.0442s/iter; left time: 945.4035s
	iters: 300, epoch: 5 | loss: 0.0723514
	speed: 0.0473s/iter; left time: 1005.8717s
	iters: 400, epoch: 5 | loss: 0.0465871
	speed: 0.0521s/iter; left time: 1104.1740s
Epoch: 5 cost time: 22.189292192459106
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.966551 --> -0.976557).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003526
	speed: 0.3035s/iter; left time: 6374.3880s
	iters: 200, epoch: 6 | loss: 0.0048941
	speed: 0.0466s/iter; left time: 974.4932s
	iters: 300, epoch: 6 | loss: 0.0043167
	speed: 0.0452s/iter; left time: 940.5183s
	iters: 400, epoch: 6 | loss: 0.0389536
	speed: 0.0502s/iter; left time: 1039.0858s
Epoch: 6 cost time: 23.06176519393921
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0416424
	speed: 0.2903s/iter; left time: 5961.0708s
	iters: 200, epoch: 7 | loss: 0.0459956
	speed: 0.0347s/iter; left time: 708.8995s
	iters: 300, epoch: 7 | loss: 0.0076508
	speed: 0.0477s/iter; left time: 970.2482s
	iters: 400, epoch: 7 | loss: 0.0007311
	speed: 0.0523s/iter; left time: 1058.6208s
Epoch: 7 cost time: 21.53616714477539
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0062328
	speed: 0.3066s/iter; left time: 6153.7012s
	iters: 200, epoch: 8 | loss: 0.0157997
	speed: 0.0475s/iter; left time: 949.2382s
	iters: 300, epoch: 8 | loss: 0.0010008
	speed: 0.0439s/iter; left time: 872.2941s
	iters: 400, epoch: 8 | loss: 0.0088902
	speed: 0.0447s/iter; left time: 883.5422s
Epoch: 8 cost time: 22.0449640750885
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0011274
	speed: 0.2831s/iter; left time: 5548.6102s
	iters: 200, epoch: 9 | loss: 0.0001039
	speed: 0.0425s/iter; left time: 828.6403s
	iters: 300, epoch: 9 | loss: 0.0022029
	speed: 0.0486s/iter; left time: 943.6645s
	iters: 400, epoch: 9 | loss: 0.0013808
	speed: 0.0495s/iter; left time: 954.6918s
Epoch: 9 cost time: 22.560526371002197
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0029127
	speed: 0.2939s/iter; left time: 5622.9210s
	iters: 200, epoch: 10 | loss: 0.0086473
	speed: 0.0459s/iter; left time: 873.2525s
	iters: 300, epoch: 10 | loss: 0.0033716
	speed: 0.0464s/iter; left time: 877.6869s
	iters: 400, epoch: 10 | loss: 0.0008109
	speed: 0.0481s/iter; left time: 906.2833s
Epoch: 10 cost time: 22.34591007232666
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0159714
	speed: 0.2906s/iter; left time: 5423.1296s
	iters: 200, epoch: 11 | loss: 0.0024658
	speed: 0.0435s/iter; left time: 808.2999s
	iters: 300, epoch: 11 | loss: 0.0718451
	speed: 0.0459s/iter; left time: 847.0707s
	iters: 400, epoch: 11 | loss: 0.0009305
	speed: 0.0466s/iter; left time: 855.1236s
Epoch: 11 cost time: 21.71703553199768
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0010664
	speed: 0.2963s/iter; left time: 5390.7977s
	iters: 200, epoch: 12 | loss: 0.0292813
	speed: 0.0452s/iter; left time: 817.6449s
	iters: 300, epoch: 12 | loss: 0.0013819
	speed: 0.0458s/iter; left time: 824.7090s
	iters: 400, epoch: 12 | loss: 0.1560158
	speed: 0.0468s/iter; left time: 837.4439s
Epoch: 12 cost time: 22.22327184677124
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0010632
	speed: 0.2893s/iter; left time: 5126.9192s
	iters: 200, epoch: 13 | loss: 0.0371028
	speed: 0.0415s/iter; left time: 731.9182s
	iters: 300, epoch: 13 | loss: 0.0000179
	speed: 0.0414s/iter; left time: 726.1587s
	iters: 400, epoch: 13 | loss: 0.0000924
	speed: 0.0418s/iter; left time: 727.7649s
Epoch: 13 cost time: 20.274483680725098
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0013072
	speed: 0.2988s/iter; left time: 5155.8505s
	iters: 200, epoch: 14 | loss: 0.0000751
	speed: 0.0457s/iter; left time: 784.5446s
	iters: 300, epoch: 14 | loss: 0.0007538
	speed: 0.0461s/iter; left time: 785.8292s
	iters: 400, epoch: 14 | loss: 0.0155468
	speed: 0.0432s/iter; left time: 731.7717s
Epoch: 14 cost time: 22.021199464797974
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.976842).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0072539
	speed: 0.2803s/iter; left time: 4704.1772s
	iters: 200, epoch: 15 | loss: 0.0003090
	speed: 0.0480s/iter; left time: 800.6610s
	iters: 300, epoch: 15 | loss: 0.0042756
	speed: 0.0456s/iter; left time: 756.5990s
	iters: 400, epoch: 15 | loss: 0.0000721
	speed: 0.0446s/iter; left time: 735.3367s
Epoch: 15 cost time: 22.092472314834595
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0009117
	speed: 0.2953s/iter; left time: 4818.8304s
	iters: 200, epoch: 16 | loss: 0.0047404
	speed: 0.0513s/iter; left time: 832.5296s
	iters: 300, epoch: 16 | loss: 0.0023198
	speed: 0.0467s/iter; left time: 751.9246s
	iters: 400, epoch: 16 | loss: 0.0000914
	speed: 0.0446s/iter; left time: 714.5653s
Epoch: 16 cost time: 22.72163724899292
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0580821
	speed: 0.2786s/iter; left time: 4414.3668s
	iters: 200, epoch: 17 | loss: 0.0002027
	speed: 0.0491s/iter; left time: 773.5975s
	iters: 300, epoch: 17 | loss: 0.0000338
	speed: 0.0478s/iter; left time: 747.3516s
	iters: 400, epoch: 17 | loss: 0.0006732
	speed: 0.0449s/iter; left time: 698.8099s
Epoch: 17 cost time: 22.618305921554565
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0050707
	speed: 0.2921s/iter; left time: 4491.4268s
	iters: 200, epoch: 18 | loss: 0.0017117
	speed: 0.0503s/iter; left time: 768.7549s
	iters: 300, epoch: 18 | loss: 0.0883281
	speed: 0.0462s/iter; left time: 700.6890s
	iters: 400, epoch: 18 | loss: 0.0010711
	speed: 0.0469s/iter; left time: 706.5024s
Epoch: 18 cost time: 23.083168506622314
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000602
	speed: 0.2837s/iter; left time: 4230.0303s
	iters: 200, epoch: 19 | loss: 0.0002637
	speed: 0.0475s/iter; left time: 704.0947s
	iters: 300, epoch: 19 | loss: 0.0004358
	speed: 0.0484s/iter; left time: 711.2857s
	iters: 400, epoch: 19 | loss: 0.0001093
	speed: 0.0480s/iter; left time: 701.0393s
Epoch: 19 cost time: 23.08877205848694
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0009183
	speed: 0.2854s/iter; left time: 4120.8287s
	iters: 200, epoch: 20 | loss: 0.0057576
	speed: 0.0513s/iter; left time: 735.1145s
	iters: 300, epoch: 20 | loss: 0.0000674
	speed: 0.0516s/iter; left time: 734.2065s
	iters: 400, epoch: 20 | loss: 0.0010567
	speed: 0.0465s/iter; left time: 657.7268s
Epoch: 20 cost time: 23.41854977607727
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.974 Test Loss: 0.171 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0016001
	speed: 0.2828s/iter; left time: 3951.6697s
	iters: 200, epoch: 21 | loss: 0.0016619
	speed: 0.0526s/iter; left time: 729.6143s
	iters: 300, epoch: 21 | loss: 0.0002917
	speed: 0.0496s/iter; left time: 683.4164s
	iters: 400, epoch: 21 | loss: 0.0006610
	speed: 0.0502s/iter; left time: 685.6637s
Epoch: 21 cost time: 24.115753173828125
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0833762
	speed: 0.2948s/iter; left time: 3980.4616s
	iters: 200, epoch: 22 | loss: 0.0051202
	speed: 0.0487s/iter; left time: 652.1784s
	iters: 300, epoch: 22 | loss: 0.0010649
	speed: 0.0524s/iter; left time: 696.7509s
	iters: 400, epoch: 22 | loss: 0.0008060
	speed: 0.0522s/iter; left time: 689.6076s
Epoch: 22 cost time: 23.921173810958862
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0004591
	speed: 0.2774s/iter; left time: 3615.3309s
	iters: 200, epoch: 23 | loss: 0.0011736
	speed: 0.0510s/iter; left time: 660.1185s
	iters: 300, epoch: 23 | loss: 0.0000433
	speed: 0.0522s/iter; left time: 669.9900s
	iters: 400, epoch: 23 | loss: 0.0011403
	speed: 0.0512s/iter; left time: 651.8976s
Epoch: 23 cost time: 24.02423667907715
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.970 Test Loss: 0.192 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000348
	speed: 0.2809s/iter; left time: 3529.0451s
	iters: 200, epoch: 24 | loss: 0.0001485
	speed: 0.0430s/iter; left time: 535.7321s
	iters: 300, epoch: 24 | loss: 0.0001893
	speed: 0.0450s/iter; left time: 556.5914s
	iters: 400, epoch: 24 | loss: 0.0013559
	speed: 0.0514s/iter; left time: 630.3457s
Epoch: 24 cost time: 21.756702423095703
Epoch: 24, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 24778
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5138494
	speed: 0.0678s/iter; left time: 1583.8315s
	iters: 200, epoch: 1 | loss: 0.6823430
	speed: 0.0459s/iter; left time: 1068.2022s
	iters: 300, epoch: 1 | loss: 0.2536387
	speed: 0.0475s/iter; left time: 1099.2395s
	iters: 400, epoch: 1 | loss: 0.2482861
	speed: 0.0441s/iter; left time: 1015.5769s
Epoch: 1 cost time: 23.631667137145996
Epoch: 1, Steps: 469 | Train Loss: 0.851 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (inf --> -0.902512).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0502116
	speed: 0.2731s/iter; left time: 6248.7789s
	iters: 200, epoch: 2 | loss: 0.3491566
	speed: 0.0362s/iter; left time: 825.5473s
	iters: 300, epoch: 2 | loss: 0.2973779
	speed: 0.0374s/iter; left time: 848.9863s
	iters: 400, epoch: 2 | loss: 0.0852395
	speed: 0.0342s/iter; left time: 773.1220s
Epoch: 2 cost time: 17.675853967666626
Epoch: 2, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.902512 --> -0.958260).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1514895
	speed: 0.2528s/iter; left time: 5664.9796s
	iters: 200, epoch: 3 | loss: 0.0595075
	speed: 0.0423s/iter; left time: 943.0339s
	iters: 300, epoch: 3 | loss: 0.0288221
	speed: 0.0424s/iter; left time: 940.8388s
	iters: 400, epoch: 3 | loss: 0.0084701
	speed: 0.0412s/iter; left time: 910.8185s
Epoch: 3 cost time: 20.438655376434326
Epoch: 3, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.958260 --> -0.959690).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0827747
	speed: 0.2815s/iter; left time: 6177.0294s
	iters: 200, epoch: 4 | loss: 0.0356552
	speed: 0.0396s/iter; left time: 864.8857s
	iters: 300, epoch: 4 | loss: 0.0031138
	speed: 0.0410s/iter; left time: 892.1861s
	iters: 400, epoch: 4 | loss: 0.0083324
	speed: 0.0402s/iter; left time: 869.1782s
Epoch: 4 cost time: 19.494410514831543
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.959690 --> -0.966837).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0087573
	speed: 0.2676s/iter; left time: 5747.0767s
	iters: 200, epoch: 5 | loss: 0.0032598
	speed: 0.0412s/iter; left time: 881.6427s
	iters: 300, epoch: 5 | loss: 0.0156516
	speed: 0.0396s/iter; left time: 843.3363s
	iters: 400, epoch: 5 | loss: 0.0248718
	speed: 0.0402s/iter; left time: 851.3065s
Epoch: 5 cost time: 19.88536310195923
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.966837 --> -0.972554).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0142547
	speed: 0.2763s/iter; left time: 5803.6628s
	iters: 200, epoch: 6 | loss: 0.0022144
	speed: 0.0397s/iter; left time: 830.8545s
	iters: 300, epoch: 6 | loss: 0.0283535
	speed: 0.0379s/iter; left time: 789.2619s
	iters: 400, epoch: 6 | loss: 0.0100771
	speed: 0.0386s/iter; left time: 799.7701s
Epoch: 6 cost time: 19.092380046844482
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
Validation loss decreased (-0.972554 --> -0.973984).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0561148
	speed: 0.2756s/iter; left time: 5659.8990s
	iters: 200, epoch: 7 | loss: 0.0220378
	speed: 0.0433s/iter; left time: 885.1783s
	iters: 300, epoch: 7 | loss: 0.0643196
	speed: 0.0444s/iter; left time: 902.3861s
	iters: 400, epoch: 7 | loss: 0.0198808
	speed: 0.0435s/iter; left time: 879.8215s
Epoch: 7 cost time: 21.039469718933105
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.973984 --> -0.980273).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0489458
	speed: 0.2788s/iter; left time: 5595.0026s
	iters: 200, epoch: 8 | loss: 0.0161553
	speed: 0.0370s/iter; left time: 739.3910s
	iters: 300, epoch: 8 | loss: 0.1068666
	speed: 0.0336s/iter; left time: 668.4581s
	iters: 400, epoch: 8 | loss: 0.2277491
	speed: 0.0343s/iter; left time: 677.0941s
Epoch: 8 cost time: 17.877594470977783
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0155844
	speed: 0.2672s/iter; left time: 5237.7971s
	iters: 200, epoch: 9 | loss: 0.0968886
	speed: 0.0419s/iter; left time: 816.9380s
	iters: 300, epoch: 9 | loss: 0.0003925
	speed: 0.0421s/iter; left time: 816.5456s
	iters: 400, epoch: 9 | loss: 0.0002203
	speed: 0.0415s/iter; left time: 800.7753s
Epoch: 9 cost time: 20.339711904525757
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0019393
	speed: 0.2671s/iter; left time: 5110.1717s
	iters: 200, epoch: 10 | loss: 0.0006064
	speed: 0.0385s/iter; left time: 732.2457s
	iters: 300, epoch: 10 | loss: 0.0003766
	speed: 0.0376s/iter; left time: 712.1920s
	iters: 400, epoch: 10 | loss: 0.0045868
	speed: 0.0375s/iter; left time: 706.4438s
Epoch: 10 cost time: 18.63011932373047
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.980273 --> -0.982560).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0699411
	speed: 0.2632s/iter; left time: 4911.8593s
	iters: 200, epoch: 11 | loss: 0.0011316
	speed: 0.0400s/iter; left time: 741.6874s
	iters: 300, epoch: 11 | loss: 0.0276295
	speed: 0.0414s/iter; left time: 764.6997s
	iters: 400, epoch: 11 | loss: 0.0001845
	speed: 0.0422s/iter; left time: 774.2247s
Epoch: 11 cost time: 19.854376792907715
Epoch: 11, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001770
	speed: 0.2668s/iter; left time: 4854.2740s
	iters: 200, epoch: 12 | loss: 0.0020928
	speed: 0.0359s/iter; left time: 649.5008s
	iters: 300, epoch: 12 | loss: 0.0021105
	speed: 0.0344s/iter; left time: 618.4161s
	iters: 400, epoch: 12 | loss: 0.0002980
	speed: 0.0350s/iter; left time: 625.7677s
Epoch: 12 cost time: 17.707871198654175
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0409498
	speed: 0.2560s/iter; left time: 4537.1570s
	iters: 200, epoch: 13 | loss: 0.0073922
	speed: 0.0305s/iter; left time: 537.3404s
	iters: 300, epoch: 13 | loss: 0.0000628
	speed: 0.0410s/iter; left time: 717.7821s
	iters: 400, epoch: 13 | loss: 0.0001889
	speed: 0.0449s/iter; left time: 782.4943s
Epoch: 13 cost time: 19.122631788253784
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0087147
	speed: 0.2578s/iter; left time: 4448.0892s
	iters: 200, epoch: 14 | loss: 0.0007127
	speed: 0.0339s/iter; left time: 581.8090s
	iters: 300, epoch: 14 | loss: 0.0099030
	speed: 0.0353s/iter; left time: 602.6547s
	iters: 400, epoch: 14 | loss: 0.0115617
	speed: 0.0388s/iter; left time: 658.5874s
Epoch: 14 cost time: 17.718461275100708
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0001213
	speed: 0.2584s/iter; left time: 4338.0622s
	iters: 200, epoch: 15 | loss: 0.0001849
	speed: 0.0396s/iter; left time: 660.5446s
	iters: 300, epoch: 15 | loss: 0.0201848
	speed: 0.0372s/iter; left time: 616.1491s
	iters: 400, epoch: 15 | loss: 0.0035812
	speed: 0.0406s/iter; left time: 668.4973s
Epoch: 15 cost time: 19.00618624687195
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0112952
	speed: 0.2615s/iter; left time: 4266.6500s
	iters: 200, epoch: 16 | loss: 0.0017600
	speed: 0.0370s/iter; left time: 600.5600s
	iters: 300, epoch: 16 | loss: 0.0047592
	speed: 0.0376s/iter; left time: 606.6395s
	iters: 400, epoch: 16 | loss: 0.0055521
	speed: 0.0394s/iter; left time: 631.6088s
Epoch: 16 cost time: 18.667580127716064
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.979 Test Loss: 0.139 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0007113
	speed: 0.2618s/iter; left time: 4149.1995s
	iters: 200, epoch: 17 | loss: 0.0271459
	speed: 0.0414s/iter; left time: 651.2778s
	iters: 300, epoch: 17 | loss: 0.0025836
	speed: 0.0403s/iter; left time: 629.9160s
	iters: 400, epoch: 17 | loss: 0.0158373
	speed: 0.0440s/iter; left time: 684.1333s
Epoch: 17 cost time: 20.312832355499268
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0042280
	speed: 0.2629s/iter; left time: 4043.6018s
	iters: 200, epoch: 18 | loss: 0.0009498
	speed: 0.0385s/iter; left time: 588.9451s
	iters: 300, epoch: 18 | loss: 0.0003231
	speed: 0.0361s/iter; left time: 548.3984s
	iters: 400, epoch: 18 | loss: 0.0071151
	speed: 0.0375s/iter; left time: 564.6711s
Epoch: 18 cost time: 18.428489208221436
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000933
	speed: 0.2600s/iter; left time: 3876.3831s
	iters: 200, epoch: 19 | loss: 0.1482522
	speed: 0.0413s/iter; left time: 611.7289s
	iters: 300, epoch: 19 | loss: 0.0000681
	speed: 0.0430s/iter; left time: 632.9614s
	iters: 400, epoch: 19 | loss: 0.0519300
	speed: 0.0444s/iter; left time: 648.1478s
Epoch: 19 cost time: 20.54862952232361
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000369
	speed: 0.2642s/iter; left time: 3815.4096s
	iters: 200, epoch: 20 | loss: 0.0003218
	speed: 0.0369s/iter; left time: 528.9931s
	iters: 300, epoch: 20 | loss: 0.0030527
	speed: 0.0392s/iter; left time: 557.8192s
	iters: 400, epoch: 20 | loss: 0.0060909
	speed: 0.0395s/iter; left time: 558.2251s
Epoch: 20 cost time: 18.5271635055542
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 24810
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0971516
	speed: 0.0760s/iter; left time: 1773.9224s
	iters: 200, epoch: 1 | loss: 0.1624305
	speed: 0.0573s/iter; left time: 1331.2628s
	iters: 300, epoch: 1 | loss: 0.1075376
	speed: 0.0553s/iter; left time: 1280.4557s
	iters: 400, epoch: 1 | loss: 0.1022598
	speed: 0.0556s/iter; left time: 1281.8098s
Epoch: 1 cost time: 28.361998319625854
Epoch: 1, Steps: 469 | Train Loss: 0.649 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (inf --> -0.924812).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2035238
	speed: 0.3213s/iter; left time: 7351.0775s
	iters: 200, epoch: 2 | loss: 0.0362980
	speed: 0.0597s/iter; left time: 1360.4211s
	iters: 300, epoch: 2 | loss: 0.2613911
	speed: 0.0598s/iter; left time: 1356.5301s
	iters: 400, epoch: 2 | loss: 0.0101823
	speed: 0.0598s/iter; left time: 1350.5813s
Epoch: 2 cost time: 27.750421047210693
Epoch: 2, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.924812 --> -0.964550).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0417461
	speed: 0.3416s/iter; left time: 7655.4843s
	iters: 200, epoch: 3 | loss: 0.3863694
	speed: 0.0553s/iter; left time: 1233.4452s
	iters: 300, epoch: 3 | loss: 0.0613205
	speed: 0.0493s/iter; left time: 1094.2321s
	iters: 400, epoch: 3 | loss: 0.0150009
	speed: 0.0492s/iter; left time: 1088.8872s
Epoch: 3 cost time: 25.26458477973938
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.964550 --> -0.969696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0061565
	speed: 0.3408s/iter; left time: 7479.4133s
	iters: 200, epoch: 4 | loss: 0.0156189
	speed: 0.0557s/iter; left time: 1215.8948s
	iters: 300, epoch: 4 | loss: 0.0187055
	speed: 0.0558s/iter; left time: 1214.0232s
	iters: 400, epoch: 4 | loss: 0.0027856
	speed: 0.0555s/iter; left time: 1200.9165s
Epoch: 4 cost time: 26.664783477783203
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1927436
	speed: 0.3403s/iter; left time: 7308.7359s
	iters: 200, epoch: 5 | loss: 0.0109857
	speed: 0.0541s/iter; left time: 1155.8272s
	iters: 300, epoch: 5 | loss: 0.0347963
	speed: 0.0537s/iter; left time: 1143.1173s
	iters: 400, epoch: 5 | loss: 0.0258501
	speed: 0.0573s/iter; left time: 1214.1288s
Epoch: 5 cost time: 26.159747838974
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0016806
	speed: 0.3389s/iter; left time: 7119.0576s
	iters: 200, epoch: 6 | loss: 0.0027418
	speed: 0.0597s/iter; left time: 1247.1197s
	iters: 300, epoch: 6 | loss: 0.1933553
	speed: 0.0584s/iter; left time: 1215.7221s
	iters: 400, epoch: 6 | loss: 0.0003789
	speed: 0.0594s/iter; left time: 1230.9636s
Epoch: 6 cost time: 27.78645133972168
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0159828
	speed: 0.3249s/iter; left time: 6673.2853s
	iters: 200, epoch: 7 | loss: 0.0009485
	speed: 0.0591s/iter; left time: 1207.8007s
	iters: 300, epoch: 7 | loss: 0.0830578
	speed: 0.0591s/iter; left time: 1202.1999s
	iters: 400, epoch: 7 | loss: 0.0114590
	speed: 0.0576s/iter; left time: 1165.4507s
Epoch: 7 cost time: 27.745816946029663
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
Validation loss decreased (-0.969696 --> -0.978272).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0011243
	speed: 0.3569s/iter; left time: 7161.5050s
	iters: 200, epoch: 8 | loss: 0.3188245
	speed: 0.0577s/iter; left time: 1151.7058s
	iters: 300, epoch: 8 | loss: 0.0048005
	speed: 0.0560s/iter; left time: 1111.7707s
	iters: 400, epoch: 8 | loss: 0.0024348
	speed: 0.0530s/iter; left time: 1047.2364s
Epoch: 8 cost time: 26.668632745742798
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0009128
	speed: 0.3136s/iter; left time: 6145.7771s
	iters: 200, epoch: 9 | loss: 0.0008969
	speed: 0.0520s/iter; left time: 1013.3091s
	iters: 300, epoch: 9 | loss: 0.0303240
	speed: 0.0563s/iter; left time: 1091.7679s
	iters: 400, epoch: 9 | loss: 0.0001348
	speed: 0.0571s/iter; left time: 1101.0083s
Epoch: 9 cost time: 25.659621000289917
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0455033
	speed: 0.3464s/iter; left time: 6625.9275s
	iters: 200, epoch: 10 | loss: 0.0004823
	speed: 0.0571s/iter; left time: 1086.2223s
	iters: 300, epoch: 10 | loss: 0.0035531
	speed: 0.0586s/iter; left time: 1109.0996s
	iters: 400, epoch: 10 | loss: 0.0185020
	speed: 0.0546s/iter; left time: 1027.4368s
Epoch: 10 cost time: 26.578734636306763
Epoch: 10, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0004598
	speed: 0.3223s/iter; left time: 6014.2309s
	iters: 200, epoch: 11 | loss: 0.0010353
	speed: 0.0564s/iter; left time: 1047.1143s
	iters: 300, epoch: 11 | loss: 0.0058444
	speed: 0.0561s/iter; left time: 1034.8540s
	iters: 400, epoch: 11 | loss: 0.0002675
	speed: 0.0577s/iter; left time: 1060.2010s
Epoch: 11 cost time: 27.399149656295776
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0049581
	speed: 0.3489s/iter; left time: 6346.9129s
	iters: 200, epoch: 12 | loss: 0.0206123
	speed: 0.0564s/iter; left time: 1019.8793s
	iters: 300, epoch: 12 | loss: 0.0010915
	speed: 0.0568s/iter; left time: 1021.3439s
	iters: 400, epoch: 12 | loss: 0.0002633
	speed: 0.0561s/iter; left time: 1003.0398s
Epoch: 12 cost time: 26.79482364654541
Epoch: 12, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.977 Test Loss: 0.174 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0045889
	speed: 0.3559s/iter; left time: 6307.0923s
	iters: 200, epoch: 13 | loss: 0.0000168
	speed: 0.0563s/iter; left time: 992.9791s
	iters: 300, epoch: 13 | loss: 0.0796830
	speed: 0.0570s/iter; left time: 999.0430s
	iters: 400, epoch: 13 | loss: 0.0000888
	speed: 0.0565s/iter; left time: 984.1661s
Epoch: 13 cost time: 27.030471086502075
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0030883
	speed: 0.3443s/iter; left time: 5940.8875s
	iters: 200, epoch: 14 | loss: 0.0004625
	speed: 0.0563s/iter; left time: 965.8750s
	iters: 300, epoch: 14 | loss: 0.0001781
	speed: 0.0559s/iter; left time: 953.3348s
	iters: 400, epoch: 14 | loss: 0.0010288
	speed: 0.0534s/iter; left time: 905.0640s
Epoch: 14 cost time: 26.19373869895935
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0047986
	speed: 0.3495s/iter; left time: 5866.0774s
	iters: 200, epoch: 15 | loss: 0.0032185
	speed: 0.0516s/iter; left time: 860.3721s
	iters: 300, epoch: 15 | loss: 0.0001669
	speed: 0.0511s/iter; left time: 848.0664s
	iters: 400, epoch: 15 | loss: 0.2573648
	speed: 0.0568s/iter; left time: 937.1379s
Epoch: 15 cost time: 26.046096086502075
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.273 Vali Acc: 0.959 Test Loss: 0.273 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0007229
	speed: 0.3610s/iter; left time: 5889.9289s
	iters: 200, epoch: 16 | loss: 0.1017371
	speed: 0.0587s/iter; left time: 951.5593s
	iters: 300, epoch: 16 | loss: 0.0000408
	speed: 0.0599s/iter; left time: 964.9497s
	iters: 400, epoch: 16 | loss: 0.0414065
	speed: 0.0609s/iter; left time: 975.2636s
Epoch: 16 cost time: 28.248283863067627
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0014809
	speed: 0.3465s/iter; left time: 5490.6009s
	iters: 200, epoch: 17 | loss: 0.0004425
	speed: 0.0602s/iter; left time: 947.9266s
	iters: 300, epoch: 17 | loss: 0.0032211
	speed: 0.0584s/iter; left time: 913.1677s
	iters: 400, epoch: 17 | loss: 0.0005794
	speed: 0.0578s/iter; left time: 898.4419s
Epoch: 17 cost time: 27.741989850997925
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 214730
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2014252
	speed: 0.0745s/iter; left time: 1739.6345s
	iters: 200, epoch: 1 | loss: 0.5960037
	speed: 0.0541s/iter; left time: 1256.9501s
	iters: 300, epoch: 1 | loss: 0.3191329
	speed: 0.0564s/iter; left time: 1305.3414s
	iters: 400, epoch: 1 | loss: 0.1195601
	speed: 0.0581s/iter; left time: 1339.6071s
Epoch: 1 cost time: 28.526828289031982
Epoch: 1, Steps: 469 | Train Loss: 0.661 Vali Loss: 0.220 Vali Acc: 0.936 Test Loss: 0.220 Test Acc: 0.936
Validation loss decreased (inf --> -0.935675).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0257718
	speed: 0.3556s/iter; left time: 8137.3100s
	iters: 200, epoch: 2 | loss: 0.0306275
	speed: 0.0560s/iter; left time: 1275.1125s
	iters: 300, epoch: 2 | loss: 0.0661189
	speed: 0.0552s/iter; left time: 1252.7359s
	iters: 400, epoch: 2 | loss: 0.0311649
	speed: 0.0563s/iter; left time: 1271.2814s
Epoch: 2 cost time: 26.779467344284058
Epoch: 2, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.935675 --> -0.962548).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0619481
	speed: 0.3505s/iter; left time: 7856.2672s
	iters: 200, epoch: 3 | loss: 0.0067797
	speed: 0.0564s/iter; left time: 1258.6928s
	iters: 300, epoch: 3 | loss: 0.0652807
	speed: 0.0577s/iter; left time: 1281.3273s
	iters: 400, epoch: 3 | loss: 0.0009342
	speed: 0.0587s/iter; left time: 1298.0881s
Epoch: 3 cost time: 27.237027168273926
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.962548 --> -0.971983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1128026
	speed: 0.3430s/iter; left time: 7527.2109s
	iters: 200, epoch: 4 | loss: 0.1082923
	speed: 0.0580s/iter; left time: 1266.8216s
	iters: 300, epoch: 4 | loss: 0.0170050
	speed: 0.0573s/iter; left time: 1245.0037s
	iters: 400, epoch: 4 | loss: 0.0011491
	speed: 0.0584s/iter; left time: 1263.5345s
Epoch: 4 cost time: 27.49842119216919
Epoch: 4, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0320549
	speed: 0.3541s/iter; left time: 7603.3524s
	iters: 200, epoch: 5 | loss: 0.0005018
	speed: 0.0562s/iter; left time: 1200.9799s
	iters: 300, epoch: 5 | loss: 0.1117861
	speed: 0.0535s/iter; left time: 1137.2609s
	iters: 400, epoch: 5 | loss: 0.0021976
	speed: 0.0528s/iter; left time: 1119.0961s
Epoch: 5 cost time: 26.217812299728394
Epoch: 5, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0053766
	speed: 0.3521s/iter; left time: 7396.4376s
	iters: 200, epoch: 6 | loss: 0.0014372
	speed: 0.0592s/iter; left time: 1237.6392s
	iters: 300, epoch: 6 | loss: 0.0009475
	speed: 0.0592s/iter; left time: 1231.7251s
	iters: 400, epoch: 6 | loss: 0.4800004
	speed: 0.0612s/iter; left time: 1266.6116s
Epoch: 6 cost time: 28.187305450439453
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0002041
	speed: 0.3452s/iter; left time: 7088.9033s
	iters: 200, epoch: 7 | loss: 0.0066644
	speed: 0.0608s/iter; left time: 1242.7640s
	iters: 300, epoch: 7 | loss: 0.0026825
	speed: 0.0582s/iter; left time: 1182.9203s
	iters: 400, epoch: 7 | loss: 0.0013390
	speed: 0.0547s/iter; left time: 1106.0383s
Epoch: 7 cost time: 27.732715368270874
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0018589
	speed: 0.3686s/iter; left time: 7396.3632s
	iters: 200, epoch: 8 | loss: 0.0002021
	speed: 0.0592s/iter; left time: 1181.4968s
	iters: 300, epoch: 8 | loss: 0.0017648
	speed: 0.0576s/iter; left time: 1143.8947s
	iters: 400, epoch: 8 | loss: 0.0004696
	speed: 0.0556s/iter; left time: 1100.0695s
Epoch: 8 cost time: 27.163341999053955
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
Validation loss decreased (-0.971983 --> -0.974269).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0011715
	speed: 0.3536s/iter; left time: 6930.8034s
	iters: 200, epoch: 9 | loss: 0.0002232
	speed: 0.0549s/iter; left time: 1069.6996s
	iters: 300, epoch: 9 | loss: 0.0001506
	speed: 0.0552s/iter; left time: 1070.5468s
	iters: 400, epoch: 9 | loss: 0.0005486
	speed: 0.0610s/iter; left time: 1177.4386s
Epoch: 9 cost time: 27.54603362083435
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2312759
	speed: 0.3625s/iter; left time: 6934.6894s
	iters: 200, epoch: 10 | loss: 0.0010872
	speed: 0.0582s/iter; left time: 1108.2488s
	iters: 300, epoch: 10 | loss: 0.0021108
	speed: 0.0620s/iter; left time: 1173.0650s
	iters: 400, epoch: 10 | loss: 0.7191508
	speed: 0.0614s/iter; left time: 1155.8343s
Epoch: 10 cost time: 28.547828674316406
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0006841
	speed: 0.3431s/iter; left time: 6401.7431s
	iters: 200, epoch: 11 | loss: 0.0003827
	speed: 0.0575s/iter; left time: 1066.5316s
	iters: 300, epoch: 11 | loss: 0.0000250
	speed: 0.0534s/iter; left time: 985.0521s
	iters: 400, epoch: 11 | loss: 0.0329549
	speed: 0.0528s/iter; left time: 969.5671s
Epoch: 11 cost time: 26.056049823760986
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.974269 --> -0.977128).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0004446
	speed: 0.3582s/iter; left time: 6516.7728s
	iters: 200, epoch: 12 | loss: 0.0041539
	speed: 0.0584s/iter; left time: 1056.8388s
	iters: 300, epoch: 12 | loss: 0.0000412
	speed: 0.0574s/iter; left time: 1033.0501s
	iters: 400, epoch: 12 | loss: 0.0001978
	speed: 0.0584s/iter; left time: 1045.6157s
Epoch: 12 cost time: 27.859724521636963
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001882
	speed: 0.3481s/iter; left time: 6169.9124s
	iters: 200, epoch: 13 | loss: 0.0014332
	speed: 0.0570s/iter; left time: 1004.6695s
	iters: 300, epoch: 13 | loss: 0.0019872
	speed: 0.0574s/iter; left time: 1005.9281s
	iters: 400, epoch: 13 | loss: 0.0000164
	speed: 0.0599s/iter; left time: 1044.1557s
Epoch: 13 cost time: 27.76690363883972
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.974 Test Loss: 0.173 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0012304
	speed: 0.3684s/iter; left time: 6355.8793s
	iters: 200, epoch: 14 | loss: 0.0002628
	speed: 0.0563s/iter; left time: 966.5748s
	iters: 300, epoch: 14 | loss: 0.0003820
	speed: 0.0570s/iter; left time: 972.5600s
	iters: 400, epoch: 14 | loss: 0.0008050
	speed: 0.0619s/iter; left time: 1049.9639s
Epoch: 14 cost time: 27.880563020706177
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000163
	speed: 0.3587s/iter; left time: 6020.9619s
	iters: 200, epoch: 15 | loss: 0.0000154
	speed: 0.0582s/iter; left time: 971.5157s
	iters: 300, epoch: 15 | loss: 0.0014900
	speed: 0.0626s/iter; left time: 1039.0466s
	iters: 400, epoch: 15 | loss: 0.0197085
	speed: 0.0593s/iter; left time: 978.1301s
Epoch: 15 cost time: 28.201796293258667
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0996853
	speed: 0.3474s/iter; left time: 5668.7554s
	iters: 200, epoch: 16 | loss: 0.0000081
	speed: 0.0554s/iter; left time: 898.4288s
	iters: 300, epoch: 16 | loss: 0.0001144
	speed: 0.0537s/iter; left time: 864.8421s
	iters: 400, epoch: 16 | loss: 0.4729675
	speed: 0.0580s/iter; left time: 929.2098s
Epoch: 16 cost time: 26.98133611679077
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0032722
	speed: 0.3620s/iter; left time: 5736.7122s
	iters: 200, epoch: 17 | loss: 0.0028110
	speed: 0.0602s/iter; left time: 948.3486s
	iters: 300, epoch: 17 | loss: 0.0000179
	speed: 0.0608s/iter; left time: 951.8888s
	iters: 400, epoch: 17 | loss: 0.0098982
	speed: 0.0599s/iter; left time: 931.5402s
Epoch: 17 cost time: 28.706343412399292
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.973 Test Loss: 0.210 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0026220
	speed: 0.3435s/iter; left time: 5281.5951s
	iters: 200, epoch: 18 | loss: 0.4653243
	speed: 0.0599s/iter; left time: 915.2816s
	iters: 300, epoch: 18 | loss: 0.0001572
	speed: 0.0589s/iter; left time: 893.9108s
	iters: 400, epoch: 18 | loss: 0.0002118
	speed: 0.0598s/iter; left time: 901.2755s
Epoch: 18 cost time: 28.568134546279907
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.238 Vali Acc: 0.970 Test Loss: 0.238 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000469
	speed: 0.3453s/iter; left time: 5147.6616s
	iters: 200, epoch: 19 | loss: 0.0000597
	speed: 0.0528s/iter; left time: 782.0964s
	iters: 300, epoch: 19 | loss: 0.0040579
	speed: 0.0536s/iter; left time: 787.8131s
	iters: 400, epoch: 19 | loss: 0.0004782
	speed: 0.0589s/iter; left time: 860.7983s
Epoch: 19 cost time: 26.158565282821655
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0392278
	speed: 0.3404s/iter; left time: 4915.9364s
	iters: 200, epoch: 20 | loss: 0.0507976
	speed: 0.0595s/iter; left time: 852.7353s
	iters: 300, epoch: 20 | loss: 0.0014507
	speed: 0.0590s/iter; left time: 839.8861s
	iters: 400, epoch: 20 | loss: 0.0006882
	speed: 0.0577s/iter; left time: 815.7325s
Epoch: 20 cost time: 27.746819734573364
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.972 Test Loss: 0.215 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0539744
	speed: 0.3310s/iter; left time: 4625.0117s
	iters: 200, epoch: 21 | loss: 0.0001068
	speed: 0.0600s/iter; left time: 832.5317s
	iters: 300, epoch: 21 | loss: 0.0059755
	speed: 0.0601s/iter; left time: 828.1825s
	iters: 400, epoch: 21 | loss: 0.0038398
	speed: 0.0568s/iter; left time: 776.7113s
Epoch: 21 cost time: 27.86783766746521
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
Validation loss decreased (-0.977128 --> -0.979415).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0006698
	speed: 0.3528s/iter; left time: 4763.5875s
	iters: 200, epoch: 22 | loss: 0.0009341
	speed: 0.0566s/iter; left time: 758.7868s
	iters: 300, epoch: 22 | loss: 0.0361175
	speed: 0.0507s/iter; left time: 674.5050s
	iters: 400, epoch: 22 | loss: 0.0000050
	speed: 0.0506s/iter; left time: 668.2170s
Epoch: 22 cost time: 25.421310663223267
Epoch: 22, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0157371
	speed: 0.3406s/iter; left time: 4438.9979s
	iters: 200, epoch: 23 | loss: 0.0076247
	speed: 0.0560s/iter; left time: 723.7532s
	iters: 300, epoch: 23 | loss: 0.0000181
	speed: 0.0541s/iter; left time: 694.5932s
	iters: 400, epoch: 23 | loss: 0.0000411
	speed: 0.0554s/iter; left time: 705.6550s
Epoch: 23 cost time: 26.272929906845093
Epoch: 23, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.976 Test Loss: 0.221 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0006896
	speed: 0.3408s/iter; left time: 4281.8195s
	iters: 200, epoch: 24 | loss: 0.0073591
	speed: 0.0572s/iter; left time: 712.9465s
	iters: 300, epoch: 24 | loss: 0.0064265
	speed: 0.0557s/iter; left time: 688.1237s
	iters: 400, epoch: 24 | loss: 0.0001605
	speed: 0.0563s/iter; left time: 689.9352s
Epoch: 24 cost time: 27.131211042404175
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000008
	speed: 0.3503s/iter; left time: 4236.6312s
	iters: 200, epoch: 25 | loss: 0.0006155
	speed: 0.0536s/iter; left time: 642.8194s
	iters: 300, epoch: 25 | loss: 0.0389017
	speed: 0.0514s/iter; left time: 610.8306s
	iters: 400, epoch: 25 | loss: 0.0000120
	speed: 0.0525s/iter; left time: 619.1703s
Epoch: 25 cost time: 25.655369758605957
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.974 Test Loss: 0.256 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000604
	speed: 0.3475s/iter; left time: 4040.1550s
	iters: 200, epoch: 26 | loss: 0.0016649
	speed: 0.0542s/iter; left time: 625.1003s
	iters: 300, epoch: 26 | loss: 0.0000010
	speed: 0.0556s/iter; left time: 635.3918s
	iters: 400, epoch: 26 | loss: 0.0002325
	speed: 0.0578s/iter; left time: 654.8620s
Epoch: 26 cost time: 26.775638103485107
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.258 Vali Acc: 0.965 Test Loss: 0.258 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0014209
	speed: 0.3261s/iter; left time: 3638.3575s
	iters: 200, epoch: 27 | loss: 0.0012038
	speed: 0.0538s/iter; left time: 595.0657s
	iters: 300, epoch: 27 | loss: 0.0006232
	speed: 0.0532s/iter; left time: 582.6936s
	iters: 400, epoch: 27 | loss: 0.0000280
	speed: 0.0542s/iter; left time: 588.6999s
Epoch: 27 cost time: 26.031789302825928
Epoch: 27, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000032
	speed: 0.3446s/iter; left time: 3683.4465s
	iters: 200, epoch: 28 | loss: 0.0002306
	speed: 0.0551s/iter; left time: 583.1939s
	iters: 300, epoch: 28 | loss: 0.0024776
	speed: 0.0536s/iter; left time: 562.1037s
	iters: 400, epoch: 28 | loss: 0.0000052
	speed: 0.0498s/iter; left time: 517.6172s
Epoch: 28 cost time: 25.221264600753784
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.980 Test Loss: 0.213 Test Acc: 0.980
Validation loss decreased (-0.979415 --> -0.979701).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000065
	speed: 0.3425s/iter; left time: 3500.4019s
	iters: 200, epoch: 29 | loss: 0.0000937
	speed: 0.0583s/iter; left time: 590.2960s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0585s/iter; left time: 586.2361s
	iters: 400, epoch: 29 | loss: 0.0000005
	speed: 0.0585s/iter; left time: 580.1030s
Epoch: 29 cost time: 27.731462001800537
Epoch: 29, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000002
	speed: 0.3390s/iter; left time: 3305.2738s
	iters: 200, epoch: 30 | loss: 0.0003723
	speed: 0.0597s/iter; left time: 575.8640s
	iters: 300, epoch: 30 | loss: 0.0001938
	speed: 0.0587s/iter; left time: 560.7103s
	iters: 400, epoch: 30 | loss: 0.6248016
	speed: 0.0582s/iter; left time: 550.4072s
Epoch: 30 cost time: 27.808464765548706
Epoch: 30, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
Validation loss decreased (-0.979701 --> -0.979987).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0092112
	speed: 0.3366s/iter; left time: 3124.0127s
	iters: 200, epoch: 31 | loss: 0.0038231
	speed: 0.0554s/iter; left time: 508.2248s
	iters: 300, epoch: 31 | loss: 0.0000787
	speed: 0.0555s/iter; left time: 503.6909s
	iters: 400, epoch: 31 | loss: 0.0002964
	speed: 0.0570s/iter; left time: 511.6428s
Epoch: 31 cost time: 26.554590225219727
Epoch: 31, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.983 Test Loss: 0.176 Test Acc: 0.983
Validation loss decreased (-0.979987 --> -0.982560).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000097
	speed: 0.3471s/iter; left time: 3058.9810s
	iters: 200, epoch: 32 | loss: 0.0000515
	speed: 0.0543s/iter; left time: 472.6560s
	iters: 300, epoch: 32 | loss: 0.0000717
	speed: 0.0540s/iter; left time: 465.4657s
	iters: 400, epoch: 32 | loss: 0.0000063
	speed: 0.0587s/iter; left time: 499.4443s
Epoch: 32 cost time: 26.960988521575928
Epoch: 32, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000419
	speed: 0.3376s/iter; left time: 2816.3357s
	iters: 200, epoch: 33 | loss: 0.0000116
	speed: 0.0572s/iter; left time: 471.3402s
	iters: 300, epoch: 33 | loss: 0.0032128
	speed: 0.0582s/iter; left time: 474.2938s
	iters: 400, epoch: 33 | loss: 0.1892341
	speed: 0.0594s/iter; left time: 477.6717s
Epoch: 33 cost time: 27.459299087524414
Epoch: 33, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.978 Test Loss: 0.194 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0000242
	speed: 0.3429s/iter; left time: 2699.9708s
	iters: 200, epoch: 34 | loss: 0.0000016
	speed: 0.0578s/iter; left time: 449.2673s
	iters: 300, epoch: 34 | loss: 0.0000444
	speed: 0.0560s/iter; left time: 429.7207s
	iters: 400, epoch: 34 | loss: 0.0000003
	speed: 0.0550s/iter; left time: 416.5704s
Epoch: 34 cost time: 26.6710422039032
Epoch: 34, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0000044
	speed: 0.3238s/iter; left time: 2398.0770s
	iters: 200, epoch: 35 | loss: 0.0009673
	speed: 0.0537s/iter; left time: 392.3974s
	iters: 300, epoch: 35 | loss: 0.0000405
	speed: 0.0521s/iter; left time: 375.4822s
	iters: 400, epoch: 35 | loss: 0.0010149
	speed: 0.0542s/iter; left time: 384.9278s
Epoch: 35 cost time: 25.84368872642517
Epoch: 35, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.977 Test Loss: 0.244 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0001486
	speed: 0.3457s/iter; left time: 2397.7427s
	iters: 200, epoch: 36 | loss: 0.3390654
	speed: 0.0555s/iter; left time: 379.6531s
	iters: 300, epoch: 36 | loss: 0.0000121
	speed: 0.0562s/iter; left time: 378.6978s
	iters: 400, epoch: 36 | loss: 0.0051649
	speed: 0.0576s/iter; left time: 382.5337s
Epoch: 36 cost time: 26.80115032196045
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.267 Vali Acc: 0.973 Test Loss: 0.267 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0000014
	speed: 0.3468s/iter; left time: 2242.9707s
	iters: 200, epoch: 37 | loss: 0.0001607
	speed: 0.0546s/iter; left time: 347.4182s
	iters: 300, epoch: 37 | loss: 0.0000033
	speed: 0.0602s/iter; left time: 377.4560s
	iters: 400, epoch: 37 | loss: 0.0000080
	speed: 0.0563s/iter; left time: 347.3683s
Epoch: 37 cost time: 26.94584059715271
Epoch: 37, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.976 Test Loss: 0.227 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0000310
	speed: 0.3243s/iter; left time: 1945.3209s
	iters: 200, epoch: 38 | loss: 0.0000027
	speed: 0.0552s/iter; left time: 325.7369s
	iters: 300, epoch: 38 | loss: 0.0000008
	speed: 0.0578s/iter; left time: 335.0947s
	iters: 400, epoch: 38 | loss: 0.0003884
	speed: 0.0564s/iter; left time: 321.2546s
Epoch: 38 cost time: 26.000941514968872
Epoch: 38, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0000028
	speed: 0.3448s/iter; left time: 1906.6442s
	iters: 200, epoch: 39 | loss: 0.0000929
	speed: 0.0583s/iter; left time: 316.4283s
	iters: 300, epoch: 39 | loss: 0.0000288
	speed: 0.0579s/iter; left time: 308.5221s
	iters: 400, epoch: 39 | loss: 0.0001241
	speed: 0.0545s/iter; left time: 285.0783s
Epoch: 39 cost time: 27.04883861541748
Epoch: 39, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0001691
	speed: 0.3469s/iter; left time: 1755.5175s
	iters: 200, epoch: 40 | loss: 0.0000007
	speed: 0.0560s/iter; left time: 277.9113s
	iters: 300, epoch: 40 | loss: 0.0000503
	speed: 0.0567s/iter; left time: 275.3693s
	iters: 400, epoch: 40 | loss: 0.0005874
	speed: 0.0571s/iter; left time: 271.5628s
Epoch: 40 cost time: 27.135353803634644
Epoch: 40, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.304 Vali Acc: 0.976 Test Loss: 0.304 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0000062
	speed: 0.3486s/iter; left time: 1600.6140s
	iters: 200, epoch: 41 | loss: 0.0000023
	speed: 0.0536s/iter; left time: 240.8230s
	iters: 300, epoch: 41 | loss: 0.0000023
	speed: 0.0548s/iter; left time: 240.5508s
	iters: 400, epoch: 41 | loss: 0.0000413
	speed: 0.0531s/iter; left time: 227.8164s
Epoch: 41 cost time: 25.63965630531311
Epoch: 41, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.247 Vali Acc: 0.976 Test Loss: 0.247 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 214762
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2559056
	speed: 0.0725s/iter; left time: 1693.8561s
	iters: 200, epoch: 1 | loss: 0.3601511
	speed: 0.0549s/iter; left time: 1275.9745s
	iters: 300, epoch: 1 | loss: 0.1152310
	speed: 0.0557s/iter; left time: 1288.7070s
	iters: 400, epoch: 1 | loss: 0.2023056
	speed: 0.0562s/iter; left time: 1294.8199s
Epoch: 1 cost time: 28.031078815460205
Epoch: 1, Steps: 469 | Train Loss: 0.655 Vali Loss: 0.220 Vali Acc: 0.947 Test Loss: 0.220 Test Acc: 0.947
Validation loss decreased (inf --> -0.947396).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1037826
	speed: 0.3491s/iter; left time: 7988.1530s
	iters: 200, epoch: 2 | loss: 0.0999712
	speed: 0.0570s/iter; left time: 1298.0617s
	iters: 300, epoch: 2 | loss: 0.0519189
	speed: 0.0561s/iter; left time: 1271.8298s
	iters: 400, epoch: 2 | loss: 0.0132456
	speed: 0.0552s/iter; left time: 1246.4477s
Epoch: 2 cost time: 26.541824340820312
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
Validation loss decreased (-0.947396 --> -0.965979).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2167085
	speed: 0.3422s/iter; left time: 7668.7906s
	iters: 200, epoch: 3 | loss: 0.0272955
	speed: 0.0567s/iter; left time: 1264.9967s
	iters: 300, epoch: 3 | loss: 0.0581028
	speed: 0.0582s/iter; left time: 1291.7329s
	iters: 400, epoch: 3 | loss: 0.0071685
	speed: 0.0537s/iter; left time: 1187.7181s
Epoch: 3 cost time: 26.648524522781372
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0117701
	speed: 0.3309s/iter; left time: 7261.8284s
	iters: 200, epoch: 4 | loss: 0.0206887
	speed: 0.0578s/iter; left time: 1262.4393s
	iters: 300, epoch: 4 | loss: 0.0737472
	speed: 0.0573s/iter; left time: 1246.1101s
	iters: 400, epoch: 4 | loss: 0.0122234
	speed: 0.0541s/iter; left time: 1170.5705s
Epoch: 4 cost time: 26.54686427116394
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0106267
	speed: 0.3388s/iter; left time: 7276.3815s
	iters: 200, epoch: 5 | loss: 0.0010316
	speed: 0.0563s/iter; left time: 1202.6104s
	iters: 300, epoch: 5 | loss: 0.0188943
	speed: 0.0550s/iter; left time: 1170.2021s
	iters: 400, epoch: 5 | loss: 0.0028779
	speed: 0.0556s/iter; left time: 1176.3570s
Epoch: 5 cost time: 26.418257474899292
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.965979 --> -0.968838).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0435246
	speed: 0.3425s/iter; left time: 7194.5814s
	iters: 200, epoch: 6 | loss: 0.0003783
	speed: 0.0583s/iter; left time: 1217.9977s
	iters: 300, epoch: 6 | loss: 0.0113854
	speed: 0.0580s/iter; left time: 1205.9893s
	iters: 400, epoch: 6 | loss: 0.0039683
	speed: 0.0571s/iter; left time: 1183.1082s
Epoch: 6 cost time: 27.343329429626465
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000933
	speed: 0.3366s/iter; left time: 6912.4412s
	iters: 200, epoch: 7 | loss: 0.1338312
	speed: 0.0569s/iter; left time: 1162.7557s
	iters: 300, epoch: 7 | loss: 0.0044334
	speed: 0.0566s/iter; left time: 1151.9786s
	iters: 400, epoch: 7 | loss: 0.0075634
	speed: 0.0561s/iter; left time: 1134.6925s
Epoch: 7 cost time: 26.758626461029053
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0005500
	speed: 0.3293s/iter; left time: 6608.6888s
	iters: 200, epoch: 8 | loss: 0.0119336
	speed: 0.0532s/iter; left time: 1062.2838s
	iters: 300, epoch: 8 | loss: 0.0014559
	speed: 0.0525s/iter; left time: 1042.7122s
	iters: 400, epoch: 8 | loss: 0.0005279
	speed: 0.0524s/iter; left time: 1034.9258s
Epoch: 8 cost time: 25.69740128517151
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0075726
	speed: 0.3439s/iter; left time: 6740.4819s
	iters: 200, epoch: 9 | loss: 0.1303078
	speed: 0.0549s/iter; left time: 1070.1888s
	iters: 300, epoch: 9 | loss: 0.0803502
	speed: 0.0552s/iter; left time: 1070.7825s
	iters: 400, epoch: 9 | loss: 0.0112999
	speed: 0.0566s/iter; left time: 1092.4427s
Epoch: 9 cost time: 26.792750358581543
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
Validation loss decreased (-0.968838 --> -0.973698).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0005751
	speed: 0.3302s/iter; left time: 6316.9171s
	iters: 200, epoch: 10 | loss: 0.0071272
	speed: 0.0561s/iter; left time: 1067.6473s
	iters: 300, epoch: 10 | loss: 0.0003917
	speed: 0.0565s/iter; left time: 1069.9531s
	iters: 400, epoch: 10 | loss: 0.0006206
	speed: 0.0552s/iter; left time: 1038.8576s
Epoch: 10 cost time: 26.312127351760864
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0048494
	speed: 0.3275s/iter; left time: 6112.4024s
	iters: 200, epoch: 11 | loss: 0.0138257
	speed: 0.0490s/iter; left time: 910.0011s
	iters: 300, epoch: 11 | loss: 0.0040836
	speed: 0.0498s/iter; left time: 919.4369s
	iters: 400, epoch: 11 | loss: 0.0002833
	speed: 0.0510s/iter; left time: 937.3069s
Epoch: 11 cost time: 24.430118322372437
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0361712
	speed: 0.3431s/iter; left time: 6241.8193s
	iters: 200, epoch: 12 | loss: 0.0016945
	speed: 0.0543s/iter; left time: 982.3929s
	iters: 300, epoch: 12 | loss: 0.0000055
	speed: 0.0558s/iter; left time: 1003.1495s
	iters: 400, epoch: 12 | loss: 0.0000270
	speed: 0.0556s/iter; left time: 995.3481s
Epoch: 12 cost time: 26.386696338653564
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0011773
	speed: 0.3270s/iter; left time: 5795.0038s
	iters: 200, epoch: 13 | loss: 0.0278690
	speed: 0.0545s/iter; left time: 960.3008s
	iters: 300, epoch: 13 | loss: 0.0000039
	speed: 0.0548s/iter; left time: 960.7772s
	iters: 400, epoch: 13 | loss: 0.0000599
	speed: 0.0553s/iter; left time: 963.2980s
Epoch: 13 cost time: 26.052042961120605
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.970 Test Loss: 0.220 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.3322648
	speed: 0.3364s/iter; left time: 5804.1740s
	iters: 200, epoch: 14 | loss: 0.0048004
	speed: 0.0549s/iter; left time: 941.1898s
	iters: 300, epoch: 14 | loss: 0.0000613
	speed: 0.0543s/iter; left time: 925.4661s
	iters: 400, epoch: 14 | loss: 0.0001214
	speed: 0.0550s/iter; left time: 931.9464s
Epoch: 14 cost time: 26.122008323669434
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0107898
	speed: 0.3214s/iter; left time: 5393.8963s
	iters: 200, epoch: 15 | loss: 0.0001052
	speed: 0.0553s/iter; left time: 923.2720s
	iters: 300, epoch: 15 | loss: 0.0012341
	speed: 0.0537s/iter; left time: 889.9732s
	iters: 400, epoch: 15 | loss: 0.0003334
	speed: 0.0546s/iter; left time: 900.1907s
Epoch: 15 cost time: 26.142955780029297
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.966 Test Loss: 0.177 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0015638
	speed: 0.3177s/iter; left time: 5184.0250s
	iters: 200, epoch: 16 | loss: 0.1388004
	speed: 0.0537s/iter; left time: 870.8835s
	iters: 300, epoch: 16 | loss: 0.0139645
	speed: 0.0543s/iter; left time: 875.3311s
	iters: 400, epoch: 16 | loss: 0.4953710
	speed: 0.0553s/iter; left time: 885.0179s
Epoch: 16 cost time: 25.748767375946045
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
Validation loss decreased (-0.973698 --> -0.974270).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000167
	speed: 0.3234s/iter; left time: 5125.5608s
	iters: 200, epoch: 17 | loss: 0.6166086
	speed: 0.0513s/iter; left time: 807.0371s
	iters: 300, epoch: 17 | loss: 0.0755288
	speed: 0.0507s/iter; left time: 793.9809s
	iters: 400, epoch: 17 | loss: 0.0018378
	speed: 0.0546s/iter; left time: 849.1560s
Epoch: 17 cost time: 24.999677181243896
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.976557).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000519
	speed: 0.3203s/iter; left time: 4926.1896s
	iters: 200, epoch: 18 | loss: 0.0002526
	speed: 0.0523s/iter; left time: 798.7053s
	iters: 300, epoch: 18 | loss: 0.0003598
	speed: 0.0545s/iter; left time: 827.9245s
	iters: 400, epoch: 18 | loss: 0.0255263
	speed: 0.0541s/iter; left time: 815.0648s
Epoch: 18 cost time: 24.99238157272339
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0001041
	speed: 0.3026s/iter; left time: 4511.2025s
	iters: 200, epoch: 19 | loss: 0.0001425
	speed: 0.0542s/iter; left time: 802.3623s
	iters: 300, epoch: 19 | loss: 0.0000145
	speed: 0.0539s/iter; left time: 793.1453s
	iters: 400, epoch: 19 | loss: 0.0001443
	speed: 0.0536s/iter; left time: 783.5049s
Epoch: 19 cost time: 25.795284032821655
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.971 Test Loss: 0.196 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000296
	speed: 0.3155s/iter; left time: 4555.8573s
	iters: 200, epoch: 20 | loss: 0.0864617
	speed: 0.0500s/iter; left time: 717.2185s
	iters: 300, epoch: 20 | loss: 0.0000317
	speed: 0.0525s/iter; left time: 747.9610s
	iters: 400, epoch: 20 | loss: 0.0428407
	speed: 0.0548s/iter; left time: 774.5666s
Epoch: 20 cost time: 24.868653535842896
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000519
	speed: 0.3230s/iter; left time: 4512.2118s
	iters: 200, epoch: 21 | loss: 0.0012806
	speed: 0.0536s/iter; left time: 743.3670s
	iters: 300, epoch: 21 | loss: 0.0117083
	speed: 0.0551s/iter; left time: 758.5459s
	iters: 400, epoch: 21 | loss: 0.0000477
	speed: 0.0504s/iter; left time: 688.4702s
Epoch: 21 cost time: 24.757065534591675
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977414).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0002201
	speed: 0.3117s/iter; left time: 4208.3096s
	iters: 200, epoch: 22 | loss: 0.0006910
	speed: 0.0542s/iter; left time: 727.0431s
	iters: 300, epoch: 22 | loss: 0.1038404
	speed: 0.0499s/iter; left time: 664.0384s
	iters: 400, epoch: 22 | loss: 0.0001382
	speed: 0.0496s/iter; left time: 654.6017s
Epoch: 22 cost time: 24.660722017288208
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.978 Test Loss: 0.191 Test Acc: 0.978
Validation loss decreased (-0.977414 --> -0.977700).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000237
	speed: 0.3071s/iter; left time: 4002.9702s
	iters: 200, epoch: 23 | loss: 0.0000055
	speed: 0.0510s/iter; left time: 659.3476s
	iters: 300, epoch: 23 | loss: 0.0007667
	speed: 0.0533s/iter; left time: 684.3543s
	iters: 400, epoch: 23 | loss: 0.0001197
	speed: 0.0536s/iter; left time: 682.1155s
Epoch: 23 cost time: 24.98164939880371
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0005742
	speed: 0.3184s/iter; left time: 4000.0188s
	iters: 200, epoch: 24 | loss: 0.0000038
	speed: 0.0553s/iter; left time: 689.7752s
	iters: 300, epoch: 24 | loss: 0.0016155
	speed: 0.0549s/iter; left time: 678.3202s
	iters: 400, epoch: 24 | loss: 0.0071713
	speed: 0.0511s/iter; left time: 626.8114s
Epoch: 24 cost time: 25.48823642730713
Epoch: 24, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.965 Test Loss: 0.238 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000129
	speed: 0.3116s/iter; left time: 3768.8027s
	iters: 200, epoch: 25 | loss: 0.0237886
	speed: 0.0520s/iter; left time: 623.5204s
	iters: 300, epoch: 25 | loss: 0.0016159
	speed: 0.0517s/iter; left time: 615.4029s
	iters: 400, epoch: 25 | loss: 0.0541240
	speed: 0.0545s/iter; left time: 643.0410s
Epoch: 25 cost time: 25.10774040222168
Epoch: 25, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000121
	speed: 0.3023s/iter; left time: 3514.8412s
	iters: 200, epoch: 26 | loss: 0.0002786
	speed: 0.0528s/iter; left time: 609.0898s
	iters: 300, epoch: 26 | loss: 0.0072806
	speed: 0.0523s/iter; left time: 597.2551s
	iters: 400, epoch: 26 | loss: 0.0000718
	speed: 0.0527s/iter; left time: 597.3923s
Epoch: 26 cost time: 24.635322332382202
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.979 Test Loss: 0.152 Test Acc: 0.979
Validation loss decreased (-0.977700 --> -0.979129).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0039722
	speed: 0.3059s/iter; left time: 3413.4755s
	iters: 200, epoch: 27 | loss: 0.0000254
	speed: 0.0490s/iter; left time: 541.8688s
	iters: 300, epoch: 27 | loss: 0.0075845
	speed: 0.0494s/iter; left time: 541.7020s
	iters: 400, epoch: 27 | loss: 0.0003928
	speed: 0.0495s/iter; left time: 537.9336s
Epoch: 27 cost time: 23.51494812965393
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.970 Test Loss: 0.221 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0001279
	speed: 0.3084s/iter; left time: 3295.6518s
	iters: 200, epoch: 28 | loss: 0.0001678
	speed: 0.0511s/iter; left time: 540.7662s
	iters: 300, epoch: 28 | loss: 0.0001800
	speed: 0.0521s/iter; left time: 546.3704s
	iters: 400, epoch: 28 | loss: 0.0015298
	speed: 0.0516s/iter; left time: 535.8220s
Epoch: 28 cost time: 24.841564178466797
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000094
	speed: 0.3016s/iter; left time: 3082.4919s
	iters: 200, epoch: 29 | loss: 0.0000351
	speed: 0.0520s/iter; left time: 525.7668s
	iters: 300, epoch: 29 | loss: 0.0000151
	speed: 0.0518s/iter; left time: 518.6254s
	iters: 400, epoch: 29 | loss: 0.0010347
	speed: 0.0528s/iter; left time: 523.5700s
Epoch: 29 cost time: 24.68131923675537
Epoch: 29, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000038
	speed: 0.3112s/iter; left time: 3034.1876s
	iters: 200, epoch: 30 | loss: 0.0000071
	speed: 0.0503s/iter; left time: 485.7541s
	iters: 300, epoch: 30 | loss: 0.0018512
	speed: 0.0511s/iter; left time: 487.9855s
	iters: 400, epoch: 30 | loss: 0.0075396
	speed: 0.0514s/iter; left time: 486.0335s
Epoch: 30 cost time: 24.582666397094727
Epoch: 30, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000975
	speed: 0.3069s/iter; left time: 2848.0055s
	iters: 200, epoch: 31 | loss: 0.0000484
	speed: 0.0534s/iter; left time: 489.9467s
	iters: 300, epoch: 31 | loss: 0.0000235
	speed: 0.0512s/iter; left time: 465.2475s
	iters: 400, epoch: 31 | loss: 0.0003137
	speed: 0.0509s/iter; left time: 457.2948s
Epoch: 31 cost time: 24.25453233718872
Epoch: 31, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0009107
	speed: 0.2912s/iter; left time: 2565.7184s
	iters: 200, epoch: 32 | loss: 0.0000345
	speed: 0.0527s/iter; left time: 459.4718s
	iters: 300, epoch: 32 | loss: 0.0000495
	speed: 0.0535s/iter; left time: 460.6433s
	iters: 400, epoch: 32 | loss: 0.0002813
	speed: 0.0545s/iter; left time: 464.1637s
Epoch: 32 cost time: 25.47284483909607
Epoch: 32, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.982 Test Loss: 0.134 Test Acc: 0.982
Validation loss decreased (-0.979129 --> -0.982274).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000032
	speed: 0.3197s/iter; left time: 2666.9329s
	iters: 200, epoch: 33 | loss: 0.0012971
	speed: 0.0527s/iter; left time: 434.1047s
	iters: 300, epoch: 33 | loss: 0.0000444
	speed: 0.0525s/iter; left time: 427.2275s
	iters: 400, epoch: 33 | loss: 0.0000137
	speed: 0.0497s/iter; left time: 399.6474s
Epoch: 33 cost time: 24.383880615234375
Epoch: 33, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0008925
	speed: 0.3042s/iter; left time: 2395.1722s
	iters: 200, epoch: 34 | loss: 0.0000005
	speed: 0.0510s/iter; left time: 396.5248s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0522s/iter; left time: 400.7259s
	iters: 400, epoch: 34 | loss: 0.0000090
	speed: 0.0526s/iter; left time: 398.3120s
Epoch: 34 cost time: 25.050318241119385
Epoch: 34, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.967 Test Loss: 0.226 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0942314
	speed: 0.2926s/iter; left time: 2167.0625s
	iters: 200, epoch: 35 | loss: 0.0000000
	speed: 0.0528s/iter; left time: 385.3392s
	iters: 300, epoch: 35 | loss: 0.0000803
	speed: 0.0513s/iter; left time: 369.3906s
	iters: 400, epoch: 35 | loss: 0.0004299
	speed: 0.0514s/iter; left time: 365.4711s
Epoch: 35 cost time: 24.774076461791992
Epoch: 35, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0050705
	speed: 0.3110s/iter; left time: 2157.4235s
	iters: 200, epoch: 36 | loss: 0.0000694
	speed: 0.0497s/iter; left time: 339.7542s
	iters: 300, epoch: 36 | loss: 0.0025597
	speed: 0.0492s/iter; left time: 331.2522s
	iters: 400, epoch: 36 | loss: 0.0023127
	speed: 0.0527s/iter; left time: 349.9711s
Epoch: 36 cost time: 23.991525888442993
Epoch: 36, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000021
	speed: 0.3038s/iter; left time: 1964.4149s
	iters: 200, epoch: 37 | loss: 0.0016403
	speed: 0.0530s/iter; left time: 337.5966s
	iters: 300, epoch: 37 | loss: 0.0000420
	speed: 0.0533s/iter; left time: 333.7257s
	iters: 400, epoch: 37 | loss: 0.0000646
	speed: 0.0518s/iter; left time: 319.5250s
Epoch: 37 cost time: 24.876235485076904
Epoch: 37, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000283
	speed: 0.3002s/iter; left time: 1800.8117s
	iters: 200, epoch: 38 | loss: 0.0003489
	speed: 0.0520s/iter; left time: 306.7218s
	iters: 300, epoch: 38 | loss: 0.0000027
	speed: 0.0525s/iter; left time: 304.3120s
	iters: 400, epoch: 38 | loss: 0.0000070
	speed: 0.0545s/iter; left time: 310.4918s
Epoch: 38 cost time: 25.067704439163208
Epoch: 38, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000980
	speed: 0.3162s/iter; left time: 1748.1432s
	iters: 200, epoch: 39 | loss: 0.0000131
	speed: 0.0501s/iter; left time: 272.2408s
	iters: 300, epoch: 39 | loss: 0.0000085
	speed: 0.0515s/iter; left time: 274.3164s
	iters: 400, epoch: 39 | loss: 0.0000014
	speed: 0.0523s/iter; left time: 273.4844s
Epoch: 39 cost time: 24.50069260597229
Epoch: 39, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0000527
	speed: 0.3169s/iter; left time: 1603.5717s
	iters: 200, epoch: 40 | loss: 0.0006950
	speed: 0.0525s/iter; left time: 260.1880s
	iters: 300, epoch: 40 | loss: 0.0000232
	speed: 0.0531s/iter; left time: 257.9169s
	iters: 400, epoch: 40 | loss: 0.0000007
	speed: 0.0541s/iter; left time: 257.7475s
Epoch: 40 cost time: 25.132397174835205
Epoch: 40, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.174 Vali Acc: 0.978 Test Loss: 0.174 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000004
	speed: 0.2996s/iter; left time: 1375.3462s
	iters: 200, epoch: 41 | loss: 0.1692992
	speed: 0.0536s/iter; left time: 240.6724s
	iters: 300, epoch: 41 | loss: 0.0000147
	speed: 0.0517s/iter; left time: 227.0846s
	iters: 400, epoch: 41 | loss: 0.0000004
	speed: 0.0513s/iter; left time: 220.0265s
Epoch: 41 cost time: 24.951132774353027
Epoch: 41, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.979 Test Loss: 0.167 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0009911
	speed: 0.3089s/iter; left time: 1273.4755s
	iters: 200, epoch: 42 | loss: 0.0000002
	speed: 0.0489s/iter; left time: 196.6105s
	iters: 300, epoch: 42 | loss: 0.0000060
	speed: 0.0495s/iter; left time: 194.2034s
	iters: 400, epoch: 42 | loss: 0.0002132
	speed: 0.0528s/iter; left time: 201.7202s
Epoch: 42 cost time: 24.214133501052856
Epoch: 42, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.970 Test Loss: 0.265 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 212938
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1294283
	speed: 0.0661s/iter; left time: 1543.7981s
	iters: 200, epoch: 1 | loss: 0.3967862
	speed: 0.0491s/iter; left time: 1141.8757s
	iters: 300, epoch: 1 | loss: 0.5643480
	speed: 0.0488s/iter; left time: 1130.5570s
	iters: 400, epoch: 1 | loss: 0.0291482
	speed: 0.0521s/iter; left time: 1202.0206s
Epoch: 1 cost time: 25.22484517097473
Epoch: 1, Steps: 469 | Train Loss: 0.649 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
Validation loss decreased (inf --> -0.935104).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0589239
	speed: 0.3047s/iter; left time: 6973.1016s
	iters: 200, epoch: 2 | loss: 0.0238031
	speed: 0.0539s/iter; left time: 1228.6453s
	iters: 300, epoch: 2 | loss: 0.0487567
	speed: 0.0538s/iter; left time: 1220.8748s
	iters: 400, epoch: 2 | loss: 0.2720517
	speed: 0.0513s/iter; left time: 1157.4827s
Epoch: 2 cost time: 25.089697122573853
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.935104 --> -0.970839).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0082351
	speed: 0.2983s/iter; left time: 6685.2507s
	iters: 200, epoch: 3 | loss: 0.3175385
	speed: 0.0512s/iter; left time: 1141.9618s
	iters: 300, epoch: 3 | loss: 0.1314809
	speed: 0.0520s/iter; left time: 1154.5604s
	iters: 400, epoch: 3 | loss: 0.0069755
	speed: 0.0533s/iter; left time: 1177.5706s
Epoch: 3 cost time: 24.92096996307373
Epoch: 3, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.970839 --> -0.971697).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0102675
	speed: 0.3016s/iter; left time: 6618.9954s
	iters: 200, epoch: 4 | loss: 0.0113459
	speed: 0.0518s/iter; left time: 1131.8332s
	iters: 300, epoch: 4 | loss: 0.0106417
	speed: 0.0518s/iter; left time: 1126.0084s
	iters: 400, epoch: 4 | loss: 0.0123042
	speed: 0.0534s/iter; left time: 1156.2635s
Epoch: 4 cost time: 24.553282499313354
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0128974
	speed: 0.3097s/iter; left time: 6650.9721s
	iters: 200, epoch: 5 | loss: 0.0185301
	speed: 0.0527s/iter; left time: 1125.4711s
	iters: 300, epoch: 5 | loss: 0.0157657
	speed: 0.0523s/iter; left time: 1112.6515s
	iters: 400, epoch: 5 | loss: 0.0334205
	speed: 0.0488s/iter; left time: 1034.2985s
Epoch: 5 cost time: 24.294721364974976
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.971697 --> -0.975128).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0002610
	speed: 0.2955s/iter; left time: 6207.3114s
	iters: 200, epoch: 6 | loss: 0.0496459
	speed: 0.0532s/iter; left time: 1112.9374s
	iters: 300, epoch: 6 | loss: 0.0012445
	speed: 0.0532s/iter; left time: 1105.9321s
	iters: 400, epoch: 6 | loss: 0.0697493
	speed: 0.0528s/iter; left time: 1093.4343s
Epoch: 6 cost time: 25.000856399536133
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0191709
	speed: 0.3007s/iter; left time: 6175.6501s
	iters: 200, epoch: 7 | loss: 0.0016722
	speed: 0.0490s/iter; left time: 1002.3029s
	iters: 300, epoch: 7 | loss: 0.0003860
	speed: 0.0506s/iter; left time: 1029.1009s
	iters: 400, epoch: 7 | loss: 0.0067673
	speed: 0.0518s/iter; left time: 1047.9011s
Epoch: 7 cost time: 24.245477437973022
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0096428
	speed: 0.3059s/iter; left time: 6138.1262s
	iters: 200, epoch: 8 | loss: 0.0005960
	speed: 0.0523s/iter; left time: 1044.5741s
	iters: 300, epoch: 8 | loss: 0.0032799
	speed: 0.0502s/iter; left time: 997.6261s
	iters: 400, epoch: 8 | loss: 0.0016211
	speed: 0.0470s/iter; left time: 929.3318s
Epoch: 8 cost time: 23.78529167175293
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0126332
	speed: 0.2726s/iter; left time: 5343.3373s
	iters: 200, epoch: 9 | loss: 0.1730979
	speed: 0.0498s/iter; left time: 971.9702s
	iters: 300, epoch: 9 | loss: 0.0001619
	speed: 0.0520s/iter; left time: 1008.1948s
	iters: 400, epoch: 9 | loss: 0.0070394
	speed: 0.0512s/iter; left time: 987.8774s
Epoch: 9 cost time: 23.34434700012207
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0026625
	speed: 0.2979s/iter; left time: 5699.7282s
	iters: 200, epoch: 10 | loss: 0.0028373
	speed: 0.0506s/iter; left time: 963.0810s
	iters: 300, epoch: 10 | loss: 0.1190977
	speed: 0.0490s/iter; left time: 927.3774s
	iters: 400, epoch: 10 | loss: 0.0002258
	speed: 0.0495s/iter; left time: 931.2903s
Epoch: 10 cost time: 23.84223437309265
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0284991
	speed: 0.2971s/iter; left time: 5544.4542s
	iters: 200, epoch: 11 | loss: 0.0002837
	speed: 0.0499s/iter; left time: 926.4083s
	iters: 300, epoch: 11 | loss: 0.0045185
	speed: 0.0533s/iter; left time: 983.7771s
	iters: 400, epoch: 11 | loss: 0.0008741
	speed: 0.0538s/iter; left time: 987.5340s
Epoch: 11 cost time: 24.71404528617859
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.975128 --> -0.975413).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0457182
	speed: 0.2922s/iter; left time: 5314.9687s
	iters: 200, epoch: 12 | loss: 0.8498663
	speed: 0.0518s/iter; left time: 936.3652s
	iters: 300, epoch: 12 | loss: 0.0023564
	speed: 0.0514s/iter; left time: 925.2931s
	iters: 400, epoch: 12 | loss: 1.0167220
	speed: 0.0493s/iter; left time: 882.5790s
Epoch: 12 cost time: 23.800822496414185
Epoch: 12, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0007707
	speed: 0.3054s/iter; left time: 5412.2090s
	iters: 200, epoch: 13 | loss: 0.4758882
	speed: 0.0507s/iter; left time: 893.3776s
	iters: 300, epoch: 13 | loss: 0.0392625
	speed: 0.0494s/iter; left time: 865.2925s
	iters: 400, epoch: 13 | loss: 0.0000100
	speed: 0.0502s/iter; left time: 874.5456s
Epoch: 13 cost time: 23.986082553863525
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.977 Test Loss: 0.182 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.976556).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0008641
	speed: 0.3016s/iter; left time: 5203.8776s
	iters: 200, epoch: 14 | loss: 0.0017654
	speed: 0.0524s/iter; left time: 898.4315s
	iters: 300, epoch: 14 | loss: 0.0003202
	speed: 0.0505s/iter; left time: 861.2780s
	iters: 400, epoch: 14 | loss: 0.0018045
	speed: 0.0502s/iter; left time: 850.5930s
Epoch: 14 cost time: 24.293320178985596
Epoch: 14, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
Validation loss decreased (-0.976556 --> -0.977986).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000318
	speed: 0.2915s/iter; left time: 4892.3606s
	iters: 200, epoch: 15 | loss: 0.0000026
	speed: 0.0510s/iter; left time: 851.5964s
	iters: 300, epoch: 15 | loss: 0.0050291
	speed: 0.0513s/iter; left time: 851.2660s
	iters: 400, epoch: 15 | loss: 0.0000136
	speed: 0.0533s/iter; left time: 878.8417s
Epoch: 15 cost time: 24.477720737457275
Epoch: 15, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0007406
	speed: 0.3059s/iter; left time: 4990.5062s
	iters: 200, epoch: 16 | loss: 0.0038472
	speed: 0.0506s/iter; left time: 819.7990s
	iters: 300, epoch: 16 | loss: 0.0002772
	speed: 0.0475s/iter; left time: 765.2018s
	iters: 400, epoch: 16 | loss: 0.0039693
	speed: 0.0483s/iter; left time: 773.3916s
Epoch: 16 cost time: 23.735005378723145
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0006149
	speed: 0.3009s/iter; left time: 4768.0997s
	iters: 200, epoch: 17 | loss: 0.0247339
	speed: 0.0510s/iter; left time: 803.4769s
	iters: 300, epoch: 17 | loss: 0.0001201
	speed: 0.0509s/iter; left time: 796.2087s
	iters: 400, epoch: 17 | loss: 0.2363238
	speed: 0.0516s/iter; left time: 802.1572s
Epoch: 17 cost time: 24.299832582473755
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0027968
	speed: 0.2807s/iter; left time: 4316.3207s
	iters: 200, epoch: 18 | loss: 0.0008951
	speed: 0.0499s/iter; left time: 762.7394s
	iters: 300, epoch: 18 | loss: 0.0013753
	speed: 0.0533s/iter; left time: 809.3934s
	iters: 400, epoch: 18 | loss: 0.0009947
	speed: 0.0498s/iter; left time: 750.9731s
Epoch: 18 cost time: 24.033408403396606
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.980 Test Loss: 0.211 Test Acc: 0.980
Validation loss decreased (-0.977986 --> -0.979701).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000089
	speed: 0.3006s/iter; left time: 4481.0925s
	iters: 200, epoch: 19 | loss: 0.0029467
	speed: 0.0473s/iter; left time: 700.0493s
	iters: 300, epoch: 19 | loss: 0.0002128
	speed: 0.0472s/iter; left time: 693.7914s
	iters: 400, epoch: 19 | loss: 0.0014930
	speed: 0.0489s/iter; left time: 714.1655s
Epoch: 19 cost time: 23.07844090461731
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.3669963
	speed: 0.2939s/iter; left time: 4244.6062s
	iters: 200, epoch: 20 | loss: 0.0001656
	speed: 0.0496s/iter; left time: 710.8125s
	iters: 300, epoch: 20 | loss: 0.0001688
	speed: 0.0499s/iter; left time: 710.0368s
	iters: 400, epoch: 20 | loss: 0.0000392
	speed: 0.0501s/iter; left time: 707.7942s
Epoch: 20 cost time: 23.754018783569336
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000152
	speed: 0.2820s/iter; left time: 3939.6161s
	iters: 200, epoch: 21 | loss: 0.0000148
	speed: 0.0497s/iter; left time: 689.1427s
	iters: 300, epoch: 21 | loss: 0.0000018
	speed: 0.0513s/iter; left time: 706.0953s
	iters: 400, epoch: 21 | loss: 0.0001260
	speed: 0.0529s/iter; left time: 722.5974s
Epoch: 21 cost time: 24.24599838256836
Epoch: 21, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.976 Test Loss: 0.224 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000020
	speed: 0.3032s/iter; left time: 4093.1986s
	iters: 200, epoch: 22 | loss: 0.0015333
	speed: 0.0489s/iter; left time: 655.8278s
	iters: 300, epoch: 22 | loss: 0.0000237
	speed: 0.0477s/iter; left time: 633.9076s
	iters: 400, epoch: 22 | loss: 0.0002376
	speed: 0.0466s/iter; left time: 614.5553s
Epoch: 22 cost time: 23.08300495147705
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.970 Test Loss: 0.257 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0007867
	speed: 0.2986s/iter; left time: 3891.3354s
	iters: 200, epoch: 23 | loss: 0.0003342
	speed: 0.0492s/iter; left time: 636.0522s
	iters: 300, epoch: 23 | loss: 0.0094412
	speed: 0.0507s/iter; left time: 650.0264s
	iters: 400, epoch: 23 | loss: 0.0674704
	speed: 0.0508s/iter; left time: 646.6187s
Epoch: 23 cost time: 24.00609517097473
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.238 Vali Acc: 0.969 Test Loss: 0.238 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000936
	speed: 0.2833s/iter; left time: 3559.4724s
	iters: 200, epoch: 24 | loss: 0.0270690
	speed: 0.0516s/iter; left time: 642.8778s
	iters: 300, epoch: 24 | loss: 0.0000103
	speed: 0.0513s/iter; left time: 633.9807s
	iters: 400, epoch: 24 | loss: 0.0090047
	speed: 0.0509s/iter; left time: 623.7872s
Epoch: 24 cost time: 24.588064670562744
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.258 Vali Acc: 0.973 Test Loss: 0.258 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000023
	speed: 0.2952s/iter; left time: 3570.0311s
	iters: 200, epoch: 25 | loss: 0.0008408
	speed: 0.0483s/iter; left time: 579.1505s
	iters: 300, epoch: 25 | loss: 0.0000045
	speed: 0.0486s/iter; left time: 578.1739s
	iters: 400, epoch: 25 | loss: 0.0000076
	speed: 0.0502s/iter; left time: 591.6091s
Epoch: 25 cost time: 23.673251152038574
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.280 Vali Acc: 0.970 Test Loss: 0.280 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000006
	speed: 0.3062s/iter; left time: 3559.3354s
	iters: 200, epoch: 26 | loss: 0.0000104
	speed: 0.0516s/iter; left time: 594.2991s
	iters: 300, epoch: 26 | loss: 0.0000785
	speed: 0.0512s/iter; left time: 584.8808s
	iters: 400, epoch: 26 | loss: 0.0058197
	speed: 0.0488s/iter; left time: 552.4048s
Epoch: 26 cost time: 24.24232316017151
Epoch: 26, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.255 Vali Acc: 0.972 Test Loss: 0.255 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000141
	speed: 0.2906s/iter; left time: 3242.3370s
	iters: 200, epoch: 27 | loss: 0.0000099
	speed: 0.0495s/iter; left time: 546.8192s
	iters: 300, epoch: 27 | loss: 0.0000029
	speed: 0.0495s/iter; left time: 542.7615s
	iters: 400, epoch: 27 | loss: 0.0026610
	speed: 0.0500s/iter; left time: 542.4218s
Epoch: 27 cost time: 23.87448287010193
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.240 Vali Acc: 0.973 Test Loss: 0.240 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0024211
	speed: 0.2955s/iter; left time: 3158.5492s
	iters: 200, epoch: 28 | loss: 0.0000527
	speed: 0.0466s/iter; left time: 493.3510s
	iters: 300, epoch: 28 | loss: 0.0000722
	speed: 0.0470s/iter; left time: 493.1438s
	iters: 400, epoch: 28 | loss: 0.2075781
	speed: 0.0488s/iter; left time: 506.6875s
Epoch: 28 cost time: 23.301825761795044
Epoch: 28, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 212970
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3684490
	speed: 0.0743s/iter; left time: 1734.6990s
	iters: 200, epoch: 1 | loss: 0.1666780
	speed: 0.0545s/iter; left time: 1267.4493s
	iters: 300, epoch: 1 | loss: 0.1652487
	speed: 0.0556s/iter; left time: 1287.7478s
	iters: 400, epoch: 1 | loss: 0.2406138
	speed: 0.0602s/iter; left time: 1387.2380s
Epoch: 1 cost time: 28.83360505104065
Epoch: 1, Steps: 469 | Train Loss: 0.398 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
Validation loss decreased (inf --> -0.960261).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0092238
	speed: 0.3423s/iter; left time: 7833.4163s
	iters: 200, epoch: 2 | loss: 0.0050512
	speed: 0.0367s/iter; left time: 835.9976s
	iters: 300, epoch: 2 | loss: 0.0285451
	speed: 0.0484s/iter; left time: 1097.4311s
	iters: 400, epoch: 2 | loss: 0.3093355
	speed: 0.0470s/iter; left time: 1061.6980s
Epoch: 2 cost time: 21.49740195274353
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0060415
	speed: 0.3715s/iter; left time: 8326.2038s
	iters: 200, epoch: 3 | loss: 0.0300946
	speed: 0.0615s/iter; left time: 1372.2023s
	iters: 300, epoch: 3 | loss: 0.0086238
	speed: 0.0636s/iter; left time: 1413.6890s
	iters: 400, epoch: 3 | loss: 0.0033205
	speed: 0.0630s/iter; left time: 1392.2209s
Epoch: 3 cost time: 29.729356050491333
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.204 Vali Acc: 0.966 Test Loss: 0.204 Test Acc: 0.966
Validation loss decreased (-0.960261 --> -0.965979).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0445715
	speed: 0.3651s/iter; left time: 8012.2351s
	iters: 200, epoch: 4 | loss: 0.0735791
	speed: 0.0528s/iter; left time: 1154.0866s
	iters: 300, epoch: 4 | loss: 0.0001833
	speed: 0.0505s/iter; left time: 1098.5673s
	iters: 400, epoch: 4 | loss: 0.5683644
	speed: 0.0500s/iter; left time: 1082.7299s
Epoch: 4 cost time: 25.8723042011261
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.203 Vali Acc: 0.964 Test Loss: 0.203 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0054371
	speed: 0.3764s/iter; left time: 8083.5178s
	iters: 200, epoch: 5 | loss: 0.3282008
	speed: 0.0563s/iter; left time: 1203.7879s
	iters: 300, epoch: 5 | loss: 0.0019948
	speed: 0.0562s/iter; left time: 1194.9067s
	iters: 400, epoch: 5 | loss: 0.1705730
	speed: 0.0594s/iter; left time: 1258.3164s
Epoch: 5 cost time: 27.30658721923828
Epoch: 5, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.239 Vali Acc: 0.965 Test Loss: 0.239 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0263595
	speed: 0.3636s/iter; left time: 7638.6918s
	iters: 200, epoch: 6 | loss: 0.0277612
	speed: 0.0604s/iter; left time: 1263.5741s
	iters: 300, epoch: 6 | loss: 0.0086471
	speed: 0.0619s/iter; left time: 1288.5490s
	iters: 400, epoch: 6 | loss: 0.0505150
	speed: 0.0624s/iter; left time: 1292.6604s
Epoch: 6 cost time: 29.301812887191772
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.227 Vali Acc: 0.968 Test Loss: 0.227 Test Acc: 0.968
Validation loss decreased (-0.965979 --> -0.967979).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000007
	speed: 0.3622s/iter; left time: 7437.8615s
	iters: 200, epoch: 7 | loss: 0.1228301
	speed: 0.0612s/iter; left time: 1250.4142s
	iters: 300, epoch: 7 | loss: 0.0000832
	speed: 0.0601s/iter; left time: 1222.9829s
	iters: 400, epoch: 7 | loss: 0.0030845
	speed: 0.0600s/iter; left time: 1213.4680s
Epoch: 7 cost time: 28.87497305870056
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.967979 --> -0.977414).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0280572
	speed: 0.3596s/iter; left time: 7216.9712s
	iters: 200, epoch: 8 | loss: 0.0009565
	speed: 0.0608s/iter; left time: 1213.9465s
	iters: 300, epoch: 8 | loss: 0.0156576
	speed: 0.0629s/iter; left time: 1249.0827s
	iters: 400, epoch: 8 | loss: 0.0009927
	speed: 0.0596s/iter; left time: 1179.1602s
Epoch: 8 cost time: 28.39252996444702
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.212 Vali Acc: 0.968 Test Loss: 0.212 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0035574
	speed: 0.3678s/iter; left time: 7208.4163s
	iters: 200, epoch: 9 | loss: 0.0000076
	speed: 0.0546s/iter; left time: 1064.0211s
	iters: 300, epoch: 9 | loss: 0.0082691
	speed: 0.0566s/iter; left time: 1098.7247s
	iters: 400, epoch: 9 | loss: 0.0003082
	speed: 0.0583s/iter; left time: 1125.2393s
Epoch: 9 cost time: 26.917541027069092
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.224 Vali Acc: 0.970 Test Loss: 0.224 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000017
	speed: 0.3904s/iter; left time: 7468.2662s
	iters: 200, epoch: 10 | loss: 0.0020289
	speed: 0.0642s/iter; left time: 1220.8549s
	iters: 300, epoch: 10 | loss: 0.0000005
	speed: 0.0692s/iter; left time: 1309.6181s
	iters: 400, epoch: 10 | loss: 0.0000016
	speed: 0.0670s/iter; left time: 1261.0570s
Epoch: 10 cost time: 31.27876925468445
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.309 Vali Acc: 0.963 Test Loss: 0.309 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.4188s/iter; left time: 7814.5005s
	iters: 200, epoch: 11 | loss: 0.2079230
	speed: 0.0666s/iter; left time: 1236.5126s
	iters: 300, epoch: 11 | loss: 0.0000421
	speed: 0.0655s/iter; left time: 1208.4330s
	iters: 400, epoch: 11 | loss: 0.0006845
	speed: 0.0666s/iter; left time: 1222.4697s
Epoch: 11 cost time: 31.502726554870605
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000013
	speed: 0.4124s/iter; left time: 7503.2514s
	iters: 200, epoch: 12 | loss: 0.0090491
	speed: 0.0703s/iter; left time: 1271.9338s
	iters: 300, epoch: 12 | loss: 0.0022428
	speed: 0.0685s/iter; left time: 1233.3378s
	iters: 400, epoch: 12 | loss: 0.0003010
	speed: 0.0687s/iter; left time: 1230.0430s
Epoch: 12 cost time: 33.18052792549133
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0001818
	speed: 0.4166s/iter; left time: 7383.5178s
	iters: 200, epoch: 13 | loss: 0.0000002
	speed: 0.0698s/iter; left time: 1229.6094s
	iters: 300, epoch: 13 | loss: 0.0003792
	speed: 0.0693s/iter; left time: 1214.0753s
	iters: 400, epoch: 13 | loss: 0.0036260
	speed: 0.0695s/iter; left time: 1210.0378s
Epoch: 13 cost time: 32.983314514160156
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.973 Test Loss: 0.208 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000064
	speed: 0.4472s/iter; left time: 7715.8653s
	iters: 200, epoch: 14 | loss: 0.0095069
	speed: 0.0704s/iter; left time: 1206.9329s
	iters: 300, epoch: 14 | loss: 0.0200606
	speed: 0.0699s/iter; left time: 1192.8499s
	iters: 400, epoch: 14 | loss: 0.3997270
	speed: 0.0730s/iter; left time: 1237.3451s
Epoch: 14 cost time: 33.83313798904419
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.972 Test Loss: 0.221 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0117213
	speed: 0.4301s/iter; left time: 7219.1109s
	iters: 200, epoch: 15 | loss: 0.0000056
	speed: 0.0693s/iter; left time: 1156.6879s
	iters: 300, epoch: 15 | loss: 0.0000366
	speed: 0.0653s/iter; left time: 1083.6673s
	iters: 400, epoch: 15 | loss: 0.0012621
	speed: 0.0692s/iter; left time: 1139.9986s
Epoch: 15 cost time: 32.34230971336365
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.977 Test Loss: 0.217 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000566
	speed: 0.4273s/iter; left time: 6972.5126s
	iters: 200, epoch: 16 | loss: 0.0026435
	speed: 0.0735s/iter; left time: 1191.7435s
	iters: 300, epoch: 16 | loss: 0.0550292
	speed: 0.0736s/iter; left time: 1186.4476s
	iters: 400, epoch: 16 | loss: 0.0000105
	speed: 0.0738s/iter; left time: 1181.2247s
Epoch: 16 cost time: 34.84588980674744
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.967 Test Loss: 0.244 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000050
	speed: 0.4145s/iter; left time: 6568.5817s
	iters: 200, epoch: 17 | loss: 0.0000193
	speed: 0.0684s/iter; left time: 1077.6716s
	iters: 300, epoch: 17 | loss: 0.0000005
	speed: 0.0735s/iter; left time: 1150.3071s
	iters: 400, epoch: 17 | loss: 0.0000431
	speed: 0.0744s/iter; left time: 1156.9344s
Epoch: 17 cost time: 33.93736743927002
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.279 Vali Acc: 0.971 Test Loss: 0.279 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 770826
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2619619
	speed: 0.0890s/iter; left time: 2077.6082s
	iters: 200, epoch: 1 | loss: 0.1054132
	speed: 0.0710s/iter; left time: 1651.1249s
	iters: 300, epoch: 1 | loss: 0.0510699
	speed: 0.0695s/iter; left time: 1610.0621s
	iters: 400, epoch: 1 | loss: 0.1322752
	speed: 0.0708s/iter; left time: 1633.1464s
Epoch: 1 cost time: 34.91712522506714
Epoch: 1, Steps: 469 | Train Loss: 0.390 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
Validation loss decreased (inf --> -0.948254).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0439536
	speed: 0.4291s/iter; left time: 9818.8934s
	iters: 200, epoch: 2 | loss: 0.0057782
	speed: 0.0679s/iter; left time: 1547.3581s
	iters: 300, epoch: 2 | loss: 0.0545221
	speed: 0.0720s/iter; left time: 1633.1225s
	iters: 400, epoch: 2 | loss: 0.2502929
	speed: 0.0736s/iter; left time: 1661.3741s
Epoch: 2 cost time: 34.054463148117065
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4002835
	speed: 0.4362s/iter; left time: 9777.0808s
	iters: 200, epoch: 3 | loss: 0.0910270
	speed: 0.0705s/iter; left time: 1573.6138s
	iters: 300, epoch: 3 | loss: 0.0028201
	speed: 0.0701s/iter; left time: 1557.2576s
	iters: 400, epoch: 3 | loss: 0.0011827
	speed: 0.0711s/iter; left time: 1571.6666s
Epoch: 3 cost time: 33.01442527770996
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
Validation loss decreased (-0.948254 --> -0.970839).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0128070
	speed: 0.4446s/iter; left time: 9755.8362s
	iters: 200, epoch: 4 | loss: 0.0022567
	speed: 0.0700s/iter; left time: 1529.7750s
	iters: 300, epoch: 4 | loss: 0.0017948
	speed: 0.0680s/iter; left time: 1478.4044s
	iters: 400, epoch: 4 | loss: 0.5434145
	speed: 0.0743s/iter; left time: 1607.5321s
Epoch: 4 cost time: 33.81469225883484
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0595606
	speed: 0.4358s/iter; left time: 9358.8691s
	iters: 200, epoch: 5 | loss: 0.0016053
	speed: 0.0689s/iter; left time: 1472.4227s
	iters: 300, epoch: 5 | loss: 0.0821551
	speed: 0.0667s/iter; left time: 1418.6661s
	iters: 400, epoch: 5 | loss: 0.0010132
	speed: 0.0649s/iter; left time: 1373.3966s
Epoch: 5 cost time: 31.650468111038208
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.970839 --> -0.974841).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0001485
	speed: 0.4320s/iter; left time: 9075.4664s
	iters: 200, epoch: 6 | loss: 0.0043899
	speed: 0.0694s/iter; left time: 1451.8334s
	iters: 300, epoch: 6 | loss: 0.2291731
	speed: 0.0709s/iter; left time: 1476.1406s
	iters: 400, epoch: 6 | loss: 0.0000522
	speed: 0.0753s/iter; left time: 1558.4061s
Epoch: 6 cost time: 34.377293825149536
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000005
	speed: 0.4222s/iter; left time: 8669.7319s
	iters: 200, epoch: 7 | loss: 0.0139574
	speed: 0.0715s/iter; left time: 1461.0608s
	iters: 300, epoch: 7 | loss: 0.0001476
	speed: 0.0728s/iter; left time: 1479.5915s
	iters: 400, epoch: 7 | loss: 0.0006708
	speed: 0.0759s/iter; left time: 1536.3253s
Epoch: 7 cost time: 34.77850008010864
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.307 Vali Acc: 0.954 Test Loss: 0.307 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0009938
	speed: 0.4508s/iter; left time: 9046.8936s
	iters: 200, epoch: 8 | loss: 0.0029162
	speed: 0.0760s/iter; left time: 1517.8918s
	iters: 300, epoch: 8 | loss: 0.0006234
	speed: 0.0772s/iter; left time: 1533.3998s
	iters: 400, epoch: 8 | loss: 0.0000578
	speed: 0.0767s/iter; left time: 1515.4205s
Epoch: 8 cost time: 36.043399810791016
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.241 Vali Acc: 0.965 Test Loss: 0.241 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0004656
	speed: 0.4239s/iter; left time: 8307.6868s
	iters: 200, epoch: 9 | loss: 0.0089961
	speed: 0.0686s/iter; left time: 1338.3594s
	iters: 300, epoch: 9 | loss: 0.0001790
	speed: 0.0758s/iter; left time: 1469.9847s
	iters: 400, epoch: 9 | loss: 0.0298956
	speed: 0.0753s/iter; left time: 1453.9587s
Epoch: 9 cost time: 34.056111574172974
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.966 Test Loss: 0.238 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0001266
	speed: 0.4362s/iter; left time: 8344.6800s
	iters: 200, epoch: 10 | loss: 0.0004086
	speed: 0.0643s/iter; left time: 1224.0775s
	iters: 300, epoch: 10 | loss: 0.0009604
	speed: 0.0630s/iter; left time: 1193.0223s
	iters: 400, epoch: 10 | loss: 0.0000012
	speed: 0.0668s/iter; left time: 1257.1087s
Epoch: 10 cost time: 31.669462203979492
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000424
	speed: 0.4159s/iter; left time: 7760.8570s
	iters: 200, epoch: 11 | loss: 0.0000660
	speed: 0.0718s/iter; left time: 1332.1136s
	iters: 300, epoch: 11 | loss: 0.0002414
	speed: 0.0724s/iter; left time: 1337.1070s
	iters: 400, epoch: 11 | loss: 0.0003531
	speed: 0.0680s/iter; left time: 1248.1082s
Epoch: 11 cost time: 33.35825967788696
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0001302
	speed: 0.4263s/iter; left time: 7755.3368s
	iters: 200, epoch: 12 | loss: 0.0026002
	speed: 0.0713s/iter; left time: 1290.7153s
	iters: 300, epoch: 12 | loss: 0.0024642
	speed: 0.0679s/iter; left time: 1221.7560s
	iters: 400, epoch: 12 | loss: 0.0000000
	speed: 0.0662s/iter; left time: 1184.3412s
Epoch: 12 cost time: 32.50904679298401
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.306 Vali Acc: 0.970 Test Loss: 0.306 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000557
	speed: 0.4006s/iter; left time: 7099.7895s
	iters: 200, epoch: 13 | loss: 0.0000038
	speed: 0.0705s/iter; left time: 1242.7865s
	iters: 300, epoch: 13 | loss: 0.0004594
	speed: 0.0680s/iter; left time: 1191.4555s
	iters: 400, epoch: 13 | loss: 0.0002197
	speed: 0.0661s/iter; left time: 1152.2335s
Epoch: 13 cost time: 32.730464458465576
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.319 Vali Acc: 0.967 Test Loss: 0.319 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0006886
	speed: 0.4177s/iter; left time: 7207.1695s
	iters: 200, epoch: 14 | loss: 0.0000005
	speed: 0.0670s/iter; left time: 1149.8675s
	iters: 300, epoch: 14 | loss: 0.0011927
	speed: 0.0674s/iter; left time: 1148.8651s
	iters: 400, epoch: 14 | loss: 0.0011440
	speed: 0.0681s/iter; left time: 1154.7853s
Epoch: 14 cost time: 31.88992190361023
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.220 Vali Acc: 0.978 Test Loss: 0.220 Test Acc: 0.978
Validation loss decreased (-0.974841 --> -0.978271).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001329
	speed: 0.4084s/iter; left time: 6855.7517s
	iters: 200, epoch: 15 | loss: 0.0002441
	speed: 0.0670s/iter; left time: 1117.5196s
	iters: 300, epoch: 15 | loss: 0.0000058
	speed: 0.0697s/iter; left time: 1155.8635s
	iters: 400, epoch: 15 | loss: 0.0000439
	speed: 0.0685s/iter; left time: 1129.8414s
Epoch: 15 cost time: 32.20222020149231
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.288 Vali Acc: 0.965 Test Loss: 0.288 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001031
	speed: 0.4252s/iter; left time: 6937.5240s
	iters: 200, epoch: 16 | loss: 0.0000005
	speed: 0.0665s/iter; left time: 1077.7835s
	iters: 300, epoch: 16 | loss: 0.0000005
	speed: 0.0642s/iter; left time: 1033.8535s
	iters: 400, epoch: 16 | loss: 0.0005476
	speed: 0.0631s/iter; left time: 1010.5242s
Epoch: 16 cost time: 31.031341075897217
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0043502
	speed: 0.4319s/iter; left time: 6844.5170s
	iters: 200, epoch: 17 | loss: 0.0000086
	speed: 0.0724s/iter; left time: 1140.6257s
	iters: 300, epoch: 17 | loss: 0.0000004
	speed: 0.0721s/iter; left time: 1127.9192s
	iters: 400, epoch: 17 | loss: 0.0191127
	speed: 0.0707s/iter; left time: 1098.6279s
Epoch: 17 cost time: 33.401480197906494
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.318 Vali Acc: 0.962 Test Loss: 0.318 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0082679
	speed: 0.4071s/iter; left time: 6259.7272s
	iters: 200, epoch: 18 | loss: 0.0009721
	speed: 0.0665s/iter; left time: 1015.3650s
	iters: 300, epoch: 18 | loss: 0.0000251
	speed: 0.0684s/iter; left time: 1037.8399s
	iters: 400, epoch: 18 | loss: 0.0134839
	speed: 0.0677s/iter; left time: 1020.1910s
Epoch: 18 cost time: 32.44156050682068
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.302 Vali Acc: 0.962 Test Loss: 0.302 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0001264
	speed: 0.4217s/iter; left time: 6287.6466s
	iters: 200, epoch: 19 | loss: 0.0000015
	speed: 0.0709s/iter; left time: 1050.6571s
	iters: 300, epoch: 19 | loss: 0.0000079
	speed: 0.0709s/iter; left time: 1042.5122s
	iters: 400, epoch: 19 | loss: 0.0001693
	speed: 0.0718s/iter; left time: 1048.8143s
Epoch: 19 cost time: 33.704925775527954
Epoch: 19, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.237 Vali Acc: 0.971 Test Loss: 0.237 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0350182
	speed: 0.4019s/iter; left time: 5803.8050s
	iters: 200, epoch: 20 | loss: 0.0001854
	speed: 0.0682s/iter; left time: 978.0178s
	iters: 300, epoch: 20 | loss: 0.0026915
	speed: 0.0706s/iter; left time: 1005.9332s
	iters: 400, epoch: 20 | loss: 0.0472466
	speed: 0.0718s/iter; left time: 1014.6012s
Epoch: 20 cost time: 32.663814544677734
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.978 Test Loss: 0.221 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000698
	speed: 0.4277s/iter; left time: 5975.4896s
	iters: 200, epoch: 21 | loss: 0.0000037
	speed: 0.0627s/iter; left time: 869.5245s
	iters: 300, epoch: 21 | loss: 0.0552851
	speed: 0.0660s/iter; left time: 909.5004s
	iters: 400, epoch: 21 | loss: 0.0007184
	speed: 0.0716s/iter; left time: 979.3878s
Epoch: 21 cost time: 31.857816457748413
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.345 Vali Acc: 0.973 Test Loss: 0.345 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0759741
	speed: 0.4011s/iter; left time: 5415.1311s
	iters: 200, epoch: 22 | loss: 0.0000076
	speed: 0.0700s/iter; left time: 937.8527s
	iters: 300, epoch: 22 | loss: 0.0000000
	speed: 0.0677s/iter; left time: 900.2514s
	iters: 400, epoch: 22 | loss: 0.0000183
	speed: 0.0671s/iter; left time: 886.2652s
Epoch: 22 cost time: 32.20512080192566
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.277 Vali Acc: 0.968 Test Loss: 0.277 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0000111
	speed: 0.4166s/iter; left time: 5429.3161s
	iters: 200, epoch: 23 | loss: 0.0000005
	speed: 0.0707s/iter; left time: 914.5572s
	iters: 300, epoch: 23 | loss: 0.0000319
	speed: 0.0735s/iter; left time: 943.8389s
	iters: 400, epoch: 23 | loss: 0.0000417
	speed: 0.0694s/iter; left time: 883.9563s
Epoch: 23 cost time: 32.083802461624146
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.291 Vali Acc: 0.976 Test Loss: 0.291 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000088
	speed: 0.4172s/iter; left time: 5241.8405s
	iters: 200, epoch: 24 | loss: 0.0000114
	speed: 0.0736s/iter; left time: 917.3217s
	iters: 300, epoch: 24 | loss: 0.0002728
	speed: 0.0739s/iter; left time: 913.6390s
	iters: 400, epoch: 24 | loss: 0.0000536
	speed: 0.0737s/iter; left time: 903.5695s
Epoch: 24 cost time: 34.86565709114075
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.967 Test Loss: 0.278 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 770954
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9456589
	speed: 0.0711s/iter; left time: 1660.9548s
	iters: 200, epoch: 1 | loss: 0.1333670
	speed: 0.0538s/iter; left time: 1251.6932s
	iters: 300, epoch: 1 | loss: 0.1635434
	speed: 0.0555s/iter; left time: 1283.8777s
	iters: 400, epoch: 1 | loss: 0.1429549
	speed: 0.0564s/iter; left time: 1301.0054s
Epoch: 1 cost time: 27.665656089782715
Epoch: 1, Steps: 469 | Train Loss: 0.557 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (inf --> -0.933388).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0583110
	speed: 0.3523s/iter; left time: 8061.9401s
	iters: 200, epoch: 2 | loss: 0.0148905
	speed: 0.0592s/iter; left time: 1347.6412s
	iters: 300, epoch: 2 | loss: 0.0254544
	speed: 0.0592s/iter; left time: 1342.9746s
	iters: 400, epoch: 2 | loss: 0.0155865
	speed: 0.0588s/iter; left time: 1326.8318s
Epoch: 2 cost time: 28.141424417495728
Epoch: 2, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
Validation loss decreased (-0.933388 --> -0.961119).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0057386
	speed: 0.3529s/iter; left time: 7910.1909s
	iters: 200, epoch: 3 | loss: 0.8060434
	speed: 0.0516s/iter; left time: 1152.4065s
	iters: 300, epoch: 3 | loss: 0.0193922
	speed: 0.0519s/iter; left time: 1153.2914s
	iters: 400, epoch: 3 | loss: 0.0244718
	speed: 0.0552s/iter; left time: 1221.1538s
Epoch: 3 cost time: 25.27259635925293
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.947 Test Loss: 0.215 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0049046
	speed: 0.3544s/iter; left time: 7777.3491s
	iters: 200, epoch: 4 | loss: 0.0012883
	speed: 0.0601s/iter; left time: 1312.1491s
	iters: 300, epoch: 4 | loss: 0.5113146
	speed: 0.0599s/iter; left time: 1303.0744s
	iters: 400, epoch: 4 | loss: 0.0001584
	speed: 0.0579s/iter; left time: 1252.3587s
Epoch: 4 cost time: 27.79585337638855
Epoch: 4, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.961119 --> -0.967123).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0007988
	speed: 0.3522s/iter; left time: 7563.2614s
	iters: 200, epoch: 5 | loss: 0.0450764
	speed: 0.0557s/iter; left time: 1191.1826s
	iters: 300, epoch: 5 | loss: 0.0030855
	speed: 0.0559s/iter; left time: 1190.1422s
	iters: 400, epoch: 5 | loss: 0.0002711
	speed: 0.0554s/iter; left time: 1173.0289s
Epoch: 5 cost time: 26.81575918197632
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1012932
	speed: 0.3305s/iter; left time: 6941.9067s
	iters: 200, epoch: 6 | loss: 0.0003931
	speed: 0.0571s/iter; left time: 1192.9352s
	iters: 300, epoch: 6 | loss: 0.0001826
	speed: 0.0582s/iter; left time: 1211.5286s
	iters: 400, epoch: 6 | loss: 0.0035912
	speed: 0.0589s/iter; left time: 1220.4290s
Epoch: 6 cost time: 27.48636484146118
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.967123 --> -0.969981).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0007602
	speed: 0.3615s/iter; left time: 7423.2458s
	iters: 200, epoch: 7 | loss: 0.0000796
	speed: 0.0559s/iter; left time: 1142.3841s
	iters: 300, epoch: 7 | loss: 0.0022519
	speed: 0.0517s/iter; left time: 1051.4807s
	iters: 400, epoch: 7 | loss: 0.0391646
	speed: 0.0501s/iter; left time: 1013.7290s
Epoch: 7 cost time: 25.45532989501953
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
Validation loss decreased (-0.969981 --> -0.977986).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004752
	speed: 0.3348s/iter; left time: 6718.4427s
	iters: 200, epoch: 8 | loss: 0.0010670
	speed: 0.0567s/iter; left time: 1132.7297s
	iters: 300, epoch: 8 | loss: 0.0000085
	speed: 0.0564s/iter; left time: 1119.8653s
	iters: 400, epoch: 8 | loss: 0.0625764
	speed: 0.0482s/iter; left time: 952.2348s
Epoch: 8 cost time: 25.219286680221558
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0014280
	speed: 0.3220s/iter; left time: 6311.7156s
	iters: 200, epoch: 9 | loss: 0.0002723
	speed: 0.0570s/iter; left time: 1110.6055s
	iters: 300, epoch: 9 | loss: 0.0423374
	speed: 0.0572s/iter; left time: 1109.5104s
	iters: 400, epoch: 9 | loss: 0.0012591
	speed: 0.0582s/iter; left time: 1122.4007s
Epoch: 9 cost time: 27.227266311645508
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0033801
	speed: 0.3355s/iter; left time: 6417.5043s
	iters: 200, epoch: 10 | loss: 0.0004081
	speed: 0.0539s/iter; left time: 1024.8683s
	iters: 300, epoch: 10 | loss: 0.0010531
	speed: 0.0525s/iter; left time: 994.6780s
	iters: 400, epoch: 10 | loss: 0.2773049
	speed: 0.0527s/iter; left time: 992.7582s
Epoch: 10 cost time: 25.53938627243042
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000033
	speed: 0.3391s/iter; left time: 6327.3818s
	iters: 200, epoch: 11 | loss: 0.0001359
	speed: 0.0536s/iter; left time: 994.6521s
	iters: 300, epoch: 11 | loss: 0.0000095
	speed: 0.0531s/iter; left time: 979.6366s
	iters: 400, epoch: 11 | loss: 0.2969142
	speed: 0.0530s/iter; left time: 973.3889s
Epoch: 11 cost time: 25.60741949081421
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0004864
	speed: 0.3315s/iter; left time: 6031.1365s
	iters: 200, epoch: 12 | loss: 0.0000774
	speed: 0.0533s/iter; left time: 963.7983s
	iters: 300, epoch: 12 | loss: 0.0003716
	speed: 0.0528s/iter; left time: 949.1831s
	iters: 400, epoch: 12 | loss: 0.0000566
	speed: 0.0502s/iter; left time: 898.3783s
Epoch: 12 cost time: 25.219645500183105
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0004878
	speed: 0.3253s/iter; left time: 5764.6509s
	iters: 200, epoch: 13 | loss: 0.0003273
	speed: 0.0524s/iter; left time: 923.1649s
	iters: 300, epoch: 13 | loss: 0.0018948
	speed: 0.0558s/iter; left time: 977.7637s
	iters: 400, epoch: 13 | loss: 0.0004240
	speed: 0.0559s/iter; left time: 973.1274s
Epoch: 13 cost time: 25.95513153076172
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0004546
	speed: 0.3357s/iter; left time: 5793.0074s
	iters: 200, epoch: 14 | loss: 0.0000685
	speed: 0.0534s/iter; left time: 916.0269s
	iters: 300, epoch: 14 | loss: 0.0001579
	speed: 0.0546s/iter; left time: 930.7965s
	iters: 400, epoch: 14 | loss: 0.0001377
	speed: 0.0520s/iter; left time: 881.0595s
Epoch: 14 cost time: 25.27679991722107
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000019
	speed: 0.3370s/iter; left time: 5657.1817s
	iters: 200, epoch: 15 | loss: 0.0001309
	speed: 0.0525s/iter; left time: 876.7824s
	iters: 300, epoch: 15 | loss: 0.0000065
	speed: 0.0521s/iter; left time: 863.7155s
	iters: 400, epoch: 15 | loss: 0.0199632
	speed: 0.0526s/iter; left time: 867.4873s
Epoch: 15 cost time: 25.10039234161377
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0472379
	speed: 0.3330s/iter; left time: 5432.6441s
	iters: 200, epoch: 16 | loss: 0.0000150
	speed: 0.0559s/iter; left time: 906.6788s
	iters: 300, epoch: 16 | loss: 0.0245028
	speed: 0.0548s/iter; left time: 883.6930s
	iters: 400, epoch: 16 | loss: 0.0002542
	speed: 0.0495s/iter; left time: 792.4025s
Epoch: 16 cost time: 25.340670585632324
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000160
	speed: 0.3204s/iter; left time: 5076.6819s
	iters: 200, epoch: 17 | loss: 0.0061869
	speed: 0.0509s/iter; left time: 801.6391s
	iters: 300, epoch: 17 | loss: 0.0005438
	speed: 0.0518s/iter; left time: 810.0071s
	iters: 400, epoch: 17 | loss: 0.0000047
	speed: 0.0524s/iter; left time: 815.1563s
Epoch: 17 cost time: 24.881571292877197
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 205194
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6476132
	speed: 0.0719s/iter; left time: 1678.3130s
	iters: 200, epoch: 1 | loss: 0.3942592
	speed: 0.0507s/iter; left time: 1179.3311s
	iters: 300, epoch: 1 | loss: 0.1696594
	speed: 0.0516s/iter; left time: 1193.5841s
	iters: 400, epoch: 1 | loss: 0.0960264
	speed: 0.0536s/iter; left time: 1234.7067s
Epoch: 1 cost time: 26.667590379714966
Epoch: 1, Steps: 469 | Train Loss: 0.558 Vali Loss: 0.248 Vali Acc: 0.938 Test Loss: 0.248 Test Acc: 0.938
Validation loss decreased (inf --> -0.937962).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0136652
	speed: 0.3267s/iter; left time: 7474.8392s
	iters: 200, epoch: 2 | loss: 0.0093776
	speed: 0.0517s/iter; left time: 1178.1775s
	iters: 300, epoch: 2 | loss: 0.0547651
	speed: 0.0552s/iter; left time: 1250.9874s
	iters: 400, epoch: 2 | loss: 0.0230291
	speed: 0.0521s/iter; left time: 1177.3032s
Epoch: 2 cost time: 24.869851112365723
Epoch: 2, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.171 Vali Acc: 0.964 Test Loss: 0.171 Test Acc: 0.964
Validation loss decreased (-0.937962 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0051274
	speed: 0.3215s/iter; left time: 7206.2529s
	iters: 200, epoch: 3 | loss: 0.0075698
	speed: 0.0491s/iter; left time: 1096.5722s
	iters: 300, epoch: 3 | loss: 0.0019030
	speed: 0.0503s/iter; left time: 1118.3984s
	iters: 400, epoch: 3 | loss: 0.0666349
	speed: 0.0516s/iter; left time: 1141.1411s
Epoch: 3 cost time: 24.162834882736206
Epoch: 3, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
Validation loss decreased (-0.964264 --> -0.973984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0134559
	speed: 0.3241s/iter; left time: 7111.0262s
	iters: 200, epoch: 4 | loss: 0.0046202
	speed: 0.0537s/iter; left time: 1172.9084s
	iters: 300, epoch: 4 | loss: 0.0104553
	speed: 0.0554s/iter; left time: 1204.5736s
	iters: 400, epoch: 4 | loss: 0.0079130
	speed: 0.0534s/iter; left time: 1156.4086s
Epoch: 4 cost time: 25.476994276046753
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0144102
	speed: 0.3238s/iter; left time: 6953.4381s
	iters: 200, epoch: 5 | loss: 0.0032960
	speed: 0.0558s/iter; left time: 1193.4090s
	iters: 300, epoch: 5 | loss: 0.0322585
	speed: 0.0534s/iter; left time: 1135.2220s
	iters: 400, epoch: 5 | loss: 0.1467389
	speed: 0.0520s/iter; left time: 1100.5190s
Epoch: 5 cost time: 25.635895013809204
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0042846
	speed: 0.3228s/iter; left time: 6779.9557s
	iters: 200, epoch: 6 | loss: 0.0025487
	speed: 0.0528s/iter; left time: 1104.7811s
	iters: 300, epoch: 6 | loss: 0.0003572
	speed: 0.0528s/iter; left time: 1097.7375s
	iters: 400, epoch: 6 | loss: 0.0053670
	speed: 0.0536s/iter; left time: 1110.5200s
Epoch: 6 cost time: 25.3459312915802
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.974841).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0003162
	speed: 0.3317s/iter; left time: 6812.7887s
	iters: 200, epoch: 7 | loss: 0.0496453
	speed: 0.0444s/iter; left time: 907.8812s
	iters: 300, epoch: 7 | loss: 0.0001685
	speed: 0.0430s/iter; left time: 874.8831s
	iters: 400, epoch: 7 | loss: 0.0044874
	speed: 0.0424s/iter; left time: 858.8484s
Epoch: 7 cost time: 22.097358465194702
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974841 --> -0.975413).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0131776
	speed: 0.3311s/iter; left time: 6645.0496s
	iters: 200, epoch: 8 | loss: 0.0000043
	speed: 0.0603s/iter; left time: 1204.8052s
	iters: 300, epoch: 8 | loss: 0.1829530
	speed: 0.0606s/iter; left time: 1204.1999s
	iters: 400, epoch: 8 | loss: 0.0005232
	speed: 0.0594s/iter; left time: 1173.2340s
Epoch: 8 cost time: 28.44032049179077
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0002553
	speed: 0.3322s/iter; left time: 6510.6063s
	iters: 200, epoch: 9 | loss: 0.0133424
	speed: 0.0563s/iter; left time: 1097.6433s
	iters: 300, epoch: 9 | loss: 0.0054247
	speed: 0.0585s/iter; left time: 1135.5471s
	iters: 400, epoch: 9 | loss: 0.0002970
	speed: 0.0530s/iter; left time: 1022.0303s
Epoch: 9 cost time: 26.3846697807312
Epoch: 9, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0222409
	speed: 0.3352s/iter; left time: 6412.3447s
	iters: 200, epoch: 10 | loss: 0.0650217
	speed: 0.0505s/iter; left time: 960.8385s
	iters: 300, epoch: 10 | loss: 0.0002692
	speed: 0.0508s/iter; left time: 961.5369s
	iters: 400, epoch: 10 | loss: 0.0033730
	speed: 0.0539s/iter; left time: 1014.4328s
Epoch: 10 cost time: 24.456648111343384
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
Validation loss decreased (-0.975413 --> -0.975985).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000558
	speed: 0.3559s/iter; left time: 6642.2779s
	iters: 200, epoch: 11 | loss: 0.0000662
	speed: 0.0568s/iter; left time: 1054.0921s
	iters: 300, epoch: 11 | loss: 0.0001756
	speed: 0.0566s/iter; left time: 1045.7702s
	iters: 400, epoch: 11 | loss: 0.0096840
	speed: 0.0455s/iter; left time: 835.1188s
Epoch: 11 cost time: 24.98955726623535
Epoch: 11, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977128).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0207269
	speed: 0.3168s/iter; left time: 5762.6014s
	iters: 200, epoch: 12 | loss: 0.0000470
	speed: 0.0578s/iter; left time: 1045.0580s
	iters: 300, epoch: 12 | loss: 0.0334123
	speed: 0.0581s/iter; left time: 1044.6717s
	iters: 400, epoch: 12 | loss: 0.0009286
	speed: 0.0582s/iter; left time: 1042.0519s
Epoch: 12 cost time: 27.673645734786987
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0069204
	speed: 0.3339s/iter; left time: 5918.2975s
	iters: 200, epoch: 13 | loss: 0.4240075
	speed: 0.0545s/iter; left time: 960.2522s
	iters: 300, epoch: 13 | loss: 0.0000138
	speed: 0.0568s/iter; left time: 995.8500s
	iters: 400, epoch: 13 | loss: 0.0000035
	speed: 0.0578s/iter; left time: 1007.4830s
Epoch: 13 cost time: 26.623619079589844
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
Validation loss decreased (-0.977128 --> -0.979130).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0054554
	speed: 0.3422s/iter; left time: 5904.9637s
	iters: 200, epoch: 14 | loss: 0.0004184
	speed: 0.0498s/iter; left time: 854.3367s
	iters: 300, epoch: 14 | loss: 0.0000494
	speed: 0.0510s/iter; left time: 869.8130s
	iters: 400, epoch: 14 | loss: 0.0000629
	speed: 0.0492s/iter; left time: 834.6811s
Epoch: 14 cost time: 24.590593576431274
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.978 Test Loss: 0.214 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000009
	speed: 0.3489s/iter; left time: 5856.7949s
	iters: 200, epoch: 15 | loss: 0.0006335
	speed: 0.0580s/iter; left time: 968.1290s
	iters: 300, epoch: 15 | loss: 0.0025047
	speed: 0.0538s/iter; left time: 892.9960s
	iters: 400, epoch: 15 | loss: 0.0000008
	speed: 0.0520s/iter; left time: 856.5939s
Epoch: 15 cost time: 25.81899857521057
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.981131).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0612624
	speed: 0.3206s/iter; left time: 5230.1453s
	iters: 200, epoch: 16 | loss: 0.0013336
	speed: 0.0572s/iter; left time: 927.7288s
	iters: 300, epoch: 16 | loss: 0.0004635
	speed: 0.0583s/iter; left time: 939.3949s
	iters: 400, epoch: 16 | loss: 0.0001854
	speed: 0.0573s/iter; left time: 916.9708s
Epoch: 16 cost time: 27.286715984344482
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0001734
	speed: 0.3311s/iter; left time: 5247.4372s
	iters: 200, epoch: 17 | loss: 0.0001649
	speed: 0.0437s/iter; left time: 687.9088s
	iters: 300, epoch: 17 | loss: 0.0000836
	speed: 0.0450s/iter; left time: 704.2616s
	iters: 400, epoch: 17 | loss: 0.0001138
	speed: 0.0473s/iter; left time: 735.1120s
Epoch: 17 cost time: 22.471739768981934
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.978 Test Loss: 0.169 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000008
	speed: 0.3460s/iter; left time: 5321.3779s
	iters: 200, epoch: 18 | loss: 0.0000649
	speed: 0.0547s/iter; left time: 835.9128s
	iters: 300, epoch: 18 | loss: 0.0000017
	speed: 0.0510s/iter; left time: 773.8124s
	iters: 400, epoch: 18 | loss: 0.0000439
	speed: 0.0477s/iter; left time: 719.4917s
Epoch: 18 cost time: 24.615462064743042
Epoch: 18, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.274 Vali Acc: 0.969 Test Loss: 0.274 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0002094
	speed: 0.3257s/iter; left time: 4856.5968s
	iters: 200, epoch: 19 | loss: 0.0000573
	speed: 0.0570s/iter; left time: 844.1486s
	iters: 300, epoch: 19 | loss: 0.0024650
	speed: 0.0555s/iter; left time: 817.0670s
	iters: 400, epoch: 19 | loss: 0.0000364
	speed: 0.0561s/iter; left time: 819.5926s
Epoch: 19 cost time: 26.542579174041748
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.970 Test Loss: 0.210 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2160810
	speed: 0.3146s/iter; left time: 4542.8578s
	iters: 200, epoch: 20 | loss: 0.0000735
	speed: 0.0565s/iter; left time: 810.3361s
	iters: 300, epoch: 20 | loss: 0.0001882
	speed: 0.0571s/iter; left time: 812.9843s
	iters: 400, epoch: 20 | loss: 0.0000349
	speed: 0.0574s/iter; left time: 811.7550s
Epoch: 20 cost time: 26.698421239852905
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000441
	speed: 0.3386s/iter; left time: 4731.1141s
	iters: 200, epoch: 21 | loss: 0.0001277
	speed: 0.0441s/iter; left time: 612.0369s
	iters: 300, epoch: 21 | loss: 0.0000051
	speed: 0.0454s/iter; left time: 624.9711s
	iters: 400, epoch: 21 | loss: 0.0028036
	speed: 0.0503s/iter; left time: 688.0917s
Epoch: 21 cost time: 22.790265798568726
Epoch: 21, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000438
	speed: 0.3505s/iter; left time: 4732.9728s
	iters: 200, epoch: 22 | loss: 0.0000002
	speed: 0.0571s/iter; left time: 765.8469s
	iters: 300, epoch: 22 | loss: 0.0037118
	speed: 0.0552s/iter; left time: 734.7054s
	iters: 400, epoch: 22 | loss: 0.0000039
	speed: 0.0529s/iter; left time: 698.4657s
Epoch: 22 cost time: 26.193928480148315
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.283 Vali Acc: 0.966 Test Loss: 0.283 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0066802
	speed: 0.3243s/iter; left time: 4226.6028s
	iters: 200, epoch: 23 | loss: 0.0682742
	speed: 0.0574s/iter; left time: 742.4024s
	iters: 300, epoch: 23 | loss: 0.0010304
	speed: 0.0562s/iter; left time: 720.8115s
	iters: 400, epoch: 23 | loss: 0.0000166
	speed: 0.0573s/iter; left time: 729.8467s
Epoch: 23 cost time: 27.114928007125854
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.971 Test Loss: 0.262 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0615784
	speed: 0.3167s/iter; left time: 3979.5372s
	iters: 200, epoch: 24 | loss: 0.0000004
	speed: 0.0493s/iter; left time: 614.8791s
	iters: 300, epoch: 24 | loss: 0.0038431
	speed: 0.0545s/iter; left time: 674.3515s
	iters: 400, epoch: 24 | loss: 0.0001582
	speed: 0.0571s/iter; left time: 700.0258s
Epoch: 24 cost time: 25.283740282058716
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0072367
	speed: 0.3401s/iter; left time: 4113.6818s
	iters: 200, epoch: 25 | loss: 0.0020801
	speed: 0.0524s/iter; left time: 627.9773s
	iters: 300, epoch: 25 | loss: 0.0000017
	speed: 0.0510s/iter; left time: 607.1205s
	iters: 400, epoch: 25 | loss: 0.1079870
	speed: 0.0491s/iter; left time: 579.0426s
Epoch: 25 cost time: 24.50502634048462
Epoch: 25, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 205258
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3955721
	speed: 0.0590s/iter; left time: 1376.8021s
	iters: 200, epoch: 1 | loss: 0.5592065
	speed: 0.0429s/iter; left time: 997.8530s
	iters: 300, epoch: 1 | loss: 0.2299502
	speed: 0.0421s/iter; left time: 974.5670s
	iters: 400, epoch: 1 | loss: 0.3998376
	speed: 0.0408s/iter; left time: 939.6985s
Epoch: 1 cost time: 21.366348266601562
Epoch: 1, Steps: 469 | Train Loss: 0.775 Vali Loss: 0.344 Vali Acc: 0.903 Test Loss: 0.344 Test Acc: 0.903
Validation loss decreased (inf --> -0.902512).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1324119
	speed: 0.2741s/iter; left time: 6272.4492s
	iters: 200, epoch: 2 | loss: 0.1592503
	speed: 0.0453s/iter; left time: 1033.1135s
	iters: 300, epoch: 2 | loss: 0.0180682
	speed: 0.0456s/iter; left time: 1034.8273s
	iters: 400, epoch: 2 | loss: 0.2028062
	speed: 0.0458s/iter; left time: 1033.3353s
Epoch: 2 cost time: 21.82606792449951
Epoch: 2, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.902512 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0745370
	speed: 0.2631s/iter; left time: 5896.4628s
	iters: 200, epoch: 3 | loss: 0.0285965
	speed: 0.0398s/iter; left time: 889.1359s
	iters: 300, epoch: 3 | loss: 0.0495861
	speed: 0.0401s/iter; left time: 890.4348s
	iters: 400, epoch: 3 | loss: 0.0207837
	speed: 0.0457s/iter; left time: 1010.4794s
Epoch: 3 cost time: 20.039817810058594
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
Validation loss decreased (-0.957974 --> -0.963406).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0044787
	speed: 0.2863s/iter; left time: 6282.8495s
	iters: 200, epoch: 4 | loss: 0.0021493
	speed: 0.0464s/iter; left time: 1014.3047s
	iters: 300, epoch: 4 | loss: 0.0115881
	speed: 0.0436s/iter; left time: 947.0971s
	iters: 400, epoch: 4 | loss: 0.1024067
	speed: 0.0427s/iter; left time: 925.1213s
Epoch: 4 cost time: 21.316893815994263
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
Validation loss decreased (-0.963406 --> -0.973698).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0098725
	speed: 0.2623s/iter; left time: 5632.4801s
	iters: 200, epoch: 5 | loss: 0.0066310
	speed: 0.0447s/iter; left time: 954.5293s
	iters: 300, epoch: 5 | loss: 0.0073884
	speed: 0.0435s/iter; left time: 926.4377s
	iters: 400, epoch: 5 | loss: 0.0218250
	speed: 0.0434s/iter; left time: 918.4440s
Epoch: 5 cost time: 21.38505744934082
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973698 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0011644
	speed: 0.2820s/iter; left time: 5923.1345s
	iters: 200, epoch: 6 | loss: 0.0008368
	speed: 0.0431s/iter; left time: 900.6001s
	iters: 300, epoch: 6 | loss: 0.0251297
	speed: 0.0402s/iter; left time: 837.2204s
	iters: 400, epoch: 6 | loss: 0.0004225
	speed: 0.0409s/iter; left time: 847.0032s
Epoch: 6 cost time: 19.91996192932129
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0059392
	speed: 0.2751s/iter; left time: 5650.1535s
	iters: 200, epoch: 7 | loss: 0.0227117
	speed: 0.0466s/iter; left time: 951.5816s
	iters: 300, epoch: 7 | loss: 0.0012812
	speed: 0.0454s/iter; left time: 922.6418s
	iters: 400, epoch: 7 | loss: 0.0696399
	speed: 0.0438s/iter; left time: 885.8031s
Epoch: 7 cost time: 21.5525643825531
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0132795
	speed: 0.2559s/iter; left time: 5136.3235s
	iters: 200, epoch: 8 | loss: 0.0002183
	speed: 0.0399s/iter; left time: 797.2689s
	iters: 300, epoch: 8 | loss: 0.0047110
	speed: 0.0420s/iter; left time: 834.1828s
	iters: 400, epoch: 8 | loss: 0.0459931
	speed: 0.0456s/iter; left time: 901.0377s
Epoch: 8 cost time: 20.182444095611572
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0002078
	speed: 0.2850s/iter; left time: 5585.4693s
	iters: 200, epoch: 9 | loss: 0.0705937
	speed: 0.0445s/iter; left time: 868.4226s
	iters: 300, epoch: 9 | loss: 0.0318346
	speed: 0.0419s/iter; left time: 812.8414s
	iters: 400, epoch: 9 | loss: 0.0014333
	speed: 0.0423s/iter; left time: 817.0324s
Epoch: 9 cost time: 20.68307137489319
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0002636
	speed: 0.2580s/iter; left time: 4935.6869s
	iters: 200, epoch: 10 | loss: 0.0027221
	speed: 0.0449s/iter; left time: 854.1448s
	iters: 300, epoch: 10 | loss: 0.0001475
	speed: 0.0436s/iter; left time: 825.3845s
	iters: 400, epoch: 10 | loss: 0.0029254
	speed: 0.0430s/iter; left time: 809.8572s
Epoch: 10 cost time: 21.066856145858765
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.977129).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0007951
	speed: 0.2698s/iter; left time: 5034.2252s
	iters: 200, epoch: 11 | loss: 0.0071935
	speed: 0.0410s/iter; left time: 761.7276s
	iters: 300, epoch: 11 | loss: 0.0017751
	speed: 0.0397s/iter; left time: 733.3418s
	iters: 400, epoch: 11 | loss: 0.0001496
	speed: 0.0402s/iter; left time: 737.5820s
Epoch: 11 cost time: 19.415864944458008
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0222781
	speed: 0.2704s/iter; left time: 4918.4201s
	iters: 200, epoch: 12 | loss: 0.0047807
	speed: 0.0444s/iter; left time: 803.1476s
	iters: 300, epoch: 12 | loss: 0.0092755
	speed: 0.0452s/iter; left time: 813.0113s
	iters: 400, epoch: 12 | loss: 0.0003125
	speed: 0.0457s/iter; left time: 818.4807s
Epoch: 12 cost time: 20.87995409965515
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0028857
	speed: 0.2514s/iter; left time: 4454.7101s
	iters: 200, epoch: 13 | loss: 0.0850860
	speed: 0.0417s/iter; left time: 734.2543s
	iters: 300, epoch: 13 | loss: 0.0000678
	speed: 0.0444s/iter; left time: 777.8408s
	iters: 400, epoch: 13 | loss: 0.0101387
	speed: 0.0454s/iter; left time: 791.7615s
Epoch: 13 cost time: 20.684446573257446
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0005064
	speed: 0.2814s/iter; left time: 4854.6466s
	iters: 200, epoch: 14 | loss: 0.0009594
	speed: 0.0436s/iter; left time: 747.4273s
	iters: 300, epoch: 14 | loss: 0.0002897
	speed: 0.0430s/iter; left time: 733.2948s
	iters: 400, epoch: 14 | loss: 0.0099548
	speed: 0.0419s/iter; left time: 710.8413s
Epoch: 14 cost time: 20.557130098342896
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.968 Test Loss: 0.186 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000368
	speed: 0.2585s/iter; left time: 4339.2030s
	iters: 200, epoch: 15 | loss: 0.0183315
	speed: 0.0458s/iter; left time: 764.6336s
	iters: 300, epoch: 15 | loss: 0.0001753
	speed: 0.0459s/iter; left time: 761.3352s
	iters: 400, epoch: 15 | loss: 0.0132707
	speed: 0.0448s/iter; left time: 738.9792s
Epoch: 15 cost time: 21.628188371658325
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0041194
	speed: 0.2714s/iter; left time: 4428.4130s
	iters: 200, epoch: 16 | loss: 0.0021726
	speed: 0.0416s/iter; left time: 673.8758s
	iters: 300, epoch: 16 | loss: 0.0001071
	speed: 0.0407s/iter; left time: 655.9847s
	iters: 400, epoch: 16 | loss: 0.0003596
	speed: 0.0390s/iter; left time: 624.2505s
Epoch: 16 cost time: 19.39707088470459
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978844).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0182460
	speed: 0.2381s/iter; left time: 3773.2308s
	iters: 200, epoch: 17 | loss: 0.0002030
	speed: 0.0421s/iter; left time: 662.1780s
	iters: 300, epoch: 17 | loss: 0.0024734
	speed: 0.0441s/iter; left time: 690.4365s
	iters: 400, epoch: 17 | loss: 0.0347186
	speed: 0.0442s/iter; left time: 687.8686s
Epoch: 17 cost time: 20.26435685157776
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979702).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0007429
	speed: 0.2685s/iter; left time: 4129.0701s
	iters: 200, epoch: 18 | loss: 0.0116483
	speed: 0.0386s/iter; left time: 590.1960s
	iters: 300, epoch: 18 | loss: 0.0018177
	speed: 0.0400s/iter; left time: 606.9165s
	iters: 400, epoch: 18 | loss: 0.0179992
	speed: 0.0373s/iter; left time: 562.4239s
Epoch: 18 cost time: 18.49854040145874
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0546272
	speed: 0.2384s/iter; left time: 3553.7430s
	iters: 200, epoch: 19 | loss: 0.0001504
	speed: 0.0420s/iter; left time: 622.2111s
	iters: 300, epoch: 19 | loss: 0.0001185
	speed: 0.0419s/iter; left time: 615.8725s
	iters: 400, epoch: 19 | loss: 0.0003405
	speed: 0.0417s/iter; left time: 608.5792s
Epoch: 19 cost time: 19.798569202423096
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981131).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0272665
	speed: 0.2420s/iter; left time: 3494.0034s
	iters: 200, epoch: 20 | loss: 0.0026902
	speed: 0.0393s/iter; left time: 564.0636s
	iters: 300, epoch: 20 | loss: 0.2053471
	speed: 0.0394s/iter; left time: 561.6083s
	iters: 400, epoch: 20 | loss: 0.0155784
	speed: 0.0399s/iter; left time: 564.3574s
Epoch: 20 cost time: 18.90620255470276
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0318580
	speed: 0.2592s/iter; left time: 3621.8242s
	iters: 200, epoch: 21 | loss: 0.0025605
	speed: 0.0422s/iter; left time: 585.0658s
	iters: 300, epoch: 21 | loss: 0.0001371
	speed: 0.0409s/iter; left time: 562.9601s
	iters: 400, epoch: 21 | loss: 0.0005143
	speed: 0.0391s/iter; left time: 534.4727s
Epoch: 21 cost time: 19.496148586273193
Epoch: 21, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0003106
	speed: 0.2431s/iter; left time: 3282.2956s
	iters: 200, epoch: 22 | loss: 0.0299981
	speed: 0.0420s/iter; left time: 563.1076s
	iters: 300, epoch: 22 | loss: 0.0086375
	speed: 0.0408s/iter; left time: 542.1463s
	iters: 400, epoch: 22 | loss: 0.0000847
	speed: 0.0429s/iter; left time: 566.4471s
Epoch: 22 cost time: 20.162142276763916
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.3398055
	speed: 0.2489s/iter; left time: 3243.5201s
	iters: 200, epoch: 23 | loss: 0.0027657
	speed: 0.0385s/iter; left time: 498.5408s
	iters: 300, epoch: 23 | loss: 0.0000526
	speed: 0.0388s/iter; left time: 498.0507s
	iters: 400, epoch: 23 | loss: 0.0000487
	speed: 0.0408s/iter; left time: 519.3419s
Epoch: 23 cost time: 18.873023509979248
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.966 Test Loss: 0.231 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000665
	speed: 0.2572s/iter; left time: 3231.1528s
	iters: 200, epoch: 24 | loss: 0.0013741
	speed: 0.0414s/iter; left time: 516.4929s
	iters: 300, epoch: 24 | loss: 0.0042023
	speed: 0.0423s/iter; left time: 523.1878s
	iters: 400, epoch: 24 | loss: 0.0002718
	speed: 0.0400s/iter; left time: 490.0798s
Epoch: 24 cost time: 19.820409297943115
Epoch: 24, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0135747
	speed: 0.2438s/iter; left time: 2948.5749s
	iters: 200, epoch: 25 | loss: 0.0002798
	speed: 0.0408s/iter; left time: 489.9746s
	iters: 300, epoch: 25 | loss: 0.0014492
	speed: 0.0409s/iter; left time: 485.9861s
	iters: 400, epoch: 25 | loss: 0.0004025
	speed: 0.0419s/iter; left time: 493.8268s
Epoch: 25 cost time: 19.68256425857544
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000076
	speed: 0.2530s/iter; left time: 2941.8923s
	iters: 200, epoch: 26 | loss: 0.0010815
	speed: 0.0392s/iter; left time: 452.0361s
	iters: 300, epoch: 26 | loss: 0.0000092
	speed: 0.0401s/iter; left time: 458.0281s
	iters: 400, epoch: 26 | loss: 0.0000337
	speed: 0.0393s/iter; left time: 444.8618s
Epoch: 26 cost time: 18.975239038467407
Epoch: 26, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000227
	speed: 0.2501s/iter; left time: 2790.6021s
	iters: 200, epoch: 27 | loss: 0.0000975
	speed: 0.0420s/iter; left time: 464.3857s
	iters: 300, epoch: 27 | loss: 0.0000074
	speed: 0.0419s/iter; left time: 458.8710s
	iters: 400, epoch: 27 | loss: 0.3014109
	speed: 0.0405s/iter; left time: 439.7213s
Epoch: 27 cost time: 19.85870099067688
Epoch: 27, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0368597
	speed: 0.2479s/iter; left time: 2649.3536s
	iters: 200, epoch: 28 | loss: 0.0000540
	speed: 0.0388s/iter; left time: 410.6479s
	iters: 300, epoch: 28 | loss: 0.0003368
	speed: 0.0402s/iter; left time: 421.6009s
	iters: 400, epoch: 28 | loss: 0.0000247
	speed: 0.0399s/iter; left time: 414.2343s
Epoch: 28 cost time: 18.990395545959473
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0009083
	speed: 0.2496s/iter; left time: 2550.4002s
	iters: 200, epoch: 29 | loss: 0.0004633
	speed: 0.0401s/iter; left time: 405.2980s
	iters: 300, epoch: 29 | loss: 0.0035792
	speed: 0.0412s/iter; left time: 413.2363s
	iters: 400, epoch: 29 | loss: 0.0141119
	speed: 0.0394s/iter; left time: 391.2139s
Epoch: 29 cost time: 18.961745262145996
Epoch: 29, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.973 Test Loss: 0.187 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 57546
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5127313
	speed: 0.0553s/iter; left time: 1290.7829s
	iters: 200, epoch: 1 | loss: 0.5587221
	speed: 0.0399s/iter; left time: 927.0003s
	iters: 300, epoch: 1 | loss: 0.5169221
	speed: 0.0416s/iter; left time: 963.7255s
	iters: 400, epoch: 1 | loss: 0.2070097
	speed: 0.0412s/iter; left time: 949.9964s
Epoch: 1 cost time: 20.635043621063232
Epoch: 1, Steps: 469 | Train Loss: 0.795 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
Validation loss decreased (inf --> -0.918808).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0790203
	speed: 0.2426s/iter; left time: 5552.2553s
	iters: 200, epoch: 2 | loss: 0.0308534
	speed: 0.0382s/iter; left time: 869.5085s
	iters: 300, epoch: 2 | loss: 0.2136482
	speed: 0.0399s/iter; left time: 906.0241s
	iters: 400, epoch: 2 | loss: 0.1102640
	speed: 0.0395s/iter; left time: 892.2010s
Epoch: 2 cost time: 18.55547547340393
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.918808 --> -0.951971).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0155066
	speed: 0.2483s/iter; left time: 5564.4763s
	iters: 200, epoch: 3 | loss: 0.0450865
	speed: 0.0397s/iter; left time: 884.9217s
	iters: 300, epoch: 3 | loss: 0.0274568
	speed: 0.0380s/iter; left time: 842.9926s
	iters: 400, epoch: 3 | loss: 0.0585984
	speed: 0.0371s/iter; left time: 820.9003s
Epoch: 3 cost time: 18.49341320991516
Epoch: 3, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.966 Test Loss: 0.156 Test Acc: 0.966
Validation loss decreased (-0.951971 --> -0.965693).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0174465
	speed: 0.2433s/iter; left time: 5339.6660s
	iters: 200, epoch: 4 | loss: 0.0029902
	speed: 0.0409s/iter; left time: 893.6337s
	iters: 300, epoch: 4 | loss: 0.0285339
	speed: 0.0411s/iter; left time: 893.9807s
	iters: 400, epoch: 4 | loss: 0.0157367
	speed: 0.0418s/iter; left time: 904.3491s
Epoch: 4 cost time: 19.68518900871277
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
Validation loss decreased (-0.965693 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0004219
	speed: 0.2419s/iter; left time: 5194.7655s
	iters: 200, epoch: 5 | loss: 0.0107262
	speed: 0.0383s/iter; left time: 817.7135s
	iters: 300, epoch: 5 | loss: 0.0125716
	speed: 0.0375s/iter; left time: 797.7626s
	iters: 400, epoch: 5 | loss: 0.0005928
	speed: 0.0388s/iter; left time: 822.6352s
Epoch: 5 cost time: 18.34597873687744
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
Validation loss decreased (-0.971125 --> -0.972268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0007361
	speed: 0.2463s/iter; left time: 5173.6602s
	iters: 200, epoch: 6 | loss: 0.0073337
	speed: 0.0405s/iter; left time: 846.8277s
	iters: 300, epoch: 6 | loss: 0.0004146
	speed: 0.0383s/iter; left time: 796.7269s
	iters: 400, epoch: 6 | loss: 0.0682871
	speed: 0.0389s/iter; left time: 805.8756s
Epoch: 6 cost time: 18.795381784439087
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
Validation loss decreased (-0.972268 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005685
	speed: 0.2366s/iter; left time: 4858.2846s
	iters: 200, epoch: 7 | loss: 0.0004137
	speed: 0.0409s/iter; left time: 836.1115s
	iters: 300, epoch: 7 | loss: 0.0037878
	speed: 0.0410s/iter; left time: 833.4663s
	iters: 400, epoch: 7 | loss: 0.0098172
	speed: 0.0411s/iter; left time: 832.6107s
Epoch: 7 cost time: 19.320772171020508
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0045719
	speed: 0.2472s/iter; left time: 4959.8658s
	iters: 200, epoch: 8 | loss: 0.0021938
	speed: 0.0384s/iter; left time: 767.6491s
	iters: 300, epoch: 8 | loss: 0.0479854
	speed: 0.0386s/iter; left time: 766.4060s
	iters: 400, epoch: 8 | loss: 0.0016410
	speed: 0.0377s/iter; left time: 746.1694s
Epoch: 8 cost time: 18.302577018737793
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.973412 --> -0.976557).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0077817
	speed: 0.2226s/iter; left time: 4362.0313s
	iters: 200, epoch: 9 | loss: 0.0003852
	speed: 0.0351s/iter; left time: 684.7843s
	iters: 300, epoch: 9 | loss: 0.0040124
	speed: 0.0392s/iter; left time: 760.8661s
	iters: 400, epoch: 9 | loss: 0.0011928
	speed: 0.0396s/iter; left time: 763.7885s
Epoch: 9 cost time: 17.945008516311646
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977986).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0012217
	speed: 0.2397s/iter; left time: 4585.7560s
	iters: 200, epoch: 10 | loss: 0.0017998
	speed: 0.0387s/iter; left time: 736.7375s
	iters: 300, epoch: 10 | loss: 0.0160097
	speed: 0.0381s/iter; left time: 722.1229s
	iters: 400, epoch: 10 | loss: 0.0022766
	speed: 0.0366s/iter; left time: 689.5169s
Epoch: 10 cost time: 18.20352029800415
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0003169
	speed: 0.2453s/iter; left time: 4577.2857s
	iters: 200, epoch: 11 | loss: 0.0005345
	speed: 0.0397s/iter; left time: 737.3943s
	iters: 300, epoch: 11 | loss: 0.0007930
	speed: 0.0389s/iter; left time: 717.7631s
	iters: 400, epoch: 11 | loss: 0.0002569
	speed: 0.0390s/iter; left time: 715.3468s
Epoch: 11 cost time: 18.7624728679657
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000566
	speed: 0.2338s/iter; left time: 4253.1157s
	iters: 200, epoch: 12 | loss: 0.0056767
	speed: 0.0399s/iter; left time: 721.2045s
	iters: 300, epoch: 12 | loss: 0.0000253
	speed: 0.0392s/iter; left time: 706.0005s
	iters: 400, epoch: 12 | loss: 0.0142820
	speed: 0.0405s/iter; left time: 724.6669s
Epoch: 12 cost time: 18.859475135803223
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0129034
	speed: 0.2426s/iter; left time: 4298.9997s
	iters: 200, epoch: 13 | loss: 0.0146965
	speed: 0.0386s/iter; left time: 680.0447s
	iters: 300, epoch: 13 | loss: 0.0002028
	speed: 0.0371s/iter; left time: 650.7929s
	iters: 400, epoch: 13 | loss: 0.0002862
	speed: 0.0370s/iter; left time: 644.5809s
Epoch: 13 cost time: 18.10750150680542
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.149 Vali Acc: 0.979 Test Loss: 0.149 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.979129).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0001702
	speed: 0.2472s/iter; left time: 4264.3280s
	iters: 200, epoch: 14 | loss: 0.0142858
	speed: 0.0393s/iter; left time: 674.0440s
	iters: 300, epoch: 14 | loss: 0.0001552
	speed: 0.0398s/iter; left time: 678.8083s
	iters: 400, epoch: 14 | loss: 0.0990392
	speed: 0.0379s/iter; left time: 642.6307s
Epoch: 14 cost time: 18.679028511047363
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.974 Test Loss: 0.211 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0807825
	speed: 0.2399s/iter; left time: 4026.8442s
	iters: 200, epoch: 15 | loss: 0.0001021
	speed: 0.0401s/iter; left time: 669.2154s
	iters: 300, epoch: 15 | loss: 0.0000502
	speed: 0.0394s/iter; left time: 653.3640s
	iters: 400, epoch: 15 | loss: 0.0043478
	speed: 0.0404s/iter; left time: 666.2503s
Epoch: 15 cost time: 18.92677402496338
Epoch: 15, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0073028
	speed: 0.2410s/iter; left time: 3932.7280s
	iters: 200, epoch: 16 | loss: 0.0000159
	speed: 0.0378s/iter; left time: 613.7754s
	iters: 300, epoch: 16 | loss: 0.0000385
	speed: 0.0388s/iter; left time: 625.8109s
	iters: 400, epoch: 16 | loss: 0.0010541
	speed: 0.0374s/iter; left time: 599.3794s
Epoch: 16 cost time: 18.147831916809082
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000180
	speed: 0.2476s/iter; left time: 3923.9817s
	iters: 200, epoch: 17 | loss: 0.0000793
	speed: 0.0389s/iter; left time: 612.2688s
	iters: 300, epoch: 17 | loss: 0.0000207
	speed: 0.0387s/iter; left time: 605.6687s
	iters: 400, epoch: 17 | loss: 0.0105164
	speed: 0.0393s/iter; left time: 610.8071s
Epoch: 17 cost time: 18.612147569656372
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0034605
	speed: 0.2345s/iter; left time: 3606.2210s
	iters: 200, epoch: 18 | loss: 0.0000311
	speed: 0.0395s/iter; left time: 603.3172s
	iters: 300, epoch: 18 | loss: 0.0019613
	speed: 0.0387s/iter; left time: 586.9644s
	iters: 400, epoch: 18 | loss: 0.0000634
	speed: 0.0392s/iter; left time: 590.5273s
Epoch: 18 cost time: 18.792711973190308
Epoch: 18, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0424490
	speed: 0.2352s/iter; left time: 3506.1988s
	iters: 200, epoch: 19 | loss: 0.0001718
	speed: 0.0392s/iter; left time: 581.1611s
	iters: 300, epoch: 19 | loss: 0.0005058
	speed: 0.0389s/iter; left time: 571.9607s
	iters: 400, epoch: 19 | loss: 0.0007081
	speed: 0.0373s/iter; left time: 544.7126s
Epoch: 19 cost time: 18.438663005828857
Epoch: 19, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000262
	speed: 0.2432s/iter; left time: 3512.3410s
	iters: 200, epoch: 20 | loss: 0.0018959
	speed: 0.0387s/iter; left time: 554.9723s
	iters: 300, epoch: 20 | loss: 0.0032657
	speed: 0.0375s/iter; left time: 534.6489s
	iters: 400, epoch: 20 | loss: 0.0002084
	speed: 0.0389s/iter; left time: 549.6291s
Epoch: 20 cost time: 18.33767056465149
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
Validation loss decreased (-0.979129 --> -0.983132).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2043919
	speed: 0.2370s/iter; left time: 3310.8834s
	iters: 200, epoch: 21 | loss: 0.0021540
	speed: 0.0376s/iter; left time: 521.0844s
	iters: 300, epoch: 21 | loss: 0.0002589
	speed: 0.0410s/iter; left time: 564.3235s
	iters: 400, epoch: 21 | loss: 0.0005431
	speed: 0.0368s/iter; left time: 503.1069s
Epoch: 21 cost time: 18.34837245941162
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0017142
	speed: 0.2396s/iter; left time: 3235.5450s
	iters: 200, epoch: 22 | loss: 0.0063809
	speed: 0.0397s/iter; left time: 531.8483s
	iters: 300, epoch: 22 | loss: 0.0003357
	speed: 0.0397s/iter; left time: 527.4769s
	iters: 400, epoch: 22 | loss: 0.0002824
	speed: 0.0396s/iter; left time: 522.1767s
Epoch: 22 cost time: 18.98408794403076
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000619
	speed: 0.2512s/iter; left time: 3274.1669s
	iters: 200, epoch: 23 | loss: 0.0000932
	speed: 0.0386s/iter; left time: 499.2399s
	iters: 300, epoch: 23 | loss: 0.0003296
	speed: 0.0397s/iter; left time: 509.7684s
	iters: 400, epoch: 23 | loss: 0.0748851
	speed: 0.0388s/iter; left time: 494.1967s
Epoch: 23 cost time: 18.658791542053223
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0004431
	speed: 0.2447s/iter; left time: 3074.2643s
	iters: 200, epoch: 24 | loss: 0.0015858
	speed: 0.0410s/iter; left time: 510.9021s
	iters: 300, epoch: 24 | loss: 0.0000690
	speed: 0.0403s/iter; left time: 497.9945s
	iters: 400, epoch: 24 | loss: 0.0000012
	speed: 0.0393s/iter; left time: 481.8788s
Epoch: 24 cost time: 19.268321752548218
Epoch: 24, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.296 Vali Acc: 0.963 Test Loss: 0.296 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0014241
	speed: 0.2405s/iter; left time: 2909.4040s
	iters: 200, epoch: 25 | loss: 0.0000435
	speed: 0.0401s/iter; left time: 481.5360s
	iters: 300, epoch: 25 | loss: 0.1489017
	speed: 0.0389s/iter; left time: 462.9758s
	iters: 400, epoch: 25 | loss: 0.0003788
	speed: 0.0397s/iter; left time: 468.5817s
Epoch: 25 cost time: 18.932190418243408
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0039673
	speed: 0.2491s/iter; left time: 2896.1903s
	iters: 200, epoch: 26 | loss: 0.0000010
	speed: 0.0389s/iter; left time: 448.6575s
	iters: 300, epoch: 26 | loss: 0.0008852
	speed: 0.0384s/iter; left time: 438.7569s
	iters: 400, epoch: 26 | loss: 0.0012903
	speed: 0.0395s/iter; left time: 447.1964s
Epoch: 26 cost time: 18.754709005355835
Epoch: 26, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000017
	speed: 0.2428s/iter; left time: 2708.4428s
	iters: 200, epoch: 27 | loss: 0.0000716
	speed: 0.0406s/iter; left time: 449.2204s
	iters: 300, epoch: 27 | loss: 0.0006995
	speed: 0.0407s/iter; left time: 445.4922s
	iters: 400, epoch: 27 | loss: 0.0007619
	speed: 0.0404s/iter; left time: 438.8207s
Epoch: 27 cost time: 19.438834190368652
Epoch: 27, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0000971
	speed: 0.2387s/iter; left time: 2550.9574s
	iters: 200, epoch: 28 | loss: 0.0352202
	speed: 0.0391s/iter; left time: 414.0163s
	iters: 300, epoch: 28 | loss: 0.0000251
	speed: 0.0388s/iter; left time: 407.3989s
	iters: 400, epoch: 28 | loss: 0.0000031
	speed: 0.0386s/iter; left time: 401.2861s
Epoch: 28 cost time: 18.618677616119385
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000863
	speed: 0.2470s/iter; left time: 2523.6127s
	iters: 200, epoch: 29 | loss: 0.0000097
	speed: 0.0381s/iter; left time: 385.7740s
	iters: 300, epoch: 29 | loss: 0.0009916
	speed: 0.0393s/iter; left time: 393.3907s
	iters: 400, epoch: 29 | loss: 0.0000192
	speed: 0.0386s/iter; left time: 382.6754s
Epoch: 29 cost time: 18.540114879608154
Epoch: 29, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.973 Test Loss: 0.232 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0003690
	speed: 0.2437s/iter; left time: 2376.2904s
	iters: 200, epoch: 30 | loss: 0.0000160
	speed: 0.0405s/iter; left time: 390.4996s
	iters: 300, epoch: 30 | loss: 0.1159743
	speed: 0.0398s/iter; left time: 379.6530s
	iters: 400, epoch: 30 | loss: 0.0000076
	speed: 0.0387s/iter; left time: 365.8671s
Epoch: 30 cost time: 19.08757448196411
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.967 Test Loss: 0.285 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 57578
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3694140
	speed: 0.0768s/iter; left time: 1792.3597s
	iters: 200, epoch: 1 | loss: 0.3287923
	speed: 0.0585s/iter; left time: 1359.7214s
	iters: 300, epoch: 1 | loss: 0.0609194
	speed: 0.0594s/iter; left time: 1374.7115s
	iters: 400, epoch: 1 | loss: 0.0908592
	speed: 0.0611s/iter; left time: 1407.7708s
Epoch: 1 cost time: 29.75554895401001
Epoch: 1, Steps: 469 | Train Loss: 0.400 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (inf --> -0.951685).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0987137
	speed: 0.3635s/iter; left time: 8316.9461s
	iters: 200, epoch: 2 | loss: 0.0352291
	speed: 0.0609s/iter; left time: 1386.9509s
	iters: 300, epoch: 2 | loss: 0.0020588
	speed: 0.0600s/iter; left time: 1360.8389s
	iters: 400, epoch: 2 | loss: 0.0004501
	speed: 0.0601s/iter; left time: 1357.0269s
Epoch: 2 cost time: 28.965801000595093
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.951685 --> -0.969981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1268041
	speed: 0.3364s/iter; left time: 7538.6387s
	iters: 200, epoch: 3 | loss: 0.0233101
	speed: 0.0597s/iter; left time: 1332.0286s
	iters: 300, epoch: 3 | loss: 0.0159265
	speed: 0.0522s/iter; left time: 1160.2123s
	iters: 400, epoch: 3 | loss: 0.0081174
	speed: 0.0509s/iter; left time: 1125.0487s
Epoch: 3 cost time: 25.976531982421875
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
Validation loss decreased (-0.969981 --> -0.971983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.9475842
	speed: 0.3502s/iter; left time: 7684.7428s
	iters: 200, epoch: 4 | loss: 0.0020778
	speed: 0.0553s/iter; left time: 1207.9434s
	iters: 300, epoch: 4 | loss: 0.0020725
	speed: 0.0552s/iter; left time: 1199.4759s
	iters: 400, epoch: 4 | loss: 0.0007473
	speed: 0.0557s/iter; left time: 1204.7984s
Epoch: 4 cost time: 26.750736236572266
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000617
	speed: 0.3514s/iter; left time: 7547.2640s
	iters: 200, epoch: 5 | loss: 0.0002621
	speed: 0.0571s/iter; left time: 1219.5563s
	iters: 300, epoch: 5 | loss: 0.0010666
	speed: 0.0546s/iter; left time: 1162.0139s
	iters: 400, epoch: 5 | loss: 0.0314791
	speed: 0.0529s/iter; left time: 1120.3825s
Epoch: 5 cost time: 26.4972927570343
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.261 Vali Acc: 0.960 Test Loss: 0.261 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000270
	speed: 0.3578s/iter; left time: 7515.4396s
	iters: 200, epoch: 6 | loss: 0.0267717
	speed: 0.0614s/iter; left time: 1284.5747s
	iters: 300, epoch: 6 | loss: 0.0019162
	speed: 0.0581s/iter; left time: 1208.4401s
	iters: 400, epoch: 6 | loss: 0.0010765
	speed: 0.0582s/iter; left time: 1205.7131s
Epoch: 6 cost time: 28.119091987609863
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.278 Vali Acc: 0.962 Test Loss: 0.278 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0090453
	speed: 0.3531s/iter; left time: 7251.2774s
	iters: 200, epoch: 7 | loss: 0.0003860
	speed: 0.0614s/iter; left time: 1255.5301s
	iters: 300, epoch: 7 | loss: 0.0025583
	speed: 0.0592s/iter; left time: 1204.0176s
	iters: 400, epoch: 7 | loss: 0.0000122
	speed: 0.0576s/iter; left time: 1165.2976s
Epoch: 7 cost time: 28.224810123443604
Epoch: 7, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0034878
	speed: 0.3557s/iter; left time: 7137.2953s
	iters: 200, epoch: 8 | loss: 0.0002318
	speed: 0.0626s/iter; left time: 1249.8292s
	iters: 300, epoch: 8 | loss: 0.0000932
	speed: 0.0626s/iter; left time: 1243.6738s
	iters: 400, epoch: 8 | loss: 0.1333334
	speed: 0.0582s/iter; left time: 1150.4621s
Epoch: 8 cost time: 28.815381288528442
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0006321
	speed: 0.3584s/iter; left time: 7023.6694s
	iters: 200, epoch: 9 | loss: 0.0002432
	speed: 0.0618s/iter; left time: 1205.6954s
	iters: 300, epoch: 9 | loss: 0.0044386
	speed: 0.0628s/iter; left time: 1217.9148s
	iters: 400, epoch: 9 | loss: 0.0052860
	speed: 0.0611s/iter; left time: 1179.5712s
Epoch: 9 cost time: 29.026662349700928
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.325 Vali Acc: 0.956 Test Loss: 0.325 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0986016
	speed: 0.3569s/iter; left time: 6827.2722s
	iters: 200, epoch: 10 | loss: 0.0000038
	speed: 0.0626s/iter; left time: 1191.0643s
	iters: 300, epoch: 10 | loss: 0.0000112
	speed: 0.0629s/iter; left time: 1190.4130s
	iters: 400, epoch: 10 | loss: 0.0000112
	speed: 0.0613s/iter; left time: 1154.2737s
Epoch: 10 cost time: 29.056321144104004
Epoch: 10, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.351 Vali Acc: 0.941 Test Loss: 0.351 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000184
	speed: 0.3537s/iter; left time: 6599.8095s
	iters: 200, epoch: 11 | loss: 0.0000052
	speed: 0.0624s/iter; left time: 1158.7495s
	iters: 300, epoch: 11 | loss: 0.0081220
	speed: 0.0621s/iter; left time: 1147.1485s
	iters: 400, epoch: 11 | loss: 0.0000068
	speed: 0.0614s/iter; left time: 1127.4280s
Epoch: 11 cost time: 29.133992910385132
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.200 Vali Acc: 0.968 Test Loss: 0.200 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000336
	speed: 0.3433s/iter; left time: 6244.7576s
	iters: 200, epoch: 12 | loss: 0.0010113
	speed: 0.0610s/iter; left time: 1103.9298s
	iters: 300, epoch: 12 | loss: 0.0002720
	speed: 0.0614s/iter; left time: 1103.8946s
	iters: 400, epoch: 12 | loss: 0.0000086
	speed: 0.0602s/iter; left time: 1076.7414s
Epoch: 12 cost time: 28.74187970161438
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.969 Test Loss: 0.209 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0362265
	speed: 0.3444s/iter; left time: 6104.5477s
	iters: 200, epoch: 13 | loss: 0.0004815
	speed: 0.0607s/iter; left time: 1069.3656s
	iters: 300, epoch: 13 | loss: 0.0000736
	speed: 0.0611s/iter; left time: 1070.0578s
	iters: 400, epoch: 13 | loss: 0.0003525
	speed: 0.0586s/iter; left time: 1020.8346s
Epoch: 13 cost time: 28.263020753860474
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 767754
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3380187
	speed: 0.0741s/iter; left time: 1729.4823s
	iters: 200, epoch: 1 | loss: 0.2491491
	speed: 0.0603s/iter; left time: 1402.3601s
	iters: 300, epoch: 1 | loss: 0.4576637
	speed: 0.0566s/iter; left time: 1309.2783s
	iters: 400, epoch: 1 | loss: 0.1492667
	speed: 0.0517s/iter; left time: 1190.8247s
Epoch: 1 cost time: 27.956140995025635
Epoch: 1, Steps: 469 | Train Loss: 0.404 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (inf --> -0.961405).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0658692
	speed: 0.3541s/iter; left time: 8102.5416s
	iters: 200, epoch: 2 | loss: 0.0548426
	speed: 0.0611s/iter; left time: 1392.7568s
	iters: 300, epoch: 2 | loss: 0.0096595
	speed: 0.0587s/iter; left time: 1331.5697s
	iters: 400, epoch: 2 | loss: 0.0074487
	speed: 0.0569s/iter; left time: 1284.7641s
Epoch: 2 cost time: 27.9676673412323
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0238450
	speed: 0.3548s/iter; left time: 7952.2497s
	iters: 200, epoch: 3 | loss: 0.0729707
	speed: 0.0619s/iter; left time: 1380.6540s
	iters: 300, epoch: 3 | loss: 0.0030398
	speed: 0.0596s/iter; left time: 1324.4620s
	iters: 400, epoch: 3 | loss: 0.0034708
	speed: 0.0570s/iter; left time: 1259.7249s
Epoch: 3 cost time: 27.918229818344116
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.961405 --> -0.971125).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0044384
	speed: 0.3434s/iter; left time: 7534.4827s
	iters: 200, epoch: 4 | loss: 0.0006612
	speed: 0.0603s/iter; left time: 1317.6116s
	iters: 300, epoch: 4 | loss: 0.0013952
	speed: 0.0602s/iter; left time: 1308.4005s
	iters: 400, epoch: 4 | loss: 0.0075536
	speed: 0.0565s/iter; left time: 1223.1503s
Epoch: 4 cost time: 27.829041957855225
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001337
	speed: 0.3425s/iter; left time: 7354.5661s
	iters: 200, epoch: 5 | loss: 0.0003794
	speed: 0.0596s/iter; left time: 1272.9946s
	iters: 300, epoch: 5 | loss: 0.0002007
	speed: 0.0602s/iter; left time: 1281.4570s
	iters: 400, epoch: 5 | loss: 0.0988393
	speed: 0.0585s/iter; left time: 1239.7770s
Epoch: 5 cost time: 27.938045978546143
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.967 Test Loss: 0.252 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000415
	speed: 0.3259s/iter; left time: 6845.1220s
	iters: 200, epoch: 6 | loss: 0.0299386
	speed: 0.0502s/iter; left time: 1050.2230s
	iters: 300, epoch: 6 | loss: 0.0040363
	speed: 0.0514s/iter; left time: 1069.8702s
	iters: 400, epoch: 6 | loss: 0.0000526
	speed: 0.0567s/iter; left time: 1173.6115s
Epoch: 6 cost time: 25.81142520904541
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
Validation loss decreased (-0.971125 --> -0.976271).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0007201
	speed: 0.3519s/iter; left time: 7227.7252s
	iters: 200, epoch: 7 | loss: 0.0000900
	speed: 0.0548s/iter; left time: 1119.9047s
	iters: 300, epoch: 7 | loss: 0.0001513
	speed: 0.0553s/iter; left time: 1123.9648s
	iters: 400, epoch: 7 | loss: 0.0025144
	speed: 0.0575s/iter; left time: 1163.3071s
Epoch: 7 cost time: 26.979824542999268
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.361 Vali Acc: 0.957 Test Loss: 0.361 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0005145
	speed: 0.3522s/iter; left time: 7068.4317s
	iters: 200, epoch: 8 | loss: 0.0010773
	speed: 0.0547s/iter; left time: 1093.0452s
	iters: 300, epoch: 8 | loss: 0.0000010
	speed: 0.0550s/iter; left time: 1092.0268s
	iters: 400, epoch: 8 | loss: 0.0137899
	speed: 0.0547s/iter; left time: 1081.0176s
Epoch: 8 cost time: 26.51140308380127
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.193 Vali Acc: 0.977 Test Loss: 0.193 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977128).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0046374
	speed: 0.3594s/iter; left time: 7044.1794s
	iters: 200, epoch: 9 | loss: 0.0595601
	speed: 0.0564s/iter; left time: 1100.1513s
	iters: 300, epoch: 9 | loss: 0.0003745
	speed: 0.0577s/iter; left time: 1119.5851s
	iters: 400, epoch: 9 | loss: 0.0000048
	speed: 0.0531s/iter; left time: 1024.3983s
Epoch: 9 cost time: 26.489371061325073
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002841
	speed: 0.3524s/iter; left time: 6741.8400s
	iters: 200, epoch: 10 | loss: 0.0000152
	speed: 0.0561s/iter; left time: 1067.2695s
	iters: 300, epoch: 10 | loss: 0.0003003
	speed: 0.0556s/iter; left time: 1052.7649s
	iters: 400, epoch: 10 | loss: 0.0000063
	speed: 0.0553s/iter; left time: 1041.2394s
Epoch: 10 cost time: 26.151002883911133
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.216 Vali Acc: 0.972 Test Loss: 0.216 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0010378
	speed: 0.3548s/iter; left time: 6620.0940s
	iters: 200, epoch: 11 | loss: 0.0019752
	speed: 0.0557s/iter; left time: 1033.0713s
	iters: 300, epoch: 11 | loss: 0.0001223
	speed: 0.0553s/iter; left time: 1021.7573s
	iters: 400, epoch: 11 | loss: 0.0000737
	speed: 0.0553s/iter; left time: 1014.9290s
Epoch: 11 cost time: 26.43764615058899
Epoch: 11, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
Validation loss decreased (-0.977128 --> -0.977700).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000155
	speed: 0.3570s/iter; left time: 6494.5968s
	iters: 200, epoch: 12 | loss: 0.0000006
	speed: 0.0558s/iter; left time: 1010.0950s
	iters: 300, epoch: 12 | loss: 0.0000988
	speed: 0.0566s/iter; left time: 1018.8954s
	iters: 400, epoch: 12 | loss: 0.0038695
	speed: 0.0544s/iter; left time: 972.5554s
Epoch: 12 cost time: 26.747197151184082
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0008576
	speed: 0.3567s/iter; left time: 6322.1112s
	iters: 200, epoch: 13 | loss: 0.0000005
	speed: 0.0554s/iter; left time: 975.9972s
	iters: 300, epoch: 13 | loss: 0.0287985
	speed: 0.0559s/iter; left time: 979.3411s
	iters: 400, epoch: 13 | loss: 0.0000094
	speed: 0.0532s/iter; left time: 926.5073s
Epoch: 13 cost time: 26.32336401939392
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0012085
	speed: 0.3521s/iter; left time: 6075.6530s
	iters: 200, epoch: 14 | loss: 0.0170864
	speed: 0.0558s/iter; left time: 956.4214s
	iters: 300, epoch: 14 | loss: 0.0001118
	speed: 0.0533s/iter; left time: 909.5541s
	iters: 400, epoch: 14 | loss: 0.0000134
	speed: 0.0483s/iter; left time: 818.4572s
Epoch: 14 cost time: 25.440454244613647
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.201 Vali Acc: 0.974 Test Loss: 0.201 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000187
	speed: 0.3500s/iter; left time: 5874.7044s
	iters: 200, epoch: 15 | loss: 0.0000195
	speed: 0.0583s/iter; left time: 972.9501s
	iters: 300, epoch: 15 | loss: 0.0000239
	speed: 0.0514s/iter; left time: 853.0940s
	iters: 400, epoch: 15 | loss: 0.0056037
	speed: 0.0530s/iter; left time: 873.3311s
Epoch: 15 cost time: 26.33832573890686
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.255 Vali Acc: 0.977 Test Loss: 0.255 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000364
	speed: 0.3521s/iter; left time: 5744.6621s
	iters: 200, epoch: 16 | loss: 0.0001622
	speed: 0.0606s/iter; left time: 983.2429s
	iters: 300, epoch: 16 | loss: 0.0003611
	speed: 0.0540s/iter; left time: 870.5204s
	iters: 400, epoch: 16 | loss: 0.0007268
	speed: 0.0536s/iter; left time: 858.9548s
Epoch: 16 cost time: 26.926271677017212
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.321 Vali Acc: 0.971 Test Loss: 0.321 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.3523s/iter; left time: 5583.0277s
	iters: 200, epoch: 17 | loss: 0.0001653
	speed: 0.0591s/iter; left time: 930.0367s
	iters: 300, epoch: 17 | loss: 0.0006379
	speed: 0.0557s/iter; left time: 871.1513s
	iters: 400, epoch: 17 | loss: 0.0152578
	speed: 0.0496s/iter; left time: 771.8536s
Epoch: 17 cost time: 26.685117959976196
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.277 Vali Acc: 0.969 Test Loss: 0.277 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000569
	speed: 0.3573s/iter; left time: 5494.6226s
	iters: 200, epoch: 18 | loss: 0.0000504
	speed: 0.0600s/iter; left time: 916.6057s
	iters: 300, epoch: 18 | loss: 0.0000004
	speed: 0.0584s/iter; left time: 885.8634s
	iters: 400, epoch: 18 | loss: 0.0000009
	speed: 0.0550s/iter; left time: 829.9937s
Epoch: 18 cost time: 27.72036075592041
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.248 Vali Acc: 0.971 Test Loss: 0.248 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000005
	speed: 0.3497s/iter; left time: 5213.7708s
	iters: 200, epoch: 19 | loss: 0.0001912
	speed: 0.0593s/iter; left time: 877.4504s
	iters: 300, epoch: 19 | loss: 0.0024329
	speed: 0.0589s/iter; left time: 866.8212s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.0568s/iter; left time: 829.4991s
Epoch: 19 cost time: 27.2528817653656
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.336 Vali Acc: 0.973 Test Loss: 0.336 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.3343s/iter; left time: 4827.3888s
	iters: 200, epoch: 20 | loss: 0.0000151
	speed: 0.0603s/iter; left time: 864.2360s
	iters: 300, epoch: 20 | loss: 0.0000002
	speed: 0.0600s/iter; left time: 854.7505s
	iters: 400, epoch: 20 | loss: 0.0004158
	speed: 0.0595s/iter; left time: 840.9000s
Epoch: 20 cost time: 28.00251865386963
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.464 Vali Acc: 0.964 Test Loss: 0.464 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000506
	speed: 0.3329s/iter; left time: 4651.5095s
	iters: 200, epoch: 21 | loss: 0.0003230
	speed: 0.0481s/iter; left time: 666.7684s
	iters: 300, epoch: 21 | loss: 1.0631764
	speed: 0.0512s/iter; left time: 704.8713s
	iters: 400, epoch: 21 | loss: 0.0000507
	speed: 0.0555s/iter; left time: 759.3481s
Epoch: 21 cost time: 25.389743328094482
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.340 Vali Acc: 0.966 Test Loss: 0.340 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 767882
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6566430
	speed: 0.0621s/iter; left time: 1449.2570s
	iters: 200, epoch: 1 | loss: 0.1913421
	speed: 0.0479s/iter; left time: 1113.4851s
	iters: 300, epoch: 1 | loss: 0.1318132
	speed: 0.0492s/iter; left time: 1140.0715s
	iters: 400, epoch: 1 | loss: 0.4306255
	speed: 0.0490s/iter; left time: 1130.1114s
Epoch: 1 cost time: 24.267761945724487
Epoch: 1, Steps: 469 | Train Loss: 0.554 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
Validation loss decreased (inf --> -0.935104).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3092710
	speed: 0.2849s/iter; left time: 6518.4258s
	iters: 200, epoch: 2 | loss: 0.0831673
	speed: 0.0447s/iter; left time: 1019.0371s
	iters: 300, epoch: 2 | loss: 0.0479566
	speed: 0.0407s/iter; left time: 922.5336s
	iters: 400, epoch: 2 | loss: 0.0301124
	speed: 0.0385s/iter; left time: 869.9639s
Epoch: 2 cost time: 19.996436595916748
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.935104 --> -0.971125).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1426973
	speed: 0.2617s/iter; left time: 5864.9408s
	iters: 200, epoch: 3 | loss: 0.0370682
	speed: 0.0443s/iter; left time: 987.5308s
	iters: 300, epoch: 3 | loss: 0.0004609
	speed: 0.0451s/iter; left time: 1001.9781s
	iters: 400, epoch: 3 | loss: 0.0376410
	speed: 0.0466s/iter; left time: 1030.7998s
Epoch: 3 cost time: 22.008219718933105
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0739413
	speed: 0.3013s/iter; left time: 6611.1746s
	iters: 200, epoch: 4 | loss: 0.3573237
	speed: 0.0471s/iter; left time: 1029.6618s
	iters: 300, epoch: 4 | loss: 0.0033556
	speed: 0.0439s/iter; left time: 954.1865s
	iters: 400, epoch: 4 | loss: 0.0021912
	speed: 0.0429s/iter; left time: 929.0956s
Epoch: 4 cost time: 21.32455611228943
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0014559
	speed: 0.2920s/iter; left time: 6271.2475s
	iters: 200, epoch: 5 | loss: 0.0700928
	speed: 0.0489s/iter; left time: 1045.5104s
	iters: 300, epoch: 5 | loss: 0.0008416
	speed: 0.0455s/iter; left time: 968.9372s
	iters: 400, epoch: 5 | loss: 0.0096231
	speed: 0.0435s/iter; left time: 921.4399s
Epoch: 5 cost time: 22.012048721313477
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0014897
	speed: 0.2826s/iter; left time: 5936.8329s
	iters: 200, epoch: 6 | loss: 0.0010994
	speed: 0.0487s/iter; left time: 1017.7334s
	iters: 300, epoch: 6 | loss: 0.0022480
	speed: 0.0487s/iter; left time: 1013.8183s
	iters: 400, epoch: 6 | loss: 0.0014887
	speed: 0.0482s/iter; left time: 998.2915s
Epoch: 6 cost time: 22.7171893119812
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.971125 --> -0.975413).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0370877
	speed: 0.2753s/iter; left time: 5653.2970s
	iters: 200, epoch: 7 | loss: 0.0002398
	speed: 0.0477s/iter; left time: 975.5702s
	iters: 300, epoch: 7 | loss: 0.0011720
	speed: 0.0467s/iter; left time: 949.3140s
	iters: 400, epoch: 7 | loss: 0.1311737
	speed: 0.0495s/iter; left time: 1001.7167s
Epoch: 7 cost time: 22.928388118743896
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.955 Test Loss: 0.226 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0003708
	speed: 0.2732s/iter; left time: 5482.5559s
	iters: 200, epoch: 8 | loss: 0.0013761
	speed: 0.0458s/iter; left time: 915.1601s
	iters: 300, epoch: 8 | loss: 0.0010727
	speed: 0.0481s/iter; left time: 954.7583s
	iters: 400, epoch: 8 | loss: 0.0000176
	speed: 0.0482s/iter; left time: 953.3390s
Epoch: 8 cost time: 22.42754030227661
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.968 Test Loss: 0.208 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001174
	speed: 0.2748s/iter; left time: 5386.2755s
	iters: 200, epoch: 9 | loss: 0.0004975
	speed: 0.0459s/iter; left time: 894.5924s
	iters: 300, epoch: 9 | loss: 0.1892180
	speed: 0.0463s/iter; left time: 898.9292s
	iters: 400, epoch: 9 | loss: 0.3418425
	speed: 0.0471s/iter; left time: 909.5589s
Epoch: 9 cost time: 22.086409091949463
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0222996
	speed: 0.2840s/iter; left time: 5433.2269s
	iters: 200, epoch: 10 | loss: 0.0013688
	speed: 0.0474s/iter; left time: 901.7021s
	iters: 300, epoch: 10 | loss: 0.0194165
	speed: 0.0463s/iter; left time: 876.0196s
	iters: 400, epoch: 10 | loss: 0.0000019
	speed: 0.0455s/iter; left time: 856.4493s
Epoch: 10 cost time: 21.967622756958008
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000380
	speed: 0.2867s/iter; left time: 5350.9906s
	iters: 200, epoch: 11 | loss: 0.0002842
	speed: 0.0464s/iter; left time: 861.6066s
	iters: 300, epoch: 11 | loss: 0.0038926
	speed: 0.0466s/iter; left time: 861.1421s
	iters: 400, epoch: 11 | loss: 0.0058208
	speed: 0.0460s/iter; left time: 844.2262s
Epoch: 11 cost time: 22.101332664489746
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0146856
	speed: 0.2884s/iter; left time: 5247.0286s
	iters: 200, epoch: 12 | loss: 0.0846387
	speed: 0.0463s/iter; left time: 838.5227s
	iters: 300, epoch: 12 | loss: 0.0009063
	speed: 0.0471s/iter; left time: 846.7599s
	iters: 400, epoch: 12 | loss: 0.2127001
	speed: 0.0461s/iter; left time: 824.2703s
Epoch: 12 cost time: 22.28298044204712
Epoch: 12, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1739070
	speed: 0.2831s/iter; left time: 5017.1055s
	iters: 200, epoch: 13 | loss: 0.0001510
	speed: 0.0471s/iter; left time: 830.8045s
	iters: 300, epoch: 13 | loss: 0.0011850
	speed: 0.0464s/iter; left time: 812.4462s
	iters: 400, epoch: 13 | loss: 0.0277868
	speed: 0.0474s/iter; left time: 825.5390s
Epoch: 13 cost time: 22.652780532836914
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0006486
	speed: 0.2834s/iter; left time: 4889.8042s
	iters: 200, epoch: 14 | loss: 0.0115743
	speed: 0.0482s/iter; left time: 827.2357s
	iters: 300, epoch: 14 | loss: 0.0008436
	speed: 0.0465s/iter; left time: 792.2782s
	iters: 400, epoch: 14 | loss: 0.0595393
	speed: 0.0463s/iter; left time: 784.4171s
Epoch: 14 cost time: 22.116987943649292
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000165
	speed: 0.2788s/iter; left time: 4680.0703s
	iters: 200, epoch: 15 | loss: 0.2183867
	speed: 0.0447s/iter; left time: 745.7444s
	iters: 300, epoch: 15 | loss: 0.0000037
	speed: 0.0436s/iter; left time: 722.4594s
	iters: 400, epoch: 15 | loss: 0.0455898
	speed: 0.0460s/iter; left time: 757.5555s
Epoch: 15 cost time: 21.12448811531067
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000242
	speed: 0.2837s/iter; left time: 4628.5241s
	iters: 200, epoch: 16 | loss: 0.0000604
	speed: 0.0457s/iter; left time: 740.9628s
	iters: 300, epoch: 16 | loss: 0.0091587
	speed: 0.0449s/iter; left time: 723.4955s
	iters: 400, epoch: 16 | loss: 0.0000844
	speed: 0.0439s/iter; left time: 702.7279s
Epoch: 16 cost time: 21.32585597038269
Epoch: 16, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.966 Test Loss: 0.210 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 203658
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5468996
	speed: 0.0610s/iter; left time: 1424.7514s
	iters: 200, epoch: 1 | loss: 0.1969083
	speed: 0.0465s/iter; left time: 1081.1365s
	iters: 300, epoch: 1 | loss: 0.2809458
	speed: 0.0478s/iter; left time: 1105.7761s
	iters: 400, epoch: 1 | loss: 0.0304939
	speed: 0.0467s/iter; left time: 1075.5822s
Epoch: 1 cost time: 23.40595030784607
Epoch: 1, Steps: 469 | Train Loss: 0.563 Vali Loss: 0.272 Vali Acc: 0.927 Test Loss: 0.272 Test Acc: 0.927
Validation loss decreased (inf --> -0.926527).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0331476
	speed: 0.2816s/iter; left time: 6442.8396s
	iters: 200, epoch: 2 | loss: 0.0420768
	speed: 0.0481s/iter; left time: 1095.7363s
	iters: 300, epoch: 2 | loss: 0.0067459
	speed: 0.0475s/iter; left time: 1077.3585s
	iters: 400, epoch: 2 | loss: 0.0007524
	speed: 0.0473s/iter; left time: 1067.9679s
Epoch: 2 cost time: 22.6414852142334
Epoch: 2, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
Validation loss decreased (-0.926527 --> -0.962262).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0029090
	speed: 0.2796s/iter; left time: 6266.9680s
	iters: 200, epoch: 3 | loss: 0.0129500
	speed: 0.0452s/iter; left time: 1008.5713s
	iters: 300, epoch: 3 | loss: 0.0344547
	speed: 0.0476s/iter; left time: 1056.9200s
	iters: 400, epoch: 3 | loss: 0.2254465
	speed: 0.0461s/iter; left time: 1018.4367s
Epoch: 3 cost time: 21.93011713027954
Epoch: 3, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.962262 --> -0.969696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0145763
	speed: 0.2903s/iter; left time: 6371.4373s
	iters: 200, epoch: 4 | loss: 0.0112115
	speed: 0.0454s/iter; left time: 992.7786s
	iters: 300, epoch: 4 | loss: 0.1260604
	speed: 0.0447s/iter; left time: 971.4876s
	iters: 400, epoch: 4 | loss: 0.0009752
	speed: 0.0452s/iter; left time: 978.0819s
Epoch: 4 cost time: 21.654698371887207
Epoch: 4, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
Validation loss decreased (-0.969696 --> -0.974270).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0151367
	speed: 0.2756s/iter; left time: 5917.6757s
	iters: 200, epoch: 5 | loss: 0.0011838
	speed: 0.0470s/iter; left time: 1004.0525s
	iters: 300, epoch: 5 | loss: 0.0001467
	speed: 0.0445s/iter; left time: 946.6768s
	iters: 400, epoch: 5 | loss: 0.0057270
	speed: 0.0443s/iter; left time: 939.1041s
Epoch: 5 cost time: 21.034629106521606
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.247 Vali Acc: 0.957 Test Loss: 0.247 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0020997
	speed: 0.2742s/iter; left time: 5760.3180s
	iters: 200, epoch: 6 | loss: 0.0007658
	speed: 0.0460s/iter; left time: 961.5275s
	iters: 300, epoch: 6 | loss: 0.0192952
	speed: 0.0465s/iter; left time: 967.1468s
	iters: 400, epoch: 6 | loss: 0.0113428
	speed: 0.0477s/iter; left time: 986.9914s
Epoch: 6 cost time: 22.03603959083557
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0497411
	speed: 0.2723s/iter; left time: 5591.4099s
	iters: 200, epoch: 7 | loss: 0.0037215
	speed: 0.0395s/iter; left time: 807.5844s
	iters: 300, epoch: 7 | loss: 0.0006110
	speed: 0.0451s/iter; left time: 916.2406s
	iters: 400, epoch: 7 | loss: 0.0000798
	speed: 0.0482s/iter; left time: 975.9312s
Epoch: 7 cost time: 21.733640670776367
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975413).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003342
	speed: 0.2831s/iter; left time: 5681.9497s
	iters: 200, epoch: 8 | loss: 0.0015058
	speed: 0.0438s/iter; left time: 873.9419s
	iters: 300, epoch: 8 | loss: 0.0001920
	speed: 0.0455s/iter; left time: 904.3099s
	iters: 400, epoch: 8 | loss: 0.0001847
	speed: 0.0465s/iter; left time: 919.4010s
Epoch: 8 cost time: 21.73297619819641
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.966 Test Loss: 0.213 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0013410
	speed: 0.2924s/iter; left time: 5729.7975s
	iters: 200, epoch: 9 | loss: 0.0014268
	speed: 0.0443s/iter; left time: 864.6126s
	iters: 300, epoch: 9 | loss: 0.0030670
	speed: 0.0428s/iter; left time: 830.0758s
	iters: 400, epoch: 9 | loss: 0.1917483
	speed: 0.0423s/iter; left time: 817.2942s
Epoch: 9 cost time: 20.73336625099182
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.966 Test Loss: 0.194 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0063317
	speed: 0.2890s/iter; left time: 5527.6512s
	iters: 200, epoch: 10 | loss: 0.0004738
	speed: 0.0488s/iter; left time: 927.8692s
	iters: 300, epoch: 10 | loss: 0.0000115
	speed: 0.0463s/iter; left time: 876.4188s
	iters: 400, epoch: 10 | loss: 0.0018061
	speed: 0.0435s/iter; left time: 818.4910s
Epoch: 10 cost time: 21.88606572151184
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.968 Test Loss: 0.200 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0465696
	speed: 0.2806s/iter; left time: 5236.1931s
	iters: 200, epoch: 11 | loss: 0.0000351
	speed: 0.0489s/iter; left time: 908.0587s
	iters: 300, epoch: 11 | loss: 0.0001336
	speed: 0.0490s/iter; left time: 904.5011s
	iters: 400, epoch: 11 | loss: 0.0013576
	speed: 0.0486s/iter; left time: 892.9238s
Epoch: 11 cost time: 23.31670832633972
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.263 Vali Acc: 0.968 Test Loss: 0.263 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000009
	speed: 0.2689s/iter; left time: 4891.1718s
	iters: 200, epoch: 12 | loss: 0.2600552
	speed: 0.0474s/iter; left time: 858.1056s
	iters: 300, epoch: 12 | loss: 0.0001236
	speed: 0.0465s/iter; left time: 837.4040s
	iters: 400, epoch: 12 | loss: 0.0031267
	speed: 0.0473s/iter; left time: 846.2837s
Epoch: 12 cost time: 22.40871500968933
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.234 Vali Acc: 0.973 Test Loss: 0.234 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000118
	speed: 0.2717s/iter; left time: 4814.7790s
	iters: 200, epoch: 13 | loss: 0.0001283
	speed: 0.0439s/iter; left time: 773.7991s
	iters: 300, epoch: 13 | loss: 0.0004906
	speed: 0.0442s/iter; left time: 775.2233s
	iters: 400, epoch: 13 | loss: 0.0001432
	speed: 0.0469s/iter; left time: 817.4514s
Epoch: 13 cost time: 21.386768102645874
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.977128).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000220
	speed: 0.2802s/iter; left time: 4835.0610s
	iters: 200, epoch: 14 | loss: 0.0000387
	speed: 0.0366s/iter; left time: 627.7987s
	iters: 300, epoch: 14 | loss: 0.0000224
	speed: 0.0437s/iter; left time: 744.9267s
	iters: 400, epoch: 14 | loss: 0.0000045
	speed: 0.0442s/iter; left time: 748.8056s
Epoch: 14 cost time: 20.39002823829651
Epoch: 14, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.309 Vali Acc: 0.962 Test Loss: 0.309 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0124810
	speed: 0.2871s/iter; left time: 4819.4247s
	iters: 200, epoch: 15 | loss: 0.0000748
	speed: 0.0477s/iter; left time: 796.1391s
	iters: 300, epoch: 15 | loss: 0.0021063
	speed: 0.0483s/iter; left time: 800.3197s
	iters: 400, epoch: 15 | loss: 0.0001705
	speed: 0.0438s/iter; left time: 721.8309s
Epoch: 15 cost time: 22.13942575454712
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.971 Test Loss: 0.215 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000024
	speed: 0.2797s/iter; left time: 4564.0415s
	iters: 200, epoch: 16 | loss: 0.0025877
	speed: 0.0463s/iter; left time: 750.2279s
	iters: 300, epoch: 16 | loss: 0.0018772
	speed: 0.0476s/iter; left time: 766.5054s
	iters: 400, epoch: 16 | loss: 0.0004850
	speed: 0.0483s/iter; left time: 773.2745s
Epoch: 16 cost time: 22.603457927703857
Epoch: 16, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000282
	speed: 0.2734s/iter; left time: 4333.2056s
	iters: 200, epoch: 17 | loss: 0.0000285
	speed: 0.0464s/iter; left time: 731.2520s
	iters: 300, epoch: 17 | loss: 0.0002570
	speed: 0.0461s/iter; left time: 721.7411s
	iters: 400, epoch: 17 | loss: 0.0000310
	speed: 0.0473s/iter; left time: 735.6792s
Epoch: 17 cost time: 22.167420625686646
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.231 Vali Acc: 0.971 Test Loss: 0.231 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000004
	speed: 0.2872s/iter; left time: 4417.1571s
	iters: 200, epoch: 18 | loss: 0.0200017
	speed: 0.0439s/iter; left time: 671.4286s
	iters: 300, epoch: 18 | loss: 0.0000004
	speed: 0.0417s/iter; left time: 632.2679s
	iters: 400, epoch: 18 | loss: 0.0005536
	speed: 0.0453s/iter; left time: 682.4039s
Epoch: 18 cost time: 21.186872720718384
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0417728
	speed: 0.2941s/iter; left time: 4384.2250s
	iters: 200, epoch: 19 | loss: 0.0001047
	speed: 0.0440s/iter; left time: 651.1997s
	iters: 300, epoch: 19 | loss: 0.0103518
	speed: 0.0428s/iter; left time: 629.1998s
	iters: 400, epoch: 19 | loss: 0.0000052
	speed: 0.0410s/iter; left time: 598.2619s
Epoch: 19 cost time: 20.778773069381714
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.974 Test Loss: 0.201 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0005363
	speed: 0.2777s/iter; left time: 4010.6528s
	iters: 200, epoch: 20 | loss: 0.0017871
	speed: 0.0481s/iter; left time: 690.4376s
	iters: 300, epoch: 20 | loss: 0.0028694
	speed: 0.0473s/iter; left time: 673.2077s
	iters: 400, epoch: 20 | loss: 0.0016074
	speed: 0.0460s/iter; left time: 649.7526s
Epoch: 20 cost time: 22.06282353401184
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.968 Test Loss: 0.237 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000346
	speed: 0.2604s/iter; left time: 3637.9377s
	iters: 200, epoch: 21 | loss: 0.0918830
	speed: 0.0454s/iter; left time: 629.9639s
	iters: 300, epoch: 21 | loss: 0.0000080
	speed: 0.0479s/iter; left time: 660.0404s
	iters: 400, epoch: 21 | loss: 0.0000329
	speed: 0.0471s/iter; left time: 644.0166s
Epoch: 21 cost time: 22.368385076522827
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.256 Vali Acc: 0.972 Test Loss: 0.256 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0001356
	speed: 0.2681s/iter; left time: 3620.2322s
	iters: 200, epoch: 22 | loss: 0.0002686
	speed: 0.0461s/iter; left time: 617.8766s
	iters: 300, epoch: 22 | loss: 0.0145882
	speed: 0.0487s/iter; left time: 647.1547s
	iters: 400, epoch: 22 | loss: 0.0000066
	speed: 0.0485s/iter; left time: 640.1264s
Epoch: 22 cost time: 22.55230402946472
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.978 Test Loss: 0.235 Test Acc: 0.978
Validation loss decreased (-0.977128 --> -0.977699).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000112
	speed: 0.2863s/iter; left time: 3731.4795s
	iters: 200, epoch: 23 | loss: 0.0004538
	speed: 0.0440s/iter; left time: 569.4135s
	iters: 300, epoch: 23 | loss: 0.0012919
	speed: 0.0448s/iter; left time: 575.3737s
	iters: 400, epoch: 23 | loss: 0.0000790
	speed: 0.0445s/iter; left time: 566.9483s
Epoch: 23 cost time: 21.39704942703247
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.289 Vali Acc: 0.972 Test Loss: 0.289 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0045357
	speed: 0.2917s/iter; left time: 3665.3748s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0483s/iter; left time: 602.0683s
	iters: 300, epoch: 24 | loss: 0.0000019
	speed: 0.0452s/iter; left time: 558.4833s
	iters: 400, epoch: 24 | loss: 0.0000026
	speed: 0.0442s/iter; left time: 542.2710s
Epoch: 24 cost time: 21.85873508453369
Epoch: 24, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.254 Vali Acc: 0.971 Test Loss: 0.254 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0006538
	speed: 0.2824s/iter; left time: 3415.8277s
	iters: 200, epoch: 25 | loss: 0.0000011
	speed: 0.0464s/iter; left time: 556.3229s
	iters: 300, epoch: 25 | loss: 0.0598250
	speed: 0.0481s/iter; left time: 572.0775s
	iters: 400, epoch: 25 | loss: 0.0003203
	speed: 0.0493s/iter; left time: 582.0156s
Epoch: 25 cost time: 22.723005533218384
Epoch: 25, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.978 Test Loss: 0.238 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000047
	speed: 0.2763s/iter; left time: 3212.6875s
	iters: 200, epoch: 26 | loss: 0.0011806
	speed: 0.0457s/iter; left time: 526.2151s
	iters: 300, epoch: 26 | loss: 0.0009902
	speed: 0.0457s/iter; left time: 522.1312s
	iters: 400, epoch: 26 | loss: 0.0000866
	speed: 0.0471s/iter; left time: 533.0895s
Epoch: 26 cost time: 22.138829469680786
Epoch: 26, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.275 Vali Acc: 0.981 Test Loss: 0.275 Test Acc: 0.981
Validation loss decreased (-0.977699 --> -0.981415).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000506
	speed: 0.2765s/iter; left time: 3085.0041s
	iters: 200, epoch: 27 | loss: 0.0082473
	speed: 0.0433s/iter; left time: 479.1616s
	iters: 300, epoch: 27 | loss: 0.0000084
	speed: 0.0432s/iter; left time: 473.8312s
	iters: 400, epoch: 27 | loss: 0.0000015
	speed: 0.0455s/iter; left time: 494.3549s
Epoch: 27 cost time: 21.012075185775757
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000004
	speed: 0.2898s/iter; left time: 3097.0857s
	iters: 200, epoch: 28 | loss: 0.0001317
	speed: 0.0430s/iter; left time: 455.3217s
	iters: 300, epoch: 28 | loss: 0.0000874
	speed: 0.0431s/iter; left time: 451.6663s
	iters: 400, epoch: 28 | loss: 0.0000778
	speed: 0.0430s/iter; left time: 446.5434s
Epoch: 28 cost time: 20.75999689102173
Epoch: 28, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.325 Vali Acc: 0.967 Test Loss: 0.325 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.2466051
	speed: 0.2744s/iter; left time: 2804.5947s
	iters: 200, epoch: 29 | loss: 0.0000026
	speed: 0.0485s/iter; left time: 490.5565s
	iters: 300, epoch: 29 | loss: 0.0000115
	speed: 0.0489s/iter; left time: 490.2111s
	iters: 400, epoch: 29 | loss: 0.0001672
	speed: 0.0443s/iter; left time: 439.3177s
Epoch: 29 cost time: 22.524317741394043
Epoch: 29, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.342 Vali Acc: 0.978 Test Loss: 0.342 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000500
	speed: 0.2760s/iter; left time: 2691.0775s
	iters: 200, epoch: 30 | loss: 0.0000312
	speed: 0.0487s/iter; left time: 469.7672s
	iters: 300, epoch: 30 | loss: 0.0021330
	speed: 0.0487s/iter; left time: 465.0294s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0484s/iter; left time: 457.7291s
Epoch: 30 cost time: 22.882984161376953
Epoch: 30, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.288 Vali Acc: 0.968 Test Loss: 0.288 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000128
	speed: 0.2739s/iter; left time: 2542.2201s
	iters: 200, epoch: 31 | loss: 0.0000740
	speed: 0.0471s/iter; left time: 432.6412s
	iters: 300, epoch: 31 | loss: 0.0000060
	speed: 0.0486s/iter; left time: 441.5601s
	iters: 400, epoch: 31 | loss: 0.0001764
	speed: 0.0490s/iter; left time: 440.4621s
Epoch: 31 cost time: 22.42376184463501
Epoch: 31, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.306 Vali Acc: 0.979 Test Loss: 0.306 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0014236
	speed: 0.2871s/iter; left time: 2530.1841s
	iters: 200, epoch: 32 | loss: 0.0000091
	speed: 0.0413s/iter; left time: 359.7003s
	iters: 300, epoch: 32 | loss: 0.0000424
	speed: 0.0432s/iter; left time: 371.6221s
	iters: 400, epoch: 32 | loss: 0.0225623
	speed: 0.0456s/iter; left time: 388.3661s
Epoch: 32 cost time: 21.01837730407715
Epoch: 32, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.265 Vali Acc: 0.976 Test Loss: 0.265 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.2950s/iter; left time: 2461.5874s
	iters: 200, epoch: 33 | loss: 0.0000004
	speed: 0.0433s/iter; left time: 357.3121s
	iters: 300, epoch: 33 | loss: 0.0000027
	speed: 0.0417s/iter; left time: 339.6067s
	iters: 400, epoch: 33 | loss: 0.0000164
	speed: 0.0421s/iter; left time: 338.8145s
Epoch: 33 cost time: 20.852929830551147
Epoch: 33, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.979 Test Loss: 0.269 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000003
	speed: 0.2831s/iter; left time: 2229.2884s
	iters: 200, epoch: 34 | loss: 0.0000033
	speed: 0.0471s/iter; left time: 366.1974s
	iters: 300, epoch: 34 | loss: 0.0000139
	speed: 0.0453s/iter; left time: 347.3333s
	iters: 400, epoch: 34 | loss: 0.0000041
	speed: 0.0465s/iter; left time: 352.1042s
Epoch: 34 cost time: 21.927043676376343
Epoch: 34, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.982 Test Loss: 0.287 Test Acc: 0.982
Validation loss decreased (-0.981415 --> -0.981701).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000019
	speed: 0.2758s/iter; left time: 2042.3421s
	iters: 200, epoch: 35 | loss: 0.0000031
	speed: 0.0463s/iter; left time: 337.9039s
	iters: 300, epoch: 35 | loss: 0.0041086
	speed: 0.0466s/iter; left time: 335.6874s
	iters: 400, epoch: 35 | loss: 0.0060314
	speed: 0.0471s/iter; left time: 334.7688s
Epoch: 35 cost time: 22.358900785446167
Epoch: 35, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.336 Vali Acc: 0.977 Test Loss: 0.336 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0330926
	speed: 0.2820s/iter; left time: 1956.1285s
	iters: 200, epoch: 36 | loss: 0.0000966
	speed: 0.0446s/iter; left time: 304.8966s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.0484s/iter; left time: 326.0258s
	iters: 400, epoch: 36 | loss: 0.0000144
	speed: 0.0465s/iter; left time: 308.6570s
Epoch: 36 cost time: 21.936601400375366
Epoch: 36, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.335 Vali Acc: 0.975 Test Loss: 0.335 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0019449
	speed: 0.2868s/iter; left time: 1854.9042s
	iters: 200, epoch: 37 | loss: 0.0602516
	speed: 0.0443s/iter; left time: 282.1824s
	iters: 300, epoch: 37 | loss: 0.0005160
	speed: 0.0438s/iter; left time: 274.4994s
	iters: 400, epoch: 37 | loss: 0.0000237
	speed: 0.0445s/iter; left time: 274.2798s
Epoch: 37 cost time: 21.000468492507935
Epoch: 37, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0000823
	speed: 0.2890s/iter; left time: 1733.6871s
	iters: 200, epoch: 38 | loss: 0.0000017
	speed: 0.0490s/iter; left time: 289.0785s
	iters: 300, epoch: 38 | loss: 0.0064533
	speed: 0.0463s/iter; left time: 268.2906s
	iters: 400, epoch: 38 | loss: 0.0000002
	speed: 0.0445s/iter; left time: 253.7247s
Epoch: 38 cost time: 22.286362648010254
Epoch: 38, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.360 Vali Acc: 0.974 Test Loss: 0.360 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0031424
	speed: 0.2617s/iter; left time: 1447.1627s
	iters: 200, epoch: 39 | loss: 0.0223965
	speed: 0.0401s/iter; left time: 217.9047s
	iters: 300, epoch: 39 | loss: 0.0362497
	speed: 0.0431s/iter; left time: 229.5257s
	iters: 400, epoch: 39 | loss: 0.0000079
	speed: 0.0476s/iter; left time: 248.9241s
Epoch: 39 cost time: 20.76831579208374
Epoch: 39, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.298 Vali Acc: 0.973 Test Loss: 0.298 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0000133
	speed: 0.2714s/iter; left time: 1373.1316s
	iters: 200, epoch: 40 | loss: 0.0000350
	speed: 0.0430s/iter; left time: 213.4557s
	iters: 300, epoch: 40 | loss: 0.1419109
	speed: 0.0436s/iter; left time: 211.7739s
	iters: 400, epoch: 40 | loss: 0.0000031
	speed: 0.0467s/iter; left time: 222.2559s
Epoch: 40 cost time: 21.25574827194214
Epoch: 40, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.247 Vali Acc: 0.981 Test Loss: 0.247 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0000002
	speed: 0.2633s/iter; left time: 1208.7035s
	iters: 200, epoch: 41 | loss: 0.0000403
	speed: 0.0443s/iter; left time: 198.9381s
	iters: 300, epoch: 41 | loss: 0.0058642
	speed: 0.0435s/iter; left time: 190.8021s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0468s/iter; left time: 200.8389s
Epoch: 41 cost time: 21.134592056274414
Epoch: 41, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.979 Test Loss: 0.262 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000008
	speed: 0.2655s/iter; left time: 1094.3036s
	iters: 200, epoch: 42 | loss: 0.0000032
	speed: 0.0431s/iter; left time: 173.5010s
	iters: 300, epoch: 42 | loss: 0.0000329
	speed: 0.0443s/iter; left time: 173.8083s
	iters: 400, epoch: 42 | loss: 0.0000010
	speed: 0.0475s/iter; left time: 181.5225s
Epoch: 42 cost time: 21.077309131622314
Epoch: 42, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0001481
	speed: 0.2726s/iter; left time: 995.9732s
	iters: 200, epoch: 43 | loss: 0.0000000
	speed: 0.0420s/iter; left time: 149.2710s
	iters: 300, epoch: 43 | loss: 0.0000003
	speed: 0.0436s/iter; left time: 150.4412s
	iters: 400, epoch: 43 | loss: 0.0000065
	speed: 0.0474s/iter; left time: 158.8633s
Epoch: 43 cost time: 21.02333402633667
Epoch: 43, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.394 Vali Acc: 0.967 Test Loss: 0.394 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0001585
	speed: 0.2767s/iter; left time: 881.0860s
	iters: 200, epoch: 44 | loss: 0.0000000
	speed: 0.0411s/iter; left time: 126.6776s
	iters: 300, epoch: 44 | loss: 0.0000001
	speed: 0.0433s/iter; left time: 129.1469s
	iters: 400, epoch: 44 | loss: 0.0001136
	speed: 0.0463s/iter; left time: 133.6398s
Epoch: 44 cost time: 20.754812479019165
Epoch: 44, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.314 Vali Acc: 0.973 Test Loss: 0.314 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 203722
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5691264
	speed: 0.0534s/iter; left time: 1248.1005s
	iters: 200, epoch: 1 | loss: 0.6399106
	speed: 0.0384s/iter; left time: 893.1825s
	iters: 300, epoch: 1 | loss: 0.2450317
	speed: 0.0384s/iter; left time: 887.8823s
	iters: 400, epoch: 1 | loss: 0.1812262
	speed: 0.0376s/iter; left time: 867.7484s
Epoch: 1 cost time: 19.426814794540405
Epoch: 1, Steps: 469 | Train Loss: 0.795 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
Validation loss decreased (inf --> -0.910803).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1873047
	speed: 0.2187s/iter; left time: 5005.1329s
	iters: 200, epoch: 2 | loss: 0.1187008
	speed: 0.0372s/iter; left time: 847.9337s
	iters: 300, epoch: 2 | loss: 0.0757362
	speed: 0.0366s/iter; left time: 830.1701s
	iters: 400, epoch: 2 | loss: 0.0440633
	speed: 0.0346s/iter; left time: 780.5163s
Epoch: 2 cost time: 17.241878271102905
Epoch: 2, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.910803 --> -0.962834).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1507804
	speed: 0.2106s/iter; left time: 4720.7021s
	iters: 200, epoch: 3 | loss: 0.0048195
	speed: 0.0369s/iter; left time: 822.4798s
	iters: 300, epoch: 3 | loss: 0.0203645
	speed: 0.0361s/iter; left time: 802.5158s
	iters: 400, epoch: 3 | loss: 0.0181271
	speed: 0.0385s/iter; left time: 850.5018s
Epoch: 3 cost time: 17.825732231140137
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.962834 --> -0.971125).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0303893
	speed: 0.2159s/iter; left time: 4736.7931s
	iters: 200, epoch: 4 | loss: 0.0031648
	speed: 0.0366s/iter; left time: 800.4806s
	iters: 300, epoch: 4 | loss: 0.0826110
	speed: 0.0361s/iter; left time: 785.2395s
	iters: 400, epoch: 4 | loss: 0.0063890
	speed: 0.0369s/iter; left time: 799.7198s
Epoch: 4 cost time: 17.53421950340271
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0041635
	speed: 0.2156s/iter; left time: 4630.3117s
	iters: 200, epoch: 5 | loss: 0.0077571
	speed: 0.0304s/iter; left time: 649.8785s
	iters: 300, epoch: 5 | loss: 0.0293628
	speed: 0.0319s/iter; left time: 678.9109s
	iters: 400, epoch: 5 | loss: 0.0074157
	speed: 0.0366s/iter; left time: 774.3622s
Epoch: 5 cost time: 16.14755344390869
Epoch: 5, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0898851
	speed: 0.2233s/iter; left time: 4689.6744s
	iters: 200, epoch: 6 | loss: 0.0084191
	speed: 0.0343s/iter; left time: 717.1012s
	iters: 300, epoch: 6 | loss: 0.0014690
	speed: 0.0357s/iter; left time: 743.0468s
	iters: 400, epoch: 6 | loss: 0.0013316
	speed: 0.0328s/iter; left time: 679.3901s
Epoch: 6 cost time: 16.786415338516235
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
Validation loss decreased (-0.971125 --> -0.975985).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0555727
	speed: 0.2243s/iter; left time: 4607.1988s
	iters: 200, epoch: 7 | loss: 0.0145226
	speed: 0.0373s/iter; left time: 761.2900s
	iters: 300, epoch: 7 | loss: 0.0176604
	speed: 0.0344s/iter; left time: 700.4920s
	iters: 400, epoch: 7 | loss: 0.0006126
	speed: 0.0348s/iter; left time: 705.1064s
Epoch: 7 cost time: 17.24863052368164
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0868395
	speed: 0.2179s/iter; left time: 4372.9224s
	iters: 200, epoch: 8 | loss: 0.0025770
	speed: 0.0379s/iter; left time: 757.2246s
	iters: 300, epoch: 8 | loss: 0.0165657
	speed: 0.0376s/iter; left time: 746.6932s
	iters: 400, epoch: 8 | loss: 0.0086100
	speed: 0.0364s/iter; left time: 719.6775s
Epoch: 8 cost time: 17.833093404769897
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0001672
	speed: 0.2131s/iter; left time: 4176.2240s
	iters: 200, epoch: 9 | loss: 0.0055491
	speed: 0.0375s/iter; left time: 731.2747s
	iters: 300, epoch: 9 | loss: 0.0153000
	speed: 0.0377s/iter; left time: 731.5217s
	iters: 400, epoch: 9 | loss: 0.1103853
	speed: 0.0375s/iter; left time: 724.2603s
Epoch: 9 cost time: 18.001636743545532
Epoch: 9, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0008401
	speed: 0.2141s/iter; left time: 4095.5523s
	iters: 200, epoch: 10 | loss: 0.0003080
	speed: 0.0361s/iter; left time: 687.5504s
	iters: 300, epoch: 10 | loss: 0.0252547
	speed: 0.0366s/iter; left time: 692.3249s
	iters: 400, epoch: 10 | loss: 0.0002597
	speed: 0.0371s/iter; left time: 698.9586s
Epoch: 10 cost time: 17.402921676635742
Epoch: 10, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.978272).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0002073
	speed: 0.2169s/iter; left time: 4047.7317s
	iters: 200, epoch: 11 | loss: 0.0001677
	speed: 0.0346s/iter; left time: 641.8070s
	iters: 300, epoch: 11 | loss: 0.0004932
	speed: 0.0345s/iter; left time: 636.4713s
	iters: 400, epoch: 11 | loss: 0.0050187
	speed: 0.0374s/iter; left time: 685.8967s
Epoch: 11 cost time: 16.925341606140137
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0003288
	speed: 0.2173s/iter; left time: 3953.8662s
	iters: 200, epoch: 12 | loss: 0.0012780
	speed: 0.0352s/iter; left time: 636.5930s
	iters: 300, epoch: 12 | loss: 0.0002293
	speed: 0.0364s/iter; left time: 654.7408s
	iters: 400, epoch: 12 | loss: 0.0082255
	speed: 0.0362s/iter; left time: 647.6722s
Epoch: 12 cost time: 17.247201204299927
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0206435
	speed: 0.2173s/iter; left time: 3850.7109s
	iters: 200, epoch: 13 | loss: 0.0000369
	speed: 0.0338s/iter; left time: 595.6079s
	iters: 300, epoch: 13 | loss: 0.0005448
	speed: 0.0351s/iter; left time: 614.8183s
	iters: 400, epoch: 13 | loss: 0.0000790
	speed: 0.0350s/iter; left time: 610.5498s
Epoch: 13 cost time: 16.659631967544556
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0012445
	speed: 0.2165s/iter; left time: 3735.8107s
	iters: 200, epoch: 14 | loss: 0.0004265
	speed: 0.0356s/iter; left time: 609.9548s
	iters: 300, epoch: 14 | loss: 0.0021358
	speed: 0.0359s/iter; left time: 611.3861s
	iters: 400, epoch: 14 | loss: 0.0002303
	speed: 0.0354s/iter; left time: 599.6634s
Epoch: 14 cost time: 17.20639967918396
Epoch: 14, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0006248
	speed: 0.2206s/iter; left time: 3703.5673s
	iters: 200, epoch: 15 | loss: 0.0000124
	speed: 0.0363s/iter; left time: 605.2308s
	iters: 300, epoch: 15 | loss: 0.0001414
	speed: 0.0354s/iter; left time: 586.8541s
	iters: 400, epoch: 15 | loss: 0.0004239
	speed: 0.0364s/iter; left time: 600.2042s
Epoch: 15 cost time: 17.154314279556274
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.979 Test Loss: 0.137 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978844).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0005546
	speed: 0.2203s/iter; left time: 3595.1001s
	iters: 200, epoch: 16 | loss: 0.0000701
	speed: 0.0389s/iter; left time: 631.0598s
	iters: 300, epoch: 16 | loss: 0.0009905
	speed: 0.0361s/iter; left time: 581.4857s
	iters: 400, epoch: 16 | loss: 0.0821335
	speed: 0.0360s/iter; left time: 576.7548s
Epoch: 16 cost time: 17.800285816192627
Epoch: 16, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.981 Test Loss: 0.137 Test Acc: 0.981
Validation loss decreased (-0.978844 --> -0.980559).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0012536
	speed: 0.2146s/iter; left time: 3401.2816s
	iters: 200, epoch: 17 | loss: 0.0005577
	speed: 0.0355s/iter; left time: 559.2798s
	iters: 300, epoch: 17 | loss: 0.4643682
	speed: 0.0326s/iter; left time: 509.9482s
	iters: 400, epoch: 17 | loss: 0.0002104
	speed: 0.0318s/iter; left time: 494.5221s
Epoch: 17 cost time: 16.07126784324646
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0002163
	speed: 0.2128s/iter; left time: 3272.6402s
	iters: 200, epoch: 18 | loss: 0.0001337
	speed: 0.0378s/iter; left time: 577.1966s
	iters: 300, epoch: 18 | loss: 0.0009589
	speed: 0.0339s/iter; left time: 513.8770s
	iters: 400, epoch: 18 | loss: 0.0251703
	speed: 0.0348s/iter; left time: 524.6655s
Epoch: 18 cost time: 17.163644552230835
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0009626
	speed: 0.2104s/iter; left time: 3136.1323s
	iters: 200, epoch: 19 | loss: 0.0344656
	speed: 0.0370s/iter; left time: 547.6185s
	iters: 300, epoch: 19 | loss: 0.0005548
	speed: 0.0344s/iter; left time: 506.3985s
	iters: 400, epoch: 19 | loss: 0.0001930
	speed: 0.0335s/iter; left time: 488.7597s
Epoch: 19 cost time: 16.81531834602356
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0229595
	speed: 0.2112s/iter; left time: 3050.2301s
	iters: 200, epoch: 20 | loss: 0.0091287
	speed: 0.0341s/iter; left time: 489.6835s
	iters: 300, epoch: 20 | loss: 0.0000177
	speed: 0.0339s/iter; left time: 482.5178s
	iters: 400, epoch: 20 | loss: 0.0000575
	speed: 0.0350s/iter; left time: 495.5343s
Epoch: 20 cost time: 16.6256742477417
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.981417).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0137114
	speed: 0.2074s/iter; left time: 2897.0505s
	iters: 200, epoch: 21 | loss: 0.0003148
	speed: 0.0365s/iter; left time: 506.9169s
	iters: 300, epoch: 21 | loss: 0.0000290
	speed: 0.0345s/iter; left time: 475.0937s
	iters: 400, epoch: 21 | loss: 0.0341297
	speed: 0.0338s/iter; left time: 462.6420s
Epoch: 21 cost time: 16.421520233154297
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0155253
	speed: 0.2142s/iter; left time: 2891.9687s
	iters: 200, epoch: 22 | loss: 0.0461618
	speed: 0.0368s/iter; left time: 493.5556s
	iters: 300, epoch: 22 | loss: 0.1391563
	speed: 0.0398s/iter; left time: 529.6662s
	iters: 400, epoch: 22 | loss: 0.0000277
	speed: 0.0351s/iter; left time: 463.8731s
Epoch: 22 cost time: 17.46541666984558
Epoch: 22, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0006299
	speed: 0.2038s/iter; left time: 2655.7718s
	iters: 200, epoch: 23 | loss: 0.0004086
	speed: 0.0339s/iter; left time: 438.8042s
	iters: 300, epoch: 23 | loss: 0.0073765
	speed: 0.0380s/iter; left time: 487.6981s
	iters: 400, epoch: 23 | loss: 0.0098034
	speed: 0.0352s/iter; left time: 448.0463s
Epoch: 23 cost time: 16.481364965438843
Epoch: 23, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0002693
	speed: 0.2113s/iter; left time: 2654.3230s
	iters: 200, epoch: 24 | loss: 0.0001991
	speed: 0.0376s/iter; left time: 468.3626s
	iters: 300, epoch: 24 | loss: 0.0000150
	speed: 0.0380s/iter; left time: 470.2574s
	iters: 400, epoch: 24 | loss: 0.0000247
	speed: 0.0370s/iter; left time: 453.2220s
Epoch: 24 cost time: 17.57547664642334
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0013938
	speed: 0.2143s/iter; left time: 2591.6258s
	iters: 200, epoch: 25 | loss: 0.0242170
	speed: 0.0357s/iter; left time: 427.9349s
	iters: 300, epoch: 25 | loss: 0.0000263
	speed: 0.0353s/iter; left time: 420.4408s
	iters: 400, epoch: 25 | loss: 0.0049048
	speed: 0.0374s/iter; left time: 440.5588s
Epoch: 25 cost time: 17.35489511489868
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000119
	speed: 0.2165s/iter; left time: 2516.6743s
	iters: 200, epoch: 26 | loss: 0.0028293
	speed: 0.0379s/iter; left time: 436.7919s
	iters: 300, epoch: 26 | loss: 0.0030306
	speed: 0.0374s/iter; left time: 426.9759s
	iters: 400, epoch: 26 | loss: 0.0003432
	speed: 0.0354s/iter; left time: 401.3525s
Epoch: 26 cost time: 17.612380743026733
Epoch: 26, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0003467
	speed: 0.2049s/iter; left time: 2285.9994s
	iters: 200, epoch: 27 | loss: 0.0032310
	speed: 0.0370s/iter; left time: 409.0625s
	iters: 300, epoch: 27 | loss: 0.0118951
	speed: 0.0370s/iter; left time: 405.2506s
	iters: 400, epoch: 27 | loss: 0.0033444
	speed: 0.0368s/iter; left time: 399.7796s
Epoch: 27 cost time: 17.476083993911743
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0259928
	speed: 0.2044s/iter; left time: 2184.2727s
	iters: 200, epoch: 28 | loss: 0.0000395
	speed: 0.0348s/iter; left time: 368.6885s
	iters: 300, epoch: 28 | loss: 0.0148615
	speed: 0.0363s/iter; left time: 380.6416s
	iters: 400, epoch: 28 | loss: 0.0000118
	speed: 0.0371s/iter; left time: 384.8956s
Epoch: 28 cost time: 17.124898672103882
Epoch: 28, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0001213
	speed: 0.2110s/iter; left time: 2155.9232s
	iters: 200, epoch: 29 | loss: 0.0000003
	speed: 0.0325s/iter; left time: 329.3083s
	iters: 300, epoch: 29 | loss: 0.0000288
	speed: 0.0345s/iter; left time: 345.8663s
	iters: 400, epoch: 29 | loss: 0.0000655
	speed: 0.0362s/iter; left time: 358.5974s
Epoch: 29 cost time: 16.446101665496826
Epoch: 29, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0127734
	speed: 0.2173s/iter; left time: 2118.8675s
	iters: 200, epoch: 30 | loss: 0.0000069
	speed: 0.0343s/iter; left time: 330.6766s
	iters: 300, epoch: 30 | loss: 0.0000071
	speed: 0.0331s/iter; left time: 315.6417s
	iters: 400, epoch: 30 | loss: 0.0000780
	speed: 0.0348s/iter; left time: 328.6633s
Epoch: 30 cost time: 16.33280324935913
Epoch: 30, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 56778
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5848833
	speed: 0.0508s/iter; left time: 1186.1018s
	iters: 200, epoch: 1 | loss: 0.3347019
	speed: 0.0379s/iter; left time: 880.7834s
	iters: 300, epoch: 1 | loss: 0.3689138
	speed: 0.0379s/iter; left time: 877.7579s
	iters: 400, epoch: 1 | loss: 0.2637589
	speed: 0.0374s/iter; left time: 862.9342s
Epoch: 1 cost time: 19.099457025527954
Epoch: 1, Steps: 469 | Train Loss: 0.802 Vali Loss: 0.318 Vali Acc: 0.913 Test Loss: 0.318 Test Acc: 0.913
Validation loss decreased (inf --> -0.912518).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3250864
	speed: 0.2151s/iter; left time: 4921.5973s
	iters: 200, epoch: 2 | loss: 0.0692049
	speed: 0.0383s/iter; left time: 873.0762s
	iters: 300, epoch: 2 | loss: 0.0769924
	speed: 0.0381s/iter; left time: 863.3729s
	iters: 400, epoch: 2 | loss: 0.0250648
	speed: 0.0386s/iter; left time: 871.4736s
Epoch: 2 cost time: 18.345689296722412
Epoch: 2, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.912518 --> -0.958260).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0563576
	speed: 0.2157s/iter; left time: 4833.7671s
	iters: 200, epoch: 3 | loss: 0.0179176
	speed: 0.0356s/iter; left time: 794.1142s
	iters: 300, epoch: 3 | loss: 0.0145564
	speed: 0.0351s/iter; left time: 779.7845s
	iters: 400, epoch: 3 | loss: 0.0025281
	speed: 0.0329s/iter; left time: 727.5344s
Epoch: 3 cost time: 16.440053939819336
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
Validation loss decreased (-0.958260 --> -0.968838).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0039673
	speed: 0.2122s/iter; left time: 4657.0801s
	iters: 200, epoch: 4 | loss: 0.0032202
	speed: 0.0353s/iter; left time: 771.5548s
	iters: 300, epoch: 4 | loss: 0.0095238
	speed: 0.0320s/iter; left time: 695.6387s
	iters: 400, epoch: 4 | loss: 0.0189528
	speed: 0.0339s/iter; left time: 732.8543s
Epoch: 4 cost time: 16.622246980667114
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
Validation loss decreased (-0.968838 --> -0.971697).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0028461
	speed: 0.2185s/iter; left time: 4691.6010s
	iters: 200, epoch: 5 | loss: 0.0056833
	speed: 0.0368s/iter; left time: 787.3448s
	iters: 300, epoch: 5 | loss: 0.0017245
	speed: 0.0348s/iter; left time: 740.7291s
	iters: 400, epoch: 5 | loss: 0.1707831
	speed: 0.0333s/iter; left time: 706.0987s
Epoch: 5 cost time: 16.678033351898193
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0339580
	speed: 0.2134s/iter; left time: 4483.6945s
	iters: 200, epoch: 6 | loss: 0.0004931
	speed: 0.0351s/iter; left time: 734.0114s
	iters: 300, epoch: 6 | loss: 0.0141136
	speed: 0.0344s/iter; left time: 715.6829s
	iters: 400, epoch: 6 | loss: 0.0013673
	speed: 0.0339s/iter; left time: 701.3972s
Epoch: 6 cost time: 16.844934225082397
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
Validation loss decreased (-0.971697 --> -0.975699).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0003896
	speed: 0.2119s/iter; left time: 4351.4690s
	iters: 200, epoch: 7 | loss: 0.0242031
	speed: 0.0360s/iter; left time: 736.5305s
	iters: 300, epoch: 7 | loss: 0.0007743
	speed: 0.0355s/iter; left time: 722.5464s
	iters: 400, epoch: 7 | loss: 0.0088446
	speed: 0.0360s/iter; left time: 729.0806s
Epoch: 7 cost time: 17.30056595802307
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0006026
	speed: 0.2195s/iter; left time: 4404.0315s
	iters: 200, epoch: 8 | loss: 0.0009392
	speed: 0.0341s/iter; left time: 680.7499s
	iters: 300, epoch: 8 | loss: 0.1741434
	speed: 0.0340s/iter; left time: 675.5856s
	iters: 400, epoch: 8 | loss: 0.0160583
	speed: 0.0348s/iter; left time: 687.2325s
Epoch: 8 cost time: 16.385477542877197
Epoch: 8, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0003893
	speed: 0.2234s/iter; left time: 4379.2195s
	iters: 200, epoch: 9 | loss: 0.0246465
	speed: 0.0347s/iter; left time: 676.4920s
	iters: 300, epoch: 9 | loss: 0.0005770
	speed: 0.0319s/iter; left time: 618.6517s
	iters: 400, epoch: 9 | loss: 0.0008452
	speed: 0.0321s/iter; left time: 619.6593s
Epoch: 9 cost time: 16.111494541168213
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0003612
	speed: 0.2234s/iter; left time: 4272.8362s
	iters: 200, epoch: 10 | loss: 0.0012220
	speed: 0.0344s/iter; left time: 654.7390s
	iters: 300, epoch: 10 | loss: 0.0499900
	speed: 0.0348s/iter; left time: 658.8864s
	iters: 400, epoch: 10 | loss: 0.0039093
	speed: 0.0349s/iter; left time: 656.2457s
Epoch: 10 cost time: 16.766403436660767
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.977415).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0208688
	speed: 0.2195s/iter; left time: 4095.5603s
	iters: 200, epoch: 11 | loss: 0.0012676
	speed: 0.0345s/iter; left time: 641.1665s
	iters: 300, epoch: 11 | loss: 0.0006059
	speed: 0.0349s/iter; left time: 643.8396s
	iters: 400, epoch: 11 | loss: 0.0129565
	speed: 0.0359s/iter; left time: 659.1018s
Epoch: 11 cost time: 17.088744401931763
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004238
	speed: 0.2166s/iter; left time: 3941.1424s
	iters: 200, epoch: 12 | loss: 0.0001703
	speed: 0.0349s/iter; left time: 631.0727s
	iters: 300, epoch: 12 | loss: 0.0005481
	speed: 0.0349s/iter; left time: 628.4953s
	iters: 400, epoch: 12 | loss: 0.0015076
	speed: 0.0345s/iter; left time: 617.9339s
Epoch: 12 cost time: 16.56374192237854
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000109
	speed: 0.2170s/iter; left time: 3846.0953s
	iters: 200, epoch: 13 | loss: 0.0010517
	speed: 0.0320s/iter; left time: 564.6676s
	iters: 300, epoch: 13 | loss: 0.5202115
	speed: 0.0329s/iter; left time: 576.3853s
	iters: 400, epoch: 13 | loss: 0.4633681
	speed: 0.0350s/iter; left time: 609.9574s
Epoch: 13 cost time: 16.178409099578857
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.977415 --> -0.979702).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0043332
	speed: 0.2170s/iter; left time: 3743.4852s
	iters: 200, epoch: 14 | loss: 0.0003461
	speed: 0.0350s/iter; left time: 600.1068s
	iters: 300, epoch: 14 | loss: 0.0001855
	speed: 0.0340s/iter; left time: 580.1138s
	iters: 400, epoch: 14 | loss: 0.0051723
	speed: 0.0370s/iter; left time: 627.1486s
Epoch: 14 cost time: 16.864179611206055
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0024359
	speed: 0.2123s/iter; left time: 3562.7430s
	iters: 200, epoch: 15 | loss: 0.0810071
	speed: 0.0343s/iter; left time: 571.6043s
	iters: 300, epoch: 15 | loss: 0.0101629
	speed: 0.0363s/iter; left time: 601.3163s
	iters: 400, epoch: 15 | loss: 0.0000501
	speed: 0.0367s/iter; left time: 605.5577s
Epoch: 15 cost time: 17.04211401939392
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980845).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0011763
	speed: 0.2122s/iter; left time: 3462.5829s
	iters: 200, epoch: 16 | loss: 0.0004618
	speed: 0.0345s/iter; left time: 559.8161s
	iters: 300, epoch: 16 | loss: 0.0000457
	speed: 0.0378s/iter; left time: 609.1743s
	iters: 400, epoch: 16 | loss: 0.0000376
	speed: 0.0395s/iter; left time: 633.1668s
Epoch: 16 cost time: 17.801181316375732
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0219523
	speed: 0.2158s/iter; left time: 3419.7048s
	iters: 200, epoch: 17 | loss: 0.0152003
	speed: 0.0341s/iter; left time: 536.5998s
	iters: 300, epoch: 17 | loss: 0.0004984
	speed: 0.0370s/iter; left time: 579.7104s
	iters: 400, epoch: 17 | loss: 0.0840959
	speed: 0.0345s/iter; left time: 536.1180s
Epoch: 17 cost time: 16.551750898361206
Epoch: 17, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0141070
	speed: 0.2026s/iter; left time: 3115.0508s
	iters: 200, epoch: 18 | loss: 0.0019307
	speed: 0.0336s/iter; left time: 513.1751s
	iters: 300, epoch: 18 | loss: 0.0005122
	speed: 0.0358s/iter; left time: 543.5864s
	iters: 400, epoch: 18 | loss: 0.0234452
	speed: 0.0321s/iter; left time: 484.3069s
Epoch: 18 cost time: 16.11722755432129
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.168 Vali Acc: 0.979 Test Loss: 0.168 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0006810
	speed: 0.1980s/iter; left time: 2951.9398s
	iters: 200, epoch: 19 | loss: 0.0007519
	speed: 0.0364s/iter; left time: 538.8320s
	iters: 300, epoch: 19 | loss: 0.0018239
	speed: 0.0343s/iter; left time: 504.8517s
	iters: 400, epoch: 19 | loss: 0.0087722
	speed: 0.0333s/iter; left time: 485.8054s
Epoch: 19 cost time: 16.61781668663025
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0018439
	speed: 0.2075s/iter; left time: 2995.6282s
	iters: 200, epoch: 20 | loss: 0.0008487
	speed: 0.0338s/iter; left time: 484.2685s
	iters: 300, epoch: 20 | loss: 0.0000960
	speed: 0.0325s/iter; left time: 463.0126s
	iters: 400, epoch: 20 | loss: 0.0015026
	speed: 0.0309s/iter; left time: 436.3997s
Epoch: 20 cost time: 15.794182777404785
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.980845).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0009459
	speed: 0.2020s/iter; left time: 2822.6385s
	iters: 200, epoch: 21 | loss: 0.0004550
	speed: 0.0334s/iter; left time: 463.5318s
	iters: 300, epoch: 21 | loss: 0.0001206
	speed: 0.0324s/iter; left time: 445.5339s
	iters: 400, epoch: 21 | loss: 0.0000733
	speed: 0.0323s/iter; left time: 441.6289s
Epoch: 21 cost time: 15.8129243850708
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000080
	speed: 0.2052s/iter; left time: 2770.0183s
	iters: 200, epoch: 22 | loss: 0.0014190
	speed: 0.0340s/iter; left time: 455.0408s
	iters: 300, epoch: 22 | loss: 0.0003827
	speed: 0.0325s/iter; left time: 432.3688s
	iters: 400, epoch: 22 | loss: 0.0000863
	speed: 0.0317s/iter; left time: 418.7921s
Epoch: 22 cost time: 15.900206089019775
Epoch: 22, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.971 Test Loss: 0.254 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000114
	speed: 0.2022s/iter; left time: 2635.0480s
	iters: 200, epoch: 23 | loss: 0.0000950
	speed: 0.0326s/iter; left time: 421.5390s
	iters: 300, epoch: 23 | loss: 0.0121622
	speed: 0.0335s/iter; left time: 430.4216s
	iters: 400, epoch: 23 | loss: 0.0008537
	speed: 0.0333s/iter; left time: 424.2606s
Epoch: 23 cost time: 15.762884855270386
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0003388
	speed: 0.2040s/iter; left time: 2562.7647s
	iters: 200, epoch: 24 | loss: 0.0032097
	speed: 0.0330s/iter; left time: 411.1773s
	iters: 300, epoch: 24 | loss: 0.0394130
	speed: 0.0332s/iter; left time: 409.9139s
	iters: 400, epoch: 24 | loss: 0.0000074
	speed: 0.0331s/iter; left time: 405.7942s
Epoch: 24 cost time: 15.76047968864441
Epoch: 24, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.979 Test Loss: 0.184 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000240
	speed: 0.2040s/iter; left time: 2467.2927s
	iters: 200, epoch: 25 | loss: 0.0008243
	speed: 0.0332s/iter; left time: 397.8015s
	iters: 300, epoch: 25 | loss: 0.0001061
	speed: 0.0331s/iter; left time: 393.7394s
	iters: 400, epoch: 25 | loss: 0.0000205
	speed: 0.0344s/iter; left time: 405.2029s
Epoch: 25 cost time: 16.21064805984497
Epoch: 25, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.974 Test Loss: 0.207 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0002902
	speed: 0.2032s/iter; left time: 2362.5552s
	iters: 200, epoch: 26 | loss: 0.0002414
	speed: 0.0330s/iter; left time: 380.7033s
	iters: 300, epoch: 26 | loss: 0.0007026
	speed: 0.0338s/iter; left time: 385.8038s
	iters: 400, epoch: 26 | loss: 0.0001406
	speed: 0.0348s/iter; left time: 394.2374s
Epoch: 26 cost time: 16.071289539337158
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.209 Vali Acc: 0.969 Test Loss: 0.209 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0000228
	speed: 0.2023s/iter; left time: 2257.1397s
	iters: 200, epoch: 27 | loss: 0.0003310
	speed: 0.0323s/iter; left time: 357.1059s
	iters: 300, epoch: 27 | loss: 0.0000057
	speed: 0.0325s/iter; left time: 356.6242s
	iters: 400, epoch: 27 | loss: 0.0019599
	speed: 0.0339s/iter; left time: 368.0703s
Epoch: 27 cost time: 15.887567043304443
Epoch: 27, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.971 Test Loss: 0.270 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0001149
	speed: 0.1989s/iter; left time: 2125.7081s
	iters: 200, epoch: 28 | loss: 0.0000090
	speed: 0.0317s/iter; left time: 336.1650s
	iters: 300, epoch: 28 | loss: 0.0000141
	speed: 0.0353s/iter; left time: 370.4330s
	iters: 400, epoch: 28 | loss: 0.0000674
	speed: 0.0330s/iter; left time: 342.3958s
Epoch: 28 cost time: 15.795644521713257
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.970 Test Loss: 0.252 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0014951
	speed: 0.1952s/iter; left time: 1994.4050s
	iters: 200, epoch: 29 | loss: 0.0000576
	speed: 0.0357s/iter; left time: 361.2198s
	iters: 300, epoch: 29 | loss: 0.0003979
	speed: 0.0356s/iter; left time: 356.4015s
	iters: 400, epoch: 29 | loss: 0.0000042
	speed: 0.0351s/iter; left time: 347.9214s
Epoch: 29 cost time: 16.563518524169922
Epoch: 29, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.976 Test Loss: 0.186 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0001304
	speed: 0.1937s/iter; left time: 1889.0276s
	iters: 200, epoch: 30 | loss: 0.0000027
	speed: 0.0348s/iter; left time: 335.3418s
	iters: 300, epoch: 30 | loss: 0.0001016
	speed: 0.0370s/iter; left time: 353.8241s
	iters: 400, epoch: 30 | loss: 0.0391595
	speed: 0.0353s/iter; left time: 333.3770s
Epoch: 30 cost time: 16.94598650932312
Epoch: 30, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.254 Vali Acc: 0.964 Test Loss: 0.254 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 56810
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4178708
	speed: 0.0528s/iter; left time: 1231.9418s
	iters: 200, epoch: 1 | loss: 0.1644141
	speed: 0.0384s/iter; left time: 893.7623s
	iters: 300, epoch: 1 | loss: 0.0858733
	speed: 0.0389s/iter; left time: 900.8730s
	iters: 400, epoch: 1 | loss: 0.1325951
	speed: 0.0386s/iter; left time: 890.6871s
Epoch: 1 cost time: 19.699145317077637
Epoch: 1, Steps: 469 | Train Loss: 0.343 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (inf --> -0.955687).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0087720
	speed: 0.2445s/iter; left time: 5594.2885s
	iters: 200, epoch: 2 | loss: 0.0064040
	speed: 0.0379s/iter; left time: 862.9193s
	iters: 300, epoch: 2 | loss: 0.0173186
	speed: 0.0396s/iter; left time: 897.6605s
	iters: 400, epoch: 2 | loss: 0.0254162
	speed: 0.0322s/iter; left time: 728.0385s
Epoch: 2 cost time: 17.271947860717773
Epoch: 2, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
Validation loss decreased (-0.955687 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002990
	speed: 0.2316s/iter; left time: 5190.5110s
	iters: 200, epoch: 3 | loss: 0.0440752
	speed: 0.0417s/iter; left time: 931.1711s
	iters: 300, epoch: 3 | loss: 0.0177926
	speed: 0.0393s/iter; left time: 873.5035s
	iters: 400, epoch: 3 | loss: 0.0010037
	speed: 0.0391s/iter; left time: 865.0700s
Epoch: 3 cost time: 19.169236660003662
Epoch: 3, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
Validation loss decreased (-0.957974 --> -0.967694).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0039431
	speed: 0.2505s/iter; left time: 5497.8684s
	iters: 200, epoch: 4 | loss: 0.0625157
	speed: 0.0396s/iter; left time: 865.3968s
	iters: 300, epoch: 4 | loss: 0.0010188
	speed: 0.0392s/iter; left time: 852.5185s
	iters: 400, epoch: 4 | loss: 0.0091464
	speed: 0.0392s/iter; left time: 848.2439s
Epoch: 4 cost time: 18.96390128135681
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
Validation loss decreased (-0.967694 --> -0.971696).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0083652
	speed: 0.2492s/iter; left time: 5351.8120s
	iters: 200, epoch: 5 | loss: 0.0448091
	speed: 0.0372s/iter; left time: 795.0378s
	iters: 300, epoch: 5 | loss: 0.0315668
	speed: 0.0389s/iter; left time: 828.1453s
	iters: 400, epoch: 5 | loss: 0.2392639
	speed: 0.0405s/iter; left time: 857.2783s
Epoch: 5 cost time: 18.714454650878906
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002039
	speed: 0.2340s/iter; left time: 4914.5401s
	iters: 200, epoch: 6 | loss: 0.1126015
	speed: 0.0398s/iter; left time: 832.6526s
	iters: 300, epoch: 6 | loss: 0.0005656
	speed: 0.0386s/iter; left time: 802.2742s
	iters: 400, epoch: 6 | loss: 0.0019718
	speed: 0.0403s/iter; left time: 833.9140s
Epoch: 6 cost time: 18.793763399124146
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0153384
	speed: 0.2332s/iter; left time: 4789.8241s
	iters: 200, epoch: 7 | loss: 0.0193999
	speed: 0.0401s/iter; left time: 820.2881s
	iters: 300, epoch: 7 | loss: 0.1659746
	speed: 0.0404s/iter; left time: 820.6642s
	iters: 400, epoch: 7 | loss: 0.0000335
	speed: 0.0378s/iter; left time: 764.8618s
Epoch: 7 cost time: 18.865137338638306
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.971696 --> -0.977414).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000318
	speed: 0.2417s/iter; left time: 4850.5225s
	iters: 200, epoch: 8 | loss: 0.4127726
	speed: 0.0413s/iter; left time: 825.4961s
	iters: 300, epoch: 8 | loss: 0.0002233
	speed: 0.0386s/iter; left time: 766.4202s
	iters: 400, epoch: 8 | loss: 0.0003307
	speed: 0.0383s/iter; left time: 757.6797s
Epoch: 8 cost time: 18.919146060943604
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000173
	speed: 0.2446s/iter; left time: 4792.9398s
	iters: 200, epoch: 9 | loss: 0.0013808
	speed: 0.0389s/iter; left time: 758.1877s
	iters: 300, epoch: 9 | loss: 0.0170334
	speed: 0.0386s/iter; left time: 748.9779s
	iters: 400, epoch: 9 | loss: 0.0082366
	speed: 0.0383s/iter; left time: 739.8416s
Epoch: 9 cost time: 18.497445106506348
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0013535
	speed: 0.2469s/iter; left time: 4722.7276s
	iters: 200, epoch: 10 | loss: 0.0003366
	speed: 0.0383s/iter; left time: 728.6075s
	iters: 300, epoch: 10 | loss: 0.0016122
	speed: 0.0389s/iter; left time: 736.2735s
	iters: 400, epoch: 10 | loss: 0.0000146
	speed: 0.0413s/iter; left time: 778.5489s
Epoch: 10 cost time: 18.522860765457153
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.965 Test Loss: 0.201 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001805
	speed: 0.2475s/iter; left time: 4619.1755s
	iters: 200, epoch: 11 | loss: 0.2647883
	speed: 0.0399s/iter; left time: 740.6886s
	iters: 300, epoch: 11 | loss: 0.0000115
	speed: 0.0424s/iter; left time: 783.2792s
	iters: 400, epoch: 11 | loss: 0.0001994
	speed: 0.0418s/iter; left time: 767.5030s
Epoch: 11 cost time: 19.519709825515747
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.269 Vali Acc: 0.963 Test Loss: 0.269 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000462
	speed: 0.2498s/iter; left time: 4544.8518s
	iters: 200, epoch: 12 | loss: 0.0001081
	speed: 0.0383s/iter; left time: 693.6685s
	iters: 300, epoch: 12 | loss: 0.0004929
	speed: 0.0406s/iter; left time: 729.6193s
	iters: 400, epoch: 12 | loss: 0.0168108
	speed: 0.0409s/iter; left time: 731.5300s
Epoch: 12 cost time: 19.056506395339966
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.219 Vali Acc: 0.969 Test Loss: 0.219 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000079
	speed: 0.2442s/iter; left time: 4328.2007s
	iters: 200, epoch: 13 | loss: 0.0003633
	speed: 0.0397s/iter; left time: 700.3429s
	iters: 300, epoch: 13 | loss: 0.0329839
	speed: 0.0361s/iter; left time: 632.4411s
	iters: 400, epoch: 13 | loss: 0.0002942
	speed: 0.0383s/iter; left time: 666.8534s
Epoch: 13 cost time: 18.504874229431152
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.267 Vali Acc: 0.972 Test Loss: 0.267 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.3136654
	speed: 0.2498s/iter; left time: 4309.5962s
	iters: 200, epoch: 14 | loss: 0.0000030
	speed: 0.0373s/iter; left time: 639.3998s
	iters: 300, epoch: 14 | loss: 0.0027857
	speed: 0.0367s/iter; left time: 625.9294s
	iters: 400, epoch: 14 | loss: 0.0000043
	speed: 0.0282s/iter; left time: 477.6526s
Epoch: 14 cost time: 17.333324670791626
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000953
	speed: 0.2553s/iter; left time: 4285.8602s
	iters: 200, epoch: 15 | loss: 0.0000268
	speed: 0.0392s/iter; left time: 654.5229s
	iters: 300, epoch: 15 | loss: 0.0006626
	speed: 0.0384s/iter; left time: 636.5730s
	iters: 400, epoch: 15 | loss: 0.8525768
	speed: 0.0406s/iter; left time: 669.0656s
Epoch: 15 cost time: 19.048123836517334
Epoch: 15, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.288 Vali Acc: 0.972 Test Loss: 0.288 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0151828
	speed: 0.2521s/iter; left time: 4113.7874s
	iters: 200, epoch: 16 | loss: 0.0001526
	speed: 0.0404s/iter; left time: 654.4509s
	iters: 300, epoch: 16 | loss: 0.0000007
	speed: 0.0414s/iter; left time: 667.7737s
	iters: 400, epoch: 16 | loss: 0.0000058
	speed: 0.0408s/iter; left time: 652.8067s
Epoch: 16 cost time: 19.38124132156372
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.977 Test Loss: 0.174 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000048
	speed: 0.2509s/iter; left time: 3976.7548s
	iters: 200, epoch: 17 | loss: 0.0224458
	speed: 0.0422s/iter; left time: 665.1818s
	iters: 300, epoch: 17 | loss: 0.0052088
	speed: 0.0420s/iter; left time: 657.8718s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0408s/iter; left time: 633.6446s
Epoch: 17 cost time: 19.685686111450195
Epoch: 17, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.965 Test Loss: 0.275 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 585226
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5483878
	speed: 0.0514s/iter; left time: 1200.9720s
	iters: 200, epoch: 1 | loss: 0.1764005
	speed: 0.0384s/iter; left time: 892.0907s
	iters: 300, epoch: 1 | loss: 0.0278065
	speed: 0.0419s/iter; left time: 970.3986s
	iters: 400, epoch: 1 | loss: 0.0331450
	speed: 0.0426s/iter; left time: 980.9553s
Epoch: 1 cost time: 20.410327911376953
Epoch: 1, Steps: 469 | Train Loss: 0.314 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (inf --> -0.962548).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0460966
	speed: 0.2448s/iter; left time: 5601.0453s
	iters: 200, epoch: 2 | loss: 0.0073730
	speed: 0.0399s/iter; left time: 910.0517s
	iters: 300, epoch: 2 | loss: 0.0075729
	speed: 0.0404s/iter; left time: 915.2869s
	iters: 400, epoch: 2 | loss: 0.0009572
	speed: 0.0415s/iter; left time: 937.8087s
Epoch: 2 cost time: 19.170359134674072
Epoch: 2, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0581103
	speed: 0.2412s/iter; left time: 5407.0010s
	iters: 200, epoch: 3 | loss: 0.0357882
	speed: 0.0402s/iter; left time: 896.3129s
	iters: 300, epoch: 3 | loss: 0.0666052
	speed: 0.0400s/iter; left time: 888.9878s
	iters: 400, epoch: 3 | loss: 0.0252200
	speed: 0.0397s/iter; left time: 878.3016s
Epoch: 3 cost time: 19.01200819015503
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
Validation loss decreased (-0.962548 --> -0.969124).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1655834
	speed: 0.2448s/iter; left time: 5372.1862s
	iters: 200, epoch: 4 | loss: 0.0006355
	speed: 0.0411s/iter; left time: 897.6422s
	iters: 300, epoch: 4 | loss: 0.0026063
	speed: 0.0384s/iter; left time: 835.9620s
	iters: 400, epoch: 4 | loss: 0.0001132
	speed: 0.0389s/iter; left time: 841.0160s
Epoch: 4 cost time: 18.877914667129517
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
Validation loss decreased (-0.969124 --> -0.975699).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0024538
	speed: 0.2546s/iter; left time: 5467.7404s
	iters: 200, epoch: 5 | loss: 0.0006588
	speed: 0.0398s/iter; left time: 849.7844s
	iters: 300, epoch: 5 | loss: 0.0003599
	speed: 0.0377s/iter; left time: 802.1889s
	iters: 400, epoch: 5 | loss: 0.0086336
	speed: 0.0383s/iter; left time: 811.1712s
Epoch: 5 cost time: 18.763468742370605
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.283 Vali Acc: 0.947 Test Loss: 0.283 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1140433
	speed: 0.2552s/iter; left time: 5360.5024s
	iters: 200, epoch: 6 | loss: 0.0022601
	speed: 0.0397s/iter; left time: 829.4982s
	iters: 300, epoch: 6 | loss: 0.0159736
	speed: 0.0392s/iter; left time: 815.6620s
	iters: 400, epoch: 6 | loss: 0.0022607
	speed: 0.0411s/iter; left time: 850.9543s
Epoch: 6 cost time: 19.161114931106567
Epoch: 6, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0001309
	speed: 0.2487s/iter; left time: 5108.5479s
	iters: 200, epoch: 7 | loss: 0.0000120
	speed: 0.0417s/iter; left time: 851.5531s
	iters: 300, epoch: 7 | loss: 0.0083445
	speed: 0.0421s/iter; left time: 856.2919s
	iters: 400, epoch: 7 | loss: 0.0002823
	speed: 0.0413s/iter; left time: 834.8590s
Epoch: 7 cost time: 19.63009548187256
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.219 Vali Acc: 0.967 Test Loss: 0.219 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0005127
	speed: 0.2448s/iter; left time: 4912.6577s
	iters: 200, epoch: 8 | loss: 0.0272689
	speed: 0.0373s/iter; left time: 745.5606s
	iters: 300, epoch: 8 | loss: 0.0567984
	speed: 0.0357s/iter; left time: 708.3976s
	iters: 400, epoch: 8 | loss: 0.0278846
	speed: 0.0351s/iter; left time: 693.4046s
Epoch: 8 cost time: 17.584362030029297
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0180847
	speed: 0.2437s/iter; left time: 4775.4510s
	iters: 200, epoch: 9 | loss: 0.0002885
	speed: 0.0383s/iter; left time: 745.8909s
	iters: 300, epoch: 9 | loss: 0.0002707
	speed: 0.0386s/iter; left time: 747.8722s
	iters: 400, epoch: 9 | loss: 0.0005666
	speed: 0.0407s/iter; left time: 785.5245s
Epoch: 9 cost time: 18.8064706325531
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.305 Vali Acc: 0.963 Test Loss: 0.305 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2518719
	speed: 0.2396s/iter; left time: 4582.5993s
	iters: 200, epoch: 10 | loss: 0.0450154
	speed: 0.0406s/iter; left time: 771.7567s
	iters: 300, epoch: 10 | loss: 0.0003934
	speed: 0.0413s/iter; left time: 782.5951s
	iters: 400, epoch: 10 | loss: 0.0016376
	speed: 0.0412s/iter; left time: 776.5504s
Epoch: 10 cost time: 19.392704725265503
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.196 Vali Acc: 0.969 Test Loss: 0.196 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000061
	speed: 0.2405s/iter; left time: 4488.5069s
	iters: 200, epoch: 11 | loss: 0.0000521
	speed: 0.0422s/iter; left time: 782.9464s
	iters: 300, epoch: 11 | loss: 0.0000355
	speed: 0.0421s/iter; left time: 777.9645s
	iters: 400, epoch: 11 | loss: 0.0226390
	speed: 0.0407s/iter; left time: 747.3417s
Epoch: 11 cost time: 19.579776287078857
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000085
	speed: 0.2471s/iter; left time: 4495.9536s
	iters: 200, epoch: 12 | loss: 0.0001063
	speed: 0.0423s/iter; left time: 765.5670s
	iters: 300, epoch: 12 | loss: 0.0105323
	speed: 0.0391s/iter; left time: 704.0138s
	iters: 400, epoch: 12 | loss: 0.0003823
	speed: 0.0395s/iter; left time: 706.5738s
Epoch: 12 cost time: 19.348957538604736
Epoch: 12, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0000012
	speed: 0.2506s/iter; left time: 4441.6581s
	iters: 200, epoch: 13 | loss: 0.0789684
	speed: 0.0396s/iter; left time: 697.4145s
	iters: 300, epoch: 13 | loss: 0.0000031
	speed: 0.0393s/iter; left time: 688.9786s
	iters: 400, epoch: 13 | loss: 0.0001850
	speed: 0.0395s/iter; left time: 687.7265s
Epoch: 13 cost time: 19.070581912994385
Epoch: 13, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.949 Test Loss: 0.313 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000239
	speed: 0.2498s/iter; left time: 4310.8437s
	iters: 200, epoch: 14 | loss: 0.0000345
	speed: 0.0394s/iter; left time: 675.1193s
	iters: 300, epoch: 14 | loss: 0.0000089
	speed: 0.0406s/iter; left time: 692.8945s
	iters: 400, epoch: 14 | loss: 0.0000232
	speed: 0.0423s/iter; left time: 717.9730s
Epoch: 14 cost time: 19.251010417938232
Epoch: 14, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.291 Vali Acc: 0.957 Test Loss: 0.291 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9757004002287021
model parameter : 585482
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4796554
	speed: 0.0419s/iter; left time: 978.1895s
	iters: 200, epoch: 1 | loss: 0.5241680
	speed: 0.0294s/iter; left time: 684.7183s
	iters: 300, epoch: 1 | loss: 0.3985487
	speed: 0.0315s/iter; left time: 728.8118s
	iters: 400, epoch: 1 | loss: 0.0963155
	speed: 0.0313s/iter; left time: 721.7628s
Epoch: 1 cost time: 15.645135641098022
Epoch: 1, Steps: 469 | Train Loss: 0.452 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (inf --> -0.950255).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0727830
	speed: 0.2017s/iter; left time: 4614.6048s
	iters: 200, epoch: 2 | loss: 0.0106605
	speed: 0.0297s/iter; left time: 676.6201s
	iters: 300, epoch: 2 | loss: 0.0077761
	speed: 0.0293s/iter; left time: 664.3719s
	iters: 400, epoch: 2 | loss: 0.0586899
	speed: 0.0302s/iter; left time: 682.2517s
Epoch: 2 cost time: 14.459898710250854
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.950255 --> -0.969410).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0064623
	speed: 0.2006s/iter; left time: 4496.8578s
	iters: 200, epoch: 3 | loss: 0.0219774
	speed: 0.0311s/iter; left time: 692.8994s
	iters: 300, epoch: 3 | loss: 0.0553382
	speed: 0.0308s/iter; left time: 683.9959s
	iters: 400, epoch: 3 | loss: 0.0004301
	speed: 0.0303s/iter; left time: 671.0726s
Epoch: 3 cost time: 14.63526201248169
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0019318
	speed: 0.1994s/iter; left time: 4374.9132s
	iters: 200, epoch: 4 | loss: 0.0219229
	speed: 0.0290s/iter; left time: 632.9166s
	iters: 300, epoch: 4 | loss: 0.0957288
	speed: 0.0311s/iter; left time: 676.7604s
	iters: 400, epoch: 4 | loss: 0.0017245
	speed: 0.0316s/iter; left time: 684.7988s
Epoch: 4 cost time: 14.87432861328125
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0079560
	speed: 0.2028s/iter; left time: 4354.9512s
	iters: 200, epoch: 5 | loss: 0.0001993
	speed: 0.0318s/iter; left time: 680.6210s
	iters: 300, epoch: 5 | loss: 0.0192737
	speed: 0.0315s/iter; left time: 669.3982s
	iters: 400, epoch: 5 | loss: 0.1155845
	speed: 0.0314s/iter; left time: 665.8791s
Epoch: 5 cost time: 15.284910678863525
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0004384
	speed: 0.2017s/iter; left time: 4236.9320s
	iters: 200, epoch: 6 | loss: 0.0253321
	speed: 0.0313s/iter; left time: 653.7430s
	iters: 300, epoch: 6 | loss: 0.0001364
	speed: 0.0317s/iter; left time: 659.6211s
	iters: 400, epoch: 6 | loss: 0.0003520
	speed: 0.0318s/iter; left time: 657.5313s
Epoch: 6 cost time: 15.141279935836792
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0142367
	speed: 0.1983s/iter; left time: 4073.4697s
	iters: 200, epoch: 7 | loss: 0.0862771
	speed: 0.0288s/iter; left time: 588.7388s
	iters: 300, epoch: 7 | loss: 0.0056128
	speed: 0.0290s/iter; left time: 590.6831s
	iters: 400, epoch: 7 | loss: 0.0031292
	speed: 0.0303s/iter; left time: 613.6905s
Epoch: 7 cost time: 14.28712773323059
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0022551
	speed: 0.1987s/iter; left time: 3988.2626s
	iters: 200, epoch: 8 | loss: 0.0069422
	speed: 0.0300s/iter; left time: 599.4149s
	iters: 300, epoch: 8 | loss: 0.0012389
	speed: 0.0289s/iter; left time: 574.7149s
	iters: 400, epoch: 8 | loss: 0.0015932
	speed: 0.0298s/iter; left time: 588.1423s
Epoch: 8 cost time: 14.33747386932373
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.966 Test Loss: 0.196 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0107463
	speed: 0.1971s/iter; left time: 3863.5969s
	iters: 200, epoch: 9 | loss: 0.0000704
	speed: 0.0302s/iter; left time: 589.5219s
	iters: 300, epoch: 9 | loss: 0.0004640
	speed: 0.0309s/iter; left time: 599.4820s
	iters: 400, epoch: 9 | loss: 0.0002347
	speed: 0.0314s/iter; left time: 606.7943s
Epoch: 9 cost time: 14.871538400650024
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
Validation loss decreased (-0.973412 --> -0.973984).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0003977
	speed: 0.1913s/iter; left time: 3659.0609s
	iters: 200, epoch: 10 | loss: 0.0001171
	speed: 0.0299s/iter; left time: 569.0081s
	iters: 300, epoch: 10 | loss: 0.0001017
	speed: 0.0306s/iter; left time: 579.0706s
	iters: 400, epoch: 10 | loss: 0.0013927
	speed: 0.0317s/iter; left time: 596.4955s
Epoch: 10 cost time: 14.742908477783203
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.955 Test Loss: 0.214 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000162
	speed: 0.1912s/iter; left time: 3567.8373s
	iters: 200, epoch: 11 | loss: 0.0000471
	speed: 0.0284s/iter; left time: 526.2499s
	iters: 300, epoch: 11 | loss: 0.0033559
	speed: 0.0301s/iter; left time: 555.0461s
	iters: 400, epoch: 11 | loss: 0.0000370
	speed: 0.0323s/iter; left time: 593.9313s
Epoch: 11 cost time: 14.62960410118103
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0889047
	speed: 0.1924s/iter; left time: 3500.7055s
	iters: 200, epoch: 12 | loss: 0.0003694
	speed: 0.0290s/iter; left time: 523.9976s
	iters: 300, epoch: 12 | loss: 0.0006143
	speed: 0.0304s/iter; left time: 547.3163s
	iters: 400, epoch: 12 | loss: 0.0019991
	speed: 0.0327s/iter; left time: 585.4292s
Epoch: 12 cost time: 14.46834921836853
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.966 Test Loss: 0.262 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000410
	speed: 0.1956s/iter; left time: 3466.5391s
	iters: 200, epoch: 13 | loss: 0.0000167
	speed: 0.0291s/iter; left time: 512.3891s
	iters: 300, epoch: 13 | loss: 0.0005296
	speed: 0.0308s/iter; left time: 540.5814s
	iters: 400, epoch: 13 | loss: 0.0008590
	speed: 0.0319s/iter; left time: 554.9341s
Epoch: 13 cost time: 14.785518884658813
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.975127).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.4396802
	speed: 0.1976s/iter; left time: 3408.5873s
	iters: 200, epoch: 14 | loss: 0.1332782
	speed: 0.0317s/iter; left time: 543.2032s
	iters: 300, epoch: 14 | loss: 0.0008226
	speed: 0.0321s/iter; left time: 548.0908s
	iters: 400, epoch: 14 | loss: 0.0000248
	speed: 0.0315s/iter; left time: 534.4558s
Epoch: 14 cost time: 15.09038257598877
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0037985
	speed: 0.1937s/iter; left time: 3251.4906s
	iters: 200, epoch: 15 | loss: 0.0121022
	speed: 0.0298s/iter; left time: 496.8073s
	iters: 300, epoch: 15 | loss: 0.0009939
	speed: 0.0291s/iter; left time: 482.3283s
	iters: 400, epoch: 15 | loss: 0.0002097
	speed: 0.0315s/iter; left time: 520.0285s
Epoch: 15 cost time: 14.432491779327393
Epoch: 15, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.979 Test Loss: 0.148 Test Acc: 0.979
Validation loss decreased (-0.975127 --> -0.979415).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000030
	speed: 0.1696s/iter; left time: 2767.4657s
	iters: 200, epoch: 16 | loss: 0.0005943
	speed: 0.0284s/iter; left time: 460.5604s
	iters: 300, epoch: 16 | loss: 0.0046690
	speed: 0.0295s/iter; left time: 475.2343s
	iters: 400, epoch: 16 | loss: 0.0000332
	speed: 0.0309s/iter; left time: 495.6216s
Epoch: 16 cost time: 14.285853624343872
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0163389
	speed: 0.1896s/iter; left time: 3004.0032s
	iters: 200, epoch: 17 | loss: 0.0001728
	speed: 0.0299s/iter; left time: 470.8856s
	iters: 300, epoch: 17 | loss: 0.0150217
	speed: 0.0293s/iter; left time: 458.6158s
	iters: 400, epoch: 17 | loss: 0.0000501
	speed: 0.0321s/iter; left time: 498.4887s
Epoch: 17 cost time: 14.631171941757202
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.261 Vali Acc: 0.963 Test Loss: 0.261 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000122
	speed: 0.1936s/iter; left time: 2976.8850s
	iters: 200, epoch: 18 | loss: 0.0002863
	speed: 0.0261s/iter; left time: 399.3280s
	iters: 300, epoch: 18 | loss: 0.0000027
	speed: 0.0282s/iter; left time: 427.6526s
	iters: 400, epoch: 18 | loss: 0.0141892
	speed: 0.0294s/iter; left time: 442.6896s
Epoch: 18 cost time: 13.610472440719604
Epoch: 18, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0011147
	speed: 0.1947s/iter; left time: 2902.6273s
	iters: 200, epoch: 19 | loss: 0.0204616
	speed: 0.0291s/iter; left time: 430.9438s
	iters: 300, epoch: 19 | loss: 0.0010085
	speed: 0.0285s/iter; left time: 419.1428s
	iters: 400, epoch: 19 | loss: 0.0000075
	speed: 0.0265s/iter; left time: 386.7175s
Epoch: 19 cost time: 13.709789991378784
Epoch: 19, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.967 Test Loss: 0.218 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000530
	speed: 0.1914s/iter; left time: 2764.0791s
	iters: 200, epoch: 20 | loss: 0.0021935
	speed: 0.0312s/iter; left time: 447.8031s
	iters: 300, epoch: 20 | loss: 0.0016441
	speed: 0.0286s/iter; left time: 407.7813s
	iters: 400, epoch: 20 | loss: 0.0004101
	speed: 0.0287s/iter; left time: 405.8817s
Epoch: 20 cost time: 14.221859455108643
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000575
	speed: 0.1841s/iter; left time: 2571.4641s
	iters: 200, epoch: 21 | loss: 0.0009496
	speed: 0.0318s/iter; left time: 440.7627s
	iters: 300, epoch: 21 | loss: 0.0000262
	speed: 0.0320s/iter; left time: 441.2407s
	iters: 400, epoch: 21 | loss: 0.0002180
	speed: 0.0305s/iter; left time: 416.9447s
Epoch: 21 cost time: 14.961477994918823
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0093424
	speed: 0.1850s/iter; left time: 2498.5106s
	iters: 200, epoch: 22 | loss: 0.0010063
	speed: 0.0318s/iter; left time: 425.8726s
	iters: 300, epoch: 22 | loss: 0.1440824
	speed: 0.0319s/iter; left time: 424.2977s
	iters: 400, epoch: 22 | loss: 0.0000007
	speed: 0.0320s/iter; left time: 422.9653s
Epoch: 22 cost time: 15.292610883712769
Epoch: 22, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.970 Test Loss: 0.219 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000942
	speed: 0.1867s/iter; left time: 2433.7325s
	iters: 200, epoch: 23 | loss: 0.0000743
	speed: 0.0307s/iter; left time: 397.3461s
	iters: 300, epoch: 23 | loss: 0.0000065
	speed: 0.0318s/iter; left time: 407.6370s
	iters: 400, epoch: 23 | loss: 0.0002742
	speed: 0.0315s/iter; left time: 400.5052s
Epoch: 23 cost time: 14.948664426803589
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.267 Vali Acc: 0.970 Test Loss: 0.267 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000217
	speed: 0.1879s/iter; left time: 2361.1076s
	iters: 200, epoch: 24 | loss: 0.0064004
	speed: 0.0301s/iter; left time: 374.8457s
	iters: 300, epoch: 24 | loss: 0.0000501
	speed: 0.0304s/iter; left time: 375.8486s
	iters: 400, epoch: 24 | loss: 0.0001917
	speed: 0.0305s/iter; left time: 373.8453s
Epoch: 24 cost time: 14.478867053985596
Epoch: 24, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.967 Test Loss: 0.213 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.1296684
	speed: 0.1909s/iter; left time: 2309.0521s
	iters: 200, epoch: 25 | loss: 0.0007058
	speed: 0.0297s/iter; left time: 356.4880s
	iters: 300, epoch: 25 | loss: 0.4061043
	speed: 0.0304s/iter; left time: 361.3744s
	iters: 400, epoch: 25 | loss: 0.0002958
	speed: 0.0313s/iter; left time: 369.7189s
Epoch: 25 cost time: 14.539337635040283
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 161546
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8347464
	speed: 0.0436s/iter; left time: 1018.5648s
	iters: 200, epoch: 1 | loss: 0.3087729
	speed: 0.0308s/iter; left time: 716.5857s
	iters: 300, epoch: 1 | loss: 0.1066275
	speed: 0.0311s/iter; left time: 720.3245s
	iters: 400, epoch: 1 | loss: 0.0339740
	speed: 0.0310s/iter; left time: 714.9126s
Epoch: 1 cost time: 15.906726360321045
Epoch: 1, Steps: 469 | Train Loss: 0.445 Vali Loss: 0.242 Vali Acc: 0.939 Test Loss: 0.242 Test Acc: 0.939
Validation loss decreased (inf --> -0.939392).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0155225
	speed: 0.1910s/iter; left time: 4369.4884s
	iters: 200, epoch: 2 | loss: 1.2241269
	speed: 0.0332s/iter; left time: 755.8778s
	iters: 300, epoch: 2 | loss: 0.0084918
	speed: 0.0298s/iter; left time: 675.5832s
	iters: 400, epoch: 2 | loss: 0.0663059
	speed: 0.0308s/iter; left time: 696.0976s
Epoch: 2 cost time: 14.983585119247437
Epoch: 2, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.939392 --> -0.973126).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1108895
	speed: 0.1909s/iter; left time: 4277.8977s
	iters: 200, epoch: 3 | loss: 0.0284764
	speed: 0.0314s/iter; left time: 700.9320s
	iters: 300, epoch: 3 | loss: 0.0018383
	speed: 0.0326s/iter; left time: 724.9500s
	iters: 400, epoch: 3 | loss: 0.0041103
	speed: 0.0321s/iter; left time: 710.9193s
Epoch: 3 cost time: 15.172081708908081
Epoch: 3, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0077267
	speed: 0.1907s/iter; left time: 4183.7032s
	iters: 200, epoch: 4 | loss: 0.0025174
	speed: 0.0306s/iter; left time: 667.7636s
	iters: 300, epoch: 4 | loss: 0.0016824
	speed: 0.0311s/iter; left time: 675.9082s
	iters: 400, epoch: 4 | loss: 0.0908419
	speed: 0.0326s/iter; left time: 704.9772s
Epoch: 4 cost time: 15.159590005874634
Epoch: 4, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0018844
	speed: 0.1980s/iter; left time: 4252.2399s
	iters: 200, epoch: 5 | loss: 0.0052898
	speed: 0.0292s/iter; left time: 624.6509s
	iters: 300, epoch: 5 | loss: 0.0020993
	speed: 0.0283s/iter; left time: 601.4778s
	iters: 400, epoch: 5 | loss: 0.0042287
	speed: 0.0267s/iter; left time: 565.6031s
Epoch: 5 cost time: 13.563360214233398
Epoch: 5, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.966 Test Loss: 0.162 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0134001
	speed: 0.1734s/iter; left time: 3642.5446s
	iters: 200, epoch: 6 | loss: 0.0213369
	speed: 0.0293s/iter; left time: 612.1535s
	iters: 300, epoch: 6 | loss: 0.1325397
	speed: 0.0299s/iter; left time: 621.1209s
	iters: 400, epoch: 6 | loss: 0.0000390
	speed: 0.0315s/iter; left time: 652.5062s
Epoch: 6 cost time: 14.462315320968628
Epoch: 6, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0047632
	speed: 0.1881s/iter; left time: 3863.2025s
	iters: 200, epoch: 7 | loss: 0.0009084
	speed: 0.0296s/iter; left time: 605.0356s
	iters: 300, epoch: 7 | loss: 0.0003206
	speed: 0.0304s/iter; left time: 618.0585s
	iters: 400, epoch: 7 | loss: 0.0001666
	speed: 0.0315s/iter; left time: 637.9737s
Epoch: 7 cost time: 14.60228419303894
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0001104
	speed: 0.1888s/iter; left time: 3789.3586s
	iters: 200, epoch: 8 | loss: 0.0212490
	speed: 0.0291s/iter; left time: 581.9023s
	iters: 300, epoch: 8 | loss: 0.0008289
	speed: 0.0309s/iter; left time: 614.4323s
	iters: 400, epoch: 8 | loss: 0.0000822
	speed: 0.0312s/iter; left time: 616.2888s
Epoch: 8 cost time: 14.492618322372437
Epoch: 8, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.235 Vali Acc: 0.962 Test Loss: 0.235 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0002244
	speed: 0.1906s/iter; left time: 3735.1307s
	iters: 200, epoch: 9 | loss: 0.0002744
	speed: 0.0293s/iter; left time: 570.7326s
	iters: 300, epoch: 9 | loss: 0.0025647
	speed: 0.0300s/iter; left time: 581.0492s
	iters: 400, epoch: 9 | loss: 0.0146195
	speed: 0.0286s/iter; left time: 551.9934s
Epoch: 9 cost time: 14.179956912994385
Epoch: 9, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0002119
	speed: 0.1876s/iter; left time: 3589.1606s
	iters: 200, epoch: 10 | loss: 0.0002252
	speed: 0.0297s/iter; left time: 565.5951s
	iters: 300, epoch: 10 | loss: 0.0017173
	speed: 0.0299s/iter; left time: 565.7641s
	iters: 400, epoch: 10 | loss: 0.0010619
	speed: 0.0301s/iter; left time: 566.0212s
Epoch: 10 cost time: 14.336194038391113
Epoch: 10, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.966 Test Loss: 0.173 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.2151859
	speed: 0.1859s/iter; left time: 3469.2266s
	iters: 200, epoch: 11 | loss: 0.0000057
	speed: 0.0296s/iter; left time: 548.9632s
	iters: 300, epoch: 11 | loss: 0.0006840
	speed: 0.0306s/iter; left time: 564.1599s
	iters: 400, epoch: 11 | loss: 0.0046032
	speed: 0.0307s/iter; left time: 564.0904s
Epoch: 11 cost time: 14.586532354354858
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000189
	speed: 0.1846s/iter; left time: 3358.8925s
	iters: 200, epoch: 12 | loss: 0.0006938
	speed: 0.0298s/iter; left time: 538.6780s
	iters: 300, epoch: 12 | loss: 0.0003833
	speed: 0.0312s/iter; left time: 560.8290s
	iters: 400, epoch: 12 | loss: 0.0895942
	speed: 0.0316s/iter; left time: 565.5778s
Epoch: 12 cost time: 14.826860189437866
Epoch: 12, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.973126 --> -0.975127).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0722445
	speed: 0.1891s/iter; left time: 3352.1701s
	iters: 200, epoch: 13 | loss: 0.0003239
	speed: 0.0298s/iter; left time: 524.8799s
	iters: 300, epoch: 13 | loss: 0.0000214
	speed: 0.0316s/iter; left time: 552.8838s
	iters: 400, epoch: 13 | loss: 0.4799059
	speed: 0.0316s/iter; left time: 550.9486s
Epoch: 13 cost time: 14.883967876434326
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0593401
	speed: 0.1894s/iter; left time: 3268.7647s
	iters: 200, epoch: 14 | loss: 0.0000237
	speed: 0.0289s/iter; left time: 494.9456s
	iters: 300, epoch: 14 | loss: 0.0005607
	speed: 0.0307s/iter; left time: 523.2497s
	iters: 400, epoch: 14 | loss: 0.0001461
	speed: 0.0313s/iter; left time: 530.9722s
Epoch: 14 cost time: 14.49268388748169
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000260
	speed: 0.1894s/iter; left time: 3179.2190s
	iters: 200, epoch: 15 | loss: 0.0001320
	speed: 0.0294s/iter; left time: 490.2014s
	iters: 300, epoch: 15 | loss: 0.0001289
	speed: 0.0311s/iter; left time: 516.3420s
	iters: 400, epoch: 15 | loss: 0.0000888
	speed: 0.0305s/iter; left time: 502.3243s
Epoch: 15 cost time: 14.50649619102478
Epoch: 15, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
Validation loss decreased (-0.975127 --> -0.980559).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2898780
	speed: 0.1885s/iter; left time: 3075.5775s
	iters: 200, epoch: 16 | loss: 0.0000554
	speed: 0.0295s/iter; left time: 478.5941s
	iters: 300, epoch: 16 | loss: 0.0065942
	speed: 0.0314s/iter; left time: 506.1760s
	iters: 400, epoch: 16 | loss: 0.0043237
	speed: 0.0314s/iter; left time: 503.0973s
Epoch: 16 cost time: 14.646909236907959
Epoch: 16, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000683
	speed: 0.1873s/iter; left time: 2968.5431s
	iters: 200, epoch: 17 | loss: 0.0001409
	speed: 0.0299s/iter; left time: 471.5382s
	iters: 300, epoch: 17 | loss: 0.0000069
	speed: 0.0312s/iter; left time: 488.1183s
	iters: 400, epoch: 17 | loss: 0.0034406
	speed: 0.0315s/iter; left time: 489.0081s
Epoch: 17 cost time: 14.707199335098267
Epoch: 17, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0003341
	speed: 0.1822s/iter; left time: 2801.8946s
	iters: 200, epoch: 18 | loss: 0.0001238
	speed: 0.0294s/iter; left time: 449.1577s
	iters: 300, epoch: 18 | loss: 0.0383973
	speed: 0.0310s/iter; left time: 470.4143s
	iters: 400, epoch: 18 | loss: 0.0009686
	speed: 0.0311s/iter; left time: 468.4331s
Epoch: 18 cost time: 14.493507385253906
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.969 Test Loss: 0.202 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0018795
	speed: 0.1835s/iter; left time: 2736.0907s
	iters: 200, epoch: 19 | loss: 0.0000113
	speed: 0.0290s/iter; left time: 428.7420s
	iters: 300, epoch: 19 | loss: 0.0023716
	speed: 0.0309s/iter; left time: 454.4606s
	iters: 400, epoch: 19 | loss: 0.0004350
	speed: 0.0306s/iter; left time: 447.4095s
Epoch: 19 cost time: 14.219849586486816
Epoch: 19, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0160394
	speed: 0.1873s/iter; left time: 2705.1288s
	iters: 200, epoch: 20 | loss: 0.0003374
	speed: 0.0285s/iter; left time: 408.9495s
	iters: 300, epoch: 20 | loss: 0.0030960
	speed: 0.0305s/iter; left time: 434.3713s
	iters: 400, epoch: 20 | loss: 0.0000481
	speed: 0.0285s/iter; left time: 403.0654s
Epoch: 20 cost time: 14.16318941116333
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000157
	speed: 0.1897s/iter; left time: 2650.6821s
	iters: 200, epoch: 21 | loss: 0.0001214
	speed: 0.0301s/iter; left time: 417.0315s
	iters: 300, epoch: 21 | loss: 0.1283273
	speed: 0.0311s/iter; left time: 428.3460s
	iters: 400, epoch: 21 | loss: 0.0024795
	speed: 0.0311s/iter; left time: 424.9697s
Epoch: 21 cost time: 14.74423098564148
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.979 Test Loss: 0.175 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0001384
	speed: 0.1884s/iter; left time: 2544.3606s
	iters: 200, epoch: 22 | loss: 0.0000087
	speed: 0.0305s/iter; left time: 408.3311s
	iters: 300, epoch: 22 | loss: 0.0249475
	speed: 0.0318s/iter; left time: 422.4478s
	iters: 400, epoch: 22 | loss: 0.0017509
	speed: 0.0313s/iter; left time: 412.9765s
Epoch: 22 cost time: 14.79555869102478
Epoch: 22, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.972 Test Loss: 0.191 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0004165
	speed: 0.1860s/iter; left time: 2424.4393s
	iters: 200, epoch: 23 | loss: 0.0000013
	speed: 0.0304s/iter; left time: 392.5571s
	iters: 300, epoch: 23 | loss: 0.0314904
	speed: 0.0311s/iter; left time: 399.1835s
	iters: 400, epoch: 23 | loss: 0.0000321
	speed: 0.0315s/iter; left time: 401.0548s
Epoch: 23 cost time: 14.742582082748413
Epoch: 23, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0002499
	speed: 0.1864s/iter; left time: 2342.2791s
	iters: 200, epoch: 24 | loss: 0.0092857
	speed: 0.0306s/iter; left time: 381.8067s
	iters: 300, epoch: 24 | loss: 0.0012828
	speed: 0.0313s/iter; left time: 386.4472s
	iters: 400, epoch: 24 | loss: 0.0006759
	speed: 0.0313s/iter; left time: 383.3417s
Epoch: 24 cost time: 14.733467102050781
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.974 Test Loss: 0.208 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000074
	speed: 0.1874s/iter; left time: 2266.1304s
	iters: 200, epoch: 25 | loss: 0.0026848
	speed: 0.0300s/iter; left time: 359.9904s
	iters: 300, epoch: 25 | loss: 0.0000813
	speed: 0.0310s/iter; left time: 368.4875s
	iters: 400, epoch: 25 | loss: 0.2877394
	speed: 0.0313s/iter; left time: 369.0761s
Epoch: 25 cost time: 14.593760013580322
Epoch: 25, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.978 Test Loss: 0.190 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 161674
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0910431
	speed: 0.0448s/iter; left time: 1045.2250s
	iters: 200, epoch: 1 | loss: 0.2785459
	speed: 0.0275s/iter; left time: 639.0956s
	iters: 300, epoch: 1 | loss: 0.5200112
	speed: 0.0278s/iter; left time: 644.0392s
	iters: 400, epoch: 1 | loss: 0.1128875
	speed: 0.0278s/iter; left time: 641.4994s
Epoch: 1 cost time: 14.775500535964966
Epoch: 1, Steps: 469 | Train Loss: 0.641 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
Validation loss decreased (inf --> -0.923954).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8621069
	speed: 0.1799s/iter; left time: 4117.0467s
	iters: 200, epoch: 2 | loss: 0.0810266
	speed: 0.0268s/iter; left time: 609.9391s
	iters: 300, epoch: 2 | loss: 0.0905629
	speed: 0.0282s/iter; left time: 640.2137s
	iters: 400, epoch: 2 | loss: 0.1149042
	speed: 0.0281s/iter; left time: 633.6637s
Epoch: 2 cost time: 13.466333866119385
Epoch: 2, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
Validation loss decreased (-0.923954 --> -0.962834).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0506306
	speed: 0.1841s/iter; left time: 4126.5868s
	iters: 200, epoch: 3 | loss: 0.1643874
	speed: 0.0259s/iter; left time: 577.8834s
	iters: 300, epoch: 3 | loss: 0.0867167
	speed: 0.0254s/iter; left time: 564.5457s
	iters: 400, epoch: 3 | loss: 0.0762646
	speed: 0.0272s/iter; left time: 601.9014s
Epoch: 3 cost time: 12.996123790740967
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
Validation loss decreased (-0.962834 --> -0.964264).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0343613
	speed: 0.1864s/iter; left time: 4091.2458s
	iters: 200, epoch: 4 | loss: 0.0055890
	speed: 0.0284s/iter; left time: 620.1676s
	iters: 300, epoch: 4 | loss: 0.0027030
	speed: 0.0283s/iter; left time: 616.0693s
	iters: 400, epoch: 4 | loss: 0.0098730
	speed: 0.0277s/iter; left time: 598.7324s
Epoch: 4 cost time: 13.699176549911499
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
Validation loss decreased (-0.964264 --> -0.969124).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0223292
	speed: 0.1853s/iter; left time: 3978.7141s
	iters: 200, epoch: 5 | loss: 0.0035714
	speed: 0.0283s/iter; left time: 605.8907s
	iters: 300, epoch: 5 | loss: 0.0891415
	speed: 0.0283s/iter; left time: 602.3846s
	iters: 400, epoch: 5 | loss: 0.0831712
	speed: 0.0282s/iter; left time: 597.5189s
Epoch: 5 cost time: 13.789635419845581
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0247283
	speed: 0.1844s/iter; left time: 3873.5234s
	iters: 200, epoch: 6 | loss: 0.0084503
	speed: 0.0283s/iter; left time: 591.6714s
	iters: 300, epoch: 6 | loss: 0.0008736
	speed: 0.0283s/iter; left time: 589.0823s
	iters: 400, epoch: 6 | loss: 0.0001826
	speed: 0.0284s/iter; left time: 587.7212s
Epoch: 6 cost time: 13.743881940841675
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.969124 --> -0.975413).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0003387
	speed: 0.1717s/iter; left time: 3525.3045s
	iters: 200, epoch: 7 | loss: 0.0118743
	speed: 0.0258s/iter; left time: 526.4936s
	iters: 300, epoch: 7 | loss: 0.0069836
	speed: 0.0237s/iter; left time: 481.2384s
	iters: 400, epoch: 7 | loss: 0.0008591
	speed: 0.0282s/iter; left time: 570.1386s
Epoch: 7 cost time: 12.655714511871338
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0064803
	speed: 0.1797s/iter; left time: 3606.7211s
	iters: 200, epoch: 8 | loss: 0.0038099
	speed: 0.0268s/iter; left time: 535.7511s
	iters: 300, epoch: 8 | loss: 0.0003858
	speed: 0.0268s/iter; left time: 531.5214s
	iters: 400, epoch: 8 | loss: 0.0000356
	speed: 0.0284s/iter; left time: 562.1265s
Epoch: 8 cost time: 13.340431213378906
Epoch: 8, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0250290
	speed: 0.1753s/iter; left time: 3436.2149s
	iters: 200, epoch: 9 | loss: 0.0003351
	speed: 0.0276s/iter; left time: 538.4427s
	iters: 300, epoch: 9 | loss: 0.0242964
	speed: 0.0281s/iter; left time: 545.6921s
	iters: 400, epoch: 9 | loss: 0.0006155
	speed: 0.0282s/iter; left time: 543.7534s
Epoch: 9 cost time: 13.138859510421753
Epoch: 9, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.976842).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0023391
	speed: 0.1734s/iter; left time: 3316.7758s
	iters: 200, epoch: 10 | loss: 0.2642247
	speed: 0.0273s/iter; left time: 519.1201s
	iters: 300, epoch: 10 | loss: 0.0807008
	speed: 0.0257s/iter; left time: 485.8004s
	iters: 400, epoch: 10 | loss: 0.0201548
	speed: 0.0281s/iter; left time: 528.8974s
Epoch: 10 cost time: 13.11223840713501
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0453101
	speed: 0.1735s/iter; left time: 3237.4100s
	iters: 200, epoch: 11 | loss: 0.0005036
	speed: 0.0279s/iter; left time: 518.2062s
	iters: 300, epoch: 11 | loss: 0.0124328
	speed: 0.0288s/iter; left time: 531.8134s
	iters: 400, epoch: 11 | loss: 0.0092141
	speed: 0.0291s/iter; left time: 534.3710s
Epoch: 11 cost time: 13.671150922775269
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0473568
	speed: 0.1562s/iter; left time: 2841.6341s
	iters: 200, epoch: 12 | loss: 0.0021285
	speed: 0.0292s/iter; left time: 528.2628s
	iters: 300, epoch: 12 | loss: 0.0173346
	speed: 0.0290s/iter; left time: 522.0945s
	iters: 400, epoch: 12 | loss: 0.0001491
	speed: 0.0290s/iter; left time: 519.0091s
Epoch: 12 cost time: 13.866751432418823
Epoch: 12, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0011561
	speed: 0.1590s/iter; left time: 2817.2787s
	iters: 200, epoch: 13 | loss: 0.0050788
	speed: 0.0196s/iter; left time: 344.7295s
	iters: 300, epoch: 13 | loss: 0.0077834
	speed: 0.0210s/iter; left time: 367.2222s
	iters: 400, epoch: 13 | loss: 0.0070413
	speed: 0.0205s/iter; left time: 356.8286s
Epoch: 13 cost time: 9.597374200820923
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.973 Test Loss: 0.216 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0016616
	speed: 0.1161s/iter; left time: 2002.9488s
	iters: 200, epoch: 14 | loss: 0.0005471
	speed: 0.0210s/iter; left time: 359.5984s
	iters: 300, epoch: 14 | loss: 0.0024879
	speed: 0.0285s/iter; left time: 486.6926s
	iters: 400, epoch: 14 | loss: 0.0000494
	speed: 0.0290s/iter; left time: 490.9495s
Epoch: 14 cost time: 12.127474784851074
Epoch: 14, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976842 --> -0.977414).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0090932
	speed: 0.1761s/iter; left time: 2956.4013s
	iters: 200, epoch: 15 | loss: 0.0001371
	speed: 0.0292s/iter; left time: 486.6859s
	iters: 300, epoch: 15 | loss: 0.0186457
	speed: 0.0286s/iter; left time: 474.5580s
	iters: 400, epoch: 15 | loss: 0.0022414
	speed: 0.0286s/iter; left time: 472.1937s
Epoch: 15 cost time: 13.768786668777466
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0008945
	speed: 0.1742s/iter; left time: 2842.1440s
	iters: 200, epoch: 16 | loss: 0.0091624
	speed: 0.0292s/iter; left time: 473.0886s
	iters: 300, epoch: 16 | loss: 0.0000480
	speed: 0.0292s/iter; left time: 471.2521s
	iters: 400, epoch: 16 | loss: 0.0001093
	speed: 0.0289s/iter; left time: 463.2894s
Epoch: 16 cost time: 13.841387748718262
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0043379
	speed: 0.1667s/iter; left time: 2642.3660s
	iters: 200, epoch: 17 | loss: 0.0000922
	speed: 0.0291s/iter; left time: 458.7849s
	iters: 300, epoch: 17 | loss: 0.0103306
	speed: 0.0291s/iter; left time: 455.9146s
	iters: 400, epoch: 17 | loss: 0.0003316
	speed: 0.0291s/iter; left time: 451.7837s
Epoch: 17 cost time: 13.883575677871704
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0222766
	speed: 0.1733s/iter; left time: 2665.2075s
	iters: 200, epoch: 18 | loss: 0.0002579
	speed: 0.0290s/iter; left time: 442.5973s
	iters: 300, epoch: 18 | loss: 0.0004560
	speed: 0.0292s/iter; left time: 443.1602s
	iters: 400, epoch: 18 | loss: 0.0040134
	speed: 0.0291s/iter; left time: 438.9899s
Epoch: 18 cost time: 13.855846643447876
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.968 Test Loss: 0.218 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000474
	speed: 0.1752s/iter; left time: 2611.8106s
	iters: 200, epoch: 19 | loss: 0.0009713
	speed: 0.0290s/iter; left time: 429.7737s
	iters: 300, epoch: 19 | loss: 0.0019568
	speed: 0.0289s/iter; left time: 424.3611s
	iters: 400, epoch: 19 | loss: 0.0005723
	speed: 0.0292s/iter; left time: 425.9248s
Epoch: 19 cost time: 13.869819641113281
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000803
	speed: 0.1721s/iter; left time: 2484.6284s
	iters: 200, epoch: 20 | loss: 0.0002361
	speed: 0.0279s/iter; left time: 400.1606s
	iters: 300, epoch: 20 | loss: 0.0000236
	speed: 0.0278s/iter; left time: 396.0989s
	iters: 400, epoch: 20 | loss: 0.0068853
	speed: 0.0276s/iter; left time: 390.6830s
Epoch: 20 cost time: 13.34596061706543
Epoch: 20, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0090785
	speed: 0.1719s/iter; left time: 2400.9344s
	iters: 200, epoch: 21 | loss: 0.0008015
	speed: 0.0267s/iter; left time: 370.9307s
	iters: 300, epoch: 21 | loss: 0.0115580
	speed: 0.0285s/iter; left time: 392.9153s
	iters: 400, epoch: 21 | loss: 0.0004636
	speed: 0.0264s/iter; left time: 361.4030s
Epoch: 21 cost time: 13.135932922363281
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0001976
	speed: 0.1719s/iter; left time: 2321.6590s
	iters: 200, epoch: 22 | loss: 0.0018299
	speed: 0.0285s/iter; left time: 381.3189s
	iters: 300, epoch: 22 | loss: 0.0023277
	speed: 0.0286s/iter; left time: 380.2442s
	iters: 400, epoch: 22 | loss: 0.0064996
	speed: 0.0276s/iter; left time: 364.3990s
Epoch: 22 cost time: 13.372867584228516
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0052199
	speed: 0.1672s/iter; left time: 2178.6584s
	iters: 200, epoch: 23 | loss: 0.0044250
	speed: 0.0256s/iter; left time: 331.6463s
	iters: 300, epoch: 23 | loss: 0.1518888
	speed: 0.0261s/iter; left time: 334.9582s
	iters: 400, epoch: 23 | loss: 0.0000565
	speed: 0.0258s/iter; left time: 328.2387s
Epoch: 23 cost time: 12.556274890899658
Epoch: 23, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0017676
	speed: 0.1767s/iter; left time: 2219.4766s
	iters: 200, epoch: 24 | loss: 0.0106692
	speed: 0.0280s/iter; left time: 348.6721s
	iters: 300, epoch: 24 | loss: 0.0005046
	speed: 0.0280s/iter; left time: 345.8255s
	iters: 400, epoch: 24 | loss: 0.0002915
	speed: 0.0275s/iter; left time: 337.7532s
Epoch: 24 cost time: 13.376474857330322
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 48010
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9599749
	speed: 0.0417s/iter; left time: 973.8334s
	iters: 200, epoch: 1 | loss: 0.4081767
	speed: 0.0286s/iter; left time: 665.0835s
	iters: 300, epoch: 1 | loss: 0.0644664
	speed: 0.0284s/iter; left time: 656.4232s
	iters: 400, epoch: 1 | loss: 0.1490159
	speed: 0.0287s/iter; left time: 662.1560s
Epoch: 1 cost time: 14.665616512298584
Epoch: 1, Steps: 469 | Train Loss: 0.600 Vali Loss: 0.288 Vali Acc: 0.916 Test Loss: 0.288 Test Acc: 0.916
Validation loss decreased (inf --> -0.916235).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1279236
	speed: 0.1726s/iter; left time: 3949.6617s
	iters: 200, epoch: 2 | loss: 0.0838421
	speed: 0.0294s/iter; left time: 670.0860s
	iters: 300, epoch: 2 | loss: 0.1318715
	speed: 0.0286s/iter; left time: 649.2508s
	iters: 400, epoch: 2 | loss: 0.1324884
	speed: 0.0284s/iter; left time: 641.9572s
Epoch: 2 cost time: 13.851834297180176
Epoch: 2, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
Validation loss decreased (-0.916235 --> -0.964835).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0621606
	speed: 0.1821s/iter; left time: 4081.0607s
	iters: 200, epoch: 3 | loss: 0.0082751
	speed: 0.0281s/iter; left time: 627.5124s
	iters: 300, epoch: 3 | loss: 0.0210274
	speed: 0.0283s/iter; left time: 628.4498s
	iters: 400, epoch: 3 | loss: 0.1031979
	speed: 0.0287s/iter; left time: 634.5104s
Epoch: 3 cost time: 13.727640867233276
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
Validation loss decreased (-0.964835 --> -0.971983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1061376
	speed: 0.1784s/iter; left time: 3914.1555s
	iters: 200, epoch: 4 | loss: 0.0479073
	speed: 0.0271s/iter; left time: 591.3385s
	iters: 300, epoch: 4 | loss: 0.0122713
	speed: 0.0267s/iter; left time: 580.5373s
	iters: 400, epoch: 4 | loss: 0.0347509
	speed: 0.0268s/iter; left time: 581.1138s
Epoch: 4 cost time: 13.057531833648682
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0033355
	speed: 0.1766s/iter; left time: 3793.0703s
	iters: 200, epoch: 5 | loss: 0.0018618
	speed: 0.0279s/iter; left time: 596.0097s
	iters: 300, epoch: 5 | loss: 0.0101952
	speed: 0.0285s/iter; left time: 605.7317s
	iters: 400, epoch: 5 | loss: 0.0289806
	speed: 0.0281s/iter; left time: 594.6988s
Epoch: 5 cost time: 13.231500625610352
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.971983 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0561529
	speed: 0.1676s/iter; left time: 3520.3239s
	iters: 200, epoch: 6 | loss: 0.0024447
	speed: 0.0250s/iter; left time: 522.0162s
	iters: 300, epoch: 6 | loss: 0.0642183
	speed: 0.0277s/iter; left time: 576.7444s
	iters: 400, epoch: 6 | loss: 0.0006550
	speed: 0.0216s/iter; left time: 447.0540s
Epoch: 6 cost time: 11.739046812057495
Epoch: 6, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.975127).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0135833
	speed: 0.1771s/iter; left time: 3637.0148s
	iters: 200, epoch: 7 | loss: 0.0015342
	speed: 0.0276s/iter; left time: 563.7460s
	iters: 300, epoch: 7 | loss: 0.0037585
	speed: 0.0289s/iter; left time: 587.0364s
	iters: 400, epoch: 7 | loss: 0.0243781
	speed: 0.0288s/iter; left time: 583.5316s
Epoch: 7 cost time: 13.78695559501648
Epoch: 7, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0013192
	speed: 0.1822s/iter; left time: 3656.9036s
	iters: 200, epoch: 8 | loss: 0.0013015
	speed: 0.0291s/iter; left time: 580.4338s
	iters: 300, epoch: 8 | loss: 0.0012984
	speed: 0.0303s/iter; left time: 601.2752s
	iters: 400, epoch: 8 | loss: 0.0041218
	speed: 0.0299s/iter; left time: 590.6671s
Epoch: 8 cost time: 14.144441366195679
Epoch: 8, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975127 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0035779
	speed: 0.1797s/iter; left time: 3521.4517s
	iters: 200, epoch: 9 | loss: 0.0001683
	speed: 0.0294s/iter; left time: 574.1218s
	iters: 300, epoch: 9 | loss: 0.0082145
	speed: 0.0294s/iter; left time: 571.0725s
	iters: 400, epoch: 9 | loss: 0.0001834
	speed: 0.0296s/iter; left time: 570.6940s
Epoch: 9 cost time: 14.098631143569946
Epoch: 9, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0020354
	speed: 0.1782s/iter; left time: 3408.6144s
	iters: 200, epoch: 10 | loss: 0.0026111
	speed: 0.0296s/iter; left time: 562.3743s
	iters: 300, epoch: 10 | loss: 0.0001521
	speed: 0.0297s/iter; left time: 562.0708s
	iters: 400, epoch: 10 | loss: 0.0006436
	speed: 0.0293s/iter; left time: 550.9568s
Epoch: 10 cost time: 14.14777159690857
Epoch: 10, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0011533
	speed: 0.1776s/iter; left time: 3314.1695s
	iters: 200, epoch: 11 | loss: 0.0017309
	speed: 0.0293s/iter; left time: 543.4928s
	iters: 300, epoch: 11 | loss: 0.0011766
	speed: 0.0298s/iter; left time: 549.4150s
	iters: 400, epoch: 11 | loss: 0.0074950
	speed: 0.0297s/iter; left time: 544.8798s
Epoch: 11 cost time: 14.009012222290039
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000888
	speed: 0.1801s/iter; left time: 3277.1285s
	iters: 200, epoch: 12 | loss: 0.0004208
	speed: 0.0289s/iter; left time: 523.5241s
	iters: 300, epoch: 12 | loss: 0.0000485
	speed: 0.0268s/iter; left time: 482.4812s
	iters: 400, epoch: 12 | loss: 0.0000681
	speed: 0.0276s/iter; left time: 494.5167s
Epoch: 12 cost time: 13.491044044494629
Epoch: 12, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.975699 --> -0.976271).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0027794
	speed: 0.1766s/iter; left time: 3130.1451s
	iters: 200, epoch: 13 | loss: 0.0013858
	speed: 0.0285s/iter; left time: 501.7944s
	iters: 300, epoch: 13 | loss: 0.0004510
	speed: 0.0275s/iter; left time: 481.9169s
	iters: 400, epoch: 13 | loss: 0.0013476
	speed: 0.0272s/iter; left time: 473.2994s
Epoch: 13 cost time: 13.337864398956299
Epoch: 13, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
Validation loss decreased (-0.976271 --> -0.980559).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0023092
	speed: 0.1744s/iter; left time: 3009.4610s
	iters: 200, epoch: 14 | loss: 0.0003551
	speed: 0.0291s/iter; left time: 498.8875s
	iters: 300, epoch: 14 | loss: 0.0225737
	speed: 0.0281s/iter; left time: 479.4084s
	iters: 400, epoch: 14 | loss: 0.1093931
	speed: 0.0274s/iter; left time: 464.3446s
Epoch: 14 cost time: 13.506555557250977
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0004550
	speed: 0.1687s/iter; left time: 2831.2810s
	iters: 200, epoch: 15 | loss: 0.0005483
	speed: 0.0285s/iter; left time: 474.9141s
	iters: 300, epoch: 15 | loss: 0.0547687
	speed: 0.0286s/iter; left time: 475.1341s
	iters: 400, epoch: 15 | loss: 0.0002220
	speed: 0.0289s/iter; left time: 475.7008s
Epoch: 15 cost time: 12.950098991394043
Epoch: 15, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0024253
	speed: 0.1835s/iter; left time: 2994.4595s
	iters: 200, epoch: 16 | loss: 0.0013071
	speed: 0.0283s/iter; left time: 458.3099s
	iters: 300, epoch: 16 | loss: 0.0003926
	speed: 0.0290s/iter; left time: 467.8016s
	iters: 400, epoch: 16 | loss: 0.0000694
	speed: 0.0284s/iter; left time: 454.9936s
Epoch: 16 cost time: 13.74295949935913
Epoch: 16, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0001614
	speed: 0.1706s/iter; left time: 2703.6148s
	iters: 200, epoch: 17 | loss: 0.0004760
	speed: 0.0299s/iter; left time: 470.9792s
	iters: 300, epoch: 17 | loss: 0.0011049
	speed: 0.0299s/iter; left time: 468.3543s
	iters: 400, epoch: 17 | loss: 0.0080218
	speed: 0.0295s/iter; left time: 458.3157s
Epoch: 17 cost time: 13.935272693634033
Epoch: 17, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000084
	speed: 0.1805s/iter; left time: 2775.1567s
	iters: 200, epoch: 18 | loss: 0.0000233
	speed: 0.0293s/iter; left time: 448.2808s
	iters: 300, epoch: 18 | loss: 0.0106619
	speed: 0.0295s/iter; left time: 447.8563s
	iters: 400, epoch: 18 | loss: 0.0000887
	speed: 0.0292s/iter; left time: 440.6512s
Epoch: 18 cost time: 14.023711681365967
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0008531
	speed: 0.1821s/iter; left time: 2715.6213s
	iters: 200, epoch: 19 | loss: 0.0000247
	speed: 0.0290s/iter; left time: 430.0063s
	iters: 300, epoch: 19 | loss: 0.0013103
	speed: 0.0281s/iter; left time: 413.0485s
	iters: 400, epoch: 19 | loss: 0.0313937
	speed: 0.0283s/iter; left time: 414.0684s
Epoch: 19 cost time: 13.829973936080933
Epoch: 19, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.974 Test Loss: 0.185 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0519776
	speed: 0.1840s/iter; left time: 2656.8498s
	iters: 200, epoch: 20 | loss: 0.0000274
	speed: 0.0283s/iter; left time: 405.3704s
	iters: 300, epoch: 20 | loss: 0.0176842
	speed: 0.0284s/iter; left time: 404.6821s
	iters: 400, epoch: 20 | loss: 0.0000792
	speed: 0.0279s/iter; left time: 394.2051s
Epoch: 20 cost time: 13.602272748947144
Epoch: 20, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.958 Test Loss: 0.224 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000584
	speed: 0.1780s/iter; left time: 2486.4140s
	iters: 200, epoch: 21 | loss: 0.0033794
	speed: 0.0280s/iter; left time: 388.2887s
	iters: 300, epoch: 21 | loss: 0.0004556
	speed: 0.0281s/iter; left time: 386.7460s
	iters: 400, epoch: 21 | loss: 0.0011214
	speed: 0.0280s/iter; left time: 382.2447s
Epoch: 21 cost time: 13.5503089427948
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000435
	speed: 0.1765s/iter; left time: 2383.7361s
	iters: 200, epoch: 22 | loss: 0.0000285
	speed: 0.0245s/iter; left time: 328.3105s
	iters: 300, epoch: 22 | loss: 0.0000381
	speed: 0.0291s/iter; left time: 386.5364s
	iters: 400, epoch: 22 | loss: 0.0000798
	speed: 0.0293s/iter; left time: 386.5320s
Epoch: 22 cost time: 13.424078941345215
Epoch: 22, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000816
	speed: 0.1740s/iter; left time: 2268.1197s
	iters: 200, epoch: 23 | loss: 0.0111328
	speed: 0.0293s/iter; left time: 378.8860s
	iters: 300, epoch: 23 | loss: 0.0006310
	speed: 0.0290s/iter; left time: 372.2648s
	iters: 400, epoch: 23 | loss: 0.0002205
	speed: 0.0291s/iter; left time: 370.1235s
Epoch: 23 cost time: 13.88034200668335
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.966 Test Loss: 0.208 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 48074
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2723569
	speed: 0.0411s/iter; left time: 958.7672s
	iters: 200, epoch: 1 | loss: 0.9173619
	speed: 0.0281s/iter; left time: 652.7115s
	iters: 300, epoch: 1 | loss: 0.2126101
	speed: 0.0284s/iter; left time: 656.6223s
	iters: 400, epoch: 1 | loss: 0.3019091
	speed: 0.0289s/iter; left time: 666.7036s
Epoch: 1 cost time: 14.707667827606201
Epoch: 1, Steps: 469 | Train Loss: 0.878 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (inf --> -0.888504).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3399446
	speed: 0.1762s/iter; left time: 4031.6057s
	iters: 200, epoch: 2 | loss: 0.0973293
	speed: 0.0286s/iter; left time: 651.3379s
	iters: 300, epoch: 2 | loss: 0.0329744
	speed: 0.0285s/iter; left time: 647.4114s
	iters: 400, epoch: 2 | loss: 0.0218201
	speed: 0.0289s/iter; left time: 651.8978s
Epoch: 2 cost time: 13.688694477081299
Epoch: 2, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.191 Vali Acc: 0.947 Test Loss: 0.191 Test Acc: 0.947
Validation loss decreased (-0.888504 --> -0.947397).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0988635
	speed: 0.1749s/iter; left time: 3919.2146s
	iters: 200, epoch: 3 | loss: 0.0194075
	speed: 0.0291s/iter; left time: 648.8230s
	iters: 300, epoch: 3 | loss: 0.1480869
	speed: 0.0288s/iter; left time: 640.3672s
	iters: 400, epoch: 3 | loss: 0.0454585
	speed: 0.0288s/iter; left time: 636.4290s
Epoch: 3 cost time: 13.68569302558899
Epoch: 3, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
Validation loss decreased (-0.947397 --> -0.955115).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0036706
	speed: 0.1755s/iter; left time: 3851.0060s
	iters: 200, epoch: 4 | loss: 0.0068769
	speed: 0.0286s/iter; left time: 625.5922s
	iters: 300, epoch: 4 | loss: 0.0446060
	speed: 0.0280s/iter; left time: 607.8609s
	iters: 400, epoch: 4 | loss: 0.0714705
	speed: 0.0279s/iter; left time: 602.9668s
Epoch: 4 cost time: 13.457849740982056
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
Validation loss decreased (-0.955115 --> -0.967122).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0031366
	speed: 0.1785s/iter; left time: 3832.7401s
	iters: 200, epoch: 5 | loss: 0.0209298
	speed: 0.0279s/iter; left time: 596.4646s
	iters: 300, epoch: 5 | loss: 0.0203723
	speed: 0.0275s/iter; left time: 585.4668s
	iters: 400, epoch: 5 | loss: 0.4926138
	speed: 0.0266s/iter; left time: 562.5422s
Epoch: 5 cost time: 13.237501859664917
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.967122 --> -0.970267).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0041897
	speed: 0.1725s/iter; left time: 3624.3923s
	iters: 200, epoch: 6 | loss: 0.0762842
	speed: 0.0275s/iter; left time: 574.5929s
	iters: 300, epoch: 6 | loss: 0.0580733
	speed: 0.0268s/iter; left time: 557.2829s
	iters: 400, epoch: 6 | loss: 0.0089268
	speed: 0.0268s/iter; left time: 554.2596s
Epoch: 6 cost time: 13.009838819503784
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.970267 --> -0.971696).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0565272
	speed: 0.1712s/iter; left time: 3515.4049s
	iters: 200, epoch: 7 | loss: 0.4094960
	speed: 0.0234s/iter; left time: 478.3631s
	iters: 300, epoch: 7 | loss: 0.0010596
	speed: 0.0272s/iter; left time: 553.5851s
	iters: 400, epoch: 7 | loss: 0.0059487
	speed: 0.0279s/iter; left time: 564.0204s
Epoch: 7 cost time: 12.746898174285889
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.187 Vali Acc: 0.964 Test Loss: 0.187 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0650583
	speed: 0.1701s/iter; left time: 3414.4572s
	iters: 200, epoch: 8 | loss: 0.0106931
	speed: 0.0275s/iter; left time: 548.2718s
	iters: 300, epoch: 8 | loss: 0.0031665
	speed: 0.0280s/iter; left time: 556.0761s
	iters: 400, epoch: 8 | loss: 0.0027254
	speed: 0.0282s/iter; left time: 557.2213s
Epoch: 8 cost time: 13.042333841323853
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.2510090
	speed: 0.1515s/iter; left time: 2969.4914s
	iters: 200, epoch: 9 | loss: 0.0731720
	speed: 0.0289s/iter; left time: 563.2413s
	iters: 300, epoch: 9 | loss: 0.0099226
	speed: 0.0293s/iter; left time: 567.8813s
	iters: 400, epoch: 9 | loss: 0.0815316
	speed: 0.0293s/iter; left time: 565.1533s
Epoch: 9 cost time: 13.706863403320312
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
Validation loss decreased (-0.971696 --> -0.975699).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0128195
	speed: 0.1747s/iter; left time: 3342.5580s
	iters: 200, epoch: 10 | loss: 0.0376239
	speed: 0.0244s/iter; left time: 464.4297s
	iters: 300, epoch: 10 | loss: 0.0014876
	speed: 0.0247s/iter; left time: 466.7383s
	iters: 400, epoch: 10 | loss: 0.1688213
	speed: 0.0249s/iter; left time: 469.3810s
Epoch: 10 cost time: 11.500322341918945
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0793947
	speed: 0.1461s/iter; left time: 2725.4607s
	iters: 200, epoch: 11 | loss: 0.0121588
	speed: 0.0284s/iter; left time: 527.3321s
	iters: 300, epoch: 11 | loss: 0.4743409
	speed: 0.0275s/iter; left time: 508.4703s
	iters: 400, epoch: 11 | loss: 0.0014874
	speed: 0.0275s/iter; left time: 504.9830s
Epoch: 11 cost time: 13.327500104904175
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0525224
	speed: 0.1729s/iter; left time: 3145.4210s
	iters: 200, epoch: 12 | loss: 0.0002921
	speed: 0.0265s/iter; left time: 479.0626s
	iters: 300, epoch: 12 | loss: 0.0092737
	speed: 0.0273s/iter; left time: 492.0513s
	iters: 400, epoch: 12 | loss: 0.0073511
	speed: 0.0272s/iter; left time: 486.4993s
Epoch: 12 cost time: 12.999840021133423
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1634644
	speed: 0.1746s/iter; left time: 3094.5432s
	iters: 200, epoch: 13 | loss: 0.0016587
	speed: 0.0256s/iter; left time: 451.4105s
	iters: 300, epoch: 13 | loss: 0.0009585
	speed: 0.0261s/iter; left time: 456.4836s
	iters: 400, epoch: 13 | loss: 0.0014888
	speed: 0.0269s/iter; left time: 469.3883s
Epoch: 13 cost time: 12.7612943649292
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.188 Vali Acc: 0.969 Test Loss: 0.188 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1533236
	speed: 0.1746s/iter; left time: 3013.2120s
	iters: 200, epoch: 14 | loss: 0.0849323
	speed: 0.0268s/iter; left time: 459.3887s
	iters: 300, epoch: 14 | loss: 0.0435291
	speed: 0.0259s/iter; left time: 442.2901s
	iters: 400, epoch: 14 | loss: 0.0063121
	speed: 0.0240s/iter; left time: 406.7055s
Epoch: 14 cost time: 12.464633464813232
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0016753
	speed: 0.1668s/iter; left time: 2799.0398s
	iters: 200, epoch: 15 | loss: 0.0038514
	speed: 0.0274s/iter; left time: 456.5694s
	iters: 300, epoch: 15 | loss: 0.0910316
	speed: 0.0274s/iter; left time: 454.3703s
	iters: 400, epoch: 15 | loss: 0.0015661
	speed: 0.0265s/iter; left time: 437.0089s
Epoch: 15 cost time: 12.860904932022095
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
Validation loss decreased (-0.975699 --> -0.975985).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0030002
	speed: 0.1604s/iter; left time: 2617.0687s
	iters: 200, epoch: 16 | loss: 0.0927019
	speed: 0.0278s/iter; left time: 451.4842s
	iters: 300, epoch: 16 | loss: 0.0008229
	speed: 0.0276s/iter; left time: 444.6636s
	iters: 400, epoch: 16 | loss: 0.0000523
	speed: 0.0275s/iter; left time: 440.8503s
Epoch: 16 cost time: 13.091067552566528
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0058356
	speed: 0.1601s/iter; left time: 2537.3270s
	iters: 200, epoch: 17 | loss: 0.0020552
	speed: 0.0285s/iter; left time: 448.5563s
	iters: 300, epoch: 17 | loss: 0.0012410
	speed: 0.0282s/iter; left time: 440.9179s
	iters: 400, epoch: 17 | loss: 0.4155060
	speed: 0.0272s/iter; left time: 422.5816s
Epoch: 17 cost time: 13.051744937896729
Epoch: 17, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.975985).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0004211
	speed: 0.1718s/iter; left time: 2641.2215s
	iters: 200, epoch: 18 | loss: 0.0070098
	speed: 0.0280s/iter; left time: 427.5746s
	iters: 300, epoch: 18 | loss: 0.0002966
	speed: 0.0275s/iter; left time: 417.2895s
	iters: 400, epoch: 18 | loss: 0.0088143
	speed: 0.0270s/iter; left time: 407.7040s
Epoch: 18 cost time: 13.270855188369751
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.965 Test Loss: 0.201 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0349499
	speed: 0.1717s/iter; left time: 2559.1798s
	iters: 200, epoch: 19 | loss: 0.0002386
	speed: 0.0273s/iter; left time: 404.8891s
	iters: 300, epoch: 19 | loss: 0.0052469
	speed: 0.0272s/iter; left time: 400.4727s
	iters: 400, epoch: 19 | loss: 0.0009176
	speed: 0.0274s/iter; left time: 400.5427s
Epoch: 19 cost time: 13.021819353103638
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000768
	speed: 0.1700s/iter; left time: 2454.8889s
	iters: 200, epoch: 20 | loss: 0.0004581
	speed: 0.0261s/iter; left time: 374.1791s
	iters: 300, epoch: 20 | loss: 0.0004188
	speed: 0.0264s/iter; left time: 375.7364s
	iters: 400, epoch: 20 | loss: 0.0012230
	speed: 0.0281s/iter; left time: 397.4055s
Epoch: 20 cost time: 12.593955755233765
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.184 Vali Acc: 0.974 Test Loss: 0.184 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0001153
	speed: 0.1751s/iter; left time: 2446.7465s
	iters: 200, epoch: 21 | loss: 0.0019372
	speed: 0.0257s/iter; left time: 356.3688s
	iters: 300, epoch: 21 | loss: 0.0006302
	speed: 0.0270s/iter; left time: 372.2976s
	iters: 400, epoch: 21 | loss: 0.0132297
	speed: 0.0276s/iter; left time: 377.6151s
Epoch: 21 cost time: 13.058660984039307
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.153 Vali Acc: 0.978 Test Loss: 0.153 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.977986).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001087
	speed: 0.1730s/iter; left time: 2335.4542s
	iters: 200, epoch: 22 | loss: 0.0016730
	speed: 0.0286s/iter; left time: 383.3944s
	iters: 300, epoch: 22 | loss: 0.0002698
	speed: 0.0276s/iter; left time: 366.7906s
	iters: 400, epoch: 22 | loss: 0.0162347
	speed: 0.0270s/iter; left time: 357.0507s
Epoch: 22 cost time: 13.2625892162323
Epoch: 22, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003017
	speed: 0.1624s/iter; left time: 2116.2516s
	iters: 200, epoch: 23 | loss: 0.0114601
	speed: 0.0276s/iter; left time: 357.1368s
	iters: 300, epoch: 23 | loss: 0.0005231
	speed: 0.0273s/iter; left time: 349.9946s
	iters: 400, epoch: 23 | loss: 0.0003631
	speed: 0.0269s/iter; left time: 342.1432s
Epoch: 23 cost time: 12.90095329284668
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
Validation loss decreased (-0.977986 --> -0.977986).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0155200
	speed: 0.1583s/iter; left time: 1988.3449s
	iters: 200, epoch: 24 | loss: 0.0025172
	speed: 0.0244s/iter; left time: 303.6133s
	iters: 300, epoch: 24 | loss: 0.0000825
	speed: 0.0248s/iter; left time: 306.7808s
	iters: 400, epoch: 24 | loss: 0.0004769
	speed: 0.0252s/iter; left time: 309.5516s
Epoch: 24 cost time: 11.892637491226196
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.977 Test Loss: 0.197 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0001952
	speed: 0.1663s/iter; left time: 2011.5283s
	iters: 200, epoch: 25 | loss: 0.0007074
	speed: 0.0266s/iter; left time: 319.3671s
	iters: 300, epoch: 25 | loss: 0.0000026
	speed: 0.0252s/iter; left time: 299.7803s
	iters: 400, epoch: 25 | loss: 0.0049306
	speed: 0.0255s/iter; left time: 300.3824s
Epoch: 25 cost time: 12.648144245147705
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.221 Vali Acc: 0.969 Test Loss: 0.221 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000168
	speed: 0.1726s/iter; left time: 2006.1714s
	iters: 200, epoch: 26 | loss: 0.0081258
	speed: 0.0274s/iter; left time: 316.0591s
	iters: 300, epoch: 26 | loss: 0.0085394
	speed: 0.0286s/iter; left time: 326.8127s
	iters: 400, epoch: 26 | loss: 0.0108040
	speed: 0.0285s/iter; left time: 322.2646s
Epoch: 26 cost time: 13.456568479537964
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.969 Test Loss: 0.212 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000433
	speed: 0.1716s/iter; left time: 1914.0252s
	iters: 200, epoch: 27 | loss: 0.0109153
	speed: 0.0279s/iter; left time: 308.2671s
	iters: 300, epoch: 27 | loss: 0.0107853
	speed: 0.0289s/iter; left time: 316.1907s
	iters: 400, epoch: 27 | loss: 0.0000103
	speed: 0.0286s/iter; left time: 310.7090s
Epoch: 27 cost time: 13.41879653930664
Epoch: 27, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0022582
	speed: 0.1727s/iter; left time: 1845.9539s
	iters: 200, epoch: 28 | loss: 0.0504302
	speed: 0.0271s/iter; left time: 287.2965s
	iters: 300, epoch: 28 | loss: 0.0021652
	speed: 0.0275s/iter; left time: 288.1654s
	iters: 400, epoch: 28 | loss: 0.0015992
	speed: 0.0273s/iter; left time: 283.5126s
Epoch: 28 cost time: 13.118171691894531
Epoch: 28, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.178 Vali Acc: 0.979 Test Loss: 0.178 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978557).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0027345
	speed: 0.1771s/iter; left time: 1809.8524s
	iters: 200, epoch: 29 | loss: 0.0043848
	speed: 0.0276s/iter; left time: 279.4689s
	iters: 300, epoch: 29 | loss: 0.0065373
	speed: 0.0259s/iter; left time: 259.5453s
	iters: 400, epoch: 29 | loss: 0.0004605
	speed: 0.0261s/iter; left time: 259.2881s
Epoch: 29 cost time: 12.931479454040527
Epoch: 29, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000143
	speed: 0.1726s/iter; left time: 1682.4960s
	iters: 200, epoch: 30 | loss: 0.0043520
	speed: 0.0284s/iter; left time: 273.6144s
	iters: 300, epoch: 30 | loss: 0.0001548
	speed: 0.0283s/iter; left time: 269.9694s
	iters: 400, epoch: 30 | loss: 0.0010244
	speed: 0.0274s/iter; left time: 259.0003s
Epoch: 30 cost time: 13.41256856918335
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.976 Test Loss: 0.220 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000913
	speed: 0.1759s/iter; left time: 1632.4260s
	iters: 200, epoch: 31 | loss: 0.0000216
	speed: 0.0275s/iter; left time: 252.8674s
	iters: 300, epoch: 31 | loss: 0.0000343
	speed: 0.0275s/iter; left time: 250.0258s
	iters: 400, epoch: 31 | loss: 0.0005470
	speed: 0.0289s/iter; left time: 259.6438s
Epoch: 31 cost time: 13.143125057220459
Epoch: 31, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0005984
	speed: 0.1729s/iter; left time: 1523.5819s
	iters: 200, epoch: 32 | loss: 0.0001401
	speed: 0.0279s/iter; left time: 242.8860s
	iters: 300, epoch: 32 | loss: 0.0002068
	speed: 0.0284s/iter; left time: 244.9507s
	iters: 400, epoch: 32 | loss: 0.0024321
	speed: 0.0258s/iter; left time: 219.5785s
Epoch: 32 cost time: 13.267590522766113
Epoch: 32, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000918
	speed: 0.1711s/iter; left time: 1427.6929s
	iters: 200, epoch: 33 | loss: 0.0028720
	speed: 0.0287s/iter; left time: 236.9771s
	iters: 300, epoch: 33 | loss: 0.0033164
	speed: 0.0287s/iter; left time: 233.8215s
	iters: 400, epoch: 33 | loss: 0.0000775
	speed: 0.0283s/iter; left time: 227.3177s
Epoch: 33 cost time: 13.634507417678833
Epoch: 33, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000319
	speed: 0.1714s/iter; left time: 1349.6581s
	iters: 200, epoch: 34 | loss: 0.0008300
	speed: 0.0288s/iter; left time: 223.5886s
	iters: 300, epoch: 34 | loss: 0.0151716
	speed: 0.0282s/iter; left time: 216.5787s
	iters: 400, epoch: 34 | loss: 0.0000267
	speed: 0.0282s/iter; left time: 213.7199s
Epoch: 34 cost time: 13.694884061813354
Epoch: 34, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.973 Test Loss: 0.248 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0000934
	speed: 0.1802s/iter; left time: 1334.6173s
	iters: 200, epoch: 35 | loss: 0.0003288
	speed: 0.0269s/iter; left time: 196.3554s
	iters: 300, epoch: 35 | loss: 0.0002297
	speed: 0.0273s/iter; left time: 196.5354s
	iters: 400, epoch: 35 | loss: 0.0026227
	speed: 0.0285s/iter; left time: 202.7363s
Epoch: 35 cost time: 13.293724775314331
Epoch: 35, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.977 Test Loss: 0.193 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000117
	speed: 0.1811s/iter; left time: 1256.0957s
	iters: 200, epoch: 36 | loss: 0.0000010
	speed: 0.0273s/iter; left time: 186.4614s
	iters: 300, epoch: 36 | loss: 0.0000556
	speed: 0.0275s/iter; left time: 184.9083s
	iters: 400, epoch: 36 | loss: 0.0002022
	speed: 0.0281s/iter; left time: 186.3310s
Epoch: 36 cost time: 13.373040199279785
Epoch: 36, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0008176
	speed: 0.1793s/iter; left time: 1159.6574s
	iters: 200, epoch: 37 | loss: 0.0000017
	speed: 0.0283s/iter; left time: 179.9538s
	iters: 300, epoch: 37 | loss: 0.0002516
	speed: 0.0294s/iter; left time: 184.2786s
	iters: 400, epoch: 37 | loss: 0.0565978
	speed: 0.0283s/iter; left time: 174.4351s
Epoch: 37 cost time: 13.665196418762207
Epoch: 37, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.977 Test Loss: 0.185 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0814173
	speed: 0.1646s/iter; left time: 987.5501s
	iters: 200, epoch: 38 | loss: 0.0003151
	speed: 0.0251s/iter; left time: 148.3244s
	iters: 300, epoch: 38 | loss: 0.0081584
	speed: 0.0261s/iter; left time: 151.4381s
	iters: 400, epoch: 38 | loss: 0.0023453
	speed: 0.0257s/iter; left time: 146.4963s
Epoch: 38 cost time: 12.141583919525146
Epoch: 38, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.976 Test Loss: 0.193 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 15818
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3866726
	speed: 0.0471s/iter; left time: 1098.6689s
	iters: 200, epoch: 1 | loss: 0.7888509
	speed: 0.0349s/iter; left time: 811.6090s
	iters: 300, epoch: 1 | loss: 0.3371836
	speed: 0.0347s/iter; left time: 802.5635s
	iters: 400, epoch: 1 | loss: 0.4777918
	speed: 0.0348s/iter; left time: 801.8315s
Epoch: 1 cost time: 17.595007181167603
Epoch: 1, Steps: 469 | Train Loss: 0.879 Vali Loss: 0.394 Vali Acc: 0.889 Test Loss: 0.394 Test Acc: 0.889
Validation loss decreased (inf --> -0.889076).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1133392
	speed: 0.2156s/iter; left time: 4933.2217s
	iters: 200, epoch: 2 | loss: 0.2042426
	speed: 0.0305s/iter; left time: 694.2367s
	iters: 300, epoch: 2 | loss: 0.1708483
	speed: 0.0310s/iter; left time: 703.3733s
	iters: 400, epoch: 2 | loss: 0.1355274
	speed: 0.0308s/iter; left time: 694.4246s
Epoch: 2 cost time: 14.90631890296936
Epoch: 2, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.221 Vali Acc: 0.936 Test Loss: 0.221 Test Acc: 0.936
Validation loss decreased (-0.889076 --> -0.935675).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0346042
	speed: 0.1961s/iter; left time: 4394.1046s
	iters: 200, epoch: 3 | loss: 0.5913752
	speed: 0.0345s/iter; left time: 770.0576s
	iters: 300, epoch: 3 | loss: 0.0028063
	speed: 0.0350s/iter; left time: 776.4384s
	iters: 400, epoch: 3 | loss: 0.0364556
	speed: 0.0347s/iter; left time: 766.9280s
Epoch: 3 cost time: 16.43468427658081
Epoch: 3, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
Validation loss decreased (-0.935675 --> -0.961405).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1847088
	speed: 0.2151s/iter; left time: 4720.1597s
	iters: 200, epoch: 4 | loss: 0.1173560
	speed: 0.0344s/iter; left time: 751.4072s
	iters: 300, epoch: 4 | loss: 0.0130010
	speed: 0.0348s/iter; left time: 756.2244s
	iters: 400, epoch: 4 | loss: 0.0241961
	speed: 0.0351s/iter; left time: 760.2914s
Epoch: 4 cost time: 16.580294609069824
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
Validation loss decreased (-0.961405 --> -0.964835).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3617381
	speed: 0.2056s/iter; left time: 4415.0186s
	iters: 200, epoch: 5 | loss: 0.1611994
	speed: 0.0310s/iter; left time: 662.2363s
	iters: 300, epoch: 5 | loss: 0.0378875
	speed: 0.0306s/iter; left time: 651.7713s
	iters: 400, epoch: 5 | loss: 0.3533121
	speed: 0.0311s/iter; left time: 658.3827s
Epoch: 5 cost time: 14.514179229736328
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.964835 --> -0.968552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0597575
	speed: 0.2127s/iter; left time: 4468.9816s
	iters: 200, epoch: 6 | loss: 0.0580207
	speed: 0.0353s/iter; left time: 738.2538s
	iters: 300, epoch: 6 | loss: 0.0221608
	speed: 0.0343s/iter; left time: 713.0306s
	iters: 400, epoch: 6 | loss: 0.0058310
	speed: 0.0342s/iter; left time: 707.2478s
Epoch: 6 cost time: 16.54350185394287
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
Validation loss decreased (-0.968552 --> -0.973698).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0049143
	speed: 0.2203s/iter; left time: 4524.4989s
	iters: 200, epoch: 7 | loss: 0.0031356
	speed: 0.0351s/iter; left time: 717.0979s
	iters: 300, epoch: 7 | loss: 0.2827644
	speed: 0.0354s/iter; left time: 720.2486s
	iters: 400, epoch: 7 | loss: 0.0084937
	speed: 0.0317s/iter; left time: 641.8983s
Epoch: 7 cost time: 16.122111082077026
Epoch: 7, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0408992
	speed: 0.1985s/iter; left time: 3982.8691s
	iters: 200, epoch: 8 | loss: 0.0043314
	speed: 0.0315s/iter; left time: 629.9351s
	iters: 300, epoch: 8 | loss: 0.0043514
	speed: 0.0354s/iter; left time: 703.9051s
	iters: 400, epoch: 8 | loss: 0.0091087
	speed: 0.0352s/iter; left time: 695.6354s
Epoch: 8 cost time: 16.063389778137207
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.974556).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3114744
	speed: 0.2196s/iter; left time: 4303.6153s
	iters: 200, epoch: 9 | loss: 0.2020895
	speed: 0.0355s/iter; left time: 691.2497s
	iters: 300, epoch: 9 | loss: 0.0084834
	speed: 0.0353s/iter; left time: 685.4537s
	iters: 400, epoch: 9 | loss: 0.0026542
	speed: 0.0352s/iter; left time: 679.7332s
Epoch: 9 cost time: 16.926156520843506
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0022524
	speed: 0.2103s/iter; left time: 4023.6466s
	iters: 200, epoch: 10 | loss: 0.0138679
	speed: 0.0314s/iter; left time: 597.0054s
	iters: 300, epoch: 10 | loss: 0.0213228
	speed: 0.0312s/iter; left time: 590.0387s
	iters: 400, epoch: 10 | loss: 0.0196739
	speed: 0.0302s/iter; left time: 569.5551s
Epoch: 10 cost time: 14.862514734268188
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.974841).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0314661
	speed: 0.2022s/iter; left time: 3772.7520s
	iters: 200, epoch: 11 | loss: 0.0028442
	speed: 0.0324s/iter; left time: 601.5290s
	iters: 300, epoch: 11 | loss: 0.0110551
	speed: 0.0348s/iter; left time: 642.7818s
	iters: 400, epoch: 11 | loss: 0.0009278
	speed: 0.0347s/iter; left time: 637.2317s
Epoch: 11 cost time: 16.40624237060547
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0332087
	speed: 0.2148s/iter; left time: 3907.4335s
	iters: 200, epoch: 12 | loss: 0.1176613
	speed: 0.0346s/iter; left time: 625.4777s
	iters: 300, epoch: 12 | loss: 0.0008353
	speed: 0.0349s/iter; left time: 627.4104s
	iters: 400, epoch: 12 | loss: 0.0055478
	speed: 0.0347s/iter; left time: 620.1096s
Epoch: 12 cost time: 16.173076152801514
Epoch: 12, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0073174
	speed: 0.1886s/iter; left time: 3342.8727s
	iters: 200, epoch: 13 | loss: 0.0037017
	speed: 0.0313s/iter; left time: 551.9704s
	iters: 300, epoch: 13 | loss: 0.0009152
	speed: 0.0314s/iter; left time: 549.8167s
	iters: 400, epoch: 13 | loss: 0.2226557
	speed: 0.0328s/iter; left time: 571.4329s
Epoch: 13 cost time: 15.416849613189697
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0008141
	speed: 0.2215s/iter; left time: 3821.6785s
	iters: 200, epoch: 14 | loss: 0.0022339
	speed: 0.0347s/iter; left time: 595.2699s
	iters: 300, epoch: 14 | loss: 0.0001344
	speed: 0.0343s/iter; left time: 585.6975s
	iters: 400, epoch: 14 | loss: 0.0047942
	speed: 0.0349s/iter; left time: 591.1424s
Epoch: 14 cost time: 16.650717973709106
Epoch: 14, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0012682
	speed: 0.2228s/iter; left time: 3739.8121s
	iters: 200, epoch: 15 | loss: 0.0028106
	speed: 0.0333s/iter; left time: 556.4082s
	iters: 300, epoch: 15 | loss: 0.0020359
	speed: 0.0308s/iter; left time: 510.8966s
	iters: 400, epoch: 15 | loss: 0.0000701
	speed: 0.0305s/iter; left time: 503.3194s
Epoch: 15 cost time: 15.403527736663818
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.974 Test Loss: 0.171 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0040349
	speed: 0.2034s/iter; left time: 3318.9803s
	iters: 200, epoch: 16 | loss: 0.0017942
	speed: 0.0353s/iter; left time: 572.8979s
	iters: 300, epoch: 16 | loss: 0.0015053
	speed: 0.0354s/iter; left time: 569.7045s
	iters: 400, epoch: 16 | loss: 0.0015455
	speed: 0.0345s/iter; left time: 552.9947s
Epoch: 16 cost time: 16.72832727432251
Epoch: 16, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.979 Test Loss: 0.142 Test Acc: 0.979
Validation loss decreased (-0.974841 --> -0.978844).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0026591
	speed: 0.2213s/iter; left time: 3506.4591s
	iters: 200, epoch: 17 | loss: 0.0287928
	speed: 0.0355s/iter; left time: 558.8722s
	iters: 300, epoch: 17 | loss: 0.0001180
	speed: 0.0352s/iter; left time: 550.1005s
	iters: 400, epoch: 17 | loss: 0.0344407
	speed: 0.0355s/iter; left time: 552.5684s
Epoch: 17 cost time: 16.884657859802246
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0010817
	speed: 0.2019s/iter; left time: 3104.1313s
	iters: 200, epoch: 18 | loss: 0.0010446
	speed: 0.0273s/iter; left time: 417.5155s
	iters: 300, epoch: 18 | loss: 0.0022674
	speed: 0.0310s/iter; left time: 470.2591s
	iters: 400, epoch: 18 | loss: 0.0003822
	speed: 0.0319s/iter; left time: 481.2923s
Epoch: 18 cost time: 14.201586723327637
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.979 Test Loss: 0.141 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0006015
	speed: 0.2130s/iter; left time: 3175.2314s
	iters: 200, epoch: 19 | loss: 0.0256307
	speed: 0.0335s/iter; left time: 496.0144s
	iters: 300, epoch: 19 | loss: 0.0053961
	speed: 0.0340s/iter; left time: 500.0587s
	iters: 400, epoch: 19 | loss: 0.0185868
	speed: 0.0346s/iter; left time: 505.4125s
Epoch: 19 cost time: 16.312422037124634
Epoch: 19, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0027262
	speed: 0.2155s/iter; left time: 3112.3623s
	iters: 200, epoch: 20 | loss: 0.0037355
	speed: 0.0341s/iter; left time: 488.9821s
	iters: 300, epoch: 20 | loss: 0.0005072
	speed: 0.0329s/iter; left time: 468.0548s
	iters: 400, epoch: 20 | loss: 0.0017566
	speed: 0.0297s/iter; left time: 420.1092s
Epoch: 20 cost time: 15.527802467346191
Epoch: 20, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0075254
	speed: 0.1945s/iter; left time: 2716.9045s
	iters: 200, epoch: 21 | loss: 0.0000608
	speed: 0.0311s/iter; left time: 431.7972s
	iters: 300, epoch: 21 | loss: 0.0002180
	speed: 0.0280s/iter; left time: 386.2505s
	iters: 400, epoch: 21 | loss: 0.0004745
	speed: 0.0341s/iter; left time: 466.4245s
Epoch: 21 cost time: 15.126753330230713
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0003086
	speed: 0.2211s/iter; left time: 2985.6897s
	iters: 200, epoch: 22 | loss: 0.0018654
	speed: 0.0356s/iter; left time: 477.5304s
	iters: 300, epoch: 22 | loss: 0.0149459
	speed: 0.0355s/iter; left time: 471.5679s
	iters: 400, epoch: 22 | loss: 0.0009703
	speed: 0.0343s/iter; left time: 453.1090s
Epoch: 22 cost time: 16.70458483695984
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000584
	speed: 0.2115s/iter; left time: 2756.3635s
	iters: 200, epoch: 23 | loss: 0.0035774
	speed: 0.0321s/iter; left time: 415.0933s
	iters: 300, epoch: 23 | loss: 0.0376257
	speed: 0.0312s/iter; left time: 400.5570s
	iters: 400, epoch: 23 | loss: 0.0000231
	speed: 0.0318s/iter; left time: 405.0745s
Epoch: 23 cost time: 15.141344785690308
Epoch: 23, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0038913
	speed: 0.2103s/iter; left time: 2642.2223s
	iters: 200, epoch: 24 | loss: 0.0005359
	speed: 0.0342s/iter; left time: 426.3320s
	iters: 300, epoch: 24 | loss: 0.0008136
	speed: 0.0332s/iter; left time: 410.6529s
	iters: 400, epoch: 24 | loss: 0.0118581
	speed: 0.0348s/iter; left time: 427.0159s
Epoch: 24 cost time: 16.428216457366943
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0012625
	speed: 0.2148s/iter; left time: 2598.2237s
	iters: 200, epoch: 25 | loss: 0.0001416
	speed: 0.0346s/iter; left time: 415.3836s
	iters: 300, epoch: 25 | loss: 0.0010255
	speed: 0.0347s/iter; left time: 413.2154s
	iters: 400, epoch: 25 | loss: 0.0000411
	speed: 0.0346s/iter; left time: 408.4191s
Epoch: 25 cost time: 16.34870171546936
Epoch: 25, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000285
	speed: 0.1916s/iter; left time: 2227.6150s
	iters: 200, epoch: 26 | loss: 0.2470690
	speed: 0.0314s/iter; left time: 362.0809s
	iters: 300, epoch: 26 | loss: 0.0001254
	speed: 0.0332s/iter; left time: 379.6861s
	iters: 400, epoch: 26 | loss: 0.0001164
	speed: 0.0348s/iter; left time: 394.2237s
Epoch: 26 cost time: 15.724836349487305
Epoch: 26, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 15850
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1994116
	speed: 0.0631s/iter; left time: 1473.5274s
	iters: 200, epoch: 1 | loss: 0.6005481
	speed: 0.0514s/iter; left time: 1194.5795s
	iters: 300, epoch: 1 | loss: 0.0308923
	speed: 0.0497s/iter; left time: 1150.9233s
	iters: 400, epoch: 1 | loss: 0.0872305
	speed: 0.0473s/iter; left time: 1091.2299s
Epoch: 1 cost time: 24.301161527633667
Epoch: 1, Steps: 469 | Train Loss: 0.705 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
Validation loss decreased (inf --> -0.914520).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0195856
	speed: 0.2549s/iter; left time: 5832.6156s
	iters: 200, epoch: 2 | loss: 0.0429324
	speed: 0.0499s/iter; left time: 1136.5796s
	iters: 300, epoch: 2 | loss: 0.0320767
	speed: 0.0503s/iter; left time: 1140.6371s
	iters: 400, epoch: 2 | loss: 0.0019777
	speed: 0.0490s/iter; left time: 1107.5854s
Epoch: 2 cost time: 23.44765043258667
Epoch: 2, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.914520 --> -0.962548).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0469336
	speed: 0.2789s/iter; left time: 6250.6213s
	iters: 200, epoch: 3 | loss: 0.0066446
	speed: 0.0495s/iter; left time: 1103.7552s
	iters: 300, epoch: 3 | loss: 0.0532336
	speed: 0.0508s/iter; left time: 1128.8960s
	iters: 400, epoch: 3 | loss: 0.0073317
	speed: 0.0487s/iter; left time: 1076.1675s
Epoch: 3 cost time: 22.837474822998047
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1554194
	speed: 0.2607s/iter; left time: 5720.1711s
	iters: 200, epoch: 4 | loss: 0.0058196
	speed: 0.0507s/iter; left time: 1107.3588s
	iters: 300, epoch: 4 | loss: 0.0015297
	speed: 0.0506s/iter; left time: 1099.7597s
	iters: 400, epoch: 4 | loss: 0.0814863
	speed: 0.0501s/iter; left time: 1084.1068s
Epoch: 4 cost time: 23.9785213470459
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
Validation loss decreased (-0.962548 --> -0.966265).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1520620
	speed: 0.2861s/iter; left time: 6143.8218s
	iters: 200, epoch: 5 | loss: 0.1532089
	speed: 0.0523s/iter; left time: 1117.9146s
	iters: 300, epoch: 5 | loss: 0.0178637
	speed: 0.0504s/iter; left time: 1072.3942s
	iters: 400, epoch: 5 | loss: 0.0672783
	speed: 0.0489s/iter; left time: 1035.6387s
Epoch: 5 cost time: 23.96410059928894
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0001945
	speed: 0.2589s/iter; left time: 5438.7497s
	iters: 200, epoch: 6 | loss: 0.0194574
	speed: 0.0514s/iter; left time: 1073.5272s
	iters: 300, epoch: 6 | loss: 0.0010861
	speed: 0.0515s/iter; left time: 1071.2252s
	iters: 400, epoch: 6 | loss: 0.0006669
	speed: 0.0482s/iter; left time: 998.0582s
Epoch: 6 cost time: 23.269330263137817
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0013247
	speed: 0.2858s/iter; left time: 5869.7330s
	iters: 200, epoch: 7 | loss: 0.0008036
	speed: 0.0512s/iter; left time: 1047.3015s
	iters: 300, epoch: 7 | loss: 0.1000192
	speed: 0.0493s/iter; left time: 1002.8426s
	iters: 400, epoch: 7 | loss: 0.0130451
	speed: 0.0463s/iter; left time: 937.6392s
Epoch: 7 cost time: 23.317061185836792
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.966265 --> -0.972554).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0069701
	speed: 0.2586s/iter; left time: 5189.1325s
	iters: 200, epoch: 8 | loss: 0.0072924
	speed: 0.0481s/iter; left time: 960.3855s
	iters: 300, epoch: 8 | loss: 0.0012278
	speed: 0.0501s/iter; left time: 996.1682s
	iters: 400, epoch: 8 | loss: 0.3532861
	speed: 0.0487s/iter; left time: 963.5351s
Epoch: 8 cost time: 23.197426795959473
Epoch: 8, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0012872
	speed: 0.2801s/iter; left time: 5489.1095s
	iters: 200, epoch: 9 | loss: 0.0096832
	speed: 0.0497s/iter; left time: 969.0672s
	iters: 300, epoch: 9 | loss: 0.0193011
	speed: 0.0494s/iter; left time: 957.4377s
	iters: 400, epoch: 9 | loss: 0.0001027
	speed: 0.0459s/iter; left time: 886.2632s
Epoch: 9 cost time: 22.839852809906006
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0008607
	speed: 0.2612s/iter; left time: 4996.8458s
	iters: 200, epoch: 10 | loss: 0.1374151
	speed: 0.0480s/iter; left time: 912.5847s
	iters: 300, epoch: 10 | loss: 0.2167002
	speed: 0.0504s/iter; left time: 953.6182s
	iters: 400, epoch: 10 | loss: 0.0003027
	speed: 0.0482s/iter; left time: 907.3944s
Epoch: 10 cost time: 23.269662380218506
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0005670
	speed: 0.2774s/iter; left time: 5176.0138s
	iters: 200, epoch: 11 | loss: 0.0133244
	speed: 0.0486s/iter; left time: 902.7521s
	iters: 300, epoch: 11 | loss: 0.0042021
	speed: 0.0574s/iter; left time: 1060.1380s
	iters: 400, epoch: 11 | loss: 0.0007186
	speed: 0.0564s/iter; left time: 1035.9024s
Epoch: 11 cost time: 24.916332006454468
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.972554 --> -0.979987).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1276712
	speed: 0.3021s/iter; left time: 5496.2048s
	iters: 200, epoch: 12 | loss: 0.0000922
	speed: 0.0547s/iter; left time: 989.7668s
	iters: 300, epoch: 12 | loss: 0.0032982
	speed: 0.0538s/iter; left time: 967.1991s
	iters: 400, epoch: 12 | loss: 0.0335366
	speed: 0.0546s/iter; left time: 977.4652s
Epoch: 12 cost time: 25.728772401809692
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001167
	speed: 0.3092s/iter; left time: 5480.3147s
	iters: 200, epoch: 13 | loss: 0.0002762
	speed: 0.0549s/iter; left time: 967.7101s
	iters: 300, epoch: 13 | loss: 0.0001572
	speed: 0.0553s/iter; left time: 969.4479s
	iters: 400, epoch: 13 | loss: 0.0078904
	speed: 0.0550s/iter; left time: 959.0114s
Epoch: 13 cost time: 25.990198850631714
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0004524
	speed: 0.2989s/iter; left time: 5156.7756s
	iters: 200, epoch: 14 | loss: 0.0003768
	speed: 0.0528s/iter; left time: 906.3956s
	iters: 300, epoch: 14 | loss: 0.0001708
	speed: 0.0532s/iter; left time: 907.1234s
	iters: 400, epoch: 14 | loss: 0.0000418
	speed: 0.0540s/iter; left time: 916.3217s
Epoch: 14 cost time: 25.094773054122925
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0006256
	speed: 0.3210s/iter; left time: 5387.8451s
	iters: 200, epoch: 15 | loss: 0.0043344
	speed: 0.0536s/iter; left time: 894.7113s
	iters: 300, epoch: 15 | loss: 0.0001239
	speed: 0.0556s/iter; left time: 922.0428s
	iters: 400, epoch: 15 | loss: 0.1047807
	speed: 0.0584s/iter; left time: 963.1697s
Epoch: 15 cost time: 26.68726682662964
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0001065
	speed: 0.2955s/iter; left time: 4821.3778s
	iters: 200, epoch: 16 | loss: 0.0052208
	speed: 0.0520s/iter; left time: 842.4216s
	iters: 300, epoch: 16 | loss: 0.0221335
	speed: 0.0551s/iter; left time: 887.2831s
	iters: 400, epoch: 16 | loss: 0.0103283
	speed: 0.0603s/iter; left time: 965.1568s
Epoch: 16 cost time: 26.013460636138916
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000135
	speed: 0.3282s/iter; left time: 5201.1811s
	iters: 200, epoch: 17 | loss: 0.0019076
	speed: 0.0529s/iter; left time: 832.8421s
	iters: 300, epoch: 17 | loss: 0.0100448
	speed: 0.0534s/iter; left time: 834.8993s
	iters: 400, epoch: 17 | loss: 0.0014618
	speed: 0.0560s/iter; left time: 870.2133s
Epoch: 17 cost time: 25.909496068954468
Epoch: 17, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0077619
	speed: 0.2946s/iter; left time: 4531.0072s
	iters: 200, epoch: 18 | loss: 0.0000201
	speed: 0.0535s/iter; left time: 816.9848s
	iters: 300, epoch: 18 | loss: 0.0001474
	speed: 0.0578s/iter; left time: 876.8933s
	iters: 400, epoch: 18 | loss: 0.1183063
	speed: 0.0556s/iter; left time: 838.2343s
Epoch: 18 cost time: 26.18373465538025
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0002157
	speed: 0.3258s/iter; left time: 4856.7996s
	iters: 200, epoch: 19 | loss: 0.0000074
	speed: 0.0541s/iter; left time: 801.6744s
	iters: 300, epoch: 19 | loss: 0.0039897
	speed: 0.0527s/iter; left time: 774.4867s
	iters: 400, epoch: 19 | loss: 0.0000010
	speed: 0.0553s/iter; left time: 808.0156s
Epoch: 19 cost time: 25.64136838912964
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0020418
	speed: 0.3070s/iter; left time: 4432.6298s
	iters: 200, epoch: 20 | loss: 0.0004002
	speed: 0.0536s/iter; left time: 769.0808s
	iters: 300, epoch: 20 | loss: 0.0304371
	speed: 0.0545s/iter; left time: 775.5996s
	iters: 400, epoch: 20 | loss: 0.0016861
	speed: 0.0573s/iter; left time: 810.8822s
Epoch: 20 cost time: 26.107953310012817
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.982 Test Loss: 0.142 Test Acc: 0.982
Validation loss decreased (-0.979987 --> -0.981988).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0148234
	speed: 0.3245s/iter; left time: 4533.7815s
	iters: 200, epoch: 21 | loss: 0.0000750
	speed: 0.0535s/iter; left time: 742.3363s
	iters: 300, epoch: 21 | loss: 0.0058035
	speed: 0.0531s/iter; left time: 731.7985s
	iters: 400, epoch: 21 | loss: 0.0000390
	speed: 0.0577s/iter; left time: 788.4280s
Epoch: 21 cost time: 26.19626259803772
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.980 Test Loss: 0.184 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0004220
	speed: 0.3115s/iter; left time: 4206.0966s
	iters: 200, epoch: 22 | loss: 0.0014268
	speed: 0.0531s/iter; left time: 711.6600s
	iters: 300, epoch: 22 | loss: 0.0099555
	speed: 0.0509s/iter; left time: 676.7613s
	iters: 400, epoch: 22 | loss: 0.0000155
	speed: 0.0515s/iter; left time: 680.3936s
Epoch: 22 cost time: 24.544809103012085
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0005322
	speed: 0.3070s/iter; left time: 4001.7714s
	iters: 200, epoch: 23 | loss: 0.0000761
	speed: 0.0539s/iter; left time: 697.7318s
	iters: 300, epoch: 23 | loss: 0.0000162
	speed: 0.0557s/iter; left time: 715.2133s
	iters: 400, epoch: 23 | loss: 0.0260629
	speed: 0.0550s/iter; left time: 700.0695s
Epoch: 23 cost time: 26.049171447753906
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0001005
	speed: 0.3146s/iter; left time: 3953.0000s
	iters: 200, epoch: 24 | loss: 0.0000238
	speed: 0.0535s/iter; left time: 667.3260s
	iters: 300, epoch: 24 | loss: 0.0004656
	speed: 0.0536s/iter; left time: 662.2799s
	iters: 400, epoch: 24 | loss: 0.0004083
	speed: 0.0542s/iter; left time: 664.7084s
Epoch: 24 cost time: 25.370178699493408
Epoch: 24, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000647
	speed: 0.3203s/iter; left time: 3874.1498s
	iters: 200, epoch: 25 | loss: 0.0000083
	speed: 0.0566s/iter; left time: 679.0629s
	iters: 300, epoch: 25 | loss: 0.0000479
	speed: 0.0566s/iter; left time: 673.5874s
	iters: 400, epoch: 25 | loss: 0.0000066
	speed: 0.0599s/iter; left time: 706.1107s
Epoch: 25 cost time: 27.164169311523438
Epoch: 25, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0009782
	speed: 0.3147s/iter; left time: 3658.4509s
	iters: 200, epoch: 26 | loss: 0.0015985
	speed: 0.0499s/iter; left time: 575.1508s
	iters: 300, epoch: 26 | loss: 0.0000112
	speed: 0.0512s/iter; left time: 584.4592s
	iters: 400, epoch: 26 | loss: 0.0005116
	speed: 0.0512s/iter; left time: 580.2189s
Epoch: 26 cost time: 24.642247915267944
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.978 Test Loss: 0.186 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0008316
	speed: 0.3349s/iter; left time: 3736.0561s
	iters: 200, epoch: 27 | loss: 0.0000803
	speed: 0.0607s/iter; left time: 670.7344s
	iters: 300, epoch: 27 | loss: 0.0000074
	speed: 0.0606s/iter; left time: 664.3054s
	iters: 400, epoch: 27 | loss: 0.0043641
	speed: 0.0594s/iter; left time: 645.3356s
Epoch: 27 cost time: 28.31121253967285
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0077987
	speed: 0.3025s/iter; left time: 3233.2440s
	iters: 200, epoch: 28 | loss: 0.0000312
	speed: 0.0506s/iter; left time: 536.1303s
	iters: 300, epoch: 28 | loss: 0.0001014
	speed: 0.0519s/iter; left time: 544.3719s
	iters: 400, epoch: 28 | loss: 0.0000004
	speed: 0.0515s/iter; left time: 534.6989s
Epoch: 28 cost time: 24.463638067245483
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.978 Test Loss: 0.176 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0000055
	speed: 0.3197s/iter; left time: 3267.0837s
	iters: 200, epoch: 29 | loss: 0.0002224
	speed: 0.0545s/iter; left time: 551.8224s
	iters: 300, epoch: 29 | loss: 0.0000471
	speed: 0.0545s/iter; left time: 546.4942s
	iters: 400, epoch: 29 | loss: 0.0000074
	speed: 0.0513s/iter; left time: 509.0806s
Epoch: 29 cost time: 25.522159099578857
Epoch: 29, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.979 Test Loss: 0.174 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.3078s/iter; left time: 3000.6553s
	iters: 200, epoch: 30 | loss: 0.0000217
	speed: 0.0527s/iter; left time: 508.5586s
	iters: 300, epoch: 30 | loss: 0.0001372
	speed: 0.0536s/iter; left time: 511.7063s
	iters: 400, epoch: 30 | loss: 0.0000068
	speed: 0.0534s/iter; left time: 504.1714s
Epoch: 30 cost time: 25.243106365203857
Epoch: 30, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.974 Test Loss: 0.222 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 126026
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0137291
	speed: 0.0688s/iter; left time: 1606.3507s
	iters: 200, epoch: 1 | loss: 0.4872129
	speed: 0.0559s/iter; left time: 1299.2232s
	iters: 300, epoch: 1 | loss: 0.1693221
	speed: 0.0552s/iter; left time: 1278.1794s
	iters: 400, epoch: 1 | loss: 0.2647443
	speed: 0.0558s/iter; left time: 1285.6907s
Epoch: 1 cost time: 27.436578273773193
Epoch: 1, Steps: 469 | Train Loss: 0.691 Vali Loss: 0.232 Vali Acc: 0.929 Test Loss: 0.232 Test Acc: 0.929
Validation loss decreased (inf --> -0.929386).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0288860
	speed: 0.3025s/iter; left time: 6921.4600s
	iters: 200, epoch: 2 | loss: 0.0366711
	speed: 0.0520s/iter; left time: 1185.3395s
	iters: 300, epoch: 2 | loss: 0.0042933
	speed: 0.0514s/iter; left time: 1165.2229s
	iters: 400, epoch: 2 | loss: 0.1171579
	speed: 0.0543s/iter; left time: 1225.9361s
Epoch: 2 cost time: 24.91355061531067
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.929386 --> -0.967123).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0045141
	speed: 0.3201s/iter; left time: 7173.3045s
	iters: 200, epoch: 3 | loss: 0.0027562
	speed: 0.0563s/iter; left time: 1256.2679s
	iters: 300, epoch: 3 | loss: 0.0794156
	speed: 0.0555s/iter; left time: 1233.5304s
	iters: 400, epoch: 3 | loss: 0.0129441
	speed: 0.0559s/iter; left time: 1235.5699s
Epoch: 3 cost time: 26.548081636428833
Epoch: 3, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0088952
	speed: 0.3075s/iter; left time: 6748.6917s
	iters: 200, epoch: 4 | loss: 0.0213521
	speed: 0.0506s/iter; left time: 1105.4803s
	iters: 300, epoch: 4 | loss: 0.0752333
	speed: 0.0547s/iter; left time: 1189.9694s
	iters: 400, epoch: 4 | loss: 0.2856977
	speed: 0.0530s/iter; left time: 1147.3923s
Epoch: 4 cost time: 24.902884244918823
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
Validation loss decreased (-0.967123 --> -0.967980).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0011917
	speed: 0.3209s/iter; left time: 6891.6233s
	iters: 200, epoch: 5 | loss: 0.0260415
	speed: 0.0554s/iter; left time: 1183.4800s
	iters: 300, epoch: 5 | loss: 0.0057984
	speed: 0.0564s/iter; left time: 1200.2240s
	iters: 400, epoch: 5 | loss: 0.0119540
	speed: 0.0554s/iter; left time: 1172.2876s
Epoch: 5 cost time: 26.091424703598022
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.967980 --> -0.973698).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000996
	speed: 0.2888s/iter; left time: 6067.2725s
	iters: 200, epoch: 6 | loss: 0.1060882
	speed: 0.0522s/iter; left time: 1092.1724s
	iters: 300, epoch: 6 | loss: 0.0015167
	speed: 0.0523s/iter; left time: 1089.0525s
	iters: 400, epoch: 6 | loss: 0.0073853
	speed: 0.0543s/iter; left time: 1123.5487s
Epoch: 6 cost time: 24.79648232460022
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0093189
	speed: 0.3236s/iter; left time: 6646.6525s
	iters: 200, epoch: 7 | loss: 0.0766581
	speed: 0.0541s/iter; left time: 1105.5605s
	iters: 300, epoch: 7 | loss: 0.0612324
	speed: 0.0551s/iter; left time: 1120.5119s
	iters: 400, epoch: 7 | loss: 0.0018729
	speed: 0.0533s/iter; left time: 1078.4473s
Epoch: 7 cost time: 25.8106529712677
Epoch: 7, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2609362
	speed: 0.3046s/iter; left time: 6112.8197s
	iters: 200, epoch: 8 | loss: 0.0003921
	speed: 0.0537s/iter; left time: 1072.0155s
	iters: 300, epoch: 8 | loss: 0.0038941
	speed: 0.0535s/iter; left time: 1063.5443s
	iters: 400, epoch: 8 | loss: 0.0001691
	speed: 0.0552s/iter; left time: 1090.8622s
Epoch: 8 cost time: 25.682061910629272
Epoch: 8, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973698 --> -0.977415).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0096385
	speed: 0.3267s/iter; left time: 6403.5447s
	iters: 200, epoch: 9 | loss: 0.0099303
	speed: 0.0539s/iter; left time: 1050.0383s
	iters: 300, epoch: 9 | loss: 0.0000381
	speed: 0.0551s/iter; left time: 1069.0499s
	iters: 400, epoch: 9 | loss: 0.0187271
	speed: 0.0547s/iter; left time: 1056.5734s
Epoch: 9 cost time: 25.988081693649292
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002348
	speed: 0.3135s/iter; left time: 5997.6714s
	iters: 200, epoch: 10 | loss: 0.0593132
	speed: 0.0528s/iter; left time: 1004.1150s
	iters: 300, epoch: 10 | loss: 0.0004507
	speed: 0.0533s/iter; left time: 1009.0268s
	iters: 400, epoch: 10 | loss: 0.0003118
	speed: 0.0540s/iter; left time: 1017.3029s
Epoch: 10 cost time: 25.108579874038696
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.971 Test Loss: 0.200 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.2859535
	speed: 0.3130s/iter; left time: 5841.3855s
	iters: 200, epoch: 11 | loss: 0.0016851
	speed: 0.0543s/iter; left time: 1008.7760s
	iters: 300, epoch: 11 | loss: 0.0032266
	speed: 0.0546s/iter; left time: 1008.2738s
	iters: 400, epoch: 11 | loss: 0.0077752
	speed: 0.0539s/iter; left time: 989.3941s
Epoch: 11 cost time: 25.680700302124023
Epoch: 11, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.261 Vali Acc: 0.965 Test Loss: 0.261 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000661
	speed: 0.3078s/iter; left time: 5599.6892s
	iters: 200, epoch: 12 | loss: 0.2306838
	speed: 0.0511s/iter; left time: 924.2269s
	iters: 300, epoch: 12 | loss: 0.0018369
	speed: 0.0510s/iter; left time: 917.9245s
	iters: 400, epoch: 12 | loss: 0.0011719
	speed: 0.0488s/iter; left time: 872.8632s
Epoch: 12 cost time: 24.154654264450073
Epoch: 12, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000173
	speed: 0.3051s/iter; left time: 5407.6484s
	iters: 200, epoch: 13 | loss: 0.0000118
	speed: 0.0525s/iter; left time: 924.5852s
	iters: 300, epoch: 13 | loss: 0.0001122
	speed: 0.0529s/iter; left time: 926.8273s
	iters: 400, epoch: 13 | loss: 0.0932760
	speed: 0.0499s/iter; left time: 870.0441s
Epoch: 13 cost time: 24.880825519561768
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.249 Vali Acc: 0.971 Test Loss: 0.249 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0786204
	speed: 0.3151s/iter; left time: 5436.3241s
	iters: 200, epoch: 14 | loss: 0.0000258
	speed: 0.0475s/iter; left time: 815.0673s
	iters: 300, epoch: 14 | loss: 0.0000162
	speed: 0.0498s/iter; left time: 848.5457s
	iters: 400, epoch: 14 | loss: 0.0000330
	speed: 0.0511s/iter; left time: 867.1950s
Epoch: 14 cost time: 23.942078113555908
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.974 Test Loss: 0.237 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000822
	speed: 0.3188s/iter; left time: 5351.6327s
	iters: 200, epoch: 15 | loss: 0.0000339
	speed: 0.0551s/iter; left time: 919.7609s
	iters: 300, epoch: 15 | loss: 0.0003045
	speed: 0.0550s/iter; left time: 912.3191s
	iters: 400, epoch: 15 | loss: 0.0206205
	speed: 0.0570s/iter; left time: 940.3011s
Epoch: 15 cost time: 26.27693796157837
Epoch: 15, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0023840
	speed: 0.3076s/iter; left time: 5018.3506s
	iters: 200, epoch: 16 | loss: 0.0001884
	speed: 0.0496s/iter; left time: 803.9725s
	iters: 300, epoch: 16 | loss: 0.0964960
	speed: 0.0522s/iter; left time: 841.0640s
	iters: 400, epoch: 16 | loss: 0.0004954
	speed: 0.0527s/iter; left time: 843.5436s
Epoch: 16 cost time: 24.290218114852905
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.969 Test Loss: 0.218 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000576
	speed: 0.3197s/iter; left time: 5067.0016s
	iters: 200, epoch: 17 | loss: 0.0674346
	speed: 0.0551s/iter; left time: 867.5208s
	iters: 300, epoch: 17 | loss: 0.0005932
	speed: 0.0549s/iter; left time: 858.7777s
	iters: 400, epoch: 17 | loss: 0.0000187
	speed: 0.0576s/iter; left time: 895.9534s
Epoch: 17 cost time: 26.41165542602539
Epoch: 17, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1816148
	speed: 0.3032s/iter; left time: 4662.5728s
	iters: 200, epoch: 18 | loss: 0.0009781
	speed: 0.0496s/iter; left time: 757.6109s
	iters: 300, epoch: 18 | loss: 0.0023922
	speed: 0.0523s/iter; left time: 793.2317s
	iters: 400, epoch: 18 | loss: 0.0000503
	speed: 0.0523s/iter; left time: 788.5493s
Epoch: 18 cost time: 24.432631969451904
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.275 Vali Acc: 0.971 Test Loss: 0.275 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 126058
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2835974
	speed: 0.0653s/iter; left time: 1523.9653s
	iters: 200, epoch: 1 | loss: 0.7152777
	speed: 0.0553s/iter; left time: 1285.4576s
	iters: 300, epoch: 1 | loss: 0.1182151
	speed: 0.0548s/iter; left time: 1269.1143s
	iters: 400, epoch: 1 | loss: 0.1128005
	speed: 0.0554s/iter; left time: 1276.5985s
Epoch: 1 cost time: 26.9469096660614
Epoch: 1, Steps: 469 | Train Loss: 0.701 Vali Loss: 0.216 Vali Acc: 0.934 Test Loss: 0.216 Test Acc: 0.934
Validation loss decreased (inf --> -0.934246).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0119519
	speed: 0.2941s/iter; left time: 6730.5452s
	iters: 200, epoch: 2 | loss: 0.0700954
	speed: 0.0524s/iter; left time: 1193.2938s
	iters: 300, epoch: 2 | loss: 0.0201862
	speed: 0.0551s/iter; left time: 1249.3657s
	iters: 400, epoch: 2 | loss: 0.1335661
	speed: 0.0533s/iter; left time: 1204.5086s
Epoch: 2 cost time: 25.123031854629517
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (-0.934246 --> -0.955973).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0012626
	speed: 0.3117s/iter; left time: 6985.2442s
	iters: 200, epoch: 3 | loss: 0.0048544
	speed: 0.0549s/iter; left time: 1225.4377s
	iters: 300, epoch: 3 | loss: 0.0990735
	speed: 0.0565s/iter; left time: 1255.5476s
	iters: 400, epoch: 3 | loss: 0.0022895
	speed: 0.0558s/iter; left time: 1233.1277s
Epoch: 3 cost time: 26.27431583404541
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.955973 --> -0.970268).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0032748
	speed: 0.3021s/iter; left time: 6629.8024s
	iters: 200, epoch: 4 | loss: 0.0098611
	speed: 0.0507s/iter; left time: 1108.2053s
	iters: 300, epoch: 4 | loss: 0.0118209
	speed: 0.0505s/iter; left time: 1099.0556s
	iters: 400, epoch: 4 | loss: 0.0068951
	speed: 0.0521s/iter; left time: 1128.2667s
Epoch: 4 cost time: 24.062952518463135
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.970268 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0840716
	speed: 0.2899s/iter; left time: 6224.9889s
	iters: 200, epoch: 5 | loss: 0.0119105
	speed: 0.0511s/iter; left time: 1091.4550s
	iters: 300, epoch: 5 | loss: 0.0012841
	speed: 0.0503s/iter; left time: 1069.9571s
	iters: 400, epoch: 5 | loss: 0.0018598
	speed: 0.0504s/iter; left time: 1067.6878s
Epoch: 5 cost time: 24.479077100753784
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0097100
	speed: 0.2840s/iter; left time: 5966.7161s
	iters: 200, epoch: 6 | loss: 0.0014308
	speed: 0.0543s/iter; left time: 1135.9195s
	iters: 300, epoch: 6 | loss: 0.0001256
	speed: 0.0548s/iter; left time: 1140.1510s
	iters: 400, epoch: 6 | loss: 0.0031627
	speed: 0.0551s/iter; left time: 1141.5887s
Epoch: 6 cost time: 25.35522985458374
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.971125 --> -0.974556).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0435833
	speed: 0.2961s/iter; left time: 6081.4333s
	iters: 200, epoch: 7 | loss: 0.0386026
	speed: 0.0511s/iter; left time: 1045.1822s
	iters: 300, epoch: 7 | loss: 0.2138841
	speed: 0.0498s/iter; left time: 1012.6774s
	iters: 400, epoch: 7 | loss: 0.0115778
	speed: 0.0551s/iter; left time: 1114.1953s
Epoch: 7 cost time: 24.51500701904297
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0040582
	speed: 0.3027s/iter; left time: 6074.7577s
	iters: 200, epoch: 8 | loss: 0.0180188
	speed: 0.0525s/iter; left time: 1048.4892s
	iters: 300, epoch: 8 | loss: 0.0007337
	speed: 0.0526s/iter; left time: 1045.1011s
	iters: 400, epoch: 8 | loss: 0.0009028
	speed: 0.0529s/iter; left time: 1045.3786s
Epoch: 8 cost time: 25.10383105278015
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0066782
	speed: 0.3139s/iter; left time: 6151.3641s
	iters: 200, epoch: 9 | loss: 0.0034289
	speed: 0.0517s/iter; left time: 1008.3508s
	iters: 300, epoch: 9 | loss: 0.0114360
	speed: 0.0498s/iter; left time: 965.1451s
	iters: 400, epoch: 9 | loss: 0.0490639
	speed: 0.0492s/iter; left time: 948.6306s
Epoch: 9 cost time: 24.894015550613403
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.976271).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0002528
	speed: 0.3137s/iter; left time: 6001.3450s
	iters: 200, epoch: 10 | loss: 0.0007927
	speed: 0.0559s/iter; left time: 1063.8818s
	iters: 300, epoch: 10 | loss: 0.0000169
	speed: 0.0548s/iter; left time: 1037.6665s
	iters: 400, epoch: 10 | loss: 0.0000852
	speed: 0.0543s/iter; left time: 1023.4006s
Epoch: 10 cost time: 26.12338900566101
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977414).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000640
	speed: 0.2927s/iter; left time: 5461.4758s
	iters: 200, epoch: 11 | loss: 0.0010104
	speed: 0.0550s/iter; left time: 1020.0239s
	iters: 300, epoch: 11 | loss: 0.0006055
	speed: 0.0556s/iter; left time: 1026.5178s
	iters: 400, epoch: 11 | loss: 0.0032355
	speed: 0.0546s/iter; left time: 1002.8902s
Epoch: 11 cost time: 25.999390125274658
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.178 Vali Acc: 0.974 Test Loss: 0.178 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000142
	speed: 0.3084s/iter; left time: 5609.5820s
	iters: 200, epoch: 12 | loss: 0.0124202
	speed: 0.0518s/iter; left time: 937.1353s
	iters: 300, epoch: 12 | loss: 0.0002376
	speed: 0.0535s/iter; left time: 963.0282s
	iters: 400, epoch: 12 | loss: 0.2776798
	speed: 0.0549s/iter; left time: 981.9385s
Epoch: 12 cost time: 25.427314519882202
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.978 Test Loss: 0.143 Test Acc: 0.978
Validation loss decreased (-0.977414 --> -0.977986).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0004796
	speed: 0.3066s/iter; left time: 5433.2837s
	iters: 200, epoch: 13 | loss: 0.0739003
	speed: 0.0541s/iter; left time: 953.3579s
	iters: 300, epoch: 13 | loss: 0.0007855
	speed: 0.0504s/iter; left time: 882.5406s
	iters: 400, epoch: 13 | loss: 0.0001357
	speed: 0.0538s/iter; left time: 937.0117s
Epoch: 13 cost time: 25.276912927627563
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.252 Vali Acc: 0.959 Test Loss: 0.252 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0290522
	speed: 0.3155s/iter; left time: 5444.2482s
	iters: 200, epoch: 14 | loss: 0.0000743
	speed: 0.0493s/iter; left time: 846.3124s
	iters: 300, epoch: 14 | loss: 0.0016095
	speed: 0.0482s/iter; left time: 821.9238s
	iters: 400, epoch: 14 | loss: 0.2093870
	speed: 0.0467s/iter; left time: 791.8788s
Epoch: 14 cost time: 23.532552003860474
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.238 Vali Acc: 0.967 Test Loss: 0.238 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0012428
	speed: 0.3091s/iter; left time: 5188.8184s
	iters: 200, epoch: 15 | loss: 0.0043939
	speed: 0.0557s/iter; left time: 929.6225s
	iters: 300, epoch: 15 | loss: 0.0428863
	speed: 0.0553s/iter; left time: 917.5885s
	iters: 400, epoch: 15 | loss: 0.0001114
	speed: 0.0510s/iter; left time: 841.4309s
Epoch: 15 cost time: 25.361377954483032
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0004866
	speed: 0.2930s/iter; left time: 4780.8569s
	iters: 200, epoch: 16 | loss: 0.0002139
	speed: 0.0553s/iter; left time: 897.0695s
	iters: 300, epoch: 16 | loss: 0.3908070
	speed: 0.0561s/iter; left time: 903.5108s
	iters: 400, epoch: 16 | loss: 0.0000144
	speed: 0.0566s/iter; left time: 906.8070s
Epoch: 16 cost time: 26.35469961166382
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0002427
	speed: 0.3062s/iter; left time: 4851.6621s
	iters: 200, epoch: 17 | loss: 0.0000071
	speed: 0.0555s/iter; left time: 873.9977s
	iters: 300, epoch: 17 | loss: 0.0001480
	speed: 0.0566s/iter; left time: 885.5660s
	iters: 400, epoch: 17 | loss: 0.0008035
	speed: 0.0553s/iter; left time: 859.3497s
Epoch: 17 cost time: 26.113606452941895
Epoch: 17, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0014924
	speed: 0.2857s/iter; left time: 4393.8837s
	iters: 200, epoch: 18 | loss: 0.0000704
	speed: 0.0426s/iter; left time: 650.6184s
	iters: 300, epoch: 18 | loss: 0.0014637
	speed: 0.0456s/iter; left time: 692.6647s
	iters: 400, epoch: 18 | loss: 0.0001944
	speed: 0.0545s/iter; left time: 821.7553s
Epoch: 18 cost time: 22.585039138793945
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.977 Test Loss: 0.223 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0001268
	speed: 0.3168s/iter; left time: 4723.1450s
	iters: 200, epoch: 19 | loss: 0.0000702
	speed: 0.0535s/iter; left time: 791.7754s
	iters: 300, epoch: 19 | loss: 0.0017188
	speed: 0.0528s/iter; left time: 776.3793s
	iters: 400, epoch: 19 | loss: 0.0002380
	speed: 0.0536s/iter; left time: 783.0347s
Epoch: 19 cost time: 25.292189836502075
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.971 Test Loss: 0.224 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0002508
	speed: 0.3043s/iter; left time: 4394.1898s
	iters: 200, epoch: 20 | loss: 0.0002329
	speed: 0.0539s/iter; left time: 772.9769s
	iters: 300, epoch: 20 | loss: 0.0005576
	speed: 0.0527s/iter; left time: 750.5944s
	iters: 400, epoch: 20 | loss: 0.0000029
	speed: 0.0525s/iter; left time: 742.2297s
Epoch: 20 cost time: 25.089914083480835
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.978 Test Loss: 0.186 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0003438
	speed: 0.3024s/iter; left time: 4224.3373s
	iters: 200, epoch: 21 | loss: 0.0006981
	speed: 0.0506s/iter; left time: 701.5164s
	iters: 300, epoch: 21 | loss: 0.0864634
	speed: 0.0513s/iter; left time: 707.0762s
	iters: 400, epoch: 21 | loss: 0.0028856
	speed: 0.0532s/iter; left time: 726.8433s
Epoch: 21 cost time: 24.88068652153015
Epoch: 21, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.257 Vali Acc: 0.974 Test Loss: 0.257 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0305131
	speed: 0.2946s/iter; left time: 3977.0221s
	iters: 200, epoch: 22 | loss: 0.0193107
	speed: 0.0533s/iter; left time: 714.7221s
	iters: 300, epoch: 22 | loss: 0.0059203
	speed: 0.0558s/iter; left time: 742.6676s
	iters: 400, epoch: 22 | loss: 0.0451320
	speed: 0.0550s/iter; left time: 725.8728s
Epoch: 22 cost time: 25.99034810066223
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 124234
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3054249
	speed: 0.0679s/iter; left time: 1585.9648s
	iters: 200, epoch: 1 | loss: 0.6871888
	speed: 0.0545s/iter; left time: 1267.8038s
	iters: 300, epoch: 1 | loss: 0.1959957
	speed: 0.0549s/iter; left time: 1271.6709s
	iters: 400, epoch: 1 | loss: 0.1975862
	speed: 0.0550s/iter; left time: 1268.8956s
Epoch: 1 cost time: 27.12835717201233
Epoch: 1, Steps: 469 | Train Loss: 0.720 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
Validation loss decreased (inf --> -0.931673).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1232363
	speed: 0.2924s/iter; left time: 6691.5445s
	iters: 200, epoch: 2 | loss: 0.0189085
	speed: 0.0544s/iter; left time: 1239.8162s
	iters: 300, epoch: 2 | loss: 0.0084402
	speed: 0.0531s/iter; left time: 1204.3835s
	iters: 400, epoch: 2 | loss: 0.0199588
	speed: 0.0512s/iter; left time: 1155.9359s
Epoch: 2 cost time: 24.591814756393433
Epoch: 2, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.931673 --> -0.967980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0124812
	speed: 0.3062s/iter; left time: 6862.2850s
	iters: 200, epoch: 3 | loss: 0.0270883
	speed: 0.0531s/iter; left time: 1185.4174s
	iters: 300, epoch: 3 | loss: 0.0820774
	speed: 0.0527s/iter; left time: 1170.0861s
	iters: 400, epoch: 3 | loss: 0.1080024
	speed: 0.0516s/iter; left time: 1140.5817s
Epoch: 3 cost time: 24.811546325683594
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.967980 --> -0.968552).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0018185
	speed: 0.3046s/iter; left time: 6685.1314s
	iters: 200, epoch: 4 | loss: 0.0027902
	speed: 0.0534s/iter; left time: 1167.1890s
	iters: 300, epoch: 4 | loss: 0.0071252
	speed: 0.0531s/iter; left time: 1154.2505s
	iters: 400, epoch: 4 | loss: 0.0212767
	speed: 0.0534s/iter; left time: 1155.8145s
Epoch: 4 cost time: 25.120967864990234
Epoch: 4, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0022298
	speed: 0.3113s/iter; left time: 6684.9609s
	iters: 200, epoch: 5 | loss: 0.0204182
	speed: 0.0535s/iter; left time: 1142.9858s
	iters: 300, epoch: 5 | loss: 0.0110325
	speed: 0.0496s/iter; left time: 1054.9576s
	iters: 400, epoch: 5 | loss: 0.0087970
	speed: 0.0490s/iter; left time: 1037.1805s
Epoch: 5 cost time: 24.379648447036743
Epoch: 5, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.968552 --> -0.975127).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0008925
	speed: 0.2990s/iter; left time: 6281.5492s
	iters: 200, epoch: 6 | loss: 0.0625627
	speed: 0.0527s/iter; left time: 1101.0364s
	iters: 300, epoch: 6 | loss: 0.0004459
	speed: 0.0546s/iter; left time: 1135.4034s
	iters: 400, epoch: 6 | loss: 0.0007978
	speed: 0.0545s/iter; left time: 1127.6664s
Epoch: 6 cost time: 25.641103982925415
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0010635
	speed: 0.2848s/iter; left time: 5848.4332s
	iters: 200, epoch: 7 | loss: 0.0031288
	speed: 0.0551s/iter; left time: 1126.0460s
	iters: 300, epoch: 7 | loss: 0.0045089
	speed: 0.0576s/iter; left time: 1172.0446s
	iters: 400, epoch: 7 | loss: 0.0241713
	speed: 0.0571s/iter; left time: 1156.5382s
Epoch: 7 cost time: 26.515230178833008
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0094675
	speed: 0.3061s/iter; left time: 6142.3035s
	iters: 200, epoch: 8 | loss: 0.0030705
	speed: 0.0536s/iter; left time: 1070.5839s
	iters: 300, epoch: 8 | loss: 0.0008525
	speed: 0.0563s/iter; left time: 1118.0693s
	iters: 400, epoch: 8 | loss: 0.2220977
	speed: 0.0552s/iter; left time: 1090.6721s
Epoch: 8 cost time: 25.772904634475708
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0053223
	speed: 0.3073s/iter; left time: 6022.2567s
	iters: 200, epoch: 9 | loss: 0.2464458
	speed: 0.0522s/iter; left time: 1018.4811s
	iters: 300, epoch: 9 | loss: 0.0568211
	speed: 0.0530s/iter; left time: 1027.6491s
	iters: 400, epoch: 9 | loss: 0.0853998
	speed: 0.0528s/iter; left time: 1019.6527s
Epoch: 9 cost time: 25.32625150680542
Epoch: 9, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0030203
	speed: 0.3155s/iter; left time: 6035.7712s
	iters: 200, epoch: 10 | loss: 0.0001223
	speed: 0.0505s/iter; left time: 960.8934s
	iters: 300, epoch: 10 | loss: 0.0002264
	speed: 0.0515s/iter; left time: 974.5062s
	iters: 400, epoch: 10 | loss: 0.1656286
	speed: 0.0532s/iter; left time: 1002.1924s
Epoch: 10 cost time: 24.87655520439148
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.964 Test Loss: 0.244 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0028613
	speed: 0.3118s/iter; left time: 5817.9648s
	iters: 200, epoch: 11 | loss: 0.0009501
	speed: 0.0520s/iter; left time: 965.1750s
	iters: 300, epoch: 11 | loss: 0.1420426
	speed: 0.0487s/iter; left time: 898.2798s
	iters: 400, epoch: 11 | loss: 0.0013365
	speed: 0.0497s/iter; left time: 911.7528s
Epoch: 11 cost time: 24.284303426742554
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000567
	speed: 0.2807s/iter; left time: 5106.1841s
	iters: 200, epoch: 12 | loss: 0.0008497
	speed: 0.0549s/iter; left time: 993.3683s
	iters: 300, epoch: 12 | loss: 1.0543393
	speed: 0.0565s/iter; left time: 1016.1965s
	iters: 400, epoch: 12 | loss: 0.0108211
	speed: 0.0534s/iter; left time: 955.1817s
Epoch: 12 cost time: 25.865824222564697
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.220 Vali Acc: 0.972 Test Loss: 0.220 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0019424
	speed: 0.2873s/iter; left time: 5091.4985s
	iters: 200, epoch: 13 | loss: 0.0000758
	speed: 0.0512s/iter; left time: 901.4326s
	iters: 300, epoch: 13 | loss: 0.0020236
	speed: 0.0506s/iter; left time: 887.3537s
	iters: 400, epoch: 13 | loss: 0.0026489
	speed: 0.0481s/iter; left time: 838.1319s
Epoch: 13 cost time: 24.056668758392334
Epoch: 13, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.974 Test Loss: 0.185 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000480
	speed: 0.3034s/iter; left time: 5234.4761s
	iters: 200, epoch: 14 | loss: 0.0001058
	speed: 0.0522s/iter; left time: 895.2958s
	iters: 300, epoch: 14 | loss: 0.0049311
	speed: 0.0507s/iter; left time: 865.4138s
	iters: 400, epoch: 14 | loss: 0.0000711
	speed: 0.0551s/iter; left time: 933.5399s
Epoch: 14 cost time: 25.05217170715332
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0014695
	speed: 0.3009s/iter; left time: 5050.5607s
	iters: 200, epoch: 15 | loss: 0.0013628
	speed: 0.0516s/iter; left time: 860.1857s
	iters: 300, epoch: 15 | loss: 0.0124536
	speed: 0.0519s/iter; left time: 860.0562s
	iters: 400, epoch: 15 | loss: 0.0005573
	speed: 0.0527s/iter; left time: 869.4540s
Epoch: 15 cost time: 24.555763006210327
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 124266
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2982021
	speed: 0.0650s/iter; left time: 1517.3823s
	iters: 200, epoch: 1 | loss: 0.1052338
	speed: 0.0536s/iter; left time: 1246.5664s
	iters: 300, epoch: 1 | loss: 0.4117901
	speed: 0.0559s/iter; left time: 1294.9657s
	iters: 400, epoch: 1 | loss: 0.0642972
	speed: 0.0603s/iter; left time: 1388.8349s
Epoch: 1 cost time: 27.69941997528076
Epoch: 1, Steps: 469 | Train Loss: 0.409 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
Validation loss decreased (inf --> -0.953971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0202979
	speed: 0.3591s/iter; left time: 8217.5597s
	iters: 200, epoch: 2 | loss: 0.0806023
	speed: 0.0553s/iter; left time: 1260.3454s
	iters: 300, epoch: 2 | loss: 0.0048029
	speed: 0.0541s/iter; left time: 1226.1074s
	iters: 400, epoch: 2 | loss: 0.0010096
	speed: 0.0519s/iter; left time: 1171.8405s
Epoch: 2 cost time: 25.729461193084717
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
Validation loss decreased (-0.953971 --> -0.963120).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0233851
	speed: 0.3505s/iter; left time: 7856.1978s
	iters: 200, epoch: 3 | loss: 0.0220628
	speed: 0.0523s/iter; left time: 1166.6586s
	iters: 300, epoch: 3 | loss: 0.0024244
	speed: 0.0541s/iter; left time: 1202.1131s
	iters: 400, epoch: 3 | loss: 0.2988354
	speed: 0.0534s/iter; left time: 1180.9730s
Epoch: 3 cost time: 25.793851375579834
Epoch: 3, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.220 Vali Acc: 0.953 Test Loss: 0.220 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0562983
	speed: 0.3476s/iter; left time: 7626.7371s
	iters: 200, epoch: 4 | loss: 0.0041745
	speed: 0.0560s/iter; left time: 1223.8465s
	iters: 300, epoch: 4 | loss: 0.0000608
	speed: 0.0547s/iter; left time: 1190.2230s
	iters: 400, epoch: 4 | loss: 0.0029894
	speed: 0.0533s/iter; left time: 1152.9016s
Epoch: 4 cost time: 26.314987421035767
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.965 Test Loss: 0.229 Test Acc: 0.965
Validation loss decreased (-0.963120 --> -0.964549).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0014235
	speed: 0.3581s/iter; left time: 7690.6687s
	iters: 200, epoch: 5 | loss: 0.1322530
	speed: 0.0601s/iter; left time: 1285.2212s
	iters: 300, epoch: 5 | loss: 0.1536236
	speed: 0.0535s/iter; left time: 1137.5728s
	iters: 400, epoch: 5 | loss: 0.0000439
	speed: 0.0522s/iter; left time: 1105.5124s
Epoch: 5 cost time: 26.510799884796143
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.451 Vali Acc: 0.939 Test Loss: 0.451 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0006310
	speed: 0.3499s/iter; left time: 7349.0933s
	iters: 200, epoch: 6 | loss: 0.0000818
	speed: 0.0603s/iter; left time: 1261.3800s
	iters: 300, epoch: 6 | loss: 0.0101340
	speed: 0.0605s/iter; left time: 1258.2967s
	iters: 400, epoch: 6 | loss: 1.1639405
	speed: 0.0570s/iter; left time: 1180.3846s
Epoch: 6 cost time: 27.90682077407837
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.965 Test Loss: 0.252 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000894
	speed: 0.3353s/iter; left time: 6885.3966s
	iters: 200, epoch: 7 | loss: 0.3257902
	speed: 0.0611s/iter; left time: 1247.8347s
	iters: 300, epoch: 7 | loss: 0.0006045
	speed: 0.0609s/iter; left time: 1237.7253s
	iters: 400, epoch: 7 | loss: 0.0006950
	speed: 0.0606s/iter; left time: 1227.2798s
Epoch: 7 cost time: 28.533317804336548
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.404 Vali Acc: 0.954 Test Loss: 0.404 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0007507
	speed: 0.3424s/iter; left time: 6870.7180s
	iters: 200, epoch: 8 | loss: 0.0006234
	speed: 0.0569s/iter; left time: 1135.9347s
	iters: 300, epoch: 8 | loss: 0.0000229
	speed: 0.0563s/iter; left time: 1119.0691s
	iters: 400, epoch: 8 | loss: 0.0000036
	speed: 0.0585s/iter; left time: 1156.4224s
Epoch: 8 cost time: 27.494747400283813
Epoch: 8, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0057405
	speed: 0.3374s/iter; left time: 6612.6821s
	iters: 200, epoch: 9 | loss: 0.0000197
	speed: 0.0602s/iter; left time: 1173.1802s
	iters: 300, epoch: 9 | loss: 0.0431789
	speed: 0.0592s/iter; left time: 1148.6505s
	iters: 400, epoch: 9 | loss: 0.2073669
	speed: 0.0602s/iter; left time: 1161.0709s
Epoch: 9 cost time: 27.74986243247986
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
Validation loss decreased (-0.964549 --> -0.967122).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1128055
	speed: 0.3296s/iter; left time: 6305.2798s
	iters: 200, epoch: 10 | loss: 0.0012450
	speed: 0.0531s/iter; left time: 1009.7717s
	iters: 300, epoch: 10 | loss: 0.0001377
	speed: 0.0606s/iter; left time: 1146.9140s
	iters: 400, epoch: 10 | loss: 0.0003786
	speed: 0.0605s/iter; left time: 1139.0381s
Epoch: 10 cost time: 27.23402166366577
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.246 Vali Acc: 0.965 Test Loss: 0.246 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0434509
	speed: 0.3531s/iter; left time: 6589.6392s
	iters: 200, epoch: 11 | loss: 0.0078720
	speed: 0.0532s/iter; left time: 987.5986s
	iters: 300, epoch: 11 | loss: 0.0163388
	speed: 0.0572s/iter; left time: 1056.1544s
	iters: 400, epoch: 11 | loss: 0.0020080
	speed: 0.0611s/iter; left time: 1121.5079s
Epoch: 11 cost time: 26.994491577148438
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.967122 --> -0.975127).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000016
	speed: 0.3649s/iter; left time: 6638.6727s
	iters: 200, epoch: 12 | loss: 0.0042743
	speed: 0.0570s/iter; left time: 1031.6166s
	iters: 300, epoch: 12 | loss: 0.0000635
	speed: 0.0575s/iter; left time: 1035.3123s
	iters: 400, epoch: 12 | loss: 0.0758619
	speed: 0.0563s/iter; left time: 1006.9860s
Epoch: 12 cost time: 27.000733613967896
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0004758
	speed: 0.3611s/iter; left time: 6400.6075s
	iters: 200, epoch: 13 | loss: 0.0000077
	speed: 0.0572s/iter; left time: 1008.0409s
	iters: 300, epoch: 13 | loss: 0.0000164
	speed: 0.0567s/iter; left time: 993.3131s
	iters: 400, epoch: 13 | loss: 0.0000093
	speed: 0.0566s/iter; left time: 986.2719s
Epoch: 13 cost time: 27.044666290283203
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
Validation loss decreased (-0.975127 --> -0.978558).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0187174
	speed: 0.3632s/iter; left time: 6266.5091s
	iters: 200, epoch: 14 | loss: 0.0019567
	speed: 0.0566s/iter; left time: 971.1559s
	iters: 300, epoch: 14 | loss: 0.2924286
	speed: 0.0564s/iter; left time: 961.2987s
	iters: 400, epoch: 14 | loss: 0.1273143
	speed: 0.0562s/iter; left time: 952.4229s
Epoch: 14 cost time: 26.947386026382446
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.981 Test Loss: 0.124 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.980845).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000217
	speed: 0.3587s/iter; left time: 6020.6417s
	iters: 200, epoch: 15 | loss: 0.0000028
	speed: 0.0600s/iter; left time: 1001.0936s
	iters: 300, epoch: 15 | loss: 0.0278162
	speed: 0.0566s/iter; left time: 939.1878s
	iters: 400, epoch: 15 | loss: 0.0002172
	speed: 0.0514s/iter; left time: 847.0561s
Epoch: 15 cost time: 26.632242679595947
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0001048
	speed: 0.3446s/iter; left time: 5622.6416s
	iters: 200, epoch: 16 | loss: 0.0000020
	speed: 0.0607s/iter; left time: 984.2052s
	iters: 300, epoch: 16 | loss: 0.0014934
	speed: 0.0604s/iter; left time: 973.6685s
	iters: 400, epoch: 16 | loss: 0.5024398
	speed: 0.0575s/iter; left time: 920.4967s
Epoch: 16 cost time: 28.002755165100098
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0003024
	speed: 0.3411s/iter; left time: 5405.1307s
	iters: 200, epoch: 17 | loss: 0.0156183
	speed: 0.0612s/iter; left time: 963.2782s
	iters: 300, epoch: 17 | loss: 0.0062544
	speed: 0.0610s/iter; left time: 954.2559s
	iters: 400, epoch: 17 | loss: 0.0004290
	speed: 0.0620s/iter; left time: 963.9088s
Epoch: 17 cost time: 29.024874925613403
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0000007
	speed: 0.3536s/iter; left time: 5437.0138s
	iters: 200, epoch: 18 | loss: 0.0000211
	speed: 0.0609s/iter; left time: 930.8913s
	iters: 300, epoch: 18 | loss: 0.0000435
	speed: 0.0582s/iter; left time: 883.7881s
	iters: 400, epoch: 18 | loss: 0.0000042
	speed: 0.0580s/iter; left time: 875.0692s
Epoch: 18 cost time: 28.21733260154724
Epoch: 18, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.977 Test Loss: 0.179 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0000011
	speed: 0.3491s/iter; left time: 5205.0832s
	iters: 200, epoch: 19 | loss: 0.0000187
	speed: 0.0620s/iter; left time: 917.4365s
	iters: 300, epoch: 19 | loss: 0.0000131
	speed: 0.0620s/iter; left time: 911.2624s
	iters: 400, epoch: 19 | loss: 0.0806201
	speed: 0.0610s/iter; left time: 891.0438s
Epoch: 19 cost time: 28.76401448249817
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.261 Vali Acc: 0.969 Test Loss: 0.261 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000003
	speed: 0.3443s/iter; left time: 4972.2908s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0561s/iter; left time: 804.3267s
	iters: 300, epoch: 20 | loss: 0.0000426
	speed: 0.0578s/iter; left time: 823.5692s
	iters: 400, epoch: 20 | loss: 0.0000336
	speed: 0.0555s/iter; left time: 784.8062s
Epoch: 20 cost time: 26.381770372390747
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.979 Test Loss: 0.227 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0003731
	speed: 0.3416s/iter; left time: 4772.9815s
	iters: 200, epoch: 21 | loss: 0.5137038
	speed: 0.0565s/iter; left time: 783.7269s
	iters: 300, epoch: 21 | loss: 0.0006118
	speed: 0.0523s/iter; left time: 720.3217s
	iters: 400, epoch: 21 | loss: 0.0050309
	speed: 0.0518s/iter; left time: 708.5824s
Epoch: 21 cost time: 26.183908939361572
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0401683
	speed: 0.3518s/iter; left time: 4750.4287s
	iters: 200, epoch: 22 | loss: 0.0060300
	speed: 0.0594s/iter; left time: 796.4006s
	iters: 300, epoch: 22 | loss: 0.2617467
	speed: 0.0568s/iter; left time: 756.0585s
	iters: 400, epoch: 22 | loss: 0.2621544
	speed: 0.0561s/iter; left time: 740.8564s
Epoch: 22 cost time: 27.37101173400879
Epoch: 22, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0019096
	speed: 0.3440s/iter; left time: 4483.9124s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0609s/iter; left time: 786.9949s
	iters: 300, epoch: 23 | loss: 0.0000006
	speed: 0.0579s/iter; left time: 743.4640s
	iters: 400, epoch: 23 | loss: 1.1914889
	speed: 0.0580s/iter; left time: 738.3032s
Epoch: 23 cost time: 28.11151432991028
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.976 Test Loss: 0.186 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0000020
	speed: 0.3585s/iter; left time: 4504.4526s
	iters: 200, epoch: 24 | loss: 0.0000011
	speed: 0.0578s/iter; left time: 720.3479s
	iters: 300, epoch: 24 | loss: 0.0000063
	speed: 0.0528s/iter; left time: 652.3463s
	iters: 400, epoch: 24 | loss: 0.0000415
	speed: 0.0551s/iter; left time: 675.4804s
Epoch: 24 cost time: 26.07995867729187
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 438538
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7240894
	speed: 0.0708s/iter; left time: 1654.1120s
	iters: 200, epoch: 1 | loss: 0.1953160
	speed: 0.0571s/iter; left time: 1326.5067s
	iters: 300, epoch: 1 | loss: 0.0639409
	speed: 0.0583s/iter; left time: 1348.8397s
	iters: 400, epoch: 1 | loss: 0.2965131
	speed: 0.0563s/iter; left time: 1297.0323s
Epoch: 1 cost time: 28.210643768310547
Epoch: 1, Steps: 469 | Train Loss: 0.410 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (inf --> -0.951971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0467833
	speed: 0.3477s/iter; left time: 7957.0753s
	iters: 200, epoch: 2 | loss: 0.0037977
	speed: 0.0565s/iter; left time: 1288.0426s
	iters: 300, epoch: 2 | loss: 0.0971128
	speed: 0.0593s/iter; left time: 1345.3244s
	iters: 400, epoch: 2 | loss: 0.0591125
	speed: 0.0602s/iter; left time: 1359.3166s
Epoch: 2 cost time: 27.731401920318604
Epoch: 2, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.951971 --> -0.972840).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0002226
	speed: 0.3383s/iter; left time: 7581.7041s
	iters: 200, epoch: 3 | loss: 0.0013143
	speed: 0.0553s/iter; left time: 1233.5175s
	iters: 300, epoch: 3 | loss: 0.0160241
	speed: 0.0590s/iter; left time: 1311.5659s
	iters: 400, epoch: 3 | loss: 0.1143680
	speed: 0.0591s/iter; left time: 1307.2735s
Epoch: 3 cost time: 27.170066595077515
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0510212
	speed: 0.3418s/iter; left time: 7500.6004s
	iters: 200, epoch: 4 | loss: 0.0000610
	speed: 0.0505s/iter; left time: 1103.0415s
	iters: 300, epoch: 4 | loss: 0.0030215
	speed: 0.0549s/iter; left time: 1193.0583s
	iters: 400, epoch: 4 | loss: 0.0273550
	speed: 0.0583s/iter; left time: 1261.6428s
Epoch: 4 cost time: 25.86478304862976
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0013371
	speed: 0.3529s/iter; left time: 7579.5266s
	iters: 200, epoch: 5 | loss: 0.0384517
	speed: 0.0568s/iter; left time: 1214.6739s
	iters: 300, epoch: 5 | loss: 0.0008006
	speed: 0.0607s/iter; left time: 1290.5460s
	iters: 400, epoch: 5 | loss: 0.0004697
	speed: 0.0566s/iter; left time: 1199.4457s
Epoch: 5 cost time: 27.189249753952026
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001778
	speed: 0.3487s/iter; left time: 7324.5017s
	iters: 200, epoch: 6 | loss: 0.0005751
	speed: 0.0570s/iter; left time: 1191.8692s
	iters: 300, epoch: 6 | loss: 0.0020379
	speed: 0.0601s/iter; left time: 1251.2230s
	iters: 400, epoch: 6 | loss: 0.0015417
	speed: 0.0602s/iter; left time: 1246.7105s
Epoch: 6 cost time: 28.074421882629395
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.972 Test Loss: 0.223 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0003388
	speed: 0.3437s/iter; left time: 7058.4030s
	iters: 200, epoch: 7 | loss: 0.0240337
	speed: 0.0568s/iter; left time: 1161.1407s
	iters: 300, epoch: 7 | loss: 0.0075045
	speed: 0.0604s/iter; left time: 1228.4741s
	iters: 400, epoch: 7 | loss: 1.5703219
	speed: 0.0605s/iter; left time: 1224.6274s
Epoch: 7 cost time: 28.086195468902588
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.232 Vali Acc: 0.971 Test Loss: 0.232 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.1701295
	speed: 0.3512s/iter; left time: 7048.1723s
	iters: 200, epoch: 8 | loss: 0.0000116
	speed: 0.0522s/iter; left time: 1043.0918s
	iters: 300, epoch: 8 | loss: 0.0005202
	speed: 0.0566s/iter; left time: 1124.7647s
	iters: 400, epoch: 8 | loss: 0.0000130
	speed: 0.0598s/iter; left time: 1181.7360s
Epoch: 8 cost time: 26.664725303649902
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.965 Test Loss: 0.223 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0078653
	speed: 0.3488s/iter; left time: 6835.6653s
	iters: 200, epoch: 9 | loss: 0.0041452
	speed: 0.0566s/iter; left time: 1104.2983s
	iters: 300, epoch: 9 | loss: 0.0000902
	speed: 0.0585s/iter; left time: 1135.0049s
	iters: 400, epoch: 9 | loss: 0.0001123
	speed: 0.0552s/iter; left time: 1065.8353s
Epoch: 9 cost time: 26.70451521873474
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.966 Test Loss: 0.269 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.4133100
	speed: 0.3325s/iter; left time: 6361.2041s
	iters: 200, epoch: 10 | loss: 0.0032260
	speed: 0.0573s/iter; left time: 1091.1498s
	iters: 300, epoch: 10 | loss: 0.0000352
	speed: 0.0585s/iter; left time: 1107.7351s
	iters: 400, epoch: 10 | loss: 0.0000340
	speed: 0.0590s/iter; left time: 1110.5327s
Epoch: 10 cost time: 27.402923583984375
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.276 Vali Acc: 0.965 Test Loss: 0.276 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0000006
	speed: 0.3227s/iter; left time: 6022.6260s
	iters: 200, epoch: 11 | loss: 0.6412005
	speed: 0.0578s/iter; left time: 1071.9452s
	iters: 300, epoch: 11 | loss: 0.0002850
	speed: 0.0592s/iter; left time: 1092.7269s
	iters: 400, epoch: 11 | loss: 0.2094157
	speed: 0.0590s/iter; left time: 1083.0760s
Epoch: 11 cost time: 26.96730661392212
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0000152
	speed: 0.2769s/iter; left time: 5036.7942s
	iters: 200, epoch: 12 | loss: 0.0002356
	speed: 0.0546s/iter; left time: 987.0657s
	iters: 300, epoch: 12 | loss: 0.0000168
	speed: 0.0588s/iter; left time: 1058.2617s
	iters: 400, epoch: 12 | loss: 0.0000217
	speed: 0.0590s/iter; left time: 1056.1757s
Epoch: 12 cost time: 26.760494709014893
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.163 Vali Acc: 0.979 Test Loss: 0.163 Test Acc: 0.979
Validation loss decreased (-0.972840 --> -0.979415).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0176629
	speed: 0.3447s/iter; left time: 6109.1087s
	iters: 200, epoch: 13 | loss: 0.0000586
	speed: 0.0594s/iter; left time: 1046.6377s
	iters: 300, epoch: 13 | loss: 0.0000510
	speed: 0.0547s/iter; left time: 958.3176s
	iters: 400, epoch: 13 | loss: 0.0000106
	speed: 0.0550s/iter; left time: 957.4141s
Epoch: 13 cost time: 26.6274356842041
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000151
	speed: 0.3408s/iter; left time: 5880.8736s
	iters: 200, epoch: 14 | loss: 0.0010703
	speed: 0.0591s/iter; left time: 1013.1114s
	iters: 300, epoch: 14 | loss: 0.0000226
	speed: 0.0594s/iter; left time: 1012.6863s
	iters: 400, epoch: 14 | loss: 0.0000687
	speed: 0.0595s/iter; left time: 1008.1064s
Epoch: 14 cost time: 27.878413200378418
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.277 Vali Acc: 0.967 Test Loss: 0.277 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000005
	speed: 0.3312s/iter; left time: 5558.4881s
	iters: 200, epoch: 15 | loss: 0.0000491
	speed: 0.0593s/iter; left time: 989.3291s
	iters: 300, epoch: 15 | loss: 0.0002877
	speed: 0.0596s/iter; left time: 989.1945s
	iters: 400, epoch: 15 | loss: 0.0167963
	speed: 0.0594s/iter; left time: 979.4000s
Epoch: 15 cost time: 27.94009041786194
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.3251s/iter; left time: 5304.2461s
	iters: 200, epoch: 16 | loss: 0.0000164
	speed: 0.0549s/iter; left time: 890.6290s
	iters: 300, epoch: 16 | loss: 0.0001182
	speed: 0.0578s/iter; left time: 930.9559s
	iters: 400, epoch: 16 | loss: 0.0000958
	speed: 0.0558s/iter; left time: 893.7818s
Epoch: 16 cost time: 26.24634099006653
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.170 Vali Acc: 0.979 Test Loss: 0.170 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0153939
	speed: 0.3335s/iter; left time: 5285.6869s
	iters: 200, epoch: 17 | loss: 0.0000308
	speed: 0.0556s/iter; left time: 875.8602s
	iters: 300, epoch: 17 | loss: 0.0009098
	speed: 0.0547s/iter; left time: 856.1046s
	iters: 400, epoch: 17 | loss: 0.0000108
	speed: 0.0556s/iter; left time: 863.6471s
Epoch: 17 cost time: 26.60284948348999
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.343 Vali Acc: 0.959 Test Loss: 0.343 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0285682
	speed: 0.3411s/iter; left time: 5245.9491s
	iters: 200, epoch: 18 | loss: 0.0000003
	speed: 0.0593s/iter; left time: 906.5776s
	iters: 300, epoch: 18 | loss: 0.0274900
	speed: 0.0591s/iter; left time: 897.3135s
	iters: 400, epoch: 18 | loss: 0.0000030
	speed: 0.0585s/iter; left time: 881.5363s
Epoch: 18 cost time: 27.710511684417725
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.371 Vali Acc: 0.961 Test Loss: 0.371 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0292227
	speed: 0.3321s/iter; left time: 4951.0249s
	iters: 200, epoch: 19 | loss: 0.0006010
	speed: 0.0594s/iter; left time: 880.2097s
	iters: 300, epoch: 19 | loss: 0.0000013
	speed: 0.0598s/iter; left time: 879.2149s
	iters: 400, epoch: 19 | loss: 0.0000011
	speed: 0.0588s/iter; left time: 858.5005s
Epoch: 19 cost time: 28.18164610862732
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
Validation loss decreased (-0.979415 --> -0.981416).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001473
	speed: 0.3325s/iter; left time: 4801.3101s
	iters: 200, epoch: 20 | loss: 0.0000011
	speed: 0.0589s/iter; left time: 845.2404s
	iters: 300, epoch: 20 | loss: 0.0000060
	speed: 0.0593s/iter; left time: 843.7360s
	iters: 400, epoch: 20 | loss: 0.0004162
	speed: 0.0593s/iter; left time: 838.0954s
Epoch: 20 cost time: 27.84833025932312
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.977 Test Loss: 0.228 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0002539
	speed: 0.3339s/iter; left time: 4664.7180s
	iters: 200, epoch: 21 | loss: 0.0000068
	speed: 0.0541s/iter; left time: 750.9745s
	iters: 300, epoch: 21 | loss: 0.3759692
	speed: 0.0529s/iter; left time: 728.9162s
	iters: 400, epoch: 21 | loss: 0.0000100
	speed: 0.0550s/iter; left time: 751.2330s
Epoch: 21 cost time: 26.14354944229126
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0065501
	speed: 0.3257s/iter; left time: 4397.2981s
	iters: 200, epoch: 22 | loss: 0.0000012
	speed: 0.0590s/iter; left time: 790.1733s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0587s/iter; left time: 780.3949s
	iters: 400, epoch: 22 | loss: 0.0000677
	speed: 0.0568s/iter; left time: 750.2355s
Epoch: 22 cost time: 27.437620878219604
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.253 Vali Acc: 0.974 Test Loss: 0.253 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000320
	speed: 0.3268s/iter; left time: 4259.6171s
	iters: 200, epoch: 23 | loss: 0.0000084
	speed: 0.0593s/iter; left time: 767.4014s
	iters: 300, epoch: 23 | loss: 0.0006041
	speed: 0.0570s/iter; left time: 732.1087s
	iters: 400, epoch: 23 | loss: 0.0000004
	speed: 0.0596s/iter; left time: 758.9311s
Epoch: 23 cost time: 27.9151291847229
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.226 Vali Acc: 0.976 Test Loss: 0.226 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000012
	speed: 0.3332s/iter; left time: 4186.0842s
	iters: 200, epoch: 24 | loss: 0.0000270
	speed: 0.0601s/iter; left time: 749.2096s
	iters: 300, epoch: 24 | loss: 0.0000006
	speed: 0.0603s/iter; left time: 745.2260s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.0598s/iter; left time: 733.4502s
Epoch: 24 cost time: 28.279053926467896
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.252 Vali Acc: 0.974 Test Loss: 0.252 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0024495
	speed: 0.3443s/iter; left time: 4164.7428s
	iters: 200, epoch: 25 | loss: 0.0000129
	speed: 0.0561s/iter; left time: 673.2206s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0566s/iter; left time: 673.4336s
	iters: 400, epoch: 25 | loss: 0.4530557
	speed: 0.0581s/iter; left time: 685.0778s
Epoch: 25 cost time: 27.405712842941284
Epoch: 25, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.365 Vali Acc: 0.964 Test Loss: 0.365 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000065
	speed: 0.3367s/iter; left time: 3914.9357s
	iters: 200, epoch: 26 | loss: 0.0000000
	speed: 0.0497s/iter; left time: 572.4823s
	iters: 300, epoch: 26 | loss: 0.0629875
	speed: 0.0485s/iter; left time: 553.9066s
	iters: 400, epoch: 26 | loss: 0.0000016
	speed: 0.0507s/iter; left time: 574.1079s
Epoch: 26 cost time: 24.54186749458313
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.364 Vali Acc: 0.962 Test Loss: 0.364 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0003843
	speed: 0.3327s/iter; left time: 3711.9811s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.0550s/iter; left time: 608.5699s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.0591s/iter; left time: 647.1169s
	iters: 400, epoch: 27 | loss: 0.0002454
	speed: 0.0605s/iter; left time: 656.5947s
Epoch: 27 cost time: 27.358088731765747
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.977 Test Loss: 0.229 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0000096
	speed: 0.3357s/iter; left time: 3587.4608s
	iters: 200, epoch: 28 | loss: 0.0000030
	speed: 0.0587s/iter; left time: 621.9541s
	iters: 300, epoch: 28 | loss: 0.0519623
	speed: 0.0600s/iter; left time: 629.7422s
	iters: 400, epoch: 28 | loss: 0.0003351
	speed: 0.0605s/iter; left time: 628.8056s
Epoch: 28 cost time: 27.94206738471985
Epoch: 28, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.281 Vali Acc: 0.977 Test Loss: 0.281 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0005648
	speed: 0.3445s/iter; left time: 3520.1202s
	iters: 200, epoch: 29 | loss: 0.0006583
	speed: 0.0553s/iter; left time: 559.6835s
	iters: 300, epoch: 29 | loss: 0.0121777
	speed: 0.0555s/iter; left time: 555.7136s
	iters: 400, epoch: 29 | loss: 0.0000077
	speed: 0.0594s/iter; left time: 589.0572s
Epoch: 29 cost time: 26.930685997009277
Epoch: 29, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.971 Test Loss: 0.300 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 438666
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9200034
	speed: 0.0560s/iter; left time: 1308.7795s
	iters: 200, epoch: 1 | loss: 0.3346916
	speed: 0.0412s/iter; left time: 957.9956s
	iters: 300, epoch: 1 | loss: 0.4848718
	speed: 0.0419s/iter; left time: 969.0300s
	iters: 400, epoch: 1 | loss: 0.0323120
	speed: 0.0422s/iter; left time: 972.2909s
Epoch: 1 cost time: 21.527897119522095
Epoch: 1, Steps: 469 | Train Loss: 0.616 Vali Loss: 0.224 Vali Acc: 0.945 Test Loss: 0.224 Test Acc: 0.945
Validation loss decreased (inf --> -0.944537).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0246500
	speed: 0.2872s/iter; left time: 6571.0484s
	iters: 200, epoch: 2 | loss: 0.1611838
	speed: 0.0426s/iter; left time: 970.3329s
	iters: 300, epoch: 2 | loss: 0.1524803
	speed: 0.0421s/iter; left time: 954.0647s
	iters: 400, epoch: 2 | loss: 0.1132174
	speed: 0.0431s/iter; left time: 972.3176s
Epoch: 2 cost time: 20.665374755859375
Epoch: 2, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.944537 --> -0.959118).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0224776
	speed: 0.2711s/iter; left time: 6076.8678s
	iters: 200, epoch: 3 | loss: 0.0787088
	speed: 0.0465s/iter; left time: 1036.5728s
	iters: 300, epoch: 3 | loss: 0.0262371
	speed: 0.0450s/iter; left time: 999.1980s
	iters: 400, epoch: 3 | loss: 0.0117802
	speed: 0.0451s/iter; left time: 997.6847s
Epoch: 3 cost time: 21.37576198577881
Epoch: 3, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
Validation loss decreased (-0.959118 --> -0.964549).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0573591
	speed: 0.2926s/iter; left time: 6419.7949s
	iters: 200, epoch: 4 | loss: 0.0263675
	speed: 0.0420s/iter; left time: 918.5280s
	iters: 300, epoch: 4 | loss: 0.0079579
	speed: 0.0419s/iter; left time: 910.9545s
	iters: 400, epoch: 4 | loss: 0.1472517
	speed: 0.0419s/iter; left time: 907.2526s
Epoch: 4 cost time: 20.42221212387085
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.964549 --> -0.971411).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0032658
	speed: 0.2947s/iter; left time: 6328.5291s
	iters: 200, epoch: 5 | loss: 0.0983977
	speed: 0.0454s/iter; left time: 969.7954s
	iters: 300, epoch: 5 | loss: 0.0012469
	speed: 0.0449s/iter; left time: 955.4810s
	iters: 400, epoch: 5 | loss: 0.0207520
	speed: 0.0453s/iter; left time: 959.2944s
Epoch: 5 cost time: 21.52994966506958
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0007206
	speed: 0.2815s/iter; left time: 5913.1527s
	iters: 200, epoch: 6 | loss: 0.0032436
	speed: 0.0455s/iter; left time: 950.9675s
	iters: 300, epoch: 6 | loss: 0.2485680
	speed: 0.0444s/iter; left time: 923.8330s
	iters: 400, epoch: 6 | loss: 0.0436714
	speed: 0.0459s/iter; left time: 950.0209s
Epoch: 6 cost time: 21.665935039520264
Epoch: 6, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0046283
	speed: 0.2940s/iter; left time: 6038.1788s
	iters: 200, epoch: 7 | loss: 0.0012440
	speed: 0.0438s/iter; left time: 895.7913s
	iters: 300, epoch: 7 | loss: 0.0821669
	speed: 0.0415s/iter; left time: 843.6930s
	iters: 400, epoch: 7 | loss: 0.0076279
	speed: 0.0402s/iter; left time: 813.9851s
Epoch: 7 cost time: 20.492640018463135
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000500
	speed: 0.2834s/iter; left time: 5687.0990s
	iters: 200, epoch: 8 | loss: 0.0040221
	speed: 0.0427s/iter; left time: 852.7851s
	iters: 300, epoch: 8 | loss: 0.0001156
	speed: 0.0435s/iter; left time: 864.1611s
	iters: 400, epoch: 8 | loss: 0.0000404
	speed: 0.0435s/iter; left time: 860.1154s
Epoch: 8 cost time: 20.961508989334106
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0434506
	speed: 0.2741s/iter; left time: 5372.4035s
	iters: 200, epoch: 9 | loss: 0.0143539
	speed: 0.0451s/iter; left time: 879.6203s
	iters: 300, epoch: 9 | loss: 0.0002320
	speed: 0.0450s/iter; left time: 873.0264s
	iters: 400, epoch: 9 | loss: 0.0011830
	speed: 0.0445s/iter; left time: 858.0545s
Epoch: 9 cost time: 21.410927057266235
Epoch: 9, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.248 Vali Acc: 0.957 Test Loss: 0.248 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0003883
	speed: 0.2945s/iter; left time: 5633.5099s
	iters: 200, epoch: 10 | loss: 0.0005560
	speed: 0.0450s/iter; left time: 856.7347s
	iters: 300, epoch: 10 | loss: 0.0025657
	speed: 0.0442s/iter; left time: 836.1781s
	iters: 400, epoch: 10 | loss: 0.0551367
	speed: 0.0430s/iter; left time: 809.1329s
Epoch: 10 cost time: 21.409103631973267
Epoch: 10, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972840).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0005565
	speed: 0.2867s/iter; left time: 5350.1529s
	iters: 200, epoch: 11 | loss: 0.0025022
	speed: 0.0464s/iter; left time: 860.6769s
	iters: 300, epoch: 11 | loss: 0.0103313
	speed: 0.0453s/iter; left time: 836.9291s
	iters: 400, epoch: 11 | loss: 0.0490554
	speed: 0.0456s/iter; left time: 837.2103s
Epoch: 11 cost time: 22.099701404571533
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974270).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0012175
	speed: 0.2862s/iter; left time: 5207.2896s
	iters: 200, epoch: 12 | loss: 0.0001353
	speed: 0.0430s/iter; left time: 778.3203s
	iters: 300, epoch: 12 | loss: 0.0005534
	speed: 0.0449s/iter; left time: 808.5542s
	iters: 400, epoch: 12 | loss: 0.0204796
	speed: 0.0445s/iter; left time: 796.3587s
Epoch: 12 cost time: 21.2615385055542
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000939
	speed: 0.2927s/iter; left time: 5188.2282s
	iters: 200, epoch: 13 | loss: 0.0012108
	speed: 0.0467s/iter; left time: 822.4683s
	iters: 300, epoch: 13 | loss: 0.0264240
	speed: 0.0426s/iter; left time: 746.3520s
	iters: 400, epoch: 13 | loss: 0.0001513
	speed: 0.0421s/iter; left time: 732.7366s
Epoch: 13 cost time: 21.37733221054077
Epoch: 13, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0005263
	speed: 0.2744s/iter; left time: 4734.8686s
	iters: 200, epoch: 14 | loss: 0.0005507
	speed: 0.0458s/iter; left time: 786.4875s
	iters: 300, epoch: 14 | loss: 0.0123932
	speed: 0.0456s/iter; left time: 777.7870s
	iters: 400, epoch: 14 | loss: 0.0061605
	speed: 0.0437s/iter; left time: 741.2752s
Epoch: 14 cost time: 21.53816509246826
Epoch: 14, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000114
	speed: 0.2786s/iter; left time: 4676.2099s
	iters: 200, epoch: 15 | loss: 0.0832499
	speed: 0.0448s/iter; left time: 747.3672s
	iters: 300, epoch: 15 | loss: 0.0002455
	speed: 0.0426s/iter; left time: 706.9448s
	iters: 400, epoch: 15 | loss: 0.0081825
	speed: 0.0448s/iter; left time: 738.1277s
Epoch: 15 cost time: 21.237428188323975
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0001079
	speed: 0.2924s/iter; left time: 4771.5312s
	iters: 200, epoch: 16 | loss: 0.0000067
	speed: 0.0481s/iter; left time: 780.5847s
	iters: 300, epoch: 16 | loss: 0.0011244
	speed: 0.0451s/iter; left time: 727.5122s
	iters: 400, epoch: 16 | loss: 0.0000134
	speed: 0.0449s/iter; left time: 719.0943s
Epoch: 16 cost time: 22.086829662322998
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.175 Vali Acc: 0.976 Test Loss: 0.175 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975985).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0057691
	speed: 0.2544s/iter; left time: 4031.1795s
	iters: 200, epoch: 17 | loss: 0.0000972
	speed: 0.0406s/iter; left time: 638.8495s
	iters: 300, epoch: 17 | loss: 0.0000122
	speed: 0.0476s/iter; left time: 744.4695s
	iters: 400, epoch: 17 | loss: 0.0005160
	speed: 0.0482s/iter; left time: 749.1777s
Epoch: 17 cost time: 21.431390285491943
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.203 Vali Acc: 0.968 Test Loss: 0.203 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0014680
	speed: 0.2792s/iter; left time: 4292.9794s
	iters: 200, epoch: 18 | loss: 0.0000147
	speed: 0.0399s/iter; left time: 609.9176s
	iters: 300, epoch: 18 | loss: 0.0022881
	speed: 0.0466s/iter; left time: 706.6146s
	iters: 400, epoch: 18 | loss: 0.0000087
	speed: 0.0472s/iter; left time: 711.2184s
Epoch: 18 cost time: 21.1828875541687
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.968 Test Loss: 0.222 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0001017
	speed: 0.2790s/iter; left time: 4160.2499s
	iters: 200, epoch: 19 | loss: 0.0114057
	speed: 0.0433s/iter; left time: 641.2273s
	iters: 300, epoch: 19 | loss: 0.0081119
	speed: 0.0477s/iter; left time: 701.9601s
	iters: 400, epoch: 19 | loss: 0.2185684
	speed: 0.0476s/iter; left time: 694.7669s
Epoch: 19 cost time: 21.695180416107178
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976842).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0024073
	speed: 0.2499s/iter; left time: 3607.9204s
	iters: 200, epoch: 20 | loss: 0.0001647
	speed: 0.0329s/iter; left time: 472.0561s
	iters: 300, epoch: 20 | loss: 0.0000435
	speed: 0.0395s/iter; left time: 562.8293s
	iters: 400, epoch: 20 | loss: 0.0000229
	speed: 0.0401s/iter; left time: 567.3900s
Epoch: 20 cost time: 18.784839868545532
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.969 Test Loss: 0.223 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.4815928
	speed: 0.2599s/iter; left time: 3630.8340s
	iters: 200, epoch: 21 | loss: 0.0009584
	speed: 0.0457s/iter; left time: 633.3982s
	iters: 300, epoch: 21 | loss: 0.0006060
	speed: 0.0476s/iter; left time: 655.6528s
	iters: 400, epoch: 21 | loss: 0.0000042
	speed: 0.0475s/iter; left time: 649.7134s
Epoch: 21 cost time: 22.00860857963562
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.248 Vali Acc: 0.971 Test Loss: 0.248 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000007
	speed: 0.2596s/iter; left time: 3505.0357s
	iters: 200, epoch: 22 | loss: 0.0005952
	speed: 0.0493s/iter; left time: 660.1041s
	iters: 300, epoch: 22 | loss: 0.0189218
	speed: 0.0477s/iter; left time: 634.3355s
	iters: 400, epoch: 22 | loss: 0.1254396
	speed: 0.0482s/iter; left time: 636.5510s
Epoch: 22 cost time: 22.435691356658936
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.971 Test Loss: 0.224 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0001004
	speed: 0.2717s/iter; left time: 3540.8120s
	iters: 200, epoch: 23 | loss: 0.0003912
	speed: 0.0447s/iter; left time: 577.8813s
	iters: 300, epoch: 23 | loss: 0.0006145
	speed: 0.0444s/iter; left time: 569.8385s
	iters: 400, epoch: 23 | loss: 0.0000080
	speed: 0.0454s/iter; left time: 577.9336s
Epoch: 23 cost time: 21.230278968811035
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
Validation loss decreased (-0.976842 --> -0.978558).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0620257
	speed: 0.2712s/iter; left time: 3407.1289s
	iters: 200, epoch: 24 | loss: 0.0718829
	speed: 0.0476s/iter; left time: 593.5450s
	iters: 300, epoch: 24 | loss: 0.0326033
	speed: 0.0482s/iter; left time: 596.1278s
	iters: 400, epoch: 24 | loss: 0.0001247
	speed: 0.0481s/iter; left time: 589.9586s
Epoch: 24 cost time: 22.49575924873352
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.272 Vali Acc: 0.949 Test Loss: 0.272 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0005099
	speed: 0.2543s/iter; left time: 3075.7095s
	iters: 200, epoch: 25 | loss: 0.0000289
	speed: 0.0455s/iter; left time: 545.2854s
	iters: 300, epoch: 25 | loss: 0.0003403
	speed: 0.0459s/iter; left time: 546.2658s
	iters: 400, epoch: 25 | loss: 0.0027061
	speed: 0.0478s/iter; left time: 563.8118s
Epoch: 25 cost time: 21.788559913635254
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.232 Vali Acc: 0.969 Test Loss: 0.232 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000018
	speed: 0.2638s/iter; left time: 3066.9647s
	iters: 200, epoch: 26 | loss: 0.0000333
	speed: 0.0462s/iter; left time: 532.5134s
	iters: 300, epoch: 26 | loss: 0.0015247
	speed: 0.0446s/iter; left time: 509.2419s
	iters: 400, epoch: 26 | loss: 0.0035098
	speed: 0.0467s/iter; left time: 528.7360s
Epoch: 26 cost time: 21.742268323898315
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000119
	speed: 0.2651s/iter; left time: 2958.0301s
	iters: 200, epoch: 27 | loss: 0.0000024
	speed: 0.0473s/iter; left time: 522.4951s
	iters: 300, epoch: 27 | loss: 0.2867549
	speed: 0.0479s/iter; left time: 524.3406s
	iters: 400, epoch: 27 | loss: 0.0000066
	speed: 0.0477s/iter; left time: 518.1078s
Epoch: 27 cost time: 22.677074670791626
Epoch: 27, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.974 Test Loss: 0.216 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000079
	speed: 0.2611s/iter; left time: 2790.2511s
	iters: 200, epoch: 28 | loss: 0.0004120
	speed: 0.0455s/iter; left time: 481.5192s
	iters: 300, epoch: 28 | loss: 0.0000251
	speed: 0.0478s/iter; left time: 501.1108s
	iters: 400, epoch: 28 | loss: 0.0009274
	speed: 0.0477s/iter; left time: 495.2751s
Epoch: 28 cost time: 22.175382137298584
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000087
	speed: 0.2714s/iter; left time: 2773.8738s
	iters: 200, epoch: 29 | loss: 0.0000168
	speed: 0.0478s/iter; left time: 483.2427s
	iters: 300, epoch: 29 | loss: 0.0000021
	speed: 0.0473s/iter; left time: 474.3394s
	iters: 400, epoch: 29 | loss: 0.0085625
	speed: 0.0471s/iter; left time: 467.5119s
Epoch: 29 cost time: 22.079118013381958
Epoch: 29, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0007187
	speed: 0.2641s/iter; left time: 2575.0235s
	iters: 200, epoch: 30 | loss: 0.0000079
	speed: 0.0466s/iter; left time: 449.8144s
	iters: 300, epoch: 30 | loss: 0.0001763
	speed: 0.0462s/iter; left time: 441.3091s
	iters: 400, epoch: 30 | loss: 0.0002886
	speed: 0.0471s/iter; left time: 445.5058s
Epoch: 30 cost time: 22.16352677345276
Epoch: 30, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.332 Vali Acc: 0.958 Test Loss: 0.332 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000167
	speed: 0.2586s/iter; left time: 2399.7642s
	iters: 200, epoch: 31 | loss: 0.0000648
	speed: 0.0436s/iter; left time: 400.1846s
	iters: 300, epoch: 31 | loss: 0.0000003
	speed: 0.0463s/iter; left time: 420.2214s
	iters: 400, epoch: 31 | loss: 0.0000086
	speed: 0.0451s/iter; left time: 404.7513s
Epoch: 31 cost time: 21.27826499938965
Epoch: 31, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0003240
	speed: 0.2637s/iter; left time: 2323.4206s
	iters: 200, epoch: 32 | loss: 0.0000320
	speed: 0.0471s/iter; left time: 410.1445s
	iters: 300, epoch: 32 | loss: 0.0000075
	speed: 0.0469s/iter; left time: 403.7459s
	iters: 400, epoch: 32 | loss: 0.0001519
	speed: 0.0420s/iter; left time: 357.7957s
Epoch: 32 cost time: 21.423572063446045
Epoch: 32, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000528
	speed: 0.2638s/iter; left time: 2200.5457s
	iters: 200, epoch: 33 | loss: 0.0000175
	speed: 0.0480s/iter; left time: 395.5386s
	iters: 300, epoch: 33 | loss: 0.0004650
	speed: 0.0476s/iter; left time: 387.9661s
	iters: 400, epoch: 33 | loss: 0.0006604
	speed: 0.0445s/iter; left time: 357.7135s
Epoch: 33 cost time: 22.2603018283844
Epoch: 33, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.978 Test Loss: 0.205 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 120970
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1032730
	speed: 0.0577s/iter; left time: 1348.3661s
	iters: 200, epoch: 1 | loss: 0.4872906
	speed: 0.0439s/iter; left time: 1021.1526s
	iters: 300, epoch: 1 | loss: 0.0831406
	speed: 0.0434s/iter; left time: 1005.0083s
	iters: 400, epoch: 1 | loss: 0.1867692
	speed: 0.0430s/iter; left time: 991.3373s
Epoch: 1 cost time: 21.988733530044556
Epoch: 1, Steps: 469 | Train Loss: 0.595 Vali Loss: 0.232 Vali Acc: 0.942 Test Loss: 0.232 Test Acc: 0.942
Validation loss decreased (inf --> -0.941965).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0133830
	speed: 0.2552s/iter; left time: 5839.6264s
	iters: 200, epoch: 2 | loss: 0.0056447
	speed: 0.0458s/iter; left time: 1042.5421s
	iters: 300, epoch: 2 | loss: 0.0206991
	speed: 0.0460s/iter; left time: 1044.0615s
	iters: 400, epoch: 2 | loss: 0.0474923
	speed: 0.0452s/iter; left time: 1020.4658s
Epoch: 2 cost time: 21.45525884628296
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.941965 --> -0.957402).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0089723
	speed: 0.2698s/iter; left time: 6046.2403s
	iters: 200, epoch: 3 | loss: 0.0127542
	speed: 0.0471s/iter; left time: 1050.7593s
	iters: 300, epoch: 3 | loss: 0.1041029
	speed: 0.0480s/iter; left time: 1067.3324s
	iters: 400, epoch: 3 | loss: 0.0043802
	speed: 0.0457s/iter; left time: 1011.0816s
Epoch: 3 cost time: 22.234010219573975
Epoch: 3, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.957402 --> -0.976843).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0348939
	speed: 0.2550s/iter; left time: 5596.7310s
	iters: 200, epoch: 4 | loss: 0.0164183
	speed: 0.0475s/iter; left time: 1037.3870s
	iters: 300, epoch: 4 | loss: 0.0048055
	speed: 0.0465s/iter; left time: 1011.6308s
	iters: 400, epoch: 4 | loss: 0.0476986
	speed: 0.0444s/iter; left time: 961.7990s
Epoch: 4 cost time: 21.85576105117798
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.206 Vali Acc: 0.961 Test Loss: 0.206 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0002012
	speed: 0.2727s/iter; left time: 5856.2118s
	iters: 200, epoch: 5 | loss: 0.0046204
	speed: 0.0464s/iter; left time: 992.4886s
	iters: 300, epoch: 5 | loss: 0.0534097
	speed: 0.0476s/iter; left time: 1012.4528s
	iters: 400, epoch: 5 | loss: 0.0001563
	speed: 0.0429s/iter; left time: 907.9226s
Epoch: 5 cost time: 21.85501265525818
Epoch: 5, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003406
	speed: 0.2819s/iter; left time: 5922.2600s
	iters: 200, epoch: 6 | loss: 0.0457134
	speed: 0.0498s/iter; left time: 1041.4760s
	iters: 300, epoch: 6 | loss: 0.0014463
	speed: 0.0501s/iter; left time: 1043.2693s
	iters: 400, epoch: 6 | loss: 0.0725456
	speed: 0.0464s/iter; left time: 960.9947s
Epoch: 6 cost time: 22.907115936279297
Epoch: 6, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.953 Test Loss: 0.245 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0354654
	speed: 0.2717s/iter; left time: 5580.8038s
	iters: 200, epoch: 7 | loss: 0.0162415
	speed: 0.0493s/iter; left time: 1007.6792s
	iters: 300, epoch: 7 | loss: 0.1530133
	speed: 0.0472s/iter; left time: 959.2464s
	iters: 400, epoch: 7 | loss: 0.0004313
	speed: 0.0445s/iter; left time: 899.6445s
Epoch: 7 cost time: 22.147928714752197
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0006002
	speed: 0.2843s/iter; left time: 5705.9068s
	iters: 200, epoch: 8 | loss: 0.0000193
	speed: 0.0492s/iter; left time: 982.4299s
	iters: 300, epoch: 8 | loss: 0.0713953
	speed: 0.0455s/iter; left time: 903.9133s
	iters: 400, epoch: 8 | loss: 0.0000060
	speed: 0.0419s/iter; left time: 827.3815s
Epoch: 8 cost time: 21.759556531906128
Epoch: 8, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.976 Test Loss: 0.198 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0010664
	speed: 0.2747s/iter; left time: 5383.4178s
	iters: 200, epoch: 9 | loss: 0.0922811
	speed: 0.0474s/iter; left time: 924.5298s
	iters: 300, epoch: 9 | loss: 0.0008991
	speed: 0.0449s/iter; left time: 871.8164s
	iters: 400, epoch: 9 | loss: 0.0000757
	speed: 0.0440s/iter; left time: 849.0246s
Epoch: 9 cost time: 21.523984909057617
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0041433
	speed: 0.2679s/iter; left time: 5124.6628s
	iters: 200, epoch: 10 | loss: 0.0002019
	speed: 0.0478s/iter; left time: 908.9992s
	iters: 300, epoch: 10 | loss: 0.0057662
	speed: 0.0442s/iter; left time: 836.5440s
	iters: 400, epoch: 10 | loss: 0.0000259
	speed: 0.0434s/iter; left time: 816.3616s
Epoch: 10 cost time: 21.304940938949585
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0003902
	speed: 0.2750s/iter; left time: 5132.2131s
	iters: 200, epoch: 11 | loss: 0.0012872
	speed: 0.0471s/iter; left time: 874.3756s
	iters: 300, epoch: 11 | loss: 0.0001407
	speed: 0.0449s/iter; left time: 829.2133s
	iters: 400, epoch: 11 | loss: 0.0487056
	speed: 0.0432s/iter; left time: 792.5869s
Epoch: 11 cost time: 21.615877866744995
Epoch: 11, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.274 Vali Acc: 0.969 Test Loss: 0.274 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000245
	speed: 0.2783s/iter; left time: 5063.1617s
	iters: 200, epoch: 12 | loss: 0.0060924
	speed: 0.0469s/iter; left time: 848.7867s
	iters: 300, epoch: 12 | loss: 0.0000775
	speed: 0.0449s/iter; left time: 808.3019s
	iters: 400, epoch: 12 | loss: 0.0000885
	speed: 0.0441s/iter; left time: 789.3898s
Epoch: 12 cost time: 21.900346755981445
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.316 Vali Acc: 0.966 Test Loss: 0.316 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0003399
	speed: 0.2861s/iter; left time: 5070.6454s
	iters: 200, epoch: 13 | loss: 0.0002302
	speed: 0.0434s/iter; left time: 764.0922s
	iters: 300, epoch: 13 | loss: 0.0000533
	speed: 0.0432s/iter; left time: 756.9817s
	iters: 400, epoch: 13 | loss: 0.0000076
	speed: 0.0439s/iter; left time: 764.3470s
Epoch: 13 cost time: 21.116578102111816
Epoch: 13, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 121034
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3526598
	speed: 0.0513s/iter; left time: 1197.4812s
	iters: 200, epoch: 1 | loss: 0.4301794
	speed: 0.0359s/iter; left time: 834.8846s
	iters: 300, epoch: 1 | loss: 0.4056339
	speed: 0.0361s/iter; left time: 836.8426s
	iters: 400, epoch: 1 | loss: 0.3022834
	speed: 0.0372s/iter; left time: 858.3549s
Epoch: 1 cost time: 18.72507643699646
Epoch: 1, Steps: 469 | Train Loss: 0.805 Vali Loss: 0.359 Vali Acc: 0.887 Test Loss: 0.359 Test Acc: 0.887
Validation loss decreased (inf --> -0.886789).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0837413
	speed: 0.2272s/iter; left time: 5199.7806s
	iters: 200, epoch: 2 | loss: 0.2191530
	speed: 0.0377s/iter; left time: 858.3629s
	iters: 300, epoch: 2 | loss: 0.0193783
	speed: 0.0363s/iter; left time: 823.7751s
	iters: 400, epoch: 2 | loss: 0.0678979
	speed: 0.0387s/iter; left time: 873.2442s
Epoch: 2 cost time: 18.141448974609375
Epoch: 2, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
Validation loss decreased (-0.886789 --> -0.944538).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0074641
	speed: 0.2283s/iter; left time: 5117.8935s
	iters: 200, epoch: 3 | loss: 0.0285962
	speed: 0.0350s/iter; left time: 782.0663s
	iters: 300, epoch: 3 | loss: 0.0331782
	speed: 0.0358s/iter; left time: 794.9300s
	iters: 400, epoch: 3 | loss: 0.0057021
	speed: 0.0361s/iter; left time: 798.9023s
Epoch: 3 cost time: 17.246599197387695
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.944538 --> -0.956545).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0567746
	speed: 0.2389s/iter; left time: 5242.2811s
	iters: 200, epoch: 4 | loss: 0.0185387
	speed: 0.0371s/iter; left time: 810.7073s
	iters: 300, epoch: 4 | loss: 0.0168522
	speed: 0.0385s/iter; left time: 837.3744s
	iters: 400, epoch: 4 | loss: 0.0111870
	speed: 0.0373s/iter; left time: 808.3147s
Epoch: 4 cost time: 18.019195795059204
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.956545 --> -0.967123).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0019629
	speed: 0.2306s/iter; left time: 4952.3269s
	iters: 200, epoch: 5 | loss: 0.0943199
	speed: 0.0371s/iter; left time: 793.8142s
	iters: 300, epoch: 5 | loss: 0.0268754
	speed: 0.0380s/iter; left time: 808.5303s
	iters: 400, epoch: 5 | loss: 0.0052176
	speed: 0.0381s/iter; left time: 806.8268s
Epoch: 5 cost time: 17.922677516937256
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
Validation loss decreased (-0.967123 --> -0.975699).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0035457
	speed: 0.2352s/iter; left time: 4940.6172s
	iters: 200, epoch: 6 | loss: 0.0723165
	speed: 0.0404s/iter; left time: 845.1130s
	iters: 300, epoch: 6 | loss: 0.0122955
	speed: 0.0403s/iter; left time: 838.8291s
	iters: 400, epoch: 6 | loss: 0.0031062
	speed: 0.0388s/iter; left time: 804.3925s
Epoch: 6 cost time: 18.81839656829834
Epoch: 6, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0101395
	speed: 0.2189s/iter; left time: 4495.7729s
	iters: 200, epoch: 7 | loss: 0.0113646
	speed: 0.0392s/iter; left time: 800.5102s
	iters: 300, epoch: 7 | loss: 0.0047021
	speed: 0.0393s/iter; left time: 798.3467s
	iters: 400, epoch: 7 | loss: 0.0014810
	speed: 0.0402s/iter; left time: 812.6393s
Epoch: 7 cost time: 18.66952919960022
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0309223
	speed: 0.2257s/iter; left time: 4529.1497s
	iters: 200, epoch: 8 | loss: 0.0290938
	speed: 0.0396s/iter; left time: 790.0829s
	iters: 300, epoch: 8 | loss: 0.0003228
	speed: 0.0397s/iter; left time: 789.6614s
	iters: 400, epoch: 8 | loss: 0.0009062
	speed: 0.0399s/iter; left time: 789.4398s
Epoch: 8 cost time: 18.41939663887024
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0006280
	speed: 0.2110s/iter; left time: 4134.5153s
	iters: 200, epoch: 9 | loss: 0.0124731
	speed: 0.0372s/iter; left time: 726.0058s
	iters: 300, epoch: 9 | loss: 0.0036895
	speed: 0.0395s/iter; left time: 766.8460s
	iters: 400, epoch: 9 | loss: 0.0018302
	speed: 0.0373s/iter; left time: 719.2167s
Epoch: 9 cost time: 18.08981966972351
Epoch: 9, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
Validation loss decreased (-0.975699 --> -0.981131).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0080678
	speed: 0.2297s/iter; left time: 4395.0877s
	iters: 200, epoch: 10 | loss: 0.0414294
	speed: 0.0376s/iter; left time: 716.0501s
	iters: 300, epoch: 10 | loss: 0.0010341
	speed: 0.0370s/iter; left time: 700.6805s
	iters: 400, epoch: 10 | loss: 0.0051944
	speed: 0.0362s/iter; left time: 681.6849s
Epoch: 10 cost time: 17.677749156951904
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0041312
	speed: 0.2305s/iter; left time: 4301.5391s
	iters: 200, epoch: 11 | loss: 0.0060024
	speed: 0.0367s/iter; left time: 681.2497s
	iters: 300, epoch: 11 | loss: 0.0006000
	speed: 0.0371s/iter; left time: 685.2096s
	iters: 400, epoch: 11 | loss: 0.0014239
	speed: 0.0384s/iter; left time: 705.4365s
Epoch: 11 cost time: 17.63109540939331
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0002005
	speed: 0.2402s/iter; left time: 4370.6254s
	iters: 200, epoch: 12 | loss: 0.0204124
	speed: 0.0368s/iter; left time: 666.0872s
	iters: 300, epoch: 12 | loss: 0.0004186
	speed: 0.0361s/iter; left time: 649.6538s
	iters: 400, epoch: 12 | loss: 0.0025021
	speed: 0.0364s/iter; left time: 650.6569s
Epoch: 12 cost time: 17.60478711128235
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0009602
	speed: 0.2374s/iter; left time: 4208.2158s
	iters: 200, epoch: 13 | loss: 0.0044039
	speed: 0.0417s/iter; left time: 734.1924s
	iters: 300, epoch: 13 | loss: 0.0001506
	speed: 0.0373s/iter; left time: 654.4577s
	iters: 400, epoch: 13 | loss: 0.0089415
	speed: 0.0372s/iter; left time: 648.1737s
Epoch: 13 cost time: 18.429643154144287
Epoch: 13, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0024276
	speed: 0.2283s/iter; left time: 3939.6000s
	iters: 200, epoch: 14 | loss: 0.0038978
	speed: 0.0366s/iter; left time: 627.7451s
	iters: 300, epoch: 14 | loss: 0.0007767
	speed: 0.0377s/iter; left time: 643.7708s
	iters: 400, epoch: 14 | loss: 0.0002810
	speed: 0.0377s/iter; left time: 639.0076s
Epoch: 14 cost time: 17.964075565338135
Epoch: 14, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0004986
	speed: 0.2288s/iter; left time: 3841.1712s
	iters: 200, epoch: 15 | loss: 0.0004234
	speed: 0.0426s/iter; left time: 711.3874s
	iters: 300, epoch: 15 | loss: 0.0020382
	speed: 0.0410s/iter; left time: 680.2471s
	iters: 400, epoch: 15 | loss: 0.0810342
	speed: 0.0389s/iter; left time: 641.3693s
Epoch: 15 cost time: 19.22585964202881
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0009589
	speed: 0.2132s/iter; left time: 3479.3828s
	iters: 200, epoch: 16 | loss: 0.0050231
	speed: 0.0368s/iter; left time: 596.7055s
	iters: 300, epoch: 16 | loss: 0.0072671
	speed: 0.0376s/iter; left time: 605.4506s
	iters: 400, epoch: 16 | loss: 0.0004029
	speed: 0.0391s/iter; left time: 626.2911s
Epoch: 16 cost time: 17.998525619506836
Epoch: 16, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0116851
	speed: 0.2252s/iter; left time: 3568.9881s
	iters: 200, epoch: 17 | loss: 0.0028629
	speed: 0.0367s/iter; left time: 577.6686s
	iters: 300, epoch: 17 | loss: 0.0007525
	speed: 0.0377s/iter; left time: 589.2309s
	iters: 400, epoch: 17 | loss: 0.0009377
	speed: 0.0396s/iter; left time: 614.9039s
Epoch: 17 cost time: 18.12506127357483
Epoch: 17, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.972 Test Loss: 0.208 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0038428
	speed: 0.2213s/iter; left time: 3403.3766s
	iters: 200, epoch: 18 | loss: 0.0370560
	speed: 0.0361s/iter; left time: 551.7541s
	iters: 300, epoch: 18 | loss: 0.0092850
	speed: 0.0374s/iter; left time: 567.6138s
	iters: 400, epoch: 18 | loss: 0.0000212
	speed: 0.0384s/iter; left time: 579.4946s
Epoch: 18 cost time: 17.862932920455933
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000127
	speed: 0.2402s/iter; left time: 3581.0850s
	iters: 200, epoch: 19 | loss: 0.0006861
	speed: 0.0379s/iter; left time: 561.2096s
	iters: 300, epoch: 19 | loss: 0.0003566
	speed: 0.0366s/iter; left time: 537.8488s
	iters: 400, epoch: 19 | loss: 0.0885342
	speed: 0.0355s/iter; left time: 519.0098s
Epoch: 19 cost time: 17.56732177734375
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 35914
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4373871
	speed: 0.0533s/iter; left time: 1244.1765s
	iters: 200, epoch: 1 | loss: 0.4048211
	speed: 0.0383s/iter; left time: 890.9844s
	iters: 300, epoch: 1 | loss: 0.4887626
	speed: 0.0392s/iter; left time: 907.9680s
	iters: 400, epoch: 1 | loss: 0.1026264
	speed: 0.0393s/iter; left time: 906.2111s
Epoch: 1 cost time: 19.791823387145996
Epoch: 1, Steps: 469 | Train Loss: 0.805 Vali Loss: 0.306 Vali Acc: 0.919 Test Loss: 0.306 Test Acc: 0.919
Validation loss decreased (inf --> -0.918808).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1167767
	speed: 0.2202s/iter; left time: 5037.7865s
	iters: 200, epoch: 2 | loss: 0.1205558
	speed: 0.0362s/iter; left time: 824.5247s
	iters: 300, epoch: 2 | loss: 0.0729589
	speed: 0.0383s/iter; left time: 868.3735s
	iters: 400, epoch: 2 | loss: 0.0228462
	speed: 0.0387s/iter; left time: 873.1684s
Epoch: 2 cost time: 17.869523286819458
Epoch: 2, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
Validation loss decreased (-0.918808 --> -0.963120).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0155440
	speed: 0.2276s/iter; left time: 5100.8675s
	iters: 200, epoch: 3 | loss: 0.0602881
	speed: 0.0363s/iter; left time: 810.9364s
	iters: 300, epoch: 3 | loss: 0.0456239
	speed: 0.0370s/iter; left time: 821.1178s
	iters: 400, epoch: 3 | loss: 0.0030530
	speed: 0.0374s/iter; left time: 827.0992s
Epoch: 3 cost time: 17.48965620994568
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.963120 --> -0.967122).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1674043
	speed: 0.1868s/iter; left time: 4099.2556s
	iters: 200, epoch: 4 | loss: 0.0442997
	speed: 0.0381s/iter; left time: 833.2979s
	iters: 300, epoch: 4 | loss: 0.0052863
	speed: 0.0384s/iter; left time: 835.8587s
	iters: 400, epoch: 4 | loss: 0.2805303
	speed: 0.0375s/iter; left time: 811.2398s
Epoch: 4 cost time: 17.772424936294556
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0073355
	speed: 0.2234s/iter; left time: 4797.5494s
	iters: 200, epoch: 5 | loss: 0.0155505
	speed: 0.0375s/iter; left time: 801.7150s
	iters: 300, epoch: 5 | loss: 0.0111943
	speed: 0.0385s/iter; left time: 819.6803s
	iters: 400, epoch: 5 | loss: 0.2314868
	speed: 0.0376s/iter; left time: 796.0965s
Epoch: 5 cost time: 17.98594069480896
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
Validation loss decreased (-0.967122 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0008308
	speed: 0.2084s/iter; left time: 4376.9936s
	iters: 200, epoch: 6 | loss: 0.0103248
	speed: 0.0314s/iter; left time: 656.4955s
	iters: 300, epoch: 6 | loss: 0.0012256
	speed: 0.0328s/iter; left time: 681.8680s
	iters: 400, epoch: 6 | loss: 0.0005426
	speed: 0.0390s/iter; left time: 808.0506s
Epoch: 6 cost time: 16.441736221313477
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
Validation loss decreased (-0.973984 --> -0.977700).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0018047
	speed: 0.2304s/iter; left time: 4731.0982s
	iters: 200, epoch: 7 | loss: 0.0068935
	speed: 0.0372s/iter; left time: 760.3566s
	iters: 300, epoch: 7 | loss: 0.0088304
	speed: 0.0372s/iter; left time: 756.5752s
	iters: 400, epoch: 7 | loss: 0.0323780
	speed: 0.0401s/iter; left time: 810.6077s
Epoch: 7 cost time: 18.15775990486145
Epoch: 7, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.977700 --> -0.980273).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0014098
	speed: 0.2219s/iter; left time: 4453.2917s
	iters: 200, epoch: 8 | loss: 0.0012231
	speed: 0.0372s/iter; left time: 743.0980s
	iters: 300, epoch: 8 | loss: 0.0086864
	speed: 0.0371s/iter; left time: 737.2444s
	iters: 400, epoch: 8 | loss: 0.0823003
	speed: 0.0368s/iter; left time: 727.3919s
Epoch: 8 cost time: 17.592868089675903
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0059684
	speed: 0.2344s/iter; left time: 4593.7121s
	iters: 200, epoch: 9 | loss: 0.0017295
	speed: 0.0366s/iter; left time: 713.6074s
	iters: 300, epoch: 9 | loss: 0.0003752
	speed: 0.0366s/iter; left time: 710.8859s
	iters: 400, epoch: 9 | loss: 0.0002000
	speed: 0.0351s/iter; left time: 678.3003s
Epoch: 9 cost time: 17.266067266464233
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0040872
	speed: 0.2184s/iter; left time: 4178.7361s
	iters: 200, epoch: 10 | loss: 0.0068139
	speed: 0.0363s/iter; left time: 690.7326s
	iters: 300, epoch: 10 | loss: 0.0002054
	speed: 0.0346s/iter; left time: 654.6126s
	iters: 400, epoch: 10 | loss: 0.0009669
	speed: 0.0357s/iter; left time: 673.0097s
Epoch: 10 cost time: 16.972727060317993
Epoch: 10, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001644
	speed: 0.2280s/iter; left time: 4253.8555s
	iters: 200, epoch: 11 | loss: 0.0007506
	speed: 0.0331s/iter; left time: 614.8818s
	iters: 300, epoch: 11 | loss: 0.0002624
	speed: 0.0360s/iter; left time: 664.5080s
	iters: 400, epoch: 11 | loss: 0.0087395
	speed: 0.0340s/iter; left time: 623.6580s
Epoch: 11 cost time: 16.84089493751526
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0031722
	speed: 0.2299s/iter; left time: 4183.0663s
	iters: 200, epoch: 12 | loss: 0.0174644
	speed: 0.0376s/iter; left time: 679.4226s
	iters: 300, epoch: 12 | loss: 0.0045566
	speed: 0.0369s/iter; left time: 664.3483s
	iters: 400, epoch: 12 | loss: 0.0017162
	speed: 0.0357s/iter; left time: 638.7373s
Epoch: 12 cost time: 17.715442657470703
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0003955
	speed: 0.2254s/iter; left time: 3994.7369s
	iters: 200, epoch: 13 | loss: 0.0026505
	speed: 0.0368s/iter; left time: 648.0829s
	iters: 300, epoch: 13 | loss: 0.0002672
	speed: 0.0357s/iter; left time: 626.3867s
	iters: 400, epoch: 13 | loss: 0.0069356
	speed: 0.0375s/iter; left time: 653.4547s
Epoch: 13 cost time: 17.494274616241455
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0001269
	speed: 0.2262s/iter; left time: 3903.0118s
	iters: 200, epoch: 14 | loss: 0.0385906
	speed: 0.0390s/iter; left time: 668.3527s
	iters: 300, epoch: 14 | loss: 0.0009357
	speed: 0.0385s/iter; left time: 656.5341s
	iters: 400, epoch: 14 | loss: 0.0004040
	speed: 0.0365s/iter; left time: 618.2862s
Epoch: 14 cost time: 18.102158784866333
Epoch: 14, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.974 Test Loss: 0.170 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000024
	speed: 0.2139s/iter; left time: 3590.5079s
	iters: 200, epoch: 15 | loss: 0.0000981
	speed: 0.0382s/iter; left time: 637.9872s
	iters: 300, epoch: 15 | loss: 0.0002929
	speed: 0.0402s/iter; left time: 667.0318s
	iters: 400, epoch: 15 | loss: 0.0463247
	speed: 0.0387s/iter; left time: 638.1406s
Epoch: 15 cost time: 18.352380752563477
Epoch: 15, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0148236
	speed: 0.2256s/iter; left time: 3680.3349s
	iters: 200, epoch: 16 | loss: 0.0144609
	speed: 0.0380s/iter; left time: 616.0517s
	iters: 300, epoch: 16 | loss: 0.0003429
	speed: 0.0390s/iter; left time: 628.5519s
	iters: 400, epoch: 16 | loss: 0.0034860
	speed: 0.0385s/iter; left time: 616.4882s
Epoch: 16 cost time: 18.378753662109375
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.970 Test Loss: 0.192 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0015857
	speed: 0.2082s/iter; left time: 3298.9056s
	iters: 200, epoch: 17 | loss: 0.2162985
	speed: 0.0399s/iter; left time: 628.1923s
	iters: 300, epoch: 17 | loss: 0.0001910
	speed: 0.0402s/iter; left time: 629.1404s
	iters: 400, epoch: 17 | loss: 0.0001920
	speed: 0.0381s/iter; left time: 592.5760s
Epoch: 17 cost time: 18.604223489761353
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.969 Test Loss: 0.216 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 35946
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2758726
	speed: 0.0623s/iter; left time: 1454.3489s
	iters: 200, epoch: 1 | loss: 0.5032277
	speed: 0.0568s/iter; left time: 1321.3710s
	iters: 300, epoch: 1 | loss: 0.0967240
	speed: 0.0552s/iter; left time: 1278.4704s
	iters: 400, epoch: 1 | loss: 0.0333017
	speed: 0.0561s/iter; left time: 1292.3193s
Epoch: 1 cost time: 27.05699849128723
Epoch: 1, Steps: 469 | Train Loss: 0.405 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (inf --> -0.956259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0430651
	speed: 0.3472s/iter; left time: 7945.3181s
	iters: 200, epoch: 2 | loss: 0.0442849
	speed: 0.0510s/iter; left time: 1161.6071s
	iters: 300, epoch: 2 | loss: 0.0715754
	speed: 0.0520s/iter; left time: 1178.6075s
	iters: 400, epoch: 2 | loss: 0.0018551
	speed: 0.0559s/iter; left time: 1261.3494s
Epoch: 2 cost time: 25.613795042037964
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0121308
	speed: 0.3424s/iter; left time: 7673.5854s
	iters: 200, epoch: 3 | loss: 0.0000648
	speed: 0.0589s/iter; left time: 1315.2378s
	iters: 300, epoch: 3 | loss: 0.0007336
	speed: 0.0588s/iter; left time: 1307.2216s
	iters: 400, epoch: 3 | loss: 0.0008354
	speed: 0.0580s/iter; left time: 1281.9141s
Epoch: 3 cost time: 27.233269453048706
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.233 Vali Acc: 0.957 Test Loss: 0.233 Test Acc: 0.957
Validation loss decreased (-0.956259 --> -0.956544).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0005699
	speed: 0.3304s/iter; left time: 7251.0677s
	iters: 200, epoch: 4 | loss: 0.0023916
	speed: 0.0592s/iter; left time: 1292.5683s
	iters: 300, epoch: 4 | loss: 0.1020688
	speed: 0.0569s/iter; left time: 1236.4981s
	iters: 400, epoch: 4 | loss: 0.2560180
	speed: 0.0535s/iter; left time: 1158.6889s
Epoch: 4 cost time: 26.941189765930176
Epoch: 4, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
Validation loss decreased (-0.956544 --> -0.968837).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0115792
	speed: 0.3227s/iter; left time: 6929.5895s
	iters: 200, epoch: 5 | loss: 0.0394614
	speed: 0.0538s/iter; left time: 1149.1673s
	iters: 300, epoch: 5 | loss: 0.0000440
	speed: 0.0545s/iter; left time: 1159.5355s
	iters: 400, epoch: 5 | loss: 0.3447614
	speed: 0.0540s/iter; left time: 1144.3659s
Epoch: 5 cost time: 25.931393146514893
Epoch: 5, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
Validation loss decreased (-0.968837 --> -0.970267).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000430
	speed: 0.3375s/iter; left time: 7089.7117s
	iters: 200, epoch: 6 | loss: 0.0000367
	speed: 0.0503s/iter; left time: 1051.7075s
	iters: 300, epoch: 6 | loss: 0.0159452
	speed: 0.0520s/iter; left time: 1081.3643s
	iters: 400, epoch: 6 | loss: 0.0000193
	speed: 0.0587s/iter; left time: 1215.3895s
Epoch: 6 cost time: 25.484675884246826
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
Validation loss decreased (-0.970267 --> -0.973697).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1680573
	speed: 0.3407s/iter; left time: 6996.7144s
	iters: 200, epoch: 7 | loss: 0.0095790
	speed: 0.0560s/iter; left time: 1145.0708s
	iters: 300, epoch: 7 | loss: 0.0000011
	speed: 0.0523s/iter; left time: 1063.1982s
	iters: 400, epoch: 7 | loss: 0.0044170
	speed: 0.0450s/iter; left time: 911.4384s
Epoch: 7 cost time: 24.253733158111572
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.973697 --> -0.975413).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000176
	speed: 0.3556s/iter; left time: 7135.7295s
	iters: 200, epoch: 8 | loss: 0.0000272
	speed: 0.0614s/iter; left time: 1226.5306s
	iters: 300, epoch: 8 | loss: 0.0000159
	speed: 0.0589s/iter; left time: 1170.9843s
	iters: 400, epoch: 8 | loss: 0.0005334
	speed: 0.0567s/iter; left time: 1120.2496s
Epoch: 8 cost time: 27.935545206069946
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000056
	speed: 0.3485s/iter; left time: 6830.7119s
	iters: 200, epoch: 9 | loss: 0.0009044
	speed: 0.0632s/iter; left time: 1231.4119s
	iters: 300, epoch: 9 | loss: 0.0000201
	speed: 0.0596s/iter; left time: 1155.5461s
	iters: 400, epoch: 9 | loss: 0.0001493
	speed: 0.0583s/iter; left time: 1124.6186s
Epoch: 9 cost time: 28.377362728118896
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000014
	speed: 0.3479s/iter; left time: 6654.4101s
	iters: 200, epoch: 10 | loss: 0.0000248
	speed: 0.0612s/iter; left time: 1165.3393s
	iters: 300, epoch: 10 | loss: 0.0029485
	speed: 0.0633s/iter; left time: 1198.2654s
	iters: 400, epoch: 10 | loss: 0.0023045
	speed: 0.0645s/iter; left time: 1214.2700s
Epoch: 10 cost time: 29.839818716049194
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.282 Vali Acc: 0.961 Test Loss: 0.282 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.3104706
	speed: 0.3730s/iter; left time: 6961.4653s
	iters: 200, epoch: 11 | loss: 0.0000143
	speed: 0.0665s/iter; left time: 1233.9797s
	iters: 300, epoch: 11 | loss: 0.0005163
	speed: 0.0647s/iter; left time: 1193.9352s
	iters: 400, epoch: 11 | loss: 0.0602725
	speed: 0.0625s/iter; left time: 1148.1354s
Epoch: 11 cost time: 30.792048931121826
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.269 Vali Acc: 0.972 Test Loss: 0.269 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3315469
	speed: 0.3660s/iter; left time: 6658.7007s
	iters: 200, epoch: 12 | loss: 0.0000095
	speed: 0.0738s/iter; left time: 1335.9941s
	iters: 300, epoch: 12 | loss: 0.0001094
	speed: 0.0753s/iter; left time: 1355.3460s
	iters: 400, epoch: 12 | loss: 0.0038490
	speed: 0.0705s/iter; left time: 1260.7850s
Epoch: 12 cost time: 33.00687098503113
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
Validation loss decreased (-0.975413 --> -0.979415).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000008
	speed: 0.4078s/iter; left time: 7227.4158s
	iters: 200, epoch: 13 | loss: 0.0000818
	speed: 0.0664s/iter; left time: 1170.7182s
	iters: 300, epoch: 13 | loss: 0.0019077
	speed: 0.0732s/iter; left time: 1282.9234s
	iters: 400, epoch: 13 | loss: 0.0009412
	speed: 0.0720s/iter; left time: 1254.8678s
Epoch: 13 cost time: 32.795392751693726
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000206
	speed: 0.4221s/iter; left time: 7282.2735s
	iters: 200, epoch: 14 | loss: 0.0000334
	speed: 0.0588s/iter; left time: 1009.3836s
	iters: 300, epoch: 14 | loss: 0.0001436
	speed: 0.0625s/iter; left time: 1065.6730s
	iters: 400, epoch: 14 | loss: 0.0000916
	speed: 0.0650s/iter; left time: 1101.8741s
Epoch: 14 cost time: 29.76520347595215
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.278 Vali Acc: 0.965 Test Loss: 0.278 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.9743217
	speed: 0.4214s/iter; left time: 7073.4307s
	iters: 200, epoch: 15 | loss: 0.0012506
	speed: 0.0618s/iter; left time: 1030.7528s
	iters: 300, epoch: 15 | loss: 0.0000004
	speed: 0.0608s/iter; left time: 1008.0912s
	iters: 400, epoch: 15 | loss: 0.0000827
	speed: 0.0605s/iter; left time: 997.0337s
Epoch: 15 cost time: 29.42496418952942
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.331 Vali Acc: 0.964 Test Loss: 0.331 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0097409
	speed: 0.4173s/iter; left time: 6808.4796s
	iters: 200, epoch: 16 | loss: 0.0000004
	speed: 0.0692s/iter; left time: 1122.8292s
	iters: 300, epoch: 16 | loss: 0.0000380
	speed: 0.0687s/iter; left time: 1107.2554s
	iters: 400, epoch: 16 | loss: 0.0000167
	speed: 0.0644s/iter; left time: 1030.7131s
Epoch: 16 cost time: 31.7885160446167
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.976 Test Loss: 0.210 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0004262
	speed: 0.3919s/iter; left time: 6210.2632s
	iters: 200, epoch: 17 | loss: 0.0000173
	speed: 0.0591s/iter; left time: 930.4999s
	iters: 300, epoch: 17 | loss: 0.0000046
	speed: 0.0704s/iter; left time: 1101.3482s
	iters: 400, epoch: 17 | loss: 0.0014596
	speed: 0.0706s/iter; left time: 1098.0371s
Epoch: 17 cost time: 31.21782159805298
Epoch: 17, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.210 Vali Acc: 0.971 Test Loss: 0.210 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0001441
	speed: 0.4124s/iter; left time: 6341.9137s
	iters: 200, epoch: 18 | loss: 0.0004391
	speed: 0.0668s/iter; left time: 1020.9645s
	iters: 300, epoch: 18 | loss: 0.0000069
	speed: 0.0656s/iter; left time: 995.2439s
	iters: 400, epoch: 18 | loss: 0.0000893
	speed: 0.0704s/iter; left time: 1061.0667s
Epoch: 18 cost time: 32.76220655441284
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.230 Vali Acc: 0.974 Test Loss: 0.230 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000010
	speed: 0.4103s/iter; left time: 6117.5085s
	iters: 200, epoch: 19 | loss: 0.0002206
	speed: 0.0691s/iter; left time: 1022.7669s
	iters: 300, epoch: 19 | loss: 0.0000032
	speed: 0.0658s/iter; left time: 967.4457s
	iters: 400, epoch: 19 | loss: 0.0000065
	speed: 0.0643s/iter; left time: 939.8847s
Epoch: 19 cost time: 32.075434923172
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.279 Vali Acc: 0.965 Test Loss: 0.279 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1693374
	speed: 0.3949s/iter; left time: 5702.1607s
	iters: 200, epoch: 20 | loss: 0.0002316
	speed: 0.0686s/iter; left time: 984.4046s
	iters: 300, epoch: 20 | loss: 0.0000187
	speed: 0.0688s/iter; left time: 979.0840s
	iters: 400, epoch: 20 | loss: 0.0002553
	speed: 0.0694s/iter; left time: 981.5725s
Epoch: 20 cost time: 32.34148859977722
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.332 Vali Acc: 0.962 Test Loss: 0.332 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.4054s/iter; left time: 5663.3422s
	iters: 200, epoch: 21 | loss: 0.0000474
	speed: 0.0655s/iter; left time: 909.1879s
	iters: 300, epoch: 21 | loss: 0.0002543
	speed: 0.0688s/iter; left time: 947.0507s
	iters: 400, epoch: 21 | loss: 0.0000332
	speed: 0.0702s/iter; left time: 959.4059s
Epoch: 21 cost time: 32.54645824432373
Epoch: 21, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0009800
	speed: 0.4137s/iter; left time: 5585.9239s
	iters: 200, epoch: 22 | loss: 0.0000135
	speed: 0.0627s/iter; left time: 840.4799s
	iters: 300, epoch: 22 | loss: 0.0023671
	speed: 0.0632s/iter; left time: 840.2345s
	iters: 400, epoch: 22 | loss: 0.0000038
	speed: 0.0656s/iter; left time: 865.6619s
Epoch: 22 cost time: 30.806787490844727
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.264 Vali Acc: 0.973 Test Loss: 0.264 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 435466
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3843671
	speed: 0.0784s/iter; left time: 1830.9260s
	iters: 200, epoch: 1 | loss: 0.1866028
	speed: 0.0697s/iter; left time: 1621.4588s
	iters: 300, epoch: 1 | loss: 0.0944755
	speed: 0.0736s/iter; left time: 1702.8990s
	iters: 400, epoch: 1 | loss: 0.3270399
	speed: 0.0710s/iter; left time: 1635.6706s
Epoch: 1 cost time: 34.12439703941345
Epoch: 1, Steps: 469 | Train Loss: 0.417 Vali Loss: 0.237 Vali Acc: 0.946 Test Loss: 0.237 Test Acc: 0.946
Validation loss decreased (inf --> -0.945681).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2965128
	speed: 0.3927s/iter; left time: 8985.0076s
	iters: 200, epoch: 2 | loss: 0.0162450
	speed: 0.0597s/iter; left time: 1360.6631s
	iters: 300, epoch: 2 | loss: 0.0176582
	speed: 0.0614s/iter; left time: 1393.7941s
	iters: 400, epoch: 2 | loss: 0.1753849
	speed: 0.0662s/iter; left time: 1495.1823s
Epoch: 2 cost time: 29.886546850204468
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.945681 --> -0.957688).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0588865
	speed: 0.4028s/iter; left time: 9028.0943s
	iters: 200, epoch: 3 | loss: 0.0026708
	speed: 0.0617s/iter; left time: 1377.4105s
	iters: 300, epoch: 3 | loss: 0.0000354
	speed: 0.0621s/iter; left time: 1380.4560s
	iters: 400, epoch: 3 | loss: 0.0026879
	speed: 0.0583s/iter; left time: 1288.3173s
Epoch: 3 cost time: 28.784522533416748
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
Validation loss decreased (-0.957688 --> -0.968838).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1724194
	speed: 0.4194s/iter; left time: 9203.3938s
	iters: 200, epoch: 4 | loss: 0.0000378
	speed: 0.0649s/iter; left time: 1417.3143s
	iters: 300, epoch: 4 | loss: 0.0296620
	speed: 0.0619s/iter; left time: 1346.4808s
	iters: 400, epoch: 4 | loss: 0.0071529
	speed: 0.0611s/iter; left time: 1321.9055s
Epoch: 4 cost time: 30.17378258705139
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.239 Vali Acc: 0.954 Test Loss: 0.239 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0097421
	speed: 0.4093s/iter; left time: 8788.7859s
	iters: 200, epoch: 5 | loss: 0.0032450
	speed: 0.0718s/iter; left time: 1534.4297s
	iters: 300, epoch: 5 | loss: 0.0000116
	speed: 0.0680s/iter; left time: 1445.7682s
	iters: 400, epoch: 5 | loss: 0.0043490
	speed: 0.0589s/iter; left time: 1247.0062s
Epoch: 5 cost time: 30.626991033554077
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0006405
	speed: 0.4062s/iter; left time: 8532.2935s
	iters: 200, epoch: 6 | loss: 0.0007725
	speed: 0.0697s/iter; left time: 1457.4480s
	iters: 300, epoch: 6 | loss: 0.0568085
	speed: 0.0728s/iter; left time: 1514.3608s
	iters: 400, epoch: 6 | loss: 0.0000118
	speed: 0.0717s/iter; left time: 1483.6740s
Epoch: 6 cost time: 32.61510610580444
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.294 Vali Acc: 0.957 Test Loss: 0.294 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0009538
	speed: 0.3804s/iter; left time: 7812.9688s
	iters: 200, epoch: 7 | loss: 0.0031614
	speed: 0.0667s/iter; left time: 1363.9114s
	iters: 300, epoch: 7 | loss: 0.2194000
	speed: 0.0695s/iter; left time: 1414.3412s
	iters: 400, epoch: 7 | loss: 0.2852238
	speed: 0.0711s/iter; left time: 1438.4990s
Epoch: 7 cost time: 32.24406599998474
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.969 Test Loss: 0.202 Test Acc: 0.969
Validation loss decreased (-0.968838 --> -0.969409).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000003
	speed: 0.3736s/iter; left time: 7497.5804s
	iters: 200, epoch: 8 | loss: 0.0023364
	speed: 0.0667s/iter; left time: 1332.0721s
	iters: 300, epoch: 8 | loss: 0.0138706
	speed: 0.0673s/iter; left time: 1337.0543s
	iters: 400, epoch: 8 | loss: 0.0000371
	speed: 0.0701s/iter; left time: 1385.2424s
Epoch: 8 cost time: 32.062376737594604
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
Validation loss decreased (-0.969409 --> -0.977700).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3172881
	speed: 0.3907s/iter; left time: 7657.7208s
	iters: 200, epoch: 9 | loss: 0.3335872
	speed: 0.0659s/iter; left time: 1284.3093s
	iters: 300, epoch: 9 | loss: 0.0036339
	speed: 0.0684s/iter; left time: 1327.4229s
	iters: 400, epoch: 9 | loss: 0.0003445
	speed: 0.0709s/iter; left time: 1368.9421s
Epoch: 9 cost time: 31.764676094055176
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.305 Vali Acc: 0.963 Test Loss: 0.305 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002087
	speed: 0.4026s/iter; left time: 7701.4981s
	iters: 200, epoch: 10 | loss: 0.0000017
	speed: 0.0572s/iter; left time: 1088.9995s
	iters: 300, epoch: 10 | loss: 0.0114284
	speed: 0.0621s/iter; left time: 1175.9407s
	iters: 400, epoch: 10 | loss: 0.0000952
	speed: 0.0702s/iter; left time: 1321.8524s
Epoch: 10 cost time: 30.388185024261475
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.398 Vali Acc: 0.963 Test Loss: 0.398 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0006355
	speed: 0.4229s/iter; left time: 7892.2868s
	iters: 200, epoch: 11 | loss: 0.0061490
	speed: 0.0618s/iter; left time: 1147.5099s
	iters: 300, epoch: 11 | loss: 0.0002373
	speed: 0.0572s/iter; left time: 1055.3909s
	iters: 400, epoch: 11 | loss: 0.0008241
	speed: 0.0579s/iter; left time: 1063.9314s
Epoch: 11 cost time: 29.595721006393433
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.326 Vali Acc: 0.962 Test Loss: 0.326 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000381
	speed: 0.4254s/iter; left time: 7738.3980s
	iters: 200, epoch: 12 | loss: 0.0000021
	speed: 0.0681s/iter; left time: 1231.6513s
	iters: 300, epoch: 12 | loss: 0.0004092
	speed: 0.0607s/iter; left time: 1091.6544s
	iters: 400, epoch: 12 | loss: 0.0000038
	speed: 0.0573s/iter; left time: 1025.0545s
Epoch: 12 cost time: 29.895251035690308
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.314 Vali Acc: 0.976 Test Loss: 0.314 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.7996073
	speed: 0.3898s/iter; left time: 6908.5874s
	iters: 200, epoch: 13 | loss: 0.0000097
	speed: 0.0693s/iter; left time: 1220.6071s
	iters: 300, epoch: 13 | loss: 0.0000542
	speed: 0.0672s/iter; left time: 1177.7788s
	iters: 400, epoch: 13 | loss: 0.3498767
	speed: 0.0608s/iter; left time: 1059.9902s
Epoch: 13 cost time: 31.01851749420166
Epoch: 13, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.385 Vali Acc: 0.966 Test Loss: 0.385 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0002384
	speed: 0.3886s/iter; left time: 6704.8878s
	iters: 200, epoch: 14 | loss: 0.0000126
	speed: 0.0711s/iter; left time: 1220.2451s
	iters: 300, epoch: 14 | loss: 0.0000002
	speed: 0.0722s/iter; left time: 1230.6681s
	iters: 400, epoch: 14 | loss: 0.0002927
	speed: 0.0679s/iter; left time: 1150.5730s
Epoch: 14 cost time: 32.66126728057861
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.388 Vali Acc: 0.969 Test Loss: 0.388 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000055
	speed: 0.3846s/iter; left time: 6455.1053s
	iters: 200, epoch: 15 | loss: 0.0000151
	speed: 0.0703s/iter; left time: 1173.4791s
	iters: 300, epoch: 15 | loss: 0.2237567
	speed: 0.0706s/iter; left time: 1170.7089s
	iters: 400, epoch: 15 | loss: 0.2974916
	speed: 0.0667s/iter; left time: 1100.3453s
Epoch: 15 cost time: 32.27853560447693
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.286 Vali Acc: 0.973 Test Loss: 0.286 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001247
	speed: 0.3905s/iter; left time: 6371.5869s
	iters: 200, epoch: 16 | loss: 0.0001556
	speed: 0.0665s/iter; left time: 1078.1831s
	iters: 300, epoch: 16 | loss: 0.0367421
	speed: 0.0734s/iter; left time: 1182.1329s
	iters: 400, epoch: 16 | loss: 0.0000021
	speed: 0.0731s/iter; left time: 1170.8553s
Epoch: 16 cost time: 32.756401777267456
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.265 Vali Acc: 0.976 Test Loss: 0.265 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0056852
	speed: 0.4158s/iter; left time: 6589.3194s
	iters: 200, epoch: 17 | loss: 0.0165958
	speed: 0.0623s/iter; left time: 981.2238s
	iters: 300, epoch: 17 | loss: 0.0000094
	speed: 0.0667s/iter; left time: 1043.7401s
	iters: 400, epoch: 17 | loss: 0.0966525
	speed: 0.0694s/iter; left time: 1078.8295s
Epoch: 17 cost time: 31.56524348258972
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0118840
	speed: 0.4098s/iter; left time: 6301.8225s
	iters: 200, epoch: 18 | loss: 0.0000023
	speed: 0.0579s/iter; left time: 884.7744s
	iters: 300, epoch: 18 | loss: 0.0000167
	speed: 0.0602s/iter; left time: 914.1311s
	iters: 400, epoch: 18 | loss: 0.0014036
	speed: 0.0681s/iter; left time: 1027.0874s
Epoch: 18 cost time: 29.762623071670532
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.344 Vali Acc: 0.971 Test Loss: 0.344 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 435594
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8294854
	speed: 0.0736s/iter; left time: 1718.5855s
	iters: 200, epoch: 1 | loss: 0.1843490
	speed: 0.0554s/iter; left time: 1289.0443s
	iters: 300, epoch: 1 | loss: 0.1557649
	speed: 0.0530s/iter; left time: 1228.0629s
	iters: 400, epoch: 1 | loss: 0.1500189
	speed: 0.0530s/iter; left time: 1222.3409s
Epoch: 1 cost time: 27.53187584877014
Epoch: 1, Steps: 469 | Train Loss: 0.594 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (inf --> -0.937391).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0809561
	speed: 0.3441s/iter; left time: 7873.8689s
	iters: 200, epoch: 2 | loss: 0.0030497
	speed: 0.0491s/iter; left time: 1117.8892s
	iters: 300, epoch: 2 | loss: 0.7831757
	speed: 0.0489s/iter; left time: 1108.1418s
	iters: 400, epoch: 2 | loss: 0.0492158
	speed: 0.0467s/iter; left time: 1055.6469s
Epoch: 2 cost time: 23.37912893295288
Epoch: 2, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
Validation loss decreased (-0.937391 --> -0.961405).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1972280
	speed: 0.3375s/iter; left time: 7563.3639s
	iters: 200, epoch: 3 | loss: 0.5709831
	speed: 0.0576s/iter; left time: 1285.2806s
	iters: 300, epoch: 3 | loss: 0.0067961
	speed: 0.0548s/iter; left time: 1217.4796s
	iters: 400, epoch: 3 | loss: 0.2679173
	speed: 0.0532s/iter; left time: 1177.4007s
Epoch: 3 cost time: 26.002071142196655
Epoch: 3, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
Validation loss decreased (-0.961405 --> -0.966265).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1583936
	speed: 0.3296s/iter; left time: 7233.5469s
	iters: 200, epoch: 4 | loss: 0.0052762
	speed: 0.0530s/iter; left time: 1157.3033s
	iters: 300, epoch: 4 | loss: 0.5415466
	speed: 0.0550s/iter; left time: 1195.9780s
	iters: 400, epoch: 4 | loss: 0.0028866
	speed: 0.0555s/iter; left time: 1200.9829s
Epoch: 4 cost time: 25.929404973983765
Epoch: 4, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.966265 --> -0.967694).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0026524
	speed: 0.3192s/iter; left time: 6854.7879s
	iters: 200, epoch: 5 | loss: 0.0012190
	speed: 0.0563s/iter; left time: 1203.8696s
	iters: 300, epoch: 5 | loss: 0.0067944
	speed: 0.0546s/iter; left time: 1162.2427s
	iters: 400, epoch: 5 | loss: 0.0698532
	speed: 0.0505s/iter; left time: 1068.3252s
Epoch: 5 cost time: 25.1236629486084
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002508
	speed: 0.3257s/iter; left time: 6841.3163s
	iters: 200, epoch: 6 | loss: 0.0003139
	speed: 0.0519s/iter; left time: 1085.7841s
	iters: 300, epoch: 6 | loss: 0.0039085
	speed: 0.0555s/iter; left time: 1153.9622s
	iters: 400, epoch: 6 | loss: 0.0955255
	speed: 0.0539s/iter; left time: 1115.8295s
Epoch: 6 cost time: 25.131110191345215
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
Validation loss decreased (-0.967694 --> -0.968266).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0004295
	speed: 0.3113s/iter; left time: 6393.8568s
	iters: 200, epoch: 7 | loss: 0.0004579
	speed: 0.0569s/iter; left time: 1162.6434s
	iters: 300, epoch: 7 | loss: 0.0010274
	speed: 0.0564s/iter; left time: 1146.6485s
	iters: 400, epoch: 7 | loss: 0.0041844
	speed: 0.0530s/iter; left time: 1072.2012s
Epoch: 7 cost time: 26.370291709899902
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.968266 --> -0.972554).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0042217
	speed: 0.3416s/iter; left time: 6855.8750s
	iters: 200, epoch: 8 | loss: 0.0038980
	speed: 0.0541s/iter; left time: 1080.6409s
	iters: 300, epoch: 8 | loss: 0.0000616
	speed: 0.0483s/iter; left time: 958.9774s
	iters: 400, epoch: 8 | loss: 0.0000327
	speed: 0.0477s/iter; left time: 943.1174s
Epoch: 8 cost time: 24.62485098838806
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000066
	speed: 0.3408s/iter; left time: 6679.4809s
	iters: 200, epoch: 9 | loss: 0.0825452
	speed: 0.0479s/iter; left time: 934.2775s
	iters: 300, epoch: 9 | loss: 0.0016672
	speed: 0.0501s/iter; left time: 971.8393s
	iters: 400, epoch: 9 | loss: 0.0086927
	speed: 0.0538s/iter; left time: 1038.9724s
Epoch: 9 cost time: 24.63775372505188
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.972554 --> -0.974841).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001432
	speed: 0.3282s/iter; left time: 6278.2565s
	iters: 200, epoch: 10 | loss: 0.0048836
	speed: 0.0527s/iter; left time: 1002.4414s
	iters: 300, epoch: 10 | loss: 0.0003419
	speed: 0.0553s/iter; left time: 1047.7316s
	iters: 400, epoch: 10 | loss: 0.0001933
	speed: 0.0560s/iter; left time: 1055.4049s
Epoch: 10 cost time: 26.056312799453735
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974841 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000841
	speed: 0.3204s/iter; left time: 5979.1719s
	iters: 200, epoch: 11 | loss: 0.0149427
	speed: 0.0538s/iter; left time: 997.6544s
	iters: 300, epoch: 11 | loss: 0.0020423
	speed: 0.0528s/iter; left time: 974.0393s
	iters: 400, epoch: 11 | loss: 0.0050224
	speed: 0.0500s/iter; left time: 917.4119s
Epoch: 11 cost time: 24.258033275604248
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0017136
	speed: 0.3217s/iter; left time: 5853.1978s
	iters: 200, epoch: 12 | loss: 0.0029782
	speed: 0.0570s/iter; left time: 1031.3865s
	iters: 300, epoch: 12 | loss: 0.0184102
	speed: 0.0548s/iter; left time: 986.1690s
	iters: 400, epoch: 12 | loss: 0.1404518
	speed: 0.0518s/iter; left time: 927.4168s
Epoch: 12 cost time: 25.55655336380005
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000358
	speed: 0.3326s/iter; left time: 5894.6156s
	iters: 200, epoch: 13 | loss: 0.0007960
	speed: 0.0523s/iter; left time: 921.7538s
	iters: 300, epoch: 13 | loss: 0.0000450
	speed: 0.0509s/iter; left time: 891.4476s
	iters: 400, epoch: 13 | loss: 0.0018677
	speed: 0.0517s/iter; left time: 901.3942s
Epoch: 13 cost time: 25.2502498626709
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0401167
	speed: 0.3277s/iter; left time: 5654.4869s
	iters: 200, epoch: 14 | loss: 0.0013519
	speed: 0.0526s/iter; left time: 902.3945s
	iters: 300, epoch: 14 | loss: 0.0016838
	speed: 0.0453s/iter; left time: 772.3109s
	iters: 400, epoch: 14 | loss: 0.0001145
	speed: 0.0469s/iter; left time: 795.7818s
Epoch: 14 cost time: 22.95045566558838
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.976556).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0034965
	speed: 0.3197s/iter; left time: 5366.4859s
	iters: 200, epoch: 15 | loss: 0.0000031
	speed: 0.0550s/iter; left time: 918.3444s
	iters: 300, epoch: 15 | loss: 0.0127017
	speed: 0.0577s/iter; left time: 956.6958s
	iters: 400, epoch: 15 | loss: 0.0013901
	speed: 0.0585s/iter; left time: 965.1348s
Epoch: 15 cost time: 26.38214373588562
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
Validation loss decreased (-0.976556 --> -0.978272).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000474
	speed: 0.3207s/iter; left time: 5233.3167s
	iters: 200, epoch: 16 | loss: 0.0077799
	speed: 0.0560s/iter; left time: 907.3196s
	iters: 300, epoch: 16 | loss: 0.0000088
	speed: 0.0546s/iter; left time: 880.2482s
	iters: 400, epoch: 16 | loss: 0.0139045
	speed: 0.0514s/iter; left time: 822.6545s
Epoch: 16 cost time: 25.979494333267212
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0236696
	speed: 0.3248s/iter; left time: 5146.3200s
	iters: 200, epoch: 17 | loss: 0.0007551
	speed: 0.0532s/iter; left time: 837.4495s
	iters: 300, epoch: 17 | loss: 0.0025361
	speed: 0.0487s/iter; left time: 761.2554s
	iters: 400, epoch: 17 | loss: 0.0350225
	speed: 0.0469s/iter; left time: 729.0810s
Epoch: 17 cost time: 23.630020141601562
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000181
	speed: 0.3254s/iter; left time: 5004.4915s
	iters: 200, epoch: 18 | loss: 0.0000019
	speed: 0.0474s/iter; left time: 724.3154s
	iters: 300, epoch: 18 | loss: 0.0228743
	speed: 0.0501s/iter; left time: 760.3657s
	iters: 400, epoch: 18 | loss: 0.0027342
	speed: 0.0551s/iter; left time: 831.3488s
Epoch: 18 cost time: 24.47093439102173
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0009268
	speed: 0.3257s/iter; left time: 4856.2803s
	iters: 200, epoch: 19 | loss: 0.0000200
	speed: 0.0516s/iter; left time: 763.4239s
	iters: 300, epoch: 19 | loss: 0.0053047
	speed: 0.0547s/iter; left time: 804.8385s
	iters: 400, epoch: 19 | loss: 0.0077493
	speed: 0.0564s/iter; left time: 823.7522s
Epoch: 19 cost time: 25.771165370941162
Epoch: 19, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0001558
	speed: 0.3249s/iter; left time: 4691.8189s
	iters: 200, epoch: 20 | loss: 0.0000533
	speed: 0.0536s/iter; left time: 768.6898s
	iters: 300, epoch: 20 | loss: 0.0000028
	speed: 0.0515s/iter; left time: 733.3364s
	iters: 400, epoch: 20 | loss: 0.0028396
	speed: 0.0530s/iter; left time: 749.2234s
Epoch: 20 cost time: 25.07859230041504
Epoch: 20, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.978 Test Loss: 0.167 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0006085
	speed: 0.3305s/iter; left time: 4618.0854s
	iters: 200, epoch: 21 | loss: 0.0001439
	speed: 0.0585s/iter; left time: 811.7022s
	iters: 300, epoch: 21 | loss: 0.0024148
	speed: 0.0567s/iter; left time: 780.5912s
	iters: 400, epoch: 21 | loss: 0.0597084
	speed: 0.0516s/iter; left time: 705.6982s
Epoch: 21 cost time: 26.292339324951172
Epoch: 21, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.982 Test Loss: 0.148 Test Acc: 0.982
Validation loss decreased (-0.978272 --> -0.981702).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000603
	speed: 0.3180s/iter; left time: 4294.2989s
	iters: 200, epoch: 22 | loss: 0.0001488
	speed: 0.0500s/iter; left time: 669.6298s
	iters: 300, epoch: 22 | loss: 0.0000389
	speed: 0.0508s/iter; left time: 675.9069s
	iters: 400, epoch: 22 | loss: 0.0106292
	speed: 0.0533s/iter; left time: 704.1942s
Epoch: 22 cost time: 24.86989450454712
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.260 Vali Acc: 0.961 Test Loss: 0.260 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0025655
	speed: 0.3318s/iter; left time: 4324.7711s
	iters: 200, epoch: 23 | loss: 0.0000648
	speed: 0.0486s/iter; left time: 628.0612s
	iters: 300, epoch: 23 | loss: 0.0000332
	speed: 0.0456s/iter; left time: 584.7463s
	iters: 400, epoch: 23 | loss: 0.0144403
	speed: 0.0516s/iter; left time: 656.4643s
Epoch: 23 cost time: 23.699358224868774
Epoch: 23, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.212 Vali Acc: 0.972 Test Loss: 0.212 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0005128
	speed: 0.3262s/iter; left time: 4097.8082s
	iters: 200, epoch: 24 | loss: 1.0564424
	speed: 0.0545s/iter; left time: 679.2456s
	iters: 300, epoch: 24 | loss: 0.0000124
	speed: 0.0543s/iter; left time: 671.4229s
	iters: 400, epoch: 24 | loss: 0.0058187
	speed: 0.0474s/iter; left time: 581.4216s
Epoch: 24 cost time: 24.33677101135254
Epoch: 24, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.305 Vali Acc: 0.958 Test Loss: 0.305 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000208
	speed: 0.2986s/iter; left time: 3611.2066s
	iters: 200, epoch: 25 | loss: 0.0000002
	speed: 0.0494s/iter; left time: 593.0829s
	iters: 300, epoch: 25 | loss: 0.0008347
	speed: 0.0509s/iter; left time: 605.6120s
	iters: 400, epoch: 25 | loss: 0.0000188
	speed: 0.0560s/iter; left time: 660.8558s
Epoch: 25 cost time: 24.726682901382446
Epoch: 25, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000054
	speed: 0.3258s/iter; left time: 3788.1524s
	iters: 200, epoch: 26 | loss: 0.0004877
	speed: 0.0518s/iter; left time: 596.9516s
	iters: 300, epoch: 26 | loss: 0.0000006
	speed: 0.0506s/iter; left time: 577.9641s
	iters: 400, epoch: 26 | loss: 0.0000004
	speed: 0.0502s/iter; left time: 568.2905s
Epoch: 26 cost time: 24.323489665985107
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.973 Test Loss: 0.212 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000466
	speed: 0.3106s/iter; left time: 3465.7636s
	iters: 200, epoch: 27 | loss: 0.0000805
	speed: 0.0551s/iter; left time: 608.7382s
	iters: 300, epoch: 27 | loss: 0.0000546
	speed: 0.0542s/iter; left time: 593.7662s
	iters: 400, epoch: 27 | loss: 0.0000213
	speed: 0.0493s/iter; left time: 535.4218s
Epoch: 27 cost time: 24.40018105506897
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000017
	speed: 0.3023s/iter; left time: 3230.4740s
	iters: 200, epoch: 28 | loss: 0.0058116
	speed: 0.0470s/iter; left time: 497.6604s
	iters: 300, epoch: 28 | loss: 0.0001527
	speed: 0.0474s/iter; left time: 496.8306s
	iters: 400, epoch: 28 | loss: 0.0000149
	speed: 0.0510s/iter; left time: 530.0550s
Epoch: 28 cost time: 23.23763871192932
Epoch: 28, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000325
	speed: 0.3085s/iter; left time: 3152.2036s
	iters: 200, epoch: 29 | loss: 0.0004455
	speed: 0.0452s/iter; left time: 457.8116s
	iters: 300, epoch: 29 | loss: 0.0000040
	speed: 0.0459s/iter; left time: 460.2735s
	iters: 400, epoch: 29 | loss: 0.0000023
	speed: 0.0476s/iter; left time: 471.6723s
Epoch: 29 cost time: 22.348922967910767
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000011
	speed: 0.3007s/iter; left time: 2931.4223s
	iters: 200, epoch: 30 | loss: 0.0151864
	speed: 0.0511s/iter; left time: 493.3335s
	iters: 300, epoch: 30 | loss: 0.0000131
	speed: 0.0499s/iter; left time: 476.3669s
	iters: 400, epoch: 30 | loss: 0.0003913
	speed: 0.0496s/iter; left time: 468.5153s
Epoch: 30 cost time: 23.122676134109497
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0094277
	speed: 0.2947s/iter; left time: 2735.0371s
	iters: 200, epoch: 31 | loss: 0.0000028
	speed: 0.0542s/iter; left time: 497.3348s
	iters: 300, epoch: 31 | loss: 0.0000012
	speed: 0.0516s/iter; left time: 468.5561s
	iters: 400, epoch: 31 | loss: 0.0000274
	speed: 0.0492s/iter; left time: 441.5239s
Epoch: 31 cost time: 24.211244583129883
Epoch: 31, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 119434
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5559327
	speed: 0.0681s/iter; left time: 1590.1302s
	iters: 200, epoch: 1 | loss: 0.5210937
	speed: 0.0528s/iter; left time: 1227.4874s
	iters: 300, epoch: 1 | loss: 0.2666449
	speed: 0.0479s/iter; left time: 1108.2205s
	iters: 400, epoch: 1 | loss: 0.0878438
	speed: 0.0459s/iter; left time: 1057.8128s
Epoch: 1 cost time: 24.79756188392639
Epoch: 1, Steps: 469 | Train Loss: 0.577 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
Validation loss decreased (inf --> -0.915378).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1016719
	speed: 0.3142s/iter; left time: 7189.3772s
	iters: 200, epoch: 2 | loss: 0.3455488
	speed: 0.0508s/iter; left time: 1156.9870s
	iters: 300, epoch: 2 | loss: 0.0063456
	speed: 0.0463s/iter; left time: 1050.8494s
	iters: 400, epoch: 2 | loss: 0.0918055
	speed: 0.0447s/iter; left time: 1010.1711s
Epoch: 2 cost time: 22.71336841583252
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.915378 --> -0.956259).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0032863
	speed: 0.3053s/iter; left time: 6841.6667s
	iters: 200, epoch: 3 | loss: 0.0135134
	speed: 0.0471s/iter; left time: 1051.5295s
	iters: 300, epoch: 3 | loss: 0.0044065
	speed: 0.0484s/iter; left time: 1075.9474s
	iters: 400, epoch: 3 | loss: 0.0012074
	speed: 0.0543s/iter; left time: 1200.0243s
Epoch: 3 cost time: 23.785741567611694
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.956259 --> -0.969982).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0075962
	speed: 0.2855s/iter; left time: 6266.0441s
	iters: 200, epoch: 4 | loss: 0.0109585
	speed: 0.0513s/iter; left time: 1121.4707s
	iters: 300, epoch: 4 | loss: 0.0401758
	speed: 0.0527s/iter; left time: 1146.7257s
	iters: 400, epoch: 4 | loss: 0.1783004
	speed: 0.0532s/iter; left time: 1150.7689s
Epoch: 4 cost time: 24.189122200012207
Epoch: 4, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0004953
	speed: 0.3166s/iter; left time: 6799.6457s
	iters: 200, epoch: 5 | loss: 0.0018949
	speed: 0.0535s/iter; left time: 1143.2279s
	iters: 300, epoch: 5 | loss: 0.0218025
	speed: 0.0476s/iter; left time: 1012.5417s
	iters: 400, epoch: 5 | loss: 0.0379208
	speed: 0.0454s/iter; left time: 961.9111s
Epoch: 5 cost time: 23.512951850891113
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.1845389
	speed: 0.3116s/iter; left time: 6545.3514s
	iters: 200, epoch: 6 | loss: 0.0188206
	speed: 0.0481s/iter; left time: 1005.5923s
	iters: 300, epoch: 6 | loss: 0.0860167
	speed: 0.0517s/iter; left time: 1074.8179s
	iters: 400, epoch: 6 | loss: 0.0007766
	speed: 0.0512s/iter; left time: 1059.2158s
Epoch: 6 cost time: 23.940749645233154
Epoch: 6, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.969982 --> -0.974556).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005568
	speed: 0.3001s/iter; left time: 6162.4040s
	iters: 200, epoch: 7 | loss: 0.0012142
	speed: 0.0454s/iter; left time: 927.2821s
	iters: 300, epoch: 7 | loss: 0.0291200
	speed: 0.0501s/iter; left time: 1018.6112s
	iters: 400, epoch: 7 | loss: 0.0007914
	speed: 0.0539s/iter; left time: 1091.3423s
Epoch: 7 cost time: 23.65884828567505
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.976842).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0008401
	speed: 0.3124s/iter; left time: 6269.2888s
	iters: 200, epoch: 8 | loss: 0.0018605
	speed: 0.0491s/iter; left time: 980.0500s
	iters: 300, epoch: 8 | loss: 0.0050944
	speed: 0.0395s/iter; left time: 784.9241s
	iters: 400, epoch: 8 | loss: 0.0000916
	speed: 0.0399s/iter; left time: 788.9535s
Epoch: 8 cost time: 21.071189403533936
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.271 Vali Acc: 0.966 Test Loss: 0.271 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0007336
	speed: 0.2957s/iter; left time: 5795.8213s
	iters: 200, epoch: 9 | loss: 0.0002846
	speed: 0.0482s/iter; left time: 940.5031s
	iters: 300, epoch: 9 | loss: 0.0052317
	speed: 0.0503s/iter; left time: 975.5775s
	iters: 400, epoch: 9 | loss: 0.0074415
	speed: 0.0526s/iter; left time: 1014.5213s
Epoch: 9 cost time: 23.518248319625854
Epoch: 9, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0029251
	speed: 0.2863s/iter; left time: 5477.8746s
	iters: 200, epoch: 10 | loss: 0.0002026
	speed: 0.0528s/iter; left time: 1005.4461s
	iters: 300, epoch: 10 | loss: 0.0001294
	speed: 0.0517s/iter; left time: 979.0311s
	iters: 400, epoch: 10 | loss: 0.1311544
	speed: 0.0478s/iter; left time: 899.7713s
Epoch: 10 cost time: 24.07665205001831
Epoch: 10, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.193 Vali Acc: 0.973 Test Loss: 0.193 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0071477
	speed: 0.2716s/iter; left time: 5069.1814s
	iters: 200, epoch: 11 | loss: 0.0000033
	speed: 0.0369s/iter; left time: 684.6766s
	iters: 300, epoch: 11 | loss: 0.0040305
	speed: 0.0420s/iter; left time: 774.8106s
	iters: 400, epoch: 11 | loss: 0.0000587
	speed: 0.0449s/iter; left time: 825.2250s
Epoch: 11 cost time: 20.12489342689514
Epoch: 11, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.971 Test Loss: 0.196 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.3270423
	speed: 0.3139s/iter; left time: 5710.3583s
	iters: 200, epoch: 12 | loss: 0.0000233
	speed: 0.0503s/iter; left time: 909.3869s
	iters: 300, epoch: 12 | loss: 0.0000153
	speed: 0.0557s/iter; left time: 1001.4514s
	iters: 400, epoch: 12 | loss: 0.1795290
	speed: 0.0546s/iter; left time: 977.5292s
Epoch: 12 cost time: 24.845456838607788
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.976842 --> -0.979987).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0002322
	speed: 0.2996s/iter; left time: 5309.7860s
	iters: 200, epoch: 13 | loss: 0.0033528
	speed: 0.0522s/iter; left time: 919.7026s
	iters: 300, epoch: 13 | loss: 0.0007422
	speed: 0.0503s/iter; left time: 881.1006s
	iters: 400, epoch: 13 | loss: 0.1033458
	speed: 0.0506s/iter; left time: 882.4171s
Epoch: 13 cost time: 24.417347192764282
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.978 Test Loss: 0.188 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.1104699
	speed: 0.3127s/iter; left time: 5395.4002s
	iters: 200, epoch: 14 | loss: 0.0028351
	speed: 0.0490s/iter; left time: 840.9929s
	iters: 300, epoch: 14 | loss: 0.0002033
	speed: 0.0450s/iter; left time: 767.6787s
	iters: 400, epoch: 14 | loss: 0.0001682
	speed: 0.0450s/iter; left time: 763.6094s
Epoch: 14 cost time: 22.78423261642456
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0431316
	speed: 0.3160s/iter; left time: 5304.4212s
	iters: 200, epoch: 15 | loss: 0.0088598
	speed: 0.0523s/iter; left time: 871.8117s
	iters: 300, epoch: 15 | loss: 0.0730858
	speed: 0.0560s/iter; left time: 928.8678s
	iters: 400, epoch: 15 | loss: 0.0008540
	speed: 0.0549s/iter; left time: 905.7041s
Epoch: 15 cost time: 25.005723476409912
Epoch: 15, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
Validation loss decreased (-0.979987 --> -0.982274).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000747
	speed: 0.2929s/iter; left time: 4779.0359s
	iters: 200, epoch: 16 | loss: 1.1870133
	speed: 0.0506s/iter; left time: 820.9332s
	iters: 300, epoch: 16 | loss: 0.0002122
	speed: 0.0470s/iter; left time: 757.8470s
	iters: 400, epoch: 16 | loss: 0.0002635
	speed: 0.0477s/iter; left time: 764.4730s
Epoch: 16 cost time: 23.25445032119751
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.969 Test Loss: 0.205 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000186
	speed: 0.3045s/iter; left time: 4825.1932s
	iters: 200, epoch: 17 | loss: 0.0326281
	speed: 0.0431s/iter; left time: 678.1736s
	iters: 300, epoch: 17 | loss: 0.0001093
	speed: 0.0443s/iter; left time: 693.5558s
	iters: 400, epoch: 17 | loss: 0.0000087
	speed: 0.0464s/iter; left time: 721.7727s
Epoch: 17 cost time: 21.89942216873169
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0012295
	speed: 0.3100s/iter; left time: 4766.6979s
	iters: 200, epoch: 18 | loss: 0.0000056
	speed: 0.0523s/iter; left time: 799.2995s
	iters: 300, epoch: 18 | loss: 0.0000436
	speed: 0.0544s/iter; left time: 826.2298s
	iters: 400, epoch: 18 | loss: 0.0000030
	speed: 0.0530s/iter; left time: 799.7238s
Epoch: 18 cost time: 24.35183835029602
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0021275
	speed: 0.2935s/iter; left time: 4375.2670s
	iters: 200, epoch: 19 | loss: 0.1300371
	speed: 0.0508s/iter; left time: 752.7484s
	iters: 300, epoch: 19 | loss: 0.0009251
	speed: 0.0480s/iter; left time: 705.9990s
	iters: 400, epoch: 19 | loss: 0.0000237
	speed: 0.0499s/iter; left time: 729.2414s
Epoch: 19 cost time: 23.82788848876953
Epoch: 19, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.239 Vali Acc: 0.967 Test Loss: 0.239 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000184
	speed: 0.3165s/iter; left time: 4569.9483s
	iters: 200, epoch: 20 | loss: 0.0006816
	speed: 0.0478s/iter; left time: 685.0323s
	iters: 300, epoch: 20 | loss: 0.0000099
	speed: 0.0478s/iter; left time: 681.2067s
	iters: 400, epoch: 20 | loss: 0.0000134
	speed: 0.0470s/iter; left time: 664.5986s
Epoch: 20 cost time: 22.94252896308899
Epoch: 20, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.974 Test Loss: 0.206 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000045
	speed: 0.2748s/iter; left time: 3838.7045s
	iters: 200, epoch: 21 | loss: 0.0000628
	speed: 0.0510s/iter; left time: 707.7704s
	iters: 300, epoch: 21 | loss: 0.0000102
	speed: 0.0520s/iter; left time: 716.0929s
	iters: 400, epoch: 21 | loss: 0.0000058
	speed: 0.0482s/iter; left time: 659.4414s
Epoch: 21 cost time: 23.09754776954651
Epoch: 21, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.973 Test Loss: 0.237 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000017
	speed: 0.2815s/iter; left time: 3800.9767s
	iters: 200, epoch: 22 | loss: 0.0009093
	speed: 0.0414s/iter; left time: 555.2457s
	iters: 300, epoch: 22 | loss: 0.0003384
	speed: 0.0435s/iter; left time: 578.5398s
	iters: 400, epoch: 22 | loss: 0.0000056
	speed: 0.0486s/iter; left time: 641.7479s
Epoch: 22 cost time: 21.853522777557373
Epoch: 22, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.977 Test Loss: 0.199 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000651
	speed: 0.3147s/iter; left time: 4101.1998s
	iters: 200, epoch: 23 | loss: 0.0000006
	speed: 0.0467s/iter; left time: 604.2417s
	iters: 300, epoch: 23 | loss: 0.0000328
	speed: 0.0447s/iter; left time: 573.7218s
	iters: 400, epoch: 23 | loss: 0.3151918
	speed: 0.0468s/iter; left time: 595.9225s
Epoch: 23 cost time: 22.405195951461792
Epoch: 23, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.970 Test Loss: 0.293 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000067
	speed: 0.2857s/iter; left time: 3589.6884s
	iters: 200, epoch: 24 | loss: 0.0081338
	speed: 0.0524s/iter; left time: 653.6591s
	iters: 300, epoch: 24 | loss: 0.1280424
	speed: 0.0493s/iter; left time: 609.0926s
	iters: 400, epoch: 24 | loss: 0.0005796
	speed: 0.0460s/iter; left time: 564.3958s
Epoch: 24 cost time: 23.269243001937866
Epoch: 24, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.241 Vali Acc: 0.977 Test Loss: 0.241 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0001962
	speed: 0.2871s/iter; left time: 3471.9816s
	iters: 200, epoch: 25 | loss: 0.0612667
	speed: 0.0464s/iter; left time: 557.0625s
	iters: 300, epoch: 25 | loss: 0.0000561
	speed: 0.0492s/iter; left time: 585.5038s
	iters: 400, epoch: 25 | loss: 0.0001413
	speed: 0.0485s/iter; left time: 571.5720s
Epoch: 25 cost time: 22.64476752281189
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.972 Test Loss: 0.273 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 119498
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5914135
	speed: 0.0598s/iter; left time: 1396.6031s
	iters: 200, epoch: 1 | loss: 0.4824775
	speed: 0.0411s/iter; left time: 955.3765s
	iters: 300, epoch: 1 | loss: 0.3238060
	speed: 0.0380s/iter; left time: 880.2298s
	iters: 400, epoch: 1 | loss: 0.1681911
	speed: 0.0385s/iter; left time: 888.0100s
Epoch: 1 cost time: 20.50356435775757
Epoch: 1, Steps: 469 | Train Loss: 0.835 Vali Loss: 0.343 Vali Acc: 0.901 Test Loss: 0.343 Test Acc: 0.901
Validation loss decreased (inf --> -0.901083).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1686691
	speed: 0.2273s/iter; left time: 5201.4350s
	iters: 200, epoch: 2 | loss: 0.0383636
	speed: 0.0342s/iter; left time: 778.0313s
	iters: 300, epoch: 2 | loss: 0.0566028
	speed: 0.0361s/iter; left time: 819.8015s
	iters: 400, epoch: 2 | loss: 0.0681944
	speed: 0.0413s/iter; left time: 933.3489s
Epoch: 2 cost time: 17.78370952606201
Epoch: 2, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
Validation loss decreased (-0.901083 --> -0.954830).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0053277
	speed: 0.2347s/iter; left time: 5260.4973s
	iters: 200, epoch: 3 | loss: 0.0113383
	speed: 0.0401s/iter; left time: 894.9709s
	iters: 300, epoch: 3 | loss: 0.0395033
	speed: 0.0404s/iter; left time: 896.6821s
	iters: 400, epoch: 3 | loss: 0.0365492
	speed: 0.0388s/iter; left time: 857.1336s
Epoch: 3 cost time: 18.628403902053833
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0183394
	speed: 0.2223s/iter; left time: 4878.5792s
	iters: 200, epoch: 4 | loss: 0.0133705
	speed: 0.0410s/iter; left time: 896.4196s
	iters: 300, epoch: 4 | loss: 0.0269585
	speed: 0.0405s/iter; left time: 881.6976s
	iters: 400, epoch: 4 | loss: 0.0084650
	speed: 0.0384s/iter; left time: 831.7901s
Epoch: 4 cost time: 19.031208276748657
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
Validation loss decreased (-0.954830 --> -0.965979).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0306880
	speed: 0.2409s/iter; left time: 5174.0832s
	iters: 200, epoch: 5 | loss: 0.0051186
	speed: 0.0411s/iter; left time: 878.7558s
	iters: 300, epoch: 5 | loss: 0.0270935
	speed: 0.0397s/iter; left time: 843.9474s
	iters: 400, epoch: 5 | loss: 0.0106839
	speed: 0.0392s/iter; left time: 830.8471s
Epoch: 5 cost time: 19.088720321655273
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.965979 --> -0.966836).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0141857
	speed: 0.2505s/iter; left time: 5262.3283s
	iters: 200, epoch: 6 | loss: 0.0013980
	speed: 0.0393s/iter; left time: 821.9798s
	iters: 300, epoch: 6 | loss: 0.2735119
	speed: 0.0369s/iter; left time: 768.6111s
	iters: 400, epoch: 6 | loss: 0.0150821
	speed: 0.0355s/iter; left time: 735.0782s
Epoch: 6 cost time: 18.2605619430542
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0145547
	speed: 0.2478s/iter; left time: 5088.8023s
	iters: 200, epoch: 7 | loss: 0.0040641
	speed: 0.0375s/iter; left time: 765.6983s
	iters: 300, epoch: 7 | loss: 0.0151523
	speed: 0.0381s/iter; left time: 775.2244s
	iters: 400, epoch: 7 | loss: 0.0529696
	speed: 0.0401s/iter; left time: 810.9883s
Epoch: 7 cost time: 18.861436367034912
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0149087
	speed: 0.2446s/iter; left time: 4908.8399s
	iters: 200, epoch: 8 | loss: 0.0095370
	speed: 0.0399s/iter; left time: 796.9734s
	iters: 300, epoch: 8 | loss: 0.3188312
	speed: 0.0411s/iter; left time: 817.1620s
	iters: 400, epoch: 8 | loss: 0.0185373
	speed: 0.0423s/iter; left time: 835.9838s
Epoch: 8 cost time: 19.12648892402649
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
Validation loss decreased (-0.966836 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0156289
	speed: 0.2445s/iter; left time: 4791.9992s
	iters: 200, epoch: 9 | loss: 0.0040695
	speed: 0.0372s/iter; left time: 725.9491s
	iters: 300, epoch: 9 | loss: 0.0026423
	speed: 0.0385s/iter; left time: 746.8646s
	iters: 400, epoch: 9 | loss: 0.0007766
	speed: 0.0385s/iter; left time: 742.6418s
Epoch: 9 cost time: 18.20588254928589
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977986).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0125352
	speed: 0.2340s/iter; left time: 4476.4851s
	iters: 200, epoch: 10 | loss: 0.0003241
	speed: 0.0400s/iter; left time: 761.8511s
	iters: 300, epoch: 10 | loss: 0.0255252
	speed: 0.0418s/iter; left time: 792.1946s
	iters: 400, epoch: 10 | loss: 0.0004002
	speed: 0.0411s/iter; left time: 773.1260s
Epoch: 10 cost time: 19.293068408966064
Epoch: 10, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0029831
	speed: 0.2325s/iter; left time: 4338.2075s
	iters: 200, epoch: 11 | loss: 0.0133269
	speed: 0.0434s/iter; left time: 806.3889s
	iters: 300, epoch: 11 | loss: 0.0010865
	speed: 0.0389s/iter; left time: 717.5807s
	iters: 400, epoch: 11 | loss: 0.0018077
	speed: 0.0399s/iter; left time: 733.0013s
Epoch: 11 cost time: 19.343849897384644
Epoch: 11, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.2269547
	speed: 0.2509s/iter; left time: 4564.4146s
	iters: 200, epoch: 12 | loss: 0.0010519
	speed: 0.0386s/iter; left time: 697.9997s
	iters: 300, epoch: 12 | loss: 0.0012930
	speed: 0.0371s/iter; left time: 667.6812s
	iters: 400, epoch: 12 | loss: 0.0007842
	speed: 0.0351s/iter; left time: 628.0818s
Epoch: 12 cost time: 18.13242197036743
Epoch: 12, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000556
	speed: 0.2442s/iter; left time: 4327.6680s
	iters: 200, epoch: 13 | loss: 0.0028971
	speed: 0.0392s/iter; left time: 689.9452s
	iters: 300, epoch: 13 | loss: 0.0022370
	speed: 0.0394s/iter; left time: 689.9918s
	iters: 400, epoch: 13 | loss: 0.0050566
	speed: 0.0374s/iter; left time: 651.3522s
Epoch: 13 cost time: 18.3826322555542
Epoch: 13, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0005250
	speed: 0.2390s/iter; left time: 4123.6100s
	iters: 200, epoch: 14 | loss: 0.0046843
	speed: 0.0395s/iter; left time: 677.4184s
	iters: 300, epoch: 14 | loss: 0.0001117
	speed: 0.0385s/iter; left time: 656.5381s
	iters: 400, epoch: 14 | loss: 0.0009465
	speed: 0.0424s/iter; left time: 719.0305s
Epoch: 14 cost time: 19.1112802028656
Epoch: 14, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1048249
	speed: 0.2532s/iter; left time: 4250.7479s
	iters: 200, epoch: 15 | loss: 0.0033566
	speed: 0.0407s/iter; left time: 679.0602s
	iters: 300, epoch: 15 | loss: 0.0000570
	speed: 0.0423s/iter; left time: 701.3882s
	iters: 400, epoch: 15 | loss: 0.0002258
	speed: 0.0417s/iter; left time: 687.3538s
Epoch: 15 cost time: 19.662095546722412
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0131774
	speed: 0.2436s/iter; left time: 3974.5834s
	iters: 200, epoch: 16 | loss: 0.0002170
	speed: 0.0435s/iter; left time: 704.9569s
	iters: 300, epoch: 16 | loss: 0.0004503
	speed: 0.0413s/iter; left time: 665.6612s
	iters: 400, epoch: 16 | loss: 0.0014409
	speed: 0.0400s/iter; left time: 640.5292s
Epoch: 16 cost time: 19.63016629219055
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0980376
	speed: 0.2332s/iter; left time: 3696.1356s
	iters: 200, epoch: 17 | loss: 0.0099160
	speed: 0.0411s/iter; left time: 647.9599s
	iters: 300, epoch: 17 | loss: 0.0000446
	speed: 0.0379s/iter; left time: 592.6599s
	iters: 400, epoch: 17 | loss: 0.0063506
	speed: 0.0371s/iter; left time: 576.0308s
Epoch: 17 cost time: 18.498029708862305
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.979 Test Loss: 0.142 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978844).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0005116
	speed: 0.2376s/iter; left time: 3654.4954s
	iters: 200, epoch: 18 | loss: 0.0017923
	speed: 0.0390s/iter; left time: 595.3128s
	iters: 300, epoch: 18 | loss: 0.0001266
	speed: 0.0395s/iter; left time: 599.2826s
	iters: 400, epoch: 18 | loss: 0.0056635
	speed: 0.0378s/iter; left time: 569.7341s
Epoch: 18 cost time: 18.554282426834106
Epoch: 18, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0001571
	speed: 0.2324s/iter; left time: 3464.1345s
	iters: 200, epoch: 19 | loss: 0.0589445
	speed: 0.0417s/iter; left time: 617.8081s
	iters: 300, epoch: 19 | loss: 0.0000772
	speed: 0.0413s/iter; left time: 607.1086s
	iters: 400, epoch: 19 | loss: 0.0002427
	speed: 0.0420s/iter; left time: 614.1539s
Epoch: 19 cost time: 19.39874529838562
Epoch: 19, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0013241
	speed: 0.2387s/iter; left time: 3446.6769s
	iters: 200, epoch: 20 | loss: 0.0000692
	speed: 0.0415s/iter; left time: 595.7863s
	iters: 300, epoch: 20 | loss: 0.0005124
	speed: 0.0419s/iter; left time: 596.9353s
	iters: 400, epoch: 20 | loss: 0.0164851
	speed: 0.0413s/iter; left time: 583.3619s
Epoch: 20 cost time: 19.59331464767456
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0963051
	speed: 0.2419s/iter; left time: 3379.9457s
	iters: 200, epoch: 21 | loss: 0.0002157
	speed: 0.0412s/iter; left time: 571.4375s
	iters: 300, epoch: 21 | loss: 0.0020696
	speed: 0.0387s/iter; left time: 532.7766s
	iters: 400, epoch: 21 | loss: 0.0737487
	speed: 0.0371s/iter; left time: 507.3577s
Epoch: 21 cost time: 18.603132486343384
Epoch: 21, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000311
	speed: 0.2476s/iter; left time: 3342.6682s
	iters: 200, epoch: 22 | loss: 0.0001160
	speed: 0.0394s/iter; left time: 527.6824s
	iters: 300, epoch: 22 | loss: 0.0011128
	speed: 0.0397s/iter; left time: 528.6693s
	iters: 400, epoch: 22 | loss: 0.0001240
	speed: 0.0395s/iter; left time: 521.4887s
Epoch: 22 cost time: 18.935468435287476
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0007565
	speed: 0.2419s/iter; left time: 3152.6866s
	iters: 200, epoch: 23 | loss: 0.0023611
	speed: 0.0409s/iter; left time: 528.9560s
	iters: 300, epoch: 23 | loss: 0.0000990
	speed: 0.0401s/iter; left time: 514.5696s
	iters: 400, epoch: 23 | loss: 0.0021165
	speed: 0.0412s/iter; left time: 524.8152s
Epoch: 23 cost time: 19.193788051605225
Epoch: 23, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0018827
	speed: 0.2373s/iter; left time: 2981.0718s
	iters: 200, epoch: 24 | loss: 0.0211031
	speed: 0.0348s/iter; left time: 433.2701s
	iters: 300, epoch: 24 | loss: 0.0001006
	speed: 0.0358s/iter; left time: 442.8299s
	iters: 400, epoch: 24 | loss: 0.0002557
	speed: 0.0366s/iter; left time: 448.8051s
Epoch: 24 cost time: 17.269080877304077
Epoch: 24, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0092860
	speed: 0.2421s/iter; left time: 2928.5633s
	iters: 200, epoch: 25 | loss: 0.0000382
	speed: 0.0439s/iter; left time: 526.8806s
	iters: 300, epoch: 25 | loss: 0.0000214
	speed: 0.0444s/iter; left time: 528.4870s
	iters: 400, epoch: 25 | loss: 0.0000277
	speed: 0.0406s/iter; left time: 479.0615s
Epoch: 25 cost time: 20.191420793533325
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000019
	speed: 0.2482s/iter; left time: 2885.3621s
	iters: 200, epoch: 26 | loss: 0.0000708
	speed: 0.0429s/iter; left time: 494.1317s
	iters: 300, epoch: 26 | loss: 0.0000233
	speed: 0.0397s/iter; left time: 453.5834s
	iters: 400, epoch: 26 | loss: 0.0019061
	speed: 0.0400s/iter; left time: 452.7519s
Epoch: 26 cost time: 19.713277578353882
Epoch: 26, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000054
	speed: 0.2569s/iter; left time: 2865.6913s
	iters: 200, epoch: 27 | loss: 0.0095130
	speed: 0.0403s/iter; left time: 445.6920s
	iters: 300, epoch: 27 | loss: 0.0010745
	speed: 0.0398s/iter; left time: 436.5352s
	iters: 400, epoch: 27 | loss: 0.0008312
	speed: 0.0396s/iter; left time: 429.4210s
Epoch: 27 cost time: 19.07548189163208
Epoch: 27, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.965 Test Loss: 0.227 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 35146
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5497226
	speed: 0.0582s/iter; left time: 1360.1524s
	iters: 200, epoch: 1 | loss: 0.6803016
	speed: 0.0439s/iter; left time: 1019.6179s
	iters: 300, epoch: 1 | loss: 0.3362822
	speed: 0.0407s/iter; left time: 941.1210s
	iters: 400, epoch: 1 | loss: 0.2909443
	speed: 0.0382s/iter; left time: 880.9464s
Epoch: 1 cost time: 20.781591415405273
Epoch: 1, Steps: 469 | Train Loss: 0.857 Vali Loss: 0.351 Vali Acc: 0.905 Test Loss: 0.351 Test Acc: 0.905
Validation loss decreased (inf --> -0.904513).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1958787
	speed: 0.2557s/iter; left time: 5850.1691s
	iters: 200, epoch: 2 | loss: 0.2328286
	speed: 0.0386s/iter; left time: 880.2519s
	iters: 300, epoch: 2 | loss: 0.4193838
	speed: 0.0389s/iter; left time: 883.3639s
	iters: 400, epoch: 2 | loss: 0.0856822
	speed: 0.0389s/iter; left time: 878.6403s
Epoch: 2 cost time: 18.96231484413147
Epoch: 2, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.904513 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0334563
	speed: 0.2427s/iter; left time: 5440.2600s
	iters: 200, epoch: 3 | loss: 0.0450936
	speed: 0.0412s/iter; left time: 919.0988s
	iters: 300, epoch: 3 | loss: 0.0220566
	speed: 0.0415s/iter; left time: 922.3424s
	iters: 400, epoch: 3 | loss: 0.0139596
	speed: 0.0402s/iter; left time: 889.0426s
Epoch: 3 cost time: 19.42746877670288
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
Validation loss decreased (-0.957974 --> -0.961405).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1402638
	speed: 0.2349s/iter; left time: 5153.6456s
	iters: 200, epoch: 4 | loss: 0.0024344
	speed: 0.0388s/iter; left time: 848.0992s
	iters: 300, epoch: 4 | loss: 0.2169382
	speed: 0.0397s/iter; left time: 863.2099s
	iters: 400, epoch: 4 | loss: 0.0021467
	speed: 0.0417s/iter; left time: 901.5194s
Epoch: 4 cost time: 19.402743816375732
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.961405 --> -0.973126).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0022030
	speed: 0.2576s/iter; left time: 5531.8794s
	iters: 200, epoch: 5 | loss: 0.0184533
	speed: 0.0425s/iter; left time: 908.4794s
	iters: 300, epoch: 5 | loss: 0.0226836
	speed: 0.0449s/iter; left time: 955.2543s
	iters: 400, epoch: 5 | loss: 0.0132729
	speed: 0.0459s/iter; left time: 972.4031s
Epoch: 5 cost time: 20.670095205307007
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0012188
	speed: 0.2475s/iter; left time: 5198.5998s
	iters: 200, epoch: 6 | loss: 0.0008272
	speed: 0.0445s/iter; left time: 929.8378s
	iters: 300, epoch: 6 | loss: 0.0088450
	speed: 0.0427s/iter; left time: 887.9598s
	iters: 400, epoch: 6 | loss: 0.0006249
	speed: 0.0403s/iter; left time: 834.1189s
Epoch: 6 cost time: 20.428950309753418
Epoch: 6, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.973126 --> -0.978844).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0203211
	speed: 0.2573s/iter; left time: 5283.4312s
	iters: 200, epoch: 7 | loss: 0.0222337
	speed: 0.0415s/iter; left time: 847.9384s
	iters: 300, epoch: 7 | loss: 0.0089225
	speed: 0.0395s/iter; left time: 803.2567s
	iters: 400, epoch: 7 | loss: 0.0096344
	speed: 0.0410s/iter; left time: 828.8866s
Epoch: 7 cost time: 19.575308084487915
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0618140
	speed: 0.2515s/iter; left time: 5046.9651s
	iters: 200, epoch: 8 | loss: 0.0195717
	speed: 0.0430s/iter; left time: 858.9243s
	iters: 300, epoch: 8 | loss: 0.0005503
	speed: 0.0409s/iter; left time: 813.5822s
	iters: 400, epoch: 8 | loss: 0.0042079
	speed: 0.0417s/iter; left time: 825.0307s
Epoch: 8 cost time: 20.039387464523315
Epoch: 8, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0003982
	speed: 0.2521s/iter; left time: 4940.5277s
	iters: 200, epoch: 9 | loss: 0.0079251
	speed: 0.0402s/iter; left time: 783.5725s
	iters: 300, epoch: 9 | loss: 0.0249854
	speed: 0.0393s/iter; left time: 762.3900s
	iters: 400, epoch: 9 | loss: 0.0159724
	speed: 0.0427s/iter; left time: 824.3293s
Epoch: 9 cost time: 19.561405897140503
Epoch: 9, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0015191
	speed: 0.2519s/iter; left time: 4818.2445s
	iters: 200, epoch: 10 | loss: 0.0004877
	speed: 0.0402s/iter; left time: 764.1643s
	iters: 300, epoch: 10 | loss: 0.0011871
	speed: 0.0431s/iter; left time: 815.1291s
	iters: 400, epoch: 10 | loss: 0.0008656
	speed: 0.0419s/iter; left time: 789.4914s
Epoch: 10 cost time: 19.62524676322937
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0022481
	speed: 0.2389s/iter; left time: 4458.5329s
	iters: 200, epoch: 11 | loss: 0.0001943
	speed: 0.0413s/iter; left time: 766.2991s
	iters: 300, epoch: 11 | loss: 0.0016892
	speed: 0.0410s/iter; left time: 757.4332s
	iters: 400, epoch: 11 | loss: 0.0002020
	speed: 0.0418s/iter; left time: 768.3715s
Epoch: 11 cost time: 19.410028219223022
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0222207
	speed: 0.2438s/iter; left time: 4434.6428s
	iters: 200, epoch: 12 | loss: 0.0007190
	speed: 0.0436s/iter; left time: 789.4405s
	iters: 300, epoch: 12 | loss: 0.0000742
	speed: 0.0422s/iter; left time: 759.7197s
	iters: 400, epoch: 12 | loss: 0.0016068
	speed: 0.0405s/iter; left time: 723.9337s
Epoch: 12 cost time: 19.929322004318237
Epoch: 12, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0484959
	speed: 0.2533s/iter; left time: 4489.9232s
	iters: 200, epoch: 13 | loss: 0.0014308
	speed: 0.0384s/iter; left time: 677.2072s
	iters: 300, epoch: 13 | loss: 0.0003789
	speed: 0.0377s/iter; left time: 661.0782s
	iters: 400, epoch: 13 | loss: 0.0003718
	speed: 0.0379s/iter; left time: 659.7943s
Epoch: 13 cost time: 18.718229055404663
Epoch: 13, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0034563
	speed: 0.2498s/iter; left time: 4310.0032s
	iters: 200, epoch: 14 | loss: 0.0045005
	speed: 0.0386s/iter; left time: 662.5042s
	iters: 300, epoch: 14 | loss: 0.0003471
	speed: 0.0412s/iter; left time: 703.3180s
	iters: 400, epoch: 14 | loss: 0.0000648
	speed: 0.0405s/iter; left time: 686.9398s
Epoch: 14 cost time: 19.150691747665405
Epoch: 14, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0008545
	speed: 0.2489s/iter; left time: 4177.2318s
	iters: 200, epoch: 15 | loss: 0.1015892
	speed: 0.0412s/iter; left time: 687.8756s
	iters: 300, epoch: 15 | loss: 0.0000827
	speed: 0.0408s/iter; left time: 676.2323s
	iters: 400, epoch: 15 | loss: 0.0038771
	speed: 0.0422s/iter; left time: 694.9814s
Epoch: 15 cost time: 19.901203393936157
Epoch: 15, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0196646
	speed: 0.2450s/iter; left time: 3997.2758s
	iters: 200, epoch: 16 | loss: 0.0001693
	speed: 0.0397s/iter; left time: 644.1413s
	iters: 300, epoch: 16 | loss: 0.0040153
	speed: 0.0393s/iter; left time: 633.1650s
	iters: 400, epoch: 16 | loss: 0.0211526
	speed: 0.0427s/iter; left time: 683.9547s
Epoch: 16 cost time: 19.002513885498047
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0003454
	speed: 0.2396s/iter; left time: 3796.4363s
	iters: 200, epoch: 17 | loss: 0.0002672
	speed: 0.0426s/iter; left time: 670.2633s
	iters: 300, epoch: 17 | loss: 0.0017571
	speed: 0.0411s/iter; left time: 643.2909s
	iters: 400, epoch: 17 | loss: 0.0396509
	speed: 0.0385s/iter; left time: 598.7391s
Epoch: 17 cost time: 19.503037929534912
Epoch: 17, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000100
	speed: 0.2219s/iter; left time: 3412.4564s
	iters: 200, epoch: 18 | loss: 0.0011358
	speed: 0.0310s/iter; left time: 473.5087s
	iters: 300, epoch: 18 | loss: 0.0166312
	speed: 0.0313s/iter; left time: 475.3404s
	iters: 400, epoch: 18 | loss: 0.0000579
	speed: 0.0337s/iter; left time: 508.6717s
Epoch: 18 cost time: 16.028133392333984
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000819
	speed: 0.2476s/iter; left time: 3692.2107s
	iters: 200, epoch: 19 | loss: 0.0001023
	speed: 0.0418s/iter; left time: 618.3764s
	iters: 300, epoch: 19 | loss: 0.0000018
	speed: 0.0434s/iter; left time: 637.8315s
	iters: 400, epoch: 19 | loss: 0.0001255
	speed: 0.0418s/iter; left time: 610.1990s
Epoch: 19 cost time: 19.917648553848267
Epoch: 19, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0043184
	speed: 0.2400s/iter; left time: 3465.2806s
	iters: 200, epoch: 20 | loss: 0.0972261
	speed: 0.0419s/iter; left time: 601.4410s
	iters: 300, epoch: 20 | loss: 0.0000479
	speed: 0.0418s/iter; left time: 595.0202s
	iters: 400, epoch: 20 | loss: 0.0000812
	speed: 0.0392s/iter; left time: 554.4835s
Epoch: 20 cost time: 19.31699013710022
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.979 Test Loss: 0.146 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 35178
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3335850
	speed: 0.0620s/iter; left time: 1447.4854s
	iters: 200, epoch: 1 | loss: 0.2280506
	speed: 0.0501s/iter; left time: 1164.1921s
	iters: 300, epoch: 1 | loss: 0.3356767
	speed: 0.0531s/iter; left time: 1228.9250s
	iters: 400, epoch: 1 | loss: 0.0095002
	speed: 0.0534s/iter; left time: 1231.1371s
Epoch: 1 cost time: 25.252769231796265
Epoch: 1, Steps: 469 | Train Loss: 0.363 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
Validation loss decreased (inf --> -0.943394).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0118618
	speed: 0.2961s/iter; left time: 6775.8236s
	iters: 200, epoch: 2 | loss: 0.1174501
	speed: 0.0457s/iter; left time: 1040.8914s
	iters: 300, epoch: 2 | loss: 0.0130724
	speed: 0.0454s/iter; left time: 1030.5511s
	iters: 400, epoch: 2 | loss: 0.0035747
	speed: 0.0455s/iter; left time: 1026.5474s
Epoch: 2 cost time: 22.224668264389038
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.943394 --> -0.950255).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0814550
	speed: 0.2955s/iter; left time: 6624.0101s
	iters: 200, epoch: 3 | loss: 0.0757921
	speed: 0.0461s/iter; left time: 1028.0204s
	iters: 300, epoch: 3 | loss: 0.0179039
	speed: 0.0496s/iter; left time: 1101.0067s
	iters: 400, epoch: 3 | loss: 0.3039422
	speed: 0.0487s/iter; left time: 1076.6161s
Epoch: 3 cost time: 22.61354160308838
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
Validation loss decreased (-0.950255 --> -0.968552).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0007349
	speed: 0.2998s/iter; left time: 6579.4708s
	iters: 200, epoch: 4 | loss: 0.0035804
	speed: 0.0510s/iter; left time: 1113.7063s
	iters: 300, epoch: 4 | loss: 0.0002214
	speed: 0.0471s/iter; left time: 1024.0039s
	iters: 400, epoch: 4 | loss: 0.0094511
	speed: 0.0457s/iter; left time: 989.0456s
Epoch: 4 cost time: 23.080559253692627
Epoch: 4, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0063662
	speed: 0.3023s/iter; left time: 6490.8805s
	iters: 200, epoch: 5 | loss: 0.0006669
	speed: 0.0473s/iter; left time: 1011.2120s
	iters: 300, epoch: 5 | loss: 0.0287365
	speed: 0.0486s/iter; left time: 1033.4723s
	iters: 400, epoch: 5 | loss: 0.0001204
	speed: 0.0501s/iter; left time: 1061.6728s
Epoch: 5 cost time: 23.008009672164917
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
Validation loss decreased (-0.968552 --> -0.974270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0003286
	speed: 0.2982s/iter; left time: 6264.0216s
	iters: 200, epoch: 6 | loss: 0.0002673
	speed: 0.0502s/iter; left time: 1049.5242s
	iters: 300, epoch: 6 | loss: 0.0001655
	speed: 0.0491s/iter; left time: 1021.4141s
	iters: 400, epoch: 6 | loss: 0.0014015
	speed: 0.0500s/iter; left time: 1034.3126s
Epoch: 6 cost time: 23.68488335609436
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1028652
	speed: 0.3029s/iter; left time: 6220.0798s
	iters: 200, epoch: 7 | loss: 0.0000517
	speed: 0.0493s/iter; left time: 1008.1323s
	iters: 300, epoch: 7 | loss: 0.0062800
	speed: 0.0480s/iter; left time: 975.6276s
	iters: 400, epoch: 7 | loss: 0.1508270
	speed: 0.0489s/iter; left time: 989.7830s
Epoch: 7 cost time: 23.13182044029236
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0623764
	speed: 0.3029s/iter; left time: 6078.9546s
	iters: 200, epoch: 8 | loss: 0.0352553
	speed: 0.0467s/iter; left time: 932.2118s
	iters: 300, epoch: 8 | loss: 0.0003423
	speed: 0.0475s/iter; left time: 943.7533s
	iters: 400, epoch: 8 | loss: 0.0007637
	speed: 0.0481s/iter; left time: 951.4018s
Epoch: 8 cost time: 22.3250834941864
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.255 Vali Acc: 0.962 Test Loss: 0.255 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000618
	speed: 0.2900s/iter; left time: 5683.3867s
	iters: 200, epoch: 9 | loss: 0.0005113
	speed: 0.0480s/iter; left time: 936.3684s
	iters: 300, epoch: 9 | loss: 0.0000016
	speed: 0.0451s/iter; left time: 874.2345s
	iters: 400, epoch: 9 | loss: 0.0000035
	speed: 0.0432s/iter; left time: 833.5021s
Epoch: 9 cost time: 22.128862857818604
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.314 Vali Acc: 0.963 Test Loss: 0.314 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000195
	speed: 0.2982s/iter; left time: 5704.6039s
	iters: 200, epoch: 10 | loss: 0.5447861
	speed: 0.0499s/iter; left time: 950.3925s
	iters: 300, epoch: 10 | loss: 0.0060639
	speed: 0.0536s/iter; left time: 1015.3486s
	iters: 400, epoch: 10 | loss: 0.0000508
	speed: 0.0534s/iter; left time: 1004.5857s
Epoch: 10 cost time: 24.127979040145874
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
Validation loss decreased (-0.974270 --> -0.978272).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0003671
	speed: 0.3030s/iter; left time: 5653.6898s
	iters: 200, epoch: 11 | loss: 0.0000830
	speed: 0.0483s/iter; left time: 896.4266s
	iters: 300, epoch: 11 | loss: 0.0000102
	speed: 0.0472s/iter; left time: 871.8001s
	iters: 400, epoch: 11 | loss: 0.0024227
	speed: 0.0472s/iter; left time: 866.0632s
Epoch: 11 cost time: 23.154221534729004
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.366 Vali Acc: 0.946 Test Loss: 0.366 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0002482
	speed: 0.2945s/iter; left time: 5356.7626s
	iters: 200, epoch: 12 | loss: 0.0233158
	speed: 0.0480s/iter; left time: 868.4866s
	iters: 300, epoch: 12 | loss: 0.4457685
	speed: 0.0531s/iter; left time: 955.4257s
	iters: 400, epoch: 12 | loss: 0.0000002
	speed: 0.0533s/iter; left time: 953.2145s
Epoch: 12 cost time: 23.749231100082397
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.275 Vali Acc: 0.965 Test Loss: 0.275 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000027
	speed: 0.3072s/iter; left time: 5445.3613s
	iters: 200, epoch: 13 | loss: 0.0000145
	speed: 0.0450s/iter; left time: 792.5571s
	iters: 300, epoch: 13 | loss: 0.0160944
	speed: 0.0435s/iter; left time: 761.7865s
	iters: 400, epoch: 13 | loss: 0.0000373
	speed: 0.0446s/iter; left time: 777.3561s
Epoch: 13 cost time: 22.02347683906555
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.330 Vali Acc: 0.966 Test Loss: 0.330 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0001145
	speed: 0.2858s/iter; left time: 4930.6825s
	iters: 200, epoch: 14 | loss: 0.0013030
	speed: 0.0525s/iter; left time: 900.6091s
	iters: 300, epoch: 14 | loss: 0.0000335
	speed: 0.0528s/iter; left time: 900.9635s
	iters: 400, epoch: 14 | loss: 0.0003289
	speed: 0.0495s/iter; left time: 839.6767s
Epoch: 14 cost time: 23.711809635162354
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0074273
	speed: 0.2895s/iter; left time: 4858.5831s
	iters: 200, epoch: 15 | loss: 0.0000018
	speed: 0.0474s/iter; left time: 791.2945s
	iters: 300, epoch: 15 | loss: 0.0000005
	speed: 0.0491s/iter; left time: 814.9919s
	iters: 400, epoch: 15 | loss: 0.0208705
	speed: 0.0507s/iter; left time: 835.9152s
Epoch: 15 cost time: 23.40024495124817
Epoch: 15, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.258 Vali Acc: 0.973 Test Loss: 0.258 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0001015
	speed: 0.2919s/iter; left time: 4763.3208s
	iters: 200, epoch: 16 | loss: 0.0008917
	speed: 0.0531s/iter; left time: 860.4834s
	iters: 300, epoch: 16 | loss: 0.0494455
	speed: 0.0529s/iter; left time: 852.3261s
	iters: 400, epoch: 16 | loss: 0.0000187
	speed: 0.0507s/iter; left time: 811.5879s
Epoch: 16 cost time: 24.708837270736694
Epoch: 16, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.250 Vali Acc: 0.976 Test Loss: 0.250 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2989205
	speed: 0.2963s/iter; left time: 4695.8508s
	iters: 200, epoch: 17 | loss: 0.0000014
	speed: 0.0501s/iter; left time: 789.3961s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0441s/iter; left time: 690.7133s
	iters: 400, epoch: 17 | loss: 0.0001306
	speed: 0.0467s/iter; left time: 726.3905s
Epoch: 17 cost time: 22.285826921463013
Epoch: 17, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.306 Vali Acc: 0.972 Test Loss: 0.306 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.5108011
	speed: 0.2964s/iter; left time: 4557.5915s
	iters: 200, epoch: 18 | loss: 0.3383409
	speed: 0.0534s/iter; left time: 815.1046s
	iters: 300, epoch: 18 | loss: 0.0025070
	speed: 0.0515s/iter; left time: 781.2030s
	iters: 400, epoch: 18 | loss: 0.0001434
	speed: 0.0464s/iter; left time: 698.8877s
Epoch: 18 cost time: 23.48298478126526
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000004
	speed: 0.2872s/iter; left time: 4282.4732s
	iters: 200, epoch: 19 | loss: 0.0000034
	speed: 0.0535s/iter; left time: 791.7459s
	iters: 300, epoch: 19 | loss: 0.0000376
	speed: 0.0535s/iter; left time: 786.7239s
	iters: 400, epoch: 19 | loss: 0.0628683
	speed: 0.0453s/iter; left time: 661.0875s
Epoch: 19 cost time: 23.90170168876648
Epoch: 19, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000001
	speed: 0.2970s/iter; left time: 4288.4039s
	iters: 200, epoch: 20 | loss: 0.0000001
	speed: 0.0491s/iter; left time: 704.6572s
	iters: 300, epoch: 20 | loss: 0.0000775
	speed: 0.0459s/iter; left time: 653.8144s
	iters: 400, epoch: 20 | loss: 0.0000048
	speed: 0.0463s/iter; left time: 654.0524s
Epoch: 20 cost time: 22.658997297286987
Epoch: 20, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.429 Vali Acc: 0.961 Test Loss: 0.429 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 320010
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4224287
	speed: 0.0617s/iter; left time: 1439.9738s
	iters: 200, epoch: 1 | loss: 0.0674346
	speed: 0.0516s/iter; left time: 1200.2703s
	iters: 300, epoch: 1 | loss: 0.1693347
	speed: 0.0525s/iter; left time: 1214.4591s
	iters: 400, epoch: 1 | loss: 0.0226398
	speed: 0.0512s/iter; left time: 1180.8260s
Epoch: 1 cost time: 25.046563386917114
Epoch: 1, Steps: 469 | Train Loss: 0.335 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (inf --> -0.962834).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0436564
	speed: 0.2560s/iter; left time: 5857.6517s
	iters: 200, epoch: 2 | loss: 0.0168700
	speed: 0.0391s/iter; left time: 891.3153s
	iters: 300, epoch: 2 | loss: 0.5037457
	speed: 0.0396s/iter; left time: 898.7238s
	iters: 400, epoch: 2 | loss: 0.0128313
	speed: 0.0489s/iter; left time: 1103.8927s
Epoch: 2 cost time: 20.544047594070435
Epoch: 2, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.962834 --> -0.974841).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0597473
	speed: 0.3025s/iter; left time: 6779.6101s
	iters: 200, epoch: 3 | loss: 0.0193275
	speed: 0.0543s/iter; left time: 1212.6782s
	iters: 300, epoch: 3 | loss: 0.0042059
	speed: 0.0546s/iter; left time: 1212.6066s
	iters: 400, epoch: 3 | loss: 0.0055892
	speed: 0.0534s/iter; left time: 1181.6863s
Epoch: 3 cost time: 25.324296951293945
Epoch: 3, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0015821
	speed: 0.2962s/iter; left time: 6500.3830s
	iters: 200, epoch: 4 | loss: 0.0037815
	speed: 0.0515s/iter; left time: 1125.0889s
	iters: 300, epoch: 4 | loss: 0.0029788
	speed: 0.0515s/iter; left time: 1119.1194s
	iters: 400, epoch: 4 | loss: 0.0055411
	speed: 0.0520s/iter; left time: 1126.2015s
Epoch: 4 cost time: 24.58757734298706
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0019110
	speed: 0.2995s/iter; left time: 6432.0156s
	iters: 200, epoch: 5 | loss: 0.3664331
	speed: 0.0544s/iter; left time: 1163.7228s
	iters: 300, epoch: 5 | loss: 0.0009899
	speed: 0.0545s/iter; left time: 1160.3094s
	iters: 400, epoch: 5 | loss: 0.0006264
	speed: 0.0525s/iter; left time: 1110.7777s
Epoch: 5 cost time: 24.739654064178467
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0004086
	speed: 0.3089s/iter; left time: 6488.8549s
	iters: 200, epoch: 6 | loss: 0.0008477
	speed: 0.0498s/iter; left time: 1040.4090s
	iters: 300, epoch: 6 | loss: 0.0005959
	speed: 0.0503s/iter; left time: 1046.6184s
	iters: 400, epoch: 6 | loss: 0.0000841
	speed: 0.0496s/iter; left time: 1026.2026s
Epoch: 6 cost time: 23.846659898757935
Epoch: 6, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.967 Test Loss: 0.208 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0053876
	speed: 0.3124s/iter; left time: 6415.3848s
	iters: 200, epoch: 7 | loss: 0.0106787
	speed: 0.0541s/iter; left time: 1105.9687s
	iters: 300, epoch: 7 | loss: 0.0012813
	speed: 0.0525s/iter; left time: 1067.0850s
	iters: 400, epoch: 7 | loss: 0.0001775
	speed: 0.0433s/iter; left time: 877.2446s
Epoch: 7 cost time: 23.905314683914185
Epoch: 7, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.215 Vali Acc: 0.964 Test Loss: 0.215 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0005500
	speed: 0.3116s/iter; left time: 6253.2918s
	iters: 200, epoch: 8 | loss: 0.3186909
	speed: 0.0517s/iter; left time: 1031.9519s
	iters: 300, epoch: 8 | loss: 0.0007877
	speed: 0.0493s/iter; left time: 980.2315s
	iters: 400, epoch: 8 | loss: 0.0004634
	speed: 0.0455s/iter; left time: 900.2353s
Epoch: 8 cost time: 23.375130653381348
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0000997
	speed: 0.3141s/iter; left time: 6155.6290s
	iters: 200, epoch: 9 | loss: 0.0001791
	speed: 0.0550s/iter; left time: 1072.3606s
	iters: 300, epoch: 9 | loss: 0.0137065
	speed: 0.0514s/iter; left time: 997.7705s
	iters: 400, epoch: 9 | loss: 0.0635444
	speed: 0.0497s/iter; left time: 958.5667s
Epoch: 9 cost time: 24.67152452468872
Epoch: 9, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000034
	speed: 0.3231s/iter; left time: 6180.2942s
	iters: 200, epoch: 10 | loss: 0.0001389
	speed: 0.0507s/iter; left time: 965.2387s
	iters: 300, epoch: 10 | loss: 0.0001928
	speed: 0.0480s/iter; left time: 908.7922s
	iters: 400, epoch: 10 | loss: 0.0000035
	speed: 0.0485s/iter; left time: 913.7322s
Epoch: 10 cost time: 24.040517330169678
Epoch: 10, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0008149
	speed: 0.3214s/iter; left time: 5997.8199s
	iters: 200, epoch: 11 | loss: 0.0016358
	speed: 0.0521s/iter; left time: 967.7219s
	iters: 300, epoch: 11 | loss: 0.0000056
	speed: 0.0509s/iter; left time: 939.7685s
	iters: 400, epoch: 11 | loss: 0.0015251
	speed: 0.0495s/iter; left time: 908.5854s
Epoch: 11 cost time: 24.25391936302185
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0005260
	speed: 0.3283s/iter; left time: 5972.5073s
	iters: 200, epoch: 12 | loss: 0.0003909
	speed: 0.0452s/iter; left time: 817.1665s
	iters: 300, epoch: 12 | loss: 0.0001717
	speed: 0.0469s/iter; left time: 843.7181s
	iters: 400, epoch: 12 | loss: 0.0000086
	speed: 0.0480s/iter; left time: 858.7999s
Epoch: 12 cost time: 22.941517114639282
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.976 Test Loss: 0.165 Test Acc: 0.976
Validation loss decreased (-0.974841 --> -0.975985).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000152
	speed: 0.3251s/iter; left time: 5761.3492s
	iters: 200, epoch: 13 | loss: 0.0000911
	speed: 0.0502s/iter; left time: 885.2294s
	iters: 300, epoch: 13 | loss: 0.0001804
	speed: 0.0490s/iter; left time: 858.1317s
	iters: 400, epoch: 13 | loss: 0.0000954
	speed: 0.0503s/iter; left time: 875.9816s
Epoch: 13 cost time: 23.655270099639893
Epoch: 13, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.293 Vali Acc: 0.963 Test Loss: 0.293 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0002097
	speed: 0.3263s/iter; left time: 5629.8203s
	iters: 200, epoch: 14 | loss: 0.1741511
	speed: 0.0476s/iter; left time: 815.8251s
	iters: 300, epoch: 14 | loss: 0.0000178
	speed: 0.0479s/iter; left time: 816.2103s
	iters: 400, epoch: 14 | loss: 0.0000364
	speed: 0.0474s/iter; left time: 804.3851s
Epoch: 14 cost time: 22.628509521484375
Epoch: 14, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.242 Vali Acc: 0.973 Test Loss: 0.242 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0002654
	speed: 0.2889s/iter; left time: 4849.2288s
	iters: 200, epoch: 15 | loss: 0.0000001
	speed: 0.0512s/iter; left time: 853.6764s
	iters: 300, epoch: 15 | loss: 0.0000603
	speed: 0.0465s/iter; left time: 771.7073s
	iters: 400, epoch: 15 | loss: 0.0013386
	speed: 0.0485s/iter; left time: 798.7007s
Epoch: 15 cost time: 23.568944692611694
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0031549
	speed: 0.3030s/iter; left time: 4944.0435s
	iters: 200, epoch: 16 | loss: 0.0000007
	speed: 0.0532s/iter; left time: 863.0114s
	iters: 300, epoch: 16 | loss: 0.0000148
	speed: 0.0551s/iter; left time: 888.4991s
	iters: 400, epoch: 16 | loss: 0.0000176
	speed: 0.0526s/iter; left time: 843.1670s
Epoch: 16 cost time: 24.911717653274536
Epoch: 16, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.292 Vali Acc: 0.970 Test Loss: 0.292 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000281
	speed: 0.3145s/iter; left time: 4983.2709s
	iters: 200, epoch: 17 | loss: 0.0000699
	speed: 0.0529s/iter; left time: 833.3738s
	iters: 300, epoch: 17 | loss: 0.0698438
	speed: 0.0485s/iter; left time: 759.1582s
	iters: 400, epoch: 17 | loss: 0.0013481
	speed: 0.0515s/iter; left time: 799.8939s
Epoch: 17 cost time: 24.40200138092041
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0009812
	speed: 0.3101s/iter; left time: 4768.0412s
	iters: 200, epoch: 18 | loss: 0.0001576
	speed: 0.0449s/iter; left time: 685.5863s
	iters: 300, epoch: 18 | loss: 0.0001100
	speed: 0.0512s/iter; left time: 776.7317s
	iters: 400, epoch: 18 | loss: 0.0070627
	speed: 0.0519s/iter; left time: 782.2810s
Epoch: 18 cost time: 23.29125142097473
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.313 Vali Acc: 0.964 Test Loss: 0.313 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0002220
	speed: 0.3205s/iter; left time: 4778.1677s
	iters: 200, epoch: 19 | loss: 0.0030017
	speed: 0.0535s/iter; left time: 792.2489s
	iters: 300, epoch: 19 | loss: 0.0003212
	speed: 0.0507s/iter; left time: 746.1245s
	iters: 400, epoch: 19 | loss: 0.0066539
	speed: 0.0460s/iter; left time: 672.4539s
Epoch: 19 cost time: 24.0803325176239
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.311 Vali Acc: 0.971 Test Loss: 0.311 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000012
	speed: 0.3198s/iter; left time: 4618.0847s
	iters: 200, epoch: 20 | loss: 0.0041857
	speed: 0.0483s/iter; left time: 693.2308s
	iters: 300, epoch: 20 | loss: 0.0471240
	speed: 0.0503s/iter; left time: 716.5661s
	iters: 400, epoch: 20 | loss: 0.0000024
	speed: 0.0523s/iter; left time: 738.9538s
Epoch: 20 cost time: 23.920318603515625
Epoch: 20, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.968 Test Loss: 0.222 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0578365
	speed: 0.3108s/iter; left time: 4341.8782s
	iters: 200, epoch: 21 | loss: 0.0009240
	speed: 0.0539s/iter; left time: 746.9745s
	iters: 300, epoch: 21 | loss: 0.0056947
	speed: 0.0500s/iter; left time: 688.7165s
	iters: 400, epoch: 21 | loss: 0.0000164
	speed: 0.0490s/iter; left time: 669.7451s
Epoch: 21 cost time: 24.446497201919556
Epoch: 21, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.978 Test Loss: 0.195 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.977985).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.3122s/iter; left time: 4215.2988s
	iters: 200, epoch: 22 | loss: 0.0032149
	speed: 0.0500s/iter; left time: 670.0827s
	iters: 300, epoch: 22 | loss: 0.0074516
	speed: 0.0541s/iter; left time: 719.3865s
	iters: 400, epoch: 22 | loss: 0.0015626
	speed: 0.0532s/iter; left time: 702.8840s
Epoch: 22 cost time: 24.576798677444458
Epoch: 22, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.368 Vali Acc: 0.959 Test Loss: 0.368 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000028
	speed: 0.3041s/iter; left time: 3963.5686s
	iters: 200, epoch: 23 | loss: 0.0000004
	speed: 0.0523s/iter; left time: 676.4340s
	iters: 300, epoch: 23 | loss: 0.0000011
	speed: 0.0525s/iter; left time: 673.5715s
	iters: 400, epoch: 23 | loss: 0.0000025
	speed: 0.0514s/iter; left time: 654.5816s
Epoch: 23 cost time: 24.694326400756836
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.257 Vali Acc: 0.968 Test Loss: 0.257 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.3182s/iter; left time: 3997.8812s
	iters: 200, epoch: 24 | loss: 0.0000006
	speed: 0.0483s/iter; left time: 602.2198s
	iters: 300, epoch: 24 | loss: 0.0000109
	speed: 0.0495s/iter; left time: 612.5472s
	iters: 400, epoch: 24 | loss: 0.0022373
	speed: 0.0529s/iter; left time: 648.7975s
Epoch: 24 cost time: 24.181800365447998
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.272 Vali Acc: 0.973 Test Loss: 0.272 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0005486
	speed: 0.3174s/iter; left time: 3838.8863s
	iters: 200, epoch: 25 | loss: 0.0000021
	speed: 0.0507s/iter; left time: 608.3205s
	iters: 300, epoch: 25 | loss: 0.0000003
	speed: 0.0506s/iter; left time: 601.9416s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.0460s/iter; left time: 542.6810s
Epoch: 25 cost time: 23.61000418663025
Epoch: 25, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.265 Vali Acc: 0.973 Test Loss: 0.265 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0000028
	speed: 0.3194s/iter; left time: 3712.7693s
	iters: 200, epoch: 26 | loss: 0.0000624
	speed: 0.0492s/iter; left time: 566.6929s
	iters: 300, epoch: 26 | loss: 0.0000000
	speed: 0.0484s/iter; left time: 552.5969s
	iters: 400, epoch: 26 | loss: 0.0011292
	speed: 0.0530s/iter; left time: 600.2336s
Epoch: 26 cost time: 24.24139380455017
Epoch: 26, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.204 Vali Acc: 0.977 Test Loss: 0.204 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000019
	speed: 0.3207s/iter; left time: 3578.0540s
	iters: 200, epoch: 27 | loss: 0.0006246
	speed: 0.0540s/iter; left time: 596.6325s
	iters: 300, epoch: 27 | loss: 0.0000002
	speed: 0.0528s/iter; left time: 578.5110s
	iters: 400, epoch: 27 | loss: 0.0000234
	speed: 0.0506s/iter; left time: 549.3169s
Epoch: 27 cost time: 24.504958152770996
Epoch: 27, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.968 Test Loss: 0.279 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0086973
	speed: 0.2842s/iter; left time: 3037.8125s
	iters: 200, epoch: 28 | loss: 0.0000012
	speed: 0.0505s/iter; left time: 535.0085s
	iters: 300, epoch: 28 | loss: 0.0000008
	speed: 0.0508s/iter; left time: 532.8702s
	iters: 400, epoch: 28 | loss: 0.0005520
	speed: 0.0494s/iter; left time: 512.6889s
Epoch: 28 cost time: 23.245150804519653
Epoch: 28, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.971 Test Loss: 0.287 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000143
	speed: 0.3109s/iter; left time: 3177.4594s
	iters: 200, epoch: 29 | loss: 0.0001646
	speed: 0.0497s/iter; left time: 503.2231s
	iters: 300, epoch: 29 | loss: 0.0141580
	speed: 0.0512s/iter; left time: 513.2562s
	iters: 400, epoch: 29 | loss: 0.0000194
	speed: 0.0545s/iter; left time: 540.9748s
Epoch: 29 cost time: 23.991260528564453
Epoch: 29, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.978 Test Loss: 0.206 Test Acc: 0.978
Validation loss decreased (-0.977985 --> -0.978271).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.2262147
	speed: 0.3097s/iter; left time: 3019.6682s
	iters: 200, epoch: 30 | loss: 0.0000102
	speed: 0.0472s/iter; left time: 455.4507s
	iters: 300, epoch: 30 | loss: 0.0003366
	speed: 0.0460s/iter; left time: 439.0035s
	iters: 400, epoch: 30 | loss: 0.0000002
	speed: 0.0467s/iter; left time: 441.5067s
Epoch: 30 cost time: 23.35611128807068
Epoch: 30, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.976 Test Loss: 0.260 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000037
	speed: 0.3201s/iter; left time: 2970.7719s
	iters: 200, epoch: 31 | loss: 0.0380970
	speed: 0.0524s/iter; left time: 480.8390s
	iters: 300, epoch: 31 | loss: 0.0001445
	speed: 0.0479s/iter; left time: 434.5410s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0435s/iter; left time: 391.0242s
Epoch: 31 cost time: 22.65885019302368
Epoch: 31, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000001
	speed: 0.3128s/iter; left time: 2756.1683s
	iters: 200, epoch: 32 | loss: 0.0002421
	speed: 0.0480s/iter; left time: 418.0261s
	iters: 300, epoch: 32 | loss: 0.0000005
	speed: 0.0516s/iter; left time: 444.2088s
	iters: 400, epoch: 32 | loss: 0.0000004
	speed: 0.0530s/iter; left time: 451.0549s
Epoch: 32 cost time: 23.900469303131104
Epoch: 32, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.973 Test Loss: 0.224 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000488
	speed: 0.2911s/iter; left time: 2428.9074s
	iters: 200, epoch: 33 | loss: 0.0000381
	speed: 0.0461s/iter; left time: 380.1254s
	iters: 300, epoch: 33 | loss: 0.0000781
	speed: 0.0452s/iter; left time: 368.1508s
	iters: 400, epoch: 33 | loss: 0.0002384
	speed: 0.0501s/iter; left time: 403.2084s
Epoch: 33 cost time: 22.691681385040283
Epoch: 33, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.301 Vali Acc: 0.965 Test Loss: 0.301 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000201
	speed: 0.3066s/iter; left time: 2413.8335s
	iters: 200, epoch: 34 | loss: 0.0000001
	speed: 0.0478s/iter; left time: 371.9771s
	iters: 300, epoch: 34 | loss: 0.0000010
	speed: 0.0496s/iter; left time: 380.7057s
	iters: 400, epoch: 34 | loss: 0.0000009
	speed: 0.0497s/iter; left time: 376.1419s
Epoch: 34 cost time: 23.576131105422974
Epoch: 34, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.361 Vali Acc: 0.969 Test Loss: 0.361 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000047
	speed: 0.2983s/iter; left time: 2208.7132s
	iters: 200, epoch: 35 | loss: 0.0006555
	speed: 0.0523s/iter; left time: 382.1520s
	iters: 300, epoch: 35 | loss: 0.0000001
	speed: 0.0503s/iter; left time: 362.2276s
	iters: 400, epoch: 35 | loss: 0.0000001
	speed: 0.0475s/iter; left time: 337.5900s
Epoch: 35 cost time: 23.648013830184937
Epoch: 35, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.971 Test Loss: 0.225 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0000125
	speed: 0.3016s/iter; left time: 2091.9996s
	iters: 200, epoch: 36 | loss: 0.0017989
	speed: 0.0468s/iter; left time: 319.8522s
	iters: 300, epoch: 36 | loss: 0.0000191
	speed: 0.0476s/iter; left time: 320.8655s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0515s/iter; left time: 341.8083s
Epoch: 36 cost time: 23.115484476089478
Epoch: 36, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.981 Test Loss: 0.167 Test Acc: 0.981
Validation loss decreased (-0.978271 --> -0.981416).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000082
	speed: 0.2980s/iter; left time: 1927.4773s
	iters: 200, epoch: 37 | loss: 0.0000001
	speed: 0.0452s/iter; left time: 287.8007s
	iters: 300, epoch: 37 | loss: 0.0002298
	speed: 0.0450s/iter; left time: 282.0092s
	iters: 400, epoch: 37 | loss: 0.0000021
	speed: 0.0455s/iter; left time: 280.6655s
Epoch: 37 cost time: 21.907392978668213
Epoch: 37, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.240 Vali Acc: 0.971 Test Loss: 0.240 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0001124
	speed: 0.2990s/iter; left time: 1793.4934s
	iters: 200, epoch: 38 | loss: 0.0000006
	speed: 0.0471s/iter; left time: 277.7581s
	iters: 300, epoch: 38 | loss: 0.0000006
	speed: 0.0495s/iter; left time: 286.7210s
	iters: 400, epoch: 38 | loss: 0.0000174
	speed: 0.0494s/iter; left time: 281.4246s
Epoch: 38 cost time: 22.81124234199524
Epoch: 38, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.313 Vali Acc: 0.973 Test Loss: 0.313 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000441
	speed: 0.2979s/iter; left time: 1647.2848s
	iters: 200, epoch: 39 | loss: 0.0000031
	speed: 0.0449s/iter; left time: 243.9389s
	iters: 300, epoch: 39 | loss: 0.0000433
	speed: 0.0416s/iter; left time: 221.4393s
	iters: 400, epoch: 39 | loss: 0.0068120
	speed: 0.0468s/iter; left time: 244.7479s
Epoch: 39 cost time: 21.793776273727417
Epoch: 39, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.976 Test Loss: 0.213 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0000397
	speed: 0.3006s/iter; left time: 1521.2489s
	iters: 200, epoch: 40 | loss: 0.0000000
	speed: 0.0473s/iter; left time: 234.3629s
	iters: 300, epoch: 40 | loss: 0.0000131
	speed: 0.0486s/iter; left time: 236.1893s
	iters: 400, epoch: 40 | loss: 0.0009549
	speed: 0.0463s/iter; left time: 220.4363s
Epoch: 40 cost time: 22.65747618675232
Epoch: 40, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.207 Vali Acc: 0.981 Test Loss: 0.207 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0030582
	speed: 0.2961s/iter; left time: 1359.2371s
	iters: 200, epoch: 41 | loss: 0.0003414
	speed: 0.0507s/iter; left time: 227.5037s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0477s/iter; left time: 209.6697s
	iters: 400, epoch: 41 | loss: 0.0006890
	speed: 0.0446s/iter; left time: 191.4355s
Epoch: 41 cost time: 22.491530895233154
Epoch: 41, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0794827
	speed: 0.2913s/iter; left time: 1200.5556s
	iters: 200, epoch: 42 | loss: 0.0000020
	speed: 0.0457s/iter; left time: 183.6991s
	iters: 300, epoch: 42 | loss: 0.0000035
	speed: 0.0486s/iter; left time: 190.6502s
	iters: 400, epoch: 42 | loss: 0.0001336
	speed: 0.0516s/iter; left time: 197.3997s
Epoch: 42 cost time: 23.01103448867798
Epoch: 42, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.247 Vali Acc: 0.976 Test Loss: 0.247 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0000020
	speed: 0.2866s/iter; left time: 1046.7680s
	iters: 200, epoch: 43 | loss: 0.0000282
	speed: 0.0437s/iter; left time: 155.3516s
	iters: 300, epoch: 43 | loss: 0.0000002
	speed: 0.0392s/iter; left time: 135.2650s
	iters: 400, epoch: 43 | loss: 0.0572237
	speed: 0.0444s/iter; left time: 149.0306s
Epoch: 43 cost time: 20.731557846069336
Epoch: 43, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.310 Vali Acc: 0.969 Test Loss: 0.310 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0000031
	speed: 0.2901s/iter; left time: 923.8169s
	iters: 200, epoch: 44 | loss: 0.0000011
	speed: 0.0455s/iter; left time: 140.4566s
	iters: 300, epoch: 44 | loss: 0.0000003
	speed: 0.0490s/iter; left time: 146.1572s
	iters: 400, epoch: 44 | loss: 0.0011098
	speed: 0.0459s/iter; left time: 132.2967s
Epoch: 44 cost time: 21.939993619918823
Epoch: 44, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.972 Test Loss: 0.239 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0000016
	speed: 0.2936s/iter; left time: 797.0764s
	iters: 200, epoch: 45 | loss: 0.0000020
	speed: 0.0464s/iter; left time: 121.2170s
	iters: 300, epoch: 45 | loss: 0.0000091
	speed: 0.0434s/iter; left time: 109.1578s
	iters: 400, epoch: 45 | loss: 0.0000004
	speed: 0.0444s/iter; left time: 107.1209s
Epoch: 45 cost time: 21.696945190429688
Epoch: 45, Steps: 469 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.976 Test Loss: 0.256 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.2939s/iter; left time: 660.0079s
	iters: 200, epoch: 46 | loss: 0.0000466
	speed: 0.0456s/iter; left time: 97.7988s
	iters: 300, epoch: 46 | loss: 0.0000000
	speed: 0.0438s/iter; left time: 89.5971s
	iters: 400, epoch: 46 | loss: 0.0000063
	speed: 0.0396s/iter; left time: 77.1185s
Epoch: 46 cost time: 20.83837056159973
Epoch: 46, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.372 Vali Acc: 0.972 Test Loss: 0.372 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 320266
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4002349
	speed: 0.0519s/iter; left time: 1212.1882s
	iters: 200, epoch: 1 | loss: 0.3637506
	speed: 0.0336s/iter; left time: 781.6272s
	iters: 300, epoch: 1 | loss: 0.0751223
	speed: 0.0339s/iter; left time: 784.7017s
	iters: 400, epoch: 1 | loss: 0.3081053
	speed: 0.0330s/iter; left time: 760.5609s
Epoch: 1 cost time: 17.89337730407715
Epoch: 1, Steps: 469 | Train Loss: 0.484 Vali Loss: 0.242 Vali Acc: 0.942 Test Loss: 0.242 Test Acc: 0.942
Validation loss decreased (inf --> -0.941964).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0089632
	speed: 0.2369s/iter; left time: 5420.7419s
	iters: 200, epoch: 2 | loss: 0.0801106
	speed: 0.0347s/iter; left time: 790.3209s
	iters: 300, epoch: 2 | loss: 0.2154008
	speed: 0.0372s/iter; left time: 842.8254s
	iters: 400, epoch: 2 | loss: 0.0058714
	speed: 0.0349s/iter; left time: 788.6417s
Epoch: 2 cost time: 16.7852942943573
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
Validation loss decreased (-0.941964 --> -0.967980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034614
	speed: 0.2169s/iter; left time: 4862.3201s
	iters: 200, epoch: 3 | loss: 0.0169232
	speed: 0.0354s/iter; left time: 789.7899s
	iters: 300, epoch: 3 | loss: 0.0179905
	speed: 0.0357s/iter; left time: 792.0790s
	iters: 400, epoch: 3 | loss: 0.0053234
	speed: 0.0338s/iter; left time: 747.4808s
Epoch: 3 cost time: 16.927500009536743
Epoch: 3, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0019923
	speed: 0.2253s/iter; left time: 4944.1166s
	iters: 200, epoch: 4 | loss: 0.0613542
	speed: 0.0334s/iter; left time: 730.2832s
	iters: 300, epoch: 4 | loss: 0.0113141
	speed: 0.0366s/iter; left time: 795.7685s
	iters: 400, epoch: 4 | loss: 0.0100134
	speed: 0.0369s/iter; left time: 797.7824s
Epoch: 4 cost time: 16.90442705154419
Epoch: 4, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.193 Vali Acc: 0.966 Test Loss: 0.193 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0025548
	speed: 0.2277s/iter; left time: 4889.9720s
	iters: 200, epoch: 5 | loss: 0.0008313
	speed: 0.0356s/iter; left time: 759.9704s
	iters: 300, epoch: 5 | loss: 0.0003680
	speed: 0.0354s/iter; left time: 753.5151s
	iters: 400, epoch: 5 | loss: 0.0759997
	speed: 0.0348s/iter; left time: 736.4502s
Epoch: 5 cost time: 16.887465953826904
Epoch: 5, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002511
	speed: 0.2240s/iter; left time: 4705.2888s
	iters: 200, epoch: 6 | loss: 0.0190952
	speed: 0.0366s/iter; left time: 764.6227s
	iters: 300, epoch: 6 | loss: 0.0096478
	speed: 0.0355s/iter; left time: 739.3738s
	iters: 400, epoch: 6 | loss: 0.0938009
	speed: 0.0350s/iter; left time: 724.5659s
Epoch: 6 cost time: 17.310306310653687
Epoch: 6, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0016611
	speed: 0.2176s/iter; left time: 4467.9839s
	iters: 200, epoch: 7 | loss: 0.0000593
	speed: 0.0351s/iter; left time: 716.5463s
	iters: 300, epoch: 7 | loss: 0.0007929
	speed: 0.0285s/iter; left time: 580.0355s
	iters: 400, epoch: 7 | loss: 0.0028607
	speed: 0.0314s/iter; left time: 635.5523s
Epoch: 7 cost time: 15.983907699584961
Epoch: 7, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
Validation loss decreased (-0.967980 --> -0.975413).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0013389
	speed: 0.2323s/iter; left time: 4662.5997s
	iters: 200, epoch: 8 | loss: 0.0037511
	speed: 0.0361s/iter; left time: 720.4930s
	iters: 300, epoch: 8 | loss: 0.0008853
	speed: 0.0379s/iter; left time: 753.5344s
	iters: 400, epoch: 8 | loss: 0.0022305
	speed: 0.0380s/iter; left time: 750.5619s
Epoch: 8 cost time: 17.582526445388794
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0084276
	speed: 0.2322s/iter; left time: 4550.9541s
	iters: 200, epoch: 9 | loss: 0.0019396
	speed: 0.0363s/iter; left time: 707.4249s
	iters: 300, epoch: 9 | loss: 0.0001963
	speed: 0.0360s/iter; left time: 699.2365s
	iters: 400, epoch: 9 | loss: 0.2236836
	speed: 0.0357s/iter; left time: 689.8990s
Epoch: 9 cost time: 17.44297218322754
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.264 Vali Acc: 0.952 Test Loss: 0.264 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000690
	speed: 0.2339s/iter; left time: 4474.3623s
	iters: 200, epoch: 10 | loss: 0.0001091
	speed: 0.0375s/iter; left time: 714.0815s
	iters: 300, epoch: 10 | loss: 0.0023209
	speed: 0.0366s/iter; left time: 692.6926s
	iters: 400, epoch: 10 | loss: 0.0000138
	speed: 0.0385s/iter; left time: 724.5659s
Epoch: 10 cost time: 18.04629898071289
Epoch: 10, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0244760
	speed: 0.2291s/iter; left time: 4275.6268s
	iters: 200, epoch: 11 | loss: 0.0030531
	speed: 0.0375s/iter; left time: 696.0888s
	iters: 300, epoch: 11 | loss: 0.0040751
	speed: 0.0383s/iter; left time: 707.5633s
	iters: 400, epoch: 11 | loss: 0.0001365
	speed: 0.0363s/iter; left time: 667.2391s
Epoch: 11 cost time: 17.905410528182983
Epoch: 11, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
Validation loss decreased (-0.975413 --> -0.980845).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4898057
	speed: 0.2329s/iter; left time: 4237.3243s
	iters: 200, epoch: 12 | loss: 0.0002094
	speed: 0.0342s/iter; left time: 618.0956s
	iters: 300, epoch: 12 | loss: 0.0011681
	speed: 0.0357s/iter; left time: 642.5206s
	iters: 400, epoch: 12 | loss: 0.0001359
	speed: 0.0368s/iter; left time: 657.7058s
Epoch: 12 cost time: 16.94648814201355
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000018
	speed: 0.2339s/iter; left time: 4144.9978s
	iters: 200, epoch: 13 | loss: 0.0102713
	speed: 0.0363s/iter; left time: 639.0814s
	iters: 300, epoch: 13 | loss: 0.0000734
	speed: 0.0365s/iter; left time: 638.8034s
	iters: 400, epoch: 13 | loss: 0.0000078
	speed: 0.0362s/iter; left time: 631.2209s
Epoch: 13 cost time: 17.425889253616333
Epoch: 13, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0005436
	speed: 0.2273s/iter; left time: 3921.3554s
	iters: 200, epoch: 14 | loss: 0.0030130
	speed: 0.0331s/iter; left time: 568.1458s
	iters: 300, epoch: 14 | loss: 0.0014573
	speed: 0.0340s/iter; left time: 580.1100s
	iters: 400, epoch: 14 | loss: 0.0000212
	speed: 0.0359s/iter; left time: 608.4932s
Epoch: 14 cost time: 16.745644330978394
Epoch: 14, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.242 Vali Acc: 0.969 Test Loss: 0.242 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000246
	speed: 0.2264s/iter; left time: 3800.0870s
	iters: 200, epoch: 15 | loss: 0.0008046
	speed: 0.0379s/iter; left time: 631.7163s
	iters: 300, epoch: 15 | loss: 0.0000093
	speed: 0.0391s/iter; left time: 648.1180s
	iters: 400, epoch: 15 | loss: 0.0040581
	speed: 0.0371s/iter; left time: 610.9210s
Epoch: 15 cost time: 17.940014123916626
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000114
	speed: 0.2276s/iter; left time: 3714.2817s
	iters: 200, epoch: 16 | loss: 0.0032476
	speed: 0.0353s/iter; left time: 572.4730s
	iters: 300, epoch: 16 | loss: 0.0006455
	speed: 0.0335s/iter; left time: 540.5982s
	iters: 400, epoch: 16 | loss: 0.0026974
	speed: 0.0346s/iter; left time: 554.4690s
Epoch: 16 cost time: 16.733277082443237
Epoch: 16, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.254 Vali Acc: 0.968 Test Loss: 0.254 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0155214
	speed: 0.2322s/iter; left time: 3679.4063s
	iters: 200, epoch: 17 | loss: 0.0005137
	speed: 0.0355s/iter; left time: 558.2630s
	iters: 300, epoch: 17 | loss: 0.0001119
	speed: 0.0377s/iter; left time: 590.0280s
	iters: 400, epoch: 17 | loss: 0.0001076
	speed: 0.0377s/iter; left time: 585.8563s
Epoch: 17 cost time: 17.460281372070312
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000571
	speed: 0.2280s/iter; left time: 3505.6851s
	iters: 200, epoch: 18 | loss: 0.0001621
	speed: 0.0395s/iter; left time: 602.7873s
	iters: 300, epoch: 18 | loss: 0.0001398
	speed: 0.0371s/iter; left time: 563.1790s
	iters: 400, epoch: 18 | loss: 0.0001000
	speed: 0.0370s/iter; left time: 558.3343s
Epoch: 18 cost time: 17.82434105873108
Epoch: 18, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.977 Test Loss: 0.177 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0001592
	speed: 0.2275s/iter; left time: 3391.5040s
	iters: 200, epoch: 19 | loss: 0.1277975
	speed: 0.0363s/iter; left time: 536.8622s
	iters: 300, epoch: 19 | loss: 0.0039053
	speed: 0.0356s/iter; left time: 523.2525s
	iters: 400, epoch: 19 | loss: 0.0007568
	speed: 0.0359s/iter; left time: 524.7965s
Epoch: 19 cost time: 17.167097091674805
Epoch: 19, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.977 Test Loss: 0.189 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000119
	speed: 0.2296s/iter; left time: 3314.8010s
	iters: 200, epoch: 20 | loss: 0.0000027
	speed: 0.0361s/iter; left time: 517.1761s
	iters: 300, epoch: 20 | loss: 0.0000066
	speed: 0.0357s/iter; left time: 508.7271s
	iters: 400, epoch: 20 | loss: 0.0000154
	speed: 0.0364s/iter; left time: 514.6173s
Epoch: 20 cost time: 17.148969650268555
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.974 Test Loss: 0.194 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000136
	speed: 0.2311s/iter; left time: 3228.8342s
	iters: 200, epoch: 21 | loss: 0.0001899
	speed: 0.0370s/iter; left time: 513.6003s
	iters: 300, epoch: 21 | loss: 0.0006955
	speed: 0.0369s/iter; left time: 507.8120s
	iters: 400, epoch: 21 | loss: 0.0000990
	speed: 0.0348s/iter; left time: 475.5237s
Epoch: 21 cost time: 17.322322845458984
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.981 Test Loss: 0.169 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.981130).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000984
	speed: 0.2272s/iter; left time: 3067.0080s
	iters: 200, epoch: 22 | loss: 0.0000045
	speed: 0.0355s/iter; left time: 476.4122s
	iters: 300, epoch: 22 | loss: 0.0000561
	speed: 0.0358s/iter; left time: 475.8179s
	iters: 400, epoch: 22 | loss: 0.0219324
	speed: 0.0377s/iter; left time: 497.5470s
Epoch: 22 cost time: 17.482218742370605
Epoch: 22, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.282 Vali Acc: 0.974 Test Loss: 0.282 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000172
	speed: 0.2265s/iter; left time: 2951.6202s
	iters: 200, epoch: 23 | loss: 0.0000229
	speed: 0.0365s/iter; left time: 472.4567s
	iters: 300, epoch: 23 | loss: 0.0000580
	speed: 0.0383s/iter; left time: 492.0732s
	iters: 400, epoch: 23 | loss: 1.4147710
	speed: 0.0378s/iter; left time: 480.7042s
Epoch: 23 cost time: 17.699047565460205
Epoch: 23, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0008042
	speed: 0.2328s/iter; left time: 2925.3138s
	iters: 200, epoch: 24 | loss: 0.0000200
	speed: 0.0361s/iter; left time: 450.2498s
	iters: 300, epoch: 24 | loss: 0.0006661
	speed: 0.0343s/iter; left time: 423.7082s
	iters: 400, epoch: 24 | loss: 0.0002379
	speed: 0.0332s/iter; left time: 407.0617s
Epoch: 24 cost time: 16.699116945266724
Epoch: 24, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.979 Test Loss: 0.160 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000069
	speed: 0.2213s/iter; left time: 2676.0954s
	iters: 200, epoch: 25 | loss: 0.0000007
	speed: 0.0386s/iter; left time: 462.6815s
	iters: 300, epoch: 25 | loss: 0.0008831
	speed: 0.0372s/iter; left time: 442.9417s
	iters: 400, epoch: 25 | loss: 0.3307969
	speed: 0.0356s/iter; left time: 419.6585s
Epoch: 25 cost time: 17.750285625457764
Epoch: 25, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.971 Test Loss: 0.253 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0002662
	speed: 0.2316s/iter; left time: 2692.6230s
	iters: 200, epoch: 26 | loss: 0.2343117
	speed: 0.0362s/iter; left time: 416.8550s
	iters: 300, epoch: 26 | loss: 0.0000954
	speed: 0.0366s/iter; left time: 418.0671s
	iters: 400, epoch: 26 | loss: 0.0000743
	speed: 0.0367s/iter; left time: 415.5784s
Epoch: 26 cost time: 17.35975980758667
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0001010
	speed: 0.2265s/iter; left time: 2526.9470s
	iters: 200, epoch: 27 | loss: 0.0000036
	speed: 0.0316s/iter; left time: 349.6516s
	iters: 300, epoch: 27 | loss: 0.0004207
	speed: 0.0349s/iter; left time: 382.0189s
	iters: 400, epoch: 27 | loss: 0.0015883
	speed: 0.0361s/iter; left time: 392.3064s
Epoch: 27 cost time: 16.41941261291504
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.978 Test Loss: 0.174 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000006
	speed: 0.2348s/iter; left time: 2509.1894s
	iters: 200, epoch: 28 | loss: 0.0007417
	speed: 0.0386s/iter; left time: 408.6728s
	iters: 300, epoch: 28 | loss: 0.0000155
	speed: 0.0361s/iter; left time: 378.5191s
	iters: 400, epoch: 28 | loss: 0.0000503
	speed: 0.0349s/iter; left time: 362.9666s
Epoch: 28 cost time: 17.472410440444946
Epoch: 28, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.973 Test Loss: 0.204 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000242
	speed: 0.2284s/iter; left time: 2333.6725s
	iters: 200, epoch: 29 | loss: 0.0000040
	speed: 0.0362s/iter; left time: 366.5665s
	iters: 300, epoch: 29 | loss: 0.0009255
	speed: 0.0347s/iter; left time: 347.7032s
	iters: 400, epoch: 29 | loss: 0.1322266
	speed: 0.0344s/iter; left time: 341.3965s
Epoch: 29 cost time: 17.164572715759277
Epoch: 29, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000032
	speed: 0.2283s/iter; left time: 2225.7858s
	iters: 200, epoch: 30 | loss: 0.0112306
	speed: 0.0365s/iter; left time: 352.1423s
	iters: 300, epoch: 30 | loss: 0.0000363
	speed: 0.0382s/iter; left time: 364.6192s
	iters: 400, epoch: 30 | loss: 0.0000316
	speed: 0.0393s/iter; left time: 370.9830s
Epoch: 30 cost time: 17.807997941970825
Epoch: 30, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.980 Test Loss: 0.191 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0001305
	speed: 0.2289s/iter; left time: 2124.3323s
	iters: 200, epoch: 31 | loss: 0.0000345
	speed: 0.0364s/iter; left time: 334.0279s
	iters: 300, epoch: 31 | loss: 0.0004101
	speed: 0.0357s/iter; left time: 324.4001s
	iters: 400, epoch: 31 | loss: 0.0119138
	speed: 0.0359s/iter; left time: 322.0584s
Epoch: 31 cost time: 17.228749990463257
Epoch: 31, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.250 Vali Acc: 0.974 Test Loss: 0.250 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 94474
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5391117
	speed: 0.0554s/iter; left time: 1294.1908s
	iters: 200, epoch: 1 | loss: 0.2249071
	speed: 0.0367s/iter; left time: 852.2769s
	iters: 300, epoch: 1 | loss: 0.1956306
	speed: 0.0328s/iter; left time: 759.6886s
	iters: 400, epoch: 1 | loss: 0.1174893
	speed: 0.0326s/iter; left time: 751.6808s
Epoch: 1 cost time: 17.962568521499634
Epoch: 1, Steps: 469 | Train Loss: 0.457 Vali Loss: 0.215 Vali Acc: 0.947 Test Loss: 0.215 Test Acc: 0.947
Validation loss decreased (inf --> -0.946825).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1552635
	speed: 0.2298s/iter; left time: 5258.5546s
	iters: 200, epoch: 2 | loss: 0.0222762
	speed: 0.0364s/iter; left time: 829.0358s
	iters: 300, epoch: 2 | loss: 0.0589368
	speed: 0.0404s/iter; left time: 916.3121s
	iters: 400, epoch: 2 | loss: 0.1714135
	speed: 0.0398s/iter; left time: 899.2763s
Epoch: 2 cost time: 18.5847806930542
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.946825 --> -0.966551).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0028621
	speed: 0.2352s/iter; left time: 5272.5012s
	iters: 200, epoch: 3 | loss: 0.0644869
	speed: 0.0410s/iter; left time: 914.3108s
	iters: 300, epoch: 3 | loss: 0.0033389
	speed: 0.0378s/iter; left time: 840.2894s
	iters: 400, epoch: 3 | loss: 0.0178058
	speed: 0.0377s/iter; left time: 834.2673s
Epoch: 3 cost time: 18.639940977096558
Epoch: 3, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
Validation loss decreased (-0.966551 --> -0.971983).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0248262
	speed: 0.2377s/iter; left time: 5215.6839s
	iters: 200, epoch: 4 | loss: 0.0124049
	speed: 0.0347s/iter; left time: 757.6250s
	iters: 300, epoch: 4 | loss: 0.0300810
	speed: 0.0372s/iter; left time: 808.2447s
	iters: 400, epoch: 4 | loss: 0.0044247
	speed: 0.0395s/iter; left time: 854.1803s
Epoch: 4 cost time: 17.90573024749756
Epoch: 4, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0119335
	speed: 0.2450s/iter; left time: 5262.1782s
	iters: 200, epoch: 5 | loss: 0.0131273
	speed: 0.0420s/iter; left time: 896.8343s
	iters: 300, epoch: 5 | loss: 0.0169478
	speed: 0.0395s/iter; left time: 839.3152s
	iters: 400, epoch: 5 | loss: 0.0049908
	speed: 0.0383s/iter; left time: 812.0091s
Epoch: 5 cost time: 19.181551694869995
Epoch: 5, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0267730
	speed: 0.2477s/iter; left time: 5203.2404s
	iters: 200, epoch: 6 | loss: 0.0002961
	speed: 0.0390s/iter; left time: 815.0440s
	iters: 300, epoch: 6 | loss: 0.0761921
	speed: 0.0400s/iter; left time: 831.3101s
	iters: 400, epoch: 6 | loss: 0.0008857
	speed: 0.0385s/iter; left time: 797.9267s
Epoch: 6 cost time: 18.868412733078003
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0010169
	speed: 0.2450s/iter; left time: 5031.1858s
	iters: 200, epoch: 7 | loss: 0.0073821
	speed: 0.0401s/iter; left time: 820.1459s
	iters: 300, epoch: 7 | loss: 0.0008373
	speed: 0.0421s/iter; left time: 856.2014s
	iters: 400, epoch: 7 | loss: 1.3047173
	speed: 0.0400s/iter; left time: 809.2427s
Epoch: 7 cost time: 19.074904203414917
Epoch: 7, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.971983 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0124120
	speed: 0.2401s/iter; left time: 4818.2958s
	iters: 200, epoch: 8 | loss: 0.0025961
	speed: 0.0373s/iter; left time: 745.6166s
	iters: 300, epoch: 8 | loss: 0.1098182
	speed: 0.0368s/iter; left time: 731.7468s
	iters: 400, epoch: 8 | loss: 0.0630325
	speed: 0.0359s/iter; left time: 710.6373s
Epoch: 8 cost time: 18.4699649810791
Epoch: 8, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000713
	speed: 0.2350s/iter; left time: 4606.3508s
	iters: 200, epoch: 9 | loss: 0.0051941
	speed: 0.0368s/iter; left time: 718.3989s
	iters: 300, epoch: 9 | loss: 0.0006099
	speed: 0.0403s/iter; left time: 780.9031s
	iters: 400, epoch: 9 | loss: 0.0009168
	speed: 0.0403s/iter; left time: 778.3671s
Epoch: 9 cost time: 17.988930702209473
Epoch: 9, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0162627
	speed: 0.2293s/iter; left time: 4387.0612s
	iters: 200, epoch: 10 | loss: 0.0037404
	speed: 0.0324s/iter; left time: 615.7570s
	iters: 300, epoch: 10 | loss: 0.1111861
	speed: 0.0312s/iter; left time: 591.1784s
	iters: 400, epoch: 10 | loss: 0.0000058
	speed: 0.0342s/iter; left time: 644.3848s
Epoch: 10 cost time: 16.446823120117188
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0054974
	speed: 0.2378s/iter; left time: 4437.9768s
	iters: 200, epoch: 11 | loss: 0.0002391
	speed: 0.0395s/iter; left time: 733.4131s
	iters: 300, epoch: 11 | loss: 0.0137709
	speed: 0.0398s/iter; left time: 735.5102s
	iters: 400, epoch: 11 | loss: 0.0004126
	speed: 0.0371s/iter; left time: 680.5721s
Epoch: 11 cost time: 18.18455696105957
Epoch: 11, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000445
	speed: 0.2274s/iter; left time: 4137.2530s
	iters: 200, epoch: 12 | loss: 0.0001618
	speed: 0.0374s/iter; left time: 677.1589s
	iters: 300, epoch: 12 | loss: 0.0003805
	speed: 0.0354s/iter; left time: 636.1067s
	iters: 400, epoch: 12 | loss: 0.0003053
	speed: 0.0358s/iter; left time: 640.9094s
Epoch: 12 cost time: 17.56425404548645
Epoch: 12, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.979415).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0001289
	speed: 0.2278s/iter; left time: 4036.7662s
	iters: 200, epoch: 13 | loss: 0.0000439
	speed: 0.0365s/iter; left time: 642.5790s
	iters: 300, epoch: 13 | loss: 0.0000193
	speed: 0.0385s/iter; left time: 675.0057s
	iters: 400, epoch: 13 | loss: 0.0009718
	speed: 0.0404s/iter; left time: 704.7568s
Epoch: 13 cost time: 18.112010717391968
Epoch: 13, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000401
	speed: 0.2302s/iter; left time: 3971.9764s
	iters: 200, epoch: 14 | loss: 0.0008408
	speed: 0.0358s/iter; left time: 614.9204s
	iters: 300, epoch: 14 | loss: 0.0005712
	speed: 0.0372s/iter; left time: 634.7597s
	iters: 400, epoch: 14 | loss: 0.0007951
	speed: 0.0355s/iter; left time: 602.4057s
Epoch: 14 cost time: 17.526785850524902
Epoch: 14, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.973 Test Loss: 0.204 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0006038
	speed: 0.2325s/iter; left time: 3902.5273s
	iters: 200, epoch: 15 | loss: 0.0310241
	speed: 0.0344s/iter; left time: 574.7121s
	iters: 300, epoch: 15 | loss: 0.0029840
	speed: 0.0355s/iter; left time: 589.4597s
	iters: 400, epoch: 15 | loss: 0.1185804
	speed: 0.0355s/iter; left time: 585.1275s
Epoch: 15 cost time: 17.0343120098114
Epoch: 15, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0003285
	speed: 0.2365s/iter; left time: 3858.5828s
	iters: 200, epoch: 16 | loss: 0.0088159
	speed: 0.0412s/iter; left time: 668.0234s
	iters: 300, epoch: 16 | loss: 0.0019801
	speed: 0.0377s/iter; left time: 608.0706s
	iters: 400, epoch: 16 | loss: 0.0013720
	speed: 0.0361s/iter; left time: 578.5570s
Epoch: 16 cost time: 18.22453022003174
Epoch: 16, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000198
	speed: 0.2370s/iter; left time: 3755.5595s
	iters: 200, epoch: 17 | loss: 0.0000566
	speed: 0.0362s/iter; left time: 570.3460s
	iters: 300, epoch: 17 | loss: 0.0001132
	speed: 0.0363s/iter; left time: 568.3832s
	iters: 400, epoch: 17 | loss: 0.0000864
	speed: 0.0394s/iter; left time: 613.1151s
Epoch: 17 cost time: 18.30814266204834
Epoch: 17, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000004
	speed: 0.2340s/iter; left time: 3597.8625s
	iters: 200, epoch: 18 | loss: 0.0009983
	speed: 0.0391s/iter; left time: 597.4901s
	iters: 300, epoch: 18 | loss: 0.0010590
	speed: 0.0400s/iter; left time: 607.3843s
	iters: 400, epoch: 18 | loss: 0.0001723
	speed: 0.0378s/iter; left time: 569.4045s
Epoch: 18 cost time: 18.34478449821472
Epoch: 18, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.979415 --> -0.979987).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0002645
	speed: 0.2368s/iter; left time: 3530.2313s
	iters: 200, epoch: 19 | loss: 0.0013788
	speed: 0.0346s/iter; left time: 513.0880s
	iters: 300, epoch: 19 | loss: 0.0000015
	speed: 0.0359s/iter; left time: 528.2144s
	iters: 400, epoch: 19 | loss: 0.0152338
	speed: 0.0352s/iter; left time: 513.8493s
Epoch: 19 cost time: 17.30294108390808
Epoch: 19, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000156
	speed: 0.2359s/iter; left time: 3406.0743s
	iters: 200, epoch: 20 | loss: 0.0242964
	speed: 0.0401s/iter; left time: 575.4440s
	iters: 300, epoch: 20 | loss: 0.0000540
	speed: 0.0390s/iter; left time: 555.7232s
	iters: 400, epoch: 20 | loss: 0.0003240
	speed: 0.0380s/iter; left time: 537.6792s
Epoch: 20 cost time: 18.38108777999878
Epoch: 20, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0166927
	speed: 0.2428s/iter; left time: 3391.6529s
	iters: 200, epoch: 21 | loss: 0.0011199
	speed: 0.0386s/iter; left time: 535.3302s
	iters: 300, epoch: 21 | loss: 0.0000362
	speed: 0.0369s/iter; left time: 508.6900s
	iters: 400, epoch: 21 | loss: 0.0000292
	speed: 0.0346s/iter; left time: 472.9310s
Epoch: 21 cost time: 17.860583066940308
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
Validation loss decreased (-0.979987 --> -0.985133).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0015600
	speed: 0.2366s/iter; left time: 3194.1524s
	iters: 200, epoch: 22 | loss: 0.0000074
	speed: 0.0359s/iter; left time: 480.7429s
	iters: 300, epoch: 22 | loss: 0.0021181
	speed: 0.0378s/iter; left time: 502.2476s
	iters: 400, epoch: 22 | loss: 0.0002594
	speed: 0.0383s/iter; left time: 506.2073s
Epoch: 22 cost time: 18.04387903213501
Epoch: 22, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003352
	speed: 0.2299s/iter; left time: 2995.9146s
	iters: 200, epoch: 23 | loss: 0.0029815
	speed: 0.0364s/iter; left time: 470.1561s
	iters: 300, epoch: 23 | loss: 0.0013770
	speed: 0.0352s/iter; left time: 451.1879s
	iters: 400, epoch: 23 | loss: 0.0124014
	speed: 0.0376s/iter; left time: 478.7490s
Epoch: 23 cost time: 17.724045276641846
Epoch: 23, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000037
	speed: 0.2437s/iter; left time: 3062.2433s
	iters: 200, epoch: 24 | loss: 0.0013778
	speed: 0.0374s/iter; left time: 466.7513s
	iters: 300, epoch: 24 | loss: 0.0149703
	speed: 0.0376s/iter; left time: 465.1668s
	iters: 400, epoch: 24 | loss: 0.0000153
	speed: 0.0416s/iter; left time: 509.7728s
Epoch: 24 cost time: 18.68070888519287
Epoch: 24, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000245
	speed: 0.2512s/iter; left time: 3038.4081s
	iters: 200, epoch: 25 | loss: 0.0016278
	speed: 0.0397s/iter; left time: 476.7003s
	iters: 300, epoch: 25 | loss: 0.0128230
	speed: 0.0333s/iter; left time: 396.2826s
	iters: 400, epoch: 25 | loss: 0.0136930
	speed: 0.0327s/iter; left time: 385.9092s
Epoch: 25 cost time: 17.398942232131958
Epoch: 25, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0020008
	speed: 0.2559s/iter; left time: 2975.6431s
	iters: 200, epoch: 26 | loss: 0.1747487
	speed: 0.0392s/iter; left time: 452.2495s
	iters: 300, epoch: 26 | loss: 0.0000953
	speed: 0.0393s/iter; left time: 449.4550s
	iters: 400, epoch: 26 | loss: 0.0000090
	speed: 0.0404s/iter; left time: 457.9929s
Epoch: 26 cost time: 19.026426792144775
Epoch: 26, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.984 Test Loss: 0.131 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000028
	speed: 0.2527s/iter; left time: 2819.5777s
	iters: 200, epoch: 27 | loss: 0.0124158
	speed: 0.0368s/iter; left time: 407.0909s
	iters: 300, epoch: 27 | loss: 0.0000048
	speed: 0.0360s/iter; left time: 394.0804s
	iters: 400, epoch: 27 | loss: 0.0000101
	speed: 0.0381s/iter; left time: 414.1513s
Epoch: 27 cost time: 17.951035261154175
Epoch: 27, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.152 Vali Acc: 0.978 Test Loss: 0.152 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0012676
	speed: 0.2557s/iter; left time: 2732.8617s
	iters: 200, epoch: 28 | loss: 0.0000122
	speed: 0.0371s/iter; left time: 393.1237s
	iters: 300, epoch: 28 | loss: 0.0003010
	speed: 0.0354s/iter; left time: 371.1337s
	iters: 400, epoch: 28 | loss: 0.0000062
	speed: 0.0344s/iter; left time: 357.5620s
Epoch: 28 cost time: 17.495573043823242
Epoch: 28, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.165 Vali Acc: 0.976 Test Loss: 0.165 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0029188
	speed: 0.2599s/iter; left time: 2655.5783s
	iters: 200, epoch: 29 | loss: 0.0000345
	speed: 0.0382s/iter; left time: 386.6476s
	iters: 300, epoch: 29 | loss: 0.0000523
	speed: 0.0386s/iter; left time: 386.8289s
	iters: 400, epoch: 29 | loss: 0.0030662
	speed: 0.0399s/iter; left time: 395.8842s
Epoch: 29 cost time: 18.957707166671753
Epoch: 29, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.978 Test Loss: 0.197 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0005197
	speed: 0.2586s/iter; left time: 2521.3200s
	iters: 200, epoch: 30 | loss: 0.0003280
	speed: 0.0393s/iter; left time: 379.3022s
	iters: 300, epoch: 30 | loss: 0.0000101
	speed: 0.0414s/iter; left time: 395.0868s
	iters: 400, epoch: 30 | loss: 0.0002234
	speed: 0.0406s/iter; left time: 383.7960s
Epoch: 30 cost time: 19.322308778762817
Epoch: 30, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000002
	speed: 0.2482s/iter; left time: 2303.4748s
	iters: 200, epoch: 31 | loss: 0.0001182
	speed: 0.0398s/iter; left time: 365.6805s
	iters: 300, epoch: 31 | loss: 0.0030976
	speed: 0.0414s/iter; left time: 376.3570s
	iters: 400, epoch: 31 | loss: 0.0000051
	speed: 0.0410s/iter; left time: 368.2962s
Epoch: 31 cost time: 19.277071475982666
Epoch: 31, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.985134362492853
model parameter : 94602
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1092138
	speed: 0.0557s/iter; left time: 1299.7516s
	iters: 200, epoch: 1 | loss: 0.4533119
	speed: 0.0411s/iter; left time: 956.0499s
	iters: 300, epoch: 1 | loss: 0.2872823
	speed: 0.0408s/iter; left time: 944.2912s
	iters: 400, epoch: 1 | loss: 0.1581121
	speed: 0.0385s/iter; left time: 888.3794s
Epoch: 1 cost time: 20.30488109588623
Epoch: 1, Steps: 469 | Train Loss: 0.656 Vali Loss: 0.335 Vali Acc: 0.899 Test Loss: 0.335 Test Acc: 0.899
Validation loss decreased (inf --> -0.898796).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1541317
	speed: 0.2376s/iter; left time: 5436.5586s
	iters: 200, epoch: 2 | loss: 0.0561405
	speed: 0.0395s/iter; left time: 899.5235s
	iters: 300, epoch: 2 | loss: 0.0298642
	speed: 0.0404s/iter; left time: 915.2648s
	iters: 400, epoch: 2 | loss: 0.1912673
	speed: 0.0345s/iter; left time: 778.1898s
Epoch: 2 cost time: 18.180806398391724
Epoch: 2, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.187 Vali Acc: 0.958 Test Loss: 0.187 Test Acc: 0.958
Validation loss decreased (-0.898796 --> -0.958260).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0109881
	speed: 0.2431s/iter; left time: 5448.1408s
	iters: 200, epoch: 3 | loss: 0.0149323
	speed: 0.0411s/iter; left time: 916.3965s
	iters: 300, epoch: 3 | loss: 0.0553947
	speed: 0.0380s/iter; left time: 843.5619s
	iters: 400, epoch: 3 | loss: 0.0121451
	speed: 0.0346s/iter; left time: 764.5144s
Epoch: 3 cost time: 18.113250732421875
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
Validation loss decreased (-0.958260 --> -0.963120).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0032050
	speed: 0.2418s/iter; left time: 5305.9999s
	iters: 200, epoch: 4 | loss: 0.0067523
	speed: 0.0396s/iter; left time: 865.4452s
	iters: 300, epoch: 4 | loss: 0.0049075
	speed: 0.0392s/iter; left time: 853.2291s
	iters: 400, epoch: 4 | loss: 0.0096047
	speed: 0.0390s/iter; left time: 845.0717s
Epoch: 4 cost time: 18.767309427261353
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0048121
	speed: 0.2365s/iter; left time: 5079.2122s
	iters: 200, epoch: 5 | loss: 0.1408188
	speed: 0.0405s/iter; left time: 865.3786s
	iters: 300, epoch: 5 | loss: 0.0050491
	speed: 0.0414s/iter; left time: 880.5124s
	iters: 400, epoch: 5 | loss: 0.0005066
	speed: 0.0412s/iter; left time: 872.6121s
Epoch: 5 cost time: 19.318535566329956
Epoch: 5, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
Validation loss decreased (-0.963120 --> -0.971411).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0179813
	speed: 0.2424s/iter; left time: 5090.9533s
	iters: 200, epoch: 6 | loss: 0.0159399
	speed: 0.0399s/iter; left time: 833.1675s
	iters: 300, epoch: 6 | loss: 0.0008231
	speed: 0.0412s/iter; left time: 857.7021s
	iters: 400, epoch: 6 | loss: 0.0120642
	speed: 0.0407s/iter; left time: 843.2542s
Epoch: 6 cost time: 19.068003177642822
Epoch: 6, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0400511
	speed: 0.2476s/iter; left time: 5084.1497s
	iters: 200, epoch: 7 | loss: 0.0014696
	speed: 0.0405s/iter; left time: 827.5726s
	iters: 300, epoch: 7 | loss: 0.0053322
	speed: 0.0395s/iter; left time: 804.1846s
	iters: 400, epoch: 7 | loss: 0.0058393
	speed: 0.0362s/iter; left time: 731.8441s
Epoch: 7 cost time: 18.50172472000122
Epoch: 7, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0114037
	speed: 0.2379s/iter; left time: 4773.8632s
	iters: 200, epoch: 8 | loss: 0.0033162
	speed: 0.0391s/iter; left time: 781.2114s
	iters: 300, epoch: 8 | loss: 0.0177160
	speed: 0.0390s/iter; left time: 775.7467s
	iters: 400, epoch: 8 | loss: 0.0005505
	speed: 0.0389s/iter; left time: 769.2075s
Epoch: 8 cost time: 18.72743797302246
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0063020
	speed: 0.2369s/iter; left time: 4642.1380s
	iters: 200, epoch: 9 | loss: 0.0003478
	speed: 0.0395s/iter; left time: 769.6703s
	iters: 300, epoch: 9 | loss: 0.0953817
	speed: 0.0393s/iter; left time: 762.3831s
	iters: 400, epoch: 9 | loss: 0.0148156
	speed: 0.0392s/iter; left time: 756.7243s
Epoch: 9 cost time: 18.616045236587524
Epoch: 9, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971983).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0068210
	speed: 0.2333s/iter; left time: 4463.7409s
	iters: 200, epoch: 10 | loss: 0.0412785
	speed: 0.0393s/iter; left time: 746.9665s
	iters: 300, epoch: 10 | loss: 0.1365003
	speed: 0.0400s/iter; left time: 756.9210s
	iters: 400, epoch: 10 | loss: 0.0006839
	speed: 0.0390s/iter; left time: 734.8897s
Epoch: 10 cost time: 18.58547353744507
Epoch: 10, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.971983 --> -0.975127).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0054782
	speed: 0.2374s/iter; left time: 4429.7166s
	iters: 200, epoch: 11 | loss: 0.0018431
	speed: 0.0366s/iter; left time: 678.6010s
	iters: 300, epoch: 11 | loss: 0.0132310
	speed: 0.0352s/iter; left time: 650.5616s
	iters: 400, epoch: 11 | loss: 0.0050698
	speed: 0.0374s/iter; left time: 687.2528s
Epoch: 11 cost time: 17.487732410430908
Epoch: 11, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0011855
	speed: 0.2377s/iter; left time: 4324.8587s
	iters: 200, epoch: 12 | loss: 0.0920640
	speed: 0.0390s/iter; left time: 705.4519s
	iters: 300, epoch: 12 | loss: 0.0007995
	speed: 0.0408s/iter; left time: 734.5150s
	iters: 400, epoch: 12 | loss: 0.0003352
	speed: 0.0405s/iter; left time: 724.8374s
Epoch: 12 cost time: 19.001246690750122
Epoch: 12, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0066840
	speed: 0.2347s/iter; left time: 4159.9369s
	iters: 200, epoch: 13 | loss: 0.0216161
	speed: 0.0403s/iter; left time: 710.2171s
	iters: 300, epoch: 13 | loss: 0.0005632
	speed: 0.0406s/iter; left time: 711.3209s
	iters: 400, epoch: 13 | loss: 0.0000173
	speed: 0.0385s/iter; left time: 671.1989s
Epoch: 13 cost time: 18.911654233932495
Epoch: 13, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0045723
	speed: 0.2383s/iter; left time: 4112.2832s
	iters: 200, epoch: 14 | loss: 0.0009959
	speed: 0.0383s/iter; left time: 656.4830s
	iters: 300, epoch: 14 | loss: 0.1421094
	speed: 0.0392s/iter; left time: 668.2204s
	iters: 400, epoch: 14 | loss: 0.0020245
	speed: 0.0391s/iter; left time: 663.2370s
Epoch: 14 cost time: 18.251095056533813
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0011627
	speed: 0.2308s/iter; left time: 3874.4740s
	iters: 200, epoch: 15 | loss: 0.0354359
	speed: 0.0366s/iter; left time: 610.5349s
	iters: 300, epoch: 15 | loss: 0.0079270
	speed: 0.0375s/iter; left time: 622.7084s
	iters: 400, epoch: 15 | loss: 0.0170633
	speed: 0.0391s/iter; left time: 644.8195s
Epoch: 15 cost time: 17.85440492630005
Epoch: 15, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0008378
	speed: 0.2368s/iter; left time: 3863.5027s
	iters: 200, epoch: 16 | loss: 0.0008805
	speed: 0.0409s/iter; left time: 662.8985s
	iters: 300, epoch: 16 | loss: 0.0000788
	speed: 0.0407s/iter; left time: 655.9818s
	iters: 400, epoch: 16 | loss: 0.0000451
	speed: 0.0411s/iter; left time: 658.3736s
Epoch: 16 cost time: 19.027843952178955
Epoch: 16, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0237365
	speed: 0.2305s/iter; left time: 3653.3659s
	iters: 200, epoch: 17 | loss: 0.0016522
	speed: 0.0407s/iter; left time: 641.4957s
	iters: 300, epoch: 17 | loss: 0.0005277
	speed: 0.0393s/iter; left time: 615.5324s
	iters: 400, epoch: 17 | loss: 0.0023792
	speed: 0.0392s/iter; left time: 609.9881s
Epoch: 17 cost time: 18.671755075454712
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
Validation loss decreased (-0.975127 --> -0.982560).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000365
	speed: 0.2319s/iter; left time: 3566.6296s
	iters: 200, epoch: 18 | loss: 0.0008662
	speed: 0.0368s/iter; left time: 561.8929s
	iters: 300, epoch: 18 | loss: 0.0002037
	speed: 0.0377s/iter; left time: 572.5327s
	iters: 400, epoch: 18 | loss: 0.0006803
	speed: 0.0381s/iter; left time: 574.0066s
Epoch: 18 cost time: 17.696941137313843
Epoch: 18, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.976 Test Loss: 0.159 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0001301
	speed: 0.2358s/iter; left time: 3514.9823s
	iters: 200, epoch: 19 | loss: 0.0001205
	speed: 0.0388s/iter; left time: 574.6698s
	iters: 300, epoch: 19 | loss: 0.0000260
	speed: 0.0392s/iter; left time: 576.9708s
	iters: 400, epoch: 19 | loss: 0.0032944
	speed: 0.0391s/iter; left time: 571.5630s
Epoch: 19 cost time: 18.33981943130493
Epoch: 19, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0002729
	speed: 0.2343s/iter; left time: 3383.4273s
	iters: 200, epoch: 20 | loss: 0.0017007
	speed: 0.0391s/iter; left time: 560.2296s
	iters: 300, epoch: 20 | loss: 0.0157047
	speed: 0.0397s/iter; left time: 565.3266s
	iters: 400, epoch: 20 | loss: 0.0752991
	speed: 0.0396s/iter; left time: 560.0185s
Epoch: 20 cost time: 18.648467540740967
Epoch: 20, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.976 Test Loss: 0.161 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000256
	speed: 0.2339s/iter; left time: 3267.6611s
	iters: 200, epoch: 21 | loss: 0.0092288
	speed: 0.0363s/iter; left time: 503.3064s
	iters: 300, epoch: 21 | loss: 0.0003568
	speed: 0.0396s/iter; left time: 545.3932s
	iters: 400, epoch: 21 | loss: 0.0001183
	speed: 0.0400s/iter; left time: 546.9809s
Epoch: 21 cost time: 18.347704648971558
Epoch: 21, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0008653
	speed: 0.2364s/iter; left time: 3192.3506s
	iters: 200, epoch: 22 | loss: 0.0001682
	speed: 0.0356s/iter; left time: 476.7604s
	iters: 300, epoch: 22 | loss: 0.0655319
	speed: 0.0412s/iter; left time: 547.6917s
	iters: 400, epoch: 22 | loss: 0.0008617
	speed: 0.0404s/iter; left time: 533.4055s
Epoch: 22 cost time: 18.039315938949585
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.968 Test Loss: 0.196 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0015496
	speed: 0.2373s/iter; left time: 3092.4434s
	iters: 200, epoch: 23 | loss: 0.0000994
	speed: 0.0361s/iter; left time: 466.7379s
	iters: 300, epoch: 23 | loss: 0.0005884
	speed: 0.0386s/iter; left time: 495.5917s
	iters: 400, epoch: 23 | loss: 0.0000257
	speed: 0.0373s/iter; left time: 475.4121s
Epoch: 23 cost time: 17.872942209243774
Epoch: 23, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.973 Test Loss: 0.199 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0001180
	speed: 0.2405s/iter; left time: 3022.2406s
	iters: 200, epoch: 24 | loss: 0.0016635
	speed: 0.0358s/iter; left time: 446.7578s
	iters: 300, epoch: 24 | loss: 0.0000464
	speed: 0.0385s/iter; left time: 475.8664s
	iters: 400, epoch: 24 | loss: 0.0399606
	speed: 0.0396s/iter; left time: 485.1358s
Epoch: 24 cost time: 18.01852798461914
Epoch: 24, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.971 Test Loss: 0.219 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0005718
	speed: 0.2285s/iter; left time: 2763.4836s
	iters: 200, epoch: 25 | loss: 0.0017242
	speed: 0.0374s/iter; left time: 448.7665s
	iters: 300, epoch: 25 | loss: 0.0003680
	speed: 0.0373s/iter; left time: 444.0588s
	iters: 400, epoch: 25 | loss: 0.0002413
	speed: 0.0369s/iter; left time: 435.2214s
Epoch: 25 cost time: 17.43811559677124
Epoch: 25, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0003999
	speed: 0.2139s/iter; left time: 2486.3211s
	iters: 200, epoch: 26 | loss: 0.0010098
	speed: 0.0377s/iter; left time: 434.6482s
	iters: 300, epoch: 26 | loss: 0.0101549
	speed: 0.0381s/iter; left time: 435.1623s
	iters: 400, epoch: 26 | loss: 0.0000910
	speed: 0.0363s/iter; left time: 410.6207s
Epoch: 26 cost time: 17.896417140960693
Epoch: 26, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.978 Test Loss: 0.176 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0028109
	speed: 0.2383s/iter; left time: 2659.2649s
	iters: 200, epoch: 27 | loss: 0.0047395
	speed: 0.0388s/iter; left time: 428.7278s
	iters: 300, epoch: 27 | loss: 0.0313280
	speed: 0.0371s/iter; left time: 406.2010s
	iters: 400, epoch: 27 | loss: 0.0198440
	speed: 0.0349s/iter; left time: 378.8341s
Epoch: 27 cost time: 17.760241985321045
Epoch: 27, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 30858
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9431642
	speed: 0.0500s/iter; left time: 1167.0815s
	iters: 200, epoch: 1 | loss: 0.3671653
	speed: 0.0339s/iter; left time: 788.3252s
	iters: 300, epoch: 1 | loss: 0.1665591
	speed: 0.0312s/iter; left time: 722.8114s
	iters: 400, epoch: 1 | loss: 0.1030880
	speed: 0.0356s/iter; left time: 820.1209s
Epoch: 1 cost time: 17.79217290878296
Epoch: 1, Steps: 469 | Train Loss: 0.662 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (inf --> -0.917093).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1048297
	speed: 0.2316s/iter; left time: 5300.1419s
	iters: 200, epoch: 2 | loss: 0.1412993
	speed: 0.0356s/iter; left time: 811.9283s
	iters: 300, epoch: 2 | loss: 0.0186299
	speed: 0.0362s/iter; left time: 821.4486s
	iters: 400, epoch: 2 | loss: 0.0122804
	speed: 0.0343s/iter; left time: 773.9310s
Epoch: 2 cost time: 16.82801651954651
Epoch: 2, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.917093 --> -0.958546).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0591041
	speed: 0.2322s/iter; left time: 5205.0084s
	iters: 200, epoch: 3 | loss: 0.0144893
	speed: 0.0351s/iter; left time: 783.9333s
	iters: 300, epoch: 3 | loss: 0.0396629
	speed: 0.0353s/iter; left time: 784.8287s
	iters: 400, epoch: 3 | loss: 0.0148364
	speed: 0.0347s/iter; left time: 768.3778s
Epoch: 3 cost time: 17.097692728042603
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.958546 --> -0.963692).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0088076
	speed: 0.2324s/iter; left time: 5099.9828s
	iters: 200, epoch: 4 | loss: 0.0329499
	speed: 0.0343s/iter; left time: 749.7292s
	iters: 300, epoch: 4 | loss: 0.0107242
	speed: 0.0347s/iter; left time: 755.2132s
	iters: 400, epoch: 4 | loss: 0.0048668
	speed: 0.0359s/iter; left time: 776.1553s
Epoch: 4 cost time: 16.99952006340027
Epoch: 4, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
Validation loss decreased (-0.963692 --> -0.973698).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0016419
	speed: 0.2388s/iter; left time: 5127.1782s
	iters: 200, epoch: 5 | loss: 0.0482107
	speed: 0.0338s/iter; left time: 721.8098s
	iters: 300, epoch: 5 | loss: 0.0024689
	speed: 0.0348s/iter; left time: 740.9457s
	iters: 400, epoch: 5 | loss: 0.0012665
	speed: 0.0351s/iter; left time: 742.2930s
Epoch: 5 cost time: 16.642061233520508
Epoch: 5, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.3532158
	speed: 0.2371s/iter; left time: 4979.6151s
	iters: 200, epoch: 6 | loss: 0.0438805
	speed: 0.0329s/iter; left time: 687.5179s
	iters: 300, epoch: 6 | loss: 0.0014654
	speed: 0.0333s/iter; left time: 693.4770s
	iters: 400, epoch: 6 | loss: 0.0009429
	speed: 0.0317s/iter; left time: 656.1262s
Epoch: 6 cost time: 15.953211307525635
Epoch: 6, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0033587
	speed: 0.2309s/iter; left time: 4742.3467s
	iters: 200, epoch: 7 | loss: 0.0295944
	speed: 0.0336s/iter; left time: 686.9176s
	iters: 300, epoch: 7 | loss: 0.0221949
	speed: 0.0349s/iter; left time: 709.1493s
	iters: 400, epoch: 7 | loss: 0.0086812
	speed: 0.0358s/iter; left time: 724.7866s
Epoch: 7 cost time: 16.75057339668274
Epoch: 7, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0137547
	speed: 0.2318s/iter; left time: 4652.6685s
	iters: 200, epoch: 8 | loss: 0.0011682
	speed: 0.0358s/iter; left time: 714.8729s
	iters: 300, epoch: 8 | loss: 0.0016722
	speed: 0.0355s/iter; left time: 706.1279s
	iters: 400, epoch: 8 | loss: 0.0004255
	speed: 0.0356s/iter; left time: 703.4878s
Epoch: 8 cost time: 16.8576819896698
Epoch: 8, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
Validation loss decreased (-0.973698 --> -0.978272).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0156559
	speed: 0.2388s/iter; left time: 4681.0662s
	iters: 200, epoch: 9 | loss: 0.0205688
	speed: 0.0336s/iter; left time: 654.2401s
	iters: 300, epoch: 9 | loss: 0.0029556
	speed: 0.0328s/iter; left time: 636.4603s
	iters: 400, epoch: 9 | loss: 0.0612264
	speed: 0.0331s/iter; left time: 639.7102s
Epoch: 9 cost time: 16.20362663269043
Epoch: 9, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0003692
	speed: 0.2264s/iter; left time: 4330.7215s
	iters: 200, epoch: 10 | loss: 0.0027828
	speed: 0.0352s/iter; left time: 669.2614s
	iters: 300, epoch: 10 | loss: 0.0026545
	speed: 0.0353s/iter; left time: 667.7405s
	iters: 400, epoch: 10 | loss: 0.0030839
	speed: 0.0350s/iter; left time: 659.1426s
Epoch: 10 cost time: 16.667537212371826
Epoch: 10, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0012500
	speed: 0.2294s/iter; left time: 4280.9947s
	iters: 200, epoch: 11 | loss: 0.0009722
	speed: 0.0361s/iter; left time: 669.1814s
	iters: 300, epoch: 11 | loss: 0.0005475
	speed: 0.0347s/iter; left time: 639.6970s
	iters: 400, epoch: 11 | loss: 0.0111657
	speed: 0.0336s/iter; left time: 617.0300s
Epoch: 11 cost time: 16.414543390274048
Epoch: 11, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0007105
	speed: 0.2297s/iter; left time: 4177.9361s
	iters: 200, epoch: 12 | loss: 0.0029856
	speed: 0.0349s/iter; left time: 631.9624s
	iters: 300, epoch: 12 | loss: 0.0004130
	speed: 0.0342s/iter; left time: 614.7746s
	iters: 400, epoch: 12 | loss: 0.1173882
	speed: 0.0354s/iter; left time: 633.6014s
Epoch: 12 cost time: 16.58088755607605
Epoch: 12, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0006496
	speed: 0.2325s/iter; left time: 4120.1519s
	iters: 200, epoch: 13 | loss: 0.0030729
	speed: 0.0333s/iter; left time: 586.8207s
	iters: 300, epoch: 13 | loss: 0.0019441
	speed: 0.0336s/iter; left time: 588.8801s
	iters: 400, epoch: 13 | loss: 0.0020731
	speed: 0.0347s/iter; left time: 604.5984s
Epoch: 13 cost time: 16.20684289932251
Epoch: 13, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0026730
	speed: 0.2330s/iter; left time: 4019.6911s
	iters: 200, epoch: 14 | loss: 0.0076040
	speed: 0.0369s/iter; left time: 632.6503s
	iters: 300, epoch: 14 | loss: 0.0535172
	speed: 0.0354s/iter; left time: 604.2397s
	iters: 400, epoch: 14 | loss: 0.0137542
	speed: 0.0347s/iter; left time: 587.7945s
Epoch: 14 cost time: 17.079150438308716
Epoch: 14, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0011005
	speed: 0.2368s/iter; left time: 3975.5059s
	iters: 200, epoch: 15 | loss: 0.0001869
	speed: 0.0358s/iter; left time: 596.6384s
	iters: 300, epoch: 15 | loss: 0.0005181
	speed: 0.0357s/iter; left time: 591.8226s
	iters: 400, epoch: 15 | loss: 0.0004423
	speed: 0.0374s/iter; left time: 616.2422s
Epoch: 15 cost time: 17.356789588928223
Epoch: 15, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0019197
	speed: 0.2400s/iter; left time: 3915.9749s
	iters: 200, epoch: 16 | loss: 0.0034745
	speed: 0.0366s/iter; left time: 592.7442s
	iters: 300, epoch: 16 | loss: 0.0012092
	speed: 0.0367s/iter; left time: 590.7032s
	iters: 400, epoch: 16 | loss: 0.0076151
	speed: 0.0364s/iter; left time: 582.4920s
Epoch: 16 cost time: 17.249112606048584
Epoch: 16, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.979 Test Loss: 0.142 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0003624
	speed: 0.2418s/iter; left time: 3832.4257s
	iters: 200, epoch: 17 | loss: 0.0007307
	speed: 0.0313s/iter; left time: 492.6102s
	iters: 300, epoch: 17 | loss: 0.0012782
	speed: 0.0316s/iter; left time: 494.8540s
	iters: 400, epoch: 17 | loss: 0.0296815
	speed: 0.0316s/iter; left time: 491.6968s
Epoch: 17 cost time: 15.565903425216675
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0005615
	speed: 0.2225s/iter; left time: 3421.3423s
	iters: 200, epoch: 18 | loss: 0.0002953
	speed: 0.0315s/iter; left time: 480.7731s
	iters: 300, epoch: 18 | loss: 0.0014367
	speed: 0.0380s/iter; left time: 576.5056s
	iters: 400, epoch: 18 | loss: 0.0000789
	speed: 0.0385s/iter; left time: 580.0931s
Epoch: 18 cost time: 16.824290990829468
Epoch: 18, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0191601
	speed: 0.2359s/iter; left time: 3516.5739s
	iters: 200, epoch: 19 | loss: 0.0002046
	speed: 0.0370s/iter; left time: 548.6518s
	iters: 300, epoch: 19 | loss: 0.0001815
	speed: 0.0396s/iter; left time: 581.8305s
	iters: 400, epoch: 19 | loss: 0.0884471
	speed: 0.0392s/iter; left time: 573.1414s
Epoch: 19 cost time: 18.19589400291443
Epoch: 19, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003487
	speed: 0.2336s/iter; left time: 3372.9639s
	iters: 200, epoch: 20 | loss: 0.0014141
	speed: 0.0360s/iter; left time: 515.6819s
	iters: 300, epoch: 20 | loss: 0.0012527
	speed: 0.0387s/iter; left time: 551.0533s
	iters: 400, epoch: 20 | loss: 0.0001441
	speed: 0.0387s/iter; left time: 547.1658s
Epoch: 20 cost time: 18.10192084312439
Epoch: 20, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.977 Test Loss: 0.177 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0102465
	speed: 0.2302s/iter; left time: 3216.1943s
	iters: 200, epoch: 21 | loss: 0.0282443
	speed: 0.0351s/iter; left time: 486.2446s
	iters: 300, epoch: 21 | loss: 0.0004273
	speed: 0.0388s/iter; left time: 533.8926s
	iters: 400, epoch: 21 | loss: 0.0001513
	speed: 0.0412s/iter; left time: 563.3268s
Epoch: 21 cost time: 18.294829607009888
Epoch: 21, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000195
	speed: 0.2497s/iter; left time: 3371.2274s
	iters: 200, epoch: 22 | loss: 0.0001905
	speed: 0.0379s/iter; left time: 508.1712s
	iters: 300, epoch: 22 | loss: 0.0040760
	speed: 0.0403s/iter; left time: 535.6454s
	iters: 400, epoch: 22 | loss: 0.0034925
	speed: 0.0386s/iter; left time: 510.0354s
Epoch: 22 cost time: 18.528151750564575
Epoch: 22, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0026192
	speed: 0.2368s/iter; left time: 3085.6510s
	iters: 200, epoch: 23 | loss: 0.0007462
	speed: 0.0374s/iter; left time: 484.1222s
	iters: 300, epoch: 23 | loss: 0.0000896
	speed: 0.0393s/iter; left time: 504.6824s
	iters: 400, epoch: 23 | loss: 0.0000460
	speed: 0.0407s/iter; left time: 518.2742s
Epoch: 23 cost time: 18.5035400390625
Epoch: 23, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.979 Test Loss: 0.197 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000350
	speed: 0.2331s/iter; left time: 2928.9956s
	iters: 200, epoch: 24 | loss: 0.0031695
	speed: 0.0389s/iter; left time: 484.3472s
	iters: 300, epoch: 24 | loss: 0.0001571
	speed: 0.0413s/iter; left time: 510.7220s
	iters: 400, epoch: 24 | loss: 0.0267581
	speed: 0.0407s/iter; left time: 499.1434s
Epoch: 24 cost time: 18.953534841537476
Epoch: 24, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.970 Test Loss: 0.221 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000825
	speed: 0.2447s/iter; left time: 2960.2354s
	iters: 200, epoch: 25 | loss: 0.0039518
	speed: 0.0355s/iter; left time: 426.3247s
	iters: 300, epoch: 25 | loss: 0.0001694
	speed: 0.0381s/iter; left time: 453.6444s
	iters: 400, epoch: 25 | loss: 0.0010705
	speed: 0.0401s/iter; left time: 472.7915s
Epoch: 25 cost time: 18.11326026916504
Epoch: 25, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0002394
	speed: 0.2477s/iter; left time: 2879.5249s
	iters: 200, epoch: 26 | loss: 0.0000102
	speed: 0.0385s/iter; left time: 443.9387s
	iters: 300, epoch: 26 | loss: 0.0000564
	speed: 0.0393s/iter; left time: 448.9898s
	iters: 400, epoch: 26 | loss: 0.0028985
	speed: 0.0391s/iter; left time: 442.9193s
Epoch: 26 cost time: 18.48546266555786
Epoch: 26, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.979 Test Loss: 0.205 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979129).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0001721
	speed: 0.2394s/iter; left time: 2670.9037s
	iters: 200, epoch: 27 | loss: 0.0000276
	speed: 0.0363s/iter; left time: 401.3984s
	iters: 300, epoch: 27 | loss: 0.0000799
	speed: 0.0376s/iter; left time: 411.9997s
	iters: 400, epoch: 27 | loss: 0.0000654
	speed: 0.0389s/iter; left time: 422.0040s
Epoch: 27 cost time: 17.879289150238037
Epoch: 27, Steps: 469 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0001178
	speed: 0.2410s/iter; left time: 2575.3152s
	iters: 200, epoch: 28 | loss: 0.0014271
	speed: 0.0384s/iter; left time: 407.0392s
	iters: 300, epoch: 28 | loss: 0.0001951
	speed: 0.0398s/iter; left time: 417.6567s
	iters: 400, epoch: 28 | loss: 0.0000032
	speed: 0.0401s/iter; left time: 416.8485s
Epoch: 28 cost time: 18.75466537475586
Epoch: 28, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000087
	speed: 0.2394s/iter; left time: 2446.5555s
	iters: 200, epoch: 29 | loss: 0.0002148
	speed: 0.0373s/iter; left time: 377.1540s
	iters: 300, epoch: 29 | loss: 0.0000312
	speed: 0.0402s/iter; left time: 403.0443s
	iters: 400, epoch: 29 | loss: 0.0129701
	speed: 0.0409s/iter; left time: 405.1981s
Epoch: 29 cost time: 18.579564571380615
Epoch: 29, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0001802
	speed: 0.2438s/iter; left time: 2377.1625s
	iters: 200, epoch: 30 | loss: 0.0000246
	speed: 0.0400s/iter; left time: 385.6603s
	iters: 300, epoch: 30 | loss: 0.0000014
	speed: 0.0386s/iter; left time: 368.1913s
	iters: 400, epoch: 30 | loss: 0.0000325
	speed: 0.0376s/iter; left time: 355.1359s
Epoch: 30 cost time: 18.44346857070923
Epoch: 30, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000133
	speed: 0.2394s/iter; left time: 2222.0921s
	iters: 200, epoch: 31 | loss: 0.0000779
	speed: 0.0370s/iter; left time: 339.4430s
	iters: 300, epoch: 31 | loss: 0.0000209
	speed: 0.0367s/iter; left time: 333.5056s
	iters: 400, epoch: 31 | loss: 0.0636075
	speed: 0.0375s/iter; left time: 336.7801s
Epoch: 31 cost time: 17.85846734046936
Epoch: 31, Steps: 469 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0009881
	speed: 0.2376s/iter; left time: 2093.6153s
	iters: 200, epoch: 32 | loss: 0.0000051
	speed: 0.0405s/iter; left time: 353.0810s
	iters: 300, epoch: 32 | loss: 0.0000359
	speed: 0.0411s/iter; left time: 354.2581s
	iters: 400, epoch: 32 | loss: 0.0006391
	speed: 0.0407s/iter; left time: 346.4705s
Epoch: 32 cost time: 19.12496566772461
Epoch: 32, Steps: 469 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.977 Test Loss: 0.188 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000108
	speed: 0.2397s/iter; left time: 1999.6989s
	iters: 200, epoch: 33 | loss: 0.0002038
	speed: 0.0378s/iter; left time: 311.9928s
	iters: 300, epoch: 33 | loss: 0.0000273
	speed: 0.0391s/iter; left time: 318.5498s
	iters: 400, epoch: 33 | loss: 0.0000197
	speed: 0.0402s/iter; left time: 323.4030s
Epoch: 33 cost time: 18.44818091392517
Epoch: 33, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.977 Test Loss: 0.226 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000104
	speed: 0.2358s/iter; left time: 1856.4312s
	iters: 200, epoch: 34 | loss: 0.0007482
	speed: 0.0374s/iter; left time: 290.5719s
	iters: 300, epoch: 34 | loss: 0.0000201
	speed: 0.0390s/iter; left time: 299.4178s
	iters: 400, epoch: 34 | loss: 0.0000338
	speed: 0.0379s/iter; left time: 287.0065s
Epoch: 34 cost time: 17.735090732574463
Epoch: 34, Steps: 469 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0001145
	speed: 0.2389s/iter; left time: 1768.9122s
	iters: 200, epoch: 35 | loss: 0.0001756
	speed: 0.0413s/iter; left time: 302.0474s
	iters: 300, epoch: 35 | loss: 0.0002866
	speed: 0.0413s/iter; left time: 297.8895s
	iters: 400, epoch: 35 | loss: 0.0000327
	speed: 0.0408s/iter; left time: 290.2331s
Epoch: 35 cost time: 19.271580934524536
Epoch: 35, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.977 Test Loss: 0.205 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0003754
	speed: 0.2278s/iter; left time: 1580.2025s
	iters: 200, epoch: 36 | loss: 0.0189002
	speed: 0.0351s/iter; left time: 240.1014s
	iters: 300, epoch: 36 | loss: 0.0008725
	speed: 0.0348s/iter; left time: 234.2112s
	iters: 400, epoch: 36 | loss: 0.0050945
	speed: 0.0365s/iter; left time: 242.5286s
Epoch: 36 cost time: 17.019331693649292
Epoch: 36, Steps: 469 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.973 Test Loss: 0.249 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 30922
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3318025
	speed: 0.0468s/iter; left time: 1093.5593s
	iters: 200, epoch: 1 | loss: 0.5765848
	speed: 0.0330s/iter; left time: 768.0096s
	iters: 300, epoch: 1 | loss: 0.4606181
	speed: 0.0330s/iter; left time: 764.1890s
	iters: 400, epoch: 1 | loss: 0.1786521
	speed: 0.0344s/iter; left time: 794.0326s
Epoch: 1 cost time: 17.184487104415894
Epoch: 1, Steps: 469 | Train Loss: 0.866 Vali Loss: 0.404 Vali Acc: 0.882 Test Loss: 0.404 Test Acc: 0.882
Validation loss decreased (inf --> -0.882214).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3263640
	speed: 0.2296s/iter; left time: 5253.6496s
	iters: 200, epoch: 2 | loss: 0.3041068
	speed: 0.0324s/iter; left time: 738.0150s
	iters: 300, epoch: 2 | loss: 0.1366678
	speed: 0.0312s/iter; left time: 708.3873s
	iters: 400, epoch: 2 | loss: 0.1386399
	speed: 0.0313s/iter; left time: 706.2811s
Epoch: 2 cost time: 15.269482135772705
Epoch: 2, Steps: 469 | Train Loss: 0.182 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.882214 --> -0.944252).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2648302
	speed: 0.2268s/iter; left time: 5083.9377s
	iters: 200, epoch: 3 | loss: 0.1060201
	speed: 0.0337s/iter; left time: 750.8677s
	iters: 300, epoch: 3 | loss: 0.2899447
	speed: 0.0331s/iter; left time: 734.4140s
	iters: 400, epoch: 3 | loss: 0.0555465
	speed: 0.0338s/iter; left time: 746.6303s
Epoch: 3 cost time: 16.012823820114136
Epoch: 3, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
Validation loss decreased (-0.944252 --> -0.945681).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0080962
	speed: 0.2266s/iter; left time: 4973.3630s
	iters: 200, epoch: 4 | loss: 0.0573396
	speed: 0.0343s/iter; left time: 750.0517s
	iters: 300, epoch: 4 | loss: 0.0450825
	speed: 0.0340s/iter; left time: 738.3519s
	iters: 400, epoch: 4 | loss: 0.3810785
	speed: 0.0346s/iter; left time: 748.9918s
Epoch: 4 cost time: 16.3772075176239
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.945681 --> -0.958546).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0074508
	speed: 0.2208s/iter; left time: 4740.9968s
	iters: 200, epoch: 5 | loss: 0.0363025
	speed: 0.0344s/iter; left time: 734.4917s
	iters: 300, epoch: 5 | loss: 0.0444094
	speed: 0.0334s/iter; left time: 711.5785s
	iters: 400, epoch: 5 | loss: 0.0286771
	speed: 0.0342s/iter; left time: 724.2332s
Epoch: 5 cost time: 16.12360143661499
Epoch: 5, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0595412
	speed: 0.2310s/iter; left time: 4851.3972s
	iters: 200, epoch: 6 | loss: 0.0397891
	speed: 0.0320s/iter; left time: 668.6153s
	iters: 300, epoch: 6 | loss: 0.1251851
	speed: 0.0322s/iter; left time: 670.7281s
	iters: 400, epoch: 6 | loss: 0.0142503
	speed: 0.0340s/iter; left time: 703.0063s
Epoch: 6 cost time: 15.885744571685791
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
Validation loss decreased (-0.958546 --> -0.963692).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0104891
	speed: 0.2336s/iter; left time: 4797.8225s
	iters: 200, epoch: 7 | loss: 0.0091930
	speed: 0.0351s/iter; left time: 716.5642s
	iters: 300, epoch: 7 | loss: 0.0019270
	speed: 0.0339s/iter; left time: 690.3419s
	iters: 400, epoch: 7 | loss: 0.0090239
	speed: 0.0329s/iter; left time: 665.6974s
Epoch: 7 cost time: 16.26970887184143
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
Validation loss decreased (-0.963692 --> -0.967980).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0101758
	speed: 0.2258s/iter; left time: 4532.0250s
	iters: 200, epoch: 8 | loss: 0.0441348
	speed: 0.0329s/iter; left time: 657.3226s
	iters: 300, epoch: 8 | loss: 0.1011781
	speed: 0.0342s/iter; left time: 678.6037s
	iters: 400, epoch: 8 | loss: 0.0030041
	speed: 0.0343s/iter; left time: 678.6476s
Epoch: 8 cost time: 16.236715078353882
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.192 Vali Acc: 0.965 Test Loss: 0.192 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0019481
	speed: 0.2306s/iter; left time: 4519.3558s
	iters: 200, epoch: 9 | loss: 0.0029116
	speed: 0.0337s/iter; left time: 658.0379s
	iters: 300, epoch: 9 | loss: 0.0016228
	speed: 0.0343s/iter; left time: 665.2342s
	iters: 400, epoch: 9 | loss: 0.0657032
	speed: 0.0343s/iter; left time: 661.8897s
Epoch: 9 cost time: 16.47510576248169
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
Validation loss decreased (-0.967980 --> -0.971696).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0284054
	speed: 0.2293s/iter; left time: 4385.9209s
	iters: 200, epoch: 10 | loss: 0.0014675
	speed: 0.0333s/iter; left time: 633.7047s
	iters: 300, epoch: 10 | loss: 0.0027209
	speed: 0.0345s/iter; left time: 652.2775s
	iters: 400, epoch: 10 | loss: 0.0648371
	speed: 0.0339s/iter; left time: 638.9606s
Epoch: 10 cost time: 16.208017110824585
Epoch: 10, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0019730
	speed: 0.2334s/iter; left time: 4355.5639s
	iters: 200, epoch: 11 | loss: 0.0003634
	speed: 0.0329s/iter; left time: 610.8156s
	iters: 300, epoch: 11 | loss: 0.1342052
	speed: 0.0322s/iter; left time: 594.3194s
	iters: 400, epoch: 11 | loss: 0.0006444
	speed: 0.0314s/iter; left time: 577.2974s
Epoch: 11 cost time: 15.81510853767395
Epoch: 11, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.248 Vali Acc: 0.962 Test Loss: 0.248 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0109978
	speed: 0.2305s/iter; left time: 4192.9343s
	iters: 200, epoch: 12 | loss: 0.0126118
	speed: 0.0318s/iter; left time: 575.8732s
	iters: 300, epoch: 12 | loss: 0.0019712
	speed: 0.0324s/iter; left time: 582.7503s
	iters: 400, epoch: 12 | loss: 0.0017938
	speed: 0.0339s/iter; left time: 606.8544s
Epoch: 12 cost time: 15.787554264068604
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.969 Test Loss: 0.190 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0651550
	speed: 0.2105s/iter; left time: 3729.9086s
	iters: 200, epoch: 13 | loss: 0.0044888
	speed: 0.0301s/iter; left time: 530.7584s
	iters: 300, epoch: 13 | loss: 0.0006091
	speed: 0.0325s/iter; left time: 570.0712s
	iters: 400, epoch: 13 | loss: 0.0006129
	speed: 0.0377s/iter; left time: 656.6126s
Epoch: 13 cost time: 15.972579956054688
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0040572
	speed: 0.2286s/iter; left time: 3944.3068s
	iters: 200, epoch: 14 | loss: 0.0012378
	speed: 0.0341s/iter; left time: 585.0676s
	iters: 300, epoch: 14 | loss: 0.0005939
	speed: 0.0341s/iter; left time: 582.1669s
	iters: 400, epoch: 14 | loss: 0.0061839
	speed: 0.0372s/iter; left time: 630.6162s
Epoch: 14 cost time: 16.84547209739685
Epoch: 14, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0062476
	speed: 0.2262s/iter; left time: 3796.5217s
	iters: 200, epoch: 15 | loss: 0.0014309
	speed: 0.0303s/iter; left time: 505.1786s
	iters: 300, epoch: 15 | loss: 0.0483785
	speed: 0.0305s/iter; left time: 505.6575s
	iters: 400, epoch: 15 | loss: 0.0004091
	speed: 0.0353s/iter; left time: 582.4081s
Epoch: 15 cost time: 15.601261138916016
Epoch: 15, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000268
	speed: 0.2305s/iter; left time: 3761.5951s
	iters: 200, epoch: 16 | loss: 0.0300153
	speed: 0.0349s/iter; left time: 566.6445s
	iters: 300, epoch: 16 | loss: 0.0013528
	speed: 0.0336s/iter; left time: 541.5634s
	iters: 400, epoch: 16 | loss: 0.0018030
	speed: 0.0365s/iter; left time: 583.9280s
Epoch: 16 cost time: 16.70538568496704
Epoch: 16, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.969 Test Loss: 0.194 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0048768
	speed: 0.2293s/iter; left time: 3633.0096s
	iters: 200, epoch: 17 | loss: 0.0111174
	speed: 0.0333s/iter; left time: 525.1356s
	iters: 300, epoch: 17 | loss: 0.0061167
	speed: 0.0297s/iter; left time: 464.4378s
	iters: 400, epoch: 17 | loss: 0.0001040
	speed: 0.0360s/iter; left time: 559.6940s
Epoch: 17 cost time: 16.1890389919281
Epoch: 17, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
Validation loss decreased (-0.971696 --> -0.977414).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0014287
	speed: 0.2232s/iter; left time: 3432.0857s
	iters: 200, epoch: 18 | loss: 0.0003303
	speed: 0.0326s/iter; left time: 498.0947s
	iters: 300, epoch: 18 | loss: 0.0225378
	speed: 0.0334s/iter; left time: 506.4245s
	iters: 400, epoch: 18 | loss: 0.0007281
	speed: 0.0367s/iter; left time: 553.5528s
Epoch: 18 cost time: 16.42836618423462
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0023166
	speed: 0.2224s/iter; left time: 3315.6192s
	iters: 200, epoch: 19 | loss: 0.4174847
	speed: 0.0291s/iter; left time: 431.3699s
	iters: 300, epoch: 19 | loss: 0.0064486
	speed: 0.0306s/iter; left time: 450.4183s
	iters: 400, epoch: 19 | loss: 0.0032219
	speed: 0.0354s/iter; left time: 517.5982s
Epoch: 19 cost time: 15.388689279556274
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0017008
	speed: 0.2271s/iter; left time: 3278.9110s
	iters: 200, epoch: 20 | loss: 0.0140323
	speed: 0.0311s/iter; left time: 446.1893s
	iters: 300, epoch: 20 | loss: 0.0014837
	speed: 0.0306s/iter; left time: 436.0969s
	iters: 400, epoch: 20 | loss: 0.0001447
	speed: 0.0361s/iter; left time: 509.9204s
Epoch: 20 cost time: 15.952136516571045
Epoch: 20, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0026534
	speed: 0.2281s/iter; left time: 3187.4296s
	iters: 200, epoch: 21 | loss: 0.0014779
	speed: 0.0341s/iter; left time: 472.5386s
	iters: 300, epoch: 21 | loss: 0.0002831
	speed: 0.0341s/iter; left time: 469.3895s
	iters: 400, epoch: 21 | loss: 0.0004868
	speed: 0.0351s/iter; left time: 479.7675s
Epoch: 21 cost time: 16.592734813690186
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0002262
	speed: 0.2202s/iter; left time: 2973.3959s
	iters: 200, epoch: 22 | loss: 0.0006467
	speed: 0.0328s/iter; left time: 438.9312s
	iters: 300, epoch: 22 | loss: 0.0004960
	speed: 0.0338s/iter; left time: 449.5562s
	iters: 400, epoch: 22 | loss: 0.0004205
	speed: 0.0357s/iter; left time: 471.6844s
Epoch: 22 cost time: 16.415924310684204
Epoch: 22, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0177478
	speed: 0.2144s/iter; left time: 2793.9976s
	iters: 200, epoch: 23 | loss: 0.0003188
	speed: 0.0341s/iter; left time: 441.3703s
	iters: 300, epoch: 23 | loss: 0.0014997
	speed: 0.0347s/iter; left time: 445.7242s
	iters: 400, epoch: 23 | loss: 0.0003151
	speed: 0.0367s/iter; left time: 467.7204s
Epoch: 23 cost time: 16.72682213783264
Epoch: 23, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000542
	speed: 0.2201s/iter; left time: 2764.9972s
	iters: 200, epoch: 24 | loss: 0.0005227
	speed: 0.0316s/iter; left time: 393.4430s
	iters: 300, epoch: 24 | loss: 0.0001716
	speed: 0.0327s/iter; left time: 404.5866s
	iters: 400, epoch: 24 | loss: 0.0006057
	speed: 0.0360s/iter; left time: 441.5855s
Epoch: 24 cost time: 16.211313247680664
Epoch: 24, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0001392
	speed: 0.2225s/iter; left time: 2690.9271s
	iters: 200, epoch: 25 | loss: 0.0001220
	speed: 0.0334s/iter; left time: 400.1185s
	iters: 300, epoch: 25 | loss: 0.0014637
	speed: 0.0331s/iter; left time: 393.9720s
	iters: 400, epoch: 25 | loss: 0.0001567
	speed: 0.0354s/iter; left time: 417.4792s
Epoch: 25 cost time: 16.36227250099182
Epoch: 25, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
Validation loss decreased (-0.977414 --> -0.977414).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0037643
	speed: 0.2227s/iter; left time: 2588.7917s
	iters: 200, epoch: 26 | loss: 0.0008192
	speed: 0.0340s/iter; left time: 391.7867s
	iters: 300, epoch: 26 | loss: 0.0010655
	speed: 0.0355s/iter; left time: 405.9992s
	iters: 400, epoch: 26 | loss: 0.0265107
	speed: 0.0358s/iter; left time: 405.8162s
Epoch: 26 cost time: 16.816954374313354
Epoch: 26, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.178 Vali Acc: 0.977 Test Loss: 0.178 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0009545
	speed: 0.2094s/iter; left time: 2336.3316s
	iters: 200, epoch: 27 | loss: 0.0026092
	speed: 0.0309s/iter; left time: 341.9573s
	iters: 300, epoch: 27 | loss: 0.0034283
	speed: 0.0344s/iter; left time: 376.6316s
	iters: 400, epoch: 27 | loss: 0.0000883
	speed: 0.0357s/iter; left time: 387.7901s
Epoch: 27 cost time: 15.645086765289307
Epoch: 27, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.972 Test Loss: 0.213 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0015967
	speed: 0.2120s/iter; left time: 2265.3344s
	iters: 200, epoch: 28 | loss: 0.0001364
	speed: 0.0331s/iter; left time: 350.1938s
	iters: 300, epoch: 28 | loss: 0.0001764
	speed: 0.0355s/iter; left time: 371.9656s
	iters: 400, epoch: 28 | loss: 0.0000328
	speed: 0.0361s/iter; left time: 374.5092s
Epoch: 28 cost time: 16.347994804382324
Epoch: 28, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.971 Test Loss: 0.204 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0178129
	speed: 0.2154s/iter; left time: 2201.0967s
	iters: 200, epoch: 29 | loss: 0.0016659
	speed: 0.0302s/iter; left time: 305.8825s
	iters: 300, epoch: 29 | loss: 0.0170546
	speed: 0.0335s/iter; left time: 335.3125s
	iters: 400, epoch: 29 | loss: 0.0006063
	speed: 0.0342s/iter; left time: 339.5868s
Epoch: 29 cost time: 15.835328817367554
Epoch: 29, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.970 Test Loss: 0.229 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0017104
	speed: 0.2196s/iter; left time: 2141.0056s
	iters: 200, epoch: 30 | loss: 0.0001551
	speed: 0.0318s/iter; left time: 306.9055s
	iters: 300, epoch: 30 | loss: 0.0023126
	speed: 0.0356s/iter; left time: 339.9679s
	iters: 400, epoch: 30 | loss: 0.0013971
	speed: 0.0336s/iter; left time: 317.9646s
Epoch: 30 cost time: 16.063796520233154
Epoch: 30, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.973 Test Loss: 0.208 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0869626
	speed: 0.2122s/iter; left time: 1969.4245s
	iters: 200, epoch: 31 | loss: 0.0622510
	speed: 0.0343s/iter; left time: 314.9618s
	iters: 300, epoch: 31 | loss: 0.0009527
	speed: 0.0355s/iter; left time: 322.0296s
	iters: 400, epoch: 31 | loss: 0.0011567
	speed: 0.0353s/iter; left time: 316.8903s
Epoch: 31 cost time: 16.64780592918396
Epoch: 31, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0002915
	speed: 0.2125s/iter; left time: 1872.7894s
	iters: 200, epoch: 32 | loss: 0.1002779
	speed: 0.0337s/iter; left time: 293.8927s
	iters: 300, epoch: 32 | loss: 0.0015584
	speed: 0.0369s/iter; left time: 317.4200s
	iters: 400, epoch: 32 | loss: 0.0157344
	speed: 0.0357s/iter; left time: 303.4960s
Epoch: 32 cost time: 16.82986855506897
Epoch: 32, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.246 Vali Acc: 0.973 Test Loss: 0.246 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0577279
	speed: 0.2149s/iter; left time: 1793.2573s
	iters: 200, epoch: 33 | loss: 0.0089119
	speed: 0.0327s/iter; left time: 269.4346s
	iters: 300, epoch: 33 | loss: 0.0000502
	speed: 0.0364s/iter; left time: 296.6391s
	iters: 400, epoch: 33 | loss: 0.7479011
	speed: 0.0361s/iter; left time: 290.0878s
Epoch: 33 cost time: 16.52420425415039
Epoch: 33, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.972 Test Loss: 0.225 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0008537
	speed: 0.2125s/iter; left time: 1673.5297s
	iters: 200, epoch: 34 | loss: 0.0000773
	speed: 0.0317s/iter; left time: 246.5112s
	iters: 300, epoch: 34 | loss: 0.0001480
	speed: 0.0340s/iter; left time: 260.9383s
	iters: 400, epoch: 34 | loss: 0.0006763
	speed: 0.0334s/iter; left time: 253.1231s
Epoch: 34 cost time: 15.649923324584961
Epoch: 34, Steps: 469 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.972 Test Loss: 0.256 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0013378
	speed: 0.2135s/iter; left time: 1581.0187s
	iters: 200, epoch: 35 | loss: 0.0000875
	speed: 0.0336s/iter; left time: 245.8089s
	iters: 300, epoch: 35 | loss: 0.0098404
	speed: 0.0358s/iter; left time: 257.8823s
	iters: 400, epoch: 35 | loss: 0.0005220
	speed: 0.0361s/iter; left time: 256.6904s
Epoch: 35 cost time: 16.56501817703247
Epoch: 35, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.974 Test Loss: 0.197 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 11338
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3978148
	speed: 0.0465s/iter; left time: 1086.7070s
	iters: 200, epoch: 1 | loss: 1.0127206
	speed: 0.0319s/iter; left time: 741.1989s
	iters: 300, epoch: 1 | loss: 0.4389613
	speed: 0.0291s/iter; left time: 674.1014s
	iters: 400, epoch: 1 | loss: 0.4016673
	speed: 0.0295s/iter; left time: 680.5589s
Epoch: 1 cost time: 15.926125526428223
Epoch: 1, Steps: 469 | Train Loss: 0.938 Vali Loss: 0.423 Vali Acc: 0.886 Test Loss: 0.423 Test Acc: 0.886
Validation loss decreased (inf --> -0.885931).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3759456
	speed: 0.2227s/iter; left time: 5094.8404s
	iters: 200, epoch: 2 | loss: 0.1617527
	speed: 0.0337s/iter; left time: 767.0684s
	iters: 300, epoch: 2 | loss: 0.2169787
	speed: 0.0331s/iter; left time: 750.7503s
	iters: 400, epoch: 2 | loss: 0.0914780
	speed: 0.0310s/iter; left time: 700.3025s
Epoch: 2 cost time: 15.760065793991089
Epoch: 2, Steps: 469 | Train Loss: 0.184 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
Validation loss decreased (-0.885931 --> -0.922239).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1173036
	speed: 0.2162s/iter; left time: 4845.7492s
	iters: 200, epoch: 3 | loss: 0.0563895
	speed: 0.0330s/iter; left time: 737.3853s
	iters: 300, epoch: 3 | loss: 0.0293665
	speed: 0.0328s/iter; left time: 728.6209s
	iters: 400, epoch: 3 | loss: 0.1400713
	speed: 0.0336s/iter; left time: 742.6414s
Epoch: 3 cost time: 16.010189294815063
Epoch: 3, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.922239 --> -0.956259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0218663
	speed: 0.2192s/iter; left time: 4809.2265s
	iters: 200, epoch: 4 | loss: 0.1105781
	speed: 0.0313s/iter; left time: 684.7310s
	iters: 300, epoch: 4 | loss: 0.2043473
	speed: 0.0323s/iter; left time: 702.7792s
	iters: 400, epoch: 4 | loss: 0.0100970
	speed: 0.0315s/iter; left time: 681.5787s
Epoch: 4 cost time: 15.330670833587646
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
Validation loss decreased (-0.956259 --> -0.966265).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0123133
	speed: 0.2436s/iter; left time: 5231.0495s
	iters: 200, epoch: 5 | loss: 0.0120534
	speed: 0.0382s/iter; left time: 816.3685s
	iters: 300, epoch: 5 | loss: 0.0110826
	speed: 0.0356s/iter; left time: 757.6634s
	iters: 400, epoch: 5 | loss: 0.0040929
	speed: 0.0350s/iter; left time: 740.1701s
Epoch: 5 cost time: 17.681997776031494
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.966265 --> -0.969696).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1052833
	speed: 0.2333s/iter; left time: 4899.7529s
	iters: 200, epoch: 6 | loss: 0.0085687
	speed: 0.0384s/iter; left time: 802.5204s
	iters: 300, epoch: 6 | loss: 0.0015517
	speed: 0.0376s/iter; left time: 782.0664s
	iters: 400, epoch: 6 | loss: 0.0367238
	speed: 0.0367s/iter; left time: 760.4687s
Epoch: 6 cost time: 18.073923110961914
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.969696 --> -0.971697).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0033561
	speed: 0.2540s/iter; left time: 5215.7284s
	iters: 200, epoch: 7 | loss: 0.0010409
	speed: 0.0366s/iter; left time: 748.2690s
	iters: 300, epoch: 7 | loss: 0.0446277
	speed: 0.0372s/iter; left time: 757.1936s
	iters: 400, epoch: 7 | loss: 0.0062830
	speed: 0.0383s/iter; left time: 776.0621s
Epoch: 7 cost time: 17.873500108718872
Epoch: 7, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0378556
	speed: 0.2495s/iter; left time: 5006.2154s
	iters: 200, epoch: 8 | loss: 0.0215928
	speed: 0.0366s/iter; left time: 731.4952s
	iters: 300, epoch: 8 | loss: 0.0129738
	speed: 0.0348s/iter; left time: 691.3516s
	iters: 400, epoch: 8 | loss: 0.0240650
	speed: 0.0363s/iter; left time: 716.6507s
Epoch: 8 cost time: 17.41126823425293
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0556390
	speed: 0.2519s/iter; left time: 4937.0927s
	iters: 200, epoch: 9 | loss: 0.0188620
	speed: 0.0374s/iter; left time: 729.4386s
	iters: 300, epoch: 9 | loss: 0.0022879
	speed: 0.0363s/iter; left time: 705.0657s
	iters: 400, epoch: 9 | loss: 0.0047793
	speed: 0.0358s/iter; left time: 690.3614s
Epoch: 9 cost time: 17.694074630737305
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972554).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0042587
	speed: 0.2474s/iter; left time: 4733.4192s
	iters: 200, epoch: 10 | loss: 0.0017456
	speed: 0.0369s/iter; left time: 702.9098s
	iters: 300, epoch: 10 | loss: 0.0014843
	speed: 0.0318s/iter; left time: 601.3012s
	iters: 400, epoch: 10 | loss: 0.0066815
	speed: 0.0357s/iter; left time: 672.9607s
Epoch: 10 cost time: 17.28953528404236
Epoch: 10, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1037121
	speed: 0.2453s/iter; left time: 4578.3527s
	iters: 200, epoch: 11 | loss: 0.0024439
	speed: 0.0369s/iter; left time: 685.4549s
	iters: 300, epoch: 11 | loss: 0.0063105
	speed: 0.0392s/iter; left time: 724.3540s
	iters: 400, epoch: 11 | loss: 0.0007642
	speed: 0.0377s/iter; left time: 692.7092s
Epoch: 11 cost time: 18.22086763381958
Epoch: 11, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.972554 --> -0.975127).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0023257
	speed: 0.2479s/iter; left time: 4509.5737s
	iters: 200, epoch: 12 | loss: 0.0023438
	speed: 0.0392s/iter; left time: 708.6324s
	iters: 300, epoch: 12 | loss: 0.0013994
	speed: 0.0388s/iter; left time: 697.5083s
	iters: 400, epoch: 12 | loss: 0.0094235
	speed: 0.0385s/iter; left time: 688.6197s
Epoch: 12 cost time: 18.726378440856934
Epoch: 12, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
Validation loss decreased (-0.975127 --> -0.975985).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0261466
	speed: 0.2501s/iter; left time: 4432.8729s
	iters: 200, epoch: 13 | loss: 0.0162640
	speed: 0.0388s/iter; left time: 683.1579s
	iters: 300, epoch: 13 | loss: 0.0056214
	speed: 0.0375s/iter; left time: 657.6729s
	iters: 400, epoch: 13 | loss: 0.0004306
	speed: 0.0394s/iter; left time: 687.1993s
Epoch: 13 cost time: 18.488027334213257
Epoch: 13, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0096994
	speed: 0.2533s/iter; left time: 4370.1988s
	iters: 200, epoch: 14 | loss: 0.0023188
	speed: 0.0363s/iter; left time: 623.0714s
	iters: 300, epoch: 14 | loss: 0.0056850
	speed: 0.0355s/iter; left time: 606.2676s
	iters: 400, epoch: 14 | loss: 0.0007078
	speed: 0.0369s/iter; left time: 625.6139s
Epoch: 14 cost time: 17.658263444900513
Epoch: 14, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976842).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0466693
	speed: 0.2508s/iter; left time: 4209.2396s
	iters: 200, epoch: 15 | loss: 0.2445984
	speed: 0.0390s/iter; left time: 650.1417s
	iters: 300, epoch: 15 | loss: 0.0139617
	speed: 0.0359s/iter; left time: 594.6988s
	iters: 400, epoch: 15 | loss: 0.0079492
	speed: 0.0367s/iter; left time: 605.3660s
Epoch: 15 cost time: 17.980052947998047
Epoch: 15, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0004542
	speed: 0.2464s/iter; left time: 4019.4878s
	iters: 200, epoch: 16 | loss: 0.0115591
	speed: 0.0402s/iter; left time: 652.6813s
	iters: 300, epoch: 16 | loss: 0.0015616
	speed: 0.0378s/iter; left time: 609.5386s
	iters: 400, epoch: 16 | loss: 0.0043276
	speed: 0.0379s/iter; left time: 607.5424s
Epoch: 16 cost time: 18.476628303527832
Epoch: 16, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
Validation loss decreased (-0.976842 --> -0.977986).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0200988
	speed: 0.2455s/iter; left time: 3890.1449s
	iters: 200, epoch: 17 | loss: 0.0003174
	speed: 0.0397s/iter; left time: 624.7585s
	iters: 300, epoch: 17 | loss: 0.0012609
	speed: 0.0382s/iter; left time: 597.3386s
	iters: 400, epoch: 17 | loss: 0.0012006
	speed: 0.0368s/iter; left time: 571.8820s
Epoch: 17 cost time: 18.30708384513855
Epoch: 17, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0002356
	speed: 0.2491s/iter; left time: 3831.2705s
	iters: 200, epoch: 18 | loss: 0.0001681
	speed: 0.0401s/iter; left time: 612.0682s
	iters: 300, epoch: 18 | loss: 0.0169571
	speed: 0.0398s/iter; left time: 604.8113s
	iters: 400, epoch: 18 | loss: 0.0001485
	speed: 0.0402s/iter; left time: 605.8567s
Epoch: 18 cost time: 19.325936555862427
Epoch: 18, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0005670
	speed: 0.2628s/iter; left time: 3917.8608s
	iters: 200, epoch: 19 | loss: 0.0023968
	speed: 0.0401s/iter; left time: 593.1075s
	iters: 300, epoch: 19 | loss: 0.0028040
	speed: 0.0377s/iter; left time: 554.4421s
	iters: 400, epoch: 19 | loss: 0.0007288
	speed: 0.0385s/iter; left time: 561.8560s
Epoch: 19 cost time: 19.103219270706177
Epoch: 19, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0003025
	speed: 0.2540s/iter; left time: 3667.4944s
	iters: 200, epoch: 20 | loss: 0.0030762
	speed: 0.0328s/iter; left time: 470.4635s
	iters: 300, epoch: 20 | loss: 0.0005567
	speed: 0.0340s/iter; left time: 483.5206s
	iters: 400, epoch: 20 | loss: 0.0101623
	speed: 0.0394s/iter; left time: 556.4682s
Epoch: 20 cost time: 17.332120895385742
Epoch: 20, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0006450
	speed: 0.2610s/iter; left time: 3646.5440s
	iters: 200, epoch: 21 | loss: 0.0013428
	speed: 0.0396s/iter; left time: 549.6037s
	iters: 300, epoch: 21 | loss: 0.0010149
	speed: 0.0387s/iter; left time: 532.3706s
	iters: 400, epoch: 21 | loss: 0.0004966
	speed: 0.0410s/iter; left time: 560.2392s
Epoch: 21 cost time: 19.004223585128784
Epoch: 21, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.979415).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0012205
	speed: 0.2459s/iter; left time: 3320.6270s
	iters: 200, epoch: 22 | loss: 0.0226358
	speed: 0.0272s/iter; left time: 364.0770s
	iters: 300, epoch: 22 | loss: 0.0005934
	speed: 0.0291s/iter; left time: 386.4422s
	iters: 400, epoch: 22 | loss: 0.0037540
	speed: 0.0411s/iter; left time: 542.5860s
Epoch: 22 cost time: 16.45549488067627
Epoch: 22, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1573428
	speed: 0.2532s/iter; left time: 3299.8871s
	iters: 200, epoch: 23 | loss: 0.0020011
	speed: 0.0380s/iter; left time: 491.5513s
	iters: 300, epoch: 23 | loss: 0.0046855
	speed: 0.0406s/iter; left time: 521.3638s
	iters: 400, epoch: 23 | loss: 0.0001944
	speed: 0.0432s/iter; left time: 550.5427s
Epoch: 23 cost time: 19.376899480819702
Epoch: 23, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.977 Test Loss: 0.174 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0066754
	speed: 0.2505s/iter; left time: 3147.2031s
	iters: 200, epoch: 24 | loss: 0.0007891
	speed: 0.0379s/iter; left time: 472.7276s
	iters: 300, epoch: 24 | loss: 0.0013840
	speed: 0.0395s/iter; left time: 488.9378s
	iters: 400, epoch: 24 | loss: 0.0006725
	speed: 0.0417s/iter; left time: 511.4134s
Epoch: 24 cost time: 18.763375520706177
Epoch: 24, Steps: 469 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.979 Test Loss: 0.141 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0003268
	speed: 0.2594s/iter; left time: 3137.6048s
	iters: 200, epoch: 25 | loss: 0.0003442
	speed: 0.0357s/iter; left time: 428.3452s
	iters: 300, epoch: 25 | loss: 0.0075692
	speed: 0.0400s/iter; left time: 476.0825s
	iters: 400, epoch: 25 | loss: 0.0067160
	speed: 0.0398s/iter; left time: 469.7194s
Epoch: 25 cost time: 18.46765947341919
Epoch: 25, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0016763
	speed: 0.2359s/iter; left time: 2742.8335s
	iters: 200, epoch: 26 | loss: 0.0033334
	speed: 0.0416s/iter; left time: 479.5407s
	iters: 300, epoch: 26 | loss: 0.0006121
	speed: 0.0441s/iter; left time: 503.8878s
	iters: 400, epoch: 26 | loss: 0.0000352
	speed: 0.0412s/iter; left time: 466.9481s
Epoch: 26 cost time: 19.86904263496399
Epoch: 26, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0089679
	speed: 0.2451s/iter; left time: 2734.5110s
	iters: 200, epoch: 27 | loss: 0.0052173
	speed: 0.0416s/iter; left time: 459.8974s
	iters: 300, epoch: 27 | loss: 0.0001778
	speed: 0.0435s/iter; left time: 476.6089s
	iters: 400, epoch: 27 | loss: 0.0022747
	speed: 0.0429s/iter; left time: 465.5151s
Epoch: 27 cost time: 19.95739221572876
Epoch: 27, Steps: 469 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0076516
	speed: 0.2461s/iter; left time: 2629.9473s
	iters: 200, epoch: 28 | loss: 0.0163355
	speed: 0.0400s/iter; left time: 423.0216s
	iters: 300, epoch: 28 | loss: 0.0102774
	speed: 0.0420s/iter; left time: 440.0915s
	iters: 400, epoch: 28 | loss: 0.0003585
	speed: 0.0418s/iter; left time: 433.7441s
Epoch: 28 cost time: 19.40774917602539
Epoch: 28, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0029697
	speed: 0.2425s/iter; left time: 2477.7182s
	iters: 200, epoch: 29 | loss: 0.0058163
	speed: 0.0411s/iter; left time: 416.3482s
	iters: 300, epoch: 29 | loss: 0.0001901
	speed: 0.0419s/iter; left time: 420.0329s
	iters: 400, epoch: 29 | loss: 0.0005773
	speed: 0.0400s/iter; left time: 396.3361s
Epoch: 29 cost time: 19.10681986808777
Epoch: 29, Steps: 469 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0017005
	speed: 0.2563s/iter; left time: 2498.7928s
	iters: 200, epoch: 30 | loss: 0.0003595
	speed: 0.0420s/iter; left time: 404.8470s
	iters: 300, epoch: 30 | loss: 0.0003137
	speed: 0.0417s/iter; left time: 398.6660s
	iters: 400, epoch: 30 | loss: 0.0007431
	speed: 0.0416s/iter; left time: 392.6885s
Epoch: 30 cost time: 19.58768105506897
Epoch: 30, Steps: 469 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000804
	speed: 0.2490s/iter; left time: 2310.5050s
	iters: 200, epoch: 31 | loss: 0.0009629
	speed: 0.0437s/iter; left time: 400.9225s
	iters: 300, epoch: 31 | loss: 0.0081744
	speed: 0.0426s/iter; left time: 386.6168s
	iters: 400, epoch: 31 | loss: 0.0071342
	speed: 0.0407s/iter; left time: 365.2575s
Epoch: 31 cost time: 20.048787832260132
Epoch: 31, Steps: 469 | Train Loss: 0.015 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ModernTCN_UEA_ftM_sl8_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 11370
model size : 0.06MB
