2025-04-27 20:04:11.789255: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:04:11.805193: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784251.826737    2560 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784251.833241    2560 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:04:11.854874: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.506396532058716
Epoch: 1, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.653 Vali Acc: 0.676 Test Loss: 1.653 Test Acc: 0.676
Validation loss decreased (inf --> -0.676284).  Saving model ...
Epoch: 2 cost time: 13.280209302902222
Epoch: 2, Steps: 17 | Train Loss: 0.530 Vali Loss: 2.753 Vali Acc: 0.566 Test Loss: 2.753 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.22159719467163
Epoch: 3, Steps: 17 | Train Loss: 0.223 Vali Loss: 2.400 Vali Acc: 0.780 Test Loss: 2.400 Test Acc: 0.780
Validation loss decreased (-0.676284 --> -0.780323).  Saving model ...
Epoch: 4 cost time: 13.299731731414795
Epoch: 4, Steps: 17 | Train Loss: 0.460 Vali Loss: 3.174 Vali Acc: 0.699 Test Loss: 3.174 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.2340567111969
Epoch: 5, Steps: 17 | Train Loss: 0.224 Vali Loss: 3.864 Vali Acc: 0.694 Test Loss: 3.864 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.225721597671509
Epoch: 6, Steps: 17 | Train Loss: 0.109 Vali Loss: 2.342 Vali Acc: 0.786 Test Loss: 2.342 Test Acc: 0.786
Validation loss decreased (-0.780323 --> -0.786104).  Saving model ...
Epoch: 7 cost time: 13.268165349960327
Epoch: 7, Steps: 17 | Train Loss: 0.075 Vali Loss: 5.986 Vali Acc: 0.723 Test Loss: 5.986 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.239572763442993
Epoch: 8, Steps: 17 | Train Loss: 0.420 Vali Loss: 10.733 Vali Acc: 0.705 Test Loss: 10.733 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 13.248009204864502
Epoch: 9, Steps: 17 | Train Loss: 0.461 Vali Loss: 7.249 Vali Acc: 0.688 Test Loss: 7.249 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.227787733078003
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 3.672 Vali Acc: 0.763 Test Loss: 3.672 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.240334272384644
Epoch: 11, Steps: 17 | Train Loss: 0.197 Vali Loss: 6.945 Vali Acc: 0.676 Test Loss: 6.945 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.233855962753296
Epoch: 12, Steps: 17 | Train Loss: 0.079 Vali Loss: 7.111 Vali Acc: 0.740 Test Loss: 7.111 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 13.230879068374634
Epoch: 13, Steps: 17 | Train Loss: 0.573 Vali Loss: 7.865 Vali Acc: 0.711 Test Loss: 7.865 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 13.23143982887268
Epoch: 14, Steps: 17 | Train Loss: 0.710 Vali Loss: 10.882 Vali Acc: 0.676 Test Loss: 10.882 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 13.23110294342041
Epoch: 15, Steps: 17 | Train Loss: 1.239 Vali Loss: 17.490 Vali Acc: 0.642 Test Loss: 17.490 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 13.235144853591919
Epoch: 16, Steps: 17 | Train Loss: 1.067 Vali Loss: 9.053 Vali Acc: 0.705 Test Loss: 9.053 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1849967655
model size : 7060.40MB
2025-04-27 20:10:40.582155: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:10:40.599573: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784640.621556   11969 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784640.628093   11969 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:10:40.649354: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.813705205917358
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.144 Vali Acc: 0.653 Test Loss: 1.144 Test Acc: 0.653
Validation loss decreased (inf --> -0.653168).  Saving model ...
Epoch: 2 cost time: 11.5466890335083
Epoch: 2, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.613 Vali Acc: 0.821 Test Loss: 0.613 Test Acc: 0.821
Validation loss decreased (-0.653168 --> -0.820803).  Saving model ...
Epoch: 3 cost time: 11.56350040435791
Epoch: 3, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.402 Vali Acc: 0.792 Test Loss: 1.402 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.484130144119263
Epoch: 4, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.997 Vali Acc: 0.780 Test Loss: 1.997 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.478688478469849
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.162 Vali Acc: 0.740 Test Loss: 2.162 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.483519554138184
Epoch: 6, Steps: 17 | Train Loss: 0.088 Vali Loss: 3.317 Vali Acc: 0.699 Test Loss: 3.317 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.47976016998291
Epoch: 7, Steps: 17 | Train Loss: 0.491 Vali Loss: 4.272 Vali Acc: 0.688 Test Loss: 4.272 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.47576642036438
Epoch: 8, Steps: 17 | Train Loss: 0.177 Vali Loss: 3.601 Vali Acc: 0.775 Test Loss: 3.601 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.466824054718018
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 5.313 Vali Acc: 0.699 Test Loss: 5.313 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.498719215393066
Epoch: 10, Steps: 17 | Train Loss: 0.333 Vali Loss: 4.017 Vali Acc: 0.809 Test Loss: 4.017 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.491941213607788
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 4.750 Vali Acc: 0.786 Test Loss: 4.750 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.491740465164185
Epoch: 12, Steps: 17 | Train Loss: 0.261 Vali Loss: 10.124 Vali Acc: 0.763 Test Loss: 10.124 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1842202151
model size : 7030.77MB
2025-04-27 20:15:09.483172: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:15:09.500779: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745784909.522095   19029 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745784909.528700   19029 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:15:09.550330: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.233006477355957
Epoch: 1, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.097 Vali Acc: 0.601 Test Loss: 1.097 Test Acc: 0.601
Validation loss decreased (inf --> -0.601145).  Saving model ...
Epoch: 2 cost time: 10.98118257522583
Epoch: 2, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.601145 --> -0.774558).  Saving model ...
Epoch: 3 cost time: 10.98482608795166
Epoch: 3, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.761 Vali Acc: 0.780 Test Loss: 1.761 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780329).  Saving model ...
Epoch: 4 cost time: 10.960183382034302
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.540 Vali Acc: 0.763 Test Loss: 1.540 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.927216291427612
Epoch: 5, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.974 Vali Acc: 0.786 Test Loss: 0.974 Test Acc: 0.786
Validation loss decreased (-0.780329 --> -0.786117).  Saving model ...
Epoch: 6 cost time: 10.975264549255371
Epoch: 6, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.588 Vali Acc: 0.763 Test Loss: 1.588 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.932280778884888
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.900 Vali Acc: 0.740 Test Loss: 1.900 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.926062822341919
Epoch: 8, Steps: 17 | Train Loss: 0.195 Vali Loss: 4.203 Vali Acc: 0.740 Test Loss: 4.203 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.924219608306885
Epoch: 9, Steps: 17 | Train Loss: 0.681 Vali Loss: 6.214 Vali Acc: 0.694 Test Loss: 6.214 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.926210165023804
Epoch: 10, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.262 Vali Acc: 0.746 Test Loss: 2.262 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.930954456329346
Epoch: 11, Steps: 17 | Train Loss: 0.208 Vali Loss: 4.909 Vali Acc: 0.780 Test Loss: 4.909 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.932164669036865
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 6.727 Vali Acc: 0.757 Test Loss: 6.727 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.9304780960083
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 6.256 Vali Acc: 0.757 Test Loss: 6.256 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.934775829315186
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.987 Vali Acc: 0.757 Test Loss: 5.987 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.940416097640991
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.936 Vali Acc: 0.763 Test Loss: 5.936 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1839613703
model size : 7020.90MB
2025-04-27 20:21:04.343955: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:21:04.361873: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785264.383563   27968 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785264.390139   27968 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:21:04.411742: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.88620376586914
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 0.806 Vali Acc: 0.728 Test Loss: 0.806 Test Acc: 0.728
Validation loss decreased (inf --> -0.728316).  Saving model ...
Epoch: 2 cost time: 10.803190469741821
Epoch: 2, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.476 Vali Acc: 0.549 Test Loss: 1.476 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.740567684173584
Epoch: 3, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.416 Vali Acc: 0.740 Test Loss: 1.416 Test Acc: 0.740
Validation loss decreased (-0.728316 --> -0.739870).  Saving model ...
Epoch: 4 cost time: 10.82646107673645
Epoch: 4, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.631 Vali Acc: 0.769 Test Loss: 1.631 Test Acc: 0.769
Validation loss decreased (-0.739870 --> -0.768770).  Saving model ...
Epoch: 5 cost time: 10.819389343261719
Epoch: 5, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.955 Vali Acc: 0.757 Test Loss: 1.955 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.885870695114136
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.601 Vali Acc: 0.734 Test Loss: 1.601 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.79339861869812
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.979 Vali Acc: 0.740 Test Loss: 1.979 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.839942455291748
Epoch: 8, Steps: 17 | Train Loss: 0.242 Vali Loss: 2.229 Vali Acc: 0.780 Test Loss: 2.229 Test Acc: 0.780
Validation loss decreased (-0.768770 --> -0.780325).  Saving model ...
Epoch: 9 cost time: 10.884603023529053
Epoch: 9, Steps: 17 | Train Loss: 0.263 Vali Loss: 3.757 Vali Acc: 0.746 Test Loss: 3.757 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.773687839508057
Epoch: 10, Steps: 17 | Train Loss: 0.241 Vali Loss: 4.306 Vali Acc: 0.775 Test Loss: 4.306 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.779327630996704
Epoch: 11, Steps: 17 | Train Loss: 0.247 Vali Loss: 3.096 Vali Acc: 0.803 Test Loss: 3.096 Test Acc: 0.803
Validation loss decreased (-0.780325 --> -0.803437).  Saving model ...
Epoch: 12 cost time: 10.79440689086914
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.005 Vali Acc: 0.821 Test Loss: 2.005 Test Acc: 0.821
Validation loss decreased (-0.803437 --> -0.820789).  Saving model ...
Epoch: 13 cost time: 10.801750421524048
Epoch: 13, Steps: 17 | Train Loss: 0.272 Vali Loss: 5.345 Vali Acc: 0.751 Test Loss: 5.345 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.751806259155273
Epoch: 14, Steps: 17 | Train Loss: 0.299 Vali Loss: 7.851 Vali Acc: 0.751 Test Loss: 7.851 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.761560916900635
Epoch: 15, Steps: 17 | Train Loss: 1.123 Vali Loss: 6.417 Vali Acc: 0.671 Test Loss: 6.417 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.747912168502808
Epoch: 16, Steps: 17 | Train Loss: 1.521 Vali Loss: 5.288 Vali Acc: 0.763 Test Loss: 5.288 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.745577335357666
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 7.165 Vali Acc: 0.740 Test Loss: 7.165 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.749072551727295
Epoch: 18, Steps: 17 | Train Loss: 0.647 Vali Loss: 11.015 Vali Acc: 0.699 Test Loss: 11.015 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.758292436599731
Epoch: 19, Steps: 17 | Train Loss: 0.559 Vali Loss: 7.953 Vali Acc: 0.821 Test Loss: 7.953 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.745487928390503
Epoch: 20, Steps: 17 | Train Loss: 0.092 Vali Loss: 10.142 Vali Acc: 0.786 Test Loss: 10.142 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.748235940933228
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 8.578 Vali Acc: 0.815 Test Loss: 8.578 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.733530521392822
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 13.531 Vali Acc: 0.751 Test Loss: 13.531 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1838750983
model size : 7017.61MB
2025-04-27 20:29:27.145891: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:29:27.163817: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745785767.185743   41185 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745785767.192421   41185 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:29:27.214170: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.839375972747803
Epoch: 1, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.055 Vali Acc: 0.705 Test Loss: 1.055 Test Acc: 0.705
Validation loss decreased (inf --> -0.705192).  Saving model ...
Epoch: 2 cost time: 10.715810775756836
Epoch: 2, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.606 Vali Acc: 0.780 Test Loss: 0.606 Test Acc: 0.780
Validation loss decreased (-0.705192 --> -0.780341).  Saving model ...
Epoch: 3 cost time: 10.728310823440552
Epoch: 3, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.490 Vali Acc: 0.711 Test Loss: 1.490 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.684045791625977
Epoch: 4, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.707 Vali Acc: 0.653 Test Loss: 2.707 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.663145780563354
Epoch: 5, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.987 Vali Acc: 0.792 Test Loss: 0.987 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791898).  Saving model ...
Epoch: 6 cost time: 10.717298984527588
Epoch: 6, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.524 Vali Acc: 0.740 Test Loss: 1.524 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.658055782318115
Epoch: 7, Steps: 17 | Train Loss: 0.291 Vali Loss: 3.069 Vali Acc: 0.665 Test Loss: 3.069 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.656198024749756
Epoch: 8, Steps: 17 | Train Loss: 0.199 Vali Loss: 2.394 Vali Acc: 0.723 Test Loss: 2.394 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.654322147369385
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.346 Vali Acc: 0.717 Test Loss: 2.346 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.67002534866333
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 5.026 Vali Acc: 0.717 Test Loss: 5.026 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.756643772125244
Epoch: 11, Steps: 17 | Train Loss: 0.372 Vali Loss: 5.445 Vali Acc: 0.740 Test Loss: 5.445 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.728614091873169
Epoch: 12, Steps: 17 | Train Loss: 0.610 Vali Loss: 3.803 Vali Acc: 0.751 Test Loss: 3.803 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.700740575790405
Epoch: 13, Steps: 17 | Train Loss: 0.134 Vali Loss: 5.991 Vali Acc: 0.763 Test Loss: 5.991 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.703648805618286
Epoch: 14, Steps: 17 | Train Loss: 0.309 Vali Loss: 7.944 Vali Acc: 0.699 Test Loss: 7.944 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.716312408447266
Epoch: 15, Steps: 17 | Train Loss: 1.063 Vali Loss: 8.802 Vali Acc: 0.647 Test Loss: 8.802 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 1837888359
model size : 7014.32MB
2025-04-27 20:34:56.600873: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:34:56.618953: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745786096.640663   50026 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745786096.647320   50026 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:34:56.669231: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.57579493522644
Epoch: 1, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.006 Vali Acc: 0.566 Test Loss: 1.006 Test Acc: 0.566
Validation loss decreased (inf --> -0.566464).  Saving model ...
Epoch: 2 cost time: 10.41167402267456
Epoch: 2, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.644 Vali Acc: 0.780 Test Loss: 0.644 Test Acc: 0.780
Validation loss decreased (-0.566464 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 10.438560962677002
Epoch: 3, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.121 Vali Acc: 0.780 Test Loss: 1.121 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.368157148361206
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.243 Vali Acc: 0.803 Test Loss: 1.243 Test Acc: 0.803
Validation loss decreased (-0.780340 --> -0.803456).  Saving model ...
Epoch: 5 cost time: 10.444318532943726
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.223 Vali Acc: 0.815 Test Loss: 1.223 Test Acc: 0.815
Validation loss decreased (-0.803456 --> -0.815017).  Saving model ...
Epoch: 6 cost time: 10.420301914215088
Epoch: 6, Steps: 17 | Train Loss: 0.205 Vali Loss: 2.270 Vali Acc: 0.775 Test Loss: 2.270 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.382745504379272
Epoch: 7, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.605 Vali Acc: 0.763 Test Loss: 1.605 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.379803657531738
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 2.683 Vali Acc: 0.711 Test Loss: 2.683 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.368565559387207
Epoch: 9, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.887 Vali Acc: 0.809 Test Loss: 1.887 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.383439064025879
Epoch: 10, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.664 Vali Acc: 0.618 Test Loss: 3.664 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.392770767211914
Epoch: 11, Steps: 17 | Train Loss: 0.134 Vali Loss: 6.110 Vali Acc: 0.595 Test Loss: 6.110 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.356797933578491
Epoch: 12, Steps: 17 | Train Loss: 0.370 Vali Loss: 5.066 Vali Acc: 0.792 Test Loss: 5.066 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.390931844711304
Epoch: 13, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.756 Vali Acc: 0.861 Test Loss: 1.756 Test Acc: 0.861
Validation loss decreased (-0.815017 --> -0.861254).  Saving model ...
Epoch: 14 cost time: 10.44543170928955
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 4.364 Vali Acc: 0.705 Test Loss: 4.364 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.372087955474854
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 5.685 Vali Acc: 0.769 Test Loss: 5.685 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.383801698684692
Epoch: 16, Steps: 17 | Train Loss: 0.243 Vali Loss: 10.279 Vali Acc: 0.728 Test Loss: 10.279 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.378204345703125
Epoch: 17, Steps: 17 | Train Loss: 0.686 Vali Loss: 4.365 Vali Acc: 0.757 Test Loss: 4.365 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.376530885696411
Epoch: 18, Steps: 17 | Train Loss: 0.774 Vali Loss: 5.674 Vali Acc: 0.751 Test Loss: 5.674 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.379456996917725
Epoch: 19, Steps: 17 | Train Loss: 0.488 Vali Loss: 7.118 Vali Acc: 0.751 Test Loss: 7.118 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.379331827163696
Epoch: 20, Steps: 17 | Train Loss: 0.370 Vali Loss: 4.902 Vali Acc: 0.775 Test Loss: 4.902 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.381400346755981
Epoch: 21, Steps: 17 | Train Loss: 0.252 Vali Loss: 7.357 Vali Acc: 0.723 Test Loss: 7.357 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.372459173202515
Epoch: 22, Steps: 17 | Train Loss: 0.105 Vali Loss: 11.446 Vali Acc: 0.653 Test Loss: 11.446 Test Acc: 0.653
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 10.384896993637085
Epoch: 23, Steps: 17 | Train Loss: 0.141 Vali Loss: 7.274 Vali Acc: 0.763 Test Loss: 7.274 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1837025735
model size : 7011.03MB
2025-04-27 20:43:08.023337: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:43:08.041332: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745786588.062850   63371 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745786588.069417   63371 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:43:08.091051: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.353445529937744
Epoch: 1, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.053 Vali Acc: 0.671 Test Loss: 1.053 Test Acc: 0.671
Validation loss decreased (inf --> -0.670510).  Saving model ...
Epoch: 2 cost time: 10.207650661468506
Epoch: 2, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
Validation loss decreased (-0.670510 --> -0.809243).  Saving model ...
Epoch: 3 cost time: 10.305234670639038
Epoch: 3, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.105 Vali Acc: 0.723 Test Loss: 1.105 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.160398483276367
Epoch: 4, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.029 Vali Acc: 0.740 Test Loss: 1.029 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.195841312408447
Epoch: 5, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.891 Vali Acc: 0.798 Test Loss: 0.891 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.290389776229858
Epoch: 6, Steps: 17 | Train Loss: 0.154 Vali Loss: 3.089 Vali Acc: 0.653 Test Loss: 3.089 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.28249740600586
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.210 Vali Acc: 0.769 Test Loss: 1.210 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.28422236442566
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.934 Vali Acc: 0.821 Test Loss: 0.934 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820800).  Saving model ...
Epoch: 9 cost time: 10.186177730560303
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.546 Vali Acc: 0.763 Test Loss: 2.546 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.162757635116577
Epoch: 10, Steps: 17 | Train Loss: 0.057 Vali Loss: 2.321 Vali Acc: 0.775 Test Loss: 2.321 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.143904685974121
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.587 Vali Acc: 0.711 Test Loss: 2.587 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.139643907546997
Epoch: 12, Steps: 17 | Train Loss: 0.386 Vali Loss: 5.551 Vali Acc: 0.757 Test Loss: 5.551 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 10.133265018463135
Epoch: 13, Steps: 17 | Train Loss: 0.821 Vali Loss: 3.669 Vali Acc: 0.769 Test Loss: 3.669 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 10.137380838394165
Epoch: 14, Steps: 17 | Train Loss: 0.151 Vali Loss: 2.756 Vali Acc: 0.809 Test Loss: 2.756 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.140129089355469
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.307 Vali Acc: 0.827 Test Loss: 2.307 Test Acc: 0.827
Validation loss decreased (-0.820800 --> -0.826567).  Saving model ...
Epoch: 16 cost time: 10.193650960922241
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 6.523 Vali Acc: 0.728 Test Loss: 6.523 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 10.157992124557495
Epoch: 17, Steps: 17 | Train Loss: 0.117 Vali Loss: 2.486 Vali Acc: 0.803 Test Loss: 2.486 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.13747239112854
Epoch: 18, Steps: 17 | Train Loss: 0.318 Vali Loss: 2.821 Vali Acc: 0.798 Test Loss: 2.821 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.159831047058105
Epoch: 19, Steps: 17 | Train Loss: 0.447 Vali Loss: 4.371 Vali Acc: 0.757 Test Loss: 4.371 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.135002851486206
Epoch: 20, Steps: 17 | Train Loss: 0.139 Vali Loss: 3.569 Vali Acc: 0.775 Test Loss: 3.569 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.140202045440674
Epoch: 21, Steps: 17 | Train Loss: 0.493 Vali Loss: 3.712 Vali Acc: 0.821 Test Loss: 3.712 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 10.137932777404785
Epoch: 22, Steps: 17 | Train Loss: 0.769 Vali Loss: 3.362 Vali Acc: 0.751 Test Loss: 3.362 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.160266160964966
Epoch: 23, Steps: 17 | Train Loss: 0.454 Vali Loss: 5.804 Vali Acc: 0.734 Test Loss: 5.804 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 10.144994974136353
Epoch: 24, Steps: 17 | Train Loss: 0.661 Vali Loss: 5.456 Vali Acc: 0.780 Test Loss: 5.456 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 10.155150890350342
Epoch: 25, Steps: 17 | Train Loss: 0.431 Vali Loss: 7.266 Vali Acc: 0.682 Test Loss: 7.266 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1836163111
model size : 7007.74MB
2025-04-27 20:51:25.725075: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:51:25.745290: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745787085.768304   77638 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745787085.775138   77638 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:51:25.797780: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.71714472770691
Epoch: 1, Steps: 17 | Train Loss: 2.153 Vali Loss: 0.841 Vali Acc: 0.734 Test Loss: 0.841 Test Acc: 0.734
Validation loss decreased (inf --> -0.734096).  Saving model ...
Epoch: 2 cost time: 13.372208595275879
Epoch: 2, Steps: 17 | Train Loss: 0.236 Vali Loss: 2.209 Vali Acc: 0.734 Test Loss: 2.209 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.335607528686523
Epoch: 3, Steps: 17 | Train Loss: 0.345 Vali Loss: 3.700 Vali Acc: 0.653 Test Loss: 3.700 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 13.319213390350342
Epoch: 4, Steps: 17 | Train Loss: 0.313 Vali Loss: 3.218 Vali Acc: 0.803 Test Loss: 3.218 Test Acc: 0.803
Validation loss decreased (-0.734096 --> -0.803436).  Saving model ...
Epoch: 5 cost time: 13.40971064567566
Epoch: 5, Steps: 17 | Train Loss: 0.215 Vali Loss: 3.421 Vali Acc: 0.798 Test Loss: 3.421 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.328856945037842
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.905 Vali Acc: 0.746 Test Loss: 2.905 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.337855100631714
Epoch: 7, Steps: 17 | Train Loss: 0.282 Vali Loss: 6.664 Vali Acc: 0.595 Test Loss: 6.664 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.332631349563599
Epoch: 8, Steps: 17 | Train Loss: 0.559 Vali Loss: 5.786 Vali Acc: 0.717 Test Loss: 5.786 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 13.327296257019043
Epoch: 9, Steps: 17 | Train Loss: 0.279 Vali Loss: 8.875 Vali Acc: 0.665 Test Loss: 8.875 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 13.325591325759888
Epoch: 10, Steps: 17 | Train Loss: 0.180 Vali Loss: 6.221 Vali Acc: 0.723 Test Loss: 6.221 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 13.33400845527649
Epoch: 11, Steps: 17 | Train Loss: 0.193 Vali Loss: 5.441 Vali Acc: 0.757 Test Loss: 5.441 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 13.339868545532227
Epoch: 12, Steps: 17 | Train Loss: 0.288 Vali Loss: 8.425 Vali Acc: 0.688 Test Loss: 8.425 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 13.362821578979492
Epoch: 13, Steps: 17 | Train Loss: 0.059 Vali Loss: 10.242 Vali Acc: 0.723 Test Loss: 10.242 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 13.341689109802246
Epoch: 14, Steps: 17 | Train Loss: 0.430 Vali Loss: 13.198 Vali Acc: 0.676 Test Loss: 13.198 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1849104807
model size : 7057.11MB
2025-04-27 20:57:07.965572: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 20:57:07.983433: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745787428.004974   86161 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745787428.011486   86161 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 20:57:08.033073: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.645873785018921
Epoch: 1, Steps: 17 | Train Loss: 1.847 Vali Loss: 1.116 Vali Acc: 0.607 Test Loss: 1.116 Test Acc: 0.607
Validation loss decreased (inf --> -0.606925).  Saving model ...
Epoch: 2 cost time: 11.661038398742676
Epoch: 2, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.859 Vali Acc: 0.803 Test Loss: 0.859 Test Acc: 0.803
Validation loss decreased (-0.606925 --> -0.803460).  Saving model ...
Epoch: 3 cost time: 11.67576289176941
Epoch: 3, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.956 Vali Acc: 0.798 Test Loss: 0.956 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.590348958969116
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 2.297 Vali Acc: 0.705 Test Loss: 2.297 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.613378286361694
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 1.630 Vali Acc: 0.751 Test Loss: 1.630 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.598510503768921
Epoch: 6, Steps: 17 | Train Loss: 0.144 Vali Loss: 3.688 Vali Acc: 0.676 Test Loss: 3.688 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.590894222259521
Epoch: 7, Steps: 17 | Train Loss: 0.239 Vali Loss: 2.809 Vali Acc: 0.769 Test Loss: 2.809 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.603161573410034
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.833 Vali Acc: 0.728 Test Loss: 2.833 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.602262258529663
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 4.688 Vali Acc: 0.647 Test Loss: 4.688 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 11.600569009780884
Epoch: 10, Steps: 17 | Train Loss: 0.597 Vali Loss: 5.002 Vali Acc: 0.688 Test Loss: 5.002 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.597272157669067
Epoch: 11, Steps: 17 | Train Loss: 0.352 Vali Loss: 7.884 Vali Acc: 0.676 Test Loss: 7.884 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.614981651306152
Epoch: 12, Steps: 17 | Train Loss: 0.507 Vali Loss: 6.419 Vali Acc: 0.740 Test Loss: 6.419 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1841339303
model size : 7027.48MB
2025-04-27 21:01:44.683503: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:01:44.702228: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745787704.724484   93367 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745787704.731460   93367 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:01:44.754437: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.173995018005371
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 0.778 Vali Acc: 0.699 Test Loss: 0.778 Test Acc: 0.699
Validation loss decreased (inf --> -0.699414).  Saving model ...
Epoch: 2 cost time: 11.036723375320435
Epoch: 2, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.991 Vali Acc: 0.751 Test Loss: 0.991 Test Acc: 0.751
Validation loss decreased (-0.699414 --> -0.751435).  Saving model ...
Epoch: 3 cost time: 11.033709526062012
Epoch: 3, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.258 Vali Acc: 0.763 Test Loss: 1.258 Test Acc: 0.763
Validation loss decreased (-0.751435 --> -0.762993).  Saving model ...
Epoch: 4 cost time: 11.027525186538696
Epoch: 4, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.819 Vali Acc: 0.803 Test Loss: 0.819 Test Acc: 0.803
Validation loss decreased (-0.762993 --> -0.803460).  Saving model ...
Epoch: 5 cost time: 11.038030862808228
Epoch: 5, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.853 Vali Acc: 0.803 Test Loss: 1.853 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.99841022491455
Epoch: 6, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.280 Vali Acc: 0.792 Test Loss: 1.280 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.994166612625122
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.873 Vali Acc: 0.769 Test Loss: 1.873 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.9892258644104
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.122 Vali Acc: 0.775 Test Loss: 2.122 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.986831188201904
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 3.610 Vali Acc: 0.723 Test Loss: 3.610 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.001057147979736
Epoch: 10, Steps: 17 | Train Loss: 0.372 Vali Loss: 3.210 Vali Acc: 0.734 Test Loss: 3.210 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.982532501220703
Epoch: 11, Steps: 17 | Train Loss: 0.537 Vali Loss: 6.092 Vali Acc: 0.763 Test Loss: 6.092 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.977216958999634
Epoch: 12, Steps: 17 | Train Loss: 1.173 Vali Loss: 7.398 Vali Acc: 0.717 Test Loss: 7.398 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.007368803024292
Epoch: 13, Steps: 17 | Train Loss: 0.836 Vali Loss: 4.208 Vali Acc: 0.751 Test Loss: 4.208 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.975317001342773
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 6.441 Vali Acc: 0.763 Test Loss: 6.441 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1838750855
model size : 7017.61MB
2025-04-27 21:07:24.428206: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:07:24.446525: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745788044.468426  101862 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745788044.475106  101862 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:07:24.497152: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.955528259277344
Epoch: 1, Steps: 17 | Train Loss: 1.394 Vali Loss: 0.817 Vali Acc: 0.699 Test Loss: 0.817 Test Acc: 0.699
Validation loss decreased (inf --> -0.699414).  Saving model ...
Epoch: 2 cost time: 10.826619863510132
Epoch: 2, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.689 Vali Acc: 0.728 Test Loss: 0.689 Test Acc: 0.728
Validation loss decreased (-0.699414 --> -0.728317).  Saving model ...
Epoch: 3 cost time: 10.810771465301514
Epoch: 3, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.409 Vali Acc: 0.728 Test Loss: 1.409 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.768732786178589
Epoch: 4, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.726 Vali Acc: 0.809 Test Loss: 0.726 Test Acc: 0.809
Validation loss decreased (-0.728317 --> -0.809241).  Saving model ...
Epoch: 5 cost time: 10.79396390914917
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.484 Vali Acc: 0.734 Test Loss: 2.484 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.753722429275513
Epoch: 6, Steps: 17 | Train Loss: 0.131 Vali Loss: 2.342 Vali Acc: 0.763 Test Loss: 2.342 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.747583866119385
Epoch: 7, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.709 Vali Acc: 0.775 Test Loss: 2.709 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.774470806121826
Epoch: 8, Steps: 17 | Train Loss: 0.450 Vali Loss: 4.021 Vali Acc: 0.728 Test Loss: 4.021 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.777490377426147
Epoch: 9, Steps: 17 | Train Loss: 0.240 Vali Loss: 3.357 Vali Acc: 0.647 Test Loss: 3.357 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.762328863143921
Epoch: 10, Steps: 17 | Train Loss: 0.672 Vali Loss: 3.629 Vali Acc: 0.728 Test Loss: 3.629 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.7510085105896
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.773 Vali Acc: 0.803 Test Loss: 1.773 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.766771793365479
Epoch: 12, Steps: 17 | Train Loss: 0.082 Vali Loss: 5.248 Vali Acc: 0.723 Test Loss: 5.248 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.754485368728638
Epoch: 13, Steps: 17 | Train Loss: 0.233 Vali Loss: 6.061 Vali Acc: 0.769 Test Loss: 6.061 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.77304196357727
Epoch: 14, Steps: 17 | Train Loss: 0.337 Vali Loss: 4.990 Vali Acc: 0.711 Test Loss: 4.990 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1837888135
model size : 7014.32MB
2025-04-27 21:12:45.292036: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:12:45.310542: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745788365.332984  110222 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745788365.339711  110222 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:12:45.361536: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.805530786514282
Epoch: 1, Steps: 17 | Train Loss: 1.565 Vali Loss: 0.933 Vali Acc: 0.630 Test Loss: 0.933 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 10.725416421890259
Epoch: 2, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.007 Vali Acc: 0.699 Test Loss: 1.007 Test Acc: 0.699
Validation loss decreased (-0.630048 --> -0.699412).  Saving model ...
Epoch: 3 cost time: 10.673795223236084
Epoch: 3, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.968 Vali Acc: 0.763 Test Loss: 0.968 Test Acc: 0.763
Validation loss decreased (-0.699412 --> -0.762996).  Saving model ...
Epoch: 4 cost time: 10.717039585113525
Epoch: 4, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.978 Vali Acc: 0.786 Test Loss: 0.978 Test Acc: 0.786
Validation loss decreased (-0.762996 --> -0.786117).  Saving model ...
Epoch: 5 cost time: 10.690633773803711
Epoch: 5, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.132 Vali Acc: 0.769 Test Loss: 2.132 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.653241872787476
Epoch: 6, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.750 Vali Acc: 0.751 Test Loss: 1.750 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.636765241622925
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 2.410 Vali Acc: 0.746 Test Loss: 2.410 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.659227848052979
Epoch: 8, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.950 Vali Acc: 0.751 Test Loss: 1.950 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.635436296463013
Epoch: 9, Steps: 17 | Train Loss: 0.188 Vali Loss: 2.853 Vali Acc: 0.751 Test Loss: 2.853 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.660338163375854
Epoch: 10, Steps: 17 | Train Loss: 1.117 Vali Loss: 4.335 Vali Acc: 0.740 Test Loss: 4.335 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.648881673812866
Epoch: 11, Steps: 17 | Train Loss: 0.436 Vali Loss: 4.160 Vali Acc: 0.751 Test Loss: 4.160 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.634241580963135
Epoch: 12, Steps: 17 | Train Loss: 0.350 Vali Loss: 2.907 Vali Acc: 0.780 Test Loss: 2.907 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.639833927154541
Epoch: 13, Steps: 17 | Train Loss: 0.410 Vali Loss: 5.129 Vali Acc: 0.740 Test Loss: 5.129 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.660367250442505
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 5.020 Vali Acc: 0.717 Test Loss: 5.020 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 1837025511
model size : 7011.03MB
2025-04-27 21:18:21.750991: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:18:21.769380: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745788701.791268  118695 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745788701.798257  118695 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:18:21.820572: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.623551368713379
Epoch: 1, Steps: 17 | Train Loss: 1.564 Vali Loss: 0.884 Vali Acc: 0.653 Test Loss: 0.884 Test Acc: 0.653
Validation loss decreased (inf --> -0.653170).  Saving model ...
Epoch: 2 cost time: 10.418461084365845
Epoch: 2, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
Validation loss decreased (-0.653170 --> -0.815023).  Saving model ...
Epoch: 3 cost time: 10.402646541595459
Epoch: 3, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.386835813522339
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.832 Test Loss: 0.751 Test Acc: 0.832
Validation loss decreased (-0.815023 --> -0.832362).  Saving model ...
Epoch: 5 cost time: 10.410288333892822
Epoch: 5, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.790 Vali Acc: 0.786 Test Loss: 0.790 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.359888315200806
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.757 Test Loss: 1.255 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.348031282424927
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.711 Test Loss: 1.751 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.352018356323242
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 2.540 Vali Acc: 0.694 Test Loss: 2.540 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.366459131240845
Epoch: 9, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.971 Vali Acc: 0.740 Test Loss: 1.971 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 10.390043497085571
Epoch: 10, Steps: 17 | Train Loss: 0.491 Vali Loss: 6.069 Vali Acc: 0.676 Test Loss: 6.069 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.34929633140564
Epoch: 11, Steps: 17 | Train Loss: 0.668 Vali Loss: 5.166 Vali Acc: 0.630 Test Loss: 5.166 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.334437370300293
Epoch: 12, Steps: 17 | Train Loss: 0.703 Vali Loss: 2.586 Vali Acc: 0.682 Test Loss: 2.586 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 10.358885288238525
Epoch: 13, Steps: 17 | Train Loss: 0.143 Vali Loss: 7.245 Vali Acc: 0.636 Test Loss: 7.245 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 10.348541021347046
Epoch: 14, Steps: 17 | Train Loss: 0.393 Vali Loss: 5.873 Vali Acc: 0.717 Test Loss: 5.873 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1836162887
model size : 7007.74MB
2025-04-27 21:23:31.243564: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:23:31.262431: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745789011.284639  127005 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745789011.291360  127005 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:23:31.314039: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.310096979141235
Epoch: 1, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.134 Vali Acc: 0.480 Test Loss: 1.134 Test Acc: 0.480
Validation loss decreased (inf --> -0.479757).  Saving model ...
Epoch: 2 cost time: 10.142997980117798
Epoch: 2, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.476 Vali Acc: 0.815 Test Loss: 0.476 Test Acc: 0.815
Validation loss decreased (-0.479757 --> -0.815024).  Saving model ...
Epoch: 3 cost time: 10.113728761672974
Epoch: 3, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.596 Vali Acc: 0.792 Test Loss: 0.596 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.060616970062256
Epoch: 4, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.406 Vali Acc: 0.682 Test Loss: 1.406 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.066585063934326
Epoch: 5, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.028 Vali Acc: 0.751 Test Loss: 1.028 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.083910703659058
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.659 Vali Acc: 0.775 Test Loss: 1.659 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.07081151008606
Epoch: 7, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.174 Vali Acc: 0.803 Test Loss: 1.174 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.06794261932373
Epoch: 8, Steps: 17 | Train Loss: 0.220 Vali Loss: 1.732 Vali Acc: 0.780 Test Loss: 1.732 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.062810897827148
Epoch: 9, Steps: 17 | Train Loss: 0.225 Vali Loss: 2.750 Vali Acc: 0.792 Test Loss: 2.750 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.067739725112915
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 4.061 Vali Acc: 0.671 Test Loss: 4.061 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.069688558578491
Epoch: 11, Steps: 17 | Train Loss: 0.446 Vali Loss: 3.370 Vali Acc: 0.728 Test Loss: 3.370 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.08607029914856
Epoch: 12, Steps: 17 | Train Loss: 0.311 Vali Loss: 5.144 Vali Acc: 0.705 Test Loss: 5.144 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1835300263
model size : 7004.45MB
2025-04-27 21:32:59.392736: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:32:59.411512: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745789579.434023  137633 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745789579.440865  137633 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:32:59.463230: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.898946046829224
Epoch: 1, Steps: 34 | Train Loss: 7.991 Vali Loss: 7.600 Vali Acc: 0.549 Test Loss: 7.600 Test Acc: 0.549
Validation loss decreased (inf --> -0.549057).  Saving model ...
Epoch: 2 cost time: 19.75097417831421
Epoch: 2, Steps: 34 | Train Loss: 2.806 Vali Loss: 3.694 Vali Acc: 0.728 Test Loss: 3.694 Test Acc: 0.728
Validation loss decreased (-0.549057 --> -0.728287).  Saving model ...
Epoch: 3 cost time: 19.742531538009644
Epoch: 3, Steps: 34 | Train Loss: 1.031 Vali Loss: 9.085 Vali Acc: 0.694 Test Loss: 9.085 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.718713760375977
Epoch: 4, Steps: 34 | Train Loss: 0.990 Vali Loss: 8.035 Vali Acc: 0.769 Test Loss: 8.035 Test Acc: 0.769
Validation loss decreased (-0.728287 --> -0.768706).  Saving model ...
Epoch: 5 cost time: 19.738828659057617
Epoch: 5, Steps: 34 | Train Loss: 0.804 Vali Loss: 8.339 Vali Acc: 0.723 Test Loss: 8.339 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.70341658592224
Epoch: 6, Steps: 34 | Train Loss: 0.805 Vali Loss: 9.344 Vali Acc: 0.671 Test Loss: 9.344 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 19.70173954963684
Epoch: 7, Steps: 34 | Train Loss: 0.944 Vali Loss: 11.351 Vali Acc: 0.740 Test Loss: 11.351 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.70275640487671
Epoch: 8, Steps: 34 | Train Loss: 2.668 Vali Loss: 16.407 Vali Acc: 0.699 Test Loss: 16.407 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.692768096923828
Epoch: 9, Steps: 34 | Train Loss: 1.718 Vali Loss: 10.886 Vali Acc: 0.775 Test Loss: 10.886 Test Acc: 0.775
Validation loss decreased (-0.768706 --> -0.774458).  Saving model ...
Epoch: 10 cost time: 19.73179841041565
Epoch: 10, Steps: 34 | Train Loss: 3.960 Vali Loss: 22.919 Vali Acc: 0.792 Test Loss: 22.919 Test Acc: 0.792
Validation loss decreased (-0.774458 --> -0.791678).  Saving model ...
Epoch: 11 cost time: 19.737054586410522
Epoch: 11, Steps: 34 | Train Loss: 1.096 Vali Loss: 57.422 Vali Acc: 0.624 Test Loss: 57.422 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.688756942749023
Epoch: 12, Steps: 34 | Train Loss: 3.990 Vali Loss: 81.752 Vali Acc: 0.699 Test Loss: 81.752 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.700202226638794
Epoch: 13, Steps: 34 | Train Loss: 1.896 Vali Loss: 58.406 Vali Acc: 0.711 Test Loss: 58.406 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.68751573562622
Epoch: 14, Steps: 34 | Train Loss: 2.192 Vali Loss: 46.751 Vali Acc: 0.751 Test Loss: 46.751 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 19.689456939697266
Epoch: 15, Steps: 34 | Train Loss: 3.137 Vali Loss: 54.162 Vali Acc: 0.775 Test Loss: 54.162 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 19.709107160568237
Epoch: 16, Steps: 34 | Train Loss: 4.753 Vali Loss: 37.208 Vali Acc: 0.792 Test Loss: 37.208 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 19.695945262908936
Epoch: 17, Steps: 34 | Train Loss: 2.074 Vali Loss: 63.966 Vali Acc: 0.798 Test Loss: 63.966 Test Acc: 0.798
Validation loss decreased (-0.791678 --> -0.797048).  Saving model ...
Epoch: 18 cost time: 19.724648237228394
Epoch: 18, Steps: 34 | Train Loss: 1.668 Vali Loss: 55.470 Vali Acc: 0.803 Test Loss: 55.470 Test Acc: 0.803
Validation loss decreased (-0.797048 --> -0.802914).  Saving model ...
Epoch: 19 cost time: 19.724289655685425
Epoch: 19, Steps: 34 | Train Loss: 3.971 Vali Loss: 42.821 Vali Acc: 0.798 Test Loss: 42.821 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 19.698623657226562
Epoch: 20, Steps: 34 | Train Loss: 0.141 Vali Loss: 147.671 Vali Acc: 0.555 Test Loss: 147.671 Test Acc: 0.555
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 19.73001503944397
Epoch: 21, Steps: 34 | Train Loss: 4.675 Vali Loss: 83.249 Vali Acc: 0.751 Test Loss: 83.249 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 19.706843614578247
Epoch: 22, Steps: 34 | Train Loss: 5.833 Vali Loss: 86.467 Vali Acc: 0.763 Test Loss: 86.467 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 19.69726037979126
Epoch: 23, Steps: 34 | Train Loss: 14.767 Vali Loss: 218.171 Vali Acc: 0.653 Test Loss: 218.171 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 19.710370779037476
Epoch: 24, Steps: 34 | Train Loss: 14.745 Vali Loss: 42.788 Vali Acc: 0.832 Test Loss: 42.788 Test Acc: 0.832
Validation loss decreased (-0.802914 --> -0.831942).  Saving model ...
Epoch: 25 cost time: 19.717911958694458
Epoch: 25, Steps: 34 | Train Loss: 9.856 Vali Loss: 152.040 Vali Acc: 0.734 Test Loss: 152.040 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 19.700380086898804
Epoch: 26, Steps: 34 | Train Loss: 1.153 Vali Loss: 197.912 Vali Acc: 0.798 Test Loss: 197.912 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 19.706445932388306
Epoch: 27, Steps: 34 | Train Loss: 6.742 Vali Loss: 146.664 Vali Acc: 0.769 Test Loss: 146.664 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 19.719695329666138
Epoch: 28, Steps: 34 | Train Loss: 2.694 Vali Loss: 178.834 Vali Acc: 0.740 Test Loss: 178.834 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 19.7002694606781
Epoch: 29, Steps: 34 | Train Loss: 3.413 Vali Loss: 200.537 Vali Acc: 0.803 Test Loss: 200.537 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 19.6872341632843
Epoch: 30, Steps: 34 | Train Loss: 2.225 Vali Loss: 217.219 Vali Acc: 0.723 Test Loss: 217.219 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 19.68362593650818
Epoch: 31, Steps: 34 | Train Loss: 8.023 Vali Loss: 112.457 Vali Acc: 0.798 Test Loss: 112.457 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 19.701302766799927
Epoch: 32, Steps: 34 | Train Loss: 0.000 Vali Loss: 123.521 Vali Acc: 0.780 Test Loss: 123.521 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 19.70529866218567
Epoch: 33, Steps: 34 | Train Loss: 0.322 Vali Loss: 102.395 Vali Acc: 0.809 Test Loss: 102.395 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 19.696301460266113
Epoch: 34, Steps: 34 | Train Loss: 1.305 Vali Loss: 124.708 Vali Acc: 0.780 Test Loss: 124.708 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1619213383
model size : 6179.66MB
2025-04-27 21:33:28.428493: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:33:28.445387: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745789608.466691  138037 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745789608.473279  138037 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:33:28.494705: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.358794927597046
Epoch: 1, Steps: 17 | Train Loss: 1.724 Vali Loss: 1.526 Vali Acc: 0.613 Test Loss: 1.526 Test Acc: 0.613
Validation loss decreased (inf --> -0.612702).  Saving model ...
Epoch: 2 cost time: 10.345874071121216
Epoch: 2, Steps: 17 | Train Loss: 0.760 Vali Loss: 3.900 Vali Acc: 0.613 Test Loss: 3.900 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.285613298416138
Epoch: 3, Steps: 17 | Train Loss: 0.657 Vali Loss: 2.281 Vali Acc: 0.728 Test Loss: 2.281 Test Acc: 0.728
Validation loss decreased (-0.612702 --> -0.728301).  Saving model ...
Epoch: 4 cost time: 10.319952249526978
Epoch: 4, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.640 Vali Acc: 0.769 Test Loss: 1.640 Test Acc: 0.769
Validation loss decreased (-0.728301 --> -0.768770).  Saving model ...
Epoch: 5 cost time: 10.301420211791992
Epoch: 5, Steps: 17 | Train Loss: 0.212 Vali Loss: 3.233 Vali Acc: 0.694 Test Loss: 3.233 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.297181129455566
Epoch: 6, Steps: 17 | Train Loss: 0.404 Vali Loss: 2.093 Vali Acc: 0.803 Test Loss: 2.093 Test Acc: 0.803
Validation loss decreased (-0.768770 --> -0.803447).  Saving model ...
Epoch: 7 cost time: 10.32606291770935
Epoch: 7, Steps: 17 | Train Loss: 0.181 Vali Loss: 5.209 Vali Acc: 0.723 Test Loss: 5.209 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.286872148513794
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 4.395 Vali Acc: 0.740 Test Loss: 4.395 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.282123804092407
Epoch: 9, Steps: 17 | Train Loss: 0.234 Vali Loss: 5.174 Vali Acc: 0.769 Test Loss: 5.174 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.286561727523804
Epoch: 10, Steps: 17 | Train Loss: 0.276 Vali Loss: 5.385 Vali Acc: 0.751 Test Loss: 5.385 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.276885509490967
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 6.143 Vali Acc: 0.740 Test Loss: 6.143 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.278801202774048
Epoch: 12, Steps: 17 | Train Loss: 0.281 Vali Loss: 9.191 Vali Acc: 0.775 Test Loss: 9.191 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.263575553894043
Epoch: 13, Steps: 17 | Train Loss: 0.425 Vali Loss: 5.367 Vali Acc: 0.775 Test Loss: 5.367 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.265682458877563
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 10.303 Vali Acc: 0.746 Test Loss: 10.303 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.273309230804443
Epoch: 15, Steps: 17 | Train Loss: 0.160 Vali Loss: 4.839 Vali Acc: 0.757 Test Loss: 4.839 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.286271810531616
Epoch: 16, Steps: 17 | Train Loss: 0.143 Vali Loss: 15.088 Vali Acc: 0.595 Test Loss: 15.088 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1603682375
model size : 6120.41MB
2025-04-27 21:39:10.685362: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:39:10.704196: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745789950.726506  147392 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745789950.733365  147392 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:39:10.755665: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.242039203643799
Epoch: 1, Steps: 17 | Train Loss: 1.626 Vali Loss: 2.314 Vali Acc: 0.509 Test Loss: 2.314 Test Acc: 0.509
Validation loss decreased (inf --> -0.508647).  Saving model ...
Epoch: 2 cost time: 10.124749898910522
Epoch: 2, Steps: 17 | Train Loss: 0.703 Vali Loss: 4.343 Vali Acc: 0.561 Test Loss: 4.343 Test Acc: 0.561
Validation loss decreased (-0.508647 --> -0.560650).  Saving model ...
Epoch: 3 cost time: 10.133681058883667
Epoch: 3, Steps: 17 | Train Loss: 0.528 Vali Loss: 2.056 Vali Acc: 0.682 Test Loss: 2.056 Test Acc: 0.682
Validation loss decreased (-0.560650 --> -0.682060).  Saving model ...
Epoch: 4 cost time: 10.132566928863525
Epoch: 4, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.188 Vali Acc: 0.751 Test Loss: 2.188 Test Acc: 0.751
Validation loss decreased (-0.682060 --> -0.751423).  Saving model ...
Epoch: 5 cost time: 10.133169174194336
Epoch: 5, Steps: 17 | Train Loss: 0.127 Vali Loss: 2.038 Vali Acc: 0.740 Test Loss: 2.038 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.071768045425415
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.767 Vali Acc: 0.827 Test Loss: 1.767 Test Acc: 0.827
Validation loss decreased (-0.751423 --> -0.826572).  Saving model ...
Epoch: 7 cost time: 10.108583688735962
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.577 Vali Acc: 0.751 Test Loss: 2.577 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.049265623092651
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 2.900 Vali Acc: 0.769 Test Loss: 2.900 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.069669485092163
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.651 Vali Acc: 0.815 Test Loss: 1.651 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.047569751739502
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.484 Vali Acc: 0.746 Test Loss: 2.484 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.086936950683594
Epoch: 11, Steps: 17 | Train Loss: 0.161 Vali Loss: 3.557 Vali Acc: 0.757 Test Loss: 3.557 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.0669105052948
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.772 Vali Acc: 0.769 Test Loss: 2.772 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 10.049330711364746
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 9.430 Vali Acc: 0.671 Test Loss: 9.430 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.070310354232788
Epoch: 14, Steps: 17 | Train Loss: 0.429 Vali Loss: 9.015 Vali Acc: 0.740 Test Loss: 9.015 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.05946660041809
Epoch: 15, Steps: 17 | Train Loss: 0.366 Vali Loss: 8.042 Vali Acc: 0.786 Test Loss: 8.042 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.095328330993652
Epoch: 16, Steps: 17 | Train Loss: 0.181 Vali Loss: 8.806 Vali Acc: 0.792 Test Loss: 8.806 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1598505479
model size : 6100.66MB
2025-04-27 21:45:12.006865: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:45:12.025622: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745790312.047535  156888 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745790312.054200  156888 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:45:12.076460: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.903580904006958
Epoch: 1, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.066 Vali Acc: 0.624 Test Loss: 1.066 Test Acc: 0.624
Validation loss decreased (inf --> -0.624267).  Saving model ...
Epoch: 2 cost time: 9.764723539352417
Epoch: 2, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.603 Vali Acc: 0.740 Test Loss: 1.603 Test Acc: 0.740
Validation loss decreased (-0.624267 --> -0.739868).  Saving model ...
Epoch: 3 cost time: 9.761009216308594
Epoch: 3, Steps: 17 | Train Loss: 0.437 Vali Loss: 1.788 Vali Acc: 0.746 Test Loss: 1.788 Test Acc: 0.746
Validation loss decreased (-0.739868 --> -0.745647).  Saving model ...
Epoch: 4 cost time: 9.726848840713501
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 2.451 Vali Acc: 0.728 Test Loss: 2.451 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.73064374923706
Epoch: 5, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.457 Vali Acc: 0.763 Test Loss: 1.457 Test Acc: 0.763
Validation loss decreased (-0.745647 --> -0.762991).  Saving model ...
Epoch: 6 cost time: 9.777099132537842
Epoch: 6, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.562 Vali Acc: 0.757 Test Loss: 2.562 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.71539568901062
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.877 Vali Acc: 0.723 Test Loss: 2.877 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.709968566894531
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.240 Vali Acc: 0.757 Test Loss: 2.240 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.7101149559021
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 2.262 Vali Acc: 0.740 Test Loss: 2.262 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.725546598434448
Epoch: 10, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.761 Vali Acc: 0.780 Test Loss: 2.761 Test Acc: 0.780
Validation loss decreased (-0.762991 --> -0.780319).  Saving model ...
Epoch: 11 cost time: 9.775731325149536
Epoch: 11, Steps: 17 | Train Loss: 0.083 Vali Loss: 2.788 Vali Acc: 0.717 Test Loss: 2.788 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.705232620239258
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 8.938 Vali Acc: 0.642 Test Loss: 8.938 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.687654972076416
Epoch: 13, Steps: 17 | Train Loss: 1.719 Vali Loss: 9.886 Vali Acc: 0.543 Test Loss: 9.886 Test Acc: 0.543
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.721827268600464
Epoch: 14, Steps: 17 | Train Loss: 0.782 Vali Loss: 5.841 Vali Acc: 0.746 Test Loss: 5.841 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.722587585449219
Epoch: 15, Steps: 17 | Train Loss: 0.448 Vali Loss: 10.246 Vali Acc: 0.671 Test Loss: 10.246 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.70700478553772
Epoch: 16, Steps: 17 | Train Loss: 0.613 Vali Loss: 8.788 Vali Acc: 0.636 Test Loss: 8.788 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.699007272720337
Epoch: 17, Steps: 17 | Train Loss: 0.377 Vali Loss: 9.475 Vali Acc: 0.682 Test Loss: 9.475 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.707588911056519
Epoch: 18, Steps: 17 | Train Loss: 0.219 Vali Loss: 13.190 Vali Acc: 0.659 Test Loss: 13.190 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.703078031539917
Epoch: 19, Steps: 17 | Train Loss: 0.680 Vali Loss: 12.117 Vali Acc: 0.671 Test Loss: 12.117 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.705618381500244
Epoch: 20, Steps: 17 | Train Loss: 1.152 Vali Loss: 11.168 Vali Acc: 0.734 Test Loss: 11.168 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1595917191
model size : 6090.79MB
2025-04-27 21:51:58.841503: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:51:58.860890: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745790718.883411  168379 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745790718.890323  168379 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:51:58.912956: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.67248272895813
Epoch: 1, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.554 Vali Acc: 0.566 Test Loss: 1.554 Test Acc: 0.566
Validation loss decreased (inf --> -0.566458).  Saving model ...
Epoch: 2 cost time: 9.634069204330444
Epoch: 2, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.713 Vali Acc: 0.803 Test Loss: 0.713 Test Acc: 0.803
Validation loss decreased (-0.566458 --> -0.803461).  Saving model ...
Epoch: 3 cost time: 9.64738655090332
Epoch: 3, Steps: 17 | Train Loss: 0.249 Vali Loss: 2.123 Vali Acc: 0.723 Test Loss: 2.123 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.611310005187988
Epoch: 4, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.455 Vali Acc: 0.746 Test Loss: 1.455 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.591073036193848
Epoch: 5, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.586 Vali Acc: 0.786 Test Loss: 1.586 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.599849700927734
Epoch: 6, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.561 Vali Acc: 0.786 Test Loss: 1.561 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.589810132980347
Epoch: 7, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.790 Vali Acc: 0.780 Test Loss: 1.790 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.591305494308472
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 3.749 Vali Acc: 0.711 Test Loss: 3.749 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.579322814941406
Epoch: 9, Steps: 17 | Train Loss: 0.498 Vali Loss: 2.643 Vali Acc: 0.757 Test Loss: 2.643 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.58614993095398
Epoch: 10, Steps: 17 | Train Loss: 0.227 Vali Loss: 2.778 Vali Acc: 0.763 Test Loss: 2.778 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.579054594039917
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 4.911 Vali Acc: 0.711 Test Loss: 4.911 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.575982809066772
Epoch: 12, Steps: 17 | Train Loss: 0.020 Vali Loss: 3.885 Vali Acc: 0.780 Test Loss: 3.885 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1594191943
model size : 6084.21MB
2025-04-27 21:55:58.164534: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 21:55:58.183191: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745790958.205068  175231 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745790958.211879  175231 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 21:55:58.234099: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.497508525848389
Epoch: 1, Steps: 17 | Train Loss: 1.465 Vali Loss: 0.949 Vali Acc: 0.584 Test Loss: 0.949 Test Acc: 0.584
Validation loss decreased (inf --> -0.583806).  Saving model ...
Epoch: 2 cost time: 9.225866317749023
Epoch: 2, Steps: 17 | Train Loss: 0.234 Vali Loss: 1.033 Vali Acc: 0.769 Test Loss: 1.033 Test Acc: 0.769
Validation loss decreased (-0.583806 --> -0.768776).  Saving model ...
Epoch: 3 cost time: 9.228287696838379
Epoch: 3, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.933 Vali Acc: 0.751 Test Loss: 1.933 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.135963916778564
Epoch: 4, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.560 Vali Acc: 0.751 Test Loss: 1.560 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.131323337554932
Epoch: 5, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.849 Vali Acc: 0.809 Test Loss: 0.849 Test Acc: 0.809
Validation loss decreased (-0.768776 --> -0.809240).  Saving model ...
Epoch: 6 cost time: 9.181396245956421
Epoch: 6, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.772 Vali Acc: 0.769 Test Loss: 1.772 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.144986867904663
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.409 Vali Acc: 0.803 Test Loss: 1.409 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.14307689666748
Epoch: 8, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.433 Vali Acc: 0.809 Test Loss: 1.433 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.15666913986206
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.389 Vali Acc: 0.803 Test Loss: 1.389 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.139652013778687
Epoch: 10, Steps: 17 | Train Loss: 0.113 Vali Loss: 5.883 Vali Acc: 0.671 Test Loss: 5.883 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.128323793411255
Epoch: 11, Steps: 17 | Train Loss: 0.387 Vali Loss: 6.167 Vali Acc: 0.671 Test Loss: 6.167 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.140841007232666
Epoch: 12, Steps: 17 | Train Loss: 0.887 Vali Loss: 1.901 Vali Acc: 0.832 Test Loss: 1.901 Test Acc: 0.832
Validation loss decreased (-0.809240 --> -0.832351).  Saving model ...
Epoch: 13 cost time: 9.190967082977295
Epoch: 13, Steps: 17 | Train Loss: 0.664 Vali Loss: 5.189 Vali Acc: 0.717 Test Loss: 5.189 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.145187854766846
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 3.666 Vali Acc: 0.786 Test Loss: 3.666 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.147687911987305
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 5.125 Vali Acc: 0.763 Test Loss: 5.125 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.143067836761475
Epoch: 16, Steps: 17 | Train Loss: 0.541 Vali Loss: 7.374 Vali Acc: 0.642 Test Loss: 7.374 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.140135765075684
Epoch: 17, Steps: 17 | Train Loss: 0.380 Vali Loss: 4.658 Vali Acc: 0.769 Test Loss: 4.658 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.125607967376709
Epoch: 18, Steps: 17 | Train Loss: 0.454 Vali Loss: 5.242 Vali Acc: 0.734 Test Loss: 5.242 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.150383710861206
Epoch: 19, Steps: 17 | Train Loss: 0.645 Vali Loss: 6.683 Vali Acc: 0.803 Test Loss: 6.683 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.15877914428711
Epoch: 20, Steps: 17 | Train Loss: 0.147 Vali Loss: 7.335 Vali Acc: 0.769 Test Loss: 7.335 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.141008615493774
Epoch: 21, Steps: 17 | Train Loss: 0.371 Vali Loss: 4.627 Vali Acc: 0.775 Test Loss: 4.627 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.132385730743408
Epoch: 22, Steps: 17 | Train Loss: 0.054 Vali Loss: 4.738 Vali Acc: 0.815 Test Loss: 4.738 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1592466695
model size : 6077.63MB
2025-04-27 22:02:33.911039: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 22:02:33.929902: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745791353.951789  187371 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745791353.958541  187371 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 22:02:33.980735: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.181307315826416
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.205 Vali Acc: 0.601 Test Loss: 1.205 Test Acc: 0.601
Validation loss decreased (inf --> -0.601144).  Saving model ...
Epoch: 2 cost time: 9.017531394958496
Epoch: 2, Steps: 17 | Train Loss: 0.301 Vali Loss: 1.053 Vali Acc: 0.746 Test Loss: 1.053 Test Acc: 0.746
Validation loss decreased (-0.601144 --> -0.745654).  Saving model ...
Epoch: 3 cost time: 8.995419979095459
Epoch: 3, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.193 Vali Acc: 0.757 Test Loss: 1.193 Test Acc: 0.757
Validation loss decreased (-0.745654 --> -0.757214).  Saving model ...
Epoch: 4 cost time: 8.997979640960693
Epoch: 4, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.631 Vali Acc: 0.827 Test Loss: 0.631 Test Acc: 0.827
Validation loss decreased (-0.757214 --> -0.826583).  Saving model ...
Epoch: 5 cost time: 9.00112795829773
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.688 Vali Acc: 0.723 Test Loss: 1.688 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.933356523513794
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.225 Vali Acc: 0.746 Test Loss: 1.225 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.94820785522461
Epoch: 7, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.725 Vali Acc: 0.757 Test Loss: 1.725 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.956940174102783
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.925 Vali Acc: 0.769 Test Loss: 1.925 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.950699806213379
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.826 Vali Acc: 0.769 Test Loss: 2.826 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.95826244354248
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.773 Vali Acc: 0.803 Test Loss: 1.773 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.947360277175903
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.866 Vali Acc: 0.780 Test Loss: 1.866 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.932163953781128
Epoch: 12, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.943 Vali Acc: 0.780 Test Loss: 2.943 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.93519401550293
Epoch: 13, Steps: 17 | Train Loss: 0.204 Vali Loss: 3.265 Vali Acc: 0.694 Test Loss: 3.265 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.948320865631104
Epoch: 14, Steps: 17 | Train Loss: 0.136 Vali Loss: 7.588 Vali Acc: 0.647 Test Loss: 7.588 Test Acc: 0.647
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1591604295
model size : 6074.34MB
2025-04-27 22:07:18.789002: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-27 22:07:18.807862: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745791638.829851  195392 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745791638.836557  195392 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-27 22:07:18.858763: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.500080108642578
Epoch: 1, Steps: 17 | Train Loss: 1.981 Vali Loss: 2.672 Vali Acc: 0.630 Test Loss: 2.672 Test Acc: 0.630
Validation loss decreased (inf --> -0.630031).  Saving model ...
Epoch: 2 cost time: 7.389746904373169
Epoch: 2, Steps: 17 | Train Loss: 1.110 Vali Loss: 3.560 Vali Acc: 0.659 Test Loss: 3.560 Test Acc: 0.659
Validation loss decreased (-0.630031 --> -0.658924).  Saving model ...
Epoch: 3 cost time: 7.419662237167358
Epoch: 3, Steps: 17 | Train Loss: 0.885 Vali Loss: 6.963 Vali Acc: 0.561 Test Loss: 6.963 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.371717929840088
Epoch: 4, Steps: 17 | Train Loss: 1.198 Vali Loss: 5.823 Vali Acc: 0.636 Test Loss: 5.823 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.36247444152832
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 2.898 Vali Acc: 0.728 Test Loss: 2.898 Test Acc: 0.728
Validation loss decreased (-0.658924 --> -0.728295).  Saving model ...
Epoch: 6 cost time: 7.39734959602356
Epoch: 6, Steps: 17 | Train Loss: 0.110 Vali Loss: 5.672 Vali Acc: 0.676 Test Loss: 5.672 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.371361970901489
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 4.697 Vali Acc: 0.711 Test Loss: 4.697 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.383100748062134
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 5.747 Vali Acc: 0.647 Test Loss: 5.747 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.359841346740723
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.197 Vali Acc: 0.815 Test Loss: 2.197 Test Acc: 0.815
Validation loss decreased (-0.728295 --> -0.815007).  Saving model ...
Epoch: 10 cost time: 7.39336633682251
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 7.191 Vali Acc: 0.665 Test Loss: 7.191 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.36620306968689
Epoch: 11, Steps: 17 | Train Loss: 0.295 Vali Loss: 8.442 Vali Acc: 0.740 Test Loss: 8.442 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.365079402923584
Epoch: 12, Steps: 17 | Train Loss: 0.466 Vali Loss: 9.760 Vali Acc: 0.676 Test Loss: 9.760 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.382862091064453
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 3.876 Vali Acc: 0.780 Test Loss: 3.876 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.387050151824951
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 6.142 Vali Acc: 0.688 Test Loss: 6.142 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.392382860183716
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 10.469 Vali Acc: 0.682 Test Loss: 10.469 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.379390478134155
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 8.754 Vali Acc: 0.705 Test Loss: 8.754 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.367501497268677
Epoch: 17, Steps: 17 | Train Loss: 0.112 Vali Loss: 10.926 Vali Acc: 0.699 Test Loss: 10.926 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.352570295333862
Epoch: 18, Steps: 17 | Train Loss: 0.197 Vali Loss: 8.077 Vali Acc: 0.734 Test Loss: 8.077 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.347722291946411
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 5.249 Vali Acc: 0.780 Test Loss: 5.249 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 770158119
model size : 2939.36MB
2025-04-28 01:58:47.386562: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 01:58:47.405451: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745805527.428015   35846 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745805527.435139   35846 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 01:58:47.457522: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.801974534988403
Epoch: 1, Steps: 17 | Train Loss: 1.923 Vali Loss: 1.165 Vali Acc: 0.636 Test Loss: 1.165 Test Acc: 0.636
Validation loss decreased (inf --> -0.635826).  Saving model ...
Epoch: 2 cost time: 5.723883628845215
Epoch: 2, Steps: 17 | Train Loss: 0.310 Vali Loss: 1.147 Vali Acc: 0.734 Test Loss: 1.147 Test Acc: 0.734
Validation loss decreased (-0.635826 --> -0.734093).  Saving model ...
Epoch: 3 cost time: 5.69534969329834
Epoch: 3, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.824 Vali Acc: 0.636 Test Loss: 2.824 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.657917261123657
Epoch: 4, Steps: 17 | Train Loss: 0.480 Vali Loss: 3.690 Vali Acc: 0.590 Test Loss: 3.690 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.665770053863525
Epoch: 5, Steps: 17 | Train Loss: 0.449 Vali Loss: 2.959 Vali Acc: 0.711 Test Loss: 2.959 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.66064453125
Epoch: 6, Steps: 17 | Train Loss: 0.185 Vali Loss: 2.026 Vali Acc: 0.769 Test Loss: 2.026 Test Acc: 0.769
Validation loss decreased (-0.734093 --> -0.768766).  Saving model ...
Epoch: 7 cost time: 5.721675395965576
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.566 Vali Acc: 0.815 Test Loss: 2.566 Test Acc: 0.815
Validation loss decreased (-0.768766 --> -0.815003).  Saving model ...
Epoch: 8 cost time: 5.699267625808716
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.970 Vali Acc: 0.798 Test Loss: 1.970 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.68245792388916
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 3.002 Vali Acc: 0.757 Test Loss: 3.002 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.6660425662994385
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 3.533 Vali Acc: 0.775 Test Loss: 3.533 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.668402910232544
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.681 Vali Acc: 0.827 Test Loss: 2.681 Test Acc: 0.827
Validation loss decreased (-0.815003 --> -0.826563).  Saving model ...
Epoch: 12 cost time: 5.699469327926636
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 2.859 Vali Acc: 0.803 Test Loss: 2.859 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.679511070251465
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.870 Vali Acc: 0.723 Test Loss: 2.870 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.672425746917725
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 3.872 Vali Acc: 0.786 Test Loss: 3.872 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.672913312911987
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.560 Vali Acc: 0.827 Test Loss: 2.560 Test Acc: 0.827
Validation loss decreased (-0.826563 --> -0.826564).  Saving model ...
Epoch: 16 cost time: 5.710735321044922
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 4.022 Vali Acc: 0.751 Test Loss: 4.022 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.659312009811401
Epoch: 17, Steps: 17 | Train Loss: 0.596 Vali Loss: 7.233 Vali Acc: 0.723 Test Loss: 7.233 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.6718080043792725
Epoch: 18, Steps: 17 | Train Loss: 0.926 Vali Loss: 3.264 Vali Acc: 0.769 Test Loss: 3.264 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.6801066398620605
Epoch: 19, Steps: 17 | Train Loss: 0.171 Vali Loss: 11.378 Vali Acc: 0.688 Test Loss: 11.378 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.67297887802124
Epoch: 20, Steps: 17 | Train Loss: 0.465 Vali Loss: 9.610 Vali Acc: 0.723 Test Loss: 9.610 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.668412923812866
Epoch: 21, Steps: 17 | Train Loss: 0.393 Vali Loss: 12.381 Vali Acc: 0.740 Test Loss: 12.381 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.671776533126831
Epoch: 22, Steps: 17 | Train Loss: 0.347 Vali Loss: 9.728 Vali Acc: 0.746 Test Loss: 9.728 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.67087721824646
Epoch: 23, Steps: 17 | Train Loss: 0.402 Vali Loss: 11.817 Vali Acc: 0.682 Test Loss: 11.817 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.673708438873291
Epoch: 24, Steps: 17 | Train Loss: 0.058 Vali Loss: 15.129 Vali Acc: 0.671 Test Loss: 15.129 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.67664647102356
Epoch: 25, Steps: 17 | Train Loss: 0.062 Vali Loss: 17.756 Vali Acc: 0.740 Test Loss: 17.756 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 762392615
model size : 2909.73MB
2025-04-28 02:03:20.383992: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:03:20.402483: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745805800.425044   47655 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745805800.431913   47655 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:03:20.454519: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.525144338607788
Epoch: 1, Steps: 17 | Train Loss: 1.713 Vali Loss: 0.775 Vali Acc: 0.688 Test Loss: 0.775 Test Acc: 0.688
Validation loss decreased (inf --> -0.687854).  Saving model ...
Epoch: 2 cost time: 5.460269927978516
Epoch: 2, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.914 Vali Acc: 0.763 Test Loss: 0.914 Test Acc: 0.763
Validation loss decreased (-0.687854 --> -0.762997).  Saving model ...
Epoch: 3 cost time: 5.456110239028931
Epoch: 3, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.471 Vali Acc: 0.665 Test Loss: 1.471 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.437461853027344
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.566 Vali Acc: 0.757 Test Loss: 1.566 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.444307565689087
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.311 Vali Acc: 0.757 Test Loss: 1.311 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.459924697875977
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.393 Vali Acc: 0.792 Test Loss: 1.393 Test Acc: 0.792
Validation loss decreased (-0.762997 --> -0.791894).  Saving model ...
Epoch: 7 cost time: 5.475828409194946
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.438 Vali Acc: 0.786 Test Loss: 1.438 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.428391456604004
Epoch: 8, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.019 Vali Acc: 0.780 Test Loss: 1.019 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.42678689956665
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.175 Vali Acc: 0.803 Test Loss: 1.175 Test Acc: 0.803
Validation loss decreased (-0.791894 --> -0.803456).  Saving model ...
Epoch: 10 cost time: 5.451687335968018
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.765 Vali Acc: 0.717 Test Loss: 2.765 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.458219528198242
Epoch: 11, Steps: 17 | Train Loss: 0.141 Vali Loss: 2.561 Vali Acc: 0.723 Test Loss: 2.561 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.440565586090088
Epoch: 12, Steps: 17 | Train Loss: 0.223 Vali Loss: 4.142 Vali Acc: 0.717 Test Loss: 4.142 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.441478252410889
Epoch: 13, Steps: 17 | Train Loss: 0.076 Vali Loss: 3.201 Vali Acc: 0.705 Test Loss: 3.201 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.424124717712402
Epoch: 14, Steps: 17 | Train Loss: 0.286 Vali Loss: 2.280 Vali Acc: 0.780 Test Loss: 2.280 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.455325126647949
Epoch: 15, Steps: 17 | Train Loss: 0.567 Vali Loss: 4.324 Vali Acc: 0.705 Test Loss: 4.324 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.4399354457855225
Epoch: 16, Steps: 17 | Train Loss: 0.447 Vali Loss: 6.138 Vali Acc: 0.723 Test Loss: 6.138 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.451961040496826
Epoch: 17, Steps: 17 | Train Loss: 0.331 Vali Loss: 5.402 Vali Acc: 0.763 Test Loss: 5.402 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.434230804443359
Epoch: 18, Steps: 17 | Train Loss: 0.095 Vali Loss: 4.249 Vali Acc: 0.803 Test Loss: 4.249 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.434831380844116
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.613 Vali Acc: 0.786 Test Loss: 6.613 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 759804167
model size : 2899.86MB
2025-04-28 02:06:55.873900: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:06:55.891600: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745806015.913526   56711 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745806015.920198   56711 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:06:55.942703: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.500767946243286
Epoch: 1, Steps: 17 | Train Loss: 1.560 Vali Loss: 0.904 Vali Acc: 0.653 Test Loss: 0.904 Test Acc: 0.653
Validation loss decreased (inf --> -0.653170).  Saving model ...
Epoch: 2 cost time: 5.3305745124816895
Epoch: 2, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.599 Vali Acc: 0.711 Test Loss: 1.599 Test Acc: 0.711
Validation loss decreased (-0.653170 --> -0.710967).  Saving model ...
Epoch: 3 cost time: 5.299640893936157
Epoch: 3, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.710967 --> -0.803462).  Saving model ...
Epoch: 4 cost time: 5.3140709400177
Epoch: 4, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.825 Vali Acc: 0.815 Test Loss: 0.825 Test Acc: 0.815
Validation loss decreased (-0.803462 --> -0.815021).  Saving model ...
Epoch: 5 cost time: 5.314596176147461
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.492 Vali Acc: 0.734 Test Loss: 2.492 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.27714729309082
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.570 Vali Acc: 0.757 Test Loss: 1.570 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.259633779525757
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.287 Vali Acc: 0.769 Test Loss: 1.287 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.274752378463745
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.798 Test Loss: 1.090 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.261916637420654
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.126 Vali Acc: 0.775 Test Loss: 1.126 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.262901544570923
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.780 Test Loss: 1.113 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.271348476409912
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.098 Vali Acc: 0.780 Test Loss: 1.098 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.277543067932129
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.780 Test Loss: 1.090 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.262211799621582
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.082 Vali Acc: 0.775 Test Loss: 1.082 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.300760269165039
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.775 Test Loss: 1.077 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 758510023
model size : 2894.92MB
2025-04-28 02:09:38.346790: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:09:38.364549: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745806178.386143   63446 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745806178.392841   63446 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:09:38.414495: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.249595403671265
Epoch: 1, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.032 Vali Acc: 0.624 Test Loss: 1.032 Test Acc: 0.624
Validation loss decreased (inf --> -0.624267).  Saving model ...
Epoch: 2 cost time: 5.3370256423950195
Epoch: 2, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.703 Vali Acc: 0.786 Test Loss: 0.703 Test Acc: 0.786
Validation loss decreased (-0.624267 --> -0.786120).  Saving model ...
Epoch: 3 cost time: 5.353983163833618
Epoch: 3, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.746 Vali Acc: 0.786 Test Loss: 0.746 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.325680255889893
Epoch: 4, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.838 Vali Acc: 0.746 Test Loss: 0.838 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.301086902618408
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.025 Vali Acc: 0.751 Test Loss: 1.025 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.293036699295044
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.178 Vali Acc: 0.740 Test Loss: 1.178 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.302285194396973
Epoch: 7, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.909 Vali Acc: 0.803 Test Loss: 0.909 Test Acc: 0.803
Validation loss decreased (-0.786120 --> -0.803459).  Saving model ...
Epoch: 8 cost time: 5.36541748046875
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.236 Vali Acc: 0.723 Test Loss: 2.236 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.318802356719971
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.395 Vali Acc: 0.803 Test Loss: 1.395 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.318471670150757
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.145 Vali Acc: 0.775 Test Loss: 1.145 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.311733722686768
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.602 Vali Acc: 0.809 Test Loss: 1.602 Test Acc: 0.809
Validation loss decreased (-0.803459 --> -0.809233).  Saving model ...
Epoch: 12 cost time: 5.349501848220825
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.293 Vali Acc: 0.792 Test Loss: 1.293 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.316515684127808
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.022 Vali Acc: 0.757 Test Loss: 2.022 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.312759160995483
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.160 Vali Acc: 0.821 Test Loss: 1.160 Test Acc: 0.821
Validation loss decreased (-0.809233 --> -0.820798).  Saving model ...
Epoch: 15 cost time: 5.362323522567749
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.718 Vali Acc: 0.786 Test Loss: 2.718 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.302268028259277
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.827 Test Loss: 1.882 Test Acc: 0.827
Validation loss decreased (-0.820798 --> -0.826571).  Saving model ...
Epoch: 17 cost time: 5.316685199737549
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.832 Test Loss: 1.675 Test Acc: 0.832
Validation loss decreased (-0.826571 --> -0.832353).  Saving model ...
Epoch: 18 cost time: 5.335740089416504
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.648 Vali Acc: 0.832 Test Loss: 1.648 Test Acc: 0.832
Validation loss decreased (-0.832353 --> -0.832353).  Saving model ...
Epoch: 19 cost time: 5.335680246353149
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.844 Test Loss: 1.662 Test Acc: 0.844
Validation loss decreased (-0.832353 --> -0.843914).  Saving model ...
Epoch: 20 cost time: 5.353339433670044
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.652 Vali Acc: 0.832 Test Loss: 1.652 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.313564777374268
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.615 Vali Acc: 0.832 Test Loss: 1.615 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.309924125671387
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.832 Test Loss: 1.651 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.317914724349976
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.832 Test Loss: 1.689 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.295675992965698
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.832 Test Loss: 1.700 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.319383144378662
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.832 Test Loss: 1.701 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.324208736419678
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.832 Test Loss: 1.649 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.32637095451355
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.832 Test Loss: 1.666 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.307483911514282
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.832 Test Loss: 1.655 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.302205562591553
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.832 Test Loss: 1.649 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 757647399
model size : 2891.63MB
2025-04-28 02:15:10.666772: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:15:10.684490: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745806510.706829   77174 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745806510.713768   77174 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:15:10.735747: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.280846118927002
Epoch: 1, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.305 Vali Acc: 0.428 Test Loss: 1.305 Test Acc: 0.428
Validation loss decreased (inf --> -0.427733).  Saving model ...
Epoch: 2 cost time: 5.15413236618042
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.630 Vali Acc: 0.757 Test Loss: 0.630 Test Acc: 0.757
Validation loss decreased (-0.427733 --> -0.757219).  Saving model ...
Epoch: 3 cost time: 5.139030933380127
Epoch: 3, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.948 Vali Acc: 0.780 Test Loss: 0.948 Test Acc: 0.780
Validation loss decreased (-0.757219 --> -0.780337).  Saving model ...
Epoch: 4 cost time: 5.107182502746582
Epoch: 4, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.095 Vali Acc: 0.769 Test Loss: 1.095 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.073594093322754
Epoch: 5, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.995 Vali Acc: 0.786 Test Loss: 0.995 Test Acc: 0.786
Validation loss decreased (-0.780337 --> -0.786117).  Saving model ...
Epoch: 6 cost time: 5.114184379577637
Epoch: 6, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.425 Vali Acc: 0.751 Test Loss: 1.425 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.0879740715026855
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 1.809 Vali Acc: 0.723 Test Loss: 1.809 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.092388868331909
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.895 Vali Acc: 0.838 Test Loss: 0.895 Test Acc: 0.838
Validation loss decreased (-0.786117 --> -0.838141).  Saving model ...
Epoch: 9 cost time: 5.1162145137786865
Epoch: 9, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.272 Vali Acc: 0.780 Test Loss: 1.272 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.07153582572937
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.877 Vali Acc: 0.832 Test Loss: 0.877 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.067286491394043
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.213 Vali Acc: 0.792 Test Loss: 1.213 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.10558009147644
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.618 Vali Acc: 0.821 Test Loss: 1.618 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.091737985610962
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.792 Vali Acc: 0.827 Test Loss: 1.792 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.098383188247681
Epoch: 14, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.802 Vali Acc: 0.832 Test Loss: 1.802 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.096606254577637
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.681 Vali Acc: 0.792 Test Loss: 1.681 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.080993413925171
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.022 Vali Acc: 0.775 Test Loss: 2.022 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.097431421279907
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.821 Test Loss: 1.344 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.066571235656738
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.827 Test Loss: 1.279 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 756784775
model size : 2888.34MB
2025-04-28 02:18:30.118013: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:18:30.135817: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745806710.157454   85741 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745806710.164298   85741 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:18:30.185960: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.162564277648926
Epoch: 1, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.050 Vali Acc: 0.630 Test Loss: 1.050 Test Acc: 0.630
Validation loss decreased (inf --> -0.630047).  Saving model ...
Epoch: 2 cost time: 4.970376253128052
Epoch: 2, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.875 Vali Acc: 0.630 Test Loss: 0.875 Test Acc: 0.630
Validation loss decreased (-0.630047 --> -0.630049).  Saving model ...
Epoch: 3 cost time: 4.969641447067261
Epoch: 3, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.997 Vali Acc: 0.682 Test Loss: 0.997 Test Acc: 0.682
Validation loss decreased (-0.630049 --> -0.682071).  Saving model ...
Epoch: 4 cost time: 4.952657461166382
Epoch: 4, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.765 Vali Acc: 0.763 Test Loss: 0.765 Test Acc: 0.763
Validation loss decreased (-0.682071 --> -0.762998).  Saving model ...
Epoch: 5 cost time: 4.971334457397461
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.824 Vali Acc: 0.780 Test Loss: 0.824 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780339).  Saving model ...
Epoch: 6 cost time: 4.959218978881836
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.786 Test Loss: 0.862 Test Acc: 0.786
Validation loss decreased (-0.780339 --> -0.786119).  Saving model ...
Epoch: 7 cost time: 4.97247314453125
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.815 Test Loss: 0.732 Test Acc: 0.815
Validation loss decreased (-0.786119 --> -0.815022).  Saving model ...
Epoch: 8 cost time: 4.967102766036987
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.838 Test Loss: 0.631 Test Acc: 0.838
Validation loss decreased (-0.815022 --> -0.838144).  Saving model ...
Epoch: 9 cost time: 4.949822187423706
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.931605815887451
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.827 Test Loss: 0.623 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.928337574005127
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.827 Test Loss: 0.607 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.947644233703613
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.832 Test Loss: 0.592 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.94111967086792
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.832 Test Loss: 0.596 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.930942535400391
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.832 Test Loss: 0.591 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.91753077507019
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.832 Test Loss: 0.590 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.908010005950928
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.832 Test Loss: 0.598 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.915220022201538
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.832 Test Loss: 0.599 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.916010856628418
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.832 Test Loss: 0.597 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 756353575
model size : 2886.70MB
2025-04-28 02:27:33.250683: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:27:33.268860: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745807253.291585   97089 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745807253.298460   97089 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:27:33.320897: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 20.83416438102722
Epoch: 1, Steps: 34 | Train Loss: 6.047 Vali Loss: 5.893 Vali Acc: 0.601 Test Loss: 5.893 Test Acc: 0.601
Validation loss decreased (inf --> -0.601097).  Saving model ...
Epoch: 2 cost time: 19.86037540435791
Epoch: 2, Steps: 34 | Train Loss: 2.615 Vali Loss: 9.157 Vali Acc: 0.572 Test Loss: 9.157 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.815428972244263
Epoch: 3, Steps: 34 | Train Loss: 0.838 Vali Loss: 5.555 Vali Acc: 0.705 Test Loss: 5.555 Test Acc: 0.705
Validation loss decreased (-0.601097 --> -0.705147).  Saving model ...
Epoch: 4 cost time: 19.847265481948853
Epoch: 4, Steps: 34 | Train Loss: 0.831 Vali Loss: 7.898 Vali Acc: 0.688 Test Loss: 7.898 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.82381558418274
Epoch: 5, Steps: 34 | Train Loss: 0.964 Vali Loss: 6.792 Vali Acc: 0.711 Test Loss: 6.792 Test Acc: 0.711
Validation loss decreased (-0.705147 --> -0.710915).  Saving model ...
Epoch: 6 cost time: 19.86009693145752
Epoch: 6, Steps: 34 | Train Loss: 0.864 Vali Loss: 15.557 Vali Acc: 0.682 Test Loss: 15.557 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.812548875808716
Epoch: 7, Steps: 34 | Train Loss: 2.510 Vali Loss: 22.542 Vali Acc: 0.694 Test Loss: 22.542 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.822960376739502
Epoch: 8, Steps: 34 | Train Loss: 2.556 Vali Loss: 18.991 Vali Acc: 0.676 Test Loss: 18.991 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.818724393844604
Epoch: 9, Steps: 34 | Train Loss: 0.814 Vali Loss: 17.781 Vali Acc: 0.728 Test Loss: 17.781 Test Acc: 0.728
Validation loss decreased (-0.710915 --> -0.728146).  Saving model ...
Epoch: 10 cost time: 19.86371946334839
Epoch: 10, Steps: 34 | Train Loss: 1.876 Vali Loss: 18.614 Vali Acc: 0.717 Test Loss: 18.614 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.816341161727905
Epoch: 11, Steps: 34 | Train Loss: 2.496 Vali Loss: 17.250 Vali Acc: 0.746 Test Loss: 17.250 Test Acc: 0.746
Validation loss decreased (-0.728146 --> -0.745492).  Saving model ...
Epoch: 12 cost time: 19.8447527885437
Epoch: 12, Steps: 34 | Train Loss: 4.187 Vali Loss: 47.897 Vali Acc: 0.803 Test Loss: 47.897 Test Acc: 0.803
Validation loss decreased (-0.745492 --> -0.802989).  Saving model ...
Epoch: 13 cost time: 19.846271991729736
Epoch: 13, Steps: 34 | Train Loss: 1.286 Vali Loss: 72.285 Vali Acc: 0.688 Test Loss: 72.285 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.80375099182129
Epoch: 14, Steps: 34 | Train Loss: 3.446 Vali Loss: 53.812 Vali Acc: 0.705 Test Loss: 53.812 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.817768335342407
Epoch: 15, Steps: 34 | Train Loss: 1.810 Vali Loss: 30.231 Vali Acc: 0.769 Test Loss: 30.231 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 19.784961462020874
Epoch: 16, Steps: 34 | Train Loss: 0.987 Vali Loss: 29.256 Vali Acc: 0.775 Test Loss: 29.256 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 19.800591230392456
Epoch: 17, Steps: 34 | Train Loss: 0.000 Vali Loss: 38.234 Vali Acc: 0.763 Test Loss: 38.234 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 19.805906534194946
Epoch: 18, Steps: 34 | Train Loss: 0.000 Vali Loss: 37.298 Vali Acc: 0.769 Test Loss: 37.298 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 19.824329614639282
Epoch: 19, Steps: 34 | Train Loss: 0.000 Vali Loss: 36.419 Vali Acc: 0.763 Test Loss: 36.419 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 19.817800760269165
Epoch: 20, Steps: 34 | Train Loss: 0.000 Vali Loss: 39.663 Vali Acc: 0.763 Test Loss: 39.663 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 19.81307077407837
Epoch: 21, Steps: 34 | Train Loss: 0.000 Vali Loss: 38.746 Vali Acc: 0.763 Test Loss: 38.746 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 19.80833601951599
Epoch: 22, Steps: 34 | Train Loss: 0.000 Vali Loss: 37.425 Vali Acc: 0.763 Test Loss: 37.425 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1618473799
model size : 6176.84MB
2025-04-28 02:28:02.716863: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:28:02.735826: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745807282.757690   97404 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745807282.764411   97404 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:28:02.786440: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.259563207626343
Epoch: 1, Steps: 17 | Train Loss: 2.370 Vali Loss: 1.399 Vali Acc: 0.636 Test Loss: 1.399 Test Acc: 0.636
Validation loss decreased (inf --> -0.635824).  Saving model ...
Epoch: 2 cost time: 10.235520362854004
Epoch: 2, Steps: 17 | Train Loss: 0.831 Vali Loss: 3.152 Vali Acc: 0.694 Test Loss: 3.152 Test Acc: 0.694
Validation loss decreased (-0.635824 --> -0.693610).  Saving model ...
Epoch: 3 cost time: 10.217209339141846
Epoch: 3, Steps: 17 | Train Loss: 0.449 Vali Loss: 3.859 Vali Acc: 0.572 Test Loss: 3.859 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.217968463897705
Epoch: 4, Steps: 17 | Train Loss: 0.230 Vali Loss: 3.944 Vali Acc: 0.642 Test Loss: 3.944 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.210442304611206
Epoch: 5, Steps: 17 | Train Loss: 0.242 Vali Loss: 6.399 Vali Acc: 0.659 Test Loss: 6.399 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.193524599075317
Epoch: 6, Steps: 17 | Train Loss: 0.390 Vali Loss: 4.426 Vali Acc: 0.676 Test Loss: 4.426 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.171027660369873
Epoch: 7, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.272 Vali Acc: 0.809 Test Loss: 2.272 Test Acc: 0.809
Validation loss decreased (-0.693610 --> -0.809226).  Saving model ...
Epoch: 8 cost time: 10.24531888961792
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 2.503 Vali Acc: 0.803 Test Loss: 2.503 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.179524421691895
Epoch: 9, Steps: 17 | Train Loss: 0.244 Vali Loss: 3.564 Vali Acc: 0.780 Test Loss: 3.564 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.179394960403442
Epoch: 10, Steps: 17 | Train Loss: 0.451 Vali Loss: 3.910 Vali Acc: 0.803 Test Loss: 3.910 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.188328742980957
Epoch: 11, Steps: 17 | Train Loss: 0.522 Vali Loss: 3.287 Vali Acc: 0.769 Test Loss: 3.287 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.179487466812134
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 9.991 Vali Acc: 0.705 Test Loss: 9.991 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.188404083251953
Epoch: 13, Steps: 17 | Train Loss: 0.156 Vali Loss: 8.693 Vali Acc: 0.699 Test Loss: 8.693 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.185042381286621
Epoch: 14, Steps: 17 | Train Loss: 0.349 Vali Loss: 6.994 Vali Acc: 0.751 Test Loss: 6.994 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.224488019943237
Epoch: 15, Steps: 17 | Train Loss: 0.176 Vali Loss: 11.295 Vali Acc: 0.809 Test Loss: 11.295 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.185296058654785
Epoch: 16, Steps: 17 | Train Loss: 0.349 Vali Loss: 11.529 Vali Acc: 0.705 Test Loss: 11.529 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.20115041732788
Epoch: 17, Steps: 17 | Train Loss: 0.589 Vali Loss: 6.376 Vali Acc: 0.803 Test Loss: 6.376 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1602942791
model size : 6117.59MB
2025-04-28 02:33:32.326810: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:33:32.345157: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745807612.367464  106081 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745807612.374302  106081 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:33:32.396856: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.192216634750366
Epoch: 1, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.047 Vali Acc: 0.676 Test Loss: 1.047 Test Acc: 0.676
Validation loss decreased (inf --> -0.676290).  Saving model ...
Epoch: 2 cost time: 10.014267683029175
Epoch: 2, Steps: 17 | Train Loss: 0.449 Vali Loss: 2.360 Vali Acc: 0.601 Test Loss: 2.360 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.97907567024231
Epoch: 3, Steps: 17 | Train Loss: 0.114 Vali Loss: 2.883 Vali Acc: 0.624 Test Loss: 2.883 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.980796813964844
Epoch: 4, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.644 Vali Acc: 0.757 Test Loss: 1.644 Test Acc: 0.757
Validation loss decreased (-0.676290 --> -0.757209).  Saving model ...
Epoch: 5 cost time: 10.024418830871582
Epoch: 5, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.830 Vali Acc: 0.757 Test Loss: 1.830 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.000909566879272
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 3.866 Vali Acc: 0.723 Test Loss: 3.866 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.990128517150879
Epoch: 7, Steps: 17 | Train Loss: 0.162 Vali Loss: 3.013 Vali Acc: 0.798 Test Loss: 3.013 Test Acc: 0.798
Validation loss decreased (-0.757209 --> -0.797658).  Saving model ...
Epoch: 8 cost time: 10.01839017868042
Epoch: 8, Steps: 17 | Train Loss: 0.244 Vali Loss: 3.790 Vali Acc: 0.682 Test Loss: 3.790 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.976326942443848
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.572 Vali Acc: 0.786 Test Loss: 2.572 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.006259202957153
Epoch: 10, Steps: 17 | Train Loss: 0.150 Vali Loss: 4.493 Vali Acc: 0.775 Test Loss: 4.493 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.989453554153442
Epoch: 11, Steps: 17 | Train Loss: 0.273 Vali Loss: 7.150 Vali Acc: 0.665 Test Loss: 7.150 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.00248384475708
Epoch: 12, Steps: 17 | Train Loss: 0.349 Vali Loss: 4.743 Vali Acc: 0.786 Test Loss: 4.743 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.98825979232788
Epoch: 13, Steps: 17 | Train Loss: 0.221 Vali Loss: 5.181 Vali Acc: 0.728 Test Loss: 5.181 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.962947845458984
Epoch: 14, Steps: 17 | Train Loss: 0.451 Vali Loss: 8.360 Vali Acc: 0.723 Test Loss: 8.360 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.994593620300293
Epoch: 15, Steps: 17 | Train Loss: 0.491 Vali Loss: 11.123 Vali Acc: 0.699 Test Loss: 11.123 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.993127584457397
Epoch: 16, Steps: 17 | Train Loss: 0.477 Vali Loss: 15.825 Vali Acc: 0.694 Test Loss: 15.825 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.968139171600342
Epoch: 17, Steps: 17 | Train Loss: 0.635 Vali Loss: 16.141 Vali Acc: 0.717 Test Loss: 16.141 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1597765895
model size : 6097.84MB
2025-04-28 02:39:07.299931: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:39:07.318113: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745807947.339724  114773 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745807947.346551  114773 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:39:07.368506: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.822629928588867
Epoch: 1, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.035 Vali Acc: 0.653 Test Loss: 1.035 Test Acc: 0.653
Validation loss decreased (inf --> -0.653169).  Saving model ...
Epoch: 2 cost time: 9.687311887741089
Epoch: 2, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.088 Vali Acc: 0.769 Test Loss: 1.088 Test Acc: 0.769
Validation loss decreased (-0.653169 --> -0.768775).  Saving model ...
Epoch: 3 cost time: 9.69718885421753
Epoch: 3, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.303 Vali Acc: 0.711 Test Loss: 1.303 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.669125318527222
Epoch: 4, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.878 Vali Acc: 0.757 Test Loss: 1.878 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.665823936462402
Epoch: 5, Steps: 17 | Train Loss: 0.145 Vali Loss: 3.750 Vali Acc: 0.676 Test Loss: 3.750 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.68406629562378
Epoch: 6, Steps: 17 | Train Loss: 0.218 Vali Loss: 2.912 Vali Acc: 0.613 Test Loss: 2.912 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.644455432891846
Epoch: 7, Steps: 17 | Train Loss: 0.082 Vali Loss: 3.937 Vali Acc: 0.647 Test Loss: 3.937 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.668038368225098
Epoch: 8, Steps: 17 | Train Loss: 0.204 Vali Loss: 3.748 Vali Acc: 0.740 Test Loss: 3.748 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.646239042282104
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 3.907 Vali Acc: 0.786 Test Loss: 3.907 Test Acc: 0.786
Validation loss decreased (-0.768775 --> -0.786088).  Saving model ...
Epoch: 10 cost time: 9.695051908493042
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.469 Vali Acc: 0.775 Test Loss: 2.469 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.659029960632324
Epoch: 11, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.770 Vali Acc: 0.803 Test Loss: 2.770 Test Acc: 0.803
Validation loss decreased (-0.786088 --> -0.803441).  Saving model ...
Epoch: 12 cost time: 9.690067768096924
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 4.109 Vali Acc: 0.786 Test Loss: 4.109 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.694407939910889
Epoch: 13, Steps: 17 | Train Loss: 0.329 Vali Loss: 4.045 Vali Acc: 0.780 Test Loss: 4.045 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.659526109695435
Epoch: 14, Steps: 17 | Train Loss: 0.347 Vali Loss: 6.650 Vali Acc: 0.746 Test Loss: 6.650 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.639141321182251
Epoch: 15, Steps: 17 | Train Loss: 0.481 Vali Loss: 7.692 Vali Acc: 0.751 Test Loss: 7.692 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.663690090179443
Epoch: 16, Steps: 17 | Train Loss: 0.373 Vali Loss: 6.149 Vali Acc: 0.757 Test Loss: 6.149 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.66520380973816
Epoch: 17, Steps: 17 | Train Loss: 1.079 Vali Loss: 10.484 Vali Acc: 0.763 Test Loss: 10.484 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 9.694351196289062
Epoch: 18, Steps: 17 | Train Loss: 1.005 Vali Loss: 8.956 Vali Acc: 0.763 Test Loss: 8.956 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.662500858306885
Epoch: 19, Steps: 17 | Train Loss: 0.465 Vali Loss: 18.396 Vali Acc: 0.717 Test Loss: 18.396 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 9.677305698394775
Epoch: 20, Steps: 17 | Train Loss: 0.891 Vali Loss: 10.588 Vali Acc: 0.723 Test Loss: 10.588 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 9.664262533187866
Epoch: 21, Steps: 17 | Train Loss: 1.048 Vali Loss: 7.622 Vali Acc: 0.821 Test Loss: 7.622 Test Acc: 0.821
Validation loss decreased (-0.803441 --> -0.820733).  Saving model ...
Epoch: 22 cost time: 9.716363668441772
Epoch: 22, Steps: 17 | Train Loss: 0.532 Vali Loss: 10.251 Vali Acc: 0.740 Test Loss: 10.251 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.671743392944336
Epoch: 23, Steps: 17 | Train Loss: 0.271 Vali Loss: 9.720 Vali Acc: 0.809 Test Loss: 9.720 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.666548728942871
Epoch: 24, Steps: 17 | Train Loss: 0.945 Vali Loss: 31.932 Vali Acc: 0.676 Test Loss: 31.932 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 9.681438684463501
Epoch: 25, Steps: 17 | Train Loss: 3.323 Vali Loss: 16.597 Vali Acc: 0.809 Test Loss: 16.597 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.660399913787842
Epoch: 26, Steps: 17 | Train Loss: 2.426 Vali Loss: 23.986 Vali Acc: 0.803 Test Loss: 23.986 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.67798924446106
Epoch: 27, Steps: 17 | Train Loss: 0.192 Vali Loss: 36.127 Vali Acc: 0.699 Test Loss: 36.127 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 9.67870545387268
Epoch: 28, Steps: 17 | Train Loss: 1.163 Vali Loss: 21.070 Vali Acc: 0.769 Test Loss: 21.070 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.645368814468384
Epoch: 29, Steps: 17 | Train Loss: 0.092 Vali Loss: 20.538 Vali Acc: 0.803 Test Loss: 20.538 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.665986776351929
Epoch: 30, Steps: 17 | Train Loss: 0.039 Vali Loss: 20.478 Vali Acc: 0.769 Test Loss: 20.478 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 9.663664817810059
Epoch: 31, Steps: 17 | Train Loss: 0.209 Vali Loss: 20.512 Vali Acc: 0.769 Test Loss: 20.512 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1595177607
model size : 6087.97MB
2025-04-28 02:48:34.648101: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:48:34.667438: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745808514.689513  130298 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745808514.696501  130298 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:48:34.718678: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.691734790802002
Epoch: 1, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.120 Vali Acc: 0.624 Test Loss: 1.120 Test Acc: 0.624
Validation loss decreased (inf --> -0.624266).  Saving model ...
Epoch: 2 cost time: 9.574350357055664
Epoch: 2, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.854 Vali Acc: 0.676 Test Loss: 0.854 Test Acc: 0.676
Validation loss decreased (-0.624266 --> -0.676292).  Saving model ...
Epoch: 3 cost time: 9.556278467178345
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.333 Vali Acc: 0.751 Test Loss: 1.333 Test Acc: 0.751
Validation loss decreased (-0.676292 --> -0.751432).  Saving model ...
Epoch: 4 cost time: 9.556705236434937
Epoch: 4, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.133 Vali Acc: 0.809 Test Loss: 1.133 Test Acc: 0.809
Validation loss decreased (-0.751432 --> -0.809237).  Saving model ...
Epoch: 5 cost time: 9.584195613861084
Epoch: 5, Steps: 17 | Train Loss: 0.223 Vali Loss: 2.463 Vali Acc: 0.763 Test Loss: 2.463 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.538311243057251
Epoch: 6, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.168 Vali Acc: 0.780 Test Loss: 2.168 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.52538776397705
Epoch: 7, Steps: 17 | Train Loss: 0.105 Vali Loss: 2.276 Vali Acc: 0.780 Test Loss: 2.276 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.525619506835938
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.589 Vali Acc: 0.792 Test Loss: 1.589 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.532840490341187
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.918 Vali Acc: 0.815 Test Loss: 1.918 Test Acc: 0.815
Validation loss decreased (-0.809237 --> -0.815010).  Saving model ...
Epoch: 10 cost time: 9.561254501342773
Epoch: 10, Steps: 17 | Train Loss: 0.268 Vali Loss: 2.340 Vali Acc: 0.838 Test Loss: 2.340 Test Acc: 0.838
Validation loss decreased (-0.815010 --> -0.838127).  Saving model ...
Epoch: 11 cost time: 9.600038290023804
Epoch: 11, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.866 Vali Acc: 0.815 Test Loss: 1.866 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.537731647491455
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 7.121 Vali Acc: 0.775 Test Loss: 7.121 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.541980743408203
Epoch: 13, Steps: 17 | Train Loss: 0.216 Vali Loss: 7.357 Vali Acc: 0.740 Test Loss: 7.357 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.53322696685791
Epoch: 14, Steps: 17 | Train Loss: 0.347 Vali Loss: 6.026 Vali Acc: 0.746 Test Loss: 6.026 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.538186073303223
Epoch: 15, Steps: 17 | Train Loss: 0.301 Vali Loss: 5.499 Vali Acc: 0.694 Test Loss: 5.499 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.527472019195557
Epoch: 16, Steps: 17 | Train Loss: 0.201 Vali Loss: 5.837 Vali Acc: 0.751 Test Loss: 5.837 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.54259204864502
Epoch: 17, Steps: 17 | Train Loss: 0.213 Vali Loss: 5.498 Vali Acc: 0.746 Test Loss: 5.498 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.534276962280273
Epoch: 18, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.200 Vali Acc: 0.821 Test Loss: 2.200 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.54274868965149
Epoch: 19, Steps: 17 | Train Loss: 0.152 Vali Loss: 9.761 Vali Acc: 0.763 Test Loss: 9.761 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.533241748809814
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 9.440 Vali Acc: 0.740 Test Loss: 9.440 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1593452359
model size : 6081.39MB
2025-04-28 02:55:35.748450: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 02:55:35.767610: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745808935.790424  140609 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745808935.797285  140609 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 02:55:35.819797: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.061523199081421
Epoch: 1, Steps: 17 | Train Loss: 1.721 Vali Loss: 1.270 Vali Acc: 0.636 Test Loss: 1.270 Test Acc: 0.636
Validation loss decreased (inf --> -0.635825).  Saving model ...
Epoch: 2 cost time: 9.158720254898071
Epoch: 2, Steps: 17 | Train Loss: 0.380 Vali Loss: 1.088 Vali Acc: 0.775 Test Loss: 1.088 Test Acc: 0.775
Validation loss decreased (-0.635825 --> -0.774556).  Saving model ...
Epoch: 3 cost time: 9.186092138290405
Epoch: 3, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.287 Vali Acc: 0.728 Test Loss: 1.287 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.104786157608032
Epoch: 4, Steps: 17 | Train Loss: 0.125 Vali Loss: 2.279 Vali Acc: 0.763 Test Loss: 2.279 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.111096382141113
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 1.932 Vali Acc: 0.775 Test Loss: 1.932 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.104807376861572
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.070 Vali Acc: 0.746 Test Loss: 2.070 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.098063468933105
Epoch: 7, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.775 Vali Acc: 0.757 Test Loss: 1.775 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.11264967918396
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.158 Vali Acc: 0.798 Test Loss: 2.158 Test Acc: 0.798
Validation loss decreased (-0.774556 --> -0.797666).  Saving model ...
Epoch: 9 cost time: 9.160683393478394
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.466 Vali Acc: 0.775 Test Loss: 2.466 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.10881757736206
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 3.371 Vali Acc: 0.769 Test Loss: 3.371 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.127410173416138
Epoch: 11, Steps: 17 | Train Loss: 0.091 Vali Loss: 3.781 Vali Acc: 0.734 Test Loss: 3.781 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.116459369659424
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 5.990 Vali Acc: 0.746 Test Loss: 5.990 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.125014305114746
Epoch: 13, Steps: 17 | Train Loss: 0.383 Vali Loss: 2.852 Vali Acc: 0.827 Test Loss: 2.852 Test Acc: 0.827
Validation loss decreased (-0.797666 --> -0.826561).  Saving model ...
Epoch: 14 cost time: 9.145591735839844
Epoch: 14, Steps: 17 | Train Loss: 0.087 Vali Loss: 4.367 Vali Acc: 0.809 Test Loss: 4.367 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.099256992340088
Epoch: 15, Steps: 17 | Train Loss: 0.307 Vali Loss: 2.498 Vali Acc: 0.827 Test Loss: 2.498 Test Acc: 0.827
Validation loss decreased (-0.826561 --> -0.826565).  Saving model ...
Epoch: 16 cost time: 9.148980855941772
Epoch: 16, Steps: 17 | Train Loss: 0.620 Vali Loss: 3.808 Vali Acc: 0.746 Test Loss: 3.808 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.102524995803833
Epoch: 17, Steps: 17 | Train Loss: 0.538 Vali Loss: 10.624 Vali Acc: 0.757 Test Loss: 10.624 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.110187768936157
Epoch: 18, Steps: 17 | Train Loss: 0.816 Vali Loss: 8.035 Vali Acc: 0.775 Test Loss: 8.035 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.108112096786499
Epoch: 19, Steps: 17 | Train Loss: 0.644 Vali Loss: 9.324 Vali Acc: 0.699 Test Loss: 9.324 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.114788293838501
Epoch: 20, Steps: 17 | Train Loss: 0.759 Vali Loss: 9.180 Vali Acc: 0.775 Test Loss: 9.180 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.101095914840698
Epoch: 21, Steps: 17 | Train Loss: 0.279 Vali Loss: 11.295 Vali Acc: 0.769 Test Loss: 11.295 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.111799240112305
Epoch: 22, Steps: 17 | Train Loss: 0.676 Vali Loss: 9.015 Vali Acc: 0.740 Test Loss: 9.015 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.106227397918701
Epoch: 23, Steps: 17 | Train Loss: 0.124 Vali Loss: 7.055 Vali Acc: 0.803 Test Loss: 7.055 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.099336385726929
Epoch: 24, Steps: 17 | Train Loss: 0.150 Vali Loss: 11.844 Vali Acc: 0.734 Test Loss: 11.844 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.113508939743042
Epoch: 25, Steps: 17 | Train Loss: 1.675 Vali Loss: 12.342 Vali Acc: 0.734 Test Loss: 12.342 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1591727111
model size : 6074.81MB
2025-04-28 03:03:11.536507: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:03:11.554978: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745809391.577520  153164 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745809391.584700  153164 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:03:11.607900: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.022937059402466
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.233 Vali Acc: 0.607 Test Loss: 1.233 Test Acc: 0.607
Validation loss decreased (inf --> -0.606924).  Saving model ...
Epoch: 2 cost time: 8.95422077178955
Epoch: 2, Steps: 17 | Train Loss: 0.288 Vali Loss: 1.083 Vali Acc: 0.676 Test Loss: 1.083 Test Acc: 0.676
Validation loss decreased (-0.606924 --> -0.676290).  Saving model ...
Epoch: 3 cost time: 8.937108755111694
Epoch: 3, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.123 Vali Acc: 0.775 Test Loss: 1.123 Test Acc: 0.775
Validation loss decreased (-0.676290 --> -0.774555).  Saving model ...
Epoch: 4 cost time: 8.95282769203186
Epoch: 4, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.810 Vali Acc: 0.711 Test Loss: 1.810 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.884639263153076
Epoch: 5, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
Validation loss decreased (-0.774555 --> -0.774557).  Saving model ...
Epoch: 6 cost time: 8.926793575286865
Epoch: 6, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.343 Vali Acc: 0.763 Test Loss: 1.343 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.897048950195312
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.408 Vali Acc: 0.792 Test Loss: 1.408 Test Acc: 0.792
Validation loss decreased (-0.774557 --> -0.791893).  Saving model ...
Epoch: 8 cost time: 8.95311164855957
Epoch: 8, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.672 Vali Acc: 0.803 Test Loss: 1.672 Test Acc: 0.803
Validation loss decreased (-0.791893 --> -0.803451).  Saving model ...
Epoch: 9 cost time: 8.95464038848877
Epoch: 9, Steps: 17 | Train Loss: 0.330 Vali Loss: 2.479 Vali Acc: 0.717 Test Loss: 2.479 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.89173412322998
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.782 Vali Acc: 0.751 Test Loss: 2.782 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.914068222045898
Epoch: 11, Steps: 17 | Train Loss: 0.977 Vali Loss: 2.483 Vali Acc: 0.751 Test Loss: 2.483 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.911727666854858
Epoch: 12, Steps: 17 | Train Loss: 0.413 Vali Loss: 4.624 Vali Acc: 0.780 Test Loss: 4.624 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.877599000930786
Epoch: 13, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.837 Vali Acc: 0.786 Test Loss: 2.837 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 8.913909912109375
Epoch: 14, Steps: 17 | Train Loss: 0.463 Vali Loss: 2.421 Vali Acc: 0.798 Test Loss: 2.421 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.904681205749512
Epoch: 15, Steps: 17 | Train Loss: 0.115 Vali Loss: 3.764 Vali Acc: 0.821 Test Loss: 3.764 Test Acc: 0.821
Validation loss decreased (-0.803451 --> -0.820772).  Saving model ...
Epoch: 16 cost time: 8.919665336608887
Epoch: 16, Steps: 17 | Train Loss: 0.257 Vali Loss: 7.608 Vali Acc: 0.763 Test Loss: 7.608 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.886872291564941
Epoch: 17, Steps: 17 | Train Loss: 0.908 Vali Loss: 5.207 Vali Acc: 0.775 Test Loss: 5.207 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.881086587905884
Epoch: 18, Steps: 17 | Train Loss: 0.218 Vali Loss: 10.294 Vali Acc: 0.757 Test Loss: 10.294 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.889385223388672
Epoch: 19, Steps: 17 | Train Loss: 0.678 Vali Loss: 4.459 Vali Acc: 0.809 Test Loss: 4.459 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.926990509033203
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 6.183 Vali Acc: 0.798 Test Loss: 6.183 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.889280557632446
Epoch: 21, Steps: 17 | Train Loss: 0.186 Vali Loss: 11.855 Vali Acc: 0.757 Test Loss: 11.855 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.892136096954346
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 9.255 Vali Acc: 0.809 Test Loss: 9.255 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.904662847518921
Epoch: 23, Steps: 17 | Train Loss: 0.227 Vali Loss: 8.395 Vali Acc: 0.827 Test Loss: 8.395 Test Acc: 0.827
Validation loss decreased (-0.820772 --> -0.826506).  Saving model ...
Epoch: 24 cost time: 8.947878122329712
Epoch: 24, Steps: 17 | Train Loss: 0.698 Vali Loss: 9.442 Vali Acc: 0.786 Test Loss: 9.442 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 8.88959002494812
Epoch: 25, Steps: 17 | Train Loss: 0.257 Vali Loss: 12.684 Vali Acc: 0.757 Test Loss: 12.684 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 8.877202033996582
Epoch: 26, Steps: 17 | Train Loss: 0.103 Vali Loss: 6.463 Vali Acc: 0.798 Test Loss: 6.463 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 8.876553058624268
Epoch: 27, Steps: 17 | Train Loss: 0.190 Vali Loss: 19.605 Vali Acc: 0.775 Test Loss: 19.605 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 8.901045560836792
Epoch: 28, Steps: 17 | Train Loss: 1.265 Vali Loss: 8.629 Vali Acc: 0.798 Test Loss: 8.629 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 8.90183424949646
Epoch: 29, Steps: 17 | Train Loss: 0.881 Vali Loss: 6.119 Vali Acc: 0.786 Test Loss: 6.119 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 8.887984037399292
Epoch: 30, Steps: 17 | Train Loss: 0.089 Vali Loss: 11.855 Vali Acc: 0.786 Test Loss: 11.855 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 8.893810510635376
Epoch: 31, Steps: 17 | Train Loss: 0.327 Vali Loss: 7.589 Vali Acc: 0.775 Test Loss: 7.589 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 8.920429944992065
Epoch: 32, Steps: 17 | Train Loss: 0.168 Vali Loss: 15.101 Vali Acc: 0.792 Test Loss: 15.101 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 8.908089637756348
Epoch: 33, Steps: 17 | Train Loss: 0.444 Vali Loss: 15.493 Vali Acc: 0.786 Test Loss: 15.493 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1590864711
model size : 6071.52MB
2025-04-28 03:13:22.443997: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:13:22.462274: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745810002.485043  169703 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745810002.492055  169703 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:13:22.514496: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.676739931106567
Epoch: 1, Steps: 17 | Train Loss: 2.211 Vali Loss: 1.705 Vali Acc: 0.636 Test Loss: 1.705 Test Acc: 0.636
Validation loss decreased (inf --> -0.635821).  Saving model ...
Epoch: 2 cost time: 7.520759105682373
Epoch: 2, Steps: 17 | Train Loss: 0.541 Vali Loss: 4.722 Vali Acc: 0.717 Test Loss: 4.722 Test Acc: 0.717
Validation loss decreased (-0.635821 --> -0.716716).  Saving model ...
Epoch: 3 cost time: 7.506412029266357
Epoch: 3, Steps: 17 | Train Loss: 1.091 Vali Loss: 2.048 Vali Acc: 0.740 Test Loss: 2.048 Test Acc: 0.740
Validation loss decreased (-0.716716 --> -0.739864).  Saving model ...
Epoch: 4 cost time: 7.5121259689331055
Epoch: 4, Steps: 17 | Train Loss: 0.843 Vali Loss: 3.880 Vali Acc: 0.757 Test Loss: 3.880 Test Acc: 0.757
Validation loss decreased (-0.739864 --> -0.757187).  Saving model ...
Epoch: 5 cost time: 7.4940173625946045
Epoch: 5, Steps: 17 | Train Loss: 0.339 Vali Loss: 3.671 Vali Acc: 0.653 Test Loss: 3.671 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.488256931304932
Epoch: 6, Steps: 17 | Train Loss: 0.198 Vali Loss: 3.171 Vali Acc: 0.775 Test Loss: 3.171 Test Acc: 0.775
Validation loss decreased (-0.757187 --> -0.774535).  Saving model ...
Epoch: 7 cost time: 7.536764144897461
Epoch: 7, Steps: 17 | Train Loss: 0.053 Vali Loss: 4.971 Vali Acc: 0.757 Test Loss: 4.971 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.5135016441345215
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 4.795 Vali Acc: 0.751 Test Loss: 4.795 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.479682683944702
Epoch: 9, Steps: 17 | Train Loss: 0.147 Vali Loss: 5.851 Vali Acc: 0.699 Test Loss: 5.851 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.473730802536011
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 5.551 Vali Acc: 0.717 Test Loss: 5.551 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.470258712768555
Epoch: 11, Steps: 17 | Train Loss: 0.300 Vali Loss: 2.759 Vali Acc: 0.803 Test Loss: 2.759 Test Acc: 0.803
Validation loss decreased (-0.774535 --> -0.803441).  Saving model ...
Epoch: 12 cost time: 7.503617763519287
Epoch: 12, Steps: 17 | Train Loss: 0.337 Vali Loss: 3.461 Vali Acc: 0.803 Test Loss: 3.461 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.496921062469482
Epoch: 13, Steps: 17 | Train Loss: 0.145 Vali Loss: 4.918 Vali Acc: 0.769 Test Loss: 4.918 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.475529670715332
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 4.959 Vali Acc: 0.798 Test Loss: 4.959 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.470005989074707
Epoch: 15, Steps: 17 | Train Loss: 0.275 Vali Loss: 4.721 Vali Acc: 0.803 Test Loss: 4.721 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.485419034957886
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 4.390 Vali Acc: 0.786 Test Loss: 4.390 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.504746198654175
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.121 Vali Acc: 0.775 Test Loss: 6.121 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.4819629192352295
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 4.417 Vali Acc: 0.769 Test Loss: 4.417 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.484650373458862
Epoch: 19, Steps: 17 | Train Loss: 0.154 Vali Loss: 3.811 Vali Acc: 0.786 Test Loss: 3.811 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.46729850769043
Epoch: 20, Steps: 17 | Train Loss: 0.470 Vali Loss: 9.658 Vali Acc: 0.769 Test Loss: 9.658 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.484391212463379
Epoch: 21, Steps: 17 | Train Loss: 0.564 Vali Loss: 4.403 Vali Acc: 0.821 Test Loss: 4.403 Test Acc: 0.821
Validation loss decreased (-0.803441 --> -0.820765).  Saving model ...
Epoch: 22 cost time: 7.503235578536987
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 9.279 Vali Acc: 0.734 Test Loss: 9.279 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.469160556793213
Epoch: 23, Steps: 17 | Train Loss: 0.969 Vali Loss: 6.998 Vali Acc: 0.746 Test Loss: 6.998 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.49778938293457
Epoch: 24, Steps: 17 | Train Loss: 0.258 Vali Loss: 10.858 Vali Acc: 0.682 Test Loss: 10.858 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.486485958099365
Epoch: 25, Steps: 17 | Train Loss: 0.616 Vali Loss: 32.618 Vali Acc: 0.636 Test Loss: 32.618 Test Acc: 0.636
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.4799253940582275
Epoch: 26, Steps: 17 | Train Loss: 1.204 Vali Loss: 19.366 Vali Acc: 0.717 Test Loss: 19.366 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.485167980194092
Epoch: 27, Steps: 17 | Train Loss: 4.177 Vali Loss: 29.153 Vali Acc: 0.705 Test Loss: 29.153 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.496168613433838
Epoch: 28, Steps: 17 | Train Loss: 0.654 Vali Loss: 28.721 Vali Acc: 0.763 Test Loss: 28.721 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.47683048248291
Epoch: 29, Steps: 17 | Train Loss: 0.508 Vali Loss: 21.658 Vali Acc: 0.757 Test Loss: 21.658 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.477120399475098
Epoch: 30, Steps: 17 | Train Loss: 1.138 Vali Loss: 28.780 Vali Acc: 0.728 Test Loss: 28.780 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 7.468390703201294
Epoch: 31, Steps: 17 | Train Loss: 1.247 Vali Loss: 13.361 Vali Acc: 0.815 Test Loss: 13.361 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 769788327
model size : 2937.95MB
2025-04-28 03:20:34.281856: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:20:34.300242: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745810434.322625  184680 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745810434.329532  184680 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:20:34.351967: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.955047130584717
Epoch: 1, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.652 Vali Acc: 0.607 Test Loss: 1.652 Test Acc: 0.607
Validation loss decreased (inf --> -0.606920).  Saving model ...
Epoch: 2 cost time: 5.717889308929443
Epoch: 2, Steps: 17 | Train Loss: 0.602 Vali Loss: 1.554 Vali Acc: 0.694 Test Loss: 1.554 Test Acc: 0.694
Validation loss decreased (-0.606920 --> -0.693626).  Saving model ...
Epoch: 3 cost time: 5.776897192001343
Epoch: 3, Steps: 17 | Train Loss: 0.317 Vali Loss: 2.585 Vali Acc: 0.723 Test Loss: 2.585 Test Acc: 0.723
Validation loss decreased (-0.693626 --> -0.722518).  Saving model ...
Epoch: 4 cost time: 5.7589497566223145
Epoch: 4, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.746 Vali Acc: 0.769 Test Loss: 1.746 Test Acc: 0.769
Validation loss decreased (-0.722518 --> -0.768769).  Saving model ...
Epoch: 5 cost time: 5.747439622879028
Epoch: 5, Steps: 17 | Train Loss: 0.178 Vali Loss: 2.364 Vali Acc: 0.746 Test Loss: 2.364 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.725833177566528
Epoch: 6, Steps: 17 | Train Loss: 0.324 Vali Loss: 2.608 Vali Acc: 0.717 Test Loss: 2.608 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.730374336242676
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.979 Vali Acc: 0.751 Test Loss: 2.979 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.7241833209991455
Epoch: 8, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.974 Vali Acc: 0.809 Test Loss: 0.974 Test Acc: 0.809
Validation loss decreased (-0.768769 --> -0.809239).  Saving model ...
Epoch: 9 cost time: 5.771669864654541
Epoch: 9, Steps: 17 | Train Loss: 0.059 Vali Loss: 5.231 Vali Acc: 0.717 Test Loss: 5.231 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.74290132522583
Epoch: 10, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.173 Vali Acc: 0.809 Test Loss: 1.173 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.727248430252075
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.434 Vali Acc: 0.815 Test Loss: 1.434 Test Acc: 0.815
Validation loss decreased (-0.809239 --> -0.815015).  Saving model ...
Epoch: 12 cost time: 5.737616062164307
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.855 Test Loss: 1.068 Test Acc: 0.855
Validation loss decreased (-0.815015 --> -0.855481).  Saving model ...
Epoch: 13 cost time: 5.757886171340942
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.366 Vali Acc: 0.786 Test Loss: 3.366 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.7274956703186035
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.815 Test Loss: 1.807 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.71670126914978
Epoch: 15, Steps: 17 | Train Loss: 0.199 Vali Loss: 2.330 Vali Acc: 0.769 Test Loss: 2.330 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.713467836380005
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.798 Test Loss: 1.134 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.748425245285034
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.809 Test Loss: 1.097 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.730700254440308
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.809 Test Loss: 1.059 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.7394328117370605
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.809 Test Loss: 1.046 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.709118366241455
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.809 Test Loss: 1.055 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.74585223197937
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.809 Test Loss: 1.058 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.737765550613403
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.803 Test Loss: 1.067 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 762022823
model size : 2908.32MB
2025-04-28 03:25:00.551043: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:25:00.569664: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745810700.592726  195199 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745810700.599787  195199 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:25:00.622362: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.606826305389404
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 0.962 Vali Acc: 0.572 Test Loss: 0.962 Test Acc: 0.572
Validation loss decreased (inf --> -0.572245).  Saving model ...
Epoch: 2 cost time: 5.559325456619263
Epoch: 2, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.918 Vali Acc: 0.647 Test Loss: 0.918 Test Acc: 0.647
Validation loss decreased (-0.572245 --> -0.647390).  Saving model ...
Epoch: 3 cost time: 5.5336408615112305
Epoch: 3, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.919 Vali Acc: 0.769 Test Loss: 0.919 Test Acc: 0.769
Validation loss decreased (-0.647390 --> -0.768777).  Saving model ...
Epoch: 4 cost time: 5.534607172012329
Epoch: 4, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.135 Vali Acc: 0.630 Test Loss: 2.135 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.527786493301392
Epoch: 5, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.654 Vali Acc: 0.636 Test Loss: 1.654 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.531359910964966
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.474 Vali Acc: 0.740 Test Loss: 1.474 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.507530927658081
Epoch: 7, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.849 Vali Acc: 0.746 Test Loss: 0.849 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.504290342330933
Epoch: 8, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.447 Vali Acc: 0.815 Test Loss: 1.447 Test Acc: 0.815
Validation loss decreased (-0.768777 --> -0.815014).  Saving model ...
Epoch: 9 cost time: 5.555733919143677
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.185 Vali Acc: 0.798 Test Loss: 1.185 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.508226633071899
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.821 Test Loss: 0.700 Test Acc: 0.821
Validation loss decreased (-0.815014 --> -0.820802).  Saving model ...
Epoch: 11 cost time: 5.533282995223999
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.827 Test Loss: 0.584 Test Acc: 0.827
Validation loss decreased (-0.820802 --> -0.826584).  Saving model ...
Epoch: 12 cost time: 5.554193019866943
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.827 Test Loss: 0.605 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.528738021850586
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.827 Test Loss: 0.601 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.51885986328125
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.827 Test Loss: 0.601 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.497875452041626
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.838 Test Loss: 0.601 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838144).  Saving model ...
Epoch: 16 cost time: 5.567242622375488
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.827 Test Loss: 0.602 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.488609790802002
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
Validation loss decreased (-0.838144 --> -0.838144).  Saving model ...
Epoch: 18 cost time: 5.555288791656494
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.827 Test Loss: 0.591 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.496663331985474
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.827 Test Loss: 0.612 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.530543327331543
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.838 Test Loss: 0.604 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.507157325744629
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
Validation loss decreased (-0.838144 --> -0.849705).  Saving model ...
Epoch: 22 cost time: 5.570436000823975
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.586 Vali Acc: 0.838 Test Loss: 0.586 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.507826805114746
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.513803243637085
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.838 Test Loss: 0.592 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.514397621154785
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.827 Test Loss: 0.594 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.507504224777222
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.827 Test Loss: 0.601 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.50495457649231
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.838 Test Loss: 0.597 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.490251541137695
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.827 Test Loss: 0.595 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.496153354644775
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.827 Test Loss: 0.603 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.50914454460144
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.838 Test Loss: 0.588 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.50312614440918
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.838 Test Loss: 0.589 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 759434375
model size : 2898.45MB
2025-04-28 03:31:00.412486: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:31:00.430897: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745811060.452894  209879 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745811060.459785  209879 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:31:00.482008: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.5847108364105225
Epoch: 1, Steps: 17 | Train Loss: 1.543 Vali Loss: 0.866 Vali Acc: 0.694 Test Loss: 0.866 Test Acc: 0.694
Validation loss decreased (inf --> -0.693633).  Saving model ...
Epoch: 2 cost time: 5.380545139312744
Epoch: 2, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.903 Vali Acc: 0.723 Test Loss: 0.903 Test Acc: 0.723
Validation loss decreased (-0.693633 --> -0.722534).  Saving model ...
Epoch: 3 cost time: 5.3900840282440186
Epoch: 3, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.771 Vali Acc: 0.792 Test Loss: 0.771 Test Acc: 0.792
Validation loss decreased (-0.722534 --> -0.791900).  Saving model ...
Epoch: 4 cost time: 5.385477542877197
Epoch: 4, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.110 Vali Acc: 0.676 Test Loss: 2.110 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.386682033538818
Epoch: 5, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.221 Vali Acc: 0.827 Test Loss: 1.221 Test Acc: 0.827
Validation loss decreased (-0.791900 --> -0.826577).  Saving model ...
Epoch: 6 cost time: 5.413151979446411
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.775 Test Loss: 1.713 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.371739625930786
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.775 Test Loss: 1.400 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.386169910430908
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.869 Vali Acc: 0.757 Test Loss: 1.869 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.366918563842773
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.761 Vali Acc: 0.769 Test Loss: 1.761 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.367701530456543
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.723 Vali Acc: 0.769 Test Loss: 1.723 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.354286432266235
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.711 Vali Acc: 0.769 Test Loss: 1.711 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.369051694869995
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.769 Test Loss: 1.715 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.364186763763428
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.769 Test Loss: 1.712 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.346010446548462
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.769 Test Loss: 1.684 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.3442771434783936
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.769 Test Loss: 1.669 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 758140231
model size : 2893.51MB
2025-04-28 03:34:00.061794: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:34:00.081697: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745811240.104775  217104 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745811240.111922  217104 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:34:00.134820: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.559945583343506
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 0.933 Vali Acc: 0.647 Test Loss: 0.933 Test Acc: 0.647
Validation loss decreased (inf --> -0.647390).  Saving model ...
Epoch: 2 cost time: 5.424428701400757
Epoch: 2, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.834 Vali Acc: 0.734 Test Loss: 0.834 Test Acc: 0.734
Validation loss decreased (-0.647390 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 5.4143922328948975
Epoch: 3, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.962 Vali Acc: 0.740 Test Loss: 0.962 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739875).  Saving model ...
Epoch: 4 cost time: 5.379940509796143
Epoch: 4, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.899 Vali Acc: 0.803 Test Loss: 0.899 Test Acc: 0.803
Validation loss decreased (-0.739875 --> -0.803459).  Saving model ...
Epoch: 5 cost time: 5.402639627456665
Epoch: 5, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.444 Vali Acc: 0.780 Test Loss: 1.444 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.367192983627319
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.754 Vali Acc: 0.821 Test Loss: 0.754 Test Acc: 0.821
Validation loss decreased (-0.803459 --> -0.820802).  Saving model ...
Epoch: 7 cost time: 5.410287618637085
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.955 Vali Acc: 0.821 Test Loss: 0.955 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.3400185108184814
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.643 Vali Acc: 0.792 Test Loss: 1.643 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.3875322341918945
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.313 Vali Acc: 0.792 Test Loss: 1.313 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.368534564971924
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.949 Vali Acc: 0.815 Test Loss: 0.949 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.357114791870117
Epoch: 11, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.442 Vali Acc: 0.798 Test Loss: 1.442 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.365586757659912
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.088 Vali Acc: 0.803 Test Loss: 1.088 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.350019454956055
Epoch: 13, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.828 Vali Acc: 0.798 Test Loss: 1.828 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.377406597137451
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.528 Vali Acc: 0.769 Test Loss: 1.528 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.377166032791138
Epoch: 15, Steps: 17 | Train Loss: 0.332 Vali Loss: 3.129 Vali Acc: 0.769 Test Loss: 3.129 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.346445083618164
Epoch: 16, Steps: 17 | Train Loss: 0.256 Vali Loss: 3.997 Vali Acc: 0.734 Test Loss: 3.997 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 757277607
model size : 2890.22MB
2025-04-28 03:37:15.395401: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:37:15.414283: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745811435.437630  224822 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745811435.444654  224822 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:37:15.467575: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.324031591415405
Epoch: 1, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.030 Vali Acc: 0.474 Test Loss: 1.030 Test Acc: 0.474
Validation loss decreased (inf --> -0.473978).  Saving model ...
Epoch: 2 cost time: 5.190817594528198
Epoch: 2, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.473978 --> -0.803462).  Saving model ...
Epoch: 3 cost time: 5.2088847160339355
Epoch: 3, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
Validation loss decreased (-0.803462 --> -0.843923).  Saving model ...
Epoch: 4 cost time: 5.125492095947266
Epoch: 4, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.832 Test Loss: 0.817 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.1177332401275635
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.130 Vali Acc: 0.780 Test Loss: 1.130 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.12727427482605
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.798 Test Loss: 0.789 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.1125328540802
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.984 Vali Acc: 0.780 Test Loss: 0.984 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.128201723098755
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.169 Vali Acc: 0.763 Test Loss: 1.169 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.109469175338745
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.381 Vali Acc: 0.717 Test Loss: 2.381 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.120859384536743
Epoch: 10, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.408 Vali Acc: 0.734 Test Loss: 1.408 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.1310179233551025
Epoch: 11, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.802 Vali Acc: 0.832 Test Loss: 1.802 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.1124043464660645
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.064 Vali Acc: 0.740 Test Loss: 2.064 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.12007737159729
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.600 Vali Acc: 0.769 Test Loss: 2.600 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 756414983
model size : 2886.93MB
2025-04-28 03:39:48.512829: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:39:48.531781: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745811588.556287  231099 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745811588.563864  231099 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:39:48.587910: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.242001533508301
Epoch: 1, Steps: 17 | Train Loss: 1.614 Vali Loss: 0.963 Vali Acc: 0.607 Test Loss: 0.963 Test Acc: 0.607
Validation loss decreased (inf --> -0.606927).  Saving model ...
Epoch: 2 cost time: 4.986833095550537
Epoch: 2, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.699 Vali Acc: 0.780 Test Loss: 0.699 Test Acc: 0.780
Validation loss decreased (-0.606927 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 5.0091552734375
Epoch: 3, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.815 Vali Acc: 0.786 Test Loss: 0.815 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786119).  Saving model ...
Epoch: 4 cost time: 5.029566764831543
Epoch: 4, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.809 Vali Acc: 0.751 Test Loss: 0.809 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.968984127044678
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.587 Vali Acc: 0.844 Test Loss: 0.587 Test Acc: 0.844
Validation loss decreased (-0.786119 --> -0.843925).  Saving model ...
Epoch: 6 cost time: 5.015746593475342
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.730 Vali Acc: 0.815 Test Loss: 0.730 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.991898536682129
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.197 Vali Acc: 0.775 Test Loss: 1.197 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.989666938781738
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.827 Test Loss: 0.678 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.971974849700928
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.821 Test Loss: 0.705 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.974902868270874
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.984008550643921
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.815 Test Loss: 0.670 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.97658109664917
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.98110294342041
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.969717741012573
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.9680304527282715
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.809 Test Loss: 0.648 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 755983783
model size : 2885.29MB
2025-04-28 03:46:53.327089: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:46:53.345474: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745812013.367407  240701 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745812013.374317  240701 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:46:53.396572: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 14.063209295272827
Epoch: 1, Steps: 17 | Train Loss: 13.065 Vali Loss: 13.952 Vali Acc: 0.590 Test Loss: 13.952 Test Acc: 0.590
Validation loss decreased (inf --> -0.589456).  Saving model ...
Epoch: 2 cost time: 13.059513092041016
Epoch: 2, Steps: 17 | Train Loss: 14.755 Vali Loss: 35.123 Vali Acc: 0.491 Test Loss: 35.123 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.028213024139404
Epoch: 3, Steps: 17 | Train Loss: 9.937 Vali Loss: 21.128 Vali Acc: 0.717 Test Loss: 21.128 Test Acc: 0.717
Validation loss decreased (-0.589456 --> -0.716552).  Saving model ...
Epoch: 4 cost time: 13.070985317230225
Epoch: 4, Steps: 17 | Train Loss: 8.551 Vali Loss: 44.558 Vali Acc: 0.566 Test Loss: 44.558 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.028223514556885
Epoch: 5, Steps: 17 | Train Loss: 4.206 Vali Loss: 44.794 Vali Acc: 0.468 Test Loss: 44.794 Test Acc: 0.468
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.030592918395996
Epoch: 6, Steps: 17 | Train Loss: 2.214 Vali Loss: 28.609 Vali Acc: 0.717 Test Loss: 28.609 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.026718854904175
Epoch: 7, Steps: 17 | Train Loss: 2.185 Vali Loss: 24.276 Vali Acc: 0.798 Test Loss: 24.276 Test Acc: 0.798
Validation loss decreased (-0.716552 --> -0.797445).  Saving model ...
Epoch: 8 cost time: 13.058343648910522
Epoch: 8, Steps: 17 | Train Loss: 2.148 Vali Loss: 38.648 Vali Acc: 0.682 Test Loss: 38.648 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.03747034072876
Epoch: 9, Steps: 17 | Train Loss: 0.917 Vali Loss: 48.604 Vali Acc: 0.676 Test Loss: 48.604 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.024605751037598
Epoch: 10, Steps: 17 | Train Loss: 1.851 Vali Loss: 28.464 Vali Acc: 0.763 Test Loss: 28.464 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.025020599365234
Epoch: 11, Steps: 17 | Train Loss: 1.170 Vali Loss: 28.585 Vali Acc: 0.757 Test Loss: 28.585 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.02554202079773
Epoch: 12, Steps: 17 | Train Loss: 3.269 Vali Loss: 25.283 Vali Acc: 0.734 Test Loss: 25.283 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.016563892364502
Epoch: 13, Steps: 17 | Train Loss: 0.765 Vali Loss: 27.487 Vali Acc: 0.717 Test Loss: 27.487 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.051018953323364
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 44.874 Vali Acc: 0.728 Test Loss: 44.874 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.008111000061035
Epoch: 15, Steps: 17 | Train Loss: 0.196 Vali Loss: 25.242 Vali Acc: 0.786 Test Loss: 25.242 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 13.005771398544312
Epoch: 16, Steps: 17 | Train Loss: 3.151 Vali Loss: 40.213 Vali Acc: 0.705 Test Loss: 40.213 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.99868392944336
Epoch: 17, Steps: 17 | Train Loss: 2.532 Vali Loss: 41.630 Vali Acc: 0.728 Test Loss: 41.630 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1141918855
model size : 4357.97MB
2025-04-28 03:54:24.145224: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 03:54:24.164183: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745812464.187186  249868 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745812464.194460  249868 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 03:54:24.217488: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.579763889312744
Epoch: 1, Steps: 17 | Train Loss: 10.620 Vali Loss: 12.749 Vali Acc: 0.468 Test Loss: 12.749 Test Acc: 0.468
Validation loss decreased (inf --> -0.468081).  Saving model ...
Epoch: 2 cost time: 7.55657696723938
Epoch: 2, Steps: 17 | Train Loss: 9.116 Vali Loss: 9.624 Vali Acc: 0.676 Test Loss: 9.624 Test Acc: 0.676
Validation loss decreased (-0.468081 --> -0.676204).  Saving model ...
Epoch: 3 cost time: 7.573163747787476
Epoch: 3, Steps: 17 | Train Loss: 8.636 Vali Loss: 36.287 Vali Acc: 0.572 Test Loss: 36.287 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.509586572647095
Epoch: 4, Steps: 17 | Train Loss: 3.831 Vali Loss: 9.016 Vali Acc: 0.740 Test Loss: 9.016 Test Acc: 0.740
Validation loss decreased (-0.676204 --> -0.739794).  Saving model ...
Epoch: 5 cost time: 7.551701068878174
Epoch: 5, Steps: 17 | Train Loss: 1.748 Vali Loss: 6.072 Vali Acc: 0.792 Test Loss: 6.072 Test Acc: 0.792
Validation loss decreased (-0.739794 --> -0.791847).  Saving model ...
Epoch: 6 cost time: 7.550344467163086
Epoch: 6, Steps: 17 | Train Loss: 2.370 Vali Loss: 22.181 Vali Acc: 0.624 Test Loss: 22.181 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.522509336471558
Epoch: 7, Steps: 17 | Train Loss: 1.692 Vali Loss: 14.963 Vali Acc: 0.705 Test Loss: 14.963 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.503790378570557
Epoch: 8, Steps: 17 | Train Loss: 0.859 Vali Loss: 11.928 Vali Acc: 0.763 Test Loss: 11.928 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.541290044784546
Epoch: 9, Steps: 17 | Train Loss: 1.410 Vali Loss: 10.486 Vali Acc: 0.798 Test Loss: 10.486 Test Acc: 0.798
Validation loss decreased (-0.791847 --> -0.797583).  Saving model ...
Epoch: 10 cost time: 7.556118011474609
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 10.404 Vali Acc: 0.798 Test Loss: 10.404 Test Acc: 0.798
Validation loss decreased (-0.797583 --> -0.797584).  Saving model ...
Epoch: 11 cost time: 7.566054821014404
Epoch: 11, Steps: 17 | Train Loss: 0.454 Vali Loss: 10.519 Vali Acc: 0.792 Test Loss: 10.519 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.532806396484375
Epoch: 12, Steps: 17 | Train Loss: 0.158 Vali Loss: 9.742 Vali Acc: 0.809 Test Loss: 9.742 Test Acc: 0.809
Validation loss decreased (-0.797584 --> -0.809151).  Saving model ...
Epoch: 13 cost time: 7.5555033683776855
Epoch: 13, Steps: 17 | Train Loss: 0.366 Vali Loss: 10.330 Vali Acc: 0.809 Test Loss: 10.330 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.539000034332275
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 7.344 Vali Acc: 0.827 Test Loss: 7.344 Test Acc: 0.827
Validation loss decreased (-0.809151 --> -0.826516).  Saving model ...
Epoch: 15 cost time: 7.56578803062439
Epoch: 15, Steps: 17 | Train Loss: 0.319 Vali Loss: 7.308 Vali Acc: 0.832 Test Loss: 7.308 Test Acc: 0.832
Validation loss decreased (-0.826516 --> -0.832297).  Saving model ...
Epoch: 16 cost time: 7.564196348190308
Epoch: 16, Steps: 17 | Train Loss: 0.131 Vali Loss: 8.356 Vali Acc: 0.809 Test Loss: 8.356 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.521472930908203
Epoch: 17, Steps: 17 | Train Loss: 0.292 Vali Loss: 22.837 Vali Acc: 0.751 Test Loss: 22.837 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.520805835723877
Epoch: 18, Steps: 17 | Train Loss: 2.398 Vali Loss: 7.308 Vali Acc: 0.838 Test Loss: 7.308 Test Acc: 0.838
Validation loss decreased (-0.832297 --> -0.838077).  Saving model ...
Epoch: 19 cost time: 7.530744552612305
Epoch: 19, Steps: 17 | Train Loss: 1.094 Vali Loss: 76.131 Vali Acc: 0.607 Test Loss: 76.131 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.526133298873901
Epoch: 20, Steps: 17 | Train Loss: 2.704 Vali Loss: 25.509 Vali Acc: 0.699 Test Loss: 25.509 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.518163442611694
Epoch: 21, Steps: 17 | Train Loss: 3.067 Vali Loss: 30.521 Vali Acc: 0.740 Test Loss: 30.521 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.51253342628479
Epoch: 22, Steps: 17 | Train Loss: 1.194 Vali Loss: 37.737 Vali Acc: 0.671 Test Loss: 37.737 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.511019706726074
Epoch: 23, Steps: 17 | Train Loss: 3.987 Vali Loss: 28.223 Vali Acc: 0.734 Test Loss: 28.223 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.525699853897095
Epoch: 24, Steps: 17 | Train Loss: 8.499 Vali Loss: 95.031 Vali Acc: 0.647 Test Loss: 95.031 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.5296971797943115
Epoch: 25, Steps: 17 | Train Loss: 7.343 Vali Loss: 90.762 Vali Acc: 0.694 Test Loss: 90.762 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.5242369174957275
Epoch: 26, Steps: 17 | Train Loss: 14.227 Vali Loss: 121.881 Vali Acc: 0.705 Test Loss: 121.881 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.523701906204224
Epoch: 27, Steps: 17 | Train Loss: 3.500 Vali Loss: 27.749 Vali Acc: 0.838 Test Loss: 27.749 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.527690410614014
Epoch: 28, Steps: 17 | Train Loss: 2.996 Vali Loss: 55.663 Vali Acc: 0.780 Test Loss: 55.663 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1110856839
model size : 4239.48MB
2025-04-28 04:02:12.855758: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:02:12.874527: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745812932.897268  263729 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745812932.904418  263729 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:02:12.927287: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.8100807666778564
Epoch: 1, Steps: 17 | Train Loss: 3.991 Vali Loss: 5.914 Vali Acc: 0.526 Test Loss: 5.914 Test Acc: 0.526
Validation loss decreased (inf --> -0.525952).  Saving model ...
Epoch: 2 cost time: 8.22897982597351
Epoch: 2, Steps: 17 | Train Loss: 2.975 Vali Loss: 8.978 Vali Acc: 0.624 Test Loss: 8.978 Test Acc: 0.624
Validation loss decreased (-0.525952 --> -0.624188).  Saving model ...
Epoch: 3 cost time: 6.716277360916138
Epoch: 3, Steps: 17 | Train Loss: 4.863 Vali Loss: 8.125 Vali Acc: 0.630 Test Loss: 8.125 Test Acc: 0.630
Validation loss decreased (-0.624188 --> -0.629977).  Saving model ...
Epoch: 4 cost time: 6.739062070846558
Epoch: 4, Steps: 17 | Train Loss: 4.088 Vali Loss: 15.874 Vali Acc: 0.561 Test Loss: 15.874 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.708300352096558
Epoch: 5, Steps: 17 | Train Loss: 1.736 Vali Loss: 12.703 Vali Acc: 0.642 Test Loss: 12.703 Test Acc: 0.642
Validation loss decreased (-0.629977 --> -0.641491).  Saving model ...
Epoch: 6 cost time: 6.758967161178589
Epoch: 6, Steps: 17 | Train Loss: 1.032 Vali Loss: 10.368 Vali Acc: 0.769 Test Loss: 10.368 Test Acc: 0.769
Validation loss decreased (-0.641491 --> -0.768682).  Saving model ...
Epoch: 7 cost time: 6.76916241645813
Epoch: 7, Steps: 17 | Train Loss: 0.842 Vali Loss: 10.370 Vali Acc: 0.723 Test Loss: 10.370 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.720319747924805
Epoch: 8, Steps: 17 | Train Loss: 0.984 Vali Loss: 9.928 Vali Acc: 0.786 Test Loss: 9.928 Test Acc: 0.786
Validation loss decreased (-0.768682 --> -0.786028).  Saving model ...
Epoch: 9 cost time: 6.771726846694946
Epoch: 9, Steps: 17 | Train Loss: 0.319 Vali Loss: 4.704 Vali Acc: 0.798 Test Loss: 4.704 Test Acc: 0.798
Validation loss decreased (-0.786028 --> -0.797641).  Saving model ...
Epoch: 10 cost time: 6.758984565734863
Epoch: 10, Steps: 17 | Train Loss: 0.983 Vali Loss: 19.237 Vali Acc: 0.723 Test Loss: 19.237 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.699578762054443
Epoch: 11, Steps: 17 | Train Loss: 0.285 Vali Loss: 15.909 Vali Acc: 0.694 Test Loss: 15.909 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.698137998580933
Epoch: 12, Steps: 17 | Train Loss: 0.675 Vali Loss: 8.807 Vali Acc: 0.711 Test Loss: 8.807 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.736526250839233
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 15.056 Vali Acc: 0.717 Test Loss: 15.056 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.714998722076416
Epoch: 14, Steps: 17 | Train Loss: 0.364 Vali Loss: 16.364 Vali Acc: 0.769 Test Loss: 16.364 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.718666315078735
Epoch: 15, Steps: 17 | Train Loss: 0.869 Vali Loss: 23.674 Vali Acc: 0.642 Test Loss: 23.674 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.724127531051636
Epoch: 16, Steps: 17 | Train Loss: 0.782 Vali Loss: 9.897 Vali Acc: 0.821 Test Loss: 9.897 Test Acc: 0.821
Validation loss decreased (-0.797641 --> -0.820710).  Saving model ...
Epoch: 17 cost time: 6.731026649475098
Epoch: 17, Steps: 17 | Train Loss: 0.630 Vali Loss: 13.909 Vali Acc: 0.751 Test Loss: 13.909 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.717007875442505
Epoch: 18, Steps: 17 | Train Loss: 1.118 Vali Loss: 14.734 Vali Acc: 0.792 Test Loss: 14.734 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.709395170211792
Epoch: 19, Steps: 17 | Train Loss: 0.776 Vali Loss: 18.911 Vali Acc: 0.775 Test Loss: 18.911 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.7220964431762695
Epoch: 20, Steps: 17 | Train Loss: 2.854 Vali Loss: 34.595 Vali Acc: 0.734 Test Loss: 34.595 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.712343215942383
Epoch: 21, Steps: 17 | Train Loss: 1.471 Vali Loss: 35.295 Vali Acc: 0.642 Test Loss: 35.295 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.714206695556641
Epoch: 22, Steps: 17 | Train Loss: 0.991 Vali Loss: 15.880 Vali Acc: 0.775 Test Loss: 15.880 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.709935903549194
Epoch: 23, Steps: 17 | Train Loss: 0.382 Vali Loss: 27.964 Vali Acc: 0.763 Test Loss: 27.964 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.706645250320435
Epoch: 24, Steps: 17 | Train Loss: 1.430 Vali Loss: 45.461 Vali Acc: 0.723 Test Loss: 45.461 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.708590030670166
Epoch: 25, Steps: 17 | Train Loss: 1.902 Vali Loss: 50.607 Vali Acc: 0.728 Test Loss: 50.607 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.700057506561279
Epoch: 26, Steps: 17 | Train Loss: 6.693 Vali Loss: 82.870 Vali Acc: 0.705 Test Loss: 82.870 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1100503047
model size : 4199.98MB
2025-04-28 04:08:43.996520: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:08:44.015195: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745813324.037728  276435 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745813324.044699  276435 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:08:44.067358: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.638186931610107
Epoch: 1, Steps: 17 | Train Loss: 3.087 Vali Loss: 5.591 Vali Acc: 0.578 Test Loss: 5.591 Test Acc: 0.578
Validation loss decreased (inf --> -0.577979).  Saving model ...
Epoch: 2 cost time: 6.511293888092041
Epoch: 2, Steps: 17 | Train Loss: 4.862 Vali Loss: 8.065 Vali Acc: 0.526 Test Loss: 8.065 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.463796138763428
Epoch: 3, Steps: 17 | Train Loss: 3.401 Vali Loss: 5.739 Vali Acc: 0.734 Test Loss: 5.739 Test Acc: 0.734
Validation loss decreased (-0.577979 --> -0.734047).  Saving model ...
Epoch: 4 cost time: 6.501130104064941
Epoch: 4, Steps: 17 | Train Loss: 0.920 Vali Loss: 8.362 Vali Acc: 0.757 Test Loss: 8.362 Test Acc: 0.757
Validation loss decreased (-0.734047 --> -0.757142).  Saving model ...
Epoch: 5 cost time: 6.501469850540161
Epoch: 5, Steps: 17 | Train Loss: 0.845 Vali Loss: 7.896 Vali Acc: 0.740 Test Loss: 7.896 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.491316318511963
Epoch: 6, Steps: 17 | Train Loss: 0.804 Vali Loss: 10.102 Vali Acc: 0.734 Test Loss: 10.102 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.498285531997681
Epoch: 7, Steps: 17 | Train Loss: 0.785 Vali Loss: 9.934 Vali Acc: 0.705 Test Loss: 9.934 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.495783805847168
Epoch: 8, Steps: 17 | Train Loss: 0.409 Vali Loss: 8.338 Vali Acc: 0.717 Test Loss: 8.338 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.497020483016968
Epoch: 9, Steps: 17 | Train Loss: 0.207 Vali Loss: 8.165 Vali Acc: 0.763 Test Loss: 8.165 Test Acc: 0.763
Validation loss decreased (-0.757142 --> -0.762924).  Saving model ...
Epoch: 10 cost time: 6.536873817443848
Epoch: 10, Steps: 17 | Train Loss: 0.331 Vali Loss: 9.842 Vali Acc: 0.769 Test Loss: 9.842 Test Acc: 0.769
Validation loss decreased (-0.762924 --> -0.768688).  Saving model ...
Epoch: 11 cost time: 6.5471813678741455
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 16.816 Vali Acc: 0.728 Test Loss: 16.816 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.486224412918091
Epoch: 12, Steps: 17 | Train Loss: 0.663 Vali Loss: 21.814 Vali Acc: 0.699 Test Loss: 21.814 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.489162921905518
Epoch: 13, Steps: 17 | Train Loss: 1.673 Vali Loss: 12.860 Vali Acc: 0.769 Test Loss: 12.860 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.4851624965667725
Epoch: 14, Steps: 17 | Train Loss: 0.298 Vali Loss: 10.454 Vali Acc: 0.809 Test Loss: 10.454 Test Acc: 0.809
Validation loss decreased (-0.768688 --> -0.809144).  Saving model ...
Epoch: 15 cost time: 6.548494338989258
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.547 Vali Acc: 0.815 Test Loss: 5.547 Test Acc: 0.815
Validation loss decreased (-0.809144 --> -0.814973).  Saving model ...
Epoch: 16 cost time: 6.501656770706177
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.873 Vali Acc: 0.832 Test Loss: 5.873 Test Acc: 0.832
Validation loss decreased (-0.814973 --> -0.832311).  Saving model ...
Epoch: 17 cost time: 6.529489994049072
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.970 Vali Acc: 0.827 Test Loss: 5.970 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.511157274246216
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.984 Vali Acc: 0.827 Test Loss: 5.984 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.530466794967651
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.996 Vali Acc: 0.821 Test Loss: 5.996 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.524837255477905
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.994 Vali Acc: 0.821 Test Loss: 5.994 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.49716854095459
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.973 Vali Acc: 0.821 Test Loss: 5.973 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.498718738555908
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.939 Vali Acc: 0.821 Test Loss: 5.939 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.529307126998901
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.991 Vali Acc: 0.821 Test Loss: 5.991 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.497743844985962
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.988 Vali Acc: 0.821 Test Loss: 5.988 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.499791860580444
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.985 Vali Acc: 0.821 Test Loss: 5.985 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.493697166442871
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.962 Vali Acc: 0.821 Test Loss: 5.962 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1095326471
model size : 4180.23MB
2025-04-28 04:15:03.737738: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:15:03.757135: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745813703.782102  289135 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745813703.789431  289135 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:15:03.813524: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.109099864959717
Epoch: 1, Steps: 17 | Train Loss: 2.549 Vali Loss: 2.721 Vali Acc: 0.607 Test Loss: 2.721 Test Acc: 0.607
Validation loss decreased (inf --> -0.606909).  Saving model ...
Epoch: 2 cost time: 6.97048544883728
Epoch: 2, Steps: 17 | Train Loss: 1.477 Vali Loss: 3.439 Vali Acc: 0.688 Test Loss: 3.439 Test Acc: 0.688
Validation loss decreased (-0.606909 --> -0.687827).  Saving model ...
Epoch: 3 cost time: 6.9963908195495605
Epoch: 3, Steps: 17 | Train Loss: 0.741 Vali Loss: 4.499 Vali Acc: 0.699 Test Loss: 4.499 Test Acc: 0.699
Validation loss decreased (-0.687827 --> -0.699377).  Saving model ...
Epoch: 4 cost time: 7.005018949508667
Epoch: 4, Steps: 17 | Train Loss: 2.877 Vali Loss: 8.398 Vali Acc: 0.682 Test Loss: 8.398 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.967024087905884
Epoch: 5, Steps: 17 | Train Loss: 2.808 Vali Loss: 7.792 Vali Acc: 0.659 Test Loss: 7.792 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.957772731781006
Epoch: 6, Steps: 17 | Train Loss: 1.351 Vali Loss: 4.764 Vali Acc: 0.705 Test Loss: 4.764 Test Acc: 0.705
Validation loss decreased (-0.699377 --> -0.705155).  Saving model ...
Epoch: 7 cost time: 7.0112833976745605
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 8.013 Vali Acc: 0.688 Test Loss: 8.013 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.956576347351074
Epoch: 8, Steps: 17 | Train Loss: 0.158 Vali Loss: 7.902 Vali Acc: 0.711 Test Loss: 7.902 Test Acc: 0.711
Validation loss decreased (-0.705155 --> -0.710904).  Saving model ...
Epoch: 9 cost time: 6.985304355621338
Epoch: 9, Steps: 17 | Train Loss: 0.388 Vali Loss: 10.873 Vali Acc: 0.705 Test Loss: 10.873 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.979327201843262
Epoch: 10, Steps: 17 | Train Loss: 0.552 Vali Loss: 7.933 Vali Acc: 0.746 Test Loss: 7.933 Test Acc: 0.746
Validation loss decreased (-0.710904 --> -0.745585).  Saving model ...
Epoch: 11 cost time: 6.993439197540283
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 7.066 Vali Acc: 0.775 Test Loss: 7.066 Test Acc: 0.775
Validation loss decreased (-0.745585 --> -0.774496).  Saving model ...
Epoch: 12 cost time: 6.998877763748169
Epoch: 12, Steps: 17 | Train Loss: 0.341 Vali Loss: 12.942 Vali Acc: 0.751 Test Loss: 12.942 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.953055143356323
Epoch: 13, Steps: 17 | Train Loss: 0.455 Vali Loss: 14.688 Vali Acc: 0.740 Test Loss: 14.688 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.979878664016724
Epoch: 14, Steps: 17 | Train Loss: 0.987 Vali Loss: 6.905 Vali Acc: 0.821 Test Loss: 6.905 Test Acc: 0.821
Validation loss decreased (-0.774496 --> -0.820740).  Saving model ...
Epoch: 15 cost time: 7.010686635971069
Epoch: 15, Steps: 17 | Train Loss: 0.821 Vali Loss: 7.243 Vali Acc: 0.821 Test Loss: 7.243 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.984313726425171
Epoch: 16, Steps: 17 | Train Loss: 0.118 Vali Loss: 7.493 Vali Acc: 0.815 Test Loss: 7.493 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.004274368286133
Epoch: 17, Steps: 17 | Train Loss: 0.772 Vali Loss: 23.102 Vali Acc: 0.723 Test Loss: 23.102 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.9896814823150635
Epoch: 18, Steps: 17 | Train Loss: 0.934 Vali Loss: 15.071 Vali Acc: 0.711 Test Loss: 15.071 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.9874842166900635
Epoch: 19, Steps: 17 | Train Loss: 1.102 Vali Loss: 28.368 Vali Acc: 0.728 Test Loss: 28.368 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.97827410697937
Epoch: 20, Steps: 17 | Train Loss: 0.921 Vali Loss: 14.791 Vali Acc: 0.815 Test Loss: 14.791 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.010459899902344
Epoch: 21, Steps: 17 | Train Loss: 0.913 Vali Loss: 16.871 Vali Acc: 0.734 Test Loss: 16.871 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.010577917098999
Epoch: 22, Steps: 17 | Train Loss: 0.832 Vali Loss: 14.818 Vali Acc: 0.717 Test Loss: 14.818 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.003647565841675
Epoch: 23, Steps: 17 | Train Loss: 1.069 Vali Loss: 18.274 Vali Acc: 0.746 Test Loss: 18.274 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 6.989451885223389
Epoch: 24, Steps: 17 | Train Loss: 0.960 Vali Loss: 32.935 Vali Acc: 0.711 Test Loss: 32.935 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1091013127
model size : 4163.78MB
2025-04-28 04:21:37.393041: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:21:37.412740: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745814097.435785  301076 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745814097.442837  301076 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:21:37.467180: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.387620687484741
Epoch: 1, Steps: 17 | Train Loss: 1.922 Vali Loss: 2.845 Vali Acc: 0.613 Test Loss: 2.845 Test Acc: 0.613
Validation loss decreased (inf --> -0.612688).  Saving model ...
Epoch: 2 cost time: 6.348308563232422
Epoch: 2, Steps: 17 | Train Loss: 0.909 Vali Loss: 3.528 Vali Acc: 0.636 Test Loss: 3.528 Test Acc: 0.636
Validation loss decreased (-0.612688 --> -0.635803).  Saving model ...
Epoch: 3 cost time: 6.306000709533691
Epoch: 3, Steps: 17 | Train Loss: 1.143 Vali Loss: 4.501 Vali Acc: 0.671 Test Loss: 4.501 Test Acc: 0.671
Validation loss decreased (-0.635803 --> -0.670475).  Saving model ...
Epoch: 4 cost time: 6.3215014934539795
Epoch: 4, Steps: 17 | Train Loss: 1.210 Vali Loss: 3.855 Vali Acc: 0.717 Test Loss: 3.855 Test Acc: 0.717
Validation loss decreased (-0.670475 --> -0.716724).  Saving model ...
Epoch: 5 cost time: 6.344459056854248
Epoch: 5, Steps: 17 | Train Loss: 1.336 Vali Loss: 9.211 Vali Acc: 0.682 Test Loss: 9.211 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.275544166564941
Epoch: 6, Steps: 17 | Train Loss: 1.303 Vali Loss: 7.023 Vali Acc: 0.763 Test Loss: 7.023 Test Acc: 0.763
Validation loss decreased (-0.716724 --> -0.762936).  Saving model ...
Epoch: 7 cost time: 6.33869481086731
Epoch: 7, Steps: 17 | Train Loss: 0.691 Vali Loss: 8.469 Vali Acc: 0.723 Test Loss: 8.469 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.280215263366699
Epoch: 8, Steps: 17 | Train Loss: 0.483 Vali Loss: 13.708 Vali Acc: 0.665 Test Loss: 13.708 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.315335035324097
Epoch: 9, Steps: 17 | Train Loss: 0.814 Vali Loss: 4.658 Vali Acc: 0.792 Test Loss: 4.658 Test Acc: 0.792
Validation loss decreased (-0.762936 --> -0.791861).  Saving model ...
Epoch: 10 cost time: 6.320127010345459
Epoch: 10, Steps: 17 | Train Loss: 0.175 Vali Loss: 8.540 Vali Acc: 0.746 Test Loss: 8.540 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.286547660827637
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 8.990 Vali Acc: 0.798 Test Loss: 8.990 Test Acc: 0.798
Validation loss decreased (-0.791861 --> -0.797598).  Saving model ...
Epoch: 12 cost time: 6.334477186203003
Epoch: 12, Steps: 17 | Train Loss: 0.182 Vali Loss: 8.608 Vali Acc: 0.769 Test Loss: 8.608 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.286961793899536
Epoch: 13, Steps: 17 | Train Loss: 0.782 Vali Loss: 5.246 Vali Acc: 0.832 Test Loss: 5.246 Test Acc: 0.832
Validation loss decreased (-0.797598 --> -0.832317).  Saving model ...
Epoch: 14 cost time: 6.327984094619751
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 5.900 Vali Acc: 0.832 Test Loss: 5.900 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.29291844367981
Epoch: 15, Steps: 17 | Train Loss: 0.832 Vali Loss: 4.554 Vali Acc: 0.827 Test Loss: 4.554 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.285539627075195
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 8.352 Vali Acc: 0.792 Test Loss: 8.352 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.272939443588257
Epoch: 17, Steps: 17 | Train Loss: 0.131 Vali Loss: 8.938 Vali Acc: 0.792 Test Loss: 8.938 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.29801344871521
Epoch: 18, Steps: 17 | Train Loss: 0.303 Vali Loss: 9.554 Vali Acc: 0.786 Test Loss: 9.554 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.288146734237671
Epoch: 19, Steps: 17 | Train Loss: 0.860 Vali Loss: 9.901 Vali Acc: 0.723 Test Loss: 9.901 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.279425859451294
Epoch: 20, Steps: 17 | Train Loss: 0.124 Vali Loss: 11.054 Vali Acc: 0.723 Test Loss: 11.054 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.28179144859314
Epoch: 21, Steps: 17 | Train Loss: 0.316 Vali Loss: 13.262 Vali Acc: 0.728 Test Loss: 13.262 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.302057266235352
Epoch: 22, Steps: 17 | Train Loss: 1.147 Vali Loss: 11.914 Vali Acc: 0.780 Test Loss: 11.914 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.27447247505188
Epoch: 23, Steps: 17 | Train Loss: 0.125 Vali Loss: 15.758 Vali Acc: 0.705 Test Loss: 15.758 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1087562631
model size : 4150.62MB
2025-04-28 04:33:23.106257: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:33:23.124967: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745814803.147443  325141 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745814803.154469  325141 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:33:23.177569: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.541533470153809
Epoch: 1, Steps: 17 | Train Loss: 2.134 Vali Loss: 1.890 Vali Acc: 0.740 Test Loss: 1.890 Test Acc: 0.740
Validation loss decreased (inf --> -0.739865).  Saving model ...
Epoch: 2 cost time: 6.442454814910889
Epoch: 2, Steps: 17 | Train Loss: 1.496 Vali Loss: 2.359 Vali Acc: 0.676 Test Loss: 2.359 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.415769338607788
Epoch: 3, Steps: 17 | Train Loss: 1.966 Vali Loss: 10.122 Vali Acc: 0.439 Test Loss: 10.122 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.404321193695068
Epoch: 4, Steps: 17 | Train Loss: 1.336 Vali Loss: 3.232 Vali Acc: 0.728 Test Loss: 3.232 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.424149751663208
Epoch: 5, Steps: 17 | Train Loss: 0.866 Vali Loss: 6.263 Vali Acc: 0.723 Test Loss: 6.263 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.4310221672058105
Epoch: 6, Steps: 17 | Train Loss: 0.676 Vali Loss: 4.717 Vali Acc: 0.792 Test Loss: 4.717 Test Acc: 0.792
Validation loss decreased (-0.739865 --> -0.791860).  Saving model ...
Epoch: 7 cost time: 6.485494136810303
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 4.157 Vali Acc: 0.798 Test Loss: 4.157 Test Acc: 0.798
Validation loss decreased (-0.791860 --> -0.797646).  Saving model ...
Epoch: 8 cost time: 6.454064846038818
Epoch: 8, Steps: 17 | Train Loss: 0.594 Vali Loss: 4.234 Vali Acc: 0.792 Test Loss: 4.234 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.410896301269531
Epoch: 9, Steps: 17 | Train Loss: 0.841 Vali Loss: 4.849 Vali Acc: 0.723 Test Loss: 4.849 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.38521409034729
Epoch: 10, Steps: 17 | Train Loss: 0.190 Vali Loss: 7.202 Vali Acc: 0.723 Test Loss: 7.202 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.404631853103638
Epoch: 11, Steps: 17 | Train Loss: 0.553 Vali Loss: 4.934 Vali Acc: 0.792 Test Loss: 4.934 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.367931604385376
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 5.288 Vali Acc: 0.786 Test Loss: 5.288 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.376566410064697
Epoch: 13, Steps: 17 | Train Loss: 0.401 Vali Loss: 5.931 Vali Acc: 0.740 Test Loss: 5.931 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.381076812744141
Epoch: 14, Steps: 17 | Train Loss: 0.168 Vali Loss: 7.654 Vali Acc: 0.780 Test Loss: 7.654 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.376339673995972
Epoch: 15, Steps: 17 | Train Loss: 0.234 Vali Loss: 13.061 Vali Acc: 0.746 Test Loss: 13.061 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.383584022521973
Epoch: 16, Steps: 17 | Train Loss: 1.337 Vali Loss: 10.055 Vali Acc: 0.746 Test Loss: 10.055 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.38862943649292
Epoch: 17, Steps: 17 | Train Loss: 0.410 Vali Loss: 10.195 Vali Acc: 0.746 Test Loss: 10.195 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 1086700679
model size : 4147.33MB
2025-04-28 04:37:18.372790: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:37:18.392081: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745815038.415440  333435 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745815038.422464  333435 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:37:18.446127: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.153816223144531
Epoch: 1, Steps: 17 | Train Loss: 10.238 Vali Loss: 9.929 Vali Acc: 0.486 Test Loss: 9.929 Test Acc: 0.486
Validation loss decreased (inf --> -0.485450).  Saving model ...
Epoch: 2 cost time: 6.064900875091553
Epoch: 2, Steps: 17 | Train Loss: 13.865 Vali Loss: 20.574 Vali Acc: 0.647 Test Loss: 20.574 Test Acc: 0.647
Validation loss decreased (-0.485450 --> -0.647193).  Saving model ...
Epoch: 3 cost time: 6.090642213821411
Epoch: 3, Steps: 17 | Train Loss: 7.221 Vali Loss: 13.819 Vali Acc: 0.601 Test Loss: 13.819 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.061222553253174
Epoch: 4, Steps: 17 | Train Loss: 2.941 Vali Loss: 9.913 Vali Acc: 0.659 Test Loss: 9.913 Test Acc: 0.659
Validation loss decreased (-0.647193 --> -0.658860).  Saving model ...
Epoch: 5 cost time: 6.090732097625732
Epoch: 5, Steps: 17 | Train Loss: 1.134 Vali Loss: 6.461 Vali Acc: 0.734 Test Loss: 6.461 Test Acc: 0.734
Validation loss decreased (-0.658860 --> -0.734039).  Saving model ...
Epoch: 6 cost time: 6.070485353469849
Epoch: 6, Steps: 17 | Train Loss: 0.273 Vali Loss: 12.826 Vali Acc: 0.711 Test Loss: 12.826 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.042755365371704
Epoch: 7, Steps: 17 | Train Loss: 0.905 Vali Loss: 14.226 Vali Acc: 0.711 Test Loss: 14.226 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.039258241653442
Epoch: 8, Steps: 17 | Train Loss: 0.708 Vali Loss: 11.168 Vali Acc: 0.705 Test Loss: 11.168 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.054027557373047
Epoch: 9, Steps: 17 | Train Loss: 0.255 Vali Loss: 11.559 Vali Acc: 0.694 Test Loss: 11.559 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.0491344928741455
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 17.070 Vali Acc: 0.647 Test Loss: 17.070 Test Acc: 0.647
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.045372247695923
Epoch: 11, Steps: 17 | Train Loss: 0.240 Vali Loss: 15.213 Vali Acc: 0.653 Test Loss: 15.213 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.052961826324463
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 14.361 Vali Acc: 0.653 Test Loss: 14.361 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.043383836746216
Epoch: 13, Steps: 17 | Train Loss: 0.145 Vali Loss: 13.687 Vali Acc: 0.659 Test Loss: 13.687 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.048759937286377
Epoch: 14, Steps: 17 | Train Loss: 0.482 Vali Loss: 21.742 Vali Acc: 0.671 Test Loss: 21.742 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.049251556396484
Epoch: 15, Steps: 17 | Train Loss: 0.726 Vali Loss: 16.504 Vali Acc: 0.682 Test Loss: 16.504 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7341040462427746
model parameter : 539403847
model size : 2058.62MB
2025-04-28 04:40:29.563529: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:40:29.582870: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745815229.606433  340713 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745815229.613590  340713 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:40:29.636808: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.742250204086304
Epoch: 1, Steps: 17 | Train Loss: 3.118 Vali Loss: 5.832 Vali Acc: 0.607 Test Loss: 5.832 Test Acc: 0.607
Validation loss decreased (inf --> -0.606878).  Saving model ...
Epoch: 2 cost time: 4.564930200576782
Epoch: 2, Steps: 17 | Train Loss: 4.183 Vali Loss: 6.534 Vali Acc: 0.659 Test Loss: 6.534 Test Acc: 0.659
Validation loss decreased (-0.606878 --> -0.658894).  Saving model ...
Epoch: 3 cost time: 4.543103933334351
Epoch: 3, Steps: 17 | Train Loss: 6.709 Vali Loss: 9.504 Vali Acc: 0.688 Test Loss: 9.504 Test Acc: 0.688
Validation loss decreased (-0.658894 --> -0.687766).  Saving model ...
Epoch: 4 cost time: 4.542450189590454
Epoch: 4, Steps: 17 | Train Loss: 1.487 Vali Loss: 7.421 Vali Acc: 0.717 Test Loss: 7.421 Test Acc: 0.717
Validation loss decreased (-0.687766 --> -0.716689).  Saving model ...
Epoch: 5 cost time: 4.555691957473755
Epoch: 5, Steps: 17 | Train Loss: 2.000 Vali Loss: 7.608 Vali Acc: 0.786 Test Loss: 7.608 Test Acc: 0.786
Validation loss decreased (-0.716689 --> -0.786051).  Saving model ...
Epoch: 6 cost time: 4.558458089828491
Epoch: 6, Steps: 17 | Train Loss: 0.696 Vali Loss: 10.809 Vali Acc: 0.676 Test Loss: 10.809 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.528994798660278
Epoch: 7, Steps: 17 | Train Loss: 0.857 Vali Loss: 3.185 Vali Acc: 0.792 Test Loss: 3.185 Test Acc: 0.792
Validation loss decreased (-0.786051 --> -0.791876).  Saving model ...
Epoch: 8 cost time: 4.528627157211304
Epoch: 8, Steps: 17 | Train Loss: 0.258 Vali Loss: 4.580 Vali Acc: 0.803 Test Loss: 4.580 Test Acc: 0.803
Validation loss decreased (-0.791876 --> -0.803422).  Saving model ...
Epoch: 9 cost time: 4.536238193511963
Epoch: 9, Steps: 17 | Train Loss: 0.348 Vali Loss: 4.129 Vali Acc: 0.832 Test Loss: 4.129 Test Acc: 0.832
Validation loss decreased (-0.803422 --> -0.832329).  Saving model ...
Epoch: 10 cost time: 4.532896041870117
Epoch: 10, Steps: 17 | Train Loss: 0.024 Vali Loss: 8.228 Vali Acc: 0.717 Test Loss: 8.228 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.508149862289429
Epoch: 11, Steps: 17 | Train Loss: 0.218 Vali Loss: 11.767 Vali Acc: 0.728 Test Loss: 11.767 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.551792621612549
Epoch: 12, Steps: 17 | Train Loss: 0.405 Vali Loss: 15.125 Vali Acc: 0.711 Test Loss: 15.125 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.514463424682617
Epoch: 13, Steps: 17 | Train Loss: 0.206 Vali Loss: 12.961 Vali Acc: 0.688 Test Loss: 12.961 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.4985456466674805
Epoch: 14, Steps: 17 | Train Loss: 0.158 Vali Loss: 12.154 Vali Acc: 0.659 Test Loss: 12.154 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.498384714126587
Epoch: 15, Steps: 17 | Train Loss: 0.342 Vali Loss: 9.945 Vali Acc: 0.751 Test Loss: 9.945 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.509262323379517
Epoch: 16, Steps: 17 | Train Loss: 0.751 Vali Loss: 11.217 Vali Acc: 0.809 Test Loss: 11.217 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.513392448425293
Epoch: 17, Steps: 17 | Train Loss: 0.042 Vali Loss: 9.967 Vali Acc: 0.746 Test Loss: 9.967 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.507359981536865
Epoch: 18, Steps: 17 | Train Loss: 0.115 Vali Loss: 12.540 Vali Acc: 0.740 Test Loss: 12.540 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.49017596244812
Epoch: 19, Steps: 17 | Train Loss: 0.459 Vali Loss: 7.540 Vali Acc: 0.780 Test Loss: 7.540 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 523872839
model size : 1999.37MB
2025-04-28 04:43:41.351674: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:43:41.370831: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745815421.394304  349674 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745815421.401324  349674 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:43:41.424529: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.2326819896698
Epoch: 1, Steps: 17 | Train Loss: 3.633 Vali Loss: 2.143 Vali Acc: 0.618 Test Loss: 2.143 Test Acc: 0.618
Validation loss decreased (inf --> -0.618476).  Saving model ...
Epoch: 2 cost time: 4.0394816398620605
Epoch: 2, Steps: 17 | Train Loss: 2.018 Vali Loss: 1.393 Vali Acc: 0.740 Test Loss: 1.393 Test Acc: 0.740
Validation loss decreased (-0.618476 --> -0.739870).  Saving model ...
Epoch: 3 cost time: 4.050725936889648
Epoch: 3, Steps: 17 | Train Loss: 0.733 Vali Loss: 3.813 Vali Acc: 0.717 Test Loss: 3.813 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.013611793518066
Epoch: 4, Steps: 17 | Train Loss: 1.617 Vali Loss: 4.215 Vali Acc: 0.711 Test Loss: 4.215 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.016823768615723
Epoch: 5, Steps: 17 | Train Loss: 0.779 Vali Loss: 3.849 Vali Acc: 0.803 Test Loss: 3.849 Test Acc: 0.803
Validation loss decreased (-0.739870 --> -0.803430).  Saving model ...
Epoch: 6 cost time: 4.038398742675781
Epoch: 6, Steps: 17 | Train Loss: 0.416 Vali Loss: 7.131 Vali Acc: 0.728 Test Loss: 7.131 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.0069358348846436
Epoch: 7, Steps: 17 | Train Loss: 0.194 Vali Loss: 5.066 Vali Acc: 0.809 Test Loss: 5.066 Test Acc: 0.809
Validation loss decreased (-0.803430 --> -0.809198).  Saving model ...
Epoch: 8 cost time: 4.062405586242676
Epoch: 8, Steps: 17 | Train Loss: 0.469 Vali Loss: 4.138 Vali Acc: 0.780 Test Loss: 4.138 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.031461715698242
Epoch: 9, Steps: 17 | Train Loss: 0.060 Vali Loss: 8.152 Vali Acc: 0.653 Test Loss: 8.152 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.014278411865234
Epoch: 10, Steps: 17 | Train Loss: 0.185 Vali Loss: 5.120 Vali Acc: 0.763 Test Loss: 5.120 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.026269197463989
Epoch: 11, Steps: 17 | Train Loss: 0.160 Vali Loss: 9.440 Vali Acc: 0.723 Test Loss: 9.440 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.014510631561279
Epoch: 12, Steps: 17 | Train Loss: 0.479 Vali Loss: 4.940 Vali Acc: 0.734 Test Loss: 4.940 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.013562440872192
Epoch: 13, Steps: 17 | Train Loss: 0.409 Vali Loss: 8.631 Vali Acc: 0.717 Test Loss: 8.631 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.028271913528442
Epoch: 14, Steps: 17 | Train Loss: 0.087 Vali Loss: 7.937 Vali Acc: 0.723 Test Loss: 7.937 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.004914045333862
Epoch: 15, Steps: 17 | Train Loss: 0.068 Vali Loss: 5.073 Vali Acc: 0.775 Test Loss: 5.073 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.0291523933410645
Epoch: 16, Steps: 17 | Train Loss: 0.357 Vali Loss: 10.076 Vali Acc: 0.699 Test Loss: 10.076 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.013350486755371
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 9.169 Vali Acc: 0.757 Test Loss: 9.169 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 518695943
model size : 1979.62MB
2025-04-28 04:46:07.638768: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:46:07.658361: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745815567.682141  357605 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745815567.689151  357605 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:46:07.712396: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.103245973587036
Epoch: 1, Steps: 17 | Train Loss: 2.808 Vali Loss: 3.210 Vali Acc: 0.491 Test Loss: 3.210 Test Acc: 0.491
Validation loss decreased (inf --> -0.491297).  Saving model ...
Epoch: 2 cost time: 3.917508602142334
Epoch: 2, Steps: 17 | Train Loss: 1.649 Vali Loss: 2.442 Vali Acc: 0.676 Test Loss: 2.442 Test Acc: 0.676
Validation loss decreased (-0.491297 --> -0.676276).  Saving model ...
Epoch: 3 cost time: 3.9388394355773926
Epoch: 3, Steps: 17 | Train Loss: 1.327 Vali Loss: 8.418 Vali Acc: 0.659 Test Loss: 8.418 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9063096046447754
Epoch: 4, Steps: 17 | Train Loss: 2.222 Vali Loss: 10.235 Vali Acc: 0.630 Test Loss: 10.235 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.882984161376953
Epoch: 5, Steps: 17 | Train Loss: 1.224 Vali Loss: 4.455 Vali Acc: 0.734 Test Loss: 4.455 Test Acc: 0.734
Validation loss decreased (-0.676276 --> -0.734059).  Saving model ...
Epoch: 6 cost time: 3.9488794803619385
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 6.603 Vali Acc: 0.699 Test Loss: 6.603 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.87286376953125
Epoch: 7, Steps: 17 | Train Loss: 0.146 Vali Loss: 6.271 Vali Acc: 0.734 Test Loss: 6.271 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8969902992248535
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 10.387 Vali Acc: 0.699 Test Loss: 10.387 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.87648606300354
Epoch: 9, Steps: 17 | Train Loss: 0.619 Vali Loss: 6.298 Vali Acc: 0.699 Test Loss: 6.298 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.887871742248535
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 8.412 Vali Acc: 0.642 Test Loss: 8.412 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.8911731243133545
Epoch: 11, Steps: 17 | Train Loss: 0.021 Vali Loss: 9.295 Vali Acc: 0.682 Test Loss: 9.295 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.886202096939087
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 5.814 Vali Acc: 0.740 Test Loss: 5.814 Test Acc: 0.740
Validation loss decreased (-0.734059 --> -0.739826).  Saving model ...
Epoch: 13 cost time: 3.9015731811523438
Epoch: 13, Steps: 17 | Train Loss: 0.043 Vali Loss: 4.842 Vali Acc: 0.717 Test Loss: 4.842 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.8874692916870117
Epoch: 14, Steps: 17 | Train Loss: 0.582 Vali Loss: 7.512 Vali Acc: 0.705 Test Loss: 7.512 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.882800579071045
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 4.997 Vali Acc: 0.728 Test Loss: 4.997 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8900489807128906
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.475 Vali Acc: 0.728 Test Loss: 4.475 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.8819637298583984
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.000 Vali Acc: 0.711 Test Loss: 5.000 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.886188507080078
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.049 Vali Acc: 0.711 Test Loss: 5.049 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.893399238586426
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.057 Vali Acc: 0.711 Test Loss: 5.057 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.8900704383850098
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.028 Vali Acc: 0.711 Test Loss: 5.028 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.871589422225952
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.041 Vali Acc: 0.711 Test Loss: 5.041 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.888176441192627
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.034 Vali Acc: 0.711 Test Loss: 5.034 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7398843930635838
model parameter : 516107655
model size : 1969.75MB
2025-04-28 04:49:02.230429: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:49:02.249559: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745815742.272559  367751 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745815742.279697  367751 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:49:02.303895: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.214648485183716
Epoch: 1, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.049 Vali Acc: 0.584 Test Loss: 2.049 Test Acc: 0.584
Validation loss decreased (inf --> -0.583795).  Saving model ...
Epoch: 2 cost time: 4.041452407836914
Epoch: 2, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.027 Vali Acc: 0.769 Test Loss: 1.027 Test Acc: 0.769
Validation loss decreased (-0.583795 --> -0.768776).  Saving model ...
Epoch: 3 cost time: 4.0413432121276855
Epoch: 3, Steps: 17 | Train Loss: 0.304 Vali Loss: 5.085 Vali Acc: 0.595 Test Loss: 5.085 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.039406776428223
Epoch: 4, Steps: 17 | Train Loss: 1.434 Vali Loss: 5.073 Vali Acc: 0.682 Test Loss: 5.073 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.046518087387085
Epoch: 5, Steps: 17 | Train Loss: 0.395 Vali Loss: 3.497 Vali Acc: 0.723 Test Loss: 3.497 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.024504661560059
Epoch: 6, Steps: 17 | Train Loss: 0.317 Vali Loss: 2.240 Vali Acc: 0.763 Test Loss: 2.240 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.011328220367432
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.349 Vali Acc: 0.775 Test Loss: 2.349 Test Acc: 0.775
Validation loss decreased (-0.768776 --> -0.774543).  Saving model ...
Epoch: 8 cost time: 4.039072513580322
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 4.209 Vali Acc: 0.763 Test Loss: 4.209 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.015660524368286
Epoch: 9, Steps: 17 | Train Loss: 0.133 Vali Loss: 3.388 Vali Acc: 0.717 Test Loss: 3.388 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.006790399551392
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 6.763 Vali Acc: 0.740 Test Loss: 6.763 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.031225204467773
Epoch: 11, Steps: 17 | Train Loss: 0.235 Vali Loss: 5.169 Vali Acc: 0.746 Test Loss: 5.169 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.027438163757324
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 4.638 Vali Acc: 0.769 Test Loss: 4.638 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.0140464305877686
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 5.064 Vali Acc: 0.763 Test Loss: 5.064 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.038330793380737
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 5.921 Vali Acc: 0.734 Test Loss: 5.921 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.014669895172119
Epoch: 15, Steps: 17 | Train Loss: 0.090 Vali Loss: 6.926 Vali Acc: 0.699 Test Loss: 6.926 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.0395543575286865
Epoch: 16, Steps: 17 | Train Loss: 0.253 Vali Loss: 4.337 Vali Acc: 0.734 Test Loss: 4.337 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.030316591262817
Epoch: 17, Steps: 17 | Train Loss: 0.352 Vali Loss: 3.930 Vali Acc: 0.769 Test Loss: 3.930 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 513950983
model size : 1961.52MB
2025-04-28 04:51:30.947814: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:51:30.966692: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745815890.989442  375743 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745815890.996420  375743 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:51:31.019369: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.0177001953125
Epoch: 1, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.290 Vali Acc: 0.636 Test Loss: 1.290 Test Acc: 0.636
Validation loss decreased (inf --> -0.635825).  Saving model ...
Epoch: 2 cost time: 3.845468044281006
Epoch: 2, Steps: 17 | Train Loss: 0.329 Vali Loss: 2.479 Vali Acc: 0.723 Test Loss: 2.479 Test Acc: 0.723
Validation loss decreased (-0.635825 --> -0.722519).  Saving model ...
Epoch: 3 cost time: 3.8304851055145264
Epoch: 3, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.883 Vali Acc: 0.815 Test Loss: 0.883 Test Acc: 0.815
Validation loss decreased (-0.722519 --> -0.815020).  Saving model ...
Epoch: 4 cost time: 3.8584742546081543
Epoch: 4, Steps: 17 | Train Loss: 0.452 Vali Loss: 1.894 Vali Acc: 0.728 Test Loss: 1.894 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.825467586517334
Epoch: 5, Steps: 17 | Train Loss: 0.272 Vali Loss: 3.225 Vali Acc: 0.734 Test Loss: 3.225 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.8164145946502686
Epoch: 6, Steps: 17 | Train Loss: 0.435 Vali Loss: 3.130 Vali Acc: 0.780 Test Loss: 3.130 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8437018394470215
Epoch: 7, Steps: 17 | Train Loss: 0.099 Vali Loss: 2.380 Vali Acc: 0.746 Test Loss: 2.380 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.8194193840026855
Epoch: 8, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.812 Vali Acc: 0.775 Test Loss: 2.812 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8154609203338623
Epoch: 9, Steps: 17 | Train Loss: 0.153 Vali Loss: 3.074 Vali Acc: 0.728 Test Loss: 3.074 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.812279224395752
Epoch: 10, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.776 Vali Acc: 0.757 Test Loss: 2.776 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.806570291519165
Epoch: 11, Steps: 17 | Train Loss: 0.154 Vali Loss: 3.820 Vali Acc: 0.757 Test Loss: 3.820 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.816035270690918
Epoch: 12, Steps: 17 | Train Loss: 0.488 Vali Loss: 5.941 Vali Acc: 0.711 Test Loss: 5.941 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.8419735431671143
Epoch: 13, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.501 Vali Acc: 0.838 Test Loss: 1.501 Test Acc: 0.838
Validation loss decreased (-0.815020 --> -0.838135).  Saving model ...
Epoch: 14 cost time: 3.865103006362915
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 5.138 Vali Acc: 0.769 Test Loss: 5.138 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8571012020111084
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 6.214 Vali Acc: 0.757 Test Loss: 6.214 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8385934829711914
Epoch: 16, Steps: 17 | Train Loss: 0.082 Vali Loss: 5.019 Vali Acc: 0.751 Test Loss: 5.019 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.838231325149536
Epoch: 17, Steps: 17 | Train Loss: 0.120 Vali Loss: 2.988 Vali Acc: 0.815 Test Loss: 2.988 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.854713201522827
Epoch: 18, Steps: 17 | Train Loss: 0.271 Vali Loss: 4.641 Vali Acc: 0.792 Test Loss: 4.641 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8258378505706787
Epoch: 19, Steps: 17 | Train Loss: 0.101 Vali Loss: 7.504 Vali Acc: 0.775 Test Loss: 7.504 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.83022403717041
Epoch: 20, Steps: 17 | Train Loss: 0.062 Vali Loss: 4.268 Vali Acc: 0.734 Test Loss: 4.268 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8308043479919434
Epoch: 21, Steps: 17 | Train Loss: 0.143 Vali Loss: 3.061 Vali Acc: 0.827 Test Loss: 3.061 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.8305435180664062
Epoch: 22, Steps: 17 | Train Loss: 0.607 Vali Loss: 3.618 Vali Acc: 0.815 Test Loss: 3.618 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8426756858825684
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 7.116 Vali Acc: 0.786 Test Loss: 7.116 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 512225735
model size : 1954.94MB
2025-04-28 04:54:35.918500: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:54:35.937539: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745816075.961229  386353 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745816075.968630  386353 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:54:35.991961: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.864838123321533
Epoch: 1, Steps: 17 | Train Loss: 1.791 Vali Loss: 1.768 Vali Acc: 0.555 Test Loss: 1.768 Test Acc: 0.555
Validation loss decreased (inf --> -0.554896).  Saving model ...
Epoch: 2 cost time: 3.737886905670166
Epoch: 2, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.307 Vali Acc: 0.671 Test Loss: 1.307 Test Acc: 0.671
Validation loss decreased (-0.554896 --> -0.670507).  Saving model ...
Epoch: 3 cost time: 3.7296335697174072
Epoch: 3, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.668 Vali Acc: 0.740 Test Loss: 1.668 Test Acc: 0.740
Validation loss decreased (-0.670507 --> -0.739868).  Saving model ...
Epoch: 4 cost time: 3.7496187686920166
Epoch: 4, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.882 Vali Acc: 0.786 Test Loss: 1.882 Test Acc: 0.786
Validation loss decreased (-0.739868 --> -0.786108).  Saving model ...
Epoch: 5 cost time: 3.7465085983276367
Epoch: 5, Steps: 17 | Train Loss: 0.224 Vali Loss: 2.230 Vali Acc: 0.775 Test Loss: 2.230 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7071309089660645
Epoch: 6, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.512 Vali Acc: 0.792 Test Loss: 2.512 Test Acc: 0.792
Validation loss decreased (-0.786108 --> -0.791882).  Saving model ...
Epoch: 7 cost time: 3.7227399349212646
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 4.167 Vali Acc: 0.775 Test Loss: 4.167 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.703284740447998
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 2.103 Vali Acc: 0.798 Test Loss: 2.103 Test Acc: 0.798
Validation loss decreased (-0.791882 --> -0.797667).  Saving model ...
Epoch: 9 cost time: 3.7345104217529297
Epoch: 9, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.802 Vali Acc: 0.769 Test Loss: 2.802 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.694518804550171
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.562 Vali Acc: 0.780 Test Loss: 2.562 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.701542615890503
Epoch: 11, Steps: 17 | Train Loss: 0.283 Vali Loss: 2.145 Vali Acc: 0.792 Test Loss: 2.145 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6871912479400635
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.116 Vali Acc: 0.798 Test Loss: 2.116 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.714186906814575
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.731 Vali Acc: 0.792 Test Loss: 3.731 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.7209861278533936
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 3.390 Vali Acc: 0.780 Test Loss: 3.390 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.694147825241089
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 5.467 Vali Acc: 0.734 Test Loss: 5.467 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.702003002166748
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 3.483 Vali Acc: 0.757 Test Loss: 3.483 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.69454026222229
Epoch: 17, Steps: 17 | Train Loss: 0.223 Vali Loss: 4.549 Vali Acc: 0.775 Test Loss: 4.549 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.6933982372283936
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 3.177 Vali Acc: 0.792 Test Loss: 3.177 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 511794759
model size : 1953.30MB
2025-04-28 04:57:19.636605: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 04:57:19.655488: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745816239.677798  394781 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745816239.684638  394781 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 04:57:19.707617: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.960768938064575
Epoch: 1, Steps: 17 | Train Loss: 4.958 Vali Loss: 6.006 Vali Acc: 0.462 Test Loss: 6.006 Test Acc: 0.462
Validation loss decreased (inf --> -0.462368).  Saving model ...
Epoch: 2 cost time: 3.7660329341888428
Epoch: 2, Steps: 17 | Train Loss: 2.885 Vali Loss: 10.641 Vali Acc: 0.607 Test Loss: 10.641 Test Acc: 0.607
Validation loss decreased (-0.462368 --> -0.606830).  Saving model ...
Epoch: 3 cost time: 3.754667043685913
Epoch: 3, Steps: 17 | Train Loss: 3.685 Vali Loss: 11.329 Vali Acc: 0.618 Test Loss: 11.329 Test Acc: 0.618
Validation loss decreased (-0.606830 --> -0.618384).  Saving model ...
Epoch: 4 cost time: 3.7426135540008545
Epoch: 4, Steps: 17 | Train Loss: 1.275 Vali Loss: 10.369 Vali Acc: 0.682 Test Loss: 10.369 Test Acc: 0.682
Validation loss decreased (-0.618384 --> -0.681977).  Saving model ...
Epoch: 5 cost time: 3.729030132293701
Epoch: 5, Steps: 17 | Train Loss: 1.855 Vali Loss: 10.246 Vali Acc: 0.647 Test Loss: 10.246 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6977784633636475
Epoch: 6, Steps: 17 | Train Loss: 1.232 Vali Loss: 10.949 Vali Acc: 0.578 Test Loss: 10.949 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.689943790435791
Epoch: 7, Steps: 17 | Train Loss: 0.391 Vali Loss: 13.812 Vali Acc: 0.659 Test Loss: 13.812 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.699014902114868
Epoch: 8, Steps: 17 | Train Loss: 1.566 Vali Loss: 12.481 Vali Acc: 0.751 Test Loss: 12.481 Test Acc: 0.751
Validation loss decreased (-0.681977 --> -0.751320).  Saving model ...
Epoch: 9 cost time: 3.742926597595215
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 4.701 Vali Acc: 0.792 Test Loss: 4.701 Test Acc: 0.792
Validation loss decreased (-0.751320 --> -0.791861).  Saving model ...
Epoch: 10 cost time: 3.7464749813079834
Epoch: 10, Steps: 17 | Train Loss: 0.143 Vali Loss: 4.893 Vali Acc: 0.844 Test Loss: 4.893 Test Acc: 0.844
Validation loss decreased (-0.791861 --> -0.843882).  Saving model ...
Epoch: 11 cost time: 3.7225565910339355
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 5.187 Vali Acc: 0.769 Test Loss: 5.187 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.671124219894409
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 5.954 Vali Acc: 0.792 Test Loss: 5.954 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.693859338760376
Epoch: 13, Steps: 17 | Train Loss: 0.194 Vali Loss: 5.583 Vali Acc: 0.763 Test Loss: 5.583 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.6599857807159424
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 5.648 Vali Acc: 0.780 Test Loss: 5.648 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.700544595718384
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 9.629 Vali Acc: 0.682 Test Loss: 9.629 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.6700212955474854
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 4.907 Vali Acc: 0.734 Test Loss: 4.907 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.674118757247925
Epoch: 17, Steps: 17 | Train Loss: 0.081 Vali Loss: 5.940 Vali Acc: 0.728 Test Loss: 5.940 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.684093713760376
Epoch: 18, Steps: 17 | Train Loss: 0.109 Vali Loss: 5.839 Vali Acc: 0.792 Test Loss: 5.839 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.6944966316223145
Epoch: 19, Steps: 17 | Train Loss: 0.161 Vali Loss: 14.115 Vali Acc: 0.694 Test Loss: 14.115 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6803395748138428
Epoch: 20, Steps: 17 | Train Loss: 0.646 Vali Loss: 4.942 Vali Acc: 0.728 Test Loss: 4.942 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 261813031
model size : 999.22MB
2025-04-28 05:00:01.898356: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:00:01.917459: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745816401.940387  404036 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745816401.947300  404036 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:00:01.970062: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8382959365844727
Epoch: 1, Steps: 17 | Train Loss: 2.383 Vali Loss: 3.178 Vali Acc: 0.526 Test Loss: 3.178 Test Acc: 0.526
Validation loss decreased (inf --> -0.525980).  Saving model ...
Epoch: 2 cost time: 2.636174440383911
Epoch: 2, Steps: 17 | Train Loss: 1.240 Vali Loss: 3.286 Vali Acc: 0.665 Test Loss: 3.286 Test Acc: 0.665
Validation loss decreased (-0.525980 --> -0.664707).  Saving model ...
Epoch: 3 cost time: 2.6202516555786133
Epoch: 3, Steps: 17 | Train Loss: 1.324 Vali Loss: 2.804 Vali Acc: 0.769 Test Loss: 2.804 Test Acc: 0.769
Validation loss decreased (-0.664707 --> -0.768758).  Saving model ...
Epoch: 4 cost time: 2.6487531661987305
Epoch: 4, Steps: 17 | Train Loss: 0.518 Vali Loss: 6.461 Vali Acc: 0.636 Test Loss: 6.461 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.591148614883423
Epoch: 5, Steps: 17 | Train Loss: 1.521 Vali Loss: 5.449 Vali Acc: 0.723 Test Loss: 5.449 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5741159915924072
Epoch: 6, Steps: 17 | Train Loss: 0.355 Vali Loss: 4.105 Vali Acc: 0.665 Test Loss: 4.105 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5867226123809814
Epoch: 7, Steps: 17 | Train Loss: 0.276 Vali Loss: 2.545 Vali Acc: 0.792 Test Loss: 2.545 Test Acc: 0.792
Validation loss decreased (-0.768758 --> -0.791882).  Saving model ...
Epoch: 8 cost time: 4.751633644104004
Epoch: 8, Steps: 17 | Train Loss: 0.335 Vali Loss: 4.530 Vali Acc: 0.694 Test Loss: 4.530 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5764310359954834
Epoch: 9, Steps: 17 | Train Loss: 0.054 Vali Loss: 4.243 Vali Acc: 0.682 Test Loss: 4.243 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5789241790771484
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 5.449 Vali Acc: 0.775 Test Loss: 5.449 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5907745361328125
Epoch: 11, Steps: 17 | Train Loss: 0.070 Vali Loss: 4.964 Vali Acc: 0.723 Test Loss: 4.964 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.592595338821411
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.824 Vali Acc: 0.775 Test Loss: 2.824 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6005711555480957
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 4.598 Vali Acc: 0.734 Test Loss: 4.598 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.581406354904175
Epoch: 14, Steps: 17 | Train Loss: 0.116 Vali Loss: 2.621 Vali Acc: 0.763 Test Loss: 2.621 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5704169273376465
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 4.399 Vali Acc: 0.769 Test Loss: 4.399 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6056807041168213
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.403 Vali Acc: 0.780 Test Loss: 5.403 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.583479642868042
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.797 Vali Acc: 0.780 Test Loss: 4.797 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 254047527
model size : 969.60MB
2025-04-28 05:01:51.185995: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:01:51.204722: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745816511.227607  411813 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745816511.234544  411813 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:01:51.257228: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5554633140563965
Epoch: 1, Steps: 17 | Train Loss: 1.984 Vali Loss: 1.979 Vali Acc: 0.572 Test Loss: 1.979 Test Acc: 0.572
Validation loss decreased (inf --> -0.572235).  Saving model ...
Epoch: 2 cost time: 2.4127697944641113
Epoch: 2, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.626 Vali Acc: 0.659 Test Loss: 2.626 Test Acc: 0.659
Validation loss decreased (-0.572235 --> -0.658933).  Saving model ...
Epoch: 3 cost time: 2.3797760009765625
Epoch: 3, Steps: 17 | Train Loss: 0.910 Vali Loss: 2.888 Vali Acc: 0.682 Test Loss: 2.888 Test Acc: 0.682
Validation loss decreased (-0.658933 --> -0.682052).  Saving model ...
Epoch: 4 cost time: 2.40360164642334
Epoch: 4, Steps: 17 | Train Loss: 0.305 Vali Loss: 1.831 Vali Acc: 0.746 Test Loss: 1.831 Test Acc: 0.746
Validation loss decreased (-0.682052 --> -0.745646).  Saving model ...
Epoch: 5 cost time: 2.3721346855163574
Epoch: 5, Steps: 17 | Train Loss: 0.354 Vali Loss: 4.853 Vali Acc: 0.682 Test Loss: 4.853 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.349440813064575
Epoch: 6, Steps: 17 | Train Loss: 1.151 Vali Loss: 2.926 Vali Acc: 0.711 Test Loss: 2.926 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.352818727493286
Epoch: 7, Steps: 17 | Train Loss: 0.187 Vali Loss: 3.491 Vali Acc: 0.705 Test Loss: 3.491 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.365291118621826
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.730 Vali Acc: 0.798 Test Loss: 2.730 Test Acc: 0.798
Validation loss decreased (-0.745646 --> -0.797661).  Saving model ...
Epoch: 9 cost time: 2.8088579177856445
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 4.710 Vali Acc: 0.734 Test Loss: 4.710 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3615379333496094
Epoch: 10, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.589 Vali Acc: 0.757 Test Loss: 2.589 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.361650228500366
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.634 Vali Acc: 0.803 Test Loss: 2.634 Test Acc: 0.803
Validation loss decreased (-0.797661 --> -0.803442).  Saving model ...
Epoch: 12 cost time: 2.411224126815796
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.902 Vali Acc: 0.792 Test Loss: 2.902 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3446433544158936
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.799 Vali Acc: 0.769 Test Loss: 2.799 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.335007667541504
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 4.506 Vali Acc: 0.746 Test Loss: 4.506 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3435890674591064
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.186 Vali Acc: 0.734 Test Loss: 5.186 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.350625514984131
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.865 Vali Acc: 0.740 Test Loss: 4.865 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.367960214614868
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.858 Vali Acc: 0.740 Test Loss: 4.858 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3609962463378906
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.809 Vali Acc: 0.740 Test Loss: 4.809 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.361539602279663
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.780 Vali Acc: 0.740 Test Loss: 4.780 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3570053577423096
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.757 Vali Acc: 0.740 Test Loss: 4.757 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.3490238189697266
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.735 Vali Acc: 0.740 Test Loss: 4.735 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 251459079
model size : 959.72MB
2025-04-28 05:03:55.295639: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:03:55.314503: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745816635.337816  421334 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745816635.344845  421334 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:03:55.368043: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.527613639831543
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.518 Vali Acc: 0.497 Test Loss: 1.518 Test Acc: 0.497
Validation loss decreased (inf --> -0.497095).  Saving model ...
Epoch: 2 cost time: 2.3549256324768066
Epoch: 2, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.329 Vali Acc: 0.728 Test Loss: 1.329 Test Acc: 0.728
Validation loss decreased (-0.497095 --> -0.728310).  Saving model ...
Epoch: 3 cost time: 2.881118059158325
Epoch: 3, Steps: 17 | Train Loss: 0.508 Vali Loss: 2.133 Vali Acc: 0.699 Test Loss: 2.133 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.289792776107788
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 3.193 Vali Acc: 0.699 Test Loss: 3.193 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2824058532714844
Epoch: 5, Steps: 17 | Train Loss: 0.178 Vali Loss: 3.125 Vali Acc: 0.723 Test Loss: 3.125 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2848992347717285
Epoch: 6, Steps: 17 | Train Loss: 0.164 Vali Loss: 5.513 Vali Acc: 0.642 Test Loss: 5.513 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2712948322296143
Epoch: 7, Steps: 17 | Train Loss: 0.329 Vali Loss: 4.896 Vali Acc: 0.659 Test Loss: 4.896 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2949624061584473
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 3.725 Vali Acc: 0.757 Test Loss: 3.725 Test Acc: 0.757
Validation loss decreased (-0.728310 --> -0.757188).  Saving model ...
Epoch: 9 cost time: 4.308728933334351
Epoch: 9, Steps: 17 | Train Loss: 0.285 Vali Loss: 3.604 Vali Acc: 0.717 Test Loss: 3.604 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.261683702468872
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 3.181 Vali Acc: 0.717 Test Loss: 3.181 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.297085762023926
Epoch: 11, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.627 Vali Acc: 0.740 Test Loss: 1.627 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.287381887435913
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.212 Vali Acc: 0.769 Test Loss: 2.212 Test Acc: 0.769
Validation loss decreased (-0.757188 --> -0.768764).  Saving model ...
Epoch: 13 cost time: 3.1037371158599854
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.557 Vali Acc: 0.763 Test Loss: 1.557 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.263181686401367
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.747 Vali Acc: 0.751 Test Loss: 2.747 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2897543907165527
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 2.716 Vali Acc: 0.728 Test Loss: 2.716 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2650461196899414
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 3.959 Vali Acc: 0.694 Test Loss: 3.959 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.275123357772827
Epoch: 17, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.803 Vali Acc: 0.711 Test Loss: 2.803 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2641358375549316
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.285 Vali Acc: 0.723 Test Loss: 3.285 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2897207736968994
Epoch: 19, Steps: 17 | Train Loss: 0.065 Vali Loss: 8.016 Vali Acc: 0.711 Test Loss: 8.016 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.280103921890259
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 4.073 Vali Acc: 0.769 Test Loss: 4.073 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2942540645599365
Epoch: 21, Steps: 17 | Train Loss: 0.096 Vali Loss: 6.322 Vali Acc: 0.711 Test Loss: 6.322 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2989981174468994
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 7.672 Vali Acc: 0.728 Test Loss: 7.672 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 250164935
model size : 954.79MB
2025-04-28 05:06:00.120556: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:06:00.139379: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745816760.161779  431279 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745816760.168854  431279 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:06:00.191817: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5762815475463867
Epoch: 1, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.145 Vali Acc: 0.561 Test Loss: 1.145 Test Acc: 0.561
Validation loss decreased (inf --> -0.560682).  Saving model ...
Epoch: 2 cost time: 4.2843029499053955
Epoch: 2, Steps: 17 | Train Loss: 0.719 Vali Loss: 1.813 Vali Acc: 0.601 Test Loss: 1.813 Test Acc: 0.601
Validation loss decreased (-0.560682 --> -0.601138).  Saving model ...
Epoch: 3 cost time: 2.3877220153808594
Epoch: 3, Steps: 17 | Train Loss: 0.309 Vali Loss: 1.508 Vali Acc: 0.717 Test Loss: 1.508 Test Acc: 0.717
Validation loss decreased (-0.601138 --> -0.716748).  Saving model ...
Epoch: 4 cost time: 2.355149269104004
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 2.101 Vali Acc: 0.705 Test Loss: 2.101 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.37109112739563
Epoch: 5, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.916 Vali Acc: 0.734 Test Loss: 2.916 Test Acc: 0.734
Validation loss decreased (-0.716748 --> -0.734075).  Saving model ...
Epoch: 6 cost time: 2.3630852699279785
Epoch: 6, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.707 Vali Acc: 0.751 Test Loss: 1.707 Test Acc: 0.751
Validation loss decreased (-0.734075 --> -0.751428).  Saving model ...
Epoch: 7 cost time: 2.3737752437591553
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.761 Vali Acc: 0.780 Test Loss: 1.761 Test Acc: 0.780
Validation loss decreased (-0.751428 --> -0.780329).  Saving model ...
Epoch: 8 cost time: 2.4237451553344727
Epoch: 8, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.743 Vali Acc: 0.780 Test Loss: 1.743 Test Acc: 0.780
Validation loss decreased (-0.780329 --> -0.780329).  Saving model ...
Epoch: 9 cost time: 2.4080007076263428
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 2.073 Vali Acc: 0.740 Test Loss: 2.073 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3432633876800537
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.832 Vali Acc: 0.746 Test Loss: 2.832 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.336259603500366
Epoch: 11, Steps: 17 | Train Loss: 0.107 Vali Loss: 2.545 Vali Acc: 0.705 Test Loss: 2.545 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3411295413970947
Epoch: 12, Steps: 17 | Train Loss: 0.201 Vali Loss: 3.369 Vali Acc: 0.740 Test Loss: 3.369 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3393518924713135
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 3.261 Vali Acc: 0.671 Test Loss: 3.261 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.331925868988037
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 3.264 Vali Acc: 0.728 Test Loss: 3.264 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3298940658569336
Epoch: 15, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.285 Vali Acc: 0.757 Test Loss: 3.285 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3556978702545166
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.885 Vali Acc: 0.780 Test Loss: 2.885 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3489534854888916
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.801 Vali Acc: 0.780 Test Loss: 3.801 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.3361737728118896
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 3.218 Vali Acc: 0.780 Test Loss: 3.218 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 249086599
model size : 950.67MB
2025-04-28 05:07:58.540135: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:07:58.559363: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745816878.582566  439517 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745816878.589645  439517 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:07:58.612911: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.497863292694092
Epoch: 1, Steps: 17 | Train Loss: 1.526 Vali Loss: 0.812 Vali Acc: 0.642 Test Loss: 0.812 Test Acc: 0.642
Validation loss decreased (inf --> -0.641610).  Saving model ...
Epoch: 2 cost time: 2.3001463413238525
Epoch: 2, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.427 Vali Acc: 0.688 Test Loss: 1.427 Test Acc: 0.688
Validation loss decreased (-0.641610 --> -0.687847).  Saving model ...
Epoch: 3 cost time: 2.269679069519043
Epoch: 3, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.002 Vali Acc: 0.757 Test Loss: 1.002 Test Acc: 0.757
Validation loss decreased (-0.687847 --> -0.757215).  Saving model ...
Epoch: 4 cost time: 2.2820918560028076
Epoch: 4, Steps: 17 | Train Loss: 0.194 Vali Loss: 1.878 Vali Acc: 0.757 Test Loss: 1.878 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.223271608352661
Epoch: 5, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.365 Vali Acc: 0.763 Test Loss: 1.365 Test Acc: 0.763
Validation loss decreased (-0.757215 --> -0.762992).  Saving model ...
Epoch: 6 cost time: 2.2606399059295654
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.068 Vali Acc: 0.757 Test Loss: 1.068 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2299416065216064
Epoch: 7, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.172 Vali Acc: 0.786 Test Loss: 2.172 Test Acc: 0.786
Validation loss decreased (-0.762992 --> -0.786105).  Saving model ...
Epoch: 8 cost time: 2.2502403259277344
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 2.844 Vali Acc: 0.757 Test Loss: 2.844 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2387986183166504
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 4.004 Vali Acc: 0.734 Test Loss: 4.004 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2161967754364014
Epoch: 10, Steps: 17 | Train Loss: 0.382 Vali Loss: 3.127 Vali Acc: 0.821 Test Loss: 3.127 Test Acc: 0.821
Validation loss decreased (-0.786105 --> -0.820778).  Saving model ...
Epoch: 11 cost time: 2.2602458000183105
Epoch: 11, Steps: 17 | Train Loss: 0.201 Vali Loss: 2.570 Vali Acc: 0.775 Test Loss: 2.570 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2325098514556885
Epoch: 12, Steps: 17 | Train Loss: 0.141 Vali Loss: 4.570 Vali Acc: 0.728 Test Loss: 4.570 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2256228923797607
Epoch: 13, Steps: 17 | Train Loss: 0.094 Vali Loss: 2.300 Vali Acc: 0.780 Test Loss: 2.300 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2279040813446045
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 4.295 Vali Acc: 0.734 Test Loss: 4.295 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.235262393951416
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.275 Vali Acc: 0.815 Test Loss: 1.275 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.222090244293213
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.568 Vali Acc: 0.809 Test Loss: 1.568 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.246718406677246
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.875 Vali Acc: 0.792 Test Loss: 1.875 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2118518352508545
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.821 Vali Acc: 0.786 Test Loss: 1.821 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.211451292037964
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.972 Vali Acc: 0.798 Test Loss: 1.972 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2230286598205566
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.548 Vali Acc: 0.821 Test Loss: 1.548 Test Acc: 0.821
Validation loss decreased (-0.820778 --> -0.820794).  Saving model ...
Epoch: 21 cost time: 2.2662441730499268
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.665 Vali Acc: 0.821 Test Loss: 1.665 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.222669839859009
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.219 Vali Acc: 0.780 Test Loss: 3.219 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.23085618019104
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.628 Vali Acc: 0.792 Test Loss: 3.628 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.22739577293396
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.610 Vali Acc: 0.792 Test Loss: 3.610 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2470860481262207
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.616 Vali Acc: 0.792 Test Loss: 3.616 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2204949855804443
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.534 Vali Acc: 0.792 Test Loss: 3.534 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2135794162750244
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.510 Vali Acc: 0.798 Test Loss: 3.510 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.2281970977783203
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.526 Vali Acc: 0.792 Test Loss: 3.526 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.215710163116455
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.519 Vali Acc: 0.803 Test Loss: 3.519 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.2133071422576904
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.485 Vali Acc: 0.792 Test Loss: 3.485 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 248223975
model size : 947.38MB
2025-04-28 05:10:41.908417: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:10:41.927135: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745817041.950029  452976 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745817041.957383  452976 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:10:41.980258: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3839423656463623
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 0.959 Vali Acc: 0.572 Test Loss: 0.959 Test Acc: 0.572
Validation loss decreased (inf --> -0.572245).  Saving model ...
Epoch: 2 cost time: 2.1866695880889893
Epoch: 2, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.976 Vali Acc: 0.746 Test Loss: 0.976 Test Acc: 0.746
Validation loss decreased (-0.572245 --> -0.745655).  Saving model ...
Epoch: 3 cost time: 2.155707359313965
Epoch: 3, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.868 Vali Acc: 0.786 Test Loss: 0.868 Test Acc: 0.786
Validation loss decreased (-0.745655 --> -0.786118).  Saving model ...
Epoch: 4 cost time: 2.160719633102417
Epoch: 4, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.099 Vali Acc: 0.803 Test Loss: 1.099 Test Acc: 0.803
Validation loss decreased (-0.786118 --> -0.803457).  Saving model ...
Epoch: 5 cost time: 2.1900432109832764
Epoch: 5, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.555 Vali Acc: 0.751 Test Loss: 1.555 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1253905296325684
Epoch: 6, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.479 Vali Acc: 0.746 Test Loss: 1.479 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1541037559509277
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.610 Vali Acc: 0.746 Test Loss: 1.610 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1333987712860107
Epoch: 8, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.847 Vali Acc: 0.821 Test Loss: 1.847 Test Acc: 0.821
Validation loss decreased (-0.803457 --> -0.820791).  Saving model ...
Epoch: 9 cost time: 4.64433217048645
Epoch: 9, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.334 Vali Acc: 0.803 Test Loss: 1.334 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.13887619972229
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.027 Vali Acc: 0.809 Test Loss: 1.027 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.140028476715088
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.413 Vali Acc: 0.728 Test Loss: 2.413 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.157186269760132
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.604 Vali Acc: 0.792 Test Loss: 1.604 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1282413005828857
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 3.652 Vali Acc: 0.780 Test Loss: 3.652 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.131887912750244
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 5.913 Vali Acc: 0.636 Test Loss: 5.913 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1496872901916504
Epoch: 15, Steps: 17 | Train Loss: 0.499 Vali Loss: 3.233 Vali Acc: 0.642 Test Loss: 3.233 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1307790279388428
Epoch: 16, Steps: 17 | Train Loss: 0.306 Vali Loss: 1.747 Vali Acc: 0.786 Test Loss: 1.747 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1614677906036377
Epoch: 17, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.479 Vali Acc: 0.746 Test Loss: 2.479 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1581594944000244
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.306 Vali Acc: 0.803 Test Loss: 2.306 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 248008487
model size : 946.56MB
2025-04-28 05:12:28.006289: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:12:28.025470: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745817148.048297  461170 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745817148.055322  461170 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:12:28.079332: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.395566940307617
Epoch: 1, Steps: 17 | Train Loss: 1.640 Vali Loss: 0.775 Vali Acc: 0.728 Test Loss: 0.775 Test Acc: 0.728
Validation loss decreased (inf --> -0.728316).  Saving model ...
Epoch: 2 cost time: 8.250847816467285
Epoch: 2, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.207 Vali Acc: 0.688 Test Loss: 1.207 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.246753454208374
Epoch: 3, Steps: 17 | Train Loss: 0.246 Vali Loss: 2.304 Vali Acc: 0.659 Test Loss: 2.304 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.229508638381958
Epoch: 4, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.551 Vali Acc: 0.769 Test Loss: 2.551 Test Acc: 0.769
Validation loss decreased (-0.728316 --> -0.768761).  Saving model ...
Epoch: 5 cost time: 8.282339572906494
Epoch: 5, Steps: 17 | Train Loss: 0.498 Vali Loss: 4.204 Vali Acc: 0.682 Test Loss: 4.204 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.213351488113403
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 4.631 Vali Acc: 0.723 Test Loss: 4.631 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.22940182685852
Epoch: 7, Steps: 17 | Train Loss: 0.106 Vali Loss: 4.938 Vali Acc: 0.751 Test Loss: 4.938 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.248636484146118
Epoch: 8, Steps: 17 | Train Loss: 0.077 Vali Loss: 5.272 Vali Acc: 0.723 Test Loss: 5.272 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.233064889907837
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 5.390 Vali Acc: 0.717 Test Loss: 5.390 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.206744194030762
Epoch: 10, Steps: 17 | Train Loss: 0.357 Vali Loss: 7.230 Vali Acc: 0.671 Test Loss: 7.230 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.203836917877197
Epoch: 11, Steps: 17 | Train Loss: 0.310 Vali Loss: 14.426 Vali Acc: 0.630 Test Loss: 14.426 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.206252098083496
Epoch: 12, Steps: 17 | Train Loss: 0.325 Vali Loss: 6.772 Vali Acc: 0.746 Test Loss: 6.772 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.222159385681152
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 7.519 Vali Acc: 0.717 Test Loss: 7.519 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.27629566192627
Epoch: 14, Steps: 17 | Train Loss: 0.185 Vali Loss: 5.225 Vali Acc: 0.798 Test Loss: 5.225 Test Acc: 0.798
Validation loss decreased (-0.768761 --> -0.797636).  Saving model ...
Epoch: 15 cost time: 8.291820287704468
Epoch: 15, Steps: 17 | Train Loss: 0.100 Vali Loss: 4.890 Vali Acc: 0.821 Test Loss: 4.890 Test Acc: 0.821
Validation loss decreased (-0.797636 --> -0.820760).  Saving model ...
Epoch: 16 cost time: 8.286753177642822
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 5.578 Vali Acc: 0.798 Test Loss: 5.578 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.267635345458984
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.524 Vali Acc: 0.780 Test Loss: 5.524 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.299321174621582
Epoch: 18, Steps: 17 | Train Loss: 0.109 Vali Loss: 8.129 Vali Acc: 0.740 Test Loss: 8.129 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.292255878448486
Epoch: 19, Steps: 17 | Train Loss: 0.151 Vali Loss: 5.114 Vali Acc: 0.815 Test Loss: 5.114 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.288366556167603
Epoch: 20, Steps: 17 | Train Loss: 0.066 Vali Loss: 5.320 Vali Acc: 0.798 Test Loss: 5.320 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.287665605545044
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 8.613 Vali Acc: 0.740 Test Loss: 8.613 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.274799585342407
Epoch: 22, Steps: 17 | Train Loss: 0.625 Vali Loss: 10.899 Vali Acc: 0.728 Test Loss: 10.899 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.29153299331665
Epoch: 23, Steps: 17 | Train Loss: 0.567 Vali Loss: 8.091 Vali Acc: 0.780 Test Loss: 8.091 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.281793355941772
Epoch: 24, Steps: 17 | Train Loss: 0.314 Vali Loss: 10.863 Vali Acc: 0.723 Test Loss: 10.863 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.288370132446289
Epoch: 25, Steps: 17 | Train Loss: 0.275 Vali Loss: 19.928 Vali Acc: 0.705 Test Loss: 19.928 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 935348775
model size : 3571.40MB
2025-04-28 05:18:27.793848: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:18:27.812978: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745817507.835498  473326 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745817507.842666  473326 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:18:27.865775: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.017292737960815
Epoch: 1, Steps: 17 | Train Loss: 1.598 Vali Loss: 0.946 Vali Acc: 0.659 Test Loss: 0.946 Test Acc: 0.659
Validation loss decreased (inf --> -0.658950).  Saving model ...
Epoch: 2 cost time: 6.8637120723724365
Epoch: 2, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.466 Vali Acc: 0.705 Test Loss: 1.466 Test Acc: 0.705
Validation loss decreased (-0.658950 --> -0.705188).  Saving model ...
Epoch: 3 cost time: 6.932934045791626
Epoch: 3, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.606 Vali Acc: 0.746 Test Loss: 1.606 Test Acc: 0.746
Validation loss decreased (-0.705188 --> -0.745649).  Saving model ...
Epoch: 4 cost time: 6.933939456939697
Epoch: 4, Steps: 17 | Train Loss: 0.066 Vali Loss: 2.669 Vali Acc: 0.699 Test Loss: 2.669 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.824259281158447
Epoch: 5, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.572 Vali Acc: 0.711 Test Loss: 1.572 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.84800124168396
Epoch: 6, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.969 Vali Acc: 0.728 Test Loss: 1.969 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.82464075088501
Epoch: 7, Steps: 17 | Train Loss: 0.086 Vali Loss: 3.042 Vali Acc: 0.757 Test Loss: 3.042 Test Acc: 0.757
Validation loss decreased (-0.745649 --> -0.757195).  Saving model ...
Epoch: 8 cost time: 6.861329793930054
Epoch: 8, Steps: 17 | Train Loss: 0.341 Vali Loss: 4.190 Vali Acc: 0.676 Test Loss: 4.190 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.816036939620972
Epoch: 9, Steps: 17 | Train Loss: 0.182 Vali Loss: 4.192 Vali Acc: 0.728 Test Loss: 4.192 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.802832126617432
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 3.672 Vali Acc: 0.723 Test Loss: 3.672 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.789698839187622
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.484 Vali Acc: 0.757 Test Loss: 2.484 Test Acc: 0.757
Validation loss decreased (-0.757195 --> -0.757201).  Saving model ...
Epoch: 12 cost time: 6.824803113937378
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 3.348 Vali Acc: 0.763 Test Loss: 3.348 Test Acc: 0.763
Validation loss decreased (-0.757201 --> -0.762972).  Saving model ...
Epoch: 13 cost time: 6.851745128631592
Epoch: 13, Steps: 17 | Train Loss: 0.046 Vali Loss: 4.302 Vali Acc: 0.705 Test Loss: 4.302 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.7952048778533936
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.848 Vali Acc: 0.723 Test Loss: 4.848 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.803738832473755
Epoch: 15, Steps: 17 | Train Loss: 0.190 Vali Loss: 4.880 Vali Acc: 0.682 Test Loss: 4.880 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.787185430526733
Epoch: 16, Steps: 17 | Train Loss: 0.183 Vali Loss: 7.330 Vali Acc: 0.647 Test Loss: 7.330 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.786501169204712
Epoch: 17, Steps: 17 | Train Loss: 0.519 Vali Loss: 6.126 Vali Acc: 0.734 Test Loss: 6.126 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.792928457260132
Epoch: 18, Steps: 17 | Train Loss: 1.695 Vali Loss: 5.841 Vali Acc: 0.723 Test Loss: 5.841 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.787590503692627
Epoch: 19, Steps: 17 | Train Loss: 0.201 Vali Loss: 5.680 Vali Acc: 0.688 Test Loss: 5.680 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.787761211395264
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 6.060 Vali Acc: 0.763 Test Loss: 6.060 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.788285255432129
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 5.474 Vali Acc: 0.751 Test Loss: 5.474 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.798352241516113
Epoch: 22, Steps: 17 | Train Loss: 0.243 Vali Loss: 10.982 Vali Acc: 0.786 Test Loss: 10.982 Test Acc: 0.786
Validation loss decreased (-0.762972 --> -0.786017).  Saving model ...
Epoch: 23 cost time: 6.798350811004639
Epoch: 23, Steps: 17 | Train Loss: 0.430 Vali Loss: 12.656 Vali Acc: 0.769 Test Loss: 12.656 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.788626432418823
Epoch: 24, Steps: 17 | Train Loss: 0.297 Vali Loss: 9.530 Vali Acc: 0.769 Test Loss: 9.530 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.798678874969482
Epoch: 25, Steps: 17 | Train Loss: 0.192 Vali Loss: 11.041 Vali Acc: 0.769 Test Loss: 11.041 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.7925379276275635
Epoch: 26, Steps: 17 | Train Loss: 0.073 Vali Loss: 9.157 Vali Acc: 0.798 Test Loss: 9.157 Test Acc: 0.798
Validation loss decreased (-0.786017 --> -0.797596).  Saving model ...
Epoch: 27 cost time: 6.837170839309692
Epoch: 27, Steps: 17 | Train Loss: 2.139 Vali Loss: 9.481 Vali Acc: 0.786 Test Loss: 9.481 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.789030075073242
Epoch: 28, Steps: 17 | Train Loss: 1.878 Vali Loss: 28.132 Vali Acc: 0.688 Test Loss: 28.132 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.800732612609863
Epoch: 29, Steps: 17 | Train Loss: 1.199 Vali Loss: 14.296 Vali Acc: 0.740 Test Loss: 14.296 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.796762466430664
Epoch: 30, Steps: 17 | Train Loss: 0.074 Vali Loss: 30.686 Vali Acc: 0.601 Test Loss: 30.686 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.7990946769714355
Epoch: 31, Steps: 17 | Train Loss: 0.574 Vali Loss: 22.289 Vali Acc: 0.665 Test Loss: 22.289 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.796710014343262
Epoch: 32, Steps: 17 | Train Loss: 0.284 Vali Loss: 9.812 Vali Acc: 0.815 Test Loss: 9.812 Test Acc: 0.815
Validation loss decreased (-0.797596 --> -0.814931).  Saving model ...
Epoch: 33 cost time: 6.883340358734131
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 28.950 Vali Acc: 0.630 Test Loss: 28.950 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.843255043029785
Epoch: 34, Steps: 17 | Train Loss: 0.381 Vali Loss: 15.758 Vali Acc: 0.775 Test Loss: 15.758 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.8419013023376465
Epoch: 35, Steps: 17 | Train Loss: 0.103 Vali Loss: 13.785 Vali Acc: 0.763 Test Loss: 13.785 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.823770999908447
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 18.127 Vali Acc: 0.740 Test Loss: 18.127 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.83610987663269
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 18.653 Vali Acc: 0.740 Test Loss: 18.653 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 6.858383417129517
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 18.924 Vali Acc: 0.734 Test Loss: 18.924 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 6.84694504737854
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 19.099 Vali Acc: 0.734 Test Loss: 19.099 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 6.826585054397583
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 18.747 Vali Acc: 0.734 Test Loss: 18.747 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 6.844845533370972
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 19.132 Vali Acc: 0.734 Test Loss: 19.132 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 6.833973407745361
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 19.080 Vali Acc: 0.740 Test Loss: 19.080 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 927583271
model size : 3541.78MB
2025-04-28 05:27:24.435462: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:27:24.454267: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745818044.476751  493345 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745818044.483652  493345 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:27:24.506185: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.7529895305633545
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 0.894 Vali Acc: 0.613 Test Loss: 0.894 Test Acc: 0.613
Validation loss decreased (inf --> -0.612708).  Saving model ...
Epoch: 2 cost time: 6.465202331542969
Epoch: 2, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.706 Vali Acc: 0.821 Test Loss: 0.706 Test Acc: 0.821
Validation loss decreased (-0.612708 --> -0.820802).  Saving model ...
Epoch: 3 cost time: 6.492443799972534
Epoch: 3, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.631 Vali Acc: 0.751 Test Loss: 1.631 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.434682130813599
Epoch: 4, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.353 Vali Acc: 0.763 Test Loss: 1.353 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.434804439544678
Epoch: 5, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.301 Vali Acc: 0.751 Test Loss: 1.301 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.415222406387329
Epoch: 6, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.379 Vali Acc: 0.786 Test Loss: 1.379 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.445388317108154
Epoch: 7, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.054 Vali Acc: 0.763 Test Loss: 2.054 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 6.412771701812744
Epoch: 8, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.478 Vali Acc: 0.809 Test Loss: 1.478 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 6.456204652786255
Epoch: 9, Steps: 17 | Train Loss: 0.060 Vali Loss: 2.173 Vali Acc: 0.798 Test Loss: 2.173 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.419639587402344
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.342 Vali Acc: 0.815 Test Loss: 1.342 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.4123663902282715
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.669 Vali Acc: 0.803 Test Loss: 1.669 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.411247253417969
Epoch: 12, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.618 Vali Acc: 0.769 Test Loss: 1.618 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 924994823
model size : 3531.91MB
2025-04-28 05:30:04.892215: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:30:04.910836: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745818204.933348  499239 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745818204.940365  499239 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:30:04.963180: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.5757951736450195
Epoch: 1, Steps: 17 | Train Loss: 1.482 Vali Loss: 0.871 Vali Acc: 0.746 Test Loss: 0.871 Test Acc: 0.746
Validation loss decreased (inf --> -0.745656).  Saving model ...
Epoch: 2 cost time: 6.3711748123168945
Epoch: 2, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.729 Vali Acc: 0.775 Test Loss: 0.729 Test Acc: 0.775
Validation loss decreased (-0.745656 --> -0.774559).  Saving model ...
Epoch: 3 cost time: 6.38191556930542
Epoch: 3, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.053 Vali Acc: 0.734 Test Loss: 1.053 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.336429834365845
Epoch: 4, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.919 Vali Acc: 0.809 Test Loss: 0.919 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809239).  Saving model ...
Epoch: 5 cost time: 6.387466669082642
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.821 Test Loss: 0.676 Test Acc: 0.821
Validation loss decreased (-0.809239 --> -0.820802).  Saving model ...
Epoch: 6 cost time: 6.353680372238159
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.798 Test Loss: 0.767 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.3114118576049805
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.792 Test Loss: 0.792 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.3493218421936035
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.792 Test Loss: 0.763 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.360596656799316
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.792 Test Loss: 0.727 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.354472637176514
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.798 Test Loss: 0.699 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.362038850784302
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.798 Test Loss: 0.698 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.297606706619263
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.299352645874023
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.302635431289673
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 6.285456895828247
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.815 Test Loss: 0.662 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 924132103
model size : 3528.61MB
2025-04-28 05:33:36.447560: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:33:36.466468: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745818416.489710  506594 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745818416.496675  506594 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:33:36.519716: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.476657867431641
Epoch: 1, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.021 Vali Acc: 0.520 Test Loss: 1.021 Test Acc: 0.520
Validation loss decreased (inf --> -0.520221).  Saving model ...
Epoch: 2 cost time: 6.255953550338745
Epoch: 2, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.740 Vali Acc: 0.786 Test Loss: 0.740 Test Acc: 0.786
Validation loss decreased (-0.520221 --> -0.786120).  Saving model ...
Epoch: 3 cost time: 6.237294912338257
Epoch: 3, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.081 Vali Acc: 0.699 Test Loss: 1.081 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.2167439460754395
Epoch: 4, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.157 Vali Acc: 0.734 Test Loss: 1.157 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.214993476867676
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.081 Vali Acc: 0.757 Test Loss: 1.081 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.221119165420532
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.425 Vali Acc: 0.746 Test Loss: 1.425 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.2021331787109375
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.112 Vali Acc: 0.798 Test Loss: 1.112 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797677).  Saving model ...
Epoch: 8 cost time: 6.250905513763428
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 2.710 Vali Acc: 0.751 Test Loss: 2.710 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.203884840011597
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 2.147 Vali Acc: 0.740 Test Loss: 2.147 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.216670989990234
Epoch: 10, Steps: 17 | Train Loss: 0.278 Vali Loss: 2.628 Vali Acc: 0.775 Test Loss: 2.628 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.211691856384277
Epoch: 11, Steps: 17 | Train Loss: 0.205 Vali Loss: 2.451 Vali Acc: 0.717 Test Loss: 2.451 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.205682992935181
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.831 Vali Acc: 0.740 Test Loss: 2.831 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.21953558921814
Epoch: 13, Steps: 17 | Train Loss: 0.194 Vali Loss: 5.605 Vali Acc: 0.711 Test Loss: 5.605 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.226166248321533
Epoch: 14, Steps: 17 | Train Loss: 0.498 Vali Loss: 4.706 Vali Acc: 0.630 Test Loss: 4.706 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.209946393966675
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 5.298 Vali Acc: 0.723 Test Loss: 5.298 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.204556465148926
Epoch: 16, Steps: 17 | Train Loss: 0.129 Vali Loss: 4.235 Vali Acc: 0.809 Test Loss: 4.235 Test Acc: 0.809
Validation loss decreased (-0.797677 --> -0.809206).  Saving model ...
Epoch: 17 cost time: 6.263645172119141
Epoch: 17, Steps: 17 | Train Loss: 0.129 Vali Loss: 5.731 Vali Acc: 0.763 Test Loss: 5.731 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.264428377151489
Epoch: 18, Steps: 17 | Train Loss: 0.517 Vali Loss: 6.295 Vali Acc: 0.769 Test Loss: 6.295 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.236204385757446
Epoch: 19, Steps: 17 | Train Loss: 0.095 Vali Loss: 7.356 Vali Acc: 0.746 Test Loss: 7.356 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.277932643890381
Epoch: 20, Steps: 17 | Train Loss: 0.090 Vali Loss: 5.537 Vali Acc: 0.682 Test Loss: 5.537 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.239341497421265
Epoch: 21, Steps: 17 | Train Loss: 0.351 Vali Loss: 6.625 Vali Acc: 0.676 Test Loss: 6.625 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.238596677780151
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 4.351 Vali Acc: 0.682 Test Loss: 4.351 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.240914344787598
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 5.142 Vali Acc: 0.671 Test Loss: 5.142 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.267668724060059
Epoch: 24, Steps: 17 | Train Loss: 0.064 Vali Loss: 6.056 Vali Acc: 0.757 Test Loss: 6.056 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.26032018661499
Epoch: 25, Steps: 17 | Train Loss: 0.133 Vali Loss: 5.727 Vali Acc: 0.740 Test Loss: 5.727 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.22984766960144
Epoch: 26, Steps: 17 | Train Loss: 0.040 Vali Loss: 7.161 Vali Acc: 0.757 Test Loss: 7.161 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 923269479
model size : 3525.32MB
2025-04-28 05:38:35.889811: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:38:35.908450: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745818715.931612  518929 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745818715.938604  518929 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:38:35.961250: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.317161798477173
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.004 Vali Acc: 0.647 Test Loss: 1.004 Test Acc: 0.647
Validation loss decreased (inf --> -0.647389).  Saving model ...
Epoch: 2 cost time: 6.108352422714233
Epoch: 2, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.647389 --> -0.763000).  Saving model ...
Epoch: 3 cost time: 6.111867904663086
Epoch: 3, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.876 Vali Acc: 0.728 Test Loss: 0.876 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.0514562129974365
Epoch: 4, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.637 Vali Acc: 0.746 Test Loss: 1.637 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.060272932052612
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.813 Vali Acc: 0.809 Test Loss: 0.813 Test Acc: 0.809
Validation loss decreased (-0.763000 --> -0.809240).  Saving model ...
Epoch: 6 cost time: 6.097394943237305
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.792 Test Loss: 0.984 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.053970813751221
Epoch: 7, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.789 Vali Acc: 0.728 Test Loss: 1.789 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.041400909423828
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.524 Vali Acc: 0.746 Test Loss: 1.524 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.065955638885498
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.983 Vali Acc: 0.751 Test Loss: 1.983 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.044392108917236
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.090 Vali Acc: 0.815 Test Loss: 1.090 Test Acc: 0.815
Validation loss decreased (-0.809240 --> -0.815018).  Saving model ...
Epoch: 11 cost time: 6.069165468215942
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 2.493 Vali Acc: 0.746 Test Loss: 2.493 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.06080436706543
Epoch: 12, Steps: 17 | Train Loss: 0.207 Vali Loss: 2.304 Vali Acc: 0.780 Test Loss: 2.304 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.041358232498169
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 3.292 Vali Acc: 0.769 Test Loss: 3.292 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.069421291351318
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.044 Vali Acc: 0.763 Test Loss: 2.044 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.052711248397827
Epoch: 15, Steps: 17 | Train Loss: 0.101 Vali Loss: 4.015 Vali Acc: 0.734 Test Loss: 4.015 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.063060283660889
Epoch: 16, Steps: 17 | Train Loss: 0.168 Vali Loss: 2.515 Vali Acc: 0.757 Test Loss: 2.515 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.0531463623046875
Epoch: 17, Steps: 17 | Train Loss: 0.069 Vali Loss: 6.082 Vali Acc: 0.723 Test Loss: 6.082 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.021594047546387
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 3.626 Vali Acc: 0.769 Test Loss: 3.626 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.016511678695679
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.039 Vali Acc: 0.734 Test Loss: 3.039 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.017381191253662
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 4.557 Vali Acc: 0.746 Test Loss: 4.557 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 922406855
model size : 3522.03MB
2025-04-28 05:42:35.721297: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:42:35.740276: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745818955.763328  528498 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745818955.770408  528498 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:42:35.793758: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.899465560913086
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 0.994 Vali Acc: 0.717 Test Loss: 0.994 Test Acc: 0.717
Validation loss decreased (inf --> -0.716753).  Saving model ...
Epoch: 2 cost time: 5.72648024559021
Epoch: 2, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.566 Vali Acc: 0.780 Test Loss: 0.566 Test Acc: 0.780
Validation loss decreased (-0.716753 --> -0.780341).  Saving model ...
Epoch: 3 cost time: 5.730854511260986
Epoch: 3, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.760 Vali Acc: 0.780 Test Loss: 0.760 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.673132658004761
Epoch: 4, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.435 Vali Acc: 0.844 Test Loss: 0.435 Test Acc: 0.844
Validation loss decreased (-0.780341 --> -0.843926).  Saving model ...
Epoch: 5 cost time: 5.748377561569214
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.803 Test Loss: 0.557 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.711309432983398
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.815 Test Loss: 0.522 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.693148374557495
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.502 Vali Acc: 0.838 Test Loss: 0.502 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.7012999057769775
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.679986476898193
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.672504901885986
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.500 Vali Acc: 0.838 Test Loss: 0.500 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.690089225769043
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.838 Test Loss: 0.492 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.6696836948394775
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.838 Test Loss: 0.490 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.70452618598938
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849706).  Saving model ...
Epoch: 14 cost time: 5.762171745300293
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.838 Test Loss: 0.484 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.6888086795806885
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.484 Vali Acc: 0.850 Test Loss: 0.484 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.685750484466553
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.838 Test Loss: 0.482 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.666993856430054
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.838 Test Loss: 0.483 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.684527397155762
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.479 Vali Acc: 0.838 Test Loss: 0.479 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.682703256607056
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 20 cost time: 5.87051796913147
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 21 cost time: 5.778355360031128
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 22 cost time: 5.763679027557373
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.713747501373291
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.713003873825073
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.729436159133911
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.850 Test Loss: 0.474 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.7042036056518555
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.733664512634277
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.850 Test Loss: 0.471 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 28 cost time: 5.776136636734009
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.6969287395477295
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.850 Test Loss: 0.475 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.716482877731323
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.712660789489746
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.740322113037109
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.850 Test Loss: 0.477 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.729187726974487
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.728567838668823
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.478 Vali Acc: 0.850 Test Loss: 0.478 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.710770606994629
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 36 cost time: 5.745373249053955
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.850 Test Loss: 0.469 Test Acc: 0.850
Validation loss decreased (-0.849706 --> -0.849706).  Saving model ...
Epoch: 37 cost time: 5.727560997009277
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.720450401306152
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.7093186378479
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.472 Vali Acc: 0.850 Test Loss: 0.472 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 5.6960930824279785
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.722421884536743
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 5.732874393463135
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 5.717181921005249
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 5.7140583992004395
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.850 Test Loss: 0.470 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 5.711132049560547
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 5.710055112838745
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.473 Vali Acc: 0.850 Test Loss: 0.473 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 921544231
model size : 3518.74MB
2025-04-28 05:51:17.064058: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:51:17.083572: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745819477.106499  550134 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745819477.113641  550134 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:51:17.137064: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.37216591835022
Epoch: 1, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.250 Vali Acc: 0.671 Test Loss: 1.250 Test Acc: 0.671
Validation loss decreased (inf --> -0.670508).  Saving model ...
Epoch: 2 cost time: 8.207365989685059
Epoch: 2, Steps: 17 | Train Loss: 0.556 Vali Loss: 2.195 Vali Acc: 0.723 Test Loss: 2.195 Test Acc: 0.723
Validation loss decreased (-0.670508 --> -0.722521).  Saving model ...
Epoch: 3 cost time: 8.254082202911377
Epoch: 3, Steps: 17 | Train Loss: 0.271 Vali Loss: 2.345 Vali Acc: 0.746 Test Loss: 2.345 Test Acc: 0.746
Validation loss decreased (-0.722521 --> -0.745641).  Saving model ...
Epoch: 4 cost time: 8.241813659667969
Epoch: 4, Steps: 17 | Train Loss: 0.165 Vali Loss: 4.137 Vali Acc: 0.659 Test Loss: 4.137 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.206804275512695
Epoch: 5, Steps: 17 | Train Loss: 0.157 Vali Loss: 3.257 Vali Acc: 0.694 Test Loss: 3.257 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.146151781082153
Epoch: 6, Steps: 17 | Train Loss: 0.115 Vali Loss: 3.670 Vali Acc: 0.723 Test Loss: 3.670 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.123684883117676
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.586 Vali Acc: 0.751 Test Loss: 2.586 Test Acc: 0.751
Validation loss decreased (-0.745641 --> -0.751419).  Saving model ...
Epoch: 8 cost time: 8.170586585998535
Epoch: 8, Steps: 17 | Train Loss: 0.236 Vali Loss: 5.994 Vali Acc: 0.665 Test Loss: 5.994 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.147901773452759
Epoch: 9, Steps: 17 | Train Loss: 0.107 Vali Loss: 5.266 Vali Acc: 0.723 Test Loss: 5.266 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.146717071533203
Epoch: 10, Steps: 17 | Train Loss: 0.387 Vali Loss: 9.940 Vali Acc: 0.636 Test Loss: 9.940 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.135480165481567
Epoch: 11, Steps: 17 | Train Loss: 0.574 Vali Loss: 9.766 Vali Acc: 0.653 Test Loss: 9.766 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.133280277252197
Epoch: 12, Steps: 17 | Train Loss: 1.157 Vali Loss: 8.178 Vali Acc: 0.746 Test Loss: 8.178 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.125007390975952
Epoch: 13, Steps: 17 | Train Loss: 1.165 Vali Loss: 28.031 Vali Acc: 0.572 Test Loss: 28.031 Test Acc: 0.572
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 8.123820543289185
Epoch: 14, Steps: 17 | Train Loss: 1.008 Vali Loss: 4.211 Vali Acc: 0.803 Test Loss: 4.211 Test Acc: 0.803
Validation loss decreased (-0.751419 --> -0.803426).  Saving model ...
Epoch: 15 cost time: 8.171883821487427
Epoch: 15, Steps: 17 | Train Loss: 0.306 Vali Loss: 9.071 Vali Acc: 0.723 Test Loss: 9.071 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.142454862594604
Epoch: 16, Steps: 17 | Train Loss: 0.112 Vali Loss: 9.321 Vali Acc: 0.751 Test Loss: 9.321 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.136454820632935
Epoch: 17, Steps: 17 | Train Loss: 0.071 Vali Loss: 13.411 Vali Acc: 0.723 Test Loss: 13.411 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.127567052841187
Epoch: 18, Steps: 17 | Train Loss: 0.334 Vali Loss: 19.338 Vali Acc: 0.665 Test Loss: 19.338 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.13789677619934
Epoch: 19, Steps: 17 | Train Loss: 0.143 Vali Loss: 13.411 Vali Acc: 0.775 Test Loss: 13.411 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.130651950836182
Epoch: 20, Steps: 17 | Train Loss: 0.083 Vali Loss: 16.549 Vali Acc: 0.699 Test Loss: 16.549 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 8.132518291473389
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 21.316 Vali Acc: 0.711 Test Loss: 21.316 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.134858131408691
Epoch: 22, Steps: 17 | Train Loss: 0.120 Vali Loss: 17.104 Vali Acc: 0.775 Test Loss: 17.104 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.13404631614685
Epoch: 23, Steps: 17 | Train Loss: 0.212 Vali Loss: 28.569 Vali Acc: 0.723 Test Loss: 28.569 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.13789677619934
Epoch: 24, Steps: 17 | Train Loss: 0.585 Vali Loss: 17.065 Vali Acc: 0.769 Test Loss: 17.065 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 934485927
model size : 3568.11MB
2025-04-28 05:57:26.400750: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 05:57:26.419211: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745819846.441199  562009 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745819846.448015  562009 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 05:57:26.470572: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.938422679901123
Epoch: 1, Steps: 17 | Train Loss: 1.670 Vali Loss: 0.912 Vali Acc: 0.607 Test Loss: 0.912 Test Acc: 0.607
Validation loss decreased (inf --> -0.606927).  Saving model ...
Epoch: 2 cost time: 6.81500506401062
Epoch: 2, Steps: 17 | Train Loss: 0.491 Vali Loss: 1.968 Vali Acc: 0.665 Test Loss: 1.968 Test Acc: 0.665
Validation loss decreased (-0.606927 --> -0.664720).  Saving model ...
Epoch: 3 cost time: 6.797348499298096
Epoch: 3, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.903 Vali Acc: 0.723 Test Loss: 1.903 Test Acc: 0.723
Validation loss decreased (-0.664720 --> -0.722524).  Saving model ...
Epoch: 4 cost time: 6.795925617218018
Epoch: 4, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.957 Vali Acc: 0.717 Test Loss: 1.957 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.764435529708862
Epoch: 5, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.023 Vali Acc: 0.734 Test Loss: 2.023 Test Acc: 0.734
Validation loss decreased (-0.722524 --> -0.734084).  Saving model ...
Epoch: 6 cost time: 6.821772813796997
Epoch: 6, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.131 Vali Acc: 0.786 Test Loss: 2.131 Test Acc: 0.786
Validation loss decreased (-0.734084 --> -0.786106).  Saving model ...
Epoch: 7 cost time: 6.797558784484863
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.158 Vali Acc: 0.717 Test Loss: 2.158 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.788797616958618
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.516 Vali Acc: 0.786 Test Loss: 2.516 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.76101279258728
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 3.004 Vali Acc: 0.676 Test Loss: 3.004 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.767452955245972
Epoch: 10, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.309 Vali Acc: 0.803 Test Loss: 2.309 Test Acc: 0.803
Validation loss decreased (-0.786106 --> -0.803445).  Saving model ...
Epoch: 11 cost time: 6.8141069412231445
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 2.623 Vali Acc: 0.786 Test Loss: 2.623 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.743995904922485
Epoch: 12, Steps: 17 | Train Loss: 0.554 Vali Loss: 4.270 Vali Acc: 0.751 Test Loss: 4.270 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.77797269821167
Epoch: 13, Steps: 17 | Train Loss: 0.248 Vali Loss: 6.940 Vali Acc: 0.792 Test Loss: 6.940 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.773971319198608
Epoch: 14, Steps: 17 | Train Loss: 0.257 Vali Loss: 4.299 Vali Acc: 0.763 Test Loss: 4.299 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.7934205532073975
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 4.240 Vali Acc: 0.838 Test Loss: 4.240 Test Acc: 0.838
Validation loss decreased (-0.803445 --> -0.838108).  Saving model ...
Epoch: 16 cost time: 6.830037355422974
Epoch: 16, Steps: 17 | Train Loss: 0.401 Vali Loss: 6.411 Vali Acc: 0.717 Test Loss: 6.411 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.755903244018555
Epoch: 17, Steps: 17 | Train Loss: 0.410 Vali Loss: 7.087 Vali Acc: 0.775 Test Loss: 7.087 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.741450548171997
Epoch: 18, Steps: 17 | Train Loss: 0.557 Vali Loss: 8.178 Vali Acc: 0.751 Test Loss: 8.178 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.74946141242981
Epoch: 19, Steps: 17 | Train Loss: 0.252 Vali Loss: 6.181 Vali Acc: 0.757 Test Loss: 6.181 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.74789834022522
Epoch: 20, Steps: 17 | Train Loss: 0.573 Vali Loss: 6.780 Vali Acc: 0.786 Test Loss: 6.780 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.753970384597778
Epoch: 21, Steps: 17 | Train Loss: 0.540 Vali Loss: 12.315 Vali Acc: 0.740 Test Loss: 12.315 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.783075571060181
Epoch: 22, Steps: 17 | Train Loss: 0.208 Vali Loss: 10.088 Vali Acc: 0.769 Test Loss: 10.088 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.769458293914795
Epoch: 23, Steps: 17 | Train Loss: 0.078 Vali Loss: 12.021 Vali Acc: 0.757 Test Loss: 12.021 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.763846397399902
Epoch: 24, Steps: 17 | Train Loss: 1.915 Vali Loss: 10.910 Vali Acc: 0.775 Test Loss: 10.910 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.763608932495117
Epoch: 25, Steps: 17 | Train Loss: 0.031 Vali Loss: 7.356 Vali Acc: 0.763 Test Loss: 7.356 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 926720423
model size : 3538.49MB
2025-04-28 06:03:12.939231: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:03:12.958487: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745820192.981400  574126 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745820192.988395  574126 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:03:13.011444: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.53954815864563
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.218 Vali Acc: 0.578 Test Loss: 1.218 Test Acc: 0.578
Validation loss decreased (inf --> -0.578022).  Saving model ...
Epoch: 2 cost time: 6.425033807754517
Epoch: 2, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.048 Vali Acc: 0.798 Test Loss: 1.048 Test Acc: 0.798
Validation loss decreased (-0.578022 --> -0.797677).  Saving model ...
Epoch: 3 cost time: 6.420074462890625
Epoch: 3, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.221 Vali Acc: 0.792 Test Loss: 1.221 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.377416610717773
Epoch: 4, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.983 Vali Acc: 0.815 Test Loss: 0.983 Test Acc: 0.815
Validation loss decreased (-0.797677 --> -0.815019).  Saving model ...
Epoch: 5 cost time: 6.354174852371216
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.277 Vali Acc: 0.798 Test Loss: 1.277 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.304545879364014
Epoch: 6, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.894 Vali Acc: 0.803 Test Loss: 1.894 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.312044143676758
Epoch: 7, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.621 Vali Acc: 0.786 Test Loss: 1.621 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.315881729125977
Epoch: 8, Steps: 17 | Train Loss: 0.163 Vali Loss: 2.029 Vali Acc: 0.746 Test Loss: 2.029 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.320046424865723
Epoch: 9, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.757 Vali Acc: 0.763 Test Loss: 2.757 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.314663887023926
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.197 Vali Acc: 0.798 Test Loss: 2.197 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.299139022827148
Epoch: 11, Steps: 17 | Train Loss: 0.060 Vali Loss: 5.413 Vali Acc: 0.711 Test Loss: 5.413 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.313387632369995
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.868 Vali Acc: 0.705 Test Loss: 1.868 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.329587936401367
Epoch: 13, Steps: 17 | Train Loss: 0.207 Vali Loss: 4.410 Vali Acc: 0.740 Test Loss: 4.410 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.300260305404663
Epoch: 14, Steps: 17 | Train Loss: 0.263 Vali Loss: 5.616 Vali Acc: 0.763 Test Loss: 5.616 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 924131975
model size : 3528.61MB
2025-04-28 06:06:18.009841: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:06:18.028439: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745820378.050793  580960 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745820378.057672  580960 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:06:18.081261: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.563144207000732
Epoch: 1, Steps: 17 | Train Loss: 1.481 Vali Loss: 0.938 Vali Acc: 0.607 Test Loss: 0.938 Test Acc: 0.607
Validation loss decreased (inf --> -0.606927).  Saving model ...
Epoch: 2 cost time: 6.270557641983032
Epoch: 2, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.533 Vali Acc: 0.584 Test Loss: 1.533 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.2254602909088135
Epoch: 3, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.889 Vali Acc: 0.613 Test Loss: 1.889 Test Acc: 0.613
Validation loss decreased (-0.606927 --> -0.612698).  Saving model ...
Epoch: 4 cost time: 6.233161211013794
Epoch: 4, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.270 Vali Acc: 0.815 Test Loss: 1.270 Test Acc: 0.815
Validation loss decreased (-0.612698 --> -0.815016).  Saving model ...
Epoch: 5 cost time: 6.269917964935303
Epoch: 5, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.337 Vali Acc: 0.786 Test Loss: 1.337 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.220605373382568
Epoch: 6, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.538 Vali Acc: 0.763 Test Loss: 1.538 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.222341299057007
Epoch: 7, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.874 Vali Acc: 0.855 Test Loss: 0.874 Test Acc: 0.855
Validation loss decreased (-0.815016 --> -0.855483).  Saving model ...
Epoch: 8 cost time: 6.286478757858276
Epoch: 8, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.156 Vali Acc: 0.786 Test Loss: 1.156 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.221774101257324
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.192 Vali Acc: 0.827 Test Loss: 1.192 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.232201099395752
Epoch: 10, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.264 Vali Acc: 0.821 Test Loss: 1.264 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.204134941101074
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.830 Vali Acc: 0.821 Test Loss: 1.830 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.238360643386841
Epoch: 12, Steps: 17 | Train Loss: 0.066 Vali Loss: 3.337 Vali Acc: 0.746 Test Loss: 3.337 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.249731063842773
Epoch: 13, Steps: 17 | Train Loss: 0.307 Vali Loss: 3.127 Vali Acc: 0.792 Test Loss: 3.127 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.2733848094940186
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.904 Vali Acc: 0.832 Test Loss: 1.904 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.24051570892334
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 5.142 Vali Acc: 0.769 Test Loss: 5.142 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.259472608566284
Epoch: 16, Steps: 17 | Train Loss: 0.426 Vali Loss: 4.064 Vali Acc: 0.780 Test Loss: 4.064 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.244755029678345
Epoch: 17, Steps: 17 | Train Loss: 0.763 Vali Loss: 3.661 Vali Acc: 0.757 Test Loss: 3.661 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 923269255
model size : 3525.32MB
2025-04-28 06:10:02.170829: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:10:02.190119: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745820602.213135  589219 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745820602.220177  589219 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:10:02.243198: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.3877832889556885
Epoch: 1, Steps: 17 | Train Loss: 1.569 Vali Loss: 0.911 Vali Acc: 0.688 Test Loss: 0.911 Test Acc: 0.688
Validation loss decreased (inf --> -0.687852).  Saving model ...
Epoch: 2 cost time: 6.253947496414185
Epoch: 2, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.645 Vali Acc: 0.769 Test Loss: 0.645 Test Acc: 0.769
Validation loss decreased (-0.687852 --> -0.768780).  Saving model ...
Epoch: 3 cost time: 6.251027345657349
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.971 Vali Acc: 0.734 Test Loss: 0.971 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1978724002838135
Epoch: 4, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.954 Vali Acc: 0.832 Test Loss: 0.954 Test Acc: 0.832
Validation loss decreased (-0.768780 --> -0.832360).  Saving model ...
Epoch: 5 cost time: 6.25180459022522
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.291 Vali Acc: 0.798 Test Loss: 1.291 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.194528102874756
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.792 Test Loss: 0.860 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.209798336029053
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.786 Test Loss: 1.038 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.2203967571258545
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.282 Vali Acc: 0.769 Test Loss: 1.282 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.199192762374878
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.247 Vali Acc: 0.780 Test Loss: 1.247 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.1993567943573
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.780 Test Loss: 1.214 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.174590349197388
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.780 Test Loss: 1.190 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.1776628494262695
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.158 Vali Acc: 0.786 Test Loss: 1.158 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.176098823547363
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.780 Test Loss: 1.150 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.204106092453003
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.780 Test Loss: 1.144 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 922406631
model size : 3522.03MB
2025-04-28 06:13:05.519488: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:13:05.538759: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745820785.562770  596044 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745820785.569989  596044 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:13:05.593340: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.230477809906006
Epoch: 1, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.030 Vali Acc: 0.601 Test Loss: 1.030 Test Acc: 0.601
Validation loss decreased (inf --> -0.601146).  Saving model ...
Epoch: 2 cost time: 6.067225217819214
Epoch: 2, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.573 Vali Acc: 0.809 Test Loss: 0.573 Test Acc: 0.809
Validation loss decreased (-0.601146 --> -0.809243).  Saving model ...
Epoch: 3 cost time: 6.0265045166015625
Epoch: 3, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.714 Vali Acc: 0.786 Test Loss: 0.714 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.0269269943237305
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.809 Test Loss: 0.719 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.984454870223999
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.769 Test Loss: 0.846 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.969500780105591
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.786 Test Loss: 0.755 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.968179941177368
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.678 Vali Acc: 0.792 Test Loss: 0.678 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.973344326019287
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.832 Test Loss: 0.846 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832361).  Saving model ...
Epoch: 9 cost time: 6.010146617889404
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.786 Test Loss: 0.829 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.973564863204956
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 4.782 Vali Acc: 0.618 Test Loss: 4.782 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.970489501953125
Epoch: 11, Steps: 17 | Train Loss: 0.625 Vali Loss: 2.363 Vali Acc: 0.642 Test Loss: 2.363 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.9727983474731445
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 3.598 Vali Acc: 0.728 Test Loss: 3.598 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.964143753051758
Epoch: 13, Steps: 17 | Train Loss: 0.402 Vali Loss: 3.798 Vali Acc: 0.728 Test Loss: 3.798 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.985387802124023
Epoch: 14, Steps: 17 | Train Loss: 0.912 Vali Loss: 3.710 Vali Acc: 0.757 Test Loss: 3.710 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.970012664794922
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 4.714 Vali Acc: 0.740 Test Loss: 4.714 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.966595888137817
Epoch: 16, Steps: 17 | Train Loss: 0.167 Vali Loss: 4.901 Vali Acc: 0.751 Test Loss: 4.901 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.989342927932739
Epoch: 17, Steps: 17 | Train Loss: 0.273 Vali Loss: 6.363 Vali Acc: 0.786 Test Loss: 6.363 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.956403732299805
Epoch: 18, Steps: 17 | Train Loss: 0.510 Vali Loss: 3.667 Vali Acc: 0.809 Test Loss: 3.667 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 921544007
model size : 3518.74MB
2025-04-28 06:16:35.669749: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:16:35.689055: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745820995.712691  604665 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745820995.719811  604665 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:16:35.743497: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.9327733516693115
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.091 Vali Acc: 0.618 Test Loss: 1.091 Test Acc: 0.618
Validation loss decreased (inf --> -0.618486).  Saving model ...
Epoch: 2 cost time: 5.669694662094116
Epoch: 2, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.606 Vali Acc: 0.775 Test Loss: 0.606 Test Acc: 0.775
Validation loss decreased (-0.618486 --> -0.774560).  Saving model ...
Epoch: 3 cost time: 5.672300100326538
Epoch: 3, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.918 Vali Acc: 0.751 Test Loss: 0.918 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.626160621643066
Epoch: 4, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.632 Vali Acc: 0.798 Test Loss: 0.632 Test Acc: 0.798
Validation loss decreased (-0.774560 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 5.629881143569946
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.573 Vali Acc: 0.815 Test Loss: 0.573 Test Acc: 0.815
Validation loss decreased (-0.797682 --> -0.815023).  Saving model ...
Epoch: 6 cost time: 5.670951843261719
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
Validation loss decreased (-0.815023 --> -0.867047).  Saving model ...
Epoch: 7 cost time: 5.664287567138672
Epoch: 7, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.416 Vali Acc: 0.763 Test Loss: 1.416 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.634038925170898
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.366 Vali Acc: 0.780 Test Loss: 1.366 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.660615682601929
Epoch: 9, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.186 Vali Acc: 0.780 Test Loss: 2.186 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.641614675521851
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.934 Vali Acc: 0.827 Test Loss: 0.934 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.659645080566406
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.358 Vali Acc: 0.769 Test Loss: 2.358 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.6480324268341064
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.460 Vali Acc: 0.798 Test Loss: 1.460 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.655553579330444
Epoch: 13, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.607 Vali Acc: 0.763 Test Loss: 1.607 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.663473606109619
Epoch: 14, Steps: 17 | Train Loss: 0.469 Vali Loss: 1.497 Vali Acc: 0.798 Test Loss: 1.497 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.643460750579834
Epoch: 15, Steps: 17 | Train Loss: 0.173 Vali Loss: 2.486 Vali Acc: 0.850 Test Loss: 2.486 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.676997900009155
Epoch: 16, Steps: 17 | Train Loss: 0.966 Vali Loss: 3.811 Vali Acc: 0.682 Test Loss: 3.811 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 920681383
model size : 3515.45MB
2025-04-28 06:20:03.172803: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:20:03.191902: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745821203.214658  612422 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745821203.221788  612422 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:20:03.245053: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.59431791305542
Epoch: 1, Steps: 34 | Train Loss: 10.590 Vali Loss: 13.333 Vali Acc: 0.457 Test Loss: 13.333 Test Acc: 0.457
Validation loss decreased (inf --> -0.456514).  Saving model ...
Epoch: 2 cost time: 21.34475040435791
Epoch: 2, Steps: 34 | Train Loss: 2.576 Vali Loss: 5.934 Vali Acc: 0.717 Test Loss: 5.934 Test Acc: 0.717
Validation loss decreased (-0.456514 --> -0.716704).  Saving model ...
Epoch: 3 cost time: 21.28646230697632
Epoch: 3, Steps: 34 | Train Loss: 2.119 Vali Loss: 8.032 Vali Acc: 0.653 Test Loss: 8.032 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.275440454483032
Epoch: 4, Steps: 34 | Train Loss: 1.837 Vali Loss: 9.106 Vali Acc: 0.694 Test Loss: 9.106 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 21.294589281082153
Epoch: 5, Steps: 34 | Train Loss: 3.819 Vali Loss: 13.413 Vali Acc: 0.751 Test Loss: 13.413 Test Acc: 0.751
Validation loss decreased (-0.716704 --> -0.751311).  Saving model ...
Epoch: 6 cost time: 21.314189910888672
Epoch: 6, Steps: 34 | Train Loss: 1.847 Vali Loss: 11.600 Vali Acc: 0.751 Test Loss: 11.600 Test Acc: 0.751
Validation loss decreased (-0.751311 --> -0.751329).  Saving model ...
Epoch: 7 cost time: 21.307899713516235
Epoch: 7, Steps: 34 | Train Loss: 0.632 Vali Loss: 12.569 Vali Acc: 0.746 Test Loss: 12.569 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.28342294692993
Epoch: 8, Steps: 34 | Train Loss: 1.421 Vali Loss: 17.443 Vali Acc: 0.763 Test Loss: 17.443 Test Acc: 0.763
Validation loss decreased (-0.751329 --> -0.762831).  Saving model ...
Epoch: 9 cost time: 21.303424835205078
Epoch: 9, Steps: 34 | Train Loss: 2.224 Vali Loss: 26.395 Vali Acc: 0.746 Test Loss: 26.395 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.261228799819946
Epoch: 10, Steps: 34 | Train Loss: 4.106 Vali Loss: 49.633 Vali Acc: 0.711 Test Loss: 49.633 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.258447647094727
Epoch: 11, Steps: 34 | Train Loss: 7.001 Vali Loss: 57.290 Vali Acc: 0.694 Test Loss: 57.290 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.273056030273438
Epoch: 12, Steps: 34 | Train Loss: 5.540 Vali Loss: 75.535 Vali Acc: 0.763 Test Loss: 75.535 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.299073934555054
Epoch: 13, Steps: 34 | Train Loss: 3.157 Vali Loss: 26.952 Vali Acc: 0.821 Test Loss: 26.952 Test Acc: 0.821
Validation loss decreased (-0.762831 --> -0.820540).  Saving model ...
Epoch: 14 cost time: 21.313347101211548
Epoch: 14, Steps: 34 | Train Loss: 1.996 Vali Loss: 34.011 Vali Acc: 0.803 Test Loss: 34.011 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 21.276642084121704
Epoch: 15, Steps: 34 | Train Loss: 6.905 Vali Loss: 143.465 Vali Acc: 0.688 Test Loss: 143.465 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 21.282756328582764
Epoch: 16, Steps: 34 | Train Loss: 9.118 Vali Loss: 157.159 Vali Acc: 0.699 Test Loss: 157.159 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 21.29098629951477
Epoch: 17, Steps: 34 | Train Loss: 14.476 Vali Loss: 166.517 Vali Acc: 0.682 Test Loss: 166.517 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 21.28278398513794
Epoch: 18, Steps: 34 | Train Loss: 13.832 Vali Loss: 359.287 Vali Acc: 0.665 Test Loss: 359.287 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 21.277151584625244
Epoch: 19, Steps: 34 | Train Loss: 21.499 Vali Loss: 244.970 Vali Acc: 0.740 Test Loss: 244.970 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 21.292897701263428
Epoch: 20, Steps: 34 | Train Loss: 7.894 Vali Loss: 227.176 Vali Acc: 0.769 Test Loss: 227.176 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 21.277355194091797
Epoch: 21, Steps: 34 | Train Loss: 8.433 Vali Loss: 260.789 Vali Acc: 0.740 Test Loss: 260.789 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 21.28693985939026
Epoch: 22, Steps: 34 | Train Loss: 3.235 Vali Loss: 250.672 Vali Acc: 0.734 Test Loss: 250.672 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 21.283514499664307
Epoch: 23, Steps: 34 | Train Loss: 22.900 Vali Loss: 192.505 Vali Acc: 0.769 Test Loss: 192.505 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1812541575
model size : 6919.97MB
2025-04-28 06:20:35.342884: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:20:35.361723: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745821235.384607  612755 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745821235.391595  612755 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:20:35.414488: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.42495059967041
Epoch: 1, Steps: 17 | Train Loss: 3.851 Vali Loss: 3.624 Vali Acc: 0.526 Test Loss: 3.624 Test Acc: 0.526
Validation loss decreased (inf --> -0.525975).  Saving model ...
Epoch: 2 cost time: 11.154080867767334
Epoch: 2, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.223 Vali Acc: 0.682 Test Loss: 2.223 Test Acc: 0.682
Validation loss decreased (-0.525975 --> -0.682059).  Saving model ...
Epoch: 3 cost time: 11.147535562515259
Epoch: 3, Steps: 17 | Train Loss: 0.399 Vali Loss: 2.539 Vali Acc: 0.792 Test Loss: 2.539 Test Acc: 0.792
Validation loss decreased (-0.682059 --> -0.791882).  Saving model ...
Epoch: 4 cost time: 11.16262173652649
Epoch: 4, Steps: 17 | Train Loss: 0.267 Vali Loss: 3.537 Vali Acc: 0.786 Test Loss: 3.537 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.11915373802185
Epoch: 5, Steps: 17 | Train Loss: 0.488 Vali Loss: 3.923 Vali Acc: 0.699 Test Loss: 3.923 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.116321563720703
Epoch: 6, Steps: 17 | Train Loss: 0.406 Vali Loss: 8.077 Vali Acc: 0.642 Test Loss: 8.077 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.108179807662964
Epoch: 7, Steps: 17 | Train Loss: 1.264 Vali Loss: 7.197 Vali Acc: 0.775 Test Loss: 7.197 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.131510972976685
Epoch: 8, Steps: 17 | Train Loss: 0.610 Vali Loss: 6.161 Vali Acc: 0.769 Test Loss: 6.161 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.111164331436157
Epoch: 9, Steps: 17 | Train Loss: 0.361 Vali Loss: 4.281 Vali Acc: 0.798 Test Loss: 4.281 Test Acc: 0.798
Validation loss decreased (-0.791882 --> -0.797645).  Saving model ...
Epoch: 10 cost time: 11.101622104644775
Epoch: 10, Steps: 17 | Train Loss: 1.155 Vali Loss: 12.367 Vali Acc: 0.780 Test Loss: 12.367 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.05595874786377
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 11.763 Vali Acc: 0.751 Test Loss: 11.763 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.054496049880981
Epoch: 12, Steps: 17 | Train Loss: 0.468 Vali Loss: 10.758 Vali Acc: 0.775 Test Loss: 10.758 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.047835111618042
Epoch: 13, Steps: 17 | Train Loss: 0.341 Vali Loss: 15.524 Vali Acc: 0.809 Test Loss: 15.524 Test Acc: 0.809
Validation loss decreased (-0.797645 --> -0.809093).  Saving model ...
Epoch: 14 cost time: 11.088008880615234
Epoch: 14, Steps: 17 | Train Loss: 0.309 Vali Loss: 18.425 Vali Acc: 0.711 Test Loss: 18.425 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.067421674728394
Epoch: 15, Steps: 17 | Train Loss: 0.103 Vali Loss: 20.028 Vali Acc: 0.699 Test Loss: 20.028 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.050657033920288
Epoch: 16, Steps: 17 | Train Loss: 0.393 Vali Loss: 15.465 Vali Acc: 0.705 Test Loss: 15.465 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.061094522476196
Epoch: 17, Steps: 17 | Train Loss: 0.112 Vali Loss: 19.426 Vali Acc: 0.792 Test Loss: 19.426 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.056862354278564
Epoch: 18, Steps: 17 | Train Loss: 0.204 Vali Loss: 22.768 Vali Acc: 0.746 Test Loss: 22.768 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.059773683547974
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 34.323 Vali Acc: 0.665 Test Loss: 34.323 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.108412504196167
Epoch: 20, Steps: 17 | Train Loss: 0.348 Vali Loss: 31.721 Vali Acc: 0.705 Test Loss: 31.721 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.06359052658081
Epoch: 21, Steps: 17 | Train Loss: 1.232 Vali Loss: 31.959 Vali Acc: 0.746 Test Loss: 31.959 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.050512552261353
Epoch: 22, Steps: 17 | Train Loss: 1.630 Vali Loss: 21.865 Vali Acc: 0.734 Test Loss: 21.865 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.053306818008423
Epoch: 23, Steps: 17 | Train Loss: 0.296 Vali Loss: 26.867 Vali Acc: 0.699 Test Loss: 26.867 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1781479559
model size : 6801.48MB
2025-04-28 06:28:44.060807: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:28:44.080395: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745821724.104213  624619 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745821724.111401  624619 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:28:44.135224: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.145076513290405
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 0.860 Vali Acc: 0.740 Test Loss: 0.860 Test Acc: 0.740
Validation loss decreased (inf --> -0.739876).  Saving model ...
Epoch: 2 cost time: 10.993713855743408
Epoch: 2, Steps: 17 | Train Loss: 0.349 Vali Loss: 2.577 Vali Acc: 0.711 Test Loss: 2.577 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.983481884002686
Epoch: 3, Steps: 17 | Train Loss: 0.376 Vali Loss: 5.412 Vali Acc: 0.636 Test Loss: 5.412 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.940694332122803
Epoch: 4, Steps: 17 | Train Loss: 0.742 Vali Loss: 2.932 Vali Acc: 0.723 Test Loss: 2.932 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.947802305221558
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.203 Vali Acc: 0.798 Test Loss: 2.203 Test Acc: 0.798
Validation loss decreased (-0.739876 --> -0.797666).  Saving model ...
Epoch: 6 cost time: 10.989816188812256
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 3.157 Vali Acc: 0.757 Test Loss: 3.157 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.96053171157837
Epoch: 7, Steps: 17 | Train Loss: 0.036 Vali Loss: 3.817 Vali Acc: 0.711 Test Loss: 3.817 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.954070568084717
Epoch: 8, Steps: 17 | Train Loss: 0.024 Vali Loss: 4.931 Vali Acc: 0.792 Test Loss: 4.931 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.961315155029297
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 4.244 Vali Acc: 0.798 Test Loss: 4.244 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.958191871643066
Epoch: 10, Steps: 17 | Train Loss: 0.337 Vali Loss: 7.459 Vali Acc: 0.734 Test Loss: 7.459 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.94153118133545
Epoch: 11, Steps: 17 | Train Loss: 0.951 Vali Loss: 11.356 Vali Acc: 0.688 Test Loss: 11.356 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.95122504234314
Epoch: 12, Steps: 17 | Train Loss: 0.982 Vali Loss: 6.410 Vali Acc: 0.821 Test Loss: 6.410 Test Acc: 0.821
Validation loss decreased (-0.797666 --> -0.820745).  Saving model ...
Epoch: 13 cost time: 10.979351282119751
Epoch: 13, Steps: 17 | Train Loss: 0.261 Vali Loss: 10.703 Vali Acc: 0.803 Test Loss: 10.703 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.969602346420288
Epoch: 14, Steps: 17 | Train Loss: 0.917 Vali Loss: 15.968 Vali Acc: 0.734 Test Loss: 15.968 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.966375350952148
Epoch: 15, Steps: 17 | Train Loss: 1.620 Vali Loss: 23.313 Vali Acc: 0.671 Test Loss: 23.313 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.948671340942383
Epoch: 16, Steps: 17 | Train Loss: 1.238 Vali Loss: 21.772 Vali Acc: 0.688 Test Loss: 21.772 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.954092741012573
Epoch: 17, Steps: 17 | Train Loss: 1.501 Vali Loss: 11.177 Vali Acc: 0.763 Test Loss: 11.177 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.948101282119751
Epoch: 18, Steps: 17 | Train Loss: 0.872 Vali Loss: 21.410 Vali Acc: 0.723 Test Loss: 21.410 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.963958740234375
Epoch: 19, Steps: 17 | Train Loss: 1.280 Vali Loss: 20.851 Vali Acc: 0.740 Test Loss: 20.851 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.945924758911133
Epoch: 20, Steps: 17 | Train Loss: 0.355 Vali Loss: 18.684 Vali Acc: 0.746 Test Loss: 18.684 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.949106454849243
Epoch: 21, Steps: 17 | Train Loss: 0.231 Vali Loss: 21.600 Vali Acc: 0.775 Test Loss: 21.600 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.9893798828125
Epoch: 22, Steps: 17 | Train Loss: 0.304 Vali Loss: 24.155 Vali Acc: 0.786 Test Loss: 24.155 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1771125767
model size : 6761.98MB
2025-04-28 06:36:03.027988: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:36:03.046549: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745822163.068750  635857 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745822163.076020  635857 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:36:03.098970: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.584551572799683
Epoch: 1, Steps: 17 | Train Loss: 2.159 Vali Loss: 1.878 Vali Acc: 0.618 Test Loss: 1.878 Test Acc: 0.618
Validation loss decreased (inf --> -0.618478).  Saving model ...
Epoch: 2 cost time: 10.42828917503357
Epoch: 2, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.560 Vali Acc: 0.734 Test Loss: 1.560 Test Acc: 0.734
Validation loss decreased (-0.618478 --> -0.734088).  Saving model ...
Epoch: 3 cost time: 10.38223385810852
Epoch: 3, Steps: 17 | Train Loss: 0.256 Vali Loss: 2.120 Vali Acc: 0.786 Test Loss: 2.120 Test Acc: 0.786
Validation loss decreased (-0.734088 --> -0.786106).  Saving model ...
Epoch: 4 cost time: 10.36547565460205
Epoch: 4, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.739 Vali Acc: 0.740 Test Loss: 2.739 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.349924325942993
Epoch: 5, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.662 Vali Acc: 0.780 Test Loss: 1.662 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.37247347831726
Epoch: 6, Steps: 17 | Train Loss: 0.104 Vali Loss: 4.257 Vali Acc: 0.740 Test Loss: 4.257 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.373280048370361
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 2.646 Vali Acc: 0.786 Test Loss: 2.646 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.374781608581543
Epoch: 8, Steps: 17 | Train Loss: 0.058 Vali Loss: 4.321 Vali Acc: 0.775 Test Loss: 4.321 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.366425275802612
Epoch: 9, Steps: 17 | Train Loss: 0.155 Vali Loss: 3.121 Vali Acc: 0.792 Test Loss: 3.121 Test Acc: 0.792
Validation loss decreased (-0.786106 --> -0.791876).  Saving model ...
Epoch: 10 cost time: 10.392951250076294
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 4.856 Vali Acc: 0.780 Test Loss: 4.856 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.363728523254395
Epoch: 11, Steps: 17 | Train Loss: 0.262 Vali Loss: 4.269 Vali Acc: 0.694 Test Loss: 4.269 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.35812258720398
Epoch: 12, Steps: 17 | Train Loss: 0.492 Vali Loss: 8.718 Vali Acc: 0.775 Test Loss: 8.718 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.367277383804321
Epoch: 13, Steps: 17 | Train Loss: 1.126 Vali Loss: 7.901 Vali Acc: 0.751 Test Loss: 7.901 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.345798969268799
Epoch: 14, Steps: 17 | Train Loss: 0.151 Vali Loss: 8.618 Vali Acc: 0.769 Test Loss: 8.618 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.355978012084961
Epoch: 15, Steps: 17 | Train Loss: 0.231 Vali Loss: 9.200 Vali Acc: 0.717 Test Loss: 9.200 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.351320505142212
Epoch: 16, Steps: 17 | Train Loss: 0.383 Vali Loss: 9.779 Vali Acc: 0.723 Test Loss: 9.779 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.38854718208313
Epoch: 17, Steps: 17 | Train Loss: 0.943 Vali Loss: 21.900 Vali Acc: 0.746 Test Loss: 21.900 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 10.390945196151733
Epoch: 18, Steps: 17 | Train Loss: 3.735 Vali Loss: 25.346 Vali Acc: 0.636 Test Loss: 25.346 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 10.42159652709961
Epoch: 19, Steps: 17 | Train Loss: 2.169 Vali Loss: 11.376 Vali Acc: 0.827 Test Loss: 11.376 Test Acc: 0.827
Validation loss decreased (-0.791876 --> -0.826476).  Saving model ...
Epoch: 20 cost time: 10.431782484054565
Epoch: 20, Steps: 17 | Train Loss: 0.817 Vali Loss: 28.155 Vali Acc: 0.740 Test Loss: 28.155 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 10.40101432800293
Epoch: 21, Steps: 17 | Train Loss: 0.125 Vali Loss: 25.510 Vali Acc: 0.792 Test Loss: 25.510 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.403570890426636
Epoch: 22, Steps: 17 | Train Loss: 0.508 Vali Loss: 27.230 Vali Acc: 0.786 Test Loss: 27.230 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 10.38292908668518
Epoch: 23, Steps: 17 | Train Loss: 0.743 Vali Loss: 37.439 Vali Acc: 0.711 Test Loss: 37.439 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 10.398690938949585
Epoch: 24, Steps: 17 | Train Loss: 1.120 Vali Loss: 37.588 Vali Acc: 0.786 Test Loss: 37.588 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 10.387057542800903
Epoch: 25, Steps: 17 | Train Loss: 0.480 Vali Loss: 32.432 Vali Acc: 0.769 Test Loss: 32.432 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 10.385637998580933
Epoch: 26, Steps: 17 | Train Loss: 0.819 Vali Loss: 61.548 Vali Acc: 0.653 Test Loss: 61.548 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.412835597991943
Epoch: 27, Steps: 17 | Train Loss: 0.572 Vali Loss: 56.002 Vali Acc: 0.723 Test Loss: 56.002 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 10.410272598266602
Epoch: 28, Steps: 17 | Train Loss: 1.238 Vali Loss: 63.744 Vali Acc: 0.746 Test Loss: 63.744 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 10.410751104354858
Epoch: 29, Steps: 17 | Train Loss: 0.898 Vali Loss: 44.742 Vali Acc: 0.723 Test Loss: 44.742 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1765949191
model size : 6742.23MB
2025-04-28 06:45:25.732480: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:45:25.751916: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745822725.775612  650533 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745822725.782839  650533 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:45:25.807731: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.325474500656128
Epoch: 1, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.499 Vali Acc: 0.561 Test Loss: 2.499 Test Acc: 0.561
Validation loss decreased (inf --> -0.560669).  Saving model ...
Epoch: 2 cost time: 10.121562004089355
Epoch: 2, Steps: 17 | Train Loss: 0.779 Vali Loss: 1.714 Vali Acc: 0.728 Test Loss: 1.714 Test Acc: 0.728
Validation loss decreased (-0.560669 --> -0.728307).  Saving model ...
Epoch: 3 cost time: 10.18906044960022
Epoch: 3, Steps: 17 | Train Loss: 0.865 Vali Loss: 3.353 Vali Acc: 0.775 Test Loss: 3.353 Test Acc: 0.775
Validation loss decreased (-0.728307 --> -0.774533).  Saving model ...
Epoch: 4 cost time: 10.139631509780884
Epoch: 4, Steps: 17 | Train Loss: 0.383 Vali Loss: 1.824 Vali Acc: 0.786 Test Loss: 1.824 Test Acc: 0.786
Validation loss decreased (-0.774533 --> -0.786109).  Saving model ...
Epoch: 5 cost time: 10.146355867385864
Epoch: 5, Steps: 17 | Train Loss: 0.147 Vali Loss: 2.872 Vali Acc: 0.786 Test Loss: 2.872 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.0486421585083
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 3.192 Vali Acc: 0.757 Test Loss: 3.192 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.060640573501587
Epoch: 7, Steps: 17 | Train Loss: 0.156 Vali Loss: 4.335 Vali Acc: 0.803 Test Loss: 4.335 Test Acc: 0.803
Validation loss decreased (-0.786109 --> -0.803425).  Saving model ...
Epoch: 8 cost time: 10.158872842788696
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 3.568 Vali Acc: 0.775 Test Loss: 3.568 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.064767837524414
Epoch: 9, Steps: 17 | Train Loss: 0.204 Vali Loss: 3.258 Vali Acc: 0.763 Test Loss: 3.258 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.076103448867798
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 4.225 Vali Acc: 0.803 Test Loss: 4.225 Test Acc: 0.803
Validation loss decreased (-0.803425 --> -0.803426).  Saving model ...
Epoch: 11 cost time: 10.064336061477661
Epoch: 11, Steps: 17 | Train Loss: 0.291 Vali Loss: 6.424 Vali Acc: 0.711 Test Loss: 6.424 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.054970026016235
Epoch: 12, Steps: 17 | Train Loss: 0.390 Vali Loss: 5.328 Vali Acc: 0.757 Test Loss: 5.328 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.056229591369629
Epoch: 13, Steps: 17 | Train Loss: 0.520 Vali Loss: 7.977 Vali Acc: 0.769 Test Loss: 7.977 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.058670043945312
Epoch: 14, Steps: 17 | Train Loss: 0.859 Vali Loss: 7.788 Vali Acc: 0.740 Test Loss: 7.788 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.064080476760864
Epoch: 15, Steps: 17 | Train Loss: 0.478 Vali Loss: 5.961 Vali Acc: 0.751 Test Loss: 5.961 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.065828084945679
Epoch: 16, Steps: 17 | Train Loss: 1.314 Vali Loss: 10.077 Vali Acc: 0.723 Test Loss: 10.077 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.076251029968262
Epoch: 17, Steps: 17 | Train Loss: 0.712 Vali Loss: 10.608 Vali Acc: 0.763 Test Loss: 10.608 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.068066835403442
Epoch: 18, Steps: 17 | Train Loss: 0.237 Vali Loss: 10.548 Vali Acc: 0.757 Test Loss: 10.548 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.054348945617676
Epoch: 19, Steps: 17 | Train Loss: 1.646 Vali Loss: 11.718 Vali Acc: 0.757 Test Loss: 11.718 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.063959121704102
Epoch: 20, Steps: 17 | Train Loss: 0.864 Vali Loss: 19.614 Vali Acc: 0.734 Test Loss: 19.614 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1762498695
model size : 6729.07MB
2025-04-28 06:52:45.237406: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 06:52:45.256362: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745823165.279004  660936 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745823165.285860  660936 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 06:52:45.308730: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.908152341842651
Epoch: 1, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.081 Vali Acc: 0.665 Test Loss: 1.081 Test Acc: 0.665
Validation loss decreased (inf --> -0.664729).  Saving model ...
Epoch: 2 cost time: 9.694762706756592
Epoch: 2, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.682 Vali Acc: 0.798 Test Loss: 0.682 Test Acc: 0.798
Validation loss decreased (-0.664729 --> -0.797681).  Saving model ...
Epoch: 3 cost time: 9.746875286102295
Epoch: 3, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.528 Vali Acc: 0.775 Test Loss: 1.528 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.668405771255493
Epoch: 4, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.678 Vali Acc: 0.775 Test Loss: 1.678 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.664443969726562
Epoch: 5, Steps: 17 | Train Loss: 0.198 Vali Loss: 1.478 Vali Acc: 0.803 Test Loss: 1.478 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803453).  Saving model ...
Epoch: 6 cost time: 9.689472198486328
Epoch: 6, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.664 Vali Acc: 0.769 Test Loss: 1.664 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.67730188369751
Epoch: 7, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.499 Vali Acc: 0.734 Test Loss: 2.499 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.675488233566284
Epoch: 8, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.386 Vali Acc: 0.803 Test Loss: 1.386 Test Acc: 0.803
Validation loss decreased (-0.803453 --> -0.803454).  Saving model ...
Epoch: 9 cost time: 9.727771282196045
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 2.018 Vali Acc: 0.792 Test Loss: 2.018 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.674006223678589
Epoch: 10, Steps: 17 | Train Loss: 0.155 Vali Loss: 2.531 Vali Acc: 0.798 Test Loss: 2.531 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.68424105644226
Epoch: 11, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.792 Vali Acc: 0.809 Test Loss: 2.792 Test Acc: 0.809
Validation loss decreased (-0.803454 --> -0.809221).  Saving model ...
Epoch: 12 cost time: 9.740735054016113
Epoch: 12, Steps: 17 | Train Loss: 0.304 Vali Loss: 2.769 Vali Acc: 0.821 Test Loss: 2.769 Test Acc: 0.821
Validation loss decreased (-0.809221 --> -0.820782).  Saving model ...
Epoch: 13 cost time: 9.69890809059143
Epoch: 13, Steps: 17 | Train Loss: 0.409 Vali Loss: 4.864 Vali Acc: 0.694 Test Loss: 4.864 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.694169044494629
Epoch: 14, Steps: 17 | Train Loss: 0.532 Vali Loss: 7.443 Vali Acc: 0.757 Test Loss: 7.443 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.678216695785522
Epoch: 15, Steps: 17 | Train Loss: 0.146 Vali Loss: 8.787 Vali Acc: 0.665 Test Loss: 8.787 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.669187307357788
Epoch: 16, Steps: 17 | Train Loss: 0.382 Vali Loss: 12.446 Vali Acc: 0.682 Test Loss: 12.446 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.662432670593262
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 8.174 Vali Acc: 0.746 Test Loss: 8.174 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.674421072006226
Epoch: 18, Steps: 17 | Train Loss: 0.251 Vali Loss: 7.797 Vali Acc: 0.821 Test Loss: 7.797 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.683758735656738
Epoch: 19, Steps: 17 | Train Loss: 0.093 Vali Loss: 8.339 Vali Acc: 0.786 Test Loss: 8.339 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.68009614944458
Epoch: 20, Steps: 17 | Train Loss: 0.124 Vali Loss: 12.121 Vali Acc: 0.769 Test Loss: 12.121 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.678775787353516
Epoch: 21, Steps: 17 | Train Loss: 0.471 Vali Loss: 26.734 Vali Acc: 0.717 Test Loss: 26.734 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.702975034713745
Epoch: 22, Steps: 17 | Train Loss: 2.282 Vali Loss: 13.756 Vali Acc: 0.803 Test Loss: 13.756 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1759048199
model size : 6715.91MB
2025-04-28 07:00:29.603021: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:00:29.621838: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745823629.644338  672303 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745823629.651256  672303 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:00:29.673953: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.677890539169312
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.195 Vali Acc: 0.572 Test Loss: 1.195 Test Acc: 0.572
Validation loss decreased (inf --> -0.572242).  Saving model ...
Epoch: 2 cost time: 9.439550161361694
Epoch: 2, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.862 Vali Acc: 0.780 Test Loss: 0.862 Test Acc: 0.780
Validation loss decreased (-0.572242 --> -0.780338).  Saving model ...
Epoch: 3 cost time: 9.459124088287354
Epoch: 3, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.557 Vali Acc: 0.601 Test Loss: 2.557 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.414483070373535
Epoch: 4, Steps: 17 | Train Loss: 0.279 Vali Loss: 2.110 Vali Acc: 0.688 Test Loss: 2.110 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.41457462310791
Epoch: 5, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.811 Vali Acc: 0.821 Test Loss: 0.811 Test Acc: 0.821
Validation loss decreased (-0.780338 --> -0.820801).  Saving model ...
Epoch: 6 cost time: 9.454457998275757
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.581 Vali Acc: 0.821 Test Loss: 1.581 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.398029088973999
Epoch: 7, Steps: 17 | Train Loss: 0.246 Vali Loss: 2.395 Vali Acc: 0.809 Test Loss: 2.395 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.402276039123535
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.758 Vali Acc: 0.855 Test Loss: 1.758 Test Acc: 0.855
Validation loss decreased (-0.820801 --> -0.855474).  Saving model ...
Epoch: 9 cost time: 9.475594997406006
Epoch: 9, Steps: 17 | Train Loss: 0.147 Vali Loss: 4.313 Vali Acc: 0.780 Test Loss: 4.313 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.411734819412231
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.334 Vali Acc: 0.803 Test Loss: 2.334 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.411037921905518
Epoch: 11, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.692 Vali Acc: 0.844 Test Loss: 1.692 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.407445430755615
Epoch: 12, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.963 Vali Acc: 0.780 Test Loss: 2.963 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.401443481445312
Epoch: 13, Steps: 17 | Train Loss: 0.239 Vali Loss: 2.935 Vali Acc: 0.769 Test Loss: 2.935 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.451684951782227
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 4.338 Vali Acc: 0.694 Test Loss: 4.338 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.444398641586304
Epoch: 15, Steps: 17 | Train Loss: 0.443 Vali Loss: 5.607 Vali Acc: 0.688 Test Loss: 5.607 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.440245866775513
Epoch: 16, Steps: 17 | Train Loss: 0.342 Vali Loss: 4.908 Vali Acc: 0.763 Test Loss: 4.908 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.450167417526245
Epoch: 17, Steps: 17 | Train Loss: 0.627 Vali Loss: 8.509 Vali Acc: 0.717 Test Loss: 8.509 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.470444202423096
Epoch: 18, Steps: 17 | Train Loss: 0.814 Vali Loss: 14.816 Vali Acc: 0.711 Test Loss: 14.816 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1757323399
model size : 6709.33MB
2025-04-28 07:06:27.295232: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:06:27.315252: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745823987.339517  681527 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745823987.346747  681527 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:06:27.370598: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.010463237762451
Epoch: 1, Steps: 17 | Train Loss: 2.354 Vali Loss: 3.347 Vali Acc: 0.549 Test Loss: 3.347 Test Acc: 0.549
Validation loss decreased (inf --> -0.549099).  Saving model ...
Epoch: 2 cost time: 7.83873438835144
Epoch: 2, Steps: 17 | Train Loss: 1.940 Vali Loss: 3.471 Vali Acc: 0.671 Test Loss: 3.471 Test Acc: 0.671
Validation loss decreased (-0.549099 --> -0.670486).  Saving model ...
Epoch: 3 cost time: 7.846637725830078
Epoch: 3, Steps: 17 | Train Loss: 0.941 Vali Loss: 6.774 Vali Acc: 0.613 Test Loss: 6.774 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.810290098190308
Epoch: 4, Steps: 17 | Train Loss: 0.757 Vali Loss: 4.424 Vali Acc: 0.746 Test Loss: 4.424 Test Acc: 0.746
Validation loss decreased (-0.670486 --> -0.745621).  Saving model ...
Epoch: 5 cost time: 7.833372354507446
Epoch: 5, Steps: 17 | Train Loss: 0.919 Vali Loss: 5.698 Vali Acc: 0.746 Test Loss: 5.698 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.757172107696533
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 8.252 Vali Acc: 0.728 Test Loss: 8.252 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.788060903549194
Epoch: 7, Steps: 17 | Train Loss: 0.452 Vali Loss: 5.757 Vali Acc: 0.723 Test Loss: 5.757 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.774883270263672
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 7.330 Vali Acc: 0.671 Test Loss: 7.330 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.778282403945923
Epoch: 9, Steps: 17 | Train Loss: 0.265 Vali Loss: 11.304 Vali Acc: 0.740 Test Loss: 11.304 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.785499572753906
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 11.373 Vali Acc: 0.647 Test Loss: 11.373 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.757292747497559
Epoch: 11, Steps: 17 | Train Loss: 0.658 Vali Loss: 7.239 Vali Acc: 0.769 Test Loss: 7.239 Test Acc: 0.769
Validation loss decreased (-0.745621 --> -0.768714).  Saving model ...
Epoch: 12 cost time: 7.809504508972168
Epoch: 12, Steps: 17 | Train Loss: 0.472 Vali Loss: 9.295 Vali Acc: 0.757 Test Loss: 9.295 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.772407531738281
Epoch: 13, Steps: 17 | Train Loss: 0.680 Vali Loss: 7.299 Vali Acc: 0.798 Test Loss: 7.299 Test Acc: 0.798
Validation loss decreased (-0.768714 --> -0.797615).  Saving model ...
Epoch: 14 cost time: 7.810863256454468
Epoch: 14, Steps: 17 | Train Loss: 0.291 Vali Loss: 18.599 Vali Acc: 0.595 Test Loss: 18.599 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.769491910934448
Epoch: 15, Steps: 17 | Train Loss: 0.231 Vali Loss: 13.780 Vali Acc: 0.705 Test Loss: 13.780 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.758260726928711
Epoch: 16, Steps: 17 | Train Loss: 0.456 Vali Loss: 15.513 Vali Acc: 0.751 Test Loss: 15.513 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.778948545455933
Epoch: 17, Steps: 17 | Train Loss: 0.250 Vali Loss: 17.078 Vali Acc: 0.757 Test Loss: 17.078 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.787905693054199
Epoch: 18, Steps: 17 | Train Loss: 0.136 Vali Loss: 18.878 Vali Acc: 0.746 Test Loss: 18.878 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.757293701171875
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 22.606 Vali Acc: 0.751 Test Loss: 22.606 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.764549970626831
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 21.643 Vali Acc: 0.740 Test Loss: 21.643 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.80309271812439
Epoch: 21, Steps: 17 | Train Loss: 0.286 Vali Loss: 18.086 Vali Acc: 0.740 Test Loss: 18.086 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.762672424316406
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 24.091 Vali Acc: 0.711 Test Loss: 24.091 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.758840322494507
Epoch: 23, Steps: 17 | Train Loss: 0.273 Vali Loss: 17.333 Vali Acc: 0.746 Test Loss: 17.333 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 827365447
model size : 3159.00MB
2025-04-28 07:11:56.734500: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:11:56.753511: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745824316.776636  692731 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745824316.783668  692731 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:11:56.806636: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.762685298919678
Epoch: 1, Steps: 17 | Train Loss: 2.482 Vali Loss: 3.816 Vali Acc: 0.543 Test Loss: 3.816 Test Acc: 0.543
Validation loss decreased (inf --> -0.543314).  Saving model ...
Epoch: 2 cost time: 6.471080303192139
Epoch: 2, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.276 Vali Acc: 0.734 Test Loss: 2.276 Test Acc: 0.734
Validation loss decreased (-0.543314 --> -0.734081).  Saving model ...
Epoch: 3 cost time: 6.507739782333374
Epoch: 3, Steps: 17 | Train Loss: 0.436 Vali Loss: 1.620 Vali Acc: 0.763 Test Loss: 1.620 Test Acc: 0.763
Validation loss decreased (-0.734081 --> -0.762990).  Saving model ...
Epoch: 4 cost time: 6.502841949462891
Epoch: 4, Steps: 17 | Train Loss: 0.652 Vali Loss: 2.031 Vali Acc: 0.728 Test Loss: 2.031 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.501868724822998
Epoch: 5, Steps: 17 | Train Loss: 0.103 Vali Loss: 3.200 Vali Acc: 0.757 Test Loss: 3.200 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.479889869689941
Epoch: 6, Steps: 17 | Train Loss: 0.113 Vali Loss: 3.058 Vali Acc: 0.751 Test Loss: 3.058 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.5069451332092285
Epoch: 7, Steps: 17 | Train Loss: 0.120 Vali Loss: 2.023 Vali Acc: 0.786 Test Loss: 2.023 Test Acc: 0.786
Validation loss decreased (-0.762990 --> -0.786107).  Saving model ...
Epoch: 8 cost time: 6.482949733734131
Epoch: 8, Steps: 17 | Train Loss: 0.095 Vali Loss: 5.987 Vali Acc: 0.613 Test Loss: 5.987 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.5145423412323
Epoch: 9, Steps: 17 | Train Loss: 0.127 Vali Loss: 6.438 Vali Acc: 0.723 Test Loss: 6.438 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.4620795249938965
Epoch: 10, Steps: 17 | Train Loss: 0.147 Vali Loss: 3.391 Vali Acc: 0.763 Test Loss: 3.391 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.49130392074585
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 5.406 Vali Acc: 0.676 Test Loss: 5.406 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.463217258453369
Epoch: 12, Steps: 17 | Train Loss: 0.210 Vali Loss: 8.300 Vali Acc: 0.671 Test Loss: 8.300 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.476248025894165
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 5.182 Vali Acc: 0.746 Test Loss: 5.182 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.484090089797974
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 10.746 Vali Acc: 0.647 Test Loss: 10.746 Test Acc: 0.647
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.459639072418213
Epoch: 15, Steps: 17 | Train Loss: 0.228 Vali Loss: 4.694 Vali Acc: 0.740 Test Loss: 4.694 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.497902154922485
Epoch: 16, Steps: 17 | Train Loss: 0.143 Vali Loss: 7.645 Vali Acc: 0.717 Test Loss: 7.645 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.486394643783569
Epoch: 17, Steps: 17 | Train Loss: 0.113 Vali Loss: 8.571 Vali Acc: 0.751 Test Loss: 8.571 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 811834439
model size : 3099.75MB
2025-04-28 07:15:38.395538: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:15:38.415620: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745824538.439443  700975 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745824538.446597  700975 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:15:38.470608: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.9112584590911865
Epoch: 1, Steps: 17 | Train Loss: 1.789 Vali Loss: 1.392 Vali Acc: 0.659 Test Loss: 1.392 Test Acc: 0.659
Validation loss decreased (inf --> -0.658946).  Saving model ...
Epoch: 2 cost time: 5.769865036010742
Epoch: 2, Steps: 17 | Train Loss: 0.261 Vali Loss: 2.384 Vali Acc: 0.624 Test Loss: 2.384 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.731370687484741
Epoch: 3, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
Validation loss decreased (-0.658946 --> -0.774556).  Saving model ...
Epoch: 4 cost time: 5.748947858810425
Epoch: 4, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.648 Vali Acc: 0.763 Test Loss: 1.648 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.756706476211548
Epoch: 5, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.200 Vali Acc: 0.780 Test Loss: 2.200 Test Acc: 0.780
Validation loss decreased (-0.774556 --> -0.780325).  Saving model ...
Epoch: 6 cost time: 5.7856714725494385
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.713 Vali Acc: 0.775 Test Loss: 1.713 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.756910562515259
Epoch: 7, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.834 Vali Acc: 0.775 Test Loss: 2.834 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.755237102508545
Epoch: 8, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.418 Vali Acc: 0.763 Test Loss: 2.418 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.743685483932495
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.576 Vali Acc: 0.798 Test Loss: 2.576 Test Acc: 0.798
Validation loss decreased (-0.780325 --> -0.797662).  Saving model ...
Epoch: 10 cost time: 5.778382778167725
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 2.057 Vali Acc: 0.832 Test Loss: 2.057 Test Acc: 0.832
Validation loss decreased (-0.797662 --> -0.832349).  Saving model ...
Epoch: 11 cost time: 5.789792776107788
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.694 Vali Acc: 0.809 Test Loss: 1.694 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.726541996002197
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 3.198 Vali Acc: 0.809 Test Loss: 3.198 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.7198522090911865
Epoch: 13, Steps: 17 | Train Loss: 0.096 Vali Loss: 4.075 Vali Acc: 0.769 Test Loss: 4.075 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.72987961769104
Epoch: 14, Steps: 17 | Train Loss: 0.119 Vali Loss: 3.052 Vali Acc: 0.827 Test Loss: 3.052 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.736631870269775
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 4.259 Vali Acc: 0.809 Test Loss: 4.259 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.732467889785767
Epoch: 16, Steps: 17 | Train Loss: 0.258 Vali Loss: 8.109 Vali Acc: 0.699 Test Loss: 8.109 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.709398031234741
Epoch: 17, Steps: 17 | Train Loss: 0.219 Vali Loss: 10.536 Vali Acc: 0.746 Test Loss: 10.536 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.706425666809082
Epoch: 18, Steps: 17 | Train Loss: 0.770 Vali Loss: 11.222 Vali Acc: 0.809 Test Loss: 11.222 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.710331201553345
Epoch: 19, Steps: 17 | Train Loss: 0.458 Vali Loss: 10.178 Vali Acc: 0.746 Test Loss: 10.178 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.732043743133545
Epoch: 20, Steps: 17 | Train Loss: 0.811 Vali Loss: 5.222 Vali Acc: 0.809 Test Loss: 5.222 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 806657543
model size : 3080.00MB
2025-04-28 07:19:35.768888: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:19:35.788211: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745824775.811073  710540 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745824775.818134  710540 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:19:35.841321: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.761741876602173
Epoch: 1, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.541 Vali Acc: 0.497 Test Loss: 1.541 Test Acc: 0.497
Validation loss decreased (inf --> -0.497094).  Saving model ...
Epoch: 2 cost time: 5.563681364059448
Epoch: 2, Steps: 17 | Train Loss: 0.340 Vali Loss: 1.114 Vali Acc: 0.740 Test Loss: 1.114 Test Acc: 0.740
Validation loss decreased (-0.497094 --> -0.739873).  Saving model ...
Epoch: 3 cost time: 5.564596652984619
Epoch: 3, Steps: 17 | Train Loss: 0.198 Vali Loss: 1.528 Vali Acc: 0.775 Test Loss: 1.528 Test Acc: 0.775
Validation loss decreased (-0.739873 --> -0.774551).  Saving model ...
Epoch: 4 cost time: 5.538549900054932
Epoch: 4, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.305 Vali Acc: 0.838 Test Loss: 1.305 Test Acc: 0.838
Validation loss decreased (-0.774551 --> -0.838137).  Saving model ...
Epoch: 5 cost time: 5.552087783813477
Epoch: 5, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.205 Vali Acc: 0.775 Test Loss: 2.205 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.50522518157959
Epoch: 6, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.261 Vali Acc: 0.751 Test Loss: 1.261 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.5054402351379395
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.621 Vali Acc: 0.717 Test Loss: 1.621 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.494221448898315
Epoch: 8, Steps: 17 | Train Loss: 0.058 Vali Loss: 2.303 Vali Acc: 0.717 Test Loss: 2.303 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.521261215209961
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.332 Vali Acc: 0.798 Test Loss: 2.332 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.497653245925903
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 4.821 Vali Acc: 0.751 Test Loss: 4.821 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.501142740249634
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 2.320 Vali Acc: 0.740 Test Loss: 2.320 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.532540798187256
Epoch: 12, Steps: 17 | Train Loss: 0.146 Vali Loss: 2.066 Vali Acc: 0.763 Test Loss: 2.066 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.504884243011475
Epoch: 13, Steps: 17 | Train Loss: 0.498 Vali Loss: 4.300 Vali Acc: 0.792 Test Loss: 4.300 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.5104594230651855
Epoch: 14, Steps: 17 | Train Loss: 0.227 Vali Loss: 3.258 Vali Acc: 0.821 Test Loss: 3.258 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 804069255
model size : 3070.13MB
2025-04-28 07:22:29.405938: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:22:29.424843: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745824949.447511  717323 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745824949.454428  717323 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:22:29.477281: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.77192759513855
Epoch: 1, Steps: 17 | Train Loss: 1.662 Vali Loss: 0.856 Vali Acc: 0.688 Test Loss: 0.856 Test Acc: 0.688
Validation loss decreased (inf --> -0.687853).  Saving model ...
Epoch: 2 cost time: 5.570105075836182
Epoch: 2, Steps: 17 | Train Loss: 0.472 Vali Loss: 1.184 Vali Acc: 0.636 Test Loss: 1.184 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5218825340271
Epoch: 3, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.764 Vali Acc: 0.705 Test Loss: 1.764 Test Acc: 0.705
Validation loss decreased (-0.687853 --> -0.705185).  Saving model ...
Epoch: 4 cost time: 5.59353232383728
Epoch: 4, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.579 Vali Acc: 0.728 Test Loss: 1.579 Test Acc: 0.728
Validation loss decreased (-0.705185 --> -0.728308).  Saving model ...
Epoch: 5 cost time: 5.59537148475647
Epoch: 5, Steps: 17 | Train Loss: 0.091 Vali Loss: 2.018 Vali Acc: 0.734 Test Loss: 2.018 Test Acc: 0.734
Validation loss decreased (-0.728308 --> -0.734084).  Saving model ...
Epoch: 6 cost time: 5.60927152633667
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 2.863 Vali Acc: 0.740 Test Loss: 2.863 Test Acc: 0.740
Validation loss decreased (-0.734084 --> -0.739856).  Saving model ...
Epoch: 7 cost time: 5.584031581878662
Epoch: 7, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.506 Vali Acc: 0.763 Test Loss: 1.506 Test Acc: 0.763
Validation loss decreased (-0.739856 --> -0.762991).  Saving model ...
Epoch: 8 cost time: 5.547636985778809
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.761 Vali Acc: 0.769 Test Loss: 1.761 Test Acc: 0.769
Validation loss decreased (-0.762991 --> -0.768769).  Saving model ...
Epoch: 9 cost time: 5.59794282913208
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.328 Vali Acc: 0.792 Test Loss: 1.328 Test Acc: 0.792
Validation loss decreased (-0.768769 --> -0.791894).  Saving model ...
Epoch: 10 cost time: 5.57660174369812
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 3.451 Vali Acc: 0.711 Test Loss: 3.451 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.549798965454102
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.960 Vali Acc: 0.751 Test Loss: 2.960 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.540260076522827
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.557 Vali Acc: 0.769 Test Loss: 2.557 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.5489606857299805
Epoch: 13, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.445 Vali Acc: 0.699 Test Loss: 3.445 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.578242301940918
Epoch: 14, Steps: 17 | Train Loss: 0.195 Vali Loss: 2.279 Vali Acc: 0.763 Test Loss: 2.279 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.544477462768555
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.364 Vali Acc: 0.780 Test Loss: 2.364 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.531155586242676
Epoch: 16, Steps: 17 | Train Loss: 0.140 Vali Loss: 2.036 Vali Acc: 0.827 Test Loss: 2.036 Test Acc: 0.827
Validation loss decreased (-0.791894 --> -0.826569).  Saving model ...
Epoch: 17 cost time: 5.584478855133057
Epoch: 17, Steps: 17 | Train Loss: 0.184 Vali Loss: 2.620 Vali Acc: 0.815 Test Loss: 2.620 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.526171922683716
Epoch: 18, Steps: 17 | Train Loss: 0.246 Vali Loss: 3.805 Vali Acc: 0.763 Test Loss: 3.805 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.543539047241211
Epoch: 19, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.870 Vali Acc: 0.792 Test Loss: 2.870 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.537285804748535
Epoch: 20, Steps: 17 | Train Loss: 0.645 Vali Loss: 11.170 Vali Acc: 0.561 Test Loss: 11.170 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.529855728149414
Epoch: 21, Steps: 17 | Train Loss: 0.661 Vali Loss: 8.828 Vali Acc: 0.676 Test Loss: 8.828 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.534311294555664
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 8.246 Vali Acc: 0.780 Test Loss: 8.246 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.53647255897522
Epoch: 23, Steps: 17 | Train Loss: 0.717 Vali Loss: 14.537 Vali Acc: 0.734 Test Loss: 14.537 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.533859729766846
Epoch: 24, Steps: 17 | Train Loss: 0.592 Vali Loss: 7.970 Vali Acc: 0.763 Test Loss: 7.970 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.540464401245117
Epoch: 25, Steps: 17 | Train Loss: 0.241 Vali Loss: 7.403 Vali Acc: 0.803 Test Loss: 7.403 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.565097332000732
Epoch: 26, Steps: 17 | Train Loss: 0.259 Vali Loss: 8.974 Vali Acc: 0.763 Test Loss: 8.974 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 802344007
model size : 3063.55MB
2025-04-28 07:27:36.877804: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:27:36.896708: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745825256.919238  729711 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745825256.926370  729711 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:27:36.949991: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.505789756774902
Epoch: 1, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.012 Vali Acc: 0.630 Test Loss: 1.012 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 5.323823928833008
Epoch: 2, Steps: 17 | Train Loss: 0.422 Vali Loss: 1.183 Vali Acc: 0.734 Test Loss: 1.183 Test Acc: 0.734
Validation loss decreased (-0.630048 --> -0.734092).  Saving model ...
Epoch: 3 cost time: 5.3245391845703125
Epoch: 3, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.154 Vali Acc: 0.757 Test Loss: 1.154 Test Acc: 0.757
Validation loss decreased (-0.734092 --> -0.757214).  Saving model ...
Epoch: 4 cost time: 5.299926280975342
Epoch: 4, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.658 Vali Acc: 0.815 Test Loss: 0.658 Test Acc: 0.815
Validation loss decreased (-0.757214 --> -0.815022).  Saving model ...
Epoch: 5 cost time: 5.297082185745239
Epoch: 5, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.065 Vali Acc: 0.751 Test Loss: 1.065 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.26560640335083
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 2.220 Vali Acc: 0.699 Test Loss: 2.220 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.287788152694702
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.225 Vali Acc: 0.763 Test Loss: 1.225 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.294836044311523
Epoch: 8, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.236 Vali Acc: 0.699 Test Loss: 2.236 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.29744291305542
Epoch: 9, Steps: 17 | Train Loss: 0.425 Vali Loss: 3.540 Vali Acc: 0.688 Test Loss: 3.540 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.297060966491699
Epoch: 10, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.774 Vali Acc: 0.728 Test Loss: 2.774 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.295162200927734
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.976 Vali Acc: 0.751 Test Loss: 1.976 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.270745754241943
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.711 Vali Acc: 0.723 Test Loss: 2.711 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.2817840576171875
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.928 Vali Acc: 0.728 Test Loss: 2.928 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.270766973495483
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 4.896 Vali Acc: 0.705 Test Loss: 4.896 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 800618759
model size : 3056.97MB
2025-04-28 07:30:24.495019: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:30:24.515130: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745825424.538667  736473 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745825424.545699  736473 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:30:24.568500: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.399940729141235
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 0.791 Vali Acc: 0.671 Test Loss: 0.791 Test Acc: 0.671
Validation loss decreased (inf --> -0.670512).  Saving model ...
Epoch: 2 cost time: 5.211622953414917
Epoch: 2, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.953 Vali Acc: 0.751 Test Loss: 0.953 Test Acc: 0.751
Validation loss decreased (-0.670512 --> -0.751436).  Saving model ...
Epoch: 3 cost time: 5.157225847244263
Epoch: 3, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.829 Vali Acc: 0.815 Test Loss: 0.829 Test Acc: 0.815
Validation loss decreased (-0.751436 --> -0.815021).  Saving model ...
Epoch: 4 cost time: 5.190368890762329
Epoch: 4, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.191 Vali Acc: 0.780 Test Loss: 1.191 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.147878408432007
Epoch: 5, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.100 Vali Acc: 0.728 Test Loss: 2.100 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.154052972793579
Epoch: 6, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.818 Vali Acc: 0.769 Test Loss: 0.818 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.151472330093384
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.908 Vali Acc: 0.798 Test Loss: 1.908 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.113286256790161
Epoch: 8, Steps: 17 | Train Loss: 0.256 Vali Loss: 2.093 Vali Acc: 0.780 Test Loss: 2.093 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.143678426742554
Epoch: 9, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.092 Vali Acc: 0.775 Test Loss: 2.092 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.158293724060059
Epoch: 10, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.492 Vali Acc: 0.786 Test Loss: 1.492 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.123923301696777
Epoch: 11, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.659 Vali Acc: 0.717 Test Loss: 2.659 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.137932777404785
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.340 Vali Acc: 0.775 Test Loss: 2.340 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.140054941177368
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.896 Vali Acc: 0.786 Test Loss: 1.896 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 799756359
model size : 3053.68MB
2025-04-28 07:32:53.947467: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:32:53.966635: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745825573.989869  742742 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745825573.996823  742742 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:32:54.019345: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.964343309402466
Epoch: 1, Steps: 17 | Train Loss: 2.642 Vali Loss: 1.836 Vali Acc: 0.647 Test Loss: 1.836 Test Acc: 0.647
Validation loss decreased (inf --> -0.647380).  Saving model ...
Epoch: 2 cost time: 4.699583053588867
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 5.465 Vali Acc: 0.538 Test Loss: 5.465 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.698822498321533
Epoch: 3, Steps: 17 | Train Loss: 0.960 Vali Loss: 3.579 Vali Acc: 0.665 Test Loss: 3.579 Test Acc: 0.665
Validation loss decreased (-0.647380 --> -0.664704).  Saving model ...
Epoch: 4 cost time: 4.7297468185424805
Epoch: 4, Steps: 17 | Train Loss: 0.995 Vali Loss: 3.846 Vali Acc: 0.699 Test Loss: 3.846 Test Acc: 0.699
Validation loss decreased (-0.664704 --> -0.699384).  Saving model ...
Epoch: 5 cost time: 4.731443881988525
Epoch: 5, Steps: 17 | Train Loss: 0.660 Vali Loss: 2.948 Vali Acc: 0.751 Test Loss: 2.948 Test Acc: 0.751
Validation loss decreased (-0.699384 --> -0.751416).  Saving model ...
Epoch: 6 cost time: 4.71697998046875
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 6.028 Vali Acc: 0.636 Test Loss: 6.028 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.685561180114746
Epoch: 7, Steps: 17 | Train Loss: 0.025 Vali Loss: 3.449 Vali Acc: 0.769 Test Loss: 3.449 Test Acc: 0.769
Validation loss decreased (-0.751416 --> -0.768752).  Saving model ...
Epoch: 8 cost time: 4.741754531860352
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 3.965 Vali Acc: 0.763 Test Loss: 3.965 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.690502882003784
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 3.594 Vali Acc: 0.809 Test Loss: 3.594 Test Acc: 0.809
Validation loss decreased (-0.768752 --> -0.809213).  Saving model ...
Epoch: 10 cost time: 4.768329620361328
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.676 Vali Acc: 0.798 Test Loss: 3.676 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.720852375030518
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.682 Vali Acc: 0.798 Test Loss: 3.682 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.7310075759887695
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.616 Vali Acc: 0.798 Test Loss: 3.616 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.728159427642822
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.565 Vali Acc: 0.798 Test Loss: 3.565 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.720148086547852
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.547 Vali Acc: 0.798 Test Loss: 3.547 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.732348203659058
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.568 Vali Acc: 0.798 Test Loss: 3.568 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.706834316253662
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.592 Vali Acc: 0.798 Test Loss: 3.592 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.721153497695923
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.798 Test Loss: 3.637 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.730466604232788
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.570 Vali Acc: 0.798 Test Loss: 3.570 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.706622362136841
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.549 Vali Acc: 0.798 Test Loss: 3.549 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 393956391
model size : 1504.26MB
2025-04-28 07:35:56.750983: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:35:56.769868: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745825756.792563  751665 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745825756.799509  751665 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:35:56.822032: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.8470299243927
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.066 Vali Acc: 0.665 Test Loss: 1.066 Test Acc: 0.665
Validation loss decreased (inf --> -0.664729).  Saving model ...
Epoch: 2 cost time: 3.734321355819702
Epoch: 2, Steps: 17 | Train Loss: 0.464 Vali Loss: 2.187 Vali Acc: 0.728 Test Loss: 2.187 Test Acc: 0.728
Validation loss decreased (-0.664729 --> -0.728302).  Saving model ...
Epoch: 3 cost time: 3.618297815322876
Epoch: 3, Steps: 17 | Train Loss: 0.327 Vali Loss: 1.648 Vali Acc: 0.763 Test Loss: 1.648 Test Acc: 0.763
Validation loss decreased (-0.728302 --> -0.762989).  Saving model ...
Epoch: 4 cost time: 3.6513285636901855
Epoch: 4, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.059 Vali Acc: 0.723 Test Loss: 2.059 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.624662399291992
Epoch: 5, Steps: 17 | Train Loss: 0.083 Vali Loss: 4.106 Vali Acc: 0.642 Test Loss: 4.106 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5916860103607178
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.843 Vali Acc: 0.757 Test Loss: 1.843 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6052064895629883
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.541 Vali Acc: 0.769 Test Loss: 2.541 Test Acc: 0.769
Validation loss decreased (-0.762989 --> -0.768761).  Saving model ...
Epoch: 8 cost time: 3.6644561290740967
Epoch: 8, Steps: 17 | Train Loss: 0.155 Vali Loss: 3.921 Vali Acc: 0.723 Test Loss: 3.921 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.592693328857422
Epoch: 9, Steps: 17 | Train Loss: 0.110 Vali Loss: 5.136 Vali Acc: 0.682 Test Loss: 5.136 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5899033546447754
Epoch: 10, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.930 Vali Acc: 0.780 Test Loss: 2.930 Test Acc: 0.780
Validation loss decreased (-0.768761 --> -0.780318).  Saving model ...
Epoch: 11 cost time: 3.6542654037475586
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 5.175 Vali Acc: 0.688 Test Loss: 5.175 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6189732551574707
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 3.767 Vali Acc: 0.792 Test Loss: 3.767 Test Acc: 0.792
Validation loss decreased (-0.780318 --> -0.791870).  Saving model ...
Epoch: 13 cost time: 3.608949661254883
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 3.251 Vali Acc: 0.786 Test Loss: 3.251 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.5908570289611816
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.701 Vali Acc: 0.821 Test Loss: 2.701 Test Acc: 0.821
Validation loss decreased (-0.791870 --> -0.820782).  Saving model ...
Epoch: 15 cost time: 3.6007778644561768
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.379 Vali Acc: 0.734 Test Loss: 5.379 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5853843688964844
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.636 Vali Acc: 0.815 Test Loss: 2.636 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5638628005981445
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.135 Vali Acc: 0.809 Test Loss: 4.135 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.5727689266204834
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 3.998 Vali Acc: 0.740 Test Loss: 3.998 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.59427547454834
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 5.011 Vali Acc: 0.803 Test Loss: 5.011 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.5908679962158203
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 4.485 Vali Acc: 0.775 Test Loss: 4.485 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.583017587661743
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 8.047 Vali Acc: 0.775 Test Loss: 8.047 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.5865859985351562
Epoch: 22, Steps: 17 | Train Loss: 0.088 Vali Loss: 4.571 Vali Acc: 0.780 Test Loss: 4.571 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.563286304473877
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 6.552 Vali Acc: 0.740 Test Loss: 6.552 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.577859878540039
Epoch: 24, Steps: 17 | Train Loss: 0.174 Vali Loss: 6.990 Vali Acc: 0.769 Test Loss: 6.990 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 386190887
model size : 1474.64MB
2025-04-28 07:38:58.086195: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:38:58.105098: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745825938.127222  762686 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745825938.134098  762686 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:38:58.156783: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.518452882766724
Epoch: 1, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.007 Vali Acc: 0.630 Test Loss: 1.007 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 3.288602352142334
Epoch: 2, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.792 Vali Acc: 0.751 Test Loss: 0.792 Test Acc: 0.751
Validation loss decreased (-0.630048 --> -0.751437).  Saving model ...
Epoch: 3 cost time: 3.7269625663757324
Epoch: 3, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.871 Vali Acc: 0.711 Test Loss: 1.871 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.281782627105713
Epoch: 4, Steps: 17 | Train Loss: 0.234 Vali Loss: 1.544 Vali Acc: 0.769 Test Loss: 1.544 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768771).  Saving model ...
Epoch: 5 cost time: 3.2780110836029053
Epoch: 5, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.665 Vali Acc: 0.740 Test Loss: 1.665 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2546002864837646
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.296 Vali Acc: 0.827 Test Loss: 1.296 Test Acc: 0.827
Validation loss decreased (-0.768771 --> -0.826577).  Saving model ...
Epoch: 7 cost time: 3.7302329540252686
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.861 Vali Acc: 0.723 Test Loss: 1.861 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2690999507904053
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.173 Vali Acc: 0.792 Test Loss: 1.173 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2388782501220703
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.821 Test Loss: 0.935 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.279772996902466
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.832 Test Loss: 0.897 Test Acc: 0.832
Validation loss decreased (-0.826577 --> -0.832361).  Saving model ...
Epoch: 11 cost time: 3.287339448928833
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.838 Test Loss: 0.892 Test Acc: 0.838
Validation loss decreased (-0.832361 --> -0.838141).  Saving model ...
Epoch: 12 cost time: 3.2787818908691406
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.844 Test Loss: 0.888 Test Acc: 0.844
Validation loss decreased (-0.838141 --> -0.843922).  Saving model ...
Epoch: 13 cost time: 3.2957451343536377
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.838 Test Loss: 0.886 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.26700758934021
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.838 Test Loss: 0.889 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.255333185195923
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.844 Test Loss: 0.872 Test Acc: 0.844
Validation loss decreased (-0.843922 --> -0.843922).  Saving model ...
Epoch: 16 cost time: 3.3191027641296387
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.844 Test Loss: 0.861 Test Acc: 0.844
Validation loss decreased (-0.843922 --> -0.843922).  Saving model ...
Epoch: 17 cost time: 3.2879903316497803
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.844 Test Loss: 0.867 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.265758752822876
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.844 Test Loss: 0.853 Test Acc: 0.844
Validation loss decreased (-0.843922 --> -0.843922).  Saving model ...
Epoch: 19 cost time: 3.3345062732696533
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.858 Vali Acc: 0.844 Test Loss: 0.858 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.262207269668579
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.844 Test Loss: 0.864 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.2731683254241943
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.844 Test Loss: 0.860 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.295254945755005
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.844 Test Loss: 0.853 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.2738595008850098
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.844 Test Loss: 0.850 Test Acc: 0.844
Validation loss decreased (-0.843922 --> -0.843922).  Saving model ...
Epoch: 24 cost time: 3.3109965324401855
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.844 Test Loss: 0.848 Test Acc: 0.844
Validation loss decreased (-0.843922 --> -0.843922).  Saving model ...
Epoch: 25 cost time: 3.3402953147888184
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.838 Test Loss: 0.845 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.300870180130005
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.838 Test Loss: 0.847 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.2649126052856445
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.832 Test Loss: 0.841 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2788023948669434
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.832 Test Loss: 0.838 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.2953121662139893
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.832 Test Loss: 0.834 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.287306070327759
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.832 Test Loss: 0.824 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.284466028213501
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.832 Test Loss: 0.839 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.2925708293914795
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.832 Test Loss: 0.824 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.2907209396362305
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.832 Test Loss: 0.827 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.270418882369995
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.832 Test Loss: 0.821 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 383602439
model size : 1464.76MB
2025-04-28 07:43:04.886856: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:43:04.906580: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745826184.930973  778175 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745826184.938276  778175 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:43:04.962546: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.450267553329468
Epoch: 1, Steps: 17 | Train Loss: 1.399 Vali Loss: 0.896 Vali Acc: 0.682 Test Loss: 0.896 Test Acc: 0.682
Validation loss decreased (inf --> -0.682072).  Saving model ...
Epoch: 2 cost time: 3.2727761268615723
Epoch: 2, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.775 Vali Acc: 0.728 Test Loss: 0.775 Test Acc: 0.728
Validation loss decreased (-0.682072 --> -0.728316).  Saving model ...
Epoch: 3 cost time: 3.2948451042175293
Epoch: 3, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
Validation loss decreased (-0.728316 --> -0.867046).  Saving model ...
Epoch: 4 cost time: 3.721318483352661
Epoch: 4, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.528 Vali Acc: 0.682 Test Loss: 1.528 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2246768474578857
Epoch: 5, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.917 Vali Acc: 0.780 Test Loss: 0.917 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.213258743286133
Epoch: 6, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.504 Vali Acc: 0.798 Test Loss: 1.504 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.2422049045562744
Epoch: 7, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.969 Vali Acc: 0.751 Test Loss: 0.969 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.249586820602417
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.769 Test Loss: 1.134 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.218921661376953
Epoch: 9, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.864 Vali Acc: 0.798 Test Loss: 0.864 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2048726081848145
Epoch: 10, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.524 Vali Acc: 0.734 Test Loss: 1.524 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.20832896232605
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.719 Vali Acc: 0.792 Test Loss: 1.719 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.2355523109436035
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.830 Vali Acc: 0.844 Test Loss: 0.830 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.21947979927063
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 4.117 Vali Acc: 0.723 Test Loss: 4.117 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 382308295
model size : 1459.83MB
2025-04-28 07:44:44.027873: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:44:44.046713: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745826284.070212  784240 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745826284.077723  784240 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:44:44.101595: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.534198522567749
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 0.893 Vali Acc: 0.630 Test Loss: 0.893 Test Acc: 0.630
Validation loss decreased (inf --> -0.630049).  Saving model ...
Epoch: 2 cost time: 3.28861403465271
Epoch: 2, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.311 Vali Acc: 0.682 Test Loss: 1.311 Test Acc: 0.682
Validation loss decreased (-0.630049 --> -0.682068).  Saving model ...
Epoch: 3 cost time: 3.285757303237915
Epoch: 3, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.795 Vali Acc: 0.780 Test Loss: 0.795 Test Acc: 0.780
Validation loss decreased (-0.682068 --> -0.780339).  Saving model ...
Epoch: 4 cost time: 3.31767201423645
Epoch: 4, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.561 Vali Acc: 0.699 Test Loss: 1.561 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2884159088134766
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.652 Vali Acc: 0.699 Test Loss: 1.652 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2832164764404297
Epoch: 6, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.082 Vali Acc: 0.798 Test Loss: 1.082 Test Acc: 0.798
Validation loss decreased (-0.780339 --> -0.797677).  Saving model ...
Epoch: 7 cost time: 3.3304362297058105
Epoch: 7, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.136 Vali Acc: 0.780 Test Loss: 1.136 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.261366128921509
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.537 Vali Acc: 0.775 Test Loss: 1.537 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2876169681549072
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.444 Vali Acc: 0.757 Test Loss: 1.444 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.262223482131958
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.309 Vali Acc: 0.757 Test Loss: 1.309 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.2633562088012695
Epoch: 11, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.755 Vali Acc: 0.740 Test Loss: 1.755 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2462053298950195
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.878 Vali Acc: 0.734 Test Loss: 1.878 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.257565498352051
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.831 Vali Acc: 0.769 Test Loss: 1.831 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.2377021312713623
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.799 Vali Acc: 0.792 Test Loss: 1.799 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.2374608516693115
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 2.143 Vali Acc: 0.769 Test Loss: 2.143 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2563769817352295
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.351 Vali Acc: 0.798 Test Loss: 2.351 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 381445671
model size : 1456.54MB
2025-04-28 07:46:42.937257: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:46:42.955922: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745826402.978205  791641 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745826402.985138  791641 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:46:43.007858: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.22289514541626
Epoch: 1, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.280 Vali Acc: 0.491 Test Loss: 1.280 Test Acc: 0.491
Validation loss decreased (inf --> -0.491317).  Saving model ...
Epoch: 2 cost time: 2.9511830806732178
Epoch: 2, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.611 Vali Acc: 0.780 Test Loss: 0.611 Test Acc: 0.780
Validation loss decreased (-0.491317 --> -0.780341).  Saving model ...
Epoch: 3 cost time: 2.9398062229156494
Epoch: 3, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.850 Vali Acc: 0.740 Test Loss: 0.850 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.905230760574341
Epoch: 4, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
Validation loss decreased (-0.780341 --> -0.838145).  Saving model ...
Epoch: 5 cost time: 2.947960376739502
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.689 Vali Acc: 0.815 Test Loss: 0.689 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9178404808044434
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.025 Vali Acc: 0.798 Test Loss: 1.025 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8998000621795654
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.900 Vali Acc: 0.798 Test Loss: 0.900 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8972182273864746
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
Validation loss decreased (-0.838145 --> -0.867046).  Saving model ...
Epoch: 9 cost time: 2.9420266151428223
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.578 Vali Acc: 0.861 Test Loss: 0.578 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.909672737121582
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.867 Test Loss: 0.590 Test Acc: 0.867
Validation loss decreased (-0.867046 --> -0.867046).  Saving model ...
Epoch: 11 cost time: 2.9396579265594482
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.867 Test Loss: 0.593 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.913327217102051
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.855 Test Loss: 0.589 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9228577613830566
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9119131565093994
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.570 Vali Acc: 0.850 Test Loss: 0.570 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.899435520172119
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.938108205795288
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.832 Test Loss: 0.593 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9127933979034424
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.597 Vali Acc: 0.832 Test Loss: 0.597 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.911731243133545
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.832 Test Loss: 0.581 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8990941047668457
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.832 Test Loss: 0.579 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8935370445251465
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.832 Test Loss: 0.575 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 380583047
model size : 1453.25MB
2025-04-28 07:49:00.039685: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:49:00.058575: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745826540.081716  800799 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745826540.088933  800799 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:49:00.111844: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.257603883743286
Epoch: 1, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.032 Vali Acc: 0.526 Test Loss: 1.032 Test Acc: 0.526
Validation loss decreased (inf --> -0.526001).  Saving model ...
Epoch: 2 cost time: 3.0000414848327637
Epoch: 2, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.732 Vali Acc: 0.740 Test Loss: 0.732 Test Acc: 0.740
Validation loss decreased (-0.526001 --> -0.739877).  Saving model ...
Epoch: 3 cost time: 3.4473869800567627
Epoch: 3, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
Validation loss decreased (-0.739877 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 3.028050661087036
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.972 Vali Acc: 0.803 Test Loss: 0.972 Test Acc: 0.803
Validation loss decreased (-0.762999 --> -0.803458).  Saving model ...
Epoch: 5 cost time: 3.0139119625091553
Epoch: 5, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.147 Vali Acc: 0.757 Test Loss: 1.147 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0204265117645264
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.891 Vali Acc: 0.798 Test Loss: 0.891 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9895081520080566
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.624 Vali Acc: 0.769 Test Loss: 1.624 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.993511199951172
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.424 Vali Acc: 0.757 Test Loss: 1.424 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9719138145446777
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.770 Vali Acc: 0.832 Test Loss: 0.770 Test Acc: 0.832
Validation loss decreased (-0.803458 --> -0.832362).  Saving model ...
Epoch: 10 cost time: 3.047602415084839
Epoch: 10, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.132 Vali Acc: 0.769 Test Loss: 2.132 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0014467239379883
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.513 Vali Acc: 0.780 Test Loss: 1.513 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9982571601867676
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.314 Vali Acc: 0.763 Test Loss: 1.314 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.005980968475342
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.669 Vali Acc: 0.746 Test Loss: 1.669 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.98594331741333
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.780 Test Loss: 1.629 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.032402992248535
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.792 Test Loss: 1.643 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.0042169094085693
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.792 Test Loss: 1.580 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.9882750511169434
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.792 Test Loss: 1.562 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.004742383956909
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.792 Test Loss: 1.527 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.010507106781006
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.491 Vali Acc: 0.798 Test Loss: 1.491 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 380151847
model size : 1451.60MB
2025-04-28 07:51:10.662258: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:51:10.681047: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745826670.703881  809516 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745826670.710816  809516 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:51:10.733624: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 22.225879430770874
Epoch: 1, Steps: 34 | Train Loss: 10.500 Vali Loss: 17.636 Vali Acc: 0.428 Test Loss: 17.636 Test Acc: 0.428
Validation loss decreased (inf --> -0.427569).  Saving model ...
Epoch: 2 cost time: 21.016979455947876
Epoch: 2, Steps: 34 | Train Loss: 4.103 Vali Loss: 9.322 Vali Acc: 0.688 Test Loss: 9.322 Test Acc: 0.688
Validation loss decreased (-0.427569 --> -0.687768).  Saving model ...
Epoch: 3 cost time: 20.99660086631775
Epoch: 3, Steps: 34 | Train Loss: 3.285 Vali Loss: 9.959 Vali Acc: 0.723 Test Loss: 9.959 Test Acc: 0.723
Validation loss decreased (-0.687768 --> -0.722444).  Saving model ...
Epoch: 4 cost time: 21.042251586914062
Epoch: 4, Steps: 34 | Train Loss: 2.312 Vali Loss: 10.897 Vali Acc: 0.757 Test Loss: 10.897 Test Acc: 0.757
Validation loss decreased (-0.722444 --> -0.757116).  Saving model ...
Epoch: 5 cost time: 21.028140544891357
Epoch: 5, Steps: 34 | Train Loss: 0.673 Vali Loss: 10.951 Vali Acc: 0.746 Test Loss: 10.951 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.974265098571777
Epoch: 6, Steps: 34 | Train Loss: 1.405 Vali Loss: 16.210 Vali Acc: 0.734 Test Loss: 16.210 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.97203826904297
Epoch: 7, Steps: 34 | Train Loss: 3.342 Vali Loss: 33.056 Vali Acc: 0.653 Test Loss: 33.056 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.98292589187622
Epoch: 8, Steps: 34 | Train Loss: 5.311 Vali Loss: 23.057 Vali Acc: 0.694 Test Loss: 23.057 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 20.9681875705719
Epoch: 9, Steps: 34 | Train Loss: 2.744 Vali Loss: 71.332 Vali Acc: 0.676 Test Loss: 71.332 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 20.973912715911865
Epoch: 10, Steps: 34 | Train Loss: 5.131 Vali Loss: 64.570 Vali Acc: 0.711 Test Loss: 64.570 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 21.014655590057373
Epoch: 11, Steps: 34 | Train Loss: 1.471 Vali Loss: 49.836 Vali Acc: 0.763 Test Loss: 49.836 Test Acc: 0.763
Validation loss decreased (-0.757116 --> -0.762507).  Saving model ...
Epoch: 12 cost time: 21.030006170272827
Epoch: 12, Steps: 34 | Train Loss: 1.535 Vali Loss: 71.098 Vali Acc: 0.728 Test Loss: 71.098 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 20.968583822250366
Epoch: 13, Steps: 34 | Train Loss: 1.920 Vali Loss: 80.213 Vali Acc: 0.717 Test Loss: 80.213 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.962833166122437
Epoch: 14, Steps: 34 | Train Loss: 0.535 Vali Loss: 72.246 Vali Acc: 0.746 Test Loss: 72.246 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.96957302093506
Epoch: 15, Steps: 34 | Train Loss: 0.000 Vali Loss: 91.379 Vali Acc: 0.728 Test Loss: 91.379 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.993727684020996
Epoch: 16, Steps: 34 | Train Loss: 0.000 Vali Loss: 89.700 Vali Acc: 0.728 Test Loss: 89.700 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 20.965425968170166
Epoch: 17, Steps: 34 | Train Loss: 1.386 Vali Loss: 44.157 Vali Acc: 0.827 Test Loss: 44.157 Test Acc: 0.827
Validation loss decreased (-0.762507 --> -0.826148).  Saving model ...
Epoch: 18 cost time: 21.033516883850098
Epoch: 18, Steps: 34 | Train Loss: 2.778 Vali Loss: 250.083 Vali Acc: 0.665 Test Loss: 250.083 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 21.00268244743347
Epoch: 19, Steps: 34 | Train Loss: 21.417 Vali Loss: 127.879 Vali Acc: 0.763 Test Loss: 127.879 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 21.003804206848145
Epoch: 20, Steps: 34 | Train Loss: 33.244 Vali Loss: 164.018 Vali Acc: 0.723 Test Loss: 164.018 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 20.96703267097473
Epoch: 21, Steps: 34 | Train Loss: 12.724 Vali Loss: 120.029 Vali Acc: 0.723 Test Loss: 120.029 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 20.99293875694275
Epoch: 22, Steps: 34 | Train Loss: 5.993 Vali Loss: 209.516 Vali Acc: 0.705 Test Loss: 209.516 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 20.975698709487915
Epoch: 23, Steps: 34 | Train Loss: 20.288 Vali Loss: 404.920 Vali Acc: 0.642 Test Loss: 404.920 Test Acc: 0.642
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 20.96411681175232
Epoch: 24, Steps: 34 | Train Loss: 23.739 Vali Loss: 599.319 Vali Acc: 0.659 Test Loss: 599.319 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 20.992621660232544
Epoch: 25, Steps: 34 | Train Loss: 38.379 Vali Loss: 226.100 Vali Acc: 0.803 Test Loss: 226.100 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 21.024826049804688
Epoch: 26, Steps: 34 | Train Loss: 16.553 Vali Loss: 551.165 Vali Acc: 0.711 Test Loss: 551.165 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 20.974385499954224
Epoch: 27, Steps: 34 | Train Loss: 10.824 Vali Loss: 437.835 Vali Acc: 0.717 Test Loss: 437.835 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1811062407
model size : 6914.33MB
2025-04-28 07:51:42.752176: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 07:51:42.771676: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745826702.794899  809847 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745826702.802082  809847 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 07:51:42.825164: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.22951054573059
Epoch: 1, Steps: 17 | Train Loss: 3.536 Vali Loss: 2.416 Vali Acc: 0.653 Test Loss: 2.416 Test Acc: 0.653
Validation loss decreased (inf --> -0.653155).  Saving model ...
Epoch: 2 cost time: 10.992454290390015
Epoch: 2, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.637 Vali Acc: 0.688 Test Loss: 1.637 Test Acc: 0.688
Validation loss decreased (-0.653155 --> -0.687845).  Saving model ...
Epoch: 3 cost time: 10.97445034980774
Epoch: 3, Steps: 17 | Train Loss: 0.399 Vali Loss: 3.925 Vali Acc: 0.711 Test Loss: 3.925 Test Acc: 0.711
Validation loss decreased (-0.687845 --> -0.710943).  Saving model ...
Epoch: 4 cost time: 11.00114107131958
Epoch: 4, Steps: 17 | Train Loss: 0.220 Vali Loss: 4.743 Vali Acc: 0.676 Test Loss: 4.743 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.99263858795166
Epoch: 5, Steps: 17 | Train Loss: 0.223 Vali Loss: 4.357 Vali Acc: 0.734 Test Loss: 4.357 Test Acc: 0.734
Validation loss decreased (-0.710943 --> -0.734060).  Saving model ...
Epoch: 6 cost time: 10.991373538970947
Epoch: 6, Steps: 17 | Train Loss: 0.503 Vali Loss: 6.185 Vali Acc: 0.763 Test Loss: 6.185 Test Acc: 0.763
Validation loss decreased (-0.734060 --> -0.762944).  Saving model ...
Epoch: 7 cost time: 10.918211936950684
Epoch: 7, Steps: 17 | Train Loss: 0.503 Vali Loss: 10.303 Vali Acc: 0.740 Test Loss: 10.303 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.900499820709229
Epoch: 8, Steps: 17 | Train Loss: 0.524 Vali Loss: 8.796 Vali Acc: 0.717 Test Loss: 8.796 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.88804817199707
Epoch: 9, Steps: 17 | Train Loss: 0.300 Vali Loss: 12.903 Vali Acc: 0.653 Test Loss: 12.903 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.881747245788574
Epoch: 10, Steps: 17 | Train Loss: 0.733 Vali Loss: 11.640 Vali Acc: 0.717 Test Loss: 11.640 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.879623889923096
Epoch: 11, Steps: 17 | Train Loss: 0.801 Vali Loss: 7.594 Vali Acc: 0.792 Test Loss: 7.594 Test Acc: 0.792
Validation loss decreased (-0.762944 --> -0.791832).  Saving model ...
Epoch: 12 cost time: 10.907826662063599
Epoch: 12, Steps: 17 | Train Loss: 0.270 Vali Loss: 15.618 Vali Acc: 0.671 Test Loss: 15.618 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.879531383514404
Epoch: 13, Steps: 17 | Train Loss: 0.252 Vali Loss: 15.919 Vali Acc: 0.705 Test Loss: 15.919 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.889647960662842
Epoch: 14, Steps: 17 | Train Loss: 0.744 Vali Loss: 16.117 Vali Acc: 0.705 Test Loss: 16.117 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.897569179534912
Epoch: 15, Steps: 17 | Train Loss: 1.142 Vali Loss: 13.442 Vali Acc: 0.711 Test Loss: 13.442 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.898148775100708
Epoch: 16, Steps: 17 | Train Loss: 0.318 Vali Loss: 29.445 Vali Acc: 0.688 Test Loss: 29.445 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.890849113464355
Epoch: 17, Steps: 17 | Train Loss: 1.025 Vali Loss: 22.997 Vali Acc: 0.734 Test Loss: 22.997 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.887956142425537
Epoch: 18, Steps: 17 | Train Loss: 0.401 Vali Loss: 24.979 Vali Acc: 0.740 Test Loss: 24.979 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.89722728729248
Epoch: 19, Steps: 17 | Train Loss: 0.440 Vali Loss: 15.083 Vali Acc: 0.769 Test Loss: 15.083 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.908428192138672
Epoch: 20, Steps: 17 | Train Loss: 0.833 Vali Loss: 17.107 Vali Acc: 0.792 Test Loss: 17.107 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 10.877619743347168
Epoch: 21, Steps: 17 | Train Loss: 1.041 Vali Loss: 15.526 Vali Acc: 0.798 Test Loss: 15.526 Test Acc: 0.798
Validation loss decreased (-0.791832 --> -0.797533).  Saving model ...
Epoch: 22 cost time: 10.95414113998413
Epoch: 22, Steps: 17 | Train Loss: 0.184 Vali Loss: 19.886 Vali Acc: 0.786 Test Loss: 19.886 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 10.925654649734497
Epoch: 23, Steps: 17 | Train Loss: 0.128 Vali Loss: 14.187 Vali Acc: 0.832 Test Loss: 14.187 Test Acc: 0.832
Validation loss decreased (-0.797533 --> -0.832228).  Saving model ...
Epoch: 24 cost time: 10.960203409194946
Epoch: 24, Steps: 17 | Train Loss: 0.169 Vali Loss: 35.408 Vali Acc: 0.757 Test Loss: 35.408 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 10.955977201461792
Epoch: 25, Steps: 17 | Train Loss: 0.976 Vali Loss: 25.844 Vali Acc: 0.803 Test Loss: 25.844 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 10.951277494430542
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 29.770 Vali Acc: 0.769 Test Loss: 29.770 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 10.954574823379517
Epoch: 27, Steps: 17 | Train Loss: 0.061 Vali Loss: 33.985 Vali Acc: 0.798 Test Loss: 33.985 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 10.967577695846558
Epoch: 28, Steps: 17 | Train Loss: 0.926 Vali Loss: 38.329 Vali Acc: 0.711 Test Loss: 38.329 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 10.927602291107178
Epoch: 29, Steps: 17 | Train Loss: 1.790 Vali Loss: 31.993 Vali Acc: 0.798 Test Loss: 31.993 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 10.926600694656372
Epoch: 30, Steps: 17 | Train Loss: 2.148 Vali Loss: 32.383 Vali Acc: 0.815 Test Loss: 32.383 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 10.914223670959473
Epoch: 31, Steps: 17 | Train Loss: 4.691 Vali Loss: 67.936 Vali Acc: 0.763 Test Loss: 67.936 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 10.971208095550537
Epoch: 32, Steps: 17 | Train Loss: 2.699 Vali Loss: 152.467 Vali Acc: 0.694 Test Loss: 152.467 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 10.985131978988647
Epoch: 33, Steps: 17 | Train Loss: 5.635 Vali Loss: 96.817 Vali Acc: 0.769 Test Loss: 96.817 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1780000391
model size : 6795.83MB
2025-04-28 08:03:29.592921: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:03:29.612002: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745827409.635316  826799 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745827409.642629  826799 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:03:29.666162: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 12.10547423362732
Epoch: 1, Steps: 17 | Train Loss: 2.130 Vali Loss: 1.781 Vali Acc: 0.653 Test Loss: 1.781 Test Acc: 0.653
Validation loss decreased (inf --> -0.653161).  Saving model ...
Epoch: 2 cost time: 10.820136547088623
Epoch: 2, Steps: 17 | Train Loss: 0.908 Vali Loss: 3.301 Vali Acc: 0.653 Test Loss: 3.301 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.794621229171753
Epoch: 3, Steps: 17 | Train Loss: 0.225 Vali Loss: 1.347 Vali Acc: 0.798 Test Loss: 1.347 Test Acc: 0.798
Validation loss decreased (-0.653161 --> -0.797674).  Saving model ...
Epoch: 4 cost time: 10.840417385101318
Epoch: 4, Steps: 17 | Train Loss: 0.217 Vali Loss: 2.204 Vali Acc: 0.769 Test Loss: 2.204 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.827251434326172
Epoch: 5, Steps: 17 | Train Loss: 0.079 Vali Loss: 2.150 Vali Acc: 0.763 Test Loss: 2.150 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.819729566574097
Epoch: 6, Steps: 17 | Train Loss: 0.231 Vali Loss: 4.203 Vali Acc: 0.717 Test Loss: 4.203 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.808353900909424
Epoch: 7, Steps: 17 | Train Loss: 0.294 Vali Loss: 1.816 Vali Acc: 0.844 Test Loss: 1.816 Test Acc: 0.844
Validation loss decreased (-0.797674 --> -0.843912).  Saving model ...
Epoch: 8 cost time: 10.812367677688599
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 4.971 Vali Acc: 0.740 Test Loss: 4.971 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.813485145568848
Epoch: 9, Steps: 17 | Train Loss: 0.213 Vali Loss: 11.135 Vali Acc: 0.676 Test Loss: 11.135 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.81545901298523
Epoch: 10, Steps: 17 | Train Loss: 0.691 Vali Loss: 15.703 Vali Acc: 0.630 Test Loss: 15.703 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.796152353286743
Epoch: 11, Steps: 17 | Train Loss: 1.569 Vali Loss: 10.834 Vali Acc: 0.711 Test Loss: 10.834 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 10.758108854293823
Epoch: 12, Steps: 17 | Train Loss: 0.974 Vali Loss: 7.914 Vali Acc: 0.775 Test Loss: 7.914 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 10.756515979766846
Epoch: 13, Steps: 17 | Train Loss: 0.315 Vali Loss: 10.334 Vali Acc: 0.751 Test Loss: 10.334 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 10.752440452575684
Epoch: 14, Steps: 17 | Train Loss: 0.380 Vali Loss: 19.224 Vali Acc: 0.775 Test Loss: 19.224 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 10.76550030708313
Epoch: 15, Steps: 17 | Train Loss: 1.296 Vali Loss: 9.292 Vali Acc: 0.821 Test Loss: 9.292 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 10.761733055114746
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 9.185 Vali Acc: 0.740 Test Loss: 9.185 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 10.744242668151855
Epoch: 17, Steps: 17 | Train Loss: 1.540 Vali Loss: 14.076 Vali Acc: 0.763 Test Loss: 14.076 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1769646599
model size : 6756.34MB
2025-04-28 08:09:36.262632: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:09:36.281459: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745827776.304334  835640 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745827776.311285  835640 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:09:36.334437: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.469939231872559
Epoch: 1, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.364 Vali Acc: 0.705 Test Loss: 1.364 Test Acc: 0.705
Validation loss decreased (inf --> -0.705189).  Saving model ...
Epoch: 2 cost time: 10.263870239257812
Epoch: 2, Steps: 17 | Train Loss: 0.559 Vali Loss: 1.453 Vali Acc: 0.717 Test Loss: 1.453 Test Acc: 0.717
Validation loss decreased (-0.705189 --> -0.716748).  Saving model ...
Epoch: 3 cost time: 10.273447751998901
Epoch: 3, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.940 Vali Acc: 0.827 Test Loss: 0.940 Test Acc: 0.827
Validation loss decreased (-0.716748 --> -0.826580).  Saving model ...
Epoch: 4 cost time: 10.272303819656372
Epoch: 4, Steps: 17 | Train Loss: 0.258 Vali Loss: 2.045 Vali Acc: 0.763 Test Loss: 2.045 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.246910333633423
Epoch: 5, Steps: 17 | Train Loss: 0.117 Vali Loss: 2.020 Vali Acc: 0.746 Test Loss: 2.020 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.253133773803711
Epoch: 6, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.869 Vali Acc: 0.792 Test Loss: 1.869 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.264530420303345
Epoch: 7, Steps: 17 | Train Loss: 0.109 Vali Loss: 3.532 Vali Acc: 0.780 Test Loss: 3.532 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.299825191497803
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 2.815 Vali Acc: 0.786 Test Loss: 2.815 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 10.287632942199707
Epoch: 9, Steps: 17 | Train Loss: 0.230 Vali Loss: 5.918 Vali Acc: 0.728 Test Loss: 5.918 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 10.277733325958252
Epoch: 10, Steps: 17 | Train Loss: 0.640 Vali Loss: 8.988 Vali Acc: 0.595 Test Loss: 8.988 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 10.273243188858032
Epoch: 11, Steps: 17 | Train Loss: 0.225 Vali Loss: 16.529 Vali Acc: 0.751 Test Loss: 16.529 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 10.286346912384033
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 6.601 Vali Acc: 0.786 Test Loss: 6.601 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 10.290455341339111
Epoch: 13, Steps: 17 | Train Loss: 0.139 Vali Loss: 11.896 Vali Acc: 0.769 Test Loss: 11.896 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1764470023
model size : 6736.59MB
2025-04-28 08:14:24.651783: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:14:24.670686: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745828064.693242  842477 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745828064.700392  842477 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:14:24.723647: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 11.192716598510742
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 1.566 Vali Acc: 0.601 Test Loss: 1.566 Test Acc: 0.601
Validation loss decreased (inf --> -0.601140).  Saving model ...
Epoch: 2 cost time: 10.00047492980957
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 3.499 Vali Acc: 0.630 Test Loss: 3.499 Test Acc: 0.630
Validation loss decreased (-0.601140 --> -0.630023).  Saving model ...
Epoch: 3 cost time: 10.019665956497192
Epoch: 3, Steps: 17 | Train Loss: 0.273 Vali Loss: 2.500 Vali Acc: 0.682 Test Loss: 2.500 Test Acc: 0.682
Validation loss decreased (-0.630023 --> -0.682056).  Saving model ...
Epoch: 4 cost time: 9.99449610710144
Epoch: 4, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.881 Vali Acc: 0.694 Test Loss: 1.881 Test Acc: 0.694
Validation loss decreased (-0.682056 --> -0.693623).  Saving model ...
Epoch: 5 cost time: 9.984696865081787
Epoch: 5, Steps: 17 | Train Loss: 0.140 Vali Loss: 2.831 Vali Acc: 0.763 Test Loss: 2.831 Test Acc: 0.763
Validation loss decreased (-0.693623 --> -0.762977).  Saving model ...
Epoch: 6 cost time: 10.008466005325317
Epoch: 6, Steps: 17 | Train Loss: 0.143 Vali Loss: 5.369 Vali Acc: 0.769 Test Loss: 5.369 Test Acc: 0.769
Validation loss decreased (-0.762977 --> -0.768732).  Saving model ...
Epoch: 7 cost time: 10.0369713306427
Epoch: 7, Steps: 17 | Train Loss: 0.666 Vali Loss: 2.125 Vali Acc: 0.809 Test Loss: 2.125 Test Acc: 0.809
Validation loss decreased (-0.768732 --> -0.809227).  Saving model ...
Epoch: 8 cost time: 9.994407176971436
Epoch: 8, Steps: 17 | Train Loss: 0.267 Vali Loss: 3.108 Vali Acc: 0.780 Test Loss: 3.108 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.966143608093262
Epoch: 9, Steps: 17 | Train Loss: 0.057 Vali Loss: 5.754 Vali Acc: 0.751 Test Loss: 5.754 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.932837724685669
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 7.996 Vali Acc: 0.728 Test Loss: 7.996 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.969741106033325
Epoch: 11, Steps: 17 | Train Loss: 0.816 Vali Loss: 8.223 Vali Acc: 0.746 Test Loss: 8.223 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.96666145324707
Epoch: 12, Steps: 17 | Train Loss: 0.353 Vali Loss: 7.865 Vali Acc: 0.699 Test Loss: 7.865 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.9541654586792
Epoch: 13, Steps: 17 | Train Loss: 0.310 Vali Loss: 6.260 Vali Acc: 0.711 Test Loss: 6.260 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.943677186965942
Epoch: 14, Steps: 17 | Train Loss: 0.710 Vali Loss: 4.499 Vali Acc: 0.792 Test Loss: 4.499 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.910641193389893
Epoch: 15, Steps: 17 | Train Loss: 0.390 Vali Loss: 11.739 Vali Acc: 0.653 Test Loss: 11.739 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.913779020309448
Epoch: 16, Steps: 17 | Train Loss: 0.323 Vali Loss: 5.922 Vali Acc: 0.803 Test Loss: 5.922 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.913885354995728
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 11.459 Vali Acc: 0.717 Test Loss: 11.459 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1761019527
model size : 6723.43MB
2025-04-28 08:21:24.815701: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:21:24.834650: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745828484.857292  851588 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745828484.864249  851588 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:21:24.887072: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.759870290756226
Epoch: 1, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.488 Vali Acc: 0.572 Test Loss: 1.488 Test Acc: 0.572
Validation loss decreased (inf --> -0.572239).  Saving model ...
Epoch: 2 cost time: 9.506334066390991
Epoch: 2, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.005 Vali Acc: 0.613 Test Loss: 2.005 Test Acc: 0.613
Validation loss decreased (-0.572239 --> -0.612697).  Saving model ...
Epoch: 3 cost time: 9.539064407348633
Epoch: 3, Steps: 17 | Train Loss: 0.612 Vali Loss: 1.546 Vali Acc: 0.780 Test Loss: 1.546 Test Acc: 0.780
Validation loss decreased (-0.612697 --> -0.780331).  Saving model ...
Epoch: 4 cost time: 9.535839557647705
Epoch: 4, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.292 Vali Acc: 0.792 Test Loss: 1.292 Test Acc: 0.792
Validation loss decreased (-0.780331 --> -0.791895).  Saving model ...
Epoch: 5 cost time: 9.516275644302368
Epoch: 5, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.521 Vali Acc: 0.803 Test Loss: 1.521 Test Acc: 0.803
Validation loss decreased (-0.791895 --> -0.803453).  Saving model ...
Epoch: 6 cost time: 9.525332689285278
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.392 Vali Acc: 0.769 Test Loss: 1.392 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.48261833190918
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.520 Vali Acc: 0.798 Test Loss: 2.520 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.493842363357544
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 3.700 Vali Acc: 0.763 Test Loss: 3.700 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.515459060668945
Epoch: 9, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.658 Vali Acc: 0.803 Test Loss: 2.658 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.540057182312012
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.544 Vali Acc: 0.832 Test Loss: 2.544 Test Acc: 0.832
Validation loss decreased (-0.803453 --> -0.832345).  Saving model ...
Epoch: 11 cost time: 9.584130764007568
Epoch: 11, Steps: 17 | Train Loss: 0.275 Vali Loss: 3.125 Vali Acc: 0.740 Test Loss: 3.125 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.534822702407837
Epoch: 12, Steps: 17 | Train Loss: 0.297 Vali Loss: 2.951 Vali Acc: 0.844 Test Loss: 2.951 Test Acc: 0.844
Validation loss decreased (-0.832345 --> -0.843901).  Saving model ...
Epoch: 13 cost time: 9.583239555358887
Epoch: 13, Steps: 17 | Train Loss: 0.771 Vali Loss: 10.410 Vali Acc: 0.630 Test Loss: 10.410 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.517504692077637
Epoch: 14, Steps: 17 | Train Loss: 1.131 Vali Loss: 4.372 Vali Acc: 0.827 Test Loss: 4.372 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.518779754638672
Epoch: 15, Steps: 17 | Train Loss: 0.280 Vali Loss: 6.152 Vali Acc: 0.711 Test Loss: 6.152 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.525060176849365
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 6.366 Vali Acc: 0.803 Test Loss: 6.366 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.525969505310059
Epoch: 17, Steps: 17 | Train Loss: 0.203 Vali Loss: 10.094 Vali Acc: 0.798 Test Loss: 10.094 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.53046989440918
Epoch: 18, Steps: 17 | Train Loss: 1.086 Vali Loss: 11.113 Vali Acc: 0.728 Test Loss: 11.113 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.526347160339355
Epoch: 19, Steps: 17 | Train Loss: 0.311 Vali Loss: 10.437 Vali Acc: 0.786 Test Loss: 10.437 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.520835399627686
Epoch: 20, Steps: 17 | Train Loss: 0.716 Vali Loss: 9.296 Vali Acc: 0.809 Test Loss: 9.296 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.522403955459595
Epoch: 21, Steps: 17 | Train Loss: 0.146 Vali Loss: 5.225 Vali Acc: 0.861 Test Loss: 5.225 Test Acc: 0.861
Validation loss decreased (-0.843901 --> -0.861219).  Saving model ...
Epoch: 22 cost time: 9.554004907608032
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.715 Vali Acc: 0.832 Test Loss: 6.715 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.521824598312378
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 6.642 Vali Acc: 0.844 Test Loss: 6.642 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.525221347808838
Epoch: 24, Steps: 17 | Train Loss: 0.569 Vali Loss: 15.048 Vali Acc: 0.827 Test Loss: 15.048 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 9.513283014297485
Epoch: 25, Steps: 17 | Train Loss: 0.598 Vali Loss: 13.050 Vali Acc: 0.815 Test Loss: 13.050 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.52692699432373
Epoch: 26, Steps: 17 | Train Loss: 0.429 Vali Loss: 15.215 Vali Acc: 0.821 Test Loss: 15.215 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.536871433258057
Epoch: 27, Steps: 17 | Train Loss: 1.232 Vali Loss: 16.287 Vali Acc: 0.803 Test Loss: 16.287 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 9.517521619796753
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 9.978 Vali Acc: 0.855 Test Loss: 9.978 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.540181875228882
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 9.924 Vali Acc: 0.855 Test Loss: 9.924 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.546649932861328
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 10.194 Vali Acc: 0.838 Test Loss: 10.194 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 9.54924726486206
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 10.372 Vali Acc: 0.827 Test Loss: 10.372 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1757569031
model size : 6710.27MB
2025-04-28 08:31:40.349884: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:31:40.368333: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745829100.390271  867440 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745829100.397104  867440 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:31:40.419660: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.507734060287476
Epoch: 1, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.349 Vali Acc: 0.578 Test Loss: 1.349 Test Acc: 0.578
Validation loss decreased (inf --> -0.578021).  Saving model ...
Epoch: 2 cost time: 9.326611757278442
Epoch: 2, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.583 Vali Acc: 0.665 Test Loss: 1.583 Test Acc: 0.665
Validation loss decreased (-0.578021 --> -0.664724).  Saving model ...
Epoch: 3 cost time: 9.303323030471802
Epoch: 3, Steps: 17 | Train Loss: 0.262 Vali Loss: 2.436 Vali Acc: 0.676 Test Loss: 2.436 Test Acc: 0.676
Validation loss decreased (-0.664724 --> -0.676276).  Saving model ...
Epoch: 4 cost time: 9.325178384780884
Epoch: 4, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.135 Vali Acc: 0.763 Test Loss: 1.135 Test Acc: 0.763
Validation loss decreased (-0.676276 --> -0.762994).  Saving model ...
Epoch: 5 cost time: 9.297861814498901
Epoch: 5, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.758 Vali Acc: 0.751 Test Loss: 2.758 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.270723581314087
Epoch: 6, Steps: 17 | Train Loss: 0.298 Vali Loss: 2.658 Vali Acc: 0.699 Test Loss: 2.658 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.267595767974854
Epoch: 7, Steps: 17 | Train Loss: 0.112 Vali Loss: 3.038 Vali Acc: 0.728 Test Loss: 3.038 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.270504236221313
Epoch: 8, Steps: 17 | Train Loss: 0.294 Vali Loss: 3.798 Vali Acc: 0.728 Test Loss: 3.798 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.277246475219727
Epoch: 9, Steps: 17 | Train Loss: 0.303 Vali Loss: 3.679 Vali Acc: 0.723 Test Loss: 3.679 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.266138792037964
Epoch: 10, Steps: 17 | Train Loss: 0.207 Vali Loss: 4.317 Vali Acc: 0.780 Test Loss: 4.317 Test Acc: 0.780
Validation loss decreased (-0.762994 --> -0.780304).  Saving model ...
Epoch: 11 cost time: 9.302766561508179
Epoch: 11, Steps: 17 | Train Loss: 0.290 Vali Loss: 4.345 Vali Acc: 0.803 Test Loss: 4.345 Test Acc: 0.803
Validation loss decreased (-0.780304 --> -0.803425).  Saving model ...
Epoch: 12 cost time: 9.334844589233398
Epoch: 12, Steps: 17 | Train Loss: 0.164 Vali Loss: 4.545 Vali Acc: 0.809 Test Loss: 4.545 Test Acc: 0.809
Validation loss decreased (-0.803425 --> -0.809203).  Saving model ...
Epoch: 13 cost time: 9.356063842773438
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 4.646 Vali Acc: 0.809 Test Loss: 4.646 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.346761226654053
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 4.527 Vali Acc: 0.827 Test Loss: 4.527 Test Acc: 0.827
Validation loss decreased (-0.809203 --> -0.826544).  Saving model ...
Epoch: 15 cost time: 9.342020750045776
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 2.739 Vali Acc: 0.809 Test Loss: 2.739 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.316473007202148
Epoch: 16, Steps: 17 | Train Loss: 0.024 Vali Loss: 5.930 Vali Acc: 0.832 Test Loss: 5.930 Test Acc: 0.832
Validation loss decreased (-0.826544 --> -0.832311).  Saving model ...
Epoch: 17 cost time: 9.400744915008545
Epoch: 17, Steps: 17 | Train Loss: 0.186 Vali Loss: 5.961 Vali Acc: 0.838 Test Loss: 5.961 Test Acc: 0.838
Validation loss decreased (-0.832311 --> -0.838091).  Saving model ...
Epoch: 18 cost time: 9.317330121994019
Epoch: 18, Steps: 17 | Train Loss: 0.613 Vali Loss: 6.384 Vali Acc: 0.763 Test Loss: 6.384 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.322387218475342
Epoch: 19, Steps: 17 | Train Loss: 0.426 Vali Loss: 9.778 Vali Acc: 0.757 Test Loss: 9.778 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.304939031600952
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 9.742 Vali Acc: 0.838 Test Loss: 9.742 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.321380853652954
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 12.095 Vali Acc: 0.734 Test Loss: 12.095 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.320994138717651
Epoch: 22, Steps: 17 | Train Loss: 0.326 Vali Loss: 14.205 Vali Acc: 0.642 Test Loss: 14.205 Test Acc: 0.642
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.319676876068115
Epoch: 23, Steps: 17 | Train Loss: 0.143 Vali Loss: 16.510 Vali Acc: 0.775 Test Loss: 16.510 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.320281267166138
Epoch: 24, Steps: 17 | Train Loss: 0.150 Vali Loss: 9.657 Vali Acc: 0.809 Test Loss: 9.657 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.288357973098755
Epoch: 25, Steps: 17 | Train Loss: 0.403 Vali Loss: 11.715 Vali Acc: 0.769 Test Loss: 11.715 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.332905292510986
Epoch: 26, Steps: 17 | Train Loss: 2.141 Vali Loss: 16.443 Vali Acc: 0.786 Test Loss: 16.443 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.349714279174805
Epoch: 27, Steps: 17 | Train Loss: 1.165 Vali Loss: 22.842 Vali Acc: 0.699 Test Loss: 22.842 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1755844231
model size : 6703.69MB
2025-04-28 08:41:39.800648: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:41:39.821609: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745829699.845762  881566 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745829699.853169  881566 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:41:39.877924: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.878032445907593
Epoch: 1, Steps: 17 | Train Loss: 2.971 Vali Loss: 5.358 Vali Acc: 0.526 Test Loss: 5.358 Test Acc: 0.526
Validation loss decreased (inf --> -0.525958).  Saving model ...
Epoch: 2 cost time: 7.720399618148804
Epoch: 2, Steps: 17 | Train Loss: 2.312 Vali Loss: 3.210 Vali Acc: 0.653 Test Loss: 3.210 Test Acc: 0.653
Validation loss decreased (-0.525958 --> -0.653147).  Saving model ...
Epoch: 3 cost time: 7.733666658401489
Epoch: 3, Steps: 17 | Train Loss: 1.553 Vali Loss: 5.945 Vali Acc: 0.688 Test Loss: 5.945 Test Acc: 0.688
Validation loss decreased (-0.653147 --> -0.687802).  Saving model ...
Epoch: 4 cost time: 7.7376580238342285
Epoch: 4, Steps: 17 | Train Loss: 0.643 Vali Loss: 2.468 Vali Acc: 0.775 Test Loss: 2.468 Test Acc: 0.775
Validation loss decreased (-0.687802 --> -0.774542).  Saving model ...
Epoch: 5 cost time: 7.741490125656128
Epoch: 5, Steps: 17 | Train Loss: 0.142 Vali Loss: 6.035 Vali Acc: 0.699 Test Loss: 6.035 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.712948560714722
Epoch: 6, Steps: 17 | Train Loss: 0.195 Vali Loss: 3.234 Vali Acc: 0.815 Test Loss: 3.234 Test Acc: 0.815
Validation loss decreased (-0.774542 --> -0.814997).  Saving model ...
Epoch: 7 cost time: 7.74934458732605
Epoch: 7, Steps: 17 | Train Loss: 0.114 Vali Loss: 4.114 Vali Acc: 0.705 Test Loss: 4.114 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.65340781211853
Epoch: 8, Steps: 17 | Train Loss: 0.114 Vali Loss: 3.951 Vali Acc: 0.728 Test Loss: 3.951 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.663819313049316
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 7.197 Vali Acc: 0.728 Test Loss: 7.197 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.67188024520874
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 9.529 Vali Acc: 0.688 Test Loss: 9.529 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.680737495422363
Epoch: 11, Steps: 17 | Train Loss: 0.630 Vali Loss: 6.897 Vali Acc: 0.757 Test Loss: 6.897 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.6565375328063965
Epoch: 12, Steps: 17 | Train Loss: 0.554 Vali Loss: 6.730 Vali Acc: 0.728 Test Loss: 6.730 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 7.66088080406189
Epoch: 13, Steps: 17 | Train Loss: 0.219 Vali Loss: 8.023 Vali Acc: 0.705 Test Loss: 8.023 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.666782855987549
Epoch: 14, Steps: 17 | Train Loss: 0.891 Vali Loss: 9.673 Vali Acc: 0.728 Test Loss: 9.673 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 7.674856185913086
Epoch: 15, Steps: 17 | Train Loss: 0.469 Vali Loss: 4.796 Vali Acc: 0.815 Test Loss: 4.796 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 7.657527685165405
Epoch: 16, Steps: 17 | Train Loss: 0.462 Vali Loss: 10.032 Vali Acc: 0.798 Test Loss: 10.032 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 826625863
model size : 3156.18MB
2025-04-28 08:45:50.199877: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:45:50.219871: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745829950.243435  889518 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745829950.250629  889518 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:45:50.274782: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.5578343868255615
Epoch: 1, Steps: 17 | Train Loss: 2.134 Vali Loss: 2.052 Vali Acc: 0.566 Test Loss: 2.052 Test Acc: 0.566
Validation loss decreased (inf --> -0.566453).  Saving model ...
Epoch: 2 cost time: 6.4213526248931885
Epoch: 2, Steps: 17 | Train Loss: 0.618 Vali Loss: 1.604 Vali Acc: 0.734 Test Loss: 1.604 Test Acc: 0.734
Validation loss decreased (-0.566453 --> -0.734088).  Saving model ...
Epoch: 3 cost time: 6.418163776397705
Epoch: 3, Steps: 17 | Train Loss: 0.584 Vali Loss: 3.811 Vali Acc: 0.659 Test Loss: 3.811 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.366971969604492
Epoch: 4, Steps: 17 | Train Loss: 0.318 Vali Loss: 2.135 Vali Acc: 0.740 Test Loss: 2.135 Test Acc: 0.740
Validation loss decreased (-0.734088 --> -0.739863).  Saving model ...
Epoch: 5 cost time: 6.406535387039185
Epoch: 5, Steps: 17 | Train Loss: 0.047 Vali Loss: 3.941 Vali Acc: 0.740 Test Loss: 3.941 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.363379240036011
Epoch: 6, Steps: 17 | Train Loss: 0.129 Vali Loss: 3.885 Vali Acc: 0.699 Test Loss: 3.885 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.3685221672058105
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 6.935 Vali Acc: 0.676 Test Loss: 6.935 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.389686346054077
Epoch: 8, Steps: 17 | Train Loss: 0.464 Vali Loss: 4.815 Vali Acc: 0.711 Test Loss: 4.815 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.410189151763916
Epoch: 9, Steps: 17 | Train Loss: 0.144 Vali Loss: 7.451 Vali Acc: 0.682 Test Loss: 7.451 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.403135538101196
Epoch: 10, Steps: 17 | Train Loss: 0.261 Vali Loss: 7.600 Vali Acc: 0.636 Test Loss: 7.600 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.391942024230957
Epoch: 11, Steps: 17 | Train Loss: 0.182 Vali Loss: 4.225 Vali Acc: 0.780 Test Loss: 4.225 Test Acc: 0.780
Validation loss decreased (-0.739863 --> -0.780305).  Saving model ...
Epoch: 12 cost time: 6.460216283798218
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 8.936 Vali Acc: 0.740 Test Loss: 8.936 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.396949291229248
Epoch: 13, Steps: 17 | Train Loss: 0.149 Vali Loss: 5.910 Vali Acc: 0.717 Test Loss: 5.910 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.403134822845459
Epoch: 14, Steps: 17 | Train Loss: 0.038 Vali Loss: 7.464 Vali Acc: 0.786 Test Loss: 7.464 Test Acc: 0.786
Validation loss decreased (-0.780305 --> -0.786053).  Saving model ...
Epoch: 15 cost time: 6.43634295463562
Epoch: 15, Steps: 17 | Train Loss: 0.283 Vali Loss: 10.317 Vali Acc: 0.757 Test Loss: 10.317 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.389254331588745
Epoch: 16, Steps: 17 | Train Loss: 0.180 Vali Loss: 8.378 Vali Acc: 0.734 Test Loss: 8.378 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.388874530792236
Epoch: 17, Steps: 17 | Train Loss: 0.341 Vali Loss: 18.318 Vali Acc: 0.694 Test Loss: 18.318 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.3704400062561035
Epoch: 18, Steps: 17 | Train Loss: 1.083 Vali Loss: 9.166 Vali Acc: 0.780 Test Loss: 9.166 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.391391754150391
Epoch: 19, Steps: 17 | Train Loss: 0.250 Vali Loss: 16.697 Vali Acc: 0.705 Test Loss: 16.697 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.404452562332153
Epoch: 20, Steps: 17 | Train Loss: 0.053 Vali Loss: 10.782 Vali Acc: 0.803 Test Loss: 10.782 Test Acc: 0.803
Validation loss decreased (-0.786053 --> -0.803360).  Saving model ...
Epoch: 21 cost time: 6.422654390335083
Epoch: 21, Steps: 17 | Train Loss: 0.340 Vali Loss: 13.865 Vali Acc: 0.723 Test Loss: 13.865 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.3999927043914795
Epoch: 22, Steps: 17 | Train Loss: 0.181 Vali Loss: 14.216 Vali Acc: 0.728 Test Loss: 14.216 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.363478899002075
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 16.425 Vali Acc: 0.746 Test Loss: 16.425 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.364452600479126
Epoch: 24, Steps: 17 | Train Loss: 0.672 Vali Loss: 8.288 Vali Acc: 0.792 Test Loss: 8.288 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.361054420471191
Epoch: 25, Steps: 17 | Train Loss: 0.664 Vali Loss: 12.717 Vali Acc: 0.763 Test Loss: 12.717 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.354893922805786
Epoch: 26, Steps: 17 | Train Loss: 0.099 Vali Loss: 11.952 Vali Acc: 0.775 Test Loss: 11.952 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.3513171672821045
Epoch: 27, Steps: 17 | Train Loss: 0.191 Vali Loss: 13.864 Vali Acc: 0.751 Test Loss: 13.864 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.366264581680298
Epoch: 28, Steps: 17 | Train Loss: 0.193 Vali Loss: 22.635 Vali Acc: 0.653 Test Loss: 22.635 Test Acc: 0.653
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 6.343411922454834
Epoch: 29, Steps: 17 | Train Loss: 0.056 Vali Loss: 27.594 Vali Acc: 0.728 Test Loss: 27.594 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.358769655227661
Epoch: 30, Steps: 17 | Train Loss: 0.600 Vali Loss: 48.908 Vali Acc: 0.659 Test Loss: 48.908 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 811094855
model size : 3096.93MB
2025-04-28 08:51:44.870206: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:51:44.889462: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745830304.912585  903765 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745830304.919873  903765 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:51:44.943201: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.903677463531494
Epoch: 1, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.247 Vali Acc: 0.671 Test Loss: 1.247 Test Acc: 0.671
Validation loss decreased (inf --> -0.670508).  Saving model ...
Epoch: 2 cost time: 5.773991107940674
Epoch: 2, Steps: 17 | Train Loss: 0.443 Vali Loss: 1.565 Vali Acc: 0.699 Test Loss: 1.565 Test Acc: 0.699
Validation loss decreased (-0.670508 --> -0.699406).  Saving model ...
Epoch: 3 cost time: 5.725324392318726
Epoch: 3, Steps: 17 | Train Loss: 0.176 Vali Loss: 4.032 Vali Acc: 0.682 Test Loss: 4.032 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.696439266204834
Epoch: 4, Steps: 17 | Train Loss: 0.427 Vali Loss: 1.465 Vali Acc: 0.821 Test Loss: 1.465 Test Acc: 0.821
Validation loss decreased (-0.699406 --> -0.820795).  Saving model ...
Epoch: 5 cost time: 5.760133981704712
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.251 Vali Acc: 0.821 Test Loss: 1.251 Test Acc: 0.821
Validation loss decreased (-0.820795 --> -0.820797).  Saving model ...
Epoch: 6 cost time: 5.722681283950806
Epoch: 6, Steps: 17 | Train Loss: 0.197 Vali Loss: 2.930 Vali Acc: 0.763 Test Loss: 2.930 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.674969911575317
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 2.372 Vali Acc: 0.769 Test Loss: 2.372 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.676573038101196
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 3.951 Vali Acc: 0.740 Test Loss: 3.951 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.698241472244263
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.989 Vali Acc: 0.775 Test Loss: 1.989 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.735397100448608
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 3.022 Vali Acc: 0.786 Test Loss: 3.022 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.679701566696167
Epoch: 11, Steps: 17 | Train Loss: 0.117 Vali Loss: 4.853 Vali Acc: 0.769 Test Loss: 4.853 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.682711362838745
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.354 Vali Acc: 0.751 Test Loss: 3.354 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.696216583251953
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 5.691 Vali Acc: 0.763 Test Loss: 5.691 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.698811054229736
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 5.382 Vali Acc: 0.763 Test Loss: 5.382 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.673330545425415
Epoch: 15, Steps: 17 | Train Loss: 0.204 Vali Loss: 11.272 Vali Acc: 0.734 Test Loss: 11.272 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 805917959
model size : 3077.18MB
2025-04-28 08:54:49.225509: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:54:49.244813: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745830489.268297  911012 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745830489.275469  911012 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:54:49.299250: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.695922136306763
Epoch: 1, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.321 Vali Acc: 0.572 Test Loss: 1.321 Test Acc: 0.572
Validation loss decreased (inf --> -0.572241).  Saving model ...
Epoch: 2 cost time: 5.497680425643921
Epoch: 2, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.823 Vali Acc: 0.728 Test Loss: 0.823 Test Acc: 0.728
Validation loss decreased (-0.572241 --> -0.728315).  Saving model ...
Epoch: 3 cost time: 5.4860193729400635
Epoch: 3, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.296 Vali Acc: 0.769 Test Loss: 1.296 Test Acc: 0.769
Validation loss decreased (-0.728315 --> -0.768773).  Saving model ...
Epoch: 4 cost time: 5.47184419631958
Epoch: 4, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.449 Vali Acc: 0.780 Test Loss: 1.449 Test Acc: 0.780
Validation loss decreased (-0.768773 --> -0.780332).  Saving model ...
Epoch: 5 cost time: 5.518183946609497
Epoch: 5, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.697 Vali Acc: 0.792 Test Loss: 1.697 Test Acc: 0.792
Validation loss decreased (-0.780332 --> -0.791891).  Saving model ...
Epoch: 6 cost time: 5.50425124168396
Epoch: 6, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.381 Vali Acc: 0.699 Test Loss: 2.381 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.488085508346558
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.674 Vali Acc: 0.792 Test Loss: 1.674 Test Acc: 0.792
Validation loss decreased (-0.791891 --> -0.791891).  Saving model ...
Epoch: 8 cost time: 5.51273250579834
Epoch: 8, Steps: 17 | Train Loss: 0.184 Vali Loss: 3.521 Vali Acc: 0.751 Test Loss: 3.521 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.4692206382751465
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.874 Vali Acc: 0.780 Test Loss: 1.874 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.472461938858032
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.742 Vali Acc: 0.775 Test Loss: 2.742 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.4531238079071045
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.606 Vali Acc: 0.775 Test Loss: 2.606 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.474372386932373
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.524 Vali Acc: 0.780 Test Loss: 2.524 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.451368093490601
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.513 Vali Acc: 0.780 Test Loss: 2.513 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.462786674499512
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.516 Vali Acc: 0.780 Test Loss: 2.516 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.503255367279053
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.500 Vali Acc: 0.780 Test Loss: 2.500 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.474330902099609
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.491 Vali Acc: 0.780 Test Loss: 2.491 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.474992275238037
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.540 Vali Acc: 0.792 Test Loss: 2.540 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 803329671
model size : 3067.31MB
2025-04-28 08:58:21.553541: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 08:58:21.572862: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745830701.595719  919221 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745830701.602605  919221 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 08:58:21.625685: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.718893766403198
Epoch: 1, Steps: 17 | Train Loss: 1.525 Vali Loss: 0.968 Vali Acc: 0.676 Test Loss: 0.968 Test Acc: 0.676
Validation loss decreased (inf --> -0.676291).  Saving model ...
Epoch: 2 cost time: 5.552508115768433
Epoch: 2, Steps: 17 | Train Loss: 0.319 Vali Loss: 1.124 Vali Acc: 0.769 Test Loss: 1.124 Test Acc: 0.769
Validation loss decreased (-0.676291 --> -0.768775).  Saving model ...
Epoch: 3 cost time: 5.528833389282227
Epoch: 3, Steps: 17 | Train Loss: 0.199 Vali Loss: 1.449 Vali Acc: 0.740 Test Loss: 1.449 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.505274772644043
Epoch: 4, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.731 Vali Acc: 0.763 Test Loss: 1.731 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.496468782424927
Epoch: 5, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.929 Vali Acc: 0.751 Test Loss: 1.929 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.500500679016113
Epoch: 6, Steps: 17 | Train Loss: 0.194 Vali Loss: 1.452 Vali Acc: 0.775 Test Loss: 1.452 Test Acc: 0.775
Validation loss decreased (-0.768775 --> -0.774552).  Saving model ...
Epoch: 7 cost time: 5.517245531082153
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 2.063 Vali Acc: 0.757 Test Loss: 2.063 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.492376327514648
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 2.075 Vali Acc: 0.751 Test Loss: 2.075 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.508101463317871
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 3.852 Vali Acc: 0.746 Test Loss: 3.852 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.497922897338867
Epoch: 10, Steps: 17 | Train Loss: 0.287 Vali Loss: 2.043 Vali Acc: 0.798 Test Loss: 2.043 Test Acc: 0.798
Validation loss decreased (-0.774552 --> -0.797667).  Saving model ...
Epoch: 11 cost time: 5.516679048538208
Epoch: 11, Steps: 17 | Train Loss: 0.234 Vali Loss: 4.636 Vali Acc: 0.676 Test Loss: 4.636 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.480773448944092
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 3.412 Vali Acc: 0.763 Test Loss: 3.412 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.488593578338623
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 5.115 Vali Acc: 0.705 Test Loss: 5.115 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.508866786956787
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 3.984 Vali Acc: 0.746 Test Loss: 3.984 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.516467332839966
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 3.073 Vali Acc: 0.763 Test Loss: 3.073 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.5045695304870605
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.981 Vali Acc: 0.838 Test Loss: 2.981 Test Acc: 0.838
Validation loss decreased (-0.797667 --> -0.838120).  Saving model ...
Epoch: 17 cost time: 5.521704912185669
Epoch: 17, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.792 Vali Acc: 0.803 Test Loss: 2.792 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.493427038192749
Epoch: 18, Steps: 17 | Train Loss: 0.303 Vali Loss: 2.818 Vali Acc: 0.821 Test Loss: 2.818 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.484053611755371
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.042 Vali Acc: 0.798 Test Loss: 3.042 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.493540287017822
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.746 Vali Acc: 0.798 Test Loss: 3.746 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.480656147003174
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.715 Vali Acc: 0.798 Test Loss: 3.715 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.493355751037598
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.636 Vali Acc: 0.798 Test Loss: 3.636 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.487295866012573
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.497 Vali Acc: 0.803 Test Loss: 3.497 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.468998432159424
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.348 Vali Acc: 0.803 Test Loss: 3.348 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.471908092498779
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.420 Vali Acc: 0.803 Test Loss: 3.420 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.470940351486206
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.476 Vali Acc: 0.803 Test Loss: 3.476 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 801604423
model size : 3060.73MB
2025-04-28 09:03:05.740522: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:03:05.759590: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745830985.783220  931502 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745830985.790128  931502 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:03:05.813202: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.363619089126587
Epoch: 1, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.204 Vali Acc: 0.595 Test Loss: 1.204 Test Acc: 0.595
Validation loss decreased (inf --> -0.595364).  Saving model ...
Epoch: 2 cost time: 5.223709583282471
Epoch: 2, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.766 Vali Acc: 0.792 Test Loss: 0.766 Test Acc: 0.792
Validation loss decreased (-0.595364 --> -0.791900).  Saving model ...
Epoch: 3 cost time: 5.191137313842773
Epoch: 3, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.694 Vali Acc: 0.827 Test Loss: 0.694 Test Acc: 0.827
Validation loss decreased (-0.791900 --> -0.826583).  Saving model ...
Epoch: 4 cost time: 5.18896484375
Epoch: 4, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.550 Vali Acc: 0.723 Test Loss: 1.550 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.173778533935547
Epoch: 5, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.659 Vali Acc: 0.751 Test Loss: 1.659 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.184198379516602
Epoch: 6, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.509 Vali Acc: 0.763 Test Loss: 1.509 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.177491903305054
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.088 Vali Acc: 0.792 Test Loss: 1.088 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.19128680229187
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.868 Vali Acc: 0.786 Test Loss: 1.868 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.187791109085083
Epoch: 9, Steps: 17 | Train Loss: 0.117 Vali Loss: 2.191 Vali Acc: 0.780 Test Loss: 2.191 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.173903942108154
Epoch: 10, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.009 Vali Acc: 0.769 Test Loss: 2.009 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.1875269412994385
Epoch: 11, Steps: 17 | Train Loss: 0.161 Vali Loss: 1.500 Vali Acc: 0.832 Test Loss: 1.500 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832355).  Saving model ...
Epoch: 12 cost time: 5.211735725402832
Epoch: 12, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.505 Vali Acc: 0.763 Test Loss: 2.505 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.187622308731079
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.916 Vali Acc: 0.809 Test Loss: 1.916 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.172417640686035
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 3.874 Vali Acc: 0.699 Test Loss: 3.874 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.191590785980225
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.859 Vali Acc: 0.786 Test Loss: 1.859 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.199898719787598
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 4.995 Vali Acc: 0.694 Test Loss: 4.995 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.183249235153198
Epoch: 17, Steps: 17 | Train Loss: 0.195 Vali Loss: 4.774 Vali Acc: 0.734 Test Loss: 4.774 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.186421632766724
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 6.293 Vali Acc: 0.659 Test Loss: 6.293 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.197410583496094
Epoch: 19, Steps: 17 | Train Loss: 0.089 Vali Loss: 5.226 Vali Acc: 0.705 Test Loss: 5.226 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.173877716064453
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 4.504 Vali Acc: 0.763 Test Loss: 4.504 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.172428607940674
Epoch: 21, Steps: 17 | Train Loss: 0.154 Vali Loss: 7.562 Vali Acc: 0.746 Test Loss: 7.562 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 799879175
model size : 3054.15MB
2025-04-28 09:06:47.287843: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:06:47.307061: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745831207.329734  941431 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745831207.336679  941431 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:06:47.359884: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.408631324768066
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.351 Vali Acc: 0.630 Test Loss: 1.351 Test Acc: 0.630
Validation loss decreased (inf --> -0.630044).  Saving model ...
Epoch: 2 cost time: 5.110857248306274
Epoch: 2, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.591 Vali Acc: 0.832 Test Loss: 0.591 Test Acc: 0.832
Validation loss decreased (-0.630044 --> -0.832364).  Saving model ...
Epoch: 3 cost time: 5.154595136642456
Epoch: 3, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.095 Vali Acc: 0.751 Test Loss: 1.095 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.118749141693115
Epoch: 4, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.158 Vali Acc: 0.751 Test Loss: 1.158 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.119487762451172
Epoch: 5, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.451 Vali Acc: 0.769 Test Loss: 1.451 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.099581480026245
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.859 Vali Acc: 0.809 Test Loss: 0.859 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.129565954208374
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.635 Vali Acc: 0.746 Test Loss: 1.635 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.079928398132324
Epoch: 8, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.805 Vali Acc: 0.780 Test Loss: 1.805 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.091465950012207
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.943 Vali Acc: 0.809 Test Loss: 0.943 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.0989649295806885
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.226 Vali Acc: 0.751 Test Loss: 2.226 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.0841569900512695
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 2.341 Vali Acc: 0.769 Test Loss: 2.341 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.088055610656738
Epoch: 12, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.872 Vali Acc: 0.803 Test Loss: 1.872 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 799016775
model size : 3050.86MB
2025-04-28 09:09:07.259909: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:09:07.279088: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745831347.301519  947243 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745831347.308454  947243 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:09:07.331391: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.873847723007202
Epoch: 1, Steps: 17 | Train Loss: 1.910 Vali Loss: 2.768 Vali Acc: 0.578 Test Loss: 2.768 Test Acc: 0.578
Validation loss decreased (inf --> -0.578007).  Saving model ...
Epoch: 2 cost time: 4.712597846984863
Epoch: 2, Steps: 17 | Train Loss: 0.990 Vali Loss: 3.838 Vali Acc: 0.647 Test Loss: 3.838 Test Acc: 0.647
Validation loss decreased (-0.578007 --> -0.647360).  Saving model ...
Epoch: 3 cost time: 4.719879150390625
Epoch: 3, Steps: 17 | Train Loss: 1.055 Vali Loss: 4.280 Vali Acc: 0.723 Test Loss: 4.280 Test Acc: 0.723
Validation loss decreased (-0.647360 --> -0.722501).  Saving model ...
Epoch: 4 cost time: 4.722970724105835
Epoch: 4, Steps: 17 | Train Loss: 0.456 Vali Loss: 3.838 Vali Acc: 0.676 Test Loss: 3.838 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.66513729095459
Epoch: 5, Steps: 17 | Train Loss: 0.463 Vali Loss: 4.518 Vali Acc: 0.751 Test Loss: 4.518 Test Acc: 0.751
Validation loss decreased (-0.722501 --> -0.751400).  Saving model ...
Epoch: 6 cost time: 4.701097249984741
Epoch: 6, Steps: 17 | Train Loss: 0.057 Vali Loss: 2.571 Vali Acc: 0.798 Test Loss: 2.571 Test Acc: 0.798
Validation loss decreased (-0.751400 --> -0.797662).  Saving model ...
Epoch: 7 cost time: 4.695807218551636
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 3.563 Vali Acc: 0.723 Test Loss: 3.563 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.670841693878174
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 4.396 Vali Acc: 0.676 Test Loss: 4.396 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.685223579406738
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.691 Vali Acc: 0.717 Test Loss: 3.691 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.686828374862671
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 5.233 Vali Acc: 0.659 Test Loss: 5.233 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.691056728363037
Epoch: 11, Steps: 17 | Train Loss: 0.098 Vali Loss: 3.647 Vali Acc: 0.723 Test Loss: 3.647 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.660626411437988
Epoch: 12, Steps: 17 | Train Loss: 0.337 Vali Loss: 6.778 Vali Acc: 0.682 Test Loss: 6.778 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.6680588722229
Epoch: 13, Steps: 17 | Train Loss: 0.268 Vali Loss: 5.734 Vali Acc: 0.746 Test Loss: 5.734 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.672386407852173
Epoch: 14, Steps: 17 | Train Loss: 0.123 Vali Loss: 6.745 Vali Acc: 0.676 Test Loss: 6.745 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.677031517028809
Epoch: 15, Steps: 17 | Train Loss: 0.315 Vali Loss: 10.305 Vali Acc: 0.699 Test Loss: 10.305 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.661906957626343
Epoch: 16, Steps: 17 | Train Loss: 0.178 Vali Loss: 7.704 Vali Acc: 0.699 Test Loss: 7.704 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 393586599
model size : 1502.85MB
2025-04-28 09:11:40.783989: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:11:40.803698: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745831500.827106  954784 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745831500.834216  954784 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:11:40.857181: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.795281887054443
Epoch: 1, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.440 Vali Acc: 0.538 Test Loss: 1.440 Test Acc: 0.538
Validation loss decreased (inf --> -0.537558).  Saving model ...
Epoch: 2 cost time: 3.588948965072632
Epoch: 2, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.666 Vali Acc: 0.763 Test Loss: 1.666 Test Acc: 0.763
Validation loss decreased (-0.537558 --> -0.762989).  Saving model ...
Epoch: 3 cost time: 3.72369384765625
Epoch: 3, Steps: 17 | Train Loss: 0.462 Vali Loss: 1.354 Vali Acc: 0.746 Test Loss: 1.354 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.544330596923828
Epoch: 4, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.537 Vali Acc: 0.740 Test Loss: 1.537 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.542933464050293
Epoch: 5, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.635 Vali Acc: 0.775 Test Loss: 1.635 Test Acc: 0.775
Validation loss decreased (-0.762989 --> -0.774550).  Saving model ...
Epoch: 6 cost time: 3.576742172241211
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.508 Vali Acc: 0.803 Test Loss: 1.508 Test Acc: 0.803
Validation loss decreased (-0.774550 --> -0.803453).  Saving model ...
Epoch: 7 cost time: 3.584351062774658
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.702 Vali Acc: 0.775 Test Loss: 2.702 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.544327974319458
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 2.284 Vali Acc: 0.798 Test Loss: 2.284 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5384161472320557
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.718 Vali Acc: 0.827 Test Loss: 1.718 Test Acc: 0.827
Validation loss decreased (-0.803453 --> -0.826572).  Saving model ...
Epoch: 10 cost time: 3.568326473236084
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.809 Test Loss: 1.167 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.542444944381714
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.798 Test Loss: 1.107 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.55918550491333
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.803 Test Loss: 1.071 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5446417331695557
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.803 Test Loss: 1.051 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.5681114196777344
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.803 Test Loss: 1.051 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.552664041519165
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.803 Test Loss: 1.048 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.5720229148864746
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.803 Test Loss: 1.039 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5546178817749023
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.809 Test Loss: 1.046 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.567183256149292
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.809 Test Loss: 1.046 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5225813388824463
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.809 Test Loss: 1.035 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 385821095
model size : 1473.23MB
2025-04-28 09:14:04.498872: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:14:04.518017: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745831644.540921  963553 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745831644.548209  963553 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:14:04.571421: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.422784805297852
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 0.879 Vali Acc: 0.699 Test Loss: 0.879 Test Acc: 0.699
Validation loss decreased (inf --> -0.699413).  Saving model ...
Epoch: 2 cost time: 3.248060464859009
Epoch: 2, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.508 Vali Acc: 0.780 Test Loss: 0.508 Test Acc: 0.780
Validation loss decreased (-0.699413 --> -0.780342).  Saving model ...
Epoch: 3 cost time: 3.26936411857605
Epoch: 3, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.474 Vali Acc: 0.740 Test Loss: 1.474 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.218496561050415
Epoch: 4, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.352 Vali Acc: 0.763 Test Loss: 1.352 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.206599712371826
Epoch: 5, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.813 Vali Acc: 0.682 Test Loss: 1.813 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2181739807128906
Epoch: 6, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.178 Vali Acc: 0.723 Test Loss: 1.178 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.224290609359741
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 2.377 Vali Acc: 0.671 Test Loss: 2.377 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.206346273422241
Epoch: 8, Steps: 17 | Train Loss: 0.072 Vali Loss: 2.213 Vali Acc: 0.769 Test Loss: 2.213 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2386062145233154
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.668 Vali Acc: 0.757 Test Loss: 1.668 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.231879472732544
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 2.098 Vali Acc: 0.717 Test Loss: 2.098 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.2264864444732666
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.679 Vali Acc: 0.740 Test Loss: 1.679 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.219752073287964
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.893 Vali Acc: 0.780 Test Loss: 1.893 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 383232647
model size : 1463.35MB
2025-04-28 09:15:35.265423: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:15:35.284609: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745831735.307478  969156 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745831735.314449  969156 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:15:35.337755: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.389644622802734
Epoch: 1, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.154 Vali Acc: 0.555 Test Loss: 1.154 Test Acc: 0.555
Validation loss decreased (inf --> -0.554902).  Saving model ...
Epoch: 2 cost time: 3.7090978622436523
Epoch: 2, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.542 Vali Acc: 0.827 Test Loss: 0.542 Test Acc: 0.827
Validation loss decreased (-0.554902 --> -0.826584).  Saving model ...
Epoch: 3 cost time: 3.2269198894500732
Epoch: 3, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.737 Vali Acc: 0.746 Test Loss: 0.737 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.180180549621582
Epoch: 4, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.725 Vali Acc: 0.775 Test Loss: 1.725 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.190196990966797
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.124 Vali Acc: 0.780 Test Loss: 1.124 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.2022714614868164
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.385 Vali Acc: 0.780 Test Loss: 1.385 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.1928482055664062
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.471 Vali Acc: 0.786 Test Loss: 1.471 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.199294090270996
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.503 Vali Acc: 0.723 Test Loss: 1.503 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.201457977294922
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.728 Test Loss: 1.732 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1797778606414795
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.371 Vali Acc: 0.780 Test Loss: 1.371 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1765897274017334
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.998 Vali Acc: 0.780 Test Loss: 0.998 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1781249046325684
Epoch: 12, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.399 Vali Acc: 0.763 Test Loss: 1.399 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 381938503
model size : 1458.42MB
2025-04-28 09:17:05.428203: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:17:05.447341: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745831825.470000  974766 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745831825.477140  974766 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:17:05.500404: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.431002855300903
Epoch: 1, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.132 Vali Acc: 0.526 Test Loss: 1.132 Test Acc: 0.526
Validation loss decreased (inf --> -0.526000).  Saving model ...
Epoch: 2 cost time: 3.190932273864746
Epoch: 2, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
Validation loss decreased (-0.526000 --> -0.751439).  Saving model ...
Epoch: 3 cost time: 3.2030553817749023
Epoch: 3, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.995 Vali Acc: 0.786 Test Loss: 0.995 Test Acc: 0.786
Validation loss decreased (-0.751439 --> -0.786117).  Saving model ...
Epoch: 4 cost time: 3.241140127182007
Epoch: 4, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.302 Vali Acc: 0.717 Test Loss: 1.302 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.230053663253784
Epoch: 5, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.778 Vali Acc: 0.694 Test Loss: 1.778 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2193331718444824
Epoch: 6, Steps: 17 | Train Loss: 0.208 Vali Loss: 1.809 Vali Acc: 0.769 Test Loss: 1.809 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.23531174659729
Epoch: 7, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.952 Vali Acc: 0.780 Test Loss: 0.952 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.234421491622925
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.914 Vali Acc: 0.786 Test Loss: 1.914 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2364675998687744
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.453 Vali Acc: 0.798 Test Loss: 1.453 Test Acc: 0.798
Validation loss decreased (-0.786117 --> -0.797673).  Saving model ...
Epoch: 10 cost time: 3.288774013519287
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.734 Vali Acc: 0.775 Test Loss: 1.734 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2295894622802734
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.534 Vali Acc: 0.792 Test Loss: 1.534 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.234889030456543
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.792 Test Loss: 1.592 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.2414777278900146
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.528 Vali Acc: 0.798 Test Loss: 1.528 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.249323844909668
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.480 Vali Acc: 0.792 Test Loss: 1.480 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2361562252044678
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.798 Test Loss: 1.463 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.247267723083496
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.474 Vali Acc: 0.809 Test Loss: 1.474 Test Acc: 0.809
Validation loss decreased (-0.797673 --> -0.809234).  Saving model ...
Epoch: 17 cost time: 3.248547077178955
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.438 Vali Acc: 0.809 Test Loss: 1.438 Test Acc: 0.809
Validation loss decreased (-0.809234 --> -0.809234).  Saving model ...
Epoch: 18 cost time: 3.2521846294403076
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.809 Test Loss: 1.427 Test Acc: 0.809
Validation loss decreased (-0.809234 --> -0.809234).  Saving model ...
Epoch: 19 cost time: 3.2777695655822754
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.434 Vali Acc: 0.809 Test Loss: 1.434 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2297372817993164
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.425 Vali Acc: 0.809 Test Loss: 1.425 Test Acc: 0.809
Validation loss decreased (-0.809234 --> -0.809234).  Saving model ...
Epoch: 21 cost time: 3.279026508331299
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.809 Test Loss: 1.406 Test Acc: 0.809
Validation loss decreased (-0.809234 --> -0.809234).  Saving model ...
Epoch: 22 cost time: 3.2795238494873047
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.809 Test Loss: 1.398 Test Acc: 0.809
Validation loss decreased (-0.809234 --> -0.809235).  Saving model ...
Epoch: 23 cost time: 3.2471389770507812
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.809 Test Loss: 1.415 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2472658157348633
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.424 Vali Acc: 0.809 Test Loss: 1.424 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.234492301940918
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.809 Test Loss: 1.384 Test Acc: 0.809
Validation loss decreased (-0.809235 --> -0.809235).  Saving model ...
Epoch: 26 cost time: 3.2998809814453125
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.405 Vali Acc: 0.809 Test Loss: 1.405 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.232905626296997
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.809 Test Loss: 1.408 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.237880229949951
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.407 Vali Acc: 0.809 Test Loss: 1.407 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.2192564010620117
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.798 Test Loss: 1.400 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.232938051223755
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.400 Vali Acc: 0.803 Test Loss: 1.400 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.233673334121704
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.393 Vali Acc: 0.803 Test Loss: 1.393 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.2286157608032227
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.803 Test Loss: 1.391 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.262922525405884
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.391 Vali Acc: 0.798 Test Loss: 1.391 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.229477643966675
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.412 Vali Acc: 0.803 Test Loss: 1.412 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.2440497875213623
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.803 Test Loss: 1.404 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 381075879
model size : 1455.13MB
2025-04-28 09:21:06.059170: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:21:06.079913: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745832066.104022  990647 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745832066.111176  990647 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:21:06.134539: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.278257131576538
Epoch: 1, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.300 Vali Acc: 0.405 Test Loss: 1.300 Test Acc: 0.405
Validation loss decreased (inf --> -0.404611).  Saving model ...
Epoch: 2 cost time: 3.076476573944092
Epoch: 2, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
Validation loss decreased (-0.404611 --> -0.762999).  Saving model ...
Epoch: 3 cost time: 3.1066341400146484
Epoch: 3, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.643 Vali Acc: 0.821 Test Loss: 0.643 Test Acc: 0.821
Validation loss decreased (-0.762999 --> -0.820803).  Saving model ...
Epoch: 4 cost time: 3.0843608379364014
Epoch: 4, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.113 Vali Acc: 0.717 Test Loss: 1.113 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.040475368499756
Epoch: 5, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.952 Vali Acc: 0.769 Test Loss: 0.952 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.049459457397461
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.975 Vali Acc: 0.780 Test Loss: 0.975 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.070650815963745
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.359 Vali Acc: 0.780 Test Loss: 1.359 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0610315799713135
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.140 Vali Acc: 0.815 Test Loss: 1.140 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0550856590270996
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0427441596984863
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.330 Vali Acc: 0.780 Test Loss: 1.330 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.046652317047119
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.769 Test Loss: 1.288 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.055391550064087
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.130 Vali Acc: 0.792 Test Loss: 1.130 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.063920497894287
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.780 Test Loss: 1.087 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 380213255
model size : 1451.83MB
2025-04-28 09:22:40.629565: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:22:40.648914: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745832160.671458  996695 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745832160.678639  996695 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:22:40.702614: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.243395805358887
Epoch: 1, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
Validation loss decreased (inf --> -0.514440).  Saving model ...
Epoch: 2 cost time: 3.0058798789978027
Epoch: 2, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.655 Vali Acc: 0.763 Test Loss: 0.655 Test Acc: 0.763
Validation loss decreased (-0.514440 --> -0.762999).  Saving model ...
Epoch: 3 cost time: 2.9877662658691406
Epoch: 3, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.793 Vali Acc: 0.734 Test Loss: 0.793 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.978537082672119
Epoch: 4, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
Validation loss decreased (-0.762999 --> -0.809242).  Saving model ...
Epoch: 5 cost time: 2.9918437004089355
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.769 Test Loss: 0.645 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9639339447021484
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.286 Vali Acc: 0.769 Test Loss: 1.286 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9511430263519287
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.939 Vali Acc: 0.780 Test Loss: 0.939 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9520082473754883
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.780 Test Loss: 0.761 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9431312084198
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.780 Test Loss: 0.690 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9463906288146973
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.780 Test Loss: 0.680 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.967212677001953
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.775 Test Loss: 0.675 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9880712032318115
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.780 Test Loss: 0.680 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.971552610397339
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.780 Test Loss: 0.682 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.960442543029785
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.780 Test Loss: 0.686 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 379782055
model size : 1450.19MB
2025-04-28 09:24:19.325773: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:24:19.344736: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745832259.367613 1003169 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745832259.374653 1003169 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:24:19.397553: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 16.90499472618103
Epoch: 1, Steps: 34 | Train Loss: 59.683 Vali Loss: 64.765 Vali Acc: 0.561 Test Loss: 64.765 Test Acc: 0.561
Validation loss decreased (inf --> -0.560046).  Saving model ...
Epoch: 2 cost time: 15.753251791000366
Epoch: 2, Steps: 34 | Train Loss: 58.626 Vali Loss: 80.181 Vali Acc: 0.676 Test Loss: 80.181 Test Acc: 0.676
Validation loss decreased (-0.560046 --> -0.675499).  Saving model ...
Epoch: 3 cost time: 15.774831295013428
Epoch: 3, Steps: 34 | Train Loss: 24.049 Vali Loss: 18.310 Vali Acc: 0.780 Test Loss: 18.310 Test Acc: 0.780
Validation loss decreased (-0.675499 --> -0.780164).  Saving model ...
Epoch: 4 cost time: 15.788859605789185
Epoch: 4, Steps: 34 | Train Loss: 6.182 Vali Loss: 89.818 Vali Acc: 0.647 Test Loss: 89.818 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.72402310371399
Epoch: 5, Steps: 34 | Train Loss: 9.301 Vali Loss: 39.414 Vali Acc: 0.676 Test Loss: 39.414 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.721644401550293
Epoch: 6, Steps: 34 | Train Loss: 7.232 Vali Loss: 31.346 Vali Acc: 0.711 Test Loss: 31.346 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.734105587005615
Epoch: 7, Steps: 34 | Train Loss: 5.320 Vali Loss: 54.486 Vali Acc: 0.757 Test Loss: 54.486 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.760374784469604
Epoch: 8, Steps: 34 | Train Loss: 9.337 Vali Loss: 78.809 Vali Acc: 0.630 Test Loss: 78.809 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.73491907119751
Epoch: 9, Steps: 34 | Train Loss: 18.838 Vali Loss: 63.532 Vali Acc: 0.775 Test Loss: 63.532 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 15.738916873931885
Epoch: 10, Steps: 34 | Train Loss: 34.510 Vali Loss: 57.424 Vali Acc: 0.769 Test Loss: 57.424 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 15.720073699951172
Epoch: 11, Steps: 34 | Train Loss: 6.987 Vali Loss: 208.906 Vali Acc: 0.688 Test Loss: 208.906 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 15.723692178726196
Epoch: 12, Steps: 34 | Train Loss: 27.336 Vali Loss: 290.196 Vali Acc: 0.642 Test Loss: 290.196 Test Acc: 0.642
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 15.744580030441284
Epoch: 13, Steps: 34 | Train Loss: 49.844 Vali Loss: 113.541 Vali Acc: 0.757 Test Loss: 113.541 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 1333225735
model size : 5089.63MB
2025-04-28 09:24:47.014775: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:24:47.033706: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745832287.056046 1003482 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745832287.063053 1003482 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:24:47.088244: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 9.4323251247406
Epoch: 1, Steps: 17 | Train Loss: 16.886 Vali Loss: 21.757 Vali Acc: 0.555 Test Loss: 21.757 Test Acc: 0.555
Validation loss decreased (inf --> -0.554696).  Saving model ...
Epoch: 2 cost time: 8.359362125396729
Epoch: 2, Steps: 17 | Train Loss: 12.665 Vali Loss: 34.711 Vali Acc: 0.688 Test Loss: 34.711 Test Acc: 0.688
Validation loss decreased (-0.554696 --> -0.687514).  Saving model ...
Epoch: 3 cost time: 8.349681615829468
Epoch: 3, Steps: 17 | Train Loss: 5.538 Vali Loss: 25.907 Vali Acc: 0.740 Test Loss: 25.907 Test Acc: 0.740
Validation loss decreased (-0.687514 --> -0.739625).  Saving model ...
Epoch: 4 cost time: 8.369866847991943
Epoch: 4, Steps: 17 | Train Loss: 11.188 Vali Loss: 36.905 Vali Acc: 0.676 Test Loss: 36.905 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.349597930908203
Epoch: 5, Steps: 17 | Train Loss: 13.453 Vali Loss: 36.078 Vali Acc: 0.630 Test Loss: 36.078 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.330818176269531
Epoch: 6, Steps: 17 | Train Loss: 3.634 Vali Loss: 48.902 Vali Acc: 0.665 Test Loss: 48.902 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.332056045532227
Epoch: 7, Steps: 17 | Train Loss: 3.238 Vali Loss: 22.520 Vali Acc: 0.763 Test Loss: 22.520 Test Acc: 0.763
Validation loss decreased (-0.739625 --> -0.762781).  Saving model ...
Epoch: 8 cost time: 8.403926610946655
Epoch: 8, Steps: 17 | Train Loss: 1.943 Vali Loss: 43.279 Vali Acc: 0.699 Test Loss: 43.279 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.325881004333496
Epoch: 9, Steps: 17 | Train Loss: 1.596 Vali Loss: 22.906 Vali Acc: 0.711 Test Loss: 22.906 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.354131698608398
Epoch: 10, Steps: 17 | Train Loss: 2.947 Vali Loss: 24.139 Vali Acc: 0.798 Test Loss: 24.139 Test Acc: 0.798
Validation loss decreased (-0.762781 --> -0.797446).  Saving model ...
Epoch: 11 cost time: 8.348956823348999
Epoch: 11, Steps: 17 | Train Loss: 2.862 Vali Loss: 30.408 Vali Acc: 0.803 Test Loss: 30.408 Test Acc: 0.803
Validation loss decreased (-0.797446 --> -0.803164).  Saving model ...
Epoch: 12 cost time: 8.366530179977417
Epoch: 12, Steps: 17 | Train Loss: 0.541 Vali Loss: 67.575 Vali Acc: 0.665 Test Loss: 67.575 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.339739799499512
Epoch: 13, Steps: 17 | Train Loss: 0.938 Vali Loss: 61.639 Vali Acc: 0.740 Test Loss: 61.639 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.331373691558838
Epoch: 14, Steps: 17 | Train Loss: 0.560 Vali Loss: 48.645 Vali Acc: 0.734 Test Loss: 48.645 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.335715770721436
Epoch: 15, Steps: 17 | Train Loss: 0.860 Vali Loss: 41.972 Vali Acc: 0.728 Test Loss: 41.972 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.33619475364685
Epoch: 16, Steps: 17 | Train Loss: 0.661 Vali Loss: 44.064 Vali Acc: 0.751 Test Loss: 44.064 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.32511568069458
Epoch: 17, Steps: 17 | Train Loss: 0.914 Vali Loss: 56.406 Vali Acc: 0.723 Test Loss: 56.406 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.346853971481323
Epoch: 18, Steps: 17 | Train Loss: 2.288 Vali Loss: 63.967 Vali Acc: 0.723 Test Loss: 63.967 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.332476377487183
Epoch: 19, Steps: 17 | Train Loss: 5.553 Vali Loss: 49.083 Vali Acc: 0.699 Test Loss: 49.083 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.377251625061035
Epoch: 20, Steps: 17 | Train Loss: 4.351 Vali Loss: 73.561 Vali Acc: 0.717 Test Loss: 73.561 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.335789442062378
Epoch: 21, Steps: 17 | Train Loss: 4.621 Vali Loss: 116.181 Vali Acc: 0.757 Test Loss: 116.181 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1271101703
model size : 4852.65MB
2025-04-28 09:30:59.991583: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:31:00.010568: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745832660.032673 1014030 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745832660.039474 1014030 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:31:00.062794: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.432049036026001
Epoch: 1, Steps: 17 | Train Loss: 9.092 Vali Loss: 7.289 Vali Acc: 0.630 Test Loss: 7.289 Test Acc: 0.630
Validation loss decreased (inf --> -0.629985).  Saving model ...
Epoch: 2 cost time: 7.224330902099609
Epoch: 2, Steps: 17 | Train Loss: 9.292 Vali Loss: 14.227 Vali Acc: 0.676 Test Loss: 14.227 Test Acc: 0.676
Validation loss decreased (-0.629985 --> -0.676158).  Saving model ...
Epoch: 3 cost time: 7.233532190322876
Epoch: 3, Steps: 17 | Train Loss: 6.728 Vali Loss: 25.785 Vali Acc: 0.734 Test Loss: 25.785 Test Acc: 0.734
Validation loss decreased (-0.676158 --> -0.733846).  Saving model ...
Epoch: 4 cost time: 7.241509675979614
Epoch: 4, Steps: 17 | Train Loss: 8.110 Vali Loss: 16.829 Vali Acc: 0.746 Test Loss: 16.829 Test Acc: 0.746
Validation loss decreased (-0.733846 --> -0.745496).  Saving model ...
Epoch: 5 cost time: 7.214970588684082
Epoch: 5, Steps: 17 | Train Loss: 5.922 Vali Loss: 40.400 Vali Acc: 0.595 Test Loss: 40.400 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.212140798568726
Epoch: 6, Steps: 17 | Train Loss: 4.123 Vali Loss: 23.709 Vali Acc: 0.694 Test Loss: 23.709 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.207396507263184
Epoch: 7, Steps: 17 | Train Loss: 2.133 Vali Loss: 18.105 Vali Acc: 0.740 Test Loss: 18.105 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.204328775405884
Epoch: 8, Steps: 17 | Train Loss: 0.850 Vali Loss: 14.846 Vali Acc: 0.740 Test Loss: 14.846 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.217968940734863
Epoch: 9, Steps: 17 | Train Loss: 1.475 Vali Loss: 38.581 Vali Acc: 0.699 Test Loss: 38.581 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.217336893081665
Epoch: 10, Steps: 17 | Train Loss: 1.521 Vali Loss: 25.883 Vali Acc: 0.705 Test Loss: 25.883 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.227790355682373
Epoch: 11, Steps: 17 | Train Loss: 1.168 Vali Loss: 35.049 Vali Acc: 0.642 Test Loss: 35.049 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.215834617614746
Epoch: 12, Steps: 17 | Train Loss: 1.511 Vali Loss: 12.297 Vali Acc: 0.792 Test Loss: 12.297 Test Acc: 0.792
Validation loss decreased (-0.745496 --> -0.791785).  Saving model ...
Epoch: 13 cost time: 7.252113580703735
Epoch: 13, Steps: 17 | Train Loss: 0.843 Vali Loss: 14.129 Vali Acc: 0.838 Test Loss: 14.129 Test Acc: 0.838
Validation loss decreased (-0.791785 --> -0.838009).  Saving model ...
Epoch: 14 cost time: 7.291728734970093
Epoch: 14, Steps: 17 | Train Loss: 0.822 Vali Loss: 18.535 Vali Acc: 0.821 Test Loss: 18.535 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.245647668838501
Epoch: 15, Steps: 17 | Train Loss: 0.183 Vali Loss: 21.160 Vali Acc: 0.832 Test Loss: 21.160 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.227097272872925
Epoch: 16, Steps: 17 | Train Loss: 0.516 Vali Loss: 27.665 Vali Acc: 0.763 Test Loss: 27.665 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.232816696166992
Epoch: 17, Steps: 17 | Train Loss: 0.936 Vali Loss: 28.462 Vali Acc: 0.815 Test Loss: 28.462 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.2297279834747314
Epoch: 18, Steps: 17 | Train Loss: 1.547 Vali Loss: 19.390 Vali Acc: 0.803 Test Loss: 19.390 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.243518352508545
Epoch: 19, Steps: 17 | Train Loss: 0.478 Vali Loss: 23.831 Vali Acc: 0.798 Test Loss: 23.831 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.2309887409210205
Epoch: 20, Steps: 17 | Train Loss: 0.266 Vali Loss: 41.884 Vali Acc: 0.775 Test Loss: 41.884 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.248715400695801
Epoch: 21, Steps: 17 | Train Loss: 0.384 Vali Loss: 27.457 Vali Acc: 0.780 Test Loss: 27.457 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.26099967956543
Epoch: 22, Steps: 17 | Train Loss: 0.157 Vali Loss: 46.049 Vali Acc: 0.699 Test Loss: 46.049 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.247828006744385
Epoch: 23, Steps: 17 | Train Loss: 1.464 Vali Loss: 24.889 Vali Acc: 0.740 Test Loss: 24.889 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1250394119
model size : 4773.65MB
2025-04-28 09:37:01.663638: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:37:01.683870: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745833021.707122 1025364 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745833021.714194 1025364 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:37:01.738347: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.148896217346191
Epoch: 1, Steps: 17 | Train Loss: 10.371 Vali Loss: 6.719 Vali Acc: 0.590 Test Loss: 6.719 Test Acc: 0.590
Validation loss decreased (inf --> -0.589528).  Saving model ...
Epoch: 2 cost time: 6.9142255783081055
Epoch: 2, Steps: 17 | Train Loss: 3.757 Vali Loss: 20.986 Vali Acc: 0.584 Test Loss: 20.986 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.9007556438446045
Epoch: 3, Steps: 17 | Train Loss: 8.198 Vali Loss: 12.641 Vali Acc: 0.728 Test Loss: 12.641 Test Acc: 0.728
Validation loss decreased (-0.589528 --> -0.728197).  Saving model ...
Epoch: 4 cost time: 6.917477607727051
Epoch: 4, Steps: 17 | Train Loss: 5.631 Vali Loss: 13.166 Vali Acc: 0.728 Test Loss: 13.166 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.879985332489014
Epoch: 5, Steps: 17 | Train Loss: 2.527 Vali Loss: 36.400 Vali Acc: 0.676 Test Loss: 36.400 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.882490158081055
Epoch: 6, Steps: 17 | Train Loss: 2.513 Vali Loss: 15.501 Vali Acc: 0.734 Test Loss: 15.501 Test Acc: 0.734
Validation loss decreased (-0.728197 --> -0.733949).  Saving model ...
Epoch: 7 cost time: 6.920141696929932
Epoch: 7, Steps: 17 | Train Loss: 1.445 Vali Loss: 28.595 Vali Acc: 0.671 Test Loss: 28.595 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.881592750549316
Epoch: 8, Steps: 17 | Train Loss: 0.925 Vali Loss: 24.489 Vali Acc: 0.699 Test Loss: 24.489 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.8807713985443115
Epoch: 9, Steps: 17 | Train Loss: 0.242 Vali Loss: 16.672 Vali Acc: 0.775 Test Loss: 16.672 Test Acc: 0.775
Validation loss decreased (-0.733949 --> -0.774400).  Saving model ...
Epoch: 10 cost time: 6.932102203369141
Epoch: 10, Steps: 17 | Train Loss: 0.626 Vali Loss: 19.289 Vali Acc: 0.740 Test Loss: 19.289 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.898273706436157
Epoch: 11, Steps: 17 | Train Loss: 0.848 Vali Loss: 20.859 Vali Acc: 0.746 Test Loss: 20.859 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.889922618865967
Epoch: 12, Steps: 17 | Train Loss: 0.681 Vali Loss: 21.572 Vali Acc: 0.757 Test Loss: 21.572 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.8809027671813965
Epoch: 13, Steps: 17 | Train Loss: 0.515 Vali Loss: 21.902 Vali Acc: 0.728 Test Loss: 21.902 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.8817620277404785
Epoch: 14, Steps: 17 | Train Loss: 0.575 Vali Loss: 22.099 Vali Acc: 0.751 Test Loss: 22.099 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.886507272720337
Epoch: 15, Steps: 17 | Train Loss: 0.339 Vali Loss: 40.246 Vali Acc: 0.746 Test Loss: 40.246 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.893908739089966
Epoch: 16, Steps: 17 | Train Loss: 0.960 Vali Loss: 18.823 Vali Acc: 0.763 Test Loss: 18.823 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.89285945892334
Epoch: 17, Steps: 17 | Train Loss: 0.261 Vali Loss: 20.810 Vali Acc: 0.769 Test Loss: 20.810 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.906420469284058
Epoch: 18, Steps: 17 | Train Loss: 0.463 Vali Loss: 15.918 Vali Acc: 0.803 Test Loss: 15.918 Test Acc: 0.803
Validation loss decreased (-0.774400 --> -0.803309).  Saving model ...
Epoch: 19 cost time: 6.932403564453125
Epoch: 19, Steps: 17 | Train Loss: 1.772 Vali Loss: 12.097 Vali Acc: 0.821 Test Loss: 12.097 Test Acc: 0.821
Validation loss decreased (-0.803309 --> -0.820688).  Saving model ...
Epoch: 20 cost time: 6.957782506942749
Epoch: 20, Steps: 17 | Train Loss: 0.449 Vali Loss: 30.591 Vali Acc: 0.757 Test Loss: 30.591 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.912157297134399
Epoch: 21, Steps: 17 | Train Loss: 0.901 Vali Loss: 39.966 Vali Acc: 0.728 Test Loss: 39.966 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.907809495925903
Epoch: 22, Steps: 17 | Train Loss: 0.751 Vali Loss: 41.051 Vali Acc: 0.734 Test Loss: 41.051 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.920390844345093
Epoch: 23, Steps: 17 | Train Loss: 1.422 Vali Loss: 36.002 Vali Acc: 0.734 Test Loss: 36.002 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.91143012046814
Epoch: 24, Steps: 17 | Train Loss: 0.728 Vali Loss: 31.694 Vali Acc: 0.751 Test Loss: 31.694 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.912570238113403
Epoch: 25, Steps: 17 | Train Loss: 0.743 Vali Loss: 38.149 Vali Acc: 0.699 Test Loss: 38.149 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.930759429931641
Epoch: 26, Steps: 17 | Train Loss: 1.945 Vali Loss: 46.159 Vali Acc: 0.699 Test Loss: 46.159 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.912274599075317
Epoch: 27, Steps: 17 | Train Loss: 0.936 Vali Loss: 46.814 Vali Acc: 0.728 Test Loss: 46.814 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.940136194229126
Epoch: 28, Steps: 17 | Train Loss: 2.948 Vali Loss: 56.425 Vali Acc: 0.723 Test Loss: 56.425 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.905423641204834
Epoch: 29, Steps: 17 | Train Loss: 2.660 Vali Loss: 42.405 Vali Acc: 0.734 Test Loss: 42.405 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1240040967
model size : 4734.16MB
2025-04-28 09:43:48.991926: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:43:49.010769: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745833429.033508 1039414 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745833429.040348 1039414 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:43:49.063182: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.405406713485718
Epoch: 1, Steps: 17 | Train Loss: 6.040 Vali Loss: 6.308 Vali Acc: 0.509 Test Loss: 6.308 Test Acc: 0.509
Validation loss decreased (inf --> -0.508607).  Saving model ...
Epoch: 2 cost time: 7.275001525878906
Epoch: 2, Steps: 17 | Train Loss: 3.397 Vali Loss: 5.647 Vali Acc: 0.763 Test Loss: 5.647 Test Acc: 0.763
Validation loss decreased (-0.508607 --> -0.762949).  Saving model ...
Epoch: 3 cost time: 7.299698829650879
Epoch: 3, Steps: 17 | Train Loss: 4.269 Vali Loss: 32.360 Vali Acc: 0.474 Test Loss: 32.360 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.246526479721069
Epoch: 4, Steps: 17 | Train Loss: 7.429 Vali Loss: 25.317 Vali Acc: 0.549 Test Loss: 25.317 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.244539737701416
Epoch: 5, Steps: 17 | Train Loss: 5.413 Vali Loss: 22.639 Vali Acc: 0.636 Test Loss: 22.639 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.258819341659546
Epoch: 6, Steps: 17 | Train Loss: 1.410 Vali Loss: 10.337 Vali Acc: 0.746 Test Loss: 10.337 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.254513740539551
Epoch: 7, Steps: 17 | Train Loss: 0.667 Vali Loss: 10.544 Vali Acc: 0.763 Test Loss: 10.544 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.2457334995269775
Epoch: 8, Steps: 17 | Train Loss: 0.403 Vali Loss: 12.324 Vali Acc: 0.769 Test Loss: 12.324 Test Acc: 0.769
Validation loss decreased (-0.762949 --> -0.768663).  Saving model ...
Epoch: 9 cost time: 7.287156105041504
Epoch: 9, Steps: 17 | Train Loss: 1.246 Vali Loss: 11.047 Vali Acc: 0.780 Test Loss: 11.047 Test Acc: 0.780
Validation loss decreased (-0.768663 --> -0.780236).  Saving model ...
Epoch: 10 cost time: 7.291415452957153
Epoch: 10, Steps: 17 | Train Loss: 1.137 Vali Loss: 18.575 Vali Acc: 0.705 Test Loss: 18.575 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.2303550243377686
Epoch: 11, Steps: 17 | Train Loss: 0.661 Vali Loss: 22.477 Vali Acc: 0.734 Test Loss: 22.477 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.266649007797241
Epoch: 12, Steps: 17 | Train Loss: 2.079 Vali Loss: 31.998 Vali Acc: 0.647 Test Loss: 31.998 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.23533034324646
Epoch: 13, Steps: 17 | Train Loss: 1.167 Vali Loss: 15.927 Vali Acc: 0.827 Test Loss: 15.927 Test Acc: 0.827
Validation loss decreased (-0.780236 --> -0.826430).  Saving model ...
Epoch: 14 cost time: 7.2826714515686035
Epoch: 14, Steps: 17 | Train Loss: 0.276 Vali Loss: 33.718 Vali Acc: 0.728 Test Loss: 33.718 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.249035835266113
Epoch: 15, Steps: 17 | Train Loss: 0.240 Vali Loss: 31.066 Vali Acc: 0.734 Test Loss: 31.066 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.235607147216797
Epoch: 16, Steps: 17 | Train Loss: 1.086 Vali Loss: 48.496 Vali Acc: 0.705 Test Loss: 48.496 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.255338668823242
Epoch: 17, Steps: 17 | Train Loss: 0.803 Vali Loss: 15.317 Vali Acc: 0.780 Test Loss: 15.317 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.242434978485107
Epoch: 18, Steps: 17 | Train Loss: 1.235 Vali Loss: 16.233 Vali Acc: 0.769 Test Loss: 16.233 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.21916937828064
Epoch: 19, Steps: 17 | Train Loss: 1.099 Vali Loss: 15.552 Vali Acc: 0.809 Test Loss: 15.552 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.236587285995483
Epoch: 20, Steps: 17 | Train Loss: 0.106 Vali Loss: 23.304 Vali Acc: 0.775 Test Loss: 23.304 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.226913928985596
Epoch: 21, Steps: 17 | Train Loss: 0.445 Vali Loss: 25.398 Vali Acc: 0.723 Test Loss: 25.398 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.2371461391448975
Epoch: 22, Steps: 17 | Train Loss: 0.474 Vali Loss: 20.159 Vali Acc: 0.780 Test Loss: 20.159 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.236150026321411
Epoch: 23, Steps: 17 | Train Loss: 0.567 Vali Loss: 24.431 Vali Acc: 0.786 Test Loss: 24.431 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1231414279
model size : 4701.25MB
2025-04-28 09:49:52.943024: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:49:52.962803: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745833792.985498 1050757 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745833792.992425 1050757 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:49:53.015791: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.037318468093872
Epoch: 1, Steps: 17 | Train Loss: 3.401 Vali Loss: 6.633 Vali Acc: 0.503 Test Loss: 6.633 Test Acc: 0.503
Validation loss decreased (inf --> -0.502824).  Saving model ...
Epoch: 2 cost time: 6.790013074874878
Epoch: 2, Steps: 17 | Train Loss: 4.347 Vali Loss: 7.337 Vali Acc: 0.636 Test Loss: 7.337 Test Acc: 0.636
Validation loss decreased (-0.502824 --> -0.635765).  Saving model ...
Epoch: 3 cost time: 6.824691295623779
Epoch: 3, Steps: 17 | Train Loss: 1.916 Vali Loss: 14.818 Vali Acc: 0.613 Test Loss: 14.818 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.756850719451904
Epoch: 4, Steps: 17 | Train Loss: 3.225 Vali Loss: 13.233 Vali Acc: 0.699 Test Loss: 13.233 Test Acc: 0.699
Validation loss decreased (-0.635765 --> -0.699290).  Saving model ...
Epoch: 5 cost time: 6.800912141799927
Epoch: 5, Steps: 17 | Train Loss: 1.307 Vali Loss: 8.025 Vali Acc: 0.665 Test Loss: 8.025 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.758670330047607
Epoch: 6, Steps: 17 | Train Loss: 1.855 Vali Loss: 12.136 Vali Acc: 0.694 Test Loss: 12.136 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.786070346832275
Epoch: 7, Steps: 17 | Train Loss: 0.854 Vali Loss: 24.160 Vali Acc: 0.636 Test Loss: 24.160 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.821110725402832
Epoch: 8, Steps: 17 | Train Loss: 3.122 Vali Loss: 14.376 Vali Acc: 0.711 Test Loss: 14.376 Test Acc: 0.711
Validation loss decreased (-0.699290 --> -0.710839).  Saving model ...
Epoch: 9 cost time: 6.830310344696045
Epoch: 9, Steps: 17 | Train Loss: 2.359 Vali Loss: 8.186 Vali Acc: 0.775 Test Loss: 8.186 Test Acc: 0.775
Validation loss decreased (-0.710839 --> -0.774485).  Saving model ...
Epoch: 10 cost time: 6.832883596420288
Epoch: 10, Steps: 17 | Train Loss: 0.198 Vali Loss: 6.508 Vali Acc: 0.803 Test Loss: 6.508 Test Acc: 0.803
Validation loss decreased (-0.774485 --> -0.803403).  Saving model ...
Epoch: 11 cost time: 6.83240818977356
Epoch: 11, Steps: 17 | Train Loss: 0.188 Vali Loss: 12.936 Vali Acc: 0.769 Test Loss: 12.936 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.7813169956207275
Epoch: 12, Steps: 17 | Train Loss: 0.433 Vali Loss: 9.583 Vali Acc: 0.775 Test Loss: 9.583 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.774584770202637
Epoch: 13, Steps: 17 | Train Loss: 0.137 Vali Loss: 12.259 Vali Acc: 0.803 Test Loss: 12.259 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.79182505607605
Epoch: 14, Steps: 17 | Train Loss: 0.586 Vali Loss: 7.799 Vali Acc: 0.798 Test Loss: 7.799 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.782741069793701
Epoch: 15, Steps: 17 | Train Loss: 0.621 Vali Loss: 12.410 Vali Acc: 0.827 Test Loss: 12.410 Test Acc: 0.827
Validation loss decreased (-0.803403 --> -0.826465).  Saving model ...
Epoch: 16 cost time: 6.820143222808838
Epoch: 16, Steps: 17 | Train Loss: 0.601 Vali Loss: 27.592 Vali Acc: 0.711 Test Loss: 27.592 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.784962177276611
Epoch: 17, Steps: 17 | Train Loss: 1.753 Vali Loss: 20.930 Vali Acc: 0.607 Test Loss: 20.930 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.7876222133636475
Epoch: 18, Steps: 17 | Train Loss: 0.913 Vali Loss: 31.879 Vali Acc: 0.711 Test Loss: 31.879 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.8063437938690186
Epoch: 19, Steps: 17 | Train Loss: 1.016 Vali Loss: 20.121 Vali Acc: 0.711 Test Loss: 20.121 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.796339750289917
Epoch: 20, Steps: 17 | Train Loss: 1.348 Vali Loss: 19.036 Vali Acc: 0.630 Test Loss: 19.036 Test Acc: 0.630
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.79802393913269
Epoch: 21, Steps: 17 | Train Loss: 1.015 Vali Loss: 21.370 Vali Acc: 0.705 Test Loss: 21.370 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.780362367630005
Epoch: 22, Steps: 17 | Train Loss: 1.310 Vali Loss: 13.902 Vali Acc: 0.798 Test Loss: 13.902 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.797792911529541
Epoch: 23, Steps: 17 | Train Loss: 1.961 Vali Loss: 38.142 Vali Acc: 0.775 Test Loss: 38.142 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.772477388381958
Epoch: 24, Steps: 17 | Train Loss: 2.533 Vali Loss: 69.069 Vali Acc: 0.624 Test Loss: 69.069 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.782215118408203
Epoch: 25, Steps: 17 | Train Loss: 2.322 Vali Loss: 32.769 Vali Acc: 0.751 Test Loss: 32.769 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1224513287
model size : 4674.93MB
2025-04-28 09:56:20.995566: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 09:56:21.014797: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745834181.037735 1063041 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745834181.044735 1063041 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 09:56:21.068171: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.845240116119385
Epoch: 1, Steps: 17 | Train Loss: 2.889 Vali Loss: 2.087 Vali Acc: 0.618 Test Loss: 2.087 Test Acc: 0.618
Validation loss decreased (inf --> -0.618476).  Saving model ...
Epoch: 2 cost time: 6.688349723815918
Epoch: 2, Steps: 17 | Train Loss: 2.904 Vali Loss: 5.803 Vali Acc: 0.618 Test Loss: 5.803 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.640409469604492
Epoch: 3, Steps: 17 | Train Loss: 2.547 Vali Loss: 8.903 Vali Acc: 0.647 Test Loss: 8.903 Test Acc: 0.647
Validation loss decreased (-0.618476 --> -0.647310).  Saving model ...
Epoch: 4 cost time: 6.640313386917114
Epoch: 4, Steps: 17 | Train Loss: 2.865 Vali Loss: 7.479 Vali Acc: 0.734 Test Loss: 7.479 Test Acc: 0.734
Validation loss decreased (-0.647310 --> -0.734029).  Saving model ...
Epoch: 5 cost time: 6.6656670570373535
Epoch: 5, Steps: 17 | Train Loss: 3.412 Vali Loss: 11.298 Vali Acc: 0.740 Test Loss: 11.298 Test Acc: 0.740
Validation loss decreased (-0.734029 --> -0.739771).  Saving model ...
Epoch: 6 cost time: 6.664689064025879
Epoch: 6, Steps: 17 | Train Loss: 1.453 Vali Loss: 11.838 Vali Acc: 0.688 Test Loss: 11.838 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.635452508926392
Epoch: 7, Steps: 17 | Train Loss: 0.952 Vali Loss: 10.523 Vali Acc: 0.757 Test Loss: 10.523 Test Acc: 0.757
Validation loss decreased (-0.739771 --> -0.757120).  Saving model ...
Epoch: 8 cost time: 6.653308391571045
Epoch: 8, Steps: 17 | Train Loss: 1.215 Vali Loss: 10.869 Vali Acc: 0.780 Test Loss: 10.869 Test Acc: 0.780
Validation loss decreased (-0.757120 --> -0.780238).  Saving model ...
Epoch: 9 cost time: 6.6348490715026855
Epoch: 9, Steps: 17 | Train Loss: 0.498 Vali Loss: 15.494 Vali Acc: 0.763 Test Loss: 15.494 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.601592779159546
Epoch: 10, Steps: 17 | Train Loss: 1.067 Vali Loss: 25.722 Vali Acc: 0.607 Test Loss: 25.722 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.59387993812561
Epoch: 11, Steps: 17 | Train Loss: 0.785 Vali Loss: 14.689 Vali Acc: 0.723 Test Loss: 14.689 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.6247546672821045
Epoch: 12, Steps: 17 | Train Loss: 1.585 Vali Loss: 22.284 Vali Acc: 0.763 Test Loss: 22.284 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.602965831756592
Epoch: 13, Steps: 17 | Train Loss: 1.378 Vali Loss: 17.733 Vali Acc: 0.809 Test Loss: 17.733 Test Acc: 0.809
Validation loss decreased (-0.780238 --> -0.809071).  Saving model ...
Epoch: 14 cost time: 6.60977029800415
Epoch: 14, Steps: 17 | Train Loss: 0.249 Vali Loss: 8.297 Vali Acc: 0.803 Test Loss: 8.297 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.602400064468384
Epoch: 15, Steps: 17 | Train Loss: 0.248 Vali Loss: 27.826 Vali Acc: 0.775 Test Loss: 27.826 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.600799560546875
Epoch: 16, Steps: 17 | Train Loss: 0.243 Vali Loss: 27.640 Vali Acc: 0.786 Test Loss: 27.640 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.604564905166626
Epoch: 17, Steps: 17 | Train Loss: 0.551 Vali Loss: 12.696 Vali Acc: 0.786 Test Loss: 12.696 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.591929912567139
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 17.365 Vali Acc: 0.751 Test Loss: 17.365 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.614419937133789
Epoch: 19, Steps: 17 | Train Loss: 0.042 Vali Loss: 24.096 Vali Acc: 0.798 Test Loss: 24.096 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.6083784103393555
Epoch: 20, Steps: 17 | Train Loss: 0.687 Vali Loss: 15.470 Vali Acc: 0.809 Test Loss: 15.470 Test Acc: 0.809
Validation loss decreased (-0.809071 --> -0.809094).  Saving model ...
Epoch: 21 cost time: 6.636363983154297
Epoch: 21, Steps: 17 | Train Loss: 0.286 Vali Loss: 12.342 Vali Acc: 0.827 Test Loss: 12.342 Test Acc: 0.827
Validation loss decreased (-0.809094 --> -0.826466).  Saving model ...
Epoch: 22 cost time: 6.635739803314209
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.496 Vali Acc: 0.827 Test Loss: 11.496 Test Acc: 0.827
Validation loss decreased (-0.826466 --> -0.826475).  Saving model ...
Epoch: 23 cost time: 6.650602102279663
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.331 Vali Acc: 0.827 Test Loss: 11.331 Test Acc: 0.827
Validation loss decreased (-0.826475 --> -0.826476).  Saving model ...
Epoch: 24 cost time: 6.660723686218262
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.279 Vali Acc: 0.827 Test Loss: 11.279 Test Acc: 0.827
Validation loss decreased (-0.826476 --> -0.826477).  Saving model ...
Epoch: 25 cost time: 6.669066429138184
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.334 Vali Acc: 0.827 Test Loss: 11.334 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.649495840072632
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.293 Vali Acc: 0.827 Test Loss: 11.293 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.646193981170654
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.315 Vali Acc: 0.827 Test Loss: 11.315 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.626344442367554
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.372 Vali Acc: 0.827 Test Loss: 11.372 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.638362884521484
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.298 Vali Acc: 0.827 Test Loss: 11.298 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.672181129455566
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.271 Vali Acc: 0.827 Test Loss: 11.271 Test Acc: 0.827
Validation loss decreased (-0.826477 --> -0.826477).  Saving model ...
Epoch: 31 cost time: 6.691349983215332
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.283 Vali Acc: 0.827 Test Loss: 11.283 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.6459126472473145
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.297 Vali Acc: 0.827 Test Loss: 11.297 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.647278308868408
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.336 Vali Acc: 0.827 Test Loss: 11.336 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.668269634246826
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.298 Vali Acc: 0.827 Test Loss: 11.298 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 6.656061172485352
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.318 Vali Acc: 0.827 Test Loss: 11.318 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.649080038070679
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.368 Vali Acc: 0.827 Test Loss: 11.368 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.635129690170288
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.288 Vali Acc: 0.827 Test Loss: 11.288 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 6.633663177490234
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.304 Vali Acc: 0.827 Test Loss: 11.304 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.640668153762817
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.330 Vali Acc: 0.827 Test Loss: 11.330 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.6359100341796875
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 11.301 Vali Acc: 0.827 Test Loss: 11.301 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1222789383
model size : 4668.35MB
2025-04-28 10:06:38.468264: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:06:38.487247: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745834798.510162 1082568 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745834798.517145 1082568 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:06:38.541107: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.268257141113281
Epoch: 1, Steps: 17 | Train Loss: 11.604 Vali Loss: 13.498 Vali Acc: 0.566 Test Loss: 13.498 Test Acc: 0.566
Validation loss decreased (inf --> -0.566339).  Saving model ...
Epoch: 2 cost time: 6.0493409633636475
Epoch: 2, Steps: 17 | Train Loss: 19.242 Vali Loss: 38.787 Vali Acc: 0.555 Test Loss: 38.787 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.022780656814575
Epoch: 3, Steps: 17 | Train Loss: 15.575 Vali Loss: 34.508 Vali Acc: 0.676 Test Loss: 34.508 Test Acc: 0.676
Validation loss decreased (-0.566339 --> -0.675955).  Saving model ...
Epoch: 4 cost time: 6.029099941253662
Epoch: 4, Steps: 17 | Train Loss: 10.456 Vali Loss: 36.169 Vali Acc: 0.682 Test Loss: 36.169 Test Acc: 0.682
Validation loss decreased (-0.675955 --> -0.681719).  Saving model ...
Epoch: 5 cost time: 6.048643589019775
Epoch: 5, Steps: 17 | Train Loss: 2.707 Vali Loss: 80.341 Vali Acc: 0.532 Test Loss: 80.341 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.977394342422485
Epoch: 6, Steps: 17 | Train Loss: 3.629 Vali Loss: 29.618 Vali Acc: 0.746 Test Loss: 29.618 Test Acc: 0.746
Validation loss decreased (-0.681719 --> -0.745369).  Saving model ...
Epoch: 7 cost time: 6.003587007522583
Epoch: 7, Steps: 17 | Train Loss: 1.453 Vali Loss: 59.001 Vali Acc: 0.624 Test Loss: 59.001 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.999330282211304
Epoch: 8, Steps: 17 | Train Loss: 2.073 Vali Loss: 70.347 Vali Acc: 0.566 Test Loss: 70.347 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.987506866455078
Epoch: 9, Steps: 17 | Train Loss: 7.224 Vali Loss: 67.602 Vali Acc: 0.590 Test Loss: 67.602 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.967169284820557
Epoch: 10, Steps: 17 | Train Loss: 3.327 Vali Loss: 40.443 Vali Acc: 0.682 Test Loss: 40.443 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.978098154067993
Epoch: 11, Steps: 17 | Train Loss: 1.126 Vali Loss: 48.162 Vali Acc: 0.699 Test Loss: 48.162 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.9799275398254395
Epoch: 12, Steps: 17 | Train Loss: 1.268 Vali Loss: 32.787 Vali Acc: 0.723 Test Loss: 32.787 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.98192286491394
Epoch: 13, Steps: 17 | Train Loss: 0.589 Vali Loss: 52.111 Vali Acc: 0.705 Test Loss: 52.111 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.970430850982666
Epoch: 14, Steps: 17 | Train Loss: 2.635 Vali Loss: 41.362 Vali Acc: 0.723 Test Loss: 41.362 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.980648756027222
Epoch: 15, Steps: 17 | Train Loss: 0.611 Vali Loss: 54.852 Vali Acc: 0.705 Test Loss: 54.852 Test Acc: 0.705
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.991743803024292
Epoch: 16, Steps: 17 | Train Loss: 0.694 Vali Loss: 59.607 Vali Acc: 0.642 Test Loss: 59.607 Test Acc: 0.642
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7456647398843931
model parameter : 603501703
model size : 2304.07MB
2025-04-28 10:09:49.496874: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:09:49.517710: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745834989.543370 1090268 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745834989.551145 1090268 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:09:49.575646: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.974588394165039
Epoch: 1, Steps: 17 | Train Loss: 7.522 Vali Loss: 12.086 Vali Acc: 0.520 Test Loss: 12.086 Test Acc: 0.520
Validation loss decreased (inf --> -0.520110).  Saving model ...
Epoch: 2 cost time: 4.734689712524414
Epoch: 2, Steps: 17 | Train Loss: 8.392 Vali Loss: 19.257 Vali Acc: 0.584 Test Loss: 19.257 Test Acc: 0.584
Validation loss decreased (-0.520110 --> -0.583622).  Saving model ...
Epoch: 3 cost time: 4.73650860786438
Epoch: 3, Steps: 17 | Train Loss: 6.594 Vali Loss: 21.592 Vali Acc: 0.688 Test Loss: 21.592 Test Acc: 0.688
Validation loss decreased (-0.583622 --> -0.687645).  Saving model ...
Epoch: 4 cost time: 4.731238126754761
Epoch: 4, Steps: 17 | Train Loss: 5.210 Vali Loss: 29.404 Vali Acc: 0.665 Test Loss: 29.404 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.710668563842773
Epoch: 5, Steps: 17 | Train Loss: 2.774 Vali Loss: 15.177 Vali Acc: 0.757 Test Loss: 15.177 Test Acc: 0.757
Validation loss decreased (-0.687645 --> -0.757074).  Saving model ...
Epoch: 6 cost time: 4.743861198425293
Epoch: 6, Steps: 17 | Train Loss: 1.811 Vali Loss: 25.010 Vali Acc: 0.740 Test Loss: 25.010 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.714132070541382
Epoch: 7, Steps: 17 | Train Loss: 2.001 Vali Loss: 18.579 Vali Acc: 0.688 Test Loss: 18.579 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.7180702686309814
Epoch: 8, Steps: 17 | Train Loss: 2.264 Vali Loss: 23.003 Vali Acc: 0.723 Test Loss: 23.003 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.699987888336182
Epoch: 9, Steps: 17 | Train Loss: 3.860 Vali Loss: 25.577 Vali Acc: 0.676 Test Loss: 25.577 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.716944456100464
Epoch: 10, Steps: 17 | Train Loss: 1.083 Vali Loss: 9.411 Vali Acc: 0.798 Test Loss: 9.411 Test Acc: 0.798
Validation loss decreased (-0.757074 --> -0.797594).  Saving model ...
Epoch: 11 cost time: 4.744695663452148
Epoch: 11, Steps: 17 | Train Loss: 0.644 Vali Loss: 18.460 Vali Acc: 0.757 Test Loss: 18.460 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.7075676918029785
Epoch: 12, Steps: 17 | Train Loss: 0.813 Vali Loss: 15.411 Vali Acc: 0.803 Test Loss: 15.411 Test Acc: 0.803
Validation loss decreased (-0.797594 --> -0.803314).  Saving model ...
Epoch: 13 cost time: 4.777467966079712
Epoch: 13, Steps: 17 | Train Loss: 0.334 Vali Loss: 20.647 Vali Acc: 0.705 Test Loss: 20.647 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.733016490936279
Epoch: 14, Steps: 17 | Train Loss: 1.154 Vali Loss: 32.652 Vali Acc: 0.746 Test Loss: 32.652 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.708944082260132
Epoch: 15, Steps: 17 | Train Loss: 0.385 Vali Loss: 13.030 Vali Acc: 0.821 Test Loss: 13.030 Test Acc: 0.821
Validation loss decreased (-0.803314 --> -0.820679).  Saving model ...
Epoch: 16 cost time: 4.774625301361084
Epoch: 16, Steps: 17 | Train Loss: 0.412 Vali Loss: 12.948 Vali Acc: 0.780 Test Loss: 12.948 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.730905055999756
Epoch: 17, Steps: 17 | Train Loss: 0.585 Vali Loss: 19.228 Vali Acc: 0.792 Test Loss: 19.228 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.7560670375823975
Epoch: 18, Steps: 17 | Train Loss: 1.768 Vali Loss: 24.254 Vali Acc: 0.717 Test Loss: 24.254 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.75682806968689
Epoch: 19, Steps: 17 | Train Loss: 0.471 Vali Loss: 14.029 Vali Acc: 0.815 Test Loss: 14.029 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.7267022132873535
Epoch: 20, Steps: 17 | Train Loss: 0.336 Vali Loss: 17.610 Vali Acc: 0.809 Test Loss: 17.610 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.7448670864105225
Epoch: 21, Steps: 17 | Train Loss: 0.004 Vali Loss: 16.874 Vali Acc: 0.821 Test Loss: 16.874 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.744002819061279
Epoch: 22, Steps: 17 | Train Loss: 0.519 Vali Loss: 10.904 Vali Acc: 0.861 Test Loss: 10.904 Test Acc: 0.861
Validation loss decreased (-0.820679 --> -0.861163).  Saving model ...
Epoch: 23 cost time: 4.795316219329834
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 19.262 Vali Acc: 0.815 Test Loss: 19.262 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.762932538986206
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.127 Vali Acc: 0.815 Test Loss: 20.127 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.759941577911377
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.174 Vali Acc: 0.815 Test Loss: 20.174 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.736656665802002
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.218 Vali Acc: 0.815 Test Loss: 20.218 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.778843641281128
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.617 Vali Acc: 0.815 Test Loss: 20.617 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.758840322494507
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.306 Vali Acc: 0.815 Test Loss: 20.306 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.7578630447387695
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.249 Vali Acc: 0.815 Test Loss: 20.249 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.750687837600708
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.318 Vali Acc: 0.815 Test Loss: 20.318 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.7720959186553955
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.064 Vali Acc: 0.815 Test Loss: 20.064 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.764219522476196
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 20.037 Vali Acc: 0.815 Test Loss: 20.037 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 572439687
model size : 2185.58MB
2025-04-28 10:14:48.848148: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:14:48.867502: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745835288.890400 1105129 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745835288.897336 1105129 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:14:48.920382: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.578686475753784
Epoch: 1, Steps: 17 | Train Loss: 4.844 Vali Loss: 7.932 Vali Acc: 0.543 Test Loss: 7.932 Test Acc: 0.543
Validation loss decreased (inf --> -0.543273).  Saving model ...
Epoch: 2 cost time: 4.492215633392334
Epoch: 2, Steps: 17 | Train Loss: 5.435 Vali Loss: 7.870 Vali Acc: 0.688 Test Loss: 7.870 Test Acc: 0.688
Validation loss decreased (-0.543273 --> -0.687783).  Saving model ...
Epoch: 3 cost time: 4.484486103057861
Epoch: 3, Steps: 17 | Train Loss: 3.189 Vali Loss: 17.810 Vali Acc: 0.538 Test Loss: 17.810 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.456713438034058
Epoch: 4, Steps: 17 | Train Loss: 4.506 Vali Loss: 16.144 Vali Acc: 0.659 Test Loss: 16.144 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.454109191894531
Epoch: 5, Steps: 17 | Train Loss: 2.196 Vali Loss: 20.877 Vali Acc: 0.665 Test Loss: 20.877 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.464629173278809
Epoch: 6, Steps: 17 | Train Loss: 1.083 Vali Loss: 8.584 Vali Acc: 0.775 Test Loss: 8.584 Test Acc: 0.775
Validation loss decreased (-0.687783 --> -0.774481).  Saving model ...
Epoch: 7 cost time: 4.529508829116821
Epoch: 7, Steps: 17 | Train Loss: 3.591 Vali Loss: 8.228 Vali Acc: 0.763 Test Loss: 8.228 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.455795049667358
Epoch: 8, Steps: 17 | Train Loss: 0.748 Vali Loss: 11.349 Vali Acc: 0.636 Test Loss: 11.349 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.455273866653442
Epoch: 9, Steps: 17 | Train Loss: 0.891 Vali Loss: 7.089 Vali Acc: 0.780 Test Loss: 7.089 Test Acc: 0.780
Validation loss decreased (-0.774481 --> -0.780276).  Saving model ...
Epoch: 10 cost time: 4.481343507766724
Epoch: 10, Steps: 17 | Train Loss: 0.461 Vali Loss: 9.205 Vali Acc: 0.827 Test Loss: 9.205 Test Acc: 0.827
Validation loss decreased (-0.780276 --> -0.826498).  Saving model ...
Epoch: 11 cost time: 4.477270603179932
Epoch: 11, Steps: 17 | Train Loss: 0.505 Vali Loss: 7.647 Vali Acc: 0.821 Test Loss: 7.647 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.463974714279175
Epoch: 12, Steps: 17 | Train Loss: 0.124 Vali Loss: 8.824 Vali Acc: 0.827 Test Loss: 8.824 Test Acc: 0.827
Validation loss decreased (-0.826498 --> -0.826501).  Saving model ...
Epoch: 13 cost time: 4.472594738006592
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 10.985 Vali Acc: 0.809 Test Loss: 10.985 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.471876382827759
Epoch: 14, Steps: 17 | Train Loss: 0.110 Vali Loss: 17.233 Vali Acc: 0.775 Test Loss: 17.233 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.461351633071899
Epoch: 15, Steps: 17 | Train Loss: 1.006 Vali Loss: 22.248 Vali Acc: 0.746 Test Loss: 22.248 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.441228866577148
Epoch: 16, Steps: 17 | Train Loss: 0.181 Vali Loss: 5.686 Vali Acc: 0.832 Test Loss: 5.686 Test Acc: 0.832
Validation loss decreased (-0.826501 --> -0.832313).  Saving model ...
Epoch: 17 cost time: 4.474361419677734
Epoch: 17, Steps: 17 | Train Loss: 0.162 Vali Loss: 18.177 Vali Acc: 0.792 Test Loss: 18.177 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.450918912887573
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 10.909 Vali Acc: 0.792 Test Loss: 10.909 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.439319610595703
Epoch: 19, Steps: 17 | Train Loss: 0.438 Vali Loss: 8.535 Vali Acc: 0.827 Test Loss: 8.535 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.447222471237183
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 9.535 Vali Acc: 0.821 Test Loss: 9.535 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.4529547691345215
Epoch: 21, Steps: 17 | Train Loss: 0.326 Vali Loss: 25.004 Vali Acc: 0.751 Test Loss: 25.004 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.445899486541748
Epoch: 22, Steps: 17 | Train Loss: 0.862 Vali Loss: 13.360 Vali Acc: 0.809 Test Loss: 13.360 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.468735933303833
Epoch: 23, Steps: 17 | Train Loss: 0.969 Vali Loss: 18.662 Vali Acc: 0.757 Test Loss: 18.662 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.472447633743286
Epoch: 24, Steps: 17 | Train Loss: 1.044 Vali Loss: 20.878 Vali Acc: 0.780 Test Loss: 20.878 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.4558892250061035
Epoch: 25, Steps: 17 | Train Loss: 1.093 Vali Loss: 12.174 Vali Acc: 0.786 Test Loss: 12.174 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.465131521224976
Epoch: 26, Steps: 17 | Train Loss: 3.537 Vali Loss: 46.106 Vali Acc: 0.671 Test Loss: 46.106 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 562085895
model size : 2146.08MB
2025-04-28 10:18:40.727501: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:18:40.746585: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745835520.769771 1117196 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745835520.776818 1117196 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:18:40.800328: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.210603475570679
Epoch: 1, Steps: 17 | Train Loss: 3.354 Vali Loss: 4.047 Vali Acc: 0.607 Test Loss: 4.047 Test Acc: 0.607
Validation loss decreased (inf --> -0.606896).  Saving model ...
Epoch: 2 cost time: 4.21722674369812
Epoch: 2, Steps: 17 | Train Loss: 2.112 Vali Loss: 5.338 Vali Acc: 0.723 Test Loss: 5.338 Test Acc: 0.723
Validation loss decreased (-0.606896 --> -0.722490).  Saving model ...
Epoch: 3 cost time: 4.23138952255249
Epoch: 3, Steps: 17 | Train Loss: 1.937 Vali Loss: 6.037 Vali Acc: 0.740 Test Loss: 6.037 Test Acc: 0.740
Validation loss decreased (-0.722490 --> -0.739824).  Saving model ...
Epoch: 4 cost time: 4.2365028858184814
Epoch: 4, Steps: 17 | Train Loss: 1.088 Vali Loss: 7.239 Vali Acc: 0.734 Test Loss: 7.239 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.221038341522217
Epoch: 5, Steps: 17 | Train Loss: 2.661 Vali Loss: 16.124 Vali Acc: 0.688 Test Loss: 16.124 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.181229114532471
Epoch: 6, Steps: 17 | Train Loss: 3.556 Vali Loss: 11.039 Vali Acc: 0.740 Test Loss: 11.039 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.18647575378418
Epoch: 7, Steps: 17 | Train Loss: 1.279 Vali Loss: 12.184 Vali Acc: 0.740 Test Loss: 12.184 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.199702501296997
Epoch: 8, Steps: 17 | Train Loss: 0.653 Vali Loss: 11.181 Vali Acc: 0.711 Test Loss: 11.181 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.198788404464722
Epoch: 9, Steps: 17 | Train Loss: 0.188 Vali Loss: 11.148 Vali Acc: 0.746 Test Loss: 11.148 Test Acc: 0.746
Validation loss decreased (-0.739824 --> -0.745553).  Saving model ...
Epoch: 10 cost time: 4.237894058227539
Epoch: 10, Steps: 17 | Train Loss: 0.320 Vali Loss: 17.437 Vali Acc: 0.740 Test Loss: 17.437 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.186202049255371
Epoch: 11, Steps: 17 | Train Loss: 0.433 Vali Loss: 8.362 Vali Acc: 0.803 Test Loss: 8.362 Test Acc: 0.803
Validation loss decreased (-0.745553 --> -0.803385).  Saving model ...
Epoch: 12 cost time: 4.208036661148071
Epoch: 12, Steps: 17 | Train Loss: 0.390 Vali Loss: 12.143 Vali Acc: 0.746 Test Loss: 12.143 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.189995765686035
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 10.485 Vali Acc: 0.757 Test Loss: 10.485 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.196337938308716
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 9.798 Vali Acc: 0.827 Test Loss: 9.798 Test Acc: 0.827
Validation loss decreased (-0.803385 --> -0.826492).  Saving model ...
Epoch: 15 cost time: 4.237375736236572
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 12.563 Vali Acc: 0.769 Test Loss: 12.563 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.188137054443359
Epoch: 16, Steps: 17 | Train Loss: 0.528 Vali Loss: 12.678 Vali Acc: 0.803 Test Loss: 12.678 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.182814836502075
Epoch: 17, Steps: 17 | Train Loss: 0.526 Vali Loss: 9.776 Vali Acc: 0.832 Test Loss: 9.776 Test Acc: 0.832
Validation loss decreased (-0.826492 --> -0.832272).  Saving model ...
Epoch: 18 cost time: 4.229275226593018
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 19.187 Vali Acc: 0.659 Test Loss: 19.187 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.186355352401733
Epoch: 19, Steps: 17 | Train Loss: 0.338 Vali Loss: 18.051 Vali Acc: 0.699 Test Loss: 18.051 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.205426454544067
Epoch: 20, Steps: 17 | Train Loss: 0.086 Vali Loss: 16.957 Vali Acc: 0.798 Test Loss: 16.957 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.192366600036621
Epoch: 21, Steps: 17 | Train Loss: 0.205 Vali Loss: 16.520 Vali Acc: 0.832 Test Loss: 16.520 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.206763029098511
Epoch: 22, Steps: 17 | Train Loss: 0.375 Vali Loss: 14.917 Vali Acc: 0.792 Test Loss: 14.917 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.190511465072632
Epoch: 23, Steps: 17 | Train Loss: 0.049 Vali Loss: 28.545 Vali Acc: 0.763 Test Loss: 28.545 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.193573474884033
Epoch: 24, Steps: 17 | Train Loss: 0.198 Vali Loss: 39.492 Vali Acc: 0.728 Test Loss: 39.492 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.199138164520264
Epoch: 25, Steps: 17 | Train Loss: 1.001 Vali Loss: 13.097 Vali Acc: 0.803 Test Loss: 13.097 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.19301438331604
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 46.647 Vali Acc: 0.740 Test Loss: 46.647 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.193889617919922
Epoch: 27, Steps: 17 | Train Loss: 0.624 Vali Loss: 26.551 Vali Acc: 0.815 Test Loss: 26.551 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 556909319
model size : 2126.34MB
2025-04-28 10:22:29.996615: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:22:30.015899: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745835750.038753 1129671 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745835750.045867 1129671 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:22:30.069499: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.169384956359863
Epoch: 1, Steps: 17 | Train Loss: 3.611 Vali Loss: 4.113 Vali Acc: 0.555 Test Loss: 4.113 Test Acc: 0.555
Validation loss decreased (inf --> -0.554872).  Saving model ...
Epoch: 2 cost time: 4.138553857803345
Epoch: 2, Steps: 17 | Train Loss: 1.826 Vali Loss: 4.554 Vali Acc: 0.659 Test Loss: 4.554 Test Acc: 0.659
Validation loss decreased (-0.554872 --> -0.658914).  Saving model ...
Epoch: 3 cost time: 4.1557416915893555
Epoch: 3, Steps: 17 | Train Loss: 3.170 Vali Loss: 11.675 Vali Acc: 0.636 Test Loss: 11.675 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.129883289337158
Epoch: 4, Steps: 17 | Train Loss: 2.383 Vali Loss: 9.225 Vali Acc: 0.618 Test Loss: 9.225 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.126881837844849
Epoch: 5, Steps: 17 | Train Loss: 1.577 Vali Loss: 8.394 Vali Acc: 0.740 Test Loss: 8.394 Test Acc: 0.740
Validation loss decreased (-0.658914 --> -0.739800).  Saving model ...
Epoch: 6 cost time: 4.174257040023804
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 5.327 Vali Acc: 0.775 Test Loss: 5.327 Test Acc: 0.775
Validation loss decreased (-0.739800 --> -0.774513).  Saving model ...
Epoch: 7 cost time: 4.184529066085815
Epoch: 7, Steps: 17 | Train Loss: 0.470 Vali Loss: 6.186 Vali Acc: 0.723 Test Loss: 6.186 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.148995637893677
Epoch: 8, Steps: 17 | Train Loss: 0.269 Vali Loss: 8.202 Vali Acc: 0.798 Test Loss: 8.202 Test Acc: 0.798
Validation loss decreased (-0.774513 --> -0.797606).  Saving model ...
Epoch: 9 cost time: 4.171428918838501
Epoch: 9, Steps: 17 | Train Loss: 0.186 Vali Loss: 7.108 Vali Acc: 0.740 Test Loss: 7.108 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.133613348007202
Epoch: 10, Steps: 17 | Train Loss: 0.129 Vali Loss: 6.676 Vali Acc: 0.746 Test Loss: 6.676 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.139754056930542
Epoch: 11, Steps: 17 | Train Loss: 0.111 Vali Loss: 5.560 Vali Acc: 0.728 Test Loss: 5.560 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.133765459060669
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 8.794 Vali Acc: 0.746 Test Loss: 8.794 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.1336164474487305
Epoch: 13, Steps: 17 | Train Loss: 0.085 Vali Loss: 4.929 Vali Acc: 0.740 Test Loss: 4.929 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.133597373962402
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 14.040 Vali Acc: 0.659 Test Loss: 14.040 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.153162479400635
Epoch: 15, Steps: 17 | Train Loss: 1.160 Vali Loss: 10.837 Vali Acc: 0.786 Test Loss: 10.837 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.12785267829895
Epoch: 16, Steps: 17 | Train Loss: 0.818 Vali Loss: 12.480 Vali Acc: 0.723 Test Loss: 12.480 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.146608591079712
Epoch: 17, Steps: 17 | Train Loss: 1.341 Vali Loss: 11.820 Vali Acc: 0.757 Test Loss: 11.820 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.152573347091675
Epoch: 18, Steps: 17 | Train Loss: 0.494 Vali Loss: 16.244 Vali Acc: 0.775 Test Loss: 16.244 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 552595975
model size : 2109.88MB
2025-04-28 10:25:15.240566: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:25:15.259918: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745835915.283722 1138101 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745835915.290709 1138101 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:25:15.314322: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.9205591678619385
Epoch: 1, Steps: 17 | Train Loss: 2.382 Vali Loss: 1.472 Vali Acc: 0.694 Test Loss: 1.472 Test Acc: 0.694
Validation loss decreased (inf --> -0.693627).  Saving model ...
Epoch: 2 cost time: 3.9309754371643066
Epoch: 2, Steps: 17 | Train Loss: 1.321 Vali Loss: 5.617 Vali Acc: 0.601 Test Loss: 5.617 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9073727130889893
Epoch: 3, Steps: 17 | Train Loss: 2.861 Vali Loss: 5.439 Vali Acc: 0.705 Test Loss: 5.439 Test Acc: 0.705
Validation loss decreased (-0.693627 --> -0.705148).  Saving model ...
Epoch: 4 cost time: 3.9089081287384033
Epoch: 4, Steps: 17 | Train Loss: 1.653 Vali Loss: 6.736 Vali Acc: 0.624 Test Loss: 6.736 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9166746139526367
Epoch: 5, Steps: 17 | Train Loss: 0.881 Vali Loss: 6.514 Vali Acc: 0.705 Test Loss: 6.514 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9110536575317383
Epoch: 6, Steps: 17 | Train Loss: 1.251 Vali Loss: 5.157 Vali Acc: 0.694 Test Loss: 5.157 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.903862237930298
Epoch: 7, Steps: 17 | Train Loss: 0.819 Vali Loss: 11.752 Vali Acc: 0.699 Test Loss: 11.752 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.928302526473999
Epoch: 8, Steps: 17 | Train Loss: 0.618 Vali Loss: 5.367 Vali Acc: 0.728 Test Loss: 5.367 Test Acc: 0.728
Validation loss decreased (-0.705148 --> -0.728270).  Saving model ...
Epoch: 9 cost time: 3.929532289505005
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 5.548 Vali Acc: 0.740 Test Loss: 5.548 Test Acc: 0.740
Validation loss decreased (-0.728270 --> -0.739829).  Saving model ...
Epoch: 10 cost time: 3.940645694732666
Epoch: 10, Steps: 17 | Train Loss: 0.047 Vali Loss: 9.369 Vali Acc: 0.682 Test Loss: 9.369 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8973844051361084
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 5.436 Vali Acc: 0.780 Test Loss: 5.436 Test Acc: 0.780
Validation loss decreased (-0.739829 --> -0.780292).  Saving model ...
Epoch: 12 cost time: 3.943868637084961
Epoch: 12, Steps: 17 | Train Loss: 0.132 Vali Loss: 9.038 Vali Acc: 0.780 Test Loss: 9.038 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8988699913024902
Epoch: 13, Steps: 17 | Train Loss: 0.580 Vali Loss: 6.835 Vali Acc: 0.798 Test Loss: 6.835 Test Acc: 0.798
Validation loss decreased (-0.780292 --> -0.797620).  Saving model ...
Epoch: 14 cost time: 3.9471285343170166
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 7.247 Vali Acc: 0.746 Test Loss: 7.247 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9135351181030273
Epoch: 15, Steps: 17 | Train Loss: 0.560 Vali Loss: 21.169 Vali Acc: 0.630 Test Loss: 21.169 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.926968812942505
Epoch: 16, Steps: 17 | Train Loss: 0.709 Vali Loss: 14.348 Vali Acc: 0.740 Test Loss: 14.348 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.92665958404541
Epoch: 17, Steps: 17 | Train Loss: 0.399 Vali Loss: 9.566 Vali Acc: 0.734 Test Loss: 9.566 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8923027515411377
Epoch: 18, Steps: 17 | Train Loss: 0.432 Vali Loss: 11.208 Vali Acc: 0.757 Test Loss: 11.208 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8988685607910156
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 5.197 Vali Acc: 0.838 Test Loss: 5.197 Test Acc: 0.838
Validation loss decreased (-0.797620 --> -0.838098).  Saving model ...
Epoch: 20 cost time: 3.9211885929107666
Epoch: 20, Steps: 17 | Train Loss: 0.153 Vali Loss: 14.384 Vali Acc: 0.740 Test Loss: 14.384 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.893756866455078
Epoch: 21, Steps: 17 | Train Loss: 0.734 Vali Loss: 6.944 Vali Acc: 0.751 Test Loss: 6.944 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.923386573791504
Epoch: 22, Steps: 17 | Train Loss: 0.464 Vali Loss: 6.383 Vali Acc: 0.723 Test Loss: 6.383 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.8962249755859375
Epoch: 23, Steps: 17 | Train Loss: 0.192 Vali Loss: 8.949 Vali Acc: 0.769 Test Loss: 8.949 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.901306390762329
Epoch: 24, Steps: 17 | Train Loss: 0.272 Vali Loss: 7.855 Vali Acc: 0.740 Test Loss: 7.855 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.903008460998535
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 9.616 Vali Acc: 0.780 Test Loss: 9.616 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.9036104679107666
Epoch: 26, Steps: 17 | Train Loss: 0.477 Vali Loss: 8.850 Vali Acc: 0.803 Test Loss: 8.850 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.895277738571167
Epoch: 27, Steps: 17 | Train Loss: 0.087 Vali Loss: 11.833 Vali Acc: 0.775 Test Loss: 11.833 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.893376111984253
Epoch: 28, Steps: 17 | Train Loss: 0.532 Vali Loss: 11.621 Vali Acc: 0.832 Test Loss: 11.621 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.904987096786499
Epoch: 29, Steps: 17 | Train Loss: 0.197 Vali Loss: 7.763 Vali Acc: 0.844 Test Loss: 7.763 Test Acc: 0.844
Validation loss decreased (-0.838098 --> -0.843853).  Saving model ...
Epoch: 30 cost time: 3.958523988723755
Epoch: 30, Steps: 17 | Train Loss: 0.163 Vali Loss: 12.315 Vali Acc: 0.815 Test Loss: 12.315 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8955419063568115
Epoch: 31, Steps: 17 | Train Loss: 0.269 Vali Loss: 8.752 Vali Acc: 0.769 Test Loss: 8.752 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.9100959300994873
Epoch: 32, Steps: 17 | Train Loss: 0.138 Vali Loss: 15.712 Vali Acc: 0.757 Test Loss: 15.712 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.9177677631378174
Epoch: 33, Steps: 17 | Train Loss: 0.681 Vali Loss: 8.004 Vali Acc: 0.821 Test Loss: 8.004 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.9437084197998047
Epoch: 34, Steps: 17 | Train Loss: 0.206 Vali Loss: 21.516 Vali Acc: 0.734 Test Loss: 21.516 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.9006550312042236
Epoch: 35, Steps: 17 | Train Loss: 0.356 Vali Loss: 13.884 Vali Acc: 0.786 Test Loss: 13.884 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.91211199760437
Epoch: 36, Steps: 17 | Train Loss: 0.715 Vali Loss: 12.130 Vali Acc: 0.798 Test Loss: 12.130 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.9008984565734863
Epoch: 37, Steps: 17 | Train Loss: 0.255 Vali Loss: 31.260 Vali Acc: 0.711 Test Loss: 31.260 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.912266731262207
Epoch: 38, Steps: 17 | Train Loss: 0.359 Vali Loss: 18.920 Vali Acc: 0.798 Test Loss: 18.920 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.891387701034546
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 28.994 Vali Acc: 0.786 Test Loss: 28.994 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 549145479
model size : 2096.72MB
2025-04-28 10:30:18.047415: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:30:18.067196: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745836218.090890 1155921 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745836218.098060 1155921 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:30:18.121592: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.023697137832642
Epoch: 1, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.954 Vali Acc: 0.532 Test Loss: 1.954 Test Acc: 0.532
Validation loss decreased (inf --> -0.531772).  Saving model ...
Epoch: 2 cost time: 4.216634511947632
Epoch: 2, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.914 Vali Acc: 0.717 Test Loss: 1.914 Test Acc: 0.717
Validation loss decreased (-0.531772 --> -0.716744).  Saving model ...
Epoch: 3 cost time: 3.8622543811798096
Epoch: 3, Steps: 17 | Train Loss: 0.499 Vali Loss: 6.448 Vali Acc: 0.734 Test Loss: 6.448 Test Acc: 0.734
Validation loss decreased (-0.716744 --> -0.734040).  Saving model ...
Epoch: 4 cost time: 3.8480725288391113
Epoch: 4, Steps: 17 | Train Loss: 1.999 Vali Loss: 5.080 Vali Acc: 0.734 Test Loss: 5.080 Test Acc: 0.734
Validation loss decreased (-0.734040 --> -0.734053).  Saving model ...
Epoch: 5 cost time: 3.829528570175171
Epoch: 5, Steps: 17 | Train Loss: 2.151 Vali Loss: 4.942 Vali Acc: 0.798 Test Loss: 4.942 Test Acc: 0.798
Validation loss decreased (-0.734053 --> -0.797638).  Saving model ...
Epoch: 6 cost time: 3.8402891159057617
Epoch: 6, Steps: 17 | Train Loss: 1.886 Vali Loss: 3.527 Vali Acc: 0.809 Test Loss: 3.527 Test Acc: 0.809
Validation loss decreased (-0.797638 --> -0.809213).  Saving model ...
Epoch: 7 cost time: 3.8294456005096436
Epoch: 7, Steps: 17 | Train Loss: 1.580 Vali Loss: 9.918 Vali Acc: 0.665 Test Loss: 9.918 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.809389114379883
Epoch: 8, Steps: 17 | Train Loss: 0.460 Vali Loss: 4.705 Vali Acc: 0.809 Test Loss: 4.705 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.82177734375
Epoch: 9, Steps: 17 | Train Loss: 0.098 Vali Loss: 3.861 Vali Acc: 0.803 Test Loss: 3.861 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.8100595474243164
Epoch: 10, Steps: 17 | Train Loss: 0.089 Vali Loss: 12.677 Vali Acc: 0.688 Test Loss: 12.677 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.809255599975586
Epoch: 11, Steps: 17 | Train Loss: 0.420 Vali Loss: 7.118 Vali Acc: 0.734 Test Loss: 7.118 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.797752618789673
Epoch: 12, Steps: 17 | Train Loss: 0.789 Vali Loss: 6.026 Vali Acc: 0.728 Test Loss: 6.026 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.842818021774292
Epoch: 13, Steps: 17 | Train Loss: 0.294 Vali Loss: 12.596 Vali Acc: 0.711 Test Loss: 12.596 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.8037109375
Epoch: 14, Steps: 17 | Train Loss: 0.243 Vali Loss: 8.928 Vali Acc: 0.728 Test Loss: 8.928 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.8031129837036133
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 10.072 Vali Acc: 0.717 Test Loss: 10.072 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.7950658798217773
Epoch: 16, Steps: 17 | Train Loss: 0.355 Vali Loss: 8.387 Vali Acc: 0.775 Test Loss: 8.387 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 548283527
model size : 2093.43MB
2025-04-28 10:32:47.158407: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:32:47.177431: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745836367.200159 1163456 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745836367.207119 1163456 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:32:47.230324: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.985720634460449
Epoch: 1, Steps: 17 | Train Loss: 5.569 Vali Loss: 9.887 Vali Acc: 0.590 Test Loss: 9.887 Test Acc: 0.590
Validation loss decreased (inf --> -0.589497).  Saving model ...
Epoch: 2 cost time: 3.7378077507019043
Epoch: 2, Steps: 17 | Train Loss: 8.126 Vali Loss: 17.737 Vali Acc: 0.439 Test Loss: 17.737 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.704753875732422
Epoch: 3, Steps: 17 | Train Loss: 7.372 Vali Loss: 11.941 Vali Acc: 0.746 Test Loss: 11.941 Test Acc: 0.746
Validation loss decreased (-0.589497 --> -0.745545).  Saving model ...
Epoch: 4 cost time: 3.7420601844787598
Epoch: 4, Steps: 17 | Train Loss: 4.309 Vali Loss: 22.729 Vali Acc: 0.642 Test Loss: 22.729 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7194557189941406
Epoch: 5, Steps: 17 | Train Loss: 1.410 Vali Loss: 15.239 Vali Acc: 0.671 Test Loss: 15.239 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6973655223846436
Epoch: 6, Steps: 17 | Train Loss: 1.437 Vali Loss: 29.923 Vali Acc: 0.595 Test Loss: 29.923 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7269091606140137
Epoch: 7, Steps: 17 | Train Loss: 1.963 Vali Loss: 16.816 Vali Acc: 0.740 Test Loss: 16.816 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.704718589782715
Epoch: 8, Steps: 17 | Train Loss: 1.153 Vali Loss: 24.350 Vali Acc: 0.728 Test Loss: 24.350 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.736172676086426
Epoch: 9, Steps: 17 | Train Loss: 1.742 Vali Loss: 17.417 Vali Acc: 0.763 Test Loss: 17.417 Test Acc: 0.763
Validation loss decreased (-0.745545 --> -0.762832).  Saving model ...
Epoch: 10 cost time: 3.7403171062469482
Epoch: 10, Steps: 17 | Train Loss: 0.546 Vali Loss: 19.619 Vali Acc: 0.792 Test Loss: 19.619 Test Acc: 0.792
Validation loss decreased (-0.762832 --> -0.791711).  Saving model ...
Epoch: 11 cost time: 3.724724769592285
Epoch: 11, Steps: 17 | Train Loss: 0.522 Vali Loss: 14.646 Vali Acc: 0.786 Test Loss: 14.646 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7483396530151367
Epoch: 12, Steps: 17 | Train Loss: 0.543 Vali Loss: 29.533 Vali Acc: 0.636 Test Loss: 29.533 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7402243614196777
Epoch: 13, Steps: 17 | Train Loss: 1.291 Vali Loss: 14.286 Vali Acc: 0.786 Test Loss: 14.286 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7340030670166016
Epoch: 14, Steps: 17 | Train Loss: 0.476 Vali Loss: 20.326 Vali Acc: 0.717 Test Loss: 20.326 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7299394607543945
Epoch: 15, Steps: 17 | Train Loss: 1.664 Vali Loss: 25.965 Vali Acc: 0.751 Test Loss: 25.965 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.721268892288208
Epoch: 16, Steps: 17 | Train Loss: 1.047 Vali Loss: 13.182 Vali Acc: 0.792 Test Loss: 13.182 Test Acc: 0.792
Validation loss decreased (-0.791711 --> -0.791776).  Saving model ...
Epoch: 17 cost time: 3.7535698413848877
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 21.174 Vali Acc: 0.792 Test Loss: 21.174 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.739243745803833
Epoch: 18, Steps: 17 | Train Loss: 0.828 Vali Loss: 16.203 Vali Acc: 0.775 Test Loss: 16.203 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.731346368789673
Epoch: 19, Steps: 17 | Train Loss: 0.620 Vali Loss: 21.143 Vali Acc: 0.751 Test Loss: 21.143 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.738548994064331
Epoch: 20, Steps: 17 | Train Loss: 1.421 Vali Loss: 13.931 Vali Acc: 0.780 Test Loss: 13.931 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7185726165771484
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.066 Vali Acc: 0.757 Test Loss: 23.066 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.7672317028045654
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 24.656 Vali Acc: 0.757 Test Loss: 24.656 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.748621702194214
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 24.996 Vali Acc: 0.757 Test Loss: 24.996 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.7300846576690674
Epoch: 24, Steps: 17 | Train Loss: 0.495 Vali Loss: 24.972 Vali Acc: 0.775 Test Loss: 24.972 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.7425858974456787
Epoch: 25, Steps: 17 | Train Loss: 1.107 Vali Loss: 44.015 Vali Acc: 0.763 Test Loss: 44.015 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.7276101112365723
Epoch: 26, Steps: 17 | Train Loss: 1.768 Vali Loss: 25.460 Vali Acc: 0.711 Test Loss: 25.460 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 285973063
model size : 1091.86MB
2025-04-28 10:35:57.532231: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:35:57.551486: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745836557.574729 1175417 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745836557.581806 1175417 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:35:57.605234: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.015699625015259
Epoch: 1, Steps: 17 | Train Loss: 2.841 Vali Loss: 9.196 Vali Acc: 0.486 Test Loss: 9.196 Test Acc: 0.486
Validation loss decreased (inf --> -0.485457).  Saving model ...
Epoch: 2 cost time: 5.424511194229126
Epoch: 2, Steps: 17 | Train Loss: 3.979 Vali Loss: 6.665 Vali Acc: 0.601 Test Loss: 6.665 Test Acc: 0.601
Validation loss decreased (-0.485457 --> -0.601089).  Saving model ...
Epoch: 3 cost time: 2.974499225616455
Epoch: 3, Steps: 17 | Train Loss: 1.868 Vali Loss: 12.944 Vali Acc: 0.549 Test Loss: 12.944 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9415650367736816
Epoch: 4, Steps: 17 | Train Loss: 2.379 Vali Loss: 4.832 Vali Acc: 0.717 Test Loss: 4.832 Test Acc: 0.717
Validation loss decreased (-0.601089 --> -0.716715).  Saving model ...
Epoch: 5 cost time: 2.9767091274261475
Epoch: 5, Steps: 17 | Train Loss: 1.872 Vali Loss: 8.949 Vali Acc: 0.728 Test Loss: 8.949 Test Acc: 0.728
Validation loss decreased (-0.716715 --> -0.728234).  Saving model ...
Epoch: 6 cost time: 2.959726572036743
Epoch: 6, Steps: 17 | Train Loss: 0.548 Vali Loss: 6.164 Vali Acc: 0.763 Test Loss: 6.164 Test Acc: 0.763
Validation loss decreased (-0.728234 --> -0.762944).  Saving model ...
Epoch: 7 cost time: 2.9679226875305176
Epoch: 7, Steps: 17 | Train Loss: 1.702 Vali Loss: 22.653 Vali Acc: 0.636 Test Loss: 22.653 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.954371452331543
Epoch: 8, Steps: 17 | Train Loss: 1.931 Vali Loss: 18.532 Vali Acc: 0.659 Test Loss: 18.532 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.949491500854492
Epoch: 9, Steps: 17 | Train Loss: 0.783 Vali Loss: 12.293 Vali Acc: 0.682 Test Loss: 12.293 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.94132399559021
Epoch: 10, Steps: 17 | Train Loss: 0.136 Vali Loss: 21.097 Vali Acc: 0.682 Test Loss: 21.097 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9537768363952637
Epoch: 11, Steps: 17 | Train Loss: 0.468 Vali Loss: 11.732 Vali Acc: 0.740 Test Loss: 11.732 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.946359634399414
Epoch: 12, Steps: 17 | Train Loss: 0.380 Vali Loss: 5.772 Vali Acc: 0.821 Test Loss: 5.772 Test Acc: 0.821
Validation loss decreased (-0.762944 --> -0.820752).  Saving model ...
Epoch: 13 cost time: 5.698925256729126
Epoch: 13, Steps: 17 | Train Loss: 0.432 Vali Loss: 10.962 Vali Acc: 0.798 Test Loss: 10.962 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.95776629447937
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 6.223 Vali Acc: 0.809 Test Loss: 6.223 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.947777271270752
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 8.007 Vali Acc: 0.780 Test Loss: 8.007 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9333579540252686
Epoch: 16, Steps: 17 | Train Loss: 0.241 Vali Loss: 6.782 Vali Acc: 0.832 Test Loss: 6.782 Test Acc: 0.832
Validation loss decreased (-0.820752 --> -0.832302).  Saving model ...
Epoch: 17 cost time: 3.020709753036499
Epoch: 17, Steps: 17 | Train Loss: 0.247 Vali Loss: 10.598 Vali Acc: 0.740 Test Loss: 10.598 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.9168829917907715
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 16.471 Vali Acc: 0.780 Test Loss: 16.471 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.912614107131958
Epoch: 19, Steps: 17 | Train Loss: 0.212 Vali Loss: 6.209 Vali Acc: 0.809 Test Loss: 6.209 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9278550148010254
Epoch: 20, Steps: 17 | Train Loss: 0.322 Vali Loss: 24.497 Vali Acc: 0.740 Test Loss: 24.497 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.91764235496521
Epoch: 21, Steps: 17 | Train Loss: 0.800 Vali Loss: 8.538 Vali Acc: 0.803 Test Loss: 8.538 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9314026832580566
Epoch: 22, Steps: 17 | Train Loss: 0.498 Vali Loss: 15.792 Vali Acc: 0.763 Test Loss: 15.792 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9424824714660645
Epoch: 23, Steps: 17 | Train Loss: 0.484 Vali Loss: 20.306 Vali Acc: 0.636 Test Loss: 20.306 Test Acc: 0.636
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.934826374053955
Epoch: 24, Steps: 17 | Train Loss: 0.570 Vali Loss: 11.186 Vali Acc: 0.815 Test Loss: 11.186 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9310059547424316
Epoch: 25, Steps: 17 | Train Loss: 0.353 Vali Loss: 10.698 Vali Acc: 0.792 Test Loss: 10.698 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9197988510131836
Epoch: 26, Steps: 17 | Train Loss: 0.062 Vali Loss: 10.588 Vali Acc: 0.798 Test Loss: 10.588 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 270442055
model size : 1032.61MB
2025-04-28 10:38:47.226724: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:38:47.245991: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745836727.269484 1187261 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745836727.276519 1187261 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:38:47.299999: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5696237087249756
Epoch: 1, Steps: 17 | Train Loss: 2.810 Vali Loss: 2.284 Vali Acc: 0.624 Test Loss: 2.284 Test Acc: 0.624
Validation loss decreased (inf --> -0.624255).  Saving model ...
Epoch: 2 cost time: 2.4448697566986084
Epoch: 2, Steps: 17 | Train Loss: 4.617 Vali Loss: 4.859 Vali Acc: 0.647 Test Loss: 4.859 Test Acc: 0.647
Validation loss decreased (-0.624255 --> -0.647350).  Saving model ...
Epoch: 3 cost time: 2.4320504665374756
Epoch: 3, Steps: 17 | Train Loss: 0.550 Vali Loss: 6.896 Vali Acc: 0.717 Test Loss: 6.896 Test Acc: 0.717
Validation loss decreased (-0.647350 --> -0.716694).  Saving model ...
Epoch: 4 cost time: 3.9184730052948
Epoch: 4, Steps: 17 | Train Loss: 1.815 Vali Loss: 5.114 Vali Acc: 0.723 Test Loss: 5.114 Test Acc: 0.723
Validation loss decreased (-0.716694 --> -0.722492).  Saving model ...
Epoch: 5 cost time: 2.4516353607177734
Epoch: 5, Steps: 17 | Train Loss: 0.899 Vali Loss: 5.347 Vali Acc: 0.688 Test Loss: 5.347 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4267303943634033
Epoch: 6, Steps: 17 | Train Loss: 1.270 Vali Loss: 6.682 Vali Acc: 0.682 Test Loss: 6.682 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4272689819335938
Epoch: 7, Steps: 17 | Train Loss: 0.322 Vali Loss: 5.611 Vali Acc: 0.763 Test Loss: 5.611 Test Acc: 0.763
Validation loss decreased (-0.722492 --> -0.762950).  Saving model ...
Epoch: 8 cost time: 3.9188644886016846
Epoch: 8, Steps: 17 | Train Loss: 0.378 Vali Loss: 11.832 Vali Acc: 0.595 Test Loss: 11.832 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.421459913253784
Epoch: 9, Steps: 17 | Train Loss: 1.405 Vali Loss: 8.585 Vali Acc: 0.757 Test Loss: 8.585 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4264278411865234
Epoch: 10, Steps: 17 | Train Loss: 0.395 Vali Loss: 6.581 Vali Acc: 0.711 Test Loss: 6.581 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.416050672531128
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 8.208 Vali Acc: 0.740 Test Loss: 8.208 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.445579767227173
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 8.782 Vali Acc: 0.751 Test Loss: 8.782 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4396328926086426
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 10.436 Vali Acc: 0.734 Test Loss: 10.436 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.412994384765625
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 7.449 Vali Acc: 0.728 Test Loss: 7.449 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.4210362434387207
Epoch: 15, Steps: 17 | Train Loss: 0.112 Vali Loss: 7.071 Vali Acc: 0.763 Test Loss: 7.071 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4123213291168213
Epoch: 16, Steps: 17 | Train Loss: 0.455 Vali Loss: 12.720 Vali Acc: 0.671 Test Loss: 12.720 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.427170515060425
Epoch: 17, Steps: 17 | Train Loss: 0.666 Vali Loss: 8.884 Vali Acc: 0.717 Test Loss: 8.884 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 265265159
model size : 1012.86MB
2025-04-28 10:40:35.101362: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:40:35.120836: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745836835.144114 1195061 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745836835.151203 1195061 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:40:35.174454: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5682437419891357
Epoch: 1, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.193 Vali Acc: 0.647 Test Loss: 1.193 Test Acc: 0.647
Validation loss decreased (inf --> -0.647387).  Saving model ...
Epoch: 2 cost time: 2.4018452167510986
Epoch: 2, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.482 Vali Acc: 0.798 Test Loss: 1.482 Test Acc: 0.798
Validation loss decreased (-0.647387 --> -0.797673).  Saving model ...
Epoch: 3 cost time: 2.347679615020752
Epoch: 3, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.532 Vali Acc: 0.751 Test Loss: 2.532 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.353750467300415
Epoch: 4, Steps: 17 | Train Loss: 0.430 Vali Loss: 4.021 Vali Acc: 0.688 Test Loss: 4.021 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.322002410888672
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 5.848 Vali Acc: 0.717 Test Loss: 5.848 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3175461292266846
Epoch: 6, Steps: 17 | Train Loss: 1.098 Vali Loss: 5.205 Vali Acc: 0.780 Test Loss: 5.205 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3370604515075684
Epoch: 7, Steps: 17 | Train Loss: 0.269 Vali Loss: 4.189 Vali Acc: 0.751 Test Loss: 4.189 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3514997959136963
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 4.028 Vali Acc: 0.775 Test Loss: 4.028 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3309175968170166
Epoch: 9, Steps: 17 | Train Loss: 0.248 Vali Loss: 5.941 Vali Acc: 0.723 Test Loss: 5.941 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.334197759628296
Epoch: 10, Steps: 17 | Train Loss: 0.428 Vali Loss: 7.201 Vali Acc: 0.740 Test Loss: 7.201 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.323617935180664
Epoch: 11, Steps: 17 | Train Loss: 0.542 Vali Loss: 4.547 Vali Acc: 0.775 Test Loss: 4.547 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.3381471633911133
Epoch: 12, Steps: 17 | Train Loss: 0.451 Vali Loss: 7.859 Vali Acc: 0.728 Test Loss: 7.859 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 262676871
model size : 1002.99MB
2025-04-28 10:41:49.570158: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:41:49.589232: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745836909.612072 1200618 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745836909.619132 1200618 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:41:49.642395: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5768966674804688
Epoch: 1, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.614 Vali Acc: 0.607 Test Loss: 1.614 Test Acc: 0.607
Validation loss decreased (inf --> -0.606920).  Saving model ...
Epoch: 2 cost time: 2.3791086673736572
Epoch: 2, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.799 Vali Acc: 0.514 Test Loss: 2.799 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.328900098800659
Epoch: 3, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.507 Vali Acc: 0.717 Test Loss: 2.507 Test Acc: 0.717
Validation loss decreased (-0.606920 --> -0.716738).  Saving model ...
Epoch: 4 cost time: 2.373643159866333
Epoch: 4, Steps: 17 | Train Loss: 1.210 Vali Loss: 3.425 Vali Acc: 0.671 Test Loss: 3.425 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3491902351379395
Epoch: 5, Steps: 17 | Train Loss: 0.435 Vali Loss: 3.178 Vali Acc: 0.717 Test Loss: 3.178 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3242440223693848
Epoch: 6, Steps: 17 | Train Loss: 0.055 Vali Loss: 5.407 Vali Acc: 0.763 Test Loss: 5.407 Test Acc: 0.763
Validation loss decreased (-0.716738 --> -0.762952).  Saving model ...
Epoch: 7 cost time: 2.3401260375976562
Epoch: 7, Steps: 17 | Train Loss: 0.617 Vali Loss: 4.805 Vali Acc: 0.751 Test Loss: 4.805 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3224964141845703
Epoch: 8, Steps: 17 | Train Loss: 0.281 Vali Loss: 4.812 Vali Acc: 0.728 Test Loss: 4.812 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3438901901245117
Epoch: 9, Steps: 17 | Train Loss: 0.504 Vali Loss: 5.131 Vali Acc: 0.717 Test Loss: 5.131 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.325875759124756
Epoch: 10, Steps: 17 | Train Loss: 0.468 Vali Loss: 8.973 Vali Acc: 0.694 Test Loss: 8.973 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3443148136138916
Epoch: 11, Steps: 17 | Train Loss: 0.207 Vali Loss: 7.026 Vali Acc: 0.740 Test Loss: 7.026 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3356575965881348
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 6.258 Vali Acc: 0.746 Test Loss: 6.258 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.337982177734375
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 6.191 Vali Acc: 0.688 Test Loss: 6.191 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3200371265411377
Epoch: 14, Steps: 17 | Train Loss: 0.119 Vali Loss: 5.469 Vali Acc: 0.757 Test Loss: 5.469 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.32499361038208
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 3.281 Vali Acc: 0.786 Test Loss: 3.281 Test Acc: 0.786
Validation loss decreased (-0.762952 --> -0.786094).  Saving model ...
Epoch: 16 cost time: 2.3600335121154785
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.381 Vali Acc: 0.792 Test Loss: 4.381 Test Acc: 0.792
Validation loss decreased (-0.786094 --> -0.791864).  Saving model ...
Epoch: 17 cost time: 2.376943826675415
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.057 Vali Acc: 0.786 Test Loss: 4.057 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.355503559112549
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.682 Vali Acc: 0.798 Test Loss: 3.682 Test Acc: 0.798
Validation loss decreased (-0.791864 --> -0.797651).  Saving model ...
Epoch: 19 cost time: 2.3711540699005127
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.798 Test Loss: 3.637 Test Acc: 0.798
Validation loss decreased (-0.797651 --> -0.797651).  Saving model ...
Epoch: 20 cost time: 2.3370349407196045
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.592 Vali Acc: 0.798 Test Loss: 3.592 Test Acc: 0.798
Validation loss decreased (-0.797651 --> -0.797652).  Saving model ...
Epoch: 21 cost time: 2.359496831893921
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.631 Vali Acc: 0.798 Test Loss: 3.631 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3487346172332764
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.614 Vali Acc: 0.798 Test Loss: 3.614 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.346344470977783
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.655 Vali Acc: 0.798 Test Loss: 3.655 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.330186605453491
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.639 Vali Acc: 0.798 Test Loss: 3.639 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.321647882461548
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.622 Vali Acc: 0.798 Test Loss: 3.622 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3482182025909424
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.563 Vali Acc: 0.798 Test Loss: 3.563 Test Acc: 0.798
Validation loss decreased (-0.797652 --> -0.797652).  Saving model ...
Epoch: 27 cost time: 2.369999885559082
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.599 Vali Acc: 0.798 Test Loss: 3.599 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3404245376586914
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.625 Vali Acc: 0.798 Test Loss: 3.625 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.322674036026001
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.581 Vali Acc: 0.798 Test Loss: 3.581 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.3415751457214355
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.601 Vali Acc: 0.798 Test Loss: 3.601 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.366084337234497
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.652 Vali Acc: 0.798 Test Loss: 3.652 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.330872058868408
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.617 Vali Acc: 0.798 Test Loss: 3.617 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.323599100112915
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.610 Vali Acc: 0.798 Test Loss: 3.610 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.332676887512207
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.597 Vali Acc: 0.798 Test Loss: 3.597 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.3348307609558105
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.621 Vali Acc: 0.798 Test Loss: 3.621 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.324028968811035
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.637 Vali Acc: 0.798 Test Loss: 3.637 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 260520199
model size : 994.76MB
2025-04-28 10:45:08.342747: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:45:08.362397: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837108.385641 1216790 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837108.392707 1216790 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:45:08.415819: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.491611957550049
Epoch: 1, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.217 Vali Acc: 0.630 Test Loss: 1.217 Test Acc: 0.630
Validation loss decreased (inf --> -0.630046).  Saving model ...
Epoch: 2 cost time: 2.282893419265747
Epoch: 2, Steps: 17 | Train Loss: 0.279 Vali Loss: 1.178 Vali Acc: 0.769 Test Loss: 1.178 Test Acc: 0.769
Validation loss decreased (-0.630046 --> -0.768774).  Saving model ...
Epoch: 3 cost time: 2.29756760597229
Epoch: 3, Steps: 17 | Train Loss: 0.540 Vali Loss: 2.037 Vali Acc: 0.728 Test Loss: 2.037 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2442331314086914
Epoch: 4, Steps: 17 | Train Loss: 0.906 Vali Loss: 3.281 Vali Acc: 0.734 Test Loss: 3.281 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.260021924972534
Epoch: 5, Steps: 17 | Train Loss: 0.418 Vali Loss: 2.250 Vali Acc: 0.757 Test Loss: 2.250 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2494354248046875
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 4.826 Vali Acc: 0.694 Test Loss: 4.826 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.265549659729004
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 6.849 Vali Acc: 0.514 Test Loss: 6.849 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2452752590179443
Epoch: 8, Steps: 17 | Train Loss: 0.221 Vali Loss: 2.646 Vali Acc: 0.751 Test Loss: 2.646 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.251067876815796
Epoch: 9, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.866 Vali Acc: 0.792 Test Loss: 2.866 Test Acc: 0.792
Validation loss decreased (-0.768774 --> -0.791879).  Saving model ...
Epoch: 10 cost time: 2.2540459632873535
Epoch: 10, Steps: 17 | Train Loss: 0.104 Vali Loss: 3.367 Vali Acc: 0.786 Test Loss: 3.367 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2514591217041016
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 3.243 Vali Acc: 0.815 Test Loss: 3.243 Test Acc: 0.815
Validation loss decreased (-0.791879 --> -0.814996).  Saving model ...
Epoch: 12 cost time: 2.3049824237823486
Epoch: 12, Steps: 17 | Train Loss: 0.892 Vali Loss: 5.292 Vali Acc: 0.740 Test Loss: 5.292 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2442216873168945
Epoch: 13, Steps: 17 | Train Loss: 1.005 Vali Loss: 3.743 Vali Acc: 0.798 Test Loss: 3.743 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.256267547607422
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.689 Vali Acc: 0.792 Test Loss: 2.689 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2473063468933105
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 5.089 Vali Acc: 0.763 Test Loss: 5.089 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2727808952331543
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.953 Vali Acc: 0.815 Test Loss: 2.953 Test Acc: 0.815
Validation loss decreased (-0.814996 --> -0.814999).  Saving model ...
Epoch: 17 cost time: 3.3877625465393066
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 4.712 Vali Acc: 0.827 Test Loss: 4.712 Test Acc: 0.827
Validation loss decreased (-0.814999 --> -0.826542).  Saving model ...
Epoch: 18 cost time: 2.2560720443725586
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 5.780 Vali Acc: 0.786 Test Loss: 5.780 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2603158950805664
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.286 Vali Acc: 0.792 Test Loss: 6.286 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.2347190380096436
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.689 Vali Acc: 0.798 Test Loss: 5.689 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2360646724700928
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.596 Vali Acc: 0.786 Test Loss: 5.596 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.256972312927246
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.604 Vali Acc: 0.786 Test Loss: 5.604 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.261146068572998
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.509 Vali Acc: 0.786 Test Loss: 5.509 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.231948137283325
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.567 Vali Acc: 0.786 Test Loss: 5.567 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.253459930419922
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.548 Vali Acc: 0.786 Test Loss: 5.548 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.2387659549713135
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.535 Vali Acc: 0.786 Test Loss: 5.535 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.2378180027008057
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.522 Vali Acc: 0.786 Test Loss: 5.522 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 258794951
model size : 988.18MB
2025-04-28 10:47:36.782236: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:47:36.802238: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837256.825293 1228961 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837256.832484 1228961 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:47:36.856881: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3762524127960205
Epoch: 1, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.747 Vali Acc: 0.584 Test Loss: 1.747 Test Acc: 0.584
Validation loss decreased (inf --> -0.583798).  Saving model ...
Epoch: 2 cost time: 2.2541139125823975
Epoch: 2, Steps: 17 | Train Loss: 1.885 Vali Loss: 2.614 Vali Acc: 0.682 Test Loss: 2.614 Test Acc: 0.682
Validation loss decreased (-0.583798 --> -0.682055).  Saving model ...
Epoch: 3 cost time: 2.2362539768218994
Epoch: 3, Steps: 17 | Train Loss: 0.782 Vali Loss: 3.112 Vali Acc: 0.665 Test Loss: 3.112 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.209764242172241
Epoch: 4, Steps: 17 | Train Loss: 0.505 Vali Loss: 3.313 Vali Acc: 0.688 Test Loss: 3.313 Test Acc: 0.688
Validation loss decreased (-0.682055 --> -0.687828).  Saving model ...
Epoch: 5 cost time: 2.2354345321655273
Epoch: 5, Steps: 17 | Train Loss: 0.634 Vali Loss: 4.388 Vali Acc: 0.630 Test Loss: 4.388 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1862971782684326
Epoch: 6, Steps: 17 | Train Loss: 0.607 Vali Loss: 3.227 Vali Acc: 0.717 Test Loss: 3.227 Test Acc: 0.717
Validation loss decreased (-0.687828 --> -0.716731).  Saving model ...
Epoch: 7 cost time: 2.2532460689544678
Epoch: 7, Steps: 17 | Train Loss: 0.264 Vali Loss: 2.638 Vali Acc: 0.734 Test Loss: 2.638 Test Acc: 0.734
Validation loss decreased (-0.716731 --> -0.734078).  Saving model ...
Epoch: 8 cost time: 2.2244937419891357
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 3.323 Vali Acc: 0.723 Test Loss: 3.323 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.223722219467163
Epoch: 9, Steps: 17 | Train Loss: 0.403 Vali Loss: 2.214 Vali Acc: 0.786 Test Loss: 2.214 Test Acc: 0.786
Validation loss decreased (-0.734078 --> -0.786105).  Saving model ...
Epoch: 10 cost time: 2.2180681228637695
Epoch: 10, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.751 Vali Acc: 0.728 Test Loss: 2.751 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.198817491531372
Epoch: 11, Steps: 17 | Train Loss: 0.067 Vali Loss: 5.063 Vali Acc: 0.723 Test Loss: 5.063 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2263262271881104
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.024 Vali Acc: 0.734 Test Loss: 3.024 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.207441806793213
Epoch: 13, Steps: 17 | Train Loss: 0.086 Vali Loss: 3.647 Vali Acc: 0.734 Test Loss: 3.647 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.197934150695801
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 5.728 Vali Acc: 0.717 Test Loss: 5.728 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2046570777893066
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 5.264 Vali Acc: 0.763 Test Loss: 5.264 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.199726104736328
Epoch: 16, Steps: 17 | Train Loss: 0.210 Vali Loss: 4.325 Vali Acc: 0.757 Test Loss: 4.325 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.200862407684326
Epoch: 17, Steps: 17 | Train Loss: 0.076 Vali Loss: 4.306 Vali Acc: 0.751 Test Loss: 4.306 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2084250450134277
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 4.403 Vali Acc: 0.757 Test Loss: 4.403 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.209019422531128
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.459 Vali Acc: 0.798 Test Loss: 4.459 Test Acc: 0.798
Validation loss decreased (-0.786105 --> -0.797643).  Saving model ...
Epoch: 20 cost time: 2.2415385246276855
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.546 Vali Acc: 0.809 Test Loss: 4.546 Test Acc: 0.809
Validation loss decreased (-0.797643 --> -0.809203).  Saving model ...
Epoch: 21 cost time: 2.2464685440063477
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.564 Vali Acc: 0.803 Test Loss: 4.564 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1923325061798096
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.541 Vali Acc: 0.803 Test Loss: 4.541 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2063121795654297
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.577 Vali Acc: 0.803 Test Loss: 4.577 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2104084491729736
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.626 Vali Acc: 0.803 Test Loss: 4.626 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.190171480178833
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.549 Vali Acc: 0.803 Test Loss: 4.549 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2111525535583496
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.575 Vali Acc: 0.803 Test Loss: 4.575 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2204396724700928
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.595 Vali Acc: 0.803 Test Loss: 4.595 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.2062644958496094
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.591 Vali Acc: 0.803 Test Loss: 4.591 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.20399808883667
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.566 Vali Acc: 0.803 Test Loss: 4.566 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.2046306133270264
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.583 Vali Acc: 0.803 Test Loss: 4.583 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 258363975
model size : 986.53MB
2025-04-28 10:50:18.114634: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:50:18.133882: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837418.157203 1242446 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837418.164300 1242446 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:50:18.187691: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.647646903991699
Epoch: 1, Steps: 17 | Train Loss: 5.750 Vali Loss: 7.567 Vali Acc: 0.457 Test Loss: 7.567 Test Acc: 0.457
Validation loss decreased (inf --> -0.456572).  Saving model ...
Epoch: 2 cost time: 2.417874336242676
Epoch: 2, Steps: 17 | Train Loss: 3.986 Vali Loss: 10.025 Vali Acc: 0.549 Test Loss: 10.025 Test Acc: 0.549
Validation loss decreased (-0.456572 --> -0.549033).  Saving model ...
Epoch: 3 cost time: 2.4501872062683105
Epoch: 3, Steps: 17 | Train Loss: 4.145 Vali Loss: 6.691 Vali Acc: 0.757 Test Loss: 6.691 Test Acc: 0.757
Validation loss decreased (-0.549033 --> -0.757159).  Saving model ...
Epoch: 4 cost time: 2.425509214401245
Epoch: 4, Steps: 17 | Train Loss: 2.440 Vali Loss: 9.608 Vali Acc: 0.665 Test Loss: 9.608 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4058895111083984
Epoch: 5, Steps: 17 | Train Loss: 0.781 Vali Loss: 11.328 Vali Acc: 0.630 Test Loss: 11.328 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4194438457489014
Epoch: 6, Steps: 17 | Train Loss: 1.109 Vali Loss: 7.706 Vali Acc: 0.659 Test Loss: 7.706 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.40122127532959
Epoch: 7, Steps: 17 | Train Loss: 1.835 Vali Loss: 8.660 Vali Acc: 0.671 Test Loss: 8.660 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.432767629623413
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 5.703 Vali Acc: 0.723 Test Loss: 5.703 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.395667791366577
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 8.185 Vali Acc: 0.740 Test Loss: 8.185 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.399837017059326
Epoch: 10, Steps: 17 | Train Loss: 0.235 Vali Loss: 12.134 Vali Acc: 0.671 Test Loss: 12.134 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4033331871032715
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 12.727 Vali Acc: 0.711 Test Loss: 12.727 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.399508237838745
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 10.363 Vali Acc: 0.711 Test Loss: 10.363 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3949837684631348
Epoch: 13, Steps: 17 | Train Loss: 0.048 Vali Loss: 7.111 Vali Acc: 0.775 Test Loss: 7.111 Test Acc: 0.775
Validation loss decreased (-0.757159 --> -0.774495).  Saving model ...
Epoch: 14 cost time: 2.423337697982788
Epoch: 14, Steps: 17 | Train Loss: 0.321 Vali Loss: 8.167 Vali Acc: 0.705 Test Loss: 8.167 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.388197660446167
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 8.380 Vali Acc: 0.734 Test Loss: 8.380 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.40378737449646
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 16.404 Vali Acc: 0.699 Test Loss: 16.404 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3974246978759766
Epoch: 17, Steps: 17 | Train Loss: 0.118 Vali Loss: 7.511 Vali Acc: 0.734 Test Loss: 7.511 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.405665397644043
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.997 Vali Acc: 0.723 Test Loss: 6.997 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4139363765716553
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.986 Vali Acc: 0.723 Test Loss: 6.986 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4243528842926025
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.962 Vali Acc: 0.723 Test Loss: 6.962 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.400296449661255
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.937 Vali Acc: 0.723 Test Loss: 6.937 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.398834228515625
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 7.039 Vali Acc: 0.723 Test Loss: 7.039 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.4226038455963135
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 7.005 Vali Acc: 0.723 Test Loss: 7.005 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 139042087
model size : 530.89MB
2025-04-28 10:52:21.152426: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:52:21.171521: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837541.193957 1252813 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837541.200940 1252813 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:52:21.224007: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.152233123779297
Epoch: 1, Steps: 17 | Train Loss: 2.188 Vali Loss: 1.910 Vali Acc: 0.624 Test Loss: 1.910 Test Acc: 0.624
Validation loss decreased (inf --> -0.624258).  Saving model ...
Epoch: 2 cost time: 1.9094135761260986
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 3.240 Vali Acc: 0.630 Test Loss: 3.240 Test Acc: 0.630
Validation loss decreased (-0.624258 --> -0.630025).  Saving model ...
Epoch: 3 cost time: 1.9293510913848877
Epoch: 3, Steps: 17 | Train Loss: 0.732 Vali Loss: 3.128 Vali Acc: 0.676 Test Loss: 3.128 Test Acc: 0.676
Validation loss decreased (-0.630025 --> -0.676269).  Saving model ...
Epoch: 4 cost time: 1.9464647769927979
Epoch: 4, Steps: 17 | Train Loss: 0.636 Vali Loss: 4.704 Vali Acc: 0.694 Test Loss: 4.704 Test Acc: 0.694
Validation loss decreased (-0.676269 --> -0.693595).  Saving model ...
Epoch: 5 cost time: 1.92942214012146
Epoch: 5, Steps: 17 | Train Loss: 0.745 Vali Loss: 4.071 Vali Acc: 0.723 Test Loss: 4.071 Test Acc: 0.723
Validation loss decreased (-0.693595 --> -0.722503).  Saving model ...
Epoch: 6 cost time: 1.9417083263397217
Epoch: 6, Steps: 17 | Train Loss: 2.115 Vali Loss: 4.623 Vali Acc: 0.728 Test Loss: 4.623 Test Acc: 0.728
Validation loss decreased (-0.722503 --> -0.728277).  Saving model ...
Epoch: 7 cost time: 1.9162697792053223
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 6.719 Vali Acc: 0.653 Test Loss: 6.719 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.909682273864746
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 5.596 Vali Acc: 0.763 Test Loss: 5.596 Test Acc: 0.763
Validation loss decreased (-0.728277 --> -0.762950).  Saving model ...
Epoch: 9 cost time: 1.934497356414795
Epoch: 9, Steps: 17 | Train Loss: 0.559 Vali Loss: 7.727 Vali Acc: 0.694 Test Loss: 7.727 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.331327199935913
Epoch: 10, Steps: 17 | Train Loss: 0.212 Vali Loss: 6.950 Vali Acc: 0.746 Test Loss: 6.950 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.914982795715332
Epoch: 11, Steps: 17 | Train Loss: 0.109 Vali Loss: 6.245 Vali Acc: 0.740 Test Loss: 6.245 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9248285293579102
Epoch: 12, Steps: 17 | Train Loss: 0.194 Vali Loss: 7.594 Vali Acc: 0.723 Test Loss: 7.594 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9247057437896729
Epoch: 13, Steps: 17 | Train Loss: 0.302 Vali Loss: 9.359 Vali Acc: 0.688 Test Loss: 9.359 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9275686740875244
Epoch: 14, Steps: 17 | Train Loss: 0.142 Vali Loss: 5.063 Vali Acc: 0.798 Test Loss: 5.063 Test Acc: 0.798
Validation loss decreased (-0.762950 --> -0.797637).  Saving model ...
Epoch: 15 cost time: 1.9108102321624756
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 3.569 Vali Acc: 0.763 Test Loss: 3.569 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9140753746032715
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 4.520 Vali Acc: 0.775 Test Loss: 4.520 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9351792335510254
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 7.781 Vali Acc: 0.751 Test Loss: 7.781 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9171781539916992
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 13.429 Vali Acc: 0.682 Test Loss: 13.429 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9016096591949463
Epoch: 19, Steps: 17 | Train Loss: 0.420 Vali Loss: 7.855 Vali Acc: 0.711 Test Loss: 7.855 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9279141426086426
Epoch: 20, Steps: 17 | Train Loss: 0.186 Vali Loss: 5.946 Vali Acc: 0.740 Test Loss: 5.946 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9193453788757324
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 7.104 Vali Acc: 0.694 Test Loss: 7.104 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.920792818069458
Epoch: 22, Steps: 17 | Train Loss: 0.097 Vali Loss: 12.265 Vali Acc: 0.699 Test Loss: 12.265 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9319453239440918
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 10.194 Vali Acc: 0.688 Test Loss: 10.194 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9189212322235107
Epoch: 24, Steps: 17 | Train Loss: 0.116 Vali Loss: 12.502 Vali Acc: 0.699 Test Loss: 12.502 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 131276583
model size : 501.26MB
2025-04-28 10:54:12.897544: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:54:12.916735: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837652.939851 1263554 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837652.946894 1263554 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:54:12.970078: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.936155319213867
Epoch: 1, Steps: 17 | Train Loss: 2.001 Vali Loss: 2.007 Vali Acc: 0.503 Test Loss: 2.007 Test Acc: 0.503
Validation loss decreased (inf --> -0.502870).  Saving model ...
Epoch: 2 cost time: 1.7614026069641113
Epoch: 2, Steps: 17 | Train Loss: 0.509 Vali Loss: 2.135 Vali Acc: 0.671 Test Loss: 2.135 Test Acc: 0.671
Validation loss decreased (-0.502870 --> -0.670499).  Saving model ...
Epoch: 3 cost time: 1.740377426147461
Epoch: 3, Steps: 17 | Train Loss: 0.690 Vali Loss: 1.666 Vali Acc: 0.751 Test Loss: 1.666 Test Acc: 0.751
Validation loss decreased (-0.670499 --> -0.751428).  Saving model ...
Epoch: 4 cost time: 1.7498698234558105
Epoch: 4, Steps: 17 | Train Loss: 0.621 Vali Loss: 3.256 Vali Acc: 0.740 Test Loss: 3.256 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7276067733764648
Epoch: 5, Steps: 17 | Train Loss: 1.165 Vali Loss: 5.062 Vali Acc: 0.734 Test Loss: 5.062 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7159028053283691
Epoch: 6, Steps: 17 | Train Loss: 0.878 Vali Loss: 3.158 Vali Acc: 0.780 Test Loss: 3.158 Test Acc: 0.780
Validation loss decreased (-0.751428 --> -0.780315).  Saving model ...
Epoch: 7 cost time: 1.75126051902771
Epoch: 7, Steps: 17 | Train Loss: 0.207 Vali Loss: 2.223 Vali Acc: 0.809 Test Loss: 2.223 Test Acc: 0.809
Validation loss decreased (-0.780315 --> -0.809226).  Saving model ...
Epoch: 8 cost time: 1.7253944873809814
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 2.530 Vali Acc: 0.769 Test Loss: 2.530 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7265467643737793
Epoch: 9, Steps: 17 | Train Loss: 0.152 Vali Loss: 2.379 Vali Acc: 0.763 Test Loss: 2.379 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7374587059020996
Epoch: 10, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.255 Vali Acc: 0.775 Test Loss: 2.255 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.734255313873291
Epoch: 11, Steps: 17 | Train Loss: 0.078 Vali Loss: 4.300 Vali Acc: 0.734 Test Loss: 4.300 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7373476028442383
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 3.102 Vali Acc: 0.786 Test Loss: 3.102 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7217814922332764
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 3.797 Vali Acc: 0.786 Test Loss: 3.797 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7170042991638184
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 3.240 Vali Acc: 0.763 Test Loss: 3.240 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7483689785003662
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 2.279 Vali Acc: 0.792 Test Loss: 2.279 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7288401126861572
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 3.744 Vali Acc: 0.751 Test Loss: 3.744 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.740584373474121
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 6.226 Vali Acc: 0.740 Test Loss: 6.226 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 128688135
model size : 491.39MB
2025-04-28 10:55:32.004490: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:55:32.023747: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837732.046897 1271209 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837732.053973 1271209 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:55:32.078190: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.868401050567627
Epoch: 1, Steps: 17 | Train Loss: 1.688 Vali Loss: 1.193 Vali Acc: 0.682 Test Loss: 1.193 Test Acc: 0.682
Validation loss decreased (inf --> -0.682069).  Saving model ...
Epoch: 2 cost time: 1.7053396701812744
Epoch: 2, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.555 Vali Acc: 0.699 Test Loss: 1.555 Test Acc: 0.699
Validation loss decreased (-0.682069 --> -0.699406).  Saving model ...
Epoch: 3 cost time: 1.7040987014770508
Epoch: 3, Steps: 17 | Train Loss: 0.415 Vali Loss: 2.111 Vali Acc: 0.653 Test Loss: 2.111 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7011973857879639
Epoch: 4, Steps: 17 | Train Loss: 1.218 Vali Loss: 4.568 Vali Acc: 0.561 Test Loss: 4.568 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6773197650909424
Epoch: 5, Steps: 17 | Train Loss: 0.514 Vali Loss: 2.722 Vali Acc: 0.769 Test Loss: 2.722 Test Acc: 0.769
Validation loss decreased (-0.699406 --> -0.768759).  Saving model ...
Epoch: 6 cost time: 1.6848056316375732
Epoch: 6, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.602 Vali Acc: 0.821 Test Loss: 1.602 Test Acc: 0.821
Validation loss decreased (-0.768759 --> -0.820793).  Saving model ...
Epoch: 7 cost time: 1.7057600021362305
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.730 Vali Acc: 0.740 Test Loss: 2.730 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6955270767211914
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.188 Vali Acc: 0.763 Test Loss: 2.188 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6943092346191406
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 2.748 Vali Acc: 0.775 Test Loss: 2.748 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6965513229370117
Epoch: 10, Steps: 17 | Train Loss: 0.194 Vali Loss: 2.687 Vali Acc: 0.769 Test Loss: 2.687 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7021806240081787
Epoch: 11, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.474 Vali Acc: 0.757 Test Loss: 3.474 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6755626201629639
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 2.827 Vali Acc: 0.769 Test Loss: 2.827 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7009055614471436
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.338 Vali Acc: 0.798 Test Loss: 2.338 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6698188781738281
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.562 Vali Acc: 0.798 Test Loss: 2.562 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6895956993103027
Epoch: 15, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.300 Vali Acc: 0.803 Test Loss: 2.300 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6855204105377197
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 5.162 Vali Acc: 0.676 Test Loss: 5.162 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 127393991
model size : 486.45MB
2025-04-28 10:56:43.518354: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:56:43.537884: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837803.561194 1278419 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837803.568244 1278419 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:56:43.591802: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9503533840179443
Epoch: 1, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.257 Vali Acc: 0.538 Test Loss: 1.257 Test Acc: 0.538
Validation loss decreased (inf --> -0.537560).  Saving model ...
Epoch: 2 cost time: 1.6878185272216797
Epoch: 2, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.751 Vali Acc: 0.780 Test Loss: 0.751 Test Acc: 0.780
Validation loss decreased (-0.537560 --> -0.780339).  Saving model ...
Epoch: 3 cost time: 1.655142068862915
Epoch: 3, Steps: 17 | Train Loss: 0.355 Vali Loss: 2.295 Vali Acc: 0.705 Test Loss: 2.295 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6768109798431396
Epoch: 4, Steps: 17 | Train Loss: 0.259 Vali Loss: 2.059 Vali Acc: 0.746 Test Loss: 2.059 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6730201244354248
Epoch: 5, Steps: 17 | Train Loss: 0.471 Vali Loss: 1.950 Vali Acc: 0.705 Test Loss: 1.950 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.653552532196045
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.922 Vali Acc: 0.815 Test Loss: 0.922 Test Acc: 0.815
Validation loss decreased (-0.780339 --> -0.815020).  Saving model ...
Epoch: 7 cost time: 1.6760201454162598
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.366 Vali Acc: 0.803 Test Loss: 1.366 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6634423732757568
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.617 Vali Acc: 0.809 Test Loss: 1.617 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6987981796264648
Epoch: 9, Steps: 17 | Train Loss: 0.106 Vali Loss: 2.010 Vali Acc: 0.775 Test Loss: 2.010 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.651968240737915
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 3.771 Vali Acc: 0.653 Test Loss: 3.771 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.682232141494751
Epoch: 11, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.603 Vali Acc: 0.740 Test Loss: 2.603 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6967670917510986
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.860 Vali Acc: 0.746 Test Loss: 3.860 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6875290870666504
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 3.090 Vali Acc: 0.705 Test Loss: 3.090 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6748206615447998
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 3.270 Vali Acc: 0.723 Test Loss: 3.270 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6650152206420898
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.457 Vali Acc: 0.763 Test Loss: 2.457 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6699440479278564
Epoch: 16, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.392 Vali Acc: 0.757 Test Loss: 2.392 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 126315655
model size : 482.34MB
2025-04-28 10:57:53.588936: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:57:53.609002: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837873.632464 1285623 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837873.639620 1285623 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:57:53.663464: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.850019931793213
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 0.921 Vali Acc: 0.653 Test Loss: 0.921 Test Acc: 0.653
Validation loss decreased (inf --> -0.653170).  Saving model ...
Epoch: 2 cost time: 1.5976324081420898
Epoch: 2, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.914 Vali Acc: 0.746 Test Loss: 0.914 Test Acc: 0.746
Validation loss decreased (-0.653170 --> -0.745656).  Saving model ...
Epoch: 3 cost time: 1.6461496353149414
Epoch: 3, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.172 Vali Acc: 0.659 Test Loss: 2.172 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6048460006713867
Epoch: 4, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.028 Vali Acc: 0.815 Test Loss: 1.028 Test Acc: 0.815
Validation loss decreased (-0.745656 --> -0.815019).  Saving model ...
Epoch: 5 cost time: 1.606806755065918
Epoch: 5, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.015 Vali Acc: 0.803 Test Loss: 1.015 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5957973003387451
Epoch: 6, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.173 Vali Acc: 0.746 Test Loss: 1.173 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6167871952056885
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.903 Vali Acc: 0.798 Test Loss: 0.903 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6032447814941406
Epoch: 8, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.736 Vali Acc: 0.803 Test Loss: 1.736 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6047122478485107
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.206 Vali Acc: 0.786 Test Loss: 2.206 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6008143424987793
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 2.628 Vali Acc: 0.751 Test Loss: 2.628 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6257281303405762
Epoch: 11, Steps: 17 | Train Loss: 0.155 Vali Loss: 2.245 Vali Acc: 0.728 Test Loss: 2.245 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6064121723175049
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 2.714 Vali Acc: 0.786 Test Loss: 2.714 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6113078594207764
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 4.553 Vali Acc: 0.682 Test Loss: 4.553 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6144258975982666
Epoch: 14, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.282 Vali Acc: 0.775 Test Loss: 2.282 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 125453031
model size : 479.05MB
2025-04-28 10:58:56.139917: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 10:58:56.160341: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745837936.183842 1291955 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745837936.190876 1291955 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 10:58:56.214806: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7741427421569824
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 0.922 Vali Acc: 0.671 Test Loss: 0.922 Test Acc: 0.671
Validation loss decreased (inf --> -0.670511).  Saving model ...
Epoch: 2 cost time: 1.6030242443084717
Epoch: 2, Steps: 17 | Train Loss: 0.427 Vali Loss: 1.371 Vali Acc: 0.694 Test Loss: 1.371 Test Acc: 0.694
Validation loss decreased (-0.670511 --> -0.693628).  Saving model ...
Epoch: 3 cost time: 1.6778550148010254
Epoch: 3, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.822 Vali Acc: 0.792 Test Loss: 0.822 Test Acc: 0.792
Validation loss decreased (-0.693628 --> -0.791899).  Saving model ...
Epoch: 4 cost time: 1.631242036819458
Epoch: 4, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.368 Vali Acc: 0.786 Test Loss: 1.368 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.610891342163086
Epoch: 5, Steps: 17 | Train Loss: 0.034 Vali Loss: 2.111 Vali Acc: 0.723 Test Loss: 2.111 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6327519416809082
Epoch: 6, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.941 Vali Acc: 0.711 Test Loss: 1.941 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6132957935333252
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.552 Vali Acc: 0.751 Test Loss: 2.552 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.586705207824707
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.843 Vali Acc: 0.728 Test Loss: 2.843 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5812556743621826
Epoch: 9, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.616 Vali Acc: 0.786 Test Loss: 1.616 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.601722002029419
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.803 Test Loss: 1.633 Test Acc: 0.803
Validation loss decreased (-0.791899 --> -0.803452).  Saving model ...
Epoch: 11 cost time: 1.6346094608306885
Epoch: 11, Steps: 17 | Train Loss: 0.034 Vali Loss: 2.203 Vali Acc: 0.792 Test Loss: 2.203 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5958127975463867
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.294 Vali Acc: 0.803 Test Loss: 2.294 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5743680000305176
Epoch: 13, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.891 Vali Acc: 0.792 Test Loss: 1.891 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5726795196533203
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.505 Vali Acc: 0.740 Test Loss: 2.505 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5945696830749512
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 2.074 Vali Acc: 0.780 Test Loss: 2.074 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.572932481765747
Epoch: 16, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.000 Vali Acc: 0.786 Test Loss: 2.000 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5789034366607666
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 2.763 Vali Acc: 0.723 Test Loss: 2.763 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5737872123718262
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 3.894 Vali Acc: 0.671 Test Loss: 3.894 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6030690670013428
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 3.139 Vali Acc: 0.769 Test Loss: 3.139 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5891764163970947
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.558 Vali Acc: 0.786 Test Loss: 3.558 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 125237543
model size : 478.23MB
2025-04-28 11:00:17.240589: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:00:17.260360: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745838017.284429 1300887 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745838017.291534 1300887 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:00:17.315567: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.919603586196899
Epoch: 1, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.944 Vali Acc: 0.572 Test Loss: 1.944 Test Acc: 0.572
Validation loss decreased (inf --> -0.572235).  Saving model ...
Epoch: 2 cost time: 5.633866786956787
Epoch: 2, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.268 Vali Acc: 0.746 Test Loss: 2.268 Test Acc: 0.746
Validation loss decreased (-0.572235 --> -0.745642).  Saving model ...
Epoch: 3 cost time: 5.619850158691406
Epoch: 3, Steps: 17 | Train Loss: 0.116 Vali Loss: 2.628 Vali Acc: 0.717 Test Loss: 2.628 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.579180717468262
Epoch: 4, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.324 Vali Acc: 0.740 Test Loss: 1.324 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.590479373931885
Epoch: 5, Steps: 17 | Train Loss: 0.093 Vali Loss: 5.123 Vali Acc: 0.572 Test Loss: 5.123 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.587573051452637
Epoch: 6, Steps: 17 | Train Loss: 0.112 Vali Loss: 3.704 Vali Acc: 0.723 Test Loss: 3.704 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.5935492515563965
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 3.101 Vali Acc: 0.746 Test Loss: 3.101 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.572742700576782
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 4.856 Vali Acc: 0.699 Test Loss: 4.856 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.6063337326049805
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 5.518 Vali Acc: 0.734 Test Loss: 5.518 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.582585096359253
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 6.917 Vali Acc: 0.613 Test Loss: 6.917 Test Acc: 0.613
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.581948757171631
Epoch: 11, Steps: 17 | Train Loss: 0.219 Vali Loss: 4.045 Vali Acc: 0.728 Test Loss: 4.045 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.608954191207886
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 4.166 Vali Acc: 0.769 Test Loss: 4.166 Test Acc: 0.769
Validation loss decreased (-0.745642 --> -0.768744).  Saving model ...
Epoch: 13 cost time: 5.661257266998291
Epoch: 13, Steps: 17 | Train Loss: 0.399 Vali Loss: 12.763 Vali Acc: 0.624 Test Loss: 12.763 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.576831102371216
Epoch: 14, Steps: 17 | Train Loss: 0.834 Vali Loss: 14.481 Vali Acc: 0.601 Test Loss: 14.481 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.5763139724731445
Epoch: 15, Steps: 17 | Train Loss: 0.575 Vali Loss: 5.783 Vali Acc: 0.751 Test Loss: 5.783 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.601379871368408
Epoch: 16, Steps: 17 | Train Loss: 0.514 Vali Loss: 12.073 Vali Acc: 0.682 Test Loss: 12.073 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.588882207870483
Epoch: 17, Steps: 17 | Train Loss: 1.091 Vali Loss: 6.044 Vali Acc: 0.775 Test Loss: 6.044 Test Acc: 0.775
Validation loss decreased (-0.768744 --> -0.774506).  Saving model ...
Epoch: 18 cost time: 5.623669385910034
Epoch: 18, Steps: 17 | Train Loss: 0.047 Vali Loss: 11.135 Vali Acc: 0.682 Test Loss: 11.135 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.606796026229858
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 6.991 Vali Acc: 0.763 Test Loss: 6.991 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.574842691421509
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 10.199 Vali Acc: 0.728 Test Loss: 10.199 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.588395118713379
Epoch: 21, Steps: 17 | Train Loss: 0.441 Vali Loss: 7.909 Vali Acc: 0.734 Test Loss: 7.909 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.577398777008057
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 10.510 Vali Acc: 0.723 Test Loss: 10.510 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.587236642837524
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 12.946 Vali Acc: 0.728 Test Loss: 12.946 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.593212842941284
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 9.108 Vali Acc: 0.717 Test Loss: 9.108 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.589637041091919
Epoch: 25, Steps: 17 | Train Loss: 0.116 Vali Loss: 9.445 Vali Acc: 0.723 Test Loss: 9.445 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.608933687210083
Epoch: 26, Steps: 17 | Train Loss: 0.095 Vali Loss: 10.753 Vali Acc: 0.740 Test Loss: 10.753 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.637224197387695
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 8.629 Vali Acc: 0.740 Test Loss: 8.629 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 478039335
model size : 1826.91MB
2025-04-28 11:04:40.673077: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:04:40.692288: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745838280.714711 1313503 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745838280.721827 1313503 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:04:40.745471: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.9644975662231445
Epoch: 1, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.250 Vali Acc: 0.480 Test Loss: 1.250 Test Acc: 0.480
Validation loss decreased (inf --> -0.479756).  Saving model ...
Epoch: 2 cost time: 4.719077825546265
Epoch: 2, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.339 Vali Acc: 0.653 Test Loss: 1.339 Test Acc: 0.653
Validation loss decreased (-0.479756 --> -0.653166).  Saving model ...
Epoch: 3 cost time: 4.734710931777954
Epoch: 3, Steps: 17 | Train Loss: 0.163 Vali Loss: 1.904 Vali Acc: 0.717 Test Loss: 1.904 Test Acc: 0.717
Validation loss decreased (-0.653166 --> -0.716744).  Saving model ...
Epoch: 4 cost time: 4.688404083251953
Epoch: 4, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.058 Vali Acc: 0.757 Test Loss: 2.058 Test Acc: 0.757
Validation loss decreased (-0.716744 --> -0.757205).  Saving model ...
Epoch: 5 cost time: 4.7201666831970215
Epoch: 5, Steps: 17 | Train Loss: 0.159 Vali Loss: 2.810 Vali Acc: 0.601 Test Loss: 2.810 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.6927900314331055
Epoch: 6, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.599 Vali Acc: 0.682 Test Loss: 2.599 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.647188425064087
Epoch: 7, Steps: 17 | Train Loss: 0.190 Vali Loss: 3.121 Vali Acc: 0.711 Test Loss: 3.121 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.648359775543213
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.868 Vali Acc: 0.746 Test Loss: 2.868 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.672198534011841
Epoch: 9, Steps: 17 | Train Loss: 0.100 Vali Loss: 3.396 Vali Acc: 0.769 Test Loss: 3.396 Test Acc: 0.769
Validation loss decreased (-0.757205 --> -0.768752).  Saving model ...
Epoch: 10 cost time: 4.705001592636108
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 2.906 Vali Acc: 0.751 Test Loss: 2.906 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.6872758865356445
Epoch: 11, Steps: 17 | Train Loss: 0.135 Vali Loss: 2.051 Vali Acc: 0.751 Test Loss: 2.051 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.666075944900513
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.873 Vali Acc: 0.803 Test Loss: 2.873 Test Acc: 0.803
Validation loss decreased (-0.768752 --> -0.803439).  Saving model ...
Epoch: 13 cost time: 4.689728498458862
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.781 Vali Acc: 0.775 Test Loss: 2.781 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.644189834594727
Epoch: 14, Steps: 17 | Train Loss: 0.346 Vali Loss: 5.646 Vali Acc: 0.723 Test Loss: 5.646 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.685840606689453
Epoch: 15, Steps: 17 | Train Loss: 0.814 Vali Loss: 10.986 Vali Acc: 0.538 Test Loss: 10.986 Test Acc: 0.538
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.669840335845947
Epoch: 16, Steps: 17 | Train Loss: 0.160 Vali Loss: 3.728 Vali Acc: 0.798 Test Loss: 3.728 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.668265104293823
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 10.762 Vali Acc: 0.740 Test Loss: 10.762 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.668930530548096
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 5.539 Vali Acc: 0.763 Test Loss: 5.539 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.662014007568359
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 4.929 Vali Acc: 0.763 Test Loss: 4.929 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.666404724121094
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 16.125 Vali Acc: 0.723 Test Loss: 16.125 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.653085947036743
Epoch: 21, Steps: 17 | Train Loss: 0.261 Vali Loss: 12.412 Vali Acc: 0.763 Test Loss: 12.412 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.654375791549683
Epoch: 22, Steps: 17 | Train Loss: 0.087 Vali Loss: 19.622 Vali Acc: 0.723 Test Loss: 19.622 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 470273831
model size : 1797.28MB
2025-04-28 11:07:59.904610: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:07:59.923893: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745838479.946831 1323750 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745838479.953931 1323750 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:07:59.977618: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.931612491607666
Epoch: 1, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.034 Vali Acc: 0.532 Test Loss: 1.034 Test Acc: 0.532
Validation loss decreased (inf --> -0.531782).  Saving model ...
Epoch: 2 cost time: 4.65090799331665
Epoch: 2, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.725 Vali Acc: 0.786 Test Loss: 0.725 Test Acc: 0.786
Validation loss decreased (-0.531782 --> -0.786120).  Saving model ...
Epoch: 3 cost time: 4.651310205459595
Epoch: 3, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.838 Vali Acc: 0.740 Test Loss: 1.838 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.595965385437012
Epoch: 4, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.579 Vali Acc: 0.769 Test Loss: 1.579 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.610860824584961
Epoch: 5, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.821 Test Loss: 1.297 Test Acc: 0.821
Validation loss decreased (-0.786120 --> -0.820796).  Saving model ...
Epoch: 6 cost time: 4.631312847137451
Epoch: 6, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.215 Vali Acc: 0.821 Test Loss: 1.215 Test Acc: 0.821
Validation loss decreased (-0.820796 --> -0.820797).  Saving model ...
Epoch: 7 cost time: 4.633000373840332
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.214 Vali Acc: 0.815 Test Loss: 1.214 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.639874458312988
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.206 Vali Acc: 0.815 Test Loss: 1.206 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6536455154418945
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.815 Test Loss: 1.198 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.636049509048462
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.192 Vali Acc: 0.815 Test Loss: 1.192 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.62387490272522
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.821 Test Loss: 1.175 Test Acc: 0.821
Validation loss decreased (-0.820797 --> -0.820798).  Saving model ...
Epoch: 12 cost time: 4.640415906906128
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.193 Vali Acc: 0.815 Test Loss: 1.193 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.606813669204712
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.190 Vali Acc: 0.815 Test Loss: 1.190 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.629871845245361
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.815 Test Loss: 1.183 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.646146535873413
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.815 Test Loss: 1.161 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.617937088012695
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.815 Test Loss: 1.141 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.625681400299072
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.168 Vali Acc: 0.815 Test Loss: 1.168 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.619757413864136
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.172 Vali Acc: 0.815 Test Loss: 1.172 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.612016439437866
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.162 Vali Acc: 0.815 Test Loss: 1.162 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.612394332885742
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.815 Test Loss: 1.153 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.617730617523193
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.815 Test Loss: 1.161 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 467685383
model size : 1787.41MB
2025-04-28 11:11:12.571123: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:11:12.591063: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745838672.614679 1333553 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745838672.621753 1333553 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:11:12.645316: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.845637083053589
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 0.860 Vali Acc: 0.705 Test Loss: 0.860 Test Acc: 0.705
Validation loss decreased (inf --> -0.705194).  Saving model ...
Epoch: 2 cost time: 4.5786192417144775
Epoch: 2, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.751 Vali Acc: 0.809 Test Loss: 0.751 Test Acc: 0.809
Validation loss decreased (-0.705194 --> -0.809241).  Saving model ...
Epoch: 3 cost time: 4.559354782104492
Epoch: 3, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.898 Vali Acc: 0.792 Test Loss: 0.898 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.570760011672974
Epoch: 4, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.111 Vali Acc: 0.763 Test Loss: 1.111 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.521109342575073
Epoch: 5, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.932 Vali Acc: 0.798 Test Loss: 0.932 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.5056703090667725
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.931 Vali Acc: 0.780 Test Loss: 0.931 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.498268127441406
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.775 Test Loss: 0.992 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.503068208694458
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.985 Vali Acc: 0.769 Test Loss: 0.985 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.5157575607299805
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.769 Test Loss: 0.969 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.524059772491455
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.970 Vali Acc: 0.769 Test Loss: 0.970 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.492605209350586
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.769 Test Loss: 0.962 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.520689249038696
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.769 Test Loss: 0.955 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 466822663
model size : 1784.12MB
2025-04-28 11:13:04.470737: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:13:04.490163: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745838784.513746 1339251 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745838784.521148 1339251 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:13:04.544751: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.7317187786102295
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.024 Vali Acc: 0.566 Test Loss: 1.024 Test Acc: 0.566
Validation loss decreased (inf --> -0.566464).  Saving model ...
Epoch: 2 cost time: 4.443528413772583
Epoch: 2, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.654 Vali Acc: 0.815 Test Loss: 0.654 Test Acc: 0.815
Validation loss decreased (-0.566464 --> -0.815022).  Saving model ...
Epoch: 3 cost time: 4.453522443771362
Epoch: 3, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.183 Vali Acc: 0.803 Test Loss: 1.183 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.448686361312866
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.152 Vali Acc: 0.769 Test Loss: 1.152 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.409809350967407
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.549 Vali Acc: 0.792 Test Loss: 1.549 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.4131386280059814
Epoch: 6, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.289 Vali Acc: 0.763 Test Loss: 1.289 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.436417579650879
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.271 Vali Acc: 0.751 Test Loss: 2.271 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.428367853164673
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 1.263 Vali Acc: 0.786 Test Loss: 1.263 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.43307900428772
Epoch: 9, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.601 Vali Acc: 0.786 Test Loss: 1.601 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.418690919876099
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.594 Vali Acc: 0.763 Test Loss: 1.594 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.42842960357666
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.757 Test Loss: 2.055 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.41153621673584
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.920 Vali Acc: 0.699 Test Loss: 2.920 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 465960039
model size : 1780.83MB
2025-04-28 11:14:58.641032: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:14:58.661308: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745838898.684336 1344956 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745838898.691840 1344956 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:14:58.716619: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.541695833206177
Epoch: 1, Steps: 17 | Train Loss: 1.623 Vali Loss: 0.892 Vali Acc: 0.723 Test Loss: 0.892 Test Acc: 0.723
Validation loss decreased (inf --> -0.722534).  Saving model ...
Epoch: 2 cost time: 4.279276371002197
Epoch: 2, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.680 Vali Acc: 0.786 Test Loss: 0.680 Test Acc: 0.786
Validation loss decreased (-0.722534 --> -0.786120).  Saving model ...
Epoch: 3 cost time: 4.271870851516724
Epoch: 3, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.702 Vali Acc: 0.786 Test Loss: 0.702 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.257479906082153
Epoch: 4, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.809 Test Loss: 0.739 Test Acc: 0.809
Validation loss decreased (-0.786120 --> -0.809241).  Saving model ...
Epoch: 5 cost time: 4.26167893409729
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.069 Vali Acc: 0.809 Test Loss: 1.069 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.252967119216919
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.757 Vali Acc: 0.798 Test Loss: 0.757 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.257043123245239
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.967 Vali Acc: 0.803 Test Loss: 0.967 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.244751930236816
Epoch: 8, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.803 Vali Acc: 0.786 Test Loss: 0.803 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.282264947891235
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.906 Vali Acc: 0.723 Test Loss: 1.906 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.2714996337890625
Epoch: 10, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.420 Vali Acc: 0.780 Test Loss: 1.420 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.297132968902588
Epoch: 11, Steps: 17 | Train Loss: 0.269 Vali Loss: 1.085 Vali Acc: 0.809 Test Loss: 1.085 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.281623363494873
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.109 Vali Acc: 0.792 Test Loss: 1.109 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.282977104187012
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.733 Vali Acc: 0.751 Test Loss: 2.733 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.293741703033447
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.999 Vali Acc: 0.769 Test Loss: 1.999 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 465097415
model size : 1777.54MB
2025-04-28 11:17:03.509447: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:17:03.529334: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745839023.552530 1351546 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745839023.559638 1351546 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:17:03.582923: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.184447288513184
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.072 Vali Acc: 0.607 Test Loss: 1.072 Test Acc: 0.607
Validation loss decreased (inf --> -0.606926).  Saving model ...
Epoch: 2 cost time: 4.015564680099487
Epoch: 2, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.690 Vali Acc: 0.734 Test Loss: 0.690 Test Acc: 0.734
Validation loss decreased (-0.606926 --> -0.734097).  Saving model ...
Epoch: 3 cost time: 4.032811164855957
Epoch: 3, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.505 Vali Acc: 0.832 Test Loss: 0.505 Test Acc: 0.832
Validation loss decreased (-0.734097 --> -0.832365).  Saving model ...
Epoch: 4 cost time: 4.062061548233032
Epoch: 4, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.595 Vali Acc: 0.792 Test Loss: 0.595 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.024752855300903
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.319 Vali Acc: 0.757 Test Loss: 1.319 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.021065711975098
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.860 Vali Acc: 0.838 Test Loss: 0.860 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838142).  Saving model ...
Epoch: 7 cost time: 4.026648044586182
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9990196228027344
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.397 Vali Acc: 0.792 Test Loss: 1.397 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.024198293685913
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.838 Test Loss: 0.731 Test Acc: 0.838
Validation loss decreased (-0.838142 --> -0.838143).  Saving model ...
Epoch: 10 cost time: 4.041982889175415
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.832 Test Loss: 0.706 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.004271745681763
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.832 Test Loss: 0.707 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.9902169704437256
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.832 Test Loss: 0.702 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.009784698486328
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.832 Test Loss: 0.702 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9980568885803223
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.832 Test Loss: 0.714 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.0308732986450195
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.827 Test Loss: 0.700 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.9962737560272217
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.832 Test Loss: 0.709 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.019952774047852
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.827 Test Loss: 0.713 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.995150566101074
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.832 Test Loss: 0.709 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.0289013385772705
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.832 Test Loss: 0.714 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 464234791
model size : 1774.25MB
2025-04-28 11:19:44.372524: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:19:44.391449: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745839184.413913 1360383 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745839184.420866 1360383 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:19:44.443948: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.66580605506897
Epoch: 1, Steps: 17 | Train Loss: 1.655 Vali Loss: 1.216 Vali Acc: 0.682 Test Loss: 1.216 Test Acc: 0.682
Validation loss decreased (inf --> -0.682069).  Saving model ...
Epoch: 2 cost time: 5.640676021575928
Epoch: 2, Steps: 17 | Train Loss: 0.445 Vali Loss: 1.645 Vali Acc: 0.711 Test Loss: 1.645 Test Acc: 0.711
Validation loss decreased (-0.682069 --> -0.710966).  Saving model ...
Epoch: 3 cost time: 5.660585403442383
Epoch: 3, Steps: 17 | Train Loss: 0.297 Vali Loss: 2.398 Vali Acc: 0.723 Test Loss: 2.398 Test Acc: 0.723
Validation loss decreased (-0.710966 --> -0.722519).  Saving model ...
Epoch: 4 cost time: 5.6543402671813965
Epoch: 4, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.340 Vali Acc: 0.694 Test Loss: 3.340 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.658404111862183
Epoch: 5, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.883 Vali Acc: 0.746 Test Loss: 1.883 Test Acc: 0.746
Validation loss decreased (-0.722519 --> -0.745646).  Saving model ...
Epoch: 6 cost time: 5.633377313613892
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 6.310 Vali Acc: 0.676 Test Loss: 6.310 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.580446481704712
Epoch: 7, Steps: 17 | Train Loss: 0.095 Vali Loss: 2.749 Vali Acc: 0.734 Test Loss: 2.749 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.574826002120972
Epoch: 8, Steps: 17 | Train Loss: 0.055 Vali Loss: 4.696 Vali Acc: 0.740 Test Loss: 4.696 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.59180212020874
Epoch: 9, Steps: 17 | Train Loss: 0.160 Vali Loss: 4.730 Vali Acc: 0.751 Test Loss: 4.730 Test Acc: 0.751
Validation loss decreased (-0.745646 --> -0.751398).  Saving model ...
Epoch: 10 cost time: 5.629909038543701
Epoch: 10, Steps: 17 | Train Loss: 0.400 Vali Loss: 6.888 Vali Acc: 0.630 Test Loss: 6.888 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.567886114120483
Epoch: 11, Steps: 17 | Train Loss: 0.548 Vali Loss: 5.675 Vali Acc: 0.711 Test Loss: 5.675 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.574859857559204
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 6.393 Vali Acc: 0.734 Test Loss: 6.393 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.603580474853516
Epoch: 13, Steps: 17 | Train Loss: 0.785 Vali Loss: 5.012 Vali Acc: 0.809 Test Loss: 5.012 Test Acc: 0.809
Validation loss decreased (-0.751398 --> -0.809198).  Saving model ...
Epoch: 14 cost time: 5.635818004608154
Epoch: 14, Steps: 17 | Train Loss: 0.262 Vali Loss: 6.198 Vali Acc: 0.740 Test Loss: 6.198 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.5905375480651855
Epoch: 15, Steps: 17 | Train Loss: 0.143 Vali Loss: 8.781 Vali Acc: 0.757 Test Loss: 8.781 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.606004476547241
Epoch: 16, Steps: 17 | Train Loss: 0.300 Vali Loss: 6.429 Vali Acc: 0.775 Test Loss: 6.429 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.583877325057983
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 10.406 Vali Acc: 0.775 Test Loss: 10.406 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.578984260559082
Epoch: 18, Steps: 17 | Train Loss: 0.075 Vali Loss: 6.305 Vali Acc: 0.769 Test Loss: 6.305 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.576609134674072
Epoch: 19, Steps: 17 | Train Loss: 0.373 Vali Loss: 8.706 Vali Acc: 0.740 Test Loss: 8.706 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.577565670013428
Epoch: 20, Steps: 17 | Train Loss: 0.745 Vali Loss: 22.598 Vali Acc: 0.740 Test Loss: 22.598 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.578922986984253
Epoch: 21, Steps: 17 | Train Loss: 0.293 Vali Loss: 13.527 Vali Acc: 0.694 Test Loss: 13.527 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.58348274230957
Epoch: 22, Steps: 17 | Train Loss: 0.122 Vali Loss: 19.447 Vali Acc: 0.734 Test Loss: 19.447 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.57302188873291
Epoch: 23, Steps: 17 | Train Loss: 0.130 Vali Loss: 11.970 Vali Acc: 0.757 Test Loss: 11.970 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 477176487
model size : 1823.61MB
2025-04-28 11:23:45.214511: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:23:45.233607: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745839425.256083 1371223 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745839425.262995 1371223 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:23:45.285771: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.9271135330200195
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 0.943 Vali Acc: 0.642 Test Loss: 0.943 Test Acc: 0.642
Validation loss decreased (inf --> -0.641609).  Saving model ...
Epoch: 2 cost time: 4.639508485794067
Epoch: 2, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.090 Vali Acc: 0.682 Test Loss: 1.090 Test Acc: 0.682
Validation loss decreased (-0.641609 --> -0.682070).  Saving model ...
Epoch: 3 cost time: 4.64674186706543
Epoch: 3, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.013 Vali Acc: 0.723 Test Loss: 2.013 Test Acc: 0.723
Validation loss decreased (-0.682070 --> -0.722523).  Saving model ...
Epoch: 4 cost time: 4.646800994873047
Epoch: 4, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.562 Vali Acc: 0.711 Test Loss: 2.562 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.634208917617798
Epoch: 5, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.472 Vali Acc: 0.757 Test Loss: 1.472 Test Acc: 0.757
Validation loss decreased (-0.722523 --> -0.757211).  Saving model ...
Epoch: 6 cost time: 4.643526554107666
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.327 Vali Acc: 0.821 Test Loss: 1.327 Test Acc: 0.821
Validation loss decreased (-0.757211 --> -0.820796).  Saving model ...
Epoch: 7 cost time: 4.659479856491089
Epoch: 7, Steps: 17 | Train Loss: 0.128 Vali Loss: 3.848 Vali Acc: 0.705 Test Loss: 3.848 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.648052453994751
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 2.204 Vali Acc: 0.757 Test Loss: 2.204 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.658411502838135
Epoch: 9, Steps: 17 | Train Loss: 0.012 Vali Loss: 3.427 Vali Acc: 0.757 Test Loss: 3.427 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.661935806274414
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 2.374 Vali Acc: 0.746 Test Loss: 2.374 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.653953313827515
Epoch: 11, Steps: 17 | Train Loss: 0.030 Vali Loss: 3.171 Vali Acc: 0.786 Test Loss: 3.171 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.691194534301758
Epoch: 12, Steps: 17 | Train Loss: 0.131 Vali Loss: 5.885 Vali Acc: 0.705 Test Loss: 5.885 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.674187183380127
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 6.581 Vali Acc: 0.734 Test Loss: 6.581 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.650081396102905
Epoch: 14, Steps: 17 | Train Loss: 0.530 Vali Loss: 6.778 Vali Acc: 0.705 Test Loss: 6.778 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.667516231536865
Epoch: 15, Steps: 17 | Train Loss: 0.418 Vali Loss: 5.483 Vali Acc: 0.723 Test Loss: 5.483 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.660052537918091
Epoch: 16, Steps: 17 | Train Loss: 0.132 Vali Loss: 4.741 Vali Acc: 0.786 Test Loss: 4.741 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 469410983
model size : 1793.99MB
2025-04-28 11:26:24.888208: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:26:24.907610: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745839584.931223 1378798 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745839584.938344 1378798 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:26:24.961673: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.829003572463989
Epoch: 1, Steps: 17 | Train Loss: 1.380 Vali Loss: 0.900 Vali Acc: 0.694 Test Loss: 0.900 Test Acc: 0.694
Validation loss decreased (inf --> -0.693633).  Saving model ...
Epoch: 2 cost time: 4.563245058059692
Epoch: 2, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.077 Vali Acc: 0.751 Test Loss: 1.077 Test Acc: 0.751
Validation loss decreased (-0.693633 --> -0.751434).  Saving model ...
Epoch: 3 cost time: 4.566055774688721
Epoch: 3, Steps: 17 | Train Loss: 0.194 Vali Loss: 2.026 Vali Acc: 0.717 Test Loss: 2.026 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.562747240066528
Epoch: 4, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.924 Vali Acc: 0.740 Test Loss: 1.924 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.53225564956665
Epoch: 5, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.020 Vali Acc: 0.786 Test Loss: 1.020 Test Acc: 0.786
Validation loss decreased (-0.751434 --> -0.786117).  Saving model ...
Epoch: 6 cost time: 4.588341474533081
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.346 Vali Acc: 0.827 Test Loss: 1.346 Test Acc: 0.827
Validation loss decreased (-0.786117 --> -0.826576).  Saving model ...
Epoch: 7 cost time: 4.595337867736816
Epoch: 7, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.035 Vali Acc: 0.809 Test Loss: 1.035 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.545947790145874
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.478 Vali Acc: 0.809 Test Loss: 1.478 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.55220890045166
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.823 Vali Acc: 0.751 Test Loss: 2.823 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.549510717391968
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 3.214 Vali Acc: 0.769 Test Loss: 3.214 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.549811124801636
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 2.296 Vali Acc: 0.769 Test Loss: 2.296 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.543033599853516
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.769 Test Loss: 1.698 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.556648015975952
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.989 Vali Acc: 0.803 Test Loss: 1.989 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.53278112411499
Epoch: 14, Steps: 17 | Train Loss: 0.380 Vali Loss: 2.414 Vali Acc: 0.815 Test Loss: 2.414 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.534926652908325
Epoch: 15, Steps: 17 | Train Loss: 0.438 Vali Loss: 3.625 Vali Acc: 0.728 Test Loss: 3.625 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.557677984237671
Epoch: 16, Steps: 17 | Train Loss: 0.200 Vali Loss: 7.614 Vali Acc: 0.607 Test Loss: 7.614 Test Acc: 0.607
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 466822535
model size : 1784.12MB
2025-04-28 11:28:54.476853: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:28:54.495614: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745839734.519567 1386327 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745839734.526739 1386327 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:28:54.550021: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.5269434452056885
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 0.873 Vali Acc: 0.694 Test Loss: 0.873 Test Acc: 0.694
Validation loss decreased (inf --> -0.693633).  Saving model ...
Epoch: 2 cost time: 4.484042406082153
Epoch: 2, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.083 Vali Acc: 0.728 Test Loss: 1.083 Test Acc: 0.728
Validation loss decreased (-0.693633 --> -0.728313).  Saving model ...
Epoch: 3 cost time: 4.489990472793579
Epoch: 3, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
Validation loss decreased (-0.728313 --> -0.803462).  Saving model ...
Epoch: 4 cost time: 4.530272483825684
Epoch: 4, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.803 Test Loss: 0.998 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.511477470397949
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.910 Vali Acc: 0.786 Test Loss: 0.910 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.480818748474121
Epoch: 6, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.894 Vali Acc: 0.809 Test Loss: 0.894 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809240).  Saving model ...
Epoch: 7 cost time: 4.508782863616943
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.648 Vali Acc: 0.798 Test Loss: 1.648 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.455334424972534
Epoch: 8, Steps: 17 | Train Loss: 0.107 Vali Loss: 2.545 Vali Acc: 0.786 Test Loss: 2.545 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.437422513961792
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.586 Vali Acc: 0.780 Test Loss: 1.586 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.455554723739624
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.573 Vali Acc: 0.838 Test Loss: 1.573 Test Acc: 0.838
Validation loss decreased (-0.809240 --> -0.838135).  Saving model ...
Epoch: 11 cost time: 4.484650611877441
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.827 Test Loss: 1.308 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.455844163894653
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.815 Test Loss: 1.473 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.448672294616699
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.436 Vali Acc: 0.832 Test Loss: 1.436 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.474370718002319
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.432 Vali Acc: 0.832 Test Loss: 1.432 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.472699165344238
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.415 Vali Acc: 0.832 Test Loss: 1.415 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.457324981689453
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.411 Vali Acc: 0.832 Test Loss: 1.411 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.474727630615234
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.832 Test Loss: 1.413 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.457397222518921
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.832 Test Loss: 1.397 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.451469898223877
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.397 Vali Acc: 0.832 Test Loss: 1.397 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.4522621631622314
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.390 Vali Acc: 0.832 Test Loss: 1.390 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 465959815
model size : 1780.83MB
2025-04-28 11:31:54.202110: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:31:54.221470: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745839914.244319 1395669 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745839914.251189 1395669 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:31:54.274605: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.368694543838501
Epoch: 1, Steps: 17 | Train Loss: 1.453 Vali Loss: 0.814 Vali Acc: 0.769 Test Loss: 0.814 Test Acc: 0.769
Validation loss decreased (inf --> -0.768778).  Saving model ...
Epoch: 2 cost time: 4.337701320648193
Epoch: 2, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.838 Vali Acc: 0.699 Test Loss: 0.838 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.316998720169067
Epoch: 3, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.969 Vali Acc: 0.751 Test Loss: 0.969 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.51714563369751
Epoch: 4, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.736 Vali Acc: 0.798 Test Loss: 0.736 Test Acc: 0.798
Validation loss decreased (-0.768778 --> -0.797680).  Saving model ...
Epoch: 5 cost time: 4.38107705116272
Epoch: 5, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.117 Vali Acc: 0.769 Test Loss: 1.117 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.350139379501343
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.020 Vali Acc: 0.699 Test Loss: 2.020 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.333772659301758
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.667 Vali Acc: 0.746 Test Loss: 1.667 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.3435492515563965
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.223 Vali Acc: 0.792 Test Loss: 1.223 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.3204026222229
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.803 Test Loss: 0.953 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803459).  Saving model ...
Epoch: 10 cost time: 4.375421047210693
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.952 Vali Acc: 0.809 Test Loss: 0.952 Test Acc: 0.809
Validation loss decreased (-0.803459 --> -0.809239).  Saving model ...
Epoch: 11 cost time: 4.354640245437622
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.809 Test Loss: 0.956 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.342616558074951
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.809 Test Loss: 0.953 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.326698541641235
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.809 Test Loss: 0.945 Test Acc: 0.809
Validation loss decreased (-0.809239 --> -0.809239).  Saving model ...
Epoch: 14 cost time: 4.392332315444946
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.809 Test Loss: 0.958 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.336532354354858
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.809 Test Loss: 0.949 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.349040269851685
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.809 Test Loss: 0.948 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.350554943084717
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.809 Test Loss: 0.943 Test Acc: 0.809
Validation loss decreased (-0.809239 --> -0.809239).  Saving model ...
Epoch: 18 cost time: 4.371452808380127
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.809 Test Loss: 0.927 Test Acc: 0.809
Validation loss decreased (-0.809239 --> -0.809239).  Saving model ...
Epoch: 19 cost time: 4.364086866378784
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.815 Test Loss: 0.921 Test Acc: 0.815
Validation loss decreased (-0.809239 --> -0.815020).  Saving model ...
Epoch: 20 cost time: 4.380266427993774
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.815 Test Loss: 0.911 Test Acc: 0.815
Validation loss decreased (-0.815020 --> -0.815020).  Saving model ...
Epoch: 21 cost time: 4.400040149688721
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.916 Vali Acc: 0.815 Test Loss: 0.916 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.36323094367981
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.815 Test Loss: 0.912 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.362256288528442
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.815 Test Loss: 0.920 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.371277332305908
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.815 Test Loss: 0.927 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.374959707260132
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.815 Test Loss: 0.919 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.394445180892944
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.815 Test Loss: 0.932 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.374875068664551
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.815 Test Loss: 0.897 Test Acc: 0.815
Validation loss decreased (-0.815020 --> -0.815020).  Saving model ...
Epoch: 28 cost time: 4.403956651687622
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.815 Test Loss: 0.932 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.345723628997803
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.815 Test Loss: 0.932 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.367640972137451
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.815 Test Loss: 0.926 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.371625185012817
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.815 Test Loss: 0.911 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.355829477310181
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.815 Test Loss: 0.917 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.365367889404297
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.815 Test Loss: 0.927 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.351460933685303
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.815 Test Loss: 0.895 Test Acc: 0.815
Validation loss decreased (-0.815020 --> -0.815020).  Saving model ...
Epoch: 35 cost time: 4.3921754360198975
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.815 Test Loss: 0.883 Test Acc: 0.815
Validation loss decreased (-0.815020 --> -0.815020).  Saving model ...
Epoch: 36 cost time: 4.379387140274048
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.815 Test Loss: 0.891 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 4.357451915740967
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.815 Test Loss: 0.908 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.382505416870117
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.815 Test Loss: 0.911 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.353973865509033
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.815 Test Loss: 0.903 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.356783866882324
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.815 Test Loss: 0.894 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.374925851821899
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.815 Test Loss: 0.892 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.370535850524902
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.815 Test Loss: 0.912 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.367605209350586
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.815 Test Loss: 0.887 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.354742527008057
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.815 Test Loss: 0.887 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.358936071395874
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.815 Test Loss: 0.895 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 465097191
model size : 1777.54MB
2025-04-28 11:38:08.278192: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:38:08.297209: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745840288.319895 1416359 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745840288.326739 1416359 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:38:08.349545: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.457366466522217
Epoch: 1, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.008 Vali Acc: 0.682 Test Loss: 1.008 Test Acc: 0.682
Validation loss decreased (inf --> -0.682071).  Saving model ...
Epoch: 2 cost time: 4.212266683578491
Epoch: 2, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.799 Vali Acc: 0.682 Test Loss: 0.799 Test Acc: 0.682
Validation loss decreased (-0.682071 --> -0.682073).  Saving model ...
Epoch: 3 cost time: 4.218898773193359
Epoch: 3, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.509 Vali Acc: 0.838 Test Loss: 0.509 Test Acc: 0.838
Validation loss decreased (-0.682073 --> -0.838145).  Saving model ...
Epoch: 4 cost time: 4.2121477127075195
Epoch: 4, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.445 Vali Acc: 0.838 Test Loss: 0.445 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838146).  Saving model ...
Epoch: 5 cost time: 4.245959043502808
Epoch: 5, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.958 Vali Acc: 0.792 Test Loss: 0.958 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.217763662338257
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.798 Test Loss: 0.943 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.185191631317139
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.193595886230469
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.786 Test Loss: 0.794 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.188726902008057
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.821 Test Loss: 0.670 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.1872639656066895
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.792 Test Loss: 0.655 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.174571514129639
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.653 Vali Acc: 0.792 Test Loss: 0.653 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.189518451690674
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.792 Test Loss: 0.656 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.200523614883423
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.792 Test Loss: 0.661 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.196517705917358
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.792 Test Loss: 0.662 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 464234567
model size : 1774.24MB
2025-04-28 11:40:18.655914: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:40:18.675061: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745840418.697770 1422968 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745840418.704933 1422968 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:40:18.728492: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.224298477172852
Epoch: 1, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.102 Vali Acc: 0.584 Test Loss: 1.102 Test Acc: 0.584
Validation loss decreased (inf --> -0.583804).  Saving model ...
Epoch: 2 cost time: 3.9018895626068115
Epoch: 2, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.640 Vali Acc: 0.751 Test Loss: 0.640 Test Acc: 0.751
Validation loss decreased (-0.583804 --> -0.751439).  Saving model ...
Epoch: 3 cost time: 3.918593168258667
Epoch: 3, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
Validation loss decreased (-0.751439 --> -0.803461).  Saving model ...
Epoch: 4 cost time: 3.9510505199432373
Epoch: 4, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.569 Vali Acc: 0.838 Test Loss: 0.569 Test Acc: 0.838
Validation loss decreased (-0.803461 --> -0.838145).  Saving model ...
Epoch: 5 cost time: 3.9103171825408936
Epoch: 5, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.923165798187256
Epoch: 6, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.821 Test Loss: 0.695 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8927032947540283
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.792 Test Loss: 0.785 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.928640365600586
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.815 Test Loss: 0.562 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.881856918334961
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.815 Test Loss: 0.540 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.8802683353424072
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.815 Test Loss: 0.528 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8596532344818115
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.827 Test Loss: 0.522 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.8774824142456055
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.521 Vali Acc: 0.827 Test Loss: 0.521 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.862029790878296
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.827 Test Loss: 0.512 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.86893892288208
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.827 Test Loss: 0.523 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 463371943
model size : 1770.95MB
2025-04-28 11:42:26.644120: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:42:26.662782: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745840546.685227 1429581 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745840546.692253 1429581 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:42:26.715420: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.836225032806396
Epoch: 1, Steps: 17 | Train Loss: 9.595 Vali Loss: 8.411 Vali Acc: 0.503 Test Loss: 8.411 Test Acc: 0.503
Validation loss decreased (inf --> -0.502806).  Saving model ...
Epoch: 2 cost time: 9.76816201210022
Epoch: 2, Steps: 17 | Train Loss: 2.548 Vali Loss: 4.124 Vali Acc: 0.699 Test Loss: 4.124 Test Acc: 0.699
Validation loss decreased (-0.502806 --> -0.699381).  Saving model ...
Epoch: 3 cost time: 9.78612470626831
Epoch: 3, Steps: 17 | Train Loss: 0.713 Vali Loss: 3.239 Vali Acc: 0.792 Test Loss: 3.239 Test Acc: 0.792
Validation loss decreased (-0.699381 --> -0.791875).  Saving model ...
Epoch: 4 cost time: 9.775453329086304
Epoch: 4, Steps: 17 | Train Loss: 1.015 Vali Loss: 9.712 Vali Acc: 0.699 Test Loss: 9.712 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.765284299850464
Epoch: 5, Steps: 17 | Train Loss: 0.677 Vali Loss: 8.682 Vali Acc: 0.780 Test Loss: 8.682 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.748415231704712
Epoch: 6, Steps: 17 | Train Loss: 0.756 Vali Loss: 7.029 Vali Acc: 0.780 Test Loss: 7.029 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.752932071685791
Epoch: 7, Steps: 17 | Train Loss: 0.772 Vali Loss: 13.851 Vali Acc: 0.717 Test Loss: 13.851 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.745213508605957
Epoch: 8, Steps: 17 | Train Loss: 1.038 Vali Loss: 22.088 Vali Acc: 0.682 Test Loss: 22.088 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.760254144668579
Epoch: 9, Steps: 17 | Train Loss: 1.136 Vali Loss: 9.451 Vali Acc: 0.734 Test Loss: 9.451 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.739782810211182
Epoch: 10, Steps: 17 | Train Loss: 0.397 Vali Loss: 12.546 Vali Acc: 0.734 Test Loss: 12.546 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 9.749436616897583
Epoch: 11, Steps: 17 | Train Loss: 0.095 Vali Loss: 13.593 Vali Acc: 0.746 Test Loss: 13.593 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 9.740694046020508
Epoch: 12, Steps: 17 | Train Loss: 0.556 Vali Loss: 14.267 Vali Acc: 0.803 Test Loss: 14.267 Test Acc: 0.803
Validation loss decreased (-0.791875 --> -0.803326).  Saving model ...
Epoch: 13 cost time: 9.779882431030273
Epoch: 13, Steps: 17 | Train Loss: 0.472 Vali Loss: 20.444 Vali Acc: 0.676 Test Loss: 20.444 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.800654411315918
Epoch: 14, Steps: 17 | Train Loss: 1.340 Vali Loss: 27.406 Vali Acc: 0.728 Test Loss: 27.406 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.794431209564209
Epoch: 15, Steps: 17 | Train Loss: 0.107 Vali Loss: 20.119 Vali Acc: 0.728 Test Loss: 20.119 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.789995908737183
Epoch: 16, Steps: 17 | Train Loss: 2.224 Vali Loss: 41.505 Vali Acc: 0.665 Test Loss: 41.505 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.818263053894043
Epoch: 17, Steps: 17 | Train Loss: 0.413 Vali Loss: 19.200 Vali Acc: 0.751 Test Loss: 19.200 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.842535018920898
Epoch: 18, Steps: 17 | Train Loss: 1.193 Vali Loss: 28.325 Vali Acc: 0.803 Test Loss: 28.325 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.825427770614624
Epoch: 19, Steps: 17 | Train Loss: 2.300 Vali Loss: 36.171 Vali Acc: 0.757 Test Loss: 36.171 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.805285692214966
Epoch: 20, Steps: 17 | Train Loss: 0.879 Vali Loss: 41.221 Vali Acc: 0.763 Test Loss: 41.221 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.823208093643188
Epoch: 21, Steps: 17 | Train Loss: 0.166 Vali Loss: 45.128 Vali Acc: 0.746 Test Loss: 45.128 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.801113605499268
Epoch: 22, Steps: 17 | Train Loss: 1.661 Vali Loss: 51.396 Vali Acc: 0.723 Test Loss: 51.396 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 941804679
model size : 3598.37MB
2025-04-28 11:48:43.906982: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:48:43.926205: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745840923.949259 1440561 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745840923.956319 1440561 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:48:43.979486: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.729440927505493
Epoch: 1, Steps: 17 | Train Loss: 2.686 Vali Loss: 2.132 Vali Acc: 0.653 Test Loss: 2.132 Test Acc: 0.653
Validation loss decreased (inf --> -0.653158).  Saving model ...
Epoch: 2 cost time: 7.522171497344971
Epoch: 2, Steps: 17 | Train Loss: 0.817 Vali Loss: 4.224 Vali Acc: 0.647 Test Loss: 4.224 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.485278606414795
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 4.190 Vali Acc: 0.711 Test Loss: 4.190 Test Acc: 0.711
Validation loss decreased (-0.653158 --> -0.710941).  Saving model ...
Epoch: 4 cost time: 7.519815444946289
Epoch: 4, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.176 Vali Acc: 0.803 Test Loss: 3.176 Test Acc: 0.803
Validation loss decreased (-0.710941 --> -0.803436).  Saving model ...
Epoch: 5 cost time: 7.538435697555542
Epoch: 5, Steps: 17 | Train Loss: 0.214 Vali Loss: 6.135 Vali Acc: 0.728 Test Loss: 6.135 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.507611274719238
Epoch: 6, Steps: 17 | Train Loss: 0.165 Vali Loss: 6.448 Vali Acc: 0.728 Test Loss: 6.448 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.50916051864624
Epoch: 7, Steps: 17 | Train Loss: 0.473 Vali Loss: 8.762 Vali Acc: 0.642 Test Loss: 8.762 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.504069089889526
Epoch: 8, Steps: 17 | Train Loss: 0.518 Vali Loss: 5.711 Vali Acc: 0.682 Test Loss: 5.711 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.516154527664185
Epoch: 9, Steps: 17 | Train Loss: 0.522 Vali Loss: 6.289 Vali Acc: 0.717 Test Loss: 6.289 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.499544382095337
Epoch: 10, Steps: 17 | Train Loss: 0.270 Vali Loss: 7.759 Vali Acc: 0.740 Test Loss: 7.759 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 7.490221977233887
Epoch: 11, Steps: 17 | Train Loss: 0.306 Vali Loss: 7.078 Vali Acc: 0.786 Test Loss: 7.078 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 7.491258859634399
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 12.792 Vali Acc: 0.659 Test Loss: 12.792 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 7.499656915664673
Epoch: 13, Steps: 17 | Train Loss: 0.732 Vali Loss: 9.129 Vali Acc: 0.746 Test Loss: 9.129 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 7.5116918087005615
Epoch: 14, Steps: 17 | Train Loss: 1.122 Vali Loss: 19.639 Vali Acc: 0.723 Test Loss: 19.639 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 910742663
model size : 3479.88MB
2025-04-28 11:52:12.907505: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:52:12.927499: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745841132.950866 1447501 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745841132.957967 1447501 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:52:12.981839: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.214346647262573
Epoch: 1, Steps: 17 | Train Loss: 2.063 Vali Loss: 1.577 Vali Acc: 0.549 Test Loss: 1.577 Test Acc: 0.549
Validation loss decreased (inf --> -0.549117).  Saving model ...
Epoch: 2 cost time: 7.003662586212158
Epoch: 2, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.667 Vali Acc: 0.728 Test Loss: 1.667 Test Acc: 0.728
Validation loss decreased (-0.549117 --> -0.728307).  Saving model ...
Epoch: 3 cost time: 7.009079694747925
Epoch: 3, Steps: 17 | Train Loss: 0.106 Vali Loss: 3.716 Vali Acc: 0.780 Test Loss: 3.716 Test Acc: 0.780
Validation loss decreased (-0.728307 --> -0.780310).  Saving model ...
Epoch: 4 cost time: 7.026247262954712
Epoch: 4, Steps: 17 | Train Loss: 0.169 Vali Loss: 3.314 Vali Acc: 0.705 Test Loss: 3.314 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.959396839141846
Epoch: 5, Steps: 17 | Train Loss: 0.224 Vali Loss: 2.730 Vali Acc: 0.751 Test Loss: 2.730 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.90794563293457
Epoch: 6, Steps: 17 | Train Loss: 0.633 Vali Loss: 3.700 Vali Acc: 0.751 Test Loss: 3.700 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.932460784912109
Epoch: 7, Steps: 17 | Train Loss: 0.445 Vali Loss: 5.345 Vali Acc: 0.780 Test Loss: 5.345 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.9167890548706055
Epoch: 8, Steps: 17 | Train Loss: 0.205 Vali Loss: 4.124 Vali Acc: 0.711 Test Loss: 4.124 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.909995794296265
Epoch: 9, Steps: 17 | Train Loss: 0.251 Vali Loss: 8.003 Vali Acc: 0.671 Test Loss: 8.003 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.92422080039978
Epoch: 10, Steps: 17 | Train Loss: 0.341 Vali Loss: 5.938 Vali Acc: 0.757 Test Loss: 5.938 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.927675247192383
Epoch: 11, Steps: 17 | Train Loss: 0.305 Vali Loss: 8.741 Vali Acc: 0.751 Test Loss: 8.741 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.930542945861816
Epoch: 12, Steps: 17 | Train Loss: 0.281 Vali Loss: 5.268 Vali Acc: 0.792 Test Loss: 5.268 Test Acc: 0.792
Validation loss decreased (-0.780310 --> -0.791855).  Saving model ...
Epoch: 13 cost time: 6.9549880027771
Epoch: 13, Steps: 17 | Train Loss: 0.201 Vali Loss: 5.759 Vali Acc: 0.815 Test Loss: 5.759 Test Acc: 0.815
Validation loss decreased (-0.791855 --> -0.814971).  Saving model ...
Epoch: 14 cost time: 6.938867807388306
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 8.976 Vali Acc: 0.734 Test Loss: 8.976 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.936990737915039
Epoch: 15, Steps: 17 | Train Loss: 0.505 Vali Loss: 8.131 Vali Acc: 0.740 Test Loss: 8.131 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.911135911941528
Epoch: 16, Steps: 17 | Train Loss: 0.186 Vali Loss: 5.549 Vali Acc: 0.821 Test Loss: 5.549 Test Acc: 0.821
Validation loss decreased (-0.814971 --> -0.820754).  Saving model ...
Epoch: 17 cost time: 6.933618783950806
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 5.574 Vali Acc: 0.827 Test Loss: 5.574 Test Acc: 0.827
Validation loss decreased (-0.820754 --> -0.826534).  Saving model ...
Epoch: 18 cost time: 6.9636547565460205
Epoch: 18, Steps: 17 | Train Loss: 0.270 Vali Loss: 5.702 Vali Acc: 0.803 Test Loss: 5.702 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.9473676681518555
Epoch: 19, Steps: 17 | Train Loss: 0.124 Vali Loss: 9.596 Vali Acc: 0.751 Test Loss: 9.596 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.938628196716309
Epoch: 20, Steps: 17 | Train Loss: 0.571 Vali Loss: 11.610 Vali Acc: 0.763 Test Loss: 11.610 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.943666934967041
Epoch: 21, Steps: 17 | Train Loss: 0.604 Vali Loss: 14.357 Vali Acc: 0.769 Test Loss: 14.357 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.915220022201538
Epoch: 22, Steps: 17 | Train Loss: 0.826 Vali Loss: 11.966 Vali Acc: 0.763 Test Loss: 11.966 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.924665451049805
Epoch: 23, Steps: 17 | Train Loss: 0.474 Vali Loss: 19.448 Vali Acc: 0.665 Test Loss: 19.448 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.940355062484741
Epoch: 24, Steps: 17 | Train Loss: 0.646 Vali Loss: 16.167 Vali Acc: 0.775 Test Loss: 16.167 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.9321208000183105
Epoch: 25, Steps: 17 | Train Loss: 1.014 Vali Loss: 11.428 Vali Acc: 0.786 Test Loss: 11.428 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.94130802154541
Epoch: 26, Steps: 17 | Train Loss: 0.467 Vali Loss: 10.857 Vali Acc: 0.775 Test Loss: 10.857 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.967182397842407
Epoch: 27, Steps: 17 | Train Loss: 0.616 Vali Loss: 24.683 Vali Acc: 0.723 Test Loss: 24.683 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 900388871
model size : 3440.38MB
2025-04-28 11:58:26.240333: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 11:58:26.259228: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745841506.281395 1460570 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745841506.288212 1460570 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 11:58:26.311020: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.932603120803833
Epoch: 1, Steps: 17 | Train Loss: 2.320 Vali Loss: 1.983 Vali Acc: 0.445 Test Loss: 1.983 Test Acc: 0.445
Validation loss decreased (inf --> -0.445067).  Saving model ...
Epoch: 2 cost time: 6.678617238998413
Epoch: 2, Steps: 17 | Train Loss: 0.601 Vali Loss: 1.356 Vali Acc: 0.757 Test Loss: 1.356 Test Acc: 0.757
Validation loss decreased (-0.445067 --> -0.757212).  Saving model ...
Epoch: 3 cost time: 6.688669204711914
Epoch: 3, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.971 Vali Acc: 0.763 Test Loss: 1.971 Test Acc: 0.763
Validation loss decreased (-0.757212 --> -0.762986).  Saving model ...
Epoch: 4 cost time: 6.678349733352661
Epoch: 4, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.780 Vali Acc: 0.751 Test Loss: 1.780 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.645462512969971
Epoch: 5, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.797 Vali Acc: 0.694 Test Loss: 1.797 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.657087564468384
Epoch: 6, Steps: 17 | Train Loss: 0.095 Vali Loss: 5.817 Vali Acc: 0.682 Test Loss: 5.817 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.634682655334473
Epoch: 7, Steps: 17 | Train Loss: 0.598 Vali Loss: 4.994 Vali Acc: 0.624 Test Loss: 4.994 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.6527488231658936
Epoch: 8, Steps: 17 | Train Loss: 0.252 Vali Loss: 8.912 Vali Acc: 0.624 Test Loss: 8.912 Test Acc: 0.624
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.657054424285889
Epoch: 9, Steps: 17 | Train Loss: 0.514 Vali Loss: 3.320 Vali Acc: 0.763 Test Loss: 3.320 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.678532600402832
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 5.735 Vali Acc: 0.717 Test Loss: 5.735 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.661094427108765
Epoch: 11, Steps: 17 | Train Loss: 0.142 Vali Loss: 3.822 Vali Acc: 0.780 Test Loss: 3.822 Test Acc: 0.780
Validation loss decreased (-0.762986 --> -0.780309).  Saving model ...
Epoch: 12 cost time: 6.674908876419067
Epoch: 12, Steps: 17 | Train Loss: 0.231 Vali Loss: 4.127 Vali Acc: 0.792 Test Loss: 4.127 Test Acc: 0.792
Validation loss decreased (-0.780309 --> -0.791866).  Saving model ...
Epoch: 13 cost time: 6.720768213272095
Epoch: 13, Steps: 17 | Train Loss: 0.548 Vali Loss: 10.078 Vali Acc: 0.636 Test Loss: 10.078 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.652753114700317
Epoch: 14, Steps: 17 | Train Loss: 0.253 Vali Loss: 9.645 Vali Acc: 0.763 Test Loss: 9.645 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.6767027378082275
Epoch: 15, Steps: 17 | Train Loss: 0.726 Vali Loss: 11.445 Vali Acc: 0.734 Test Loss: 11.445 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.649509429931641
Epoch: 16, Steps: 17 | Train Loss: 0.252 Vali Loss: 8.879 Vali Acc: 0.769 Test Loss: 8.879 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.642297744750977
Epoch: 17, Steps: 17 | Train Loss: 0.490 Vali Loss: 10.075 Vali Acc: 0.711 Test Loss: 10.075 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.642527103424072
Epoch: 18, Steps: 17 | Train Loss: 0.588 Vali Loss: 10.115 Vali Acc: 0.746 Test Loss: 10.115 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.6369898319244385
Epoch: 19, Steps: 17 | Train Loss: 0.523 Vali Loss: 15.634 Vali Acc: 0.803 Test Loss: 15.634 Test Acc: 0.803
Validation loss decreased (-0.791866 --> -0.803312).  Saving model ...
Epoch: 20 cost time: 6.681377410888672
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 11.393 Vali Acc: 0.780 Test Loss: 11.393 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.643120288848877
Epoch: 21, Steps: 17 | Train Loss: 0.471 Vali Loss: 7.792 Vali Acc: 0.786 Test Loss: 7.792 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.647411346435547
Epoch: 22, Steps: 17 | Train Loss: 0.969 Vali Loss: 7.022 Vali Acc: 0.803 Test Loss: 7.022 Test Acc: 0.803
Validation loss decreased (-0.803312 --> -0.803398).  Saving model ...
Epoch: 23 cost time: 6.672443151473999
Epoch: 23, Steps: 17 | Train Loss: 0.158 Vali Loss: 13.366 Vali Acc: 0.786 Test Loss: 13.366 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.598923444747925
Epoch: 24, Steps: 17 | Train Loss: 0.565 Vali Loss: 16.470 Vali Acc: 0.734 Test Loss: 16.470 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.588166952133179
Epoch: 25, Steps: 17 | Train Loss: 0.292 Vali Loss: 19.226 Vali Acc: 0.821 Test Loss: 19.226 Test Acc: 0.821
Validation loss decreased (-0.803398 --> -0.820617).  Saving model ...
Epoch: 26 cost time: 6.608189582824707
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 22.016 Vali Acc: 0.746 Test Loss: 22.016 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.609262466430664
Epoch: 27, Steps: 17 | Train Loss: 0.120 Vali Loss: 15.146 Vali Acc: 0.809 Test Loss: 15.146 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.611001968383789
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 21.921 Vali Acc: 0.769 Test Loss: 21.921 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.624482154846191
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.029 Vali Acc: 0.751 Test Loss: 23.029 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.6208813190460205
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.313 Vali Acc: 0.763 Test Loss: 23.313 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.593635320663452
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.539 Vali Acc: 0.751 Test Loss: 23.539 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.644409656524658
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.443 Vali Acc: 0.751 Test Loss: 23.443 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.611917972564697
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.472 Vali Acc: 0.763 Test Loss: 23.472 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.599016189575195
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.234 Vali Acc: 0.763 Test Loss: 23.234 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.61612606048584
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.141 Vali Acc: 0.763 Test Loss: 23.141 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 895212295
model size : 3420.64MB
2025-04-28 12:05:56.203452: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:05:56.222749: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745841956.245945 1477308 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745841956.252935 1477308 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:05:56.276513: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.6709864139556885
Epoch: 1, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.842 Vali Acc: 0.526 Test Loss: 2.842 Test Acc: 0.526
Validation loss decreased (inf --> -0.525983).  Saving model ...
Epoch: 2 cost time: 6.52460503578186
Epoch: 2, Steps: 17 | Train Loss: 0.945 Vali Loss: 3.626 Vali Acc: 0.642 Test Loss: 3.626 Test Acc: 0.642
Validation loss decreased (-0.525983 --> -0.641582).  Saving model ...
Epoch: 3 cost time: 6.458506345748901
Epoch: 3, Steps: 17 | Train Loss: 0.545 Vali Loss: 1.015 Vali Acc: 0.809 Test Loss: 1.015 Test Acc: 0.809
Validation loss decreased (-0.641582 --> -0.809238).  Saving model ...
Epoch: 4 cost time: 6.435688495635986
Epoch: 4, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.902 Vali Acc: 0.838 Test Loss: 1.902 Test Acc: 0.838
Validation loss decreased (-0.809238 --> -0.838131).  Saving model ...
Epoch: 5 cost time: 6.451923131942749
Epoch: 5, Steps: 17 | Train Loss: 0.126 Vali Loss: 2.324 Vali Acc: 0.757 Test Loss: 2.324 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.4182469844818115
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 2.471 Vali Acc: 0.757 Test Loss: 2.471 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.414425373077393
Epoch: 7, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.754 Vali Acc: 0.671 Test Loss: 2.754 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.410758018493652
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.048 Vali Acc: 0.838 Test Loss: 2.048 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.432390213012695
Epoch: 9, Steps: 17 | Train Loss: 0.162 Vali Loss: 2.458 Vali Acc: 0.786 Test Loss: 2.458 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.4310221672058105
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.862 Vali Acc: 0.827 Test Loss: 1.862 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.4559783935546875
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 3.369 Vali Acc: 0.798 Test Loss: 3.369 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.444143772125244
Epoch: 12, Steps: 17 | Train Loss: 0.068 Vali Loss: 3.941 Vali Acc: 0.780 Test Loss: 3.941 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.485129117965698
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 7.753 Vali Acc: 0.769 Test Loss: 7.753 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.457962512969971
Epoch: 14, Steps: 17 | Train Loss: 0.222 Vali Loss: 8.649 Vali Acc: 0.723 Test Loss: 8.649 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 891761799
model size : 3407.47MB
2025-04-28 12:09:13.698703: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:09:13.718236: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745842153.741606 1484193 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745842153.748670 1484193 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:09:13.772122: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.50027871131897
Epoch: 1, Steps: 17 | Train Loss: 1.932 Vali Loss: 0.961 Vali Acc: 0.584 Test Loss: 0.961 Test Acc: 0.584
Validation loss decreased (inf --> -0.583805).  Saving model ...
Epoch: 2 cost time: 6.21306300163269
Epoch: 2, Steps: 17 | Train Loss: 0.422 Vali Loss: 1.178 Vali Acc: 0.763 Test Loss: 1.178 Test Acc: 0.763
Validation loss decreased (-0.583805 --> -0.762994).  Saving model ...
Epoch: 3 cost time: 6.205411195755005
Epoch: 3, Steps: 17 | Train Loss: 0.175 Vali Loss: 2.578 Vali Acc: 0.607 Test Loss: 2.578 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.1973936557769775
Epoch: 4, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.104 Vali Acc: 0.711 Test Loss: 2.104 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.170433282852173
Epoch: 5, Steps: 17 | Train Loss: 0.231 Vali Loss: 3.090 Vali Acc: 0.665 Test Loss: 3.090 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.180671215057373
Epoch: 6, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.641 Vali Acc: 0.763 Test Loss: 2.641 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.18863844871521
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 2.440 Vali Acc: 0.786 Test Loss: 2.440 Test Acc: 0.786
Validation loss decreased (-0.762994 --> -0.786103).  Saving model ...
Epoch: 8 cost time: 6.231179714202881
Epoch: 8, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.815 Vali Acc: 0.786 Test Loss: 1.815 Test Acc: 0.786
Validation loss decreased (-0.786103 --> -0.786109).  Saving model ...
Epoch: 9 cost time: 6.205083847045898
Epoch: 9, Steps: 17 | Train Loss: 0.052 Vali Loss: 2.805 Vali Acc: 0.734 Test Loss: 2.805 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.176634311676025
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 3.328 Vali Acc: 0.769 Test Loss: 3.328 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.1896703243255615
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.103 Vali Acc: 0.792 Test Loss: 1.103 Test Acc: 0.792
Validation loss decreased (-0.786109 --> -0.791896).  Saving model ...
Epoch: 12 cost time: 6.219233512878418
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 3.394 Vali Acc: 0.763 Test Loss: 3.394 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.193042755126953
Epoch: 13, Steps: 17 | Train Loss: 0.218 Vali Loss: 3.889 Vali Acc: 0.653 Test Loss: 3.889 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.188321590423584
Epoch: 14, Steps: 17 | Train Loss: 0.087 Vali Loss: 4.972 Vali Acc: 0.717 Test Loss: 4.972 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.177315950393677
Epoch: 15, Steps: 17 | Train Loss: 0.745 Vali Loss: 4.871 Vali Acc: 0.723 Test Loss: 4.871 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.178142070770264
Epoch: 16, Steps: 17 | Train Loss: 0.442 Vali Loss: 5.666 Vali Acc: 0.711 Test Loss: 5.666 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.193958520889282
Epoch: 17, Steps: 17 | Train Loss: 0.597 Vali Loss: 12.214 Vali Acc: 0.711 Test Loss: 12.214 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.1864142417907715
Epoch: 18, Steps: 17 | Train Loss: 0.099 Vali Loss: 11.634 Vali Acc: 0.688 Test Loss: 11.634 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.183698654174805
Epoch: 19, Steps: 17 | Train Loss: 0.087 Vali Loss: 8.605 Vali Acc: 0.688 Test Loss: 8.605 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.217657566070557
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 11.661 Vali Acc: 0.746 Test Loss: 11.661 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.177433967590332
Epoch: 21, Steps: 17 | Train Loss: 0.096 Vali Loss: 13.454 Vali Acc: 0.723 Test Loss: 13.454 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 888311303
model size : 3394.31MB
2025-04-28 12:13:46.155515: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:13:46.174513: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745842426.197368 1494333 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745842426.204422 1494333 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:13:46.228039: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.51099419593811
Epoch: 1, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.194 Vali Acc: 0.711 Test Loss: 1.194 Test Acc: 0.711
Validation loss decreased (inf --> -0.710971).  Saving model ...
Epoch: 2 cost time: 6.318293809890747
Epoch: 2, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.885 Vali Acc: 0.763 Test Loss: 0.885 Test Acc: 0.763
Validation loss decreased (-0.710971 --> -0.762997).  Saving model ...
Epoch: 3 cost time: 6.350043773651123
Epoch: 3, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.910 Vali Acc: 0.769 Test Loss: 0.910 Test Acc: 0.769
Validation loss decreased (-0.762997 --> -0.768777).  Saving model ...
Epoch: 4 cost time: 6.316713094711304
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.330 Vali Acc: 0.734 Test Loss: 1.330 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.275546073913574
Epoch: 5, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.964 Vali Acc: 0.734 Test Loss: 1.964 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.278373956680298
Epoch: 6, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.839 Vali Acc: 0.751 Test Loss: 1.839 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.281498193740845
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.146 Vali Acc: 0.769 Test Loss: 2.146 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.2325263023376465
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.809 Vali Acc: 0.717 Test Loss: 2.809 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.228789567947388
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 3.512 Vali Acc: 0.780 Test Loss: 3.512 Test Acc: 0.780
Validation loss decreased (-0.768777 --> -0.780312).  Saving model ...
Epoch: 10 cost time: 6.26073145866394
Epoch: 10, Steps: 17 | Train Loss: 0.204 Vali Loss: 3.323 Vali Acc: 0.769 Test Loss: 3.323 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.231410264968872
Epoch: 11, Steps: 17 | Train Loss: 0.095 Vali Loss: 2.619 Vali Acc: 0.798 Test Loss: 2.619 Test Acc: 0.798
Validation loss decreased (-0.780312 --> -0.797662).  Saving model ...
Epoch: 12 cost time: 6.268593072891235
Epoch: 12, Steps: 17 | Train Loss: 0.109 Vali Loss: 5.235 Vali Acc: 0.757 Test Loss: 5.235 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.239379644393921
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 6.081 Vali Acc: 0.780 Test Loss: 6.081 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.229014158248901
Epoch: 14, Steps: 17 | Train Loss: 0.329 Vali Loss: 5.220 Vali Acc: 0.757 Test Loss: 5.220 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.241951942443848
Epoch: 15, Steps: 17 | Train Loss: 0.485 Vali Loss: 6.003 Vali Acc: 0.775 Test Loss: 6.003 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.243082046508789
Epoch: 16, Steps: 17 | Train Loss: 0.162 Vali Loss: 5.753 Vali Acc: 0.775 Test Loss: 5.753 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.25882363319397
Epoch: 17, Steps: 17 | Train Loss: 0.278 Vali Loss: 6.189 Vali Acc: 0.769 Test Loss: 6.189 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.229865312576294
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.430 Vali Acc: 0.769 Test Loss: 6.430 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.225025415420532
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.177 Vali Acc: 0.780 Test Loss: 6.177 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.248497486114502
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.961 Vali Acc: 0.780 Test Loss: 5.961 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.25190544128418
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.827 Vali Acc: 0.780 Test Loss: 5.827 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 886586503
model size : 3387.73MB
2025-04-28 12:18:15.465269: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:18:15.483912: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745842695.505822 1504448 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745842695.512555 1504448 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:18:15.535029: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.802973508834839
Epoch: 1, Steps: 17 | Train Loss: 3.117 Vali Loss: 4.544 Vali Acc: 0.630 Test Loss: 4.544 Test Acc: 0.630
Validation loss decreased (inf --> -0.630012).  Saving model ...
Epoch: 2 cost time: 5.571285963058472
Epoch: 2, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.438 Vali Acc: 0.734 Test Loss: 2.438 Test Acc: 0.734
Validation loss decreased (-0.630012 --> -0.734080).  Saving model ...
Epoch: 3 cost time: 5.5687479972839355
Epoch: 3, Steps: 17 | Train Loss: 0.561 Vali Loss: 2.765 Vali Acc: 0.792 Test Loss: 2.765 Test Acc: 0.792
Validation loss decreased (-0.734080 --> -0.791880).  Saving model ...
Epoch: 4 cost time: 5.619131088256836
Epoch: 4, Steps: 17 | Train Loss: 0.147 Vali Loss: 10.230 Vali Acc: 0.607 Test Loss: 10.230 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.5794994831085205
Epoch: 5, Steps: 17 | Train Loss: 0.618 Vali Loss: 8.068 Vali Acc: 0.653 Test Loss: 8.068 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.5827391147613525
Epoch: 6, Steps: 17 | Train Loss: 0.446 Vali Loss: 5.444 Vali Acc: 0.757 Test Loss: 5.444 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.570379257202148
Epoch: 7, Steps: 17 | Train Loss: 0.610 Vali Loss: 4.115 Vali Acc: 0.769 Test Loss: 4.115 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.585059404373169
Epoch: 8, Steps: 17 | Train Loss: 0.240 Vali Loss: 6.648 Vali Acc: 0.653 Test Loss: 6.648 Test Acc: 0.653
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.572826862335205
Epoch: 9, Steps: 17 | Train Loss: 0.402 Vali Loss: 5.194 Vali Acc: 0.763 Test Loss: 5.194 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.567892789840698
Epoch: 10, Steps: 17 | Train Loss: 0.572 Vali Loss: 10.281 Vali Acc: 0.728 Test Loss: 10.281 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.565093755722046
Epoch: 11, Steps: 17 | Train Loss: 0.437 Vali Loss: 9.092 Vali Acc: 0.676 Test Loss: 9.092 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.556722402572632
Epoch: 12, Steps: 17 | Train Loss: 0.162 Vali Loss: 9.034 Vali Acc: 0.723 Test Loss: 9.034 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.5692150592803955
Epoch: 13, Steps: 17 | Train Loss: 0.255 Vali Loss: 7.720 Vali Acc: 0.775 Test Loss: 7.720 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 431441479
model size : 1648.67MB
2025-04-28 12:20:37.479618: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:20:37.498660: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745842837.521345 1510683 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745842837.528477 1510683 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:20:37.551831: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.576734304428101
Epoch: 1, Steps: 17 | Train Loss: 2.446 Vali Loss: 1.340 Vali Acc: 0.682 Test Loss: 1.340 Test Acc: 0.682
Validation loss decreased (inf --> -0.682068).  Saving model ...
Epoch: 2 cost time: 4.401996612548828
Epoch: 2, Steps: 17 | Train Loss: 1.111 Vali Loss: 2.077 Vali Acc: 0.717 Test Loss: 2.077 Test Acc: 0.717
Validation loss decreased (-0.682068 --> -0.716742).  Saving model ...
Epoch: 3 cost time: 4.4301323890686035
Epoch: 3, Steps: 17 | Train Loss: 0.348 Vali Loss: 2.112 Vali Acc: 0.682 Test Loss: 2.112 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.360491991043091
Epoch: 4, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.825 Vali Acc: 0.751 Test Loss: 1.825 Test Acc: 0.751
Validation loss decreased (-0.716742 --> -0.751427).  Saving model ...
Epoch: 5 cost time: 4.406882286071777
Epoch: 5, Steps: 17 | Train Loss: 0.169 Vali Loss: 3.577 Vali Acc: 0.705 Test Loss: 3.577 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.3824076652526855
Epoch: 6, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.725 Vali Acc: 0.751 Test Loss: 2.725 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.375809669494629
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 3.346 Vali Acc: 0.717 Test Loss: 3.346 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.360976219177246
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 2.538 Vali Acc: 0.798 Test Loss: 2.538 Test Acc: 0.798
Validation loss decreased (-0.751427 --> -0.797662).  Saving model ...
Epoch: 9 cost time: 4.366967439651489
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 3.492 Vali Acc: 0.740 Test Loss: 3.492 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.345636367797852
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 3.455 Vali Acc: 0.775 Test Loss: 3.455 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.330394744873047
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 4.351 Vali Acc: 0.780 Test Loss: 4.351 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.335351943969727
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 5.278 Vali Acc: 0.694 Test Loss: 5.278 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.3367860317230225
Epoch: 13, Steps: 17 | Train Loss: 0.115 Vali Loss: 6.395 Vali Acc: 0.659 Test Loss: 6.395 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.352560758590698
Epoch: 14, Steps: 17 | Train Loss: 0.347 Vali Loss: 7.254 Vali Acc: 0.717 Test Loss: 7.254 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.3326520919799805
Epoch: 15, Steps: 17 | Train Loss: 0.268 Vali Loss: 5.740 Vali Acc: 0.780 Test Loss: 5.740 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.364577054977417
Epoch: 16, Steps: 17 | Train Loss: 0.111 Vali Loss: 8.138 Vali Acc: 0.642 Test Loss: 8.138 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.360086917877197
Epoch: 17, Steps: 17 | Train Loss: 0.108 Vali Loss: 5.300 Vali Acc: 0.803 Test Loss: 5.300 Test Acc: 0.803
Validation loss decreased (-0.797662 --> -0.803415).  Saving model ...
Epoch: 18 cost time: 4.390533924102783
Epoch: 18, Steps: 17 | Train Loss: 0.156 Vali Loss: 11.625 Vali Acc: 0.659 Test Loss: 11.625 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.345855236053467
Epoch: 19, Steps: 17 | Train Loss: 0.180 Vali Loss: 4.723 Vali Acc: 0.827 Test Loss: 4.723 Test Acc: 0.827
Validation loss decreased (-0.803415 --> -0.826542).  Saving model ...
Epoch: 20 cost time: 4.391463994979858
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 8.146 Vali Acc: 0.769 Test Loss: 8.146 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.33771276473999
Epoch: 21, Steps: 17 | Train Loss: 0.270 Vali Loss: 4.722 Vali Acc: 0.827 Test Loss: 4.722 Test Acc: 0.827
Validation loss decreased (-0.826542 --> -0.826542).  Saving model ...
Epoch: 22 cost time: 4.42253851890564
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 19.699 Vali Acc: 0.630 Test Loss: 19.699 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.35594916343689
Epoch: 23, Steps: 17 | Train Loss: 0.394 Vali Loss: 6.059 Vali Acc: 0.763 Test Loss: 6.059 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.3749871253967285
Epoch: 24, Steps: 17 | Train Loss: 0.441 Vali Loss: 13.243 Vali Acc: 0.734 Test Loss: 13.243 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.35271143913269
Epoch: 25, Steps: 17 | Train Loss: 0.111 Vali Loss: 16.134 Vali Acc: 0.665 Test Loss: 16.134 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.356126308441162
Epoch: 26, Steps: 17 | Train Loss: 0.462 Vali Loss: 11.924 Vali Acc: 0.809 Test Loss: 11.924 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.365864038467407
Epoch: 27, Steps: 17 | Train Loss: 0.404 Vali Loss: 16.822 Vali Acc: 0.757 Test Loss: 16.822 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.344164848327637
Epoch: 28, Steps: 17 | Train Loss: 0.307 Vali Loss: 17.838 Vali Acc: 0.659 Test Loss: 17.838 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.345188140869141
Epoch: 29, Steps: 17 | Train Loss: 0.606 Vali Loss: 27.531 Vali Acc: 0.705 Test Loss: 27.531 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.347045421600342
Epoch: 30, Steps: 17 | Train Loss: 0.447 Vali Loss: 15.648 Vali Acc: 0.746 Test Loss: 15.648 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.3591468334198
Epoch: 31, Steps: 17 | Train Loss: 0.185 Vali Loss: 18.690 Vali Acc: 0.757 Test Loss: 18.690 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 415910471
model size : 1589.42MB
2025-04-28 12:24:50.920569: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:24:50.939750: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745843090.962508 1524939 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745843090.969503 1524939 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:24:50.992460: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.154867887496948
Epoch: 1, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.335 Vali Acc: 0.636 Test Loss: 1.335 Test Acc: 0.636
Validation loss decreased (inf --> -0.635825).  Saving model ...
Epoch: 2 cost time: 3.899308443069458
Epoch: 2, Steps: 17 | Train Loss: 0.526 Vali Loss: 1.226 Vali Acc: 0.786 Test Loss: 1.226 Test Acc: 0.786
Validation loss decreased (-0.635825 --> -0.786115).  Saving model ...
Epoch: 3 cost time: 3.85868501663208
Epoch: 3, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.070 Vali Acc: 0.757 Test Loss: 1.070 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8422775268554688
Epoch: 4, Steps: 17 | Train Loss: 0.016 Vali Loss: 2.445 Vali Acc: 0.671 Test Loss: 2.445 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.874572277069092
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.163 Vali Acc: 0.734 Test Loss: 2.163 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.8488337993621826
Epoch: 6, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.679 Vali Acc: 0.769 Test Loss: 1.679 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.8665099143981934
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.607 Vali Acc: 0.763 Test Loss: 1.607 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.8688862323760986
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.658 Vali Acc: 0.792 Test Loss: 1.658 Test Acc: 0.792
Validation loss decreased (-0.786115 --> -0.791891).  Saving model ...
Epoch: 9 cost time: 3.9305965900421143
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.794 Vali Acc: 0.780 Test Loss: 1.794 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8862643241882324
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.917 Vali Acc: 0.734 Test Loss: 1.917 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.861002206802368
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.728 Test Loss: 2.233 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8565096855163574
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.728 Test Loss: 2.196 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.852896213531494
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.728 Test Loss: 2.136 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.864729642868042
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.117 Vali Acc: 0.728 Test Loss: 2.117 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.889887809753418
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.125 Vali Acc: 0.728 Test Loss: 2.125 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.8634159564971924
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.105 Vali Acc: 0.728 Test Loss: 2.105 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.8765454292297363
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.728 Test Loss: 2.086 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.8709557056427
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.070 Vali Acc: 0.728 Test Loss: 2.070 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 410733575
model size : 1569.67MB
2025-04-28 12:27:14.469591: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:27:14.488531: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745843234.511206 1533283 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745843234.518266 1533283 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:27:14.540900: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.068256855010986
Epoch: 1, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.355 Vali Acc: 0.630 Test Loss: 1.355 Test Acc: 0.630
Validation loss decreased (inf --> -0.630044).  Saving model ...
Epoch: 2 cost time: 3.7615771293640137
Epoch: 2, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.397 Vali Acc: 0.734 Test Loss: 1.397 Test Acc: 0.734
Validation loss decreased (-0.630044 --> -0.734090).  Saving model ...
Epoch: 3 cost time: 3.79789137840271
Epoch: 3, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.216 Vali Acc: 0.740 Test Loss: 1.216 Test Acc: 0.740
Validation loss decreased (-0.734090 --> -0.739872).  Saving model ...
Epoch: 4 cost time: 3.7886757850646973
Epoch: 4, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.330 Vali Acc: 0.780 Test Loss: 1.330 Test Acc: 0.780
Validation loss decreased (-0.739872 --> -0.780334).  Saving model ...
Epoch: 5 cost time: 3.7933738231658936
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.314 Vali Acc: 0.809 Test Loss: 1.314 Test Acc: 0.809
Validation loss decreased (-0.780334 --> -0.809235).  Saving model ...
Epoch: 6 cost time: 3.7824952602386475
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.661 Vali Acc: 0.786 Test Loss: 1.661 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7672805786132812
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.433 Vali Acc: 0.815 Test Loss: 1.433 Test Acc: 0.815
Validation loss decreased (-0.809235 --> -0.815015).  Saving model ...
Epoch: 8 cost time: 3.834350109100342
Epoch: 8, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.869 Vali Acc: 0.757 Test Loss: 1.869 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.756361246109009
Epoch: 9, Steps: 17 | Train Loss: 0.153 Vali Loss: 3.079 Vali Acc: 0.751 Test Loss: 3.079 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.771578788757324
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.161 Vali Acc: 0.763 Test Loss: 1.161 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7617945671081543
Epoch: 11, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.306 Vali Acc: 0.803 Test Loss: 1.306 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.7608370780944824
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 2.749 Vali Acc: 0.751 Test Loss: 2.749 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7578606605529785
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.231 Vali Acc: 0.803 Test Loss: 2.231 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.763537883758545
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 3.161 Vali Acc: 0.769 Test Loss: 3.161 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7542595863342285
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.609 Vali Acc: 0.803 Test Loss: 1.609 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.761059045791626
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 2.813 Vali Acc: 0.786 Test Loss: 2.813 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.7737438678741455
Epoch: 17, Steps: 17 | Train Loss: 0.081 Vali Loss: 5.509 Vali Acc: 0.723 Test Loss: 5.509 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 408145287
model size : 1559.80MB
2025-04-28 12:29:40.045140: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:29:40.064564: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745843380.089708 1541218 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745843380.096729 1541218 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:29:40.119933: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.194639444351196
Epoch: 1, Steps: 17 | Train Loss: 1.711 Vali Loss: 1.029 Vali Acc: 0.613 Test Loss: 1.029 Test Acc: 0.613
Validation loss decreased (inf --> -0.612706).  Saving model ...
Epoch: 2 cost time: 4.079146146774292
Epoch: 2, Steps: 17 | Train Loss: 0.339 Vali Loss: 1.096 Vali Acc: 0.688 Test Loss: 1.096 Test Acc: 0.688
Validation loss decreased (-0.612706 --> -0.687850).  Saving model ...
Epoch: 3 cost time: 4.061930179595947
Epoch: 3, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.919 Vali Acc: 0.694 Test Loss: 1.919 Test Acc: 0.694
Validation loss decreased (-0.687850 --> -0.693622).  Saving model ...
Epoch: 4 cost time: 4.045565843582153
Epoch: 4, Steps: 17 | Train Loss: 0.498 Vali Loss: 2.984 Vali Acc: 0.682 Test Loss: 2.984 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.041412115097046
Epoch: 5, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.065 Vali Acc: 0.780 Test Loss: 1.065 Test Acc: 0.780
Validation loss decreased (-0.693622 --> -0.780336).  Saving model ...
Epoch: 6 cost time: 4.055438995361328
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.619 Vali Acc: 0.711 Test Loss: 1.619 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.047343492507935
Epoch: 7, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.120 Vali Acc: 0.746 Test Loss: 2.120 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.042510986328125
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.040 Vali Acc: 0.717 Test Loss: 2.040 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.039004325866699
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.301 Vali Acc: 0.775 Test Loss: 1.301 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.023465633392334
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.264 Vali Acc: 0.728 Test Loss: 2.264 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.0414063930511475
Epoch: 11, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.727 Vali Acc: 0.809 Test Loss: 1.727 Test Acc: 0.809
Validation loss decreased (-0.780336 --> -0.809231).  Saving model ...
Epoch: 12 cost time: 4.082665681838989
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 4.929 Vali Acc: 0.653 Test Loss: 4.929 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.024143218994141
Epoch: 13, Steps: 17 | Train Loss: 0.296 Vali Loss: 3.635 Vali Acc: 0.647 Test Loss: 3.635 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.027060270309448
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 3.453 Vali Acc: 0.798 Test Loss: 3.453 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.02194356918335
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 3.635 Vali Acc: 0.769 Test Loss: 3.635 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.032860040664673
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.899 Vali Acc: 0.751 Test Loss: 2.899 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.01963210105896
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 3.583 Vali Acc: 0.751 Test Loss: 3.583 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.02653431892395
Epoch: 18, Steps: 17 | Train Loss: 0.059 Vali Loss: 3.939 Vali Acc: 0.769 Test Loss: 3.939 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.027884006500244
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 3.303 Vali Acc: 0.769 Test Loss: 3.303 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.027340650558472
Epoch: 20, Steps: 17 | Train Loss: 0.311 Vali Loss: 5.685 Vali Acc: 0.775 Test Loss: 5.685 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.033384561538696
Epoch: 21, Steps: 17 | Train Loss: 0.212 Vali Loss: 4.827 Vali Acc: 0.705 Test Loss: 4.827 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 406420039
model size : 1553.22MB
2025-04-28 12:32:32.218717: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:32:32.238710: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745843552.262816 1550936 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745843552.270147 1550936 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:32:32.294299: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.089117765426636
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 0.802 Vali Acc: 0.671 Test Loss: 0.802 Test Acc: 0.671
Validation loss decreased (inf --> -0.670512).  Saving model ...
Epoch: 2 cost time: 3.8695054054260254
Epoch: 2, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.790 Vali Acc: 0.613 Test Loss: 1.790 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7890892028808594
Epoch: 3, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.530 Vali Acc: 0.688 Test Loss: 1.530 Test Acc: 0.688
Validation loss decreased (-0.670512 --> -0.687846).  Saving model ...
Epoch: 4 cost time: 4.146298408508301
Epoch: 4, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.605 Vali Acc: 0.642 Test Loss: 1.605 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.755575180053711
Epoch: 5, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.230 Vali Acc: 0.803 Test Loss: 1.230 Test Acc: 0.803
Validation loss decreased (-0.687846 --> -0.803456).  Saving model ...
Epoch: 6 cost time: 3.7964751720428467
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.987 Vali Acc: 0.786 Test Loss: 0.987 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.789358139038086
Epoch: 7, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.233 Vali Acc: 0.763 Test Loss: 1.233 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7683866024017334
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.757 Vali Acc: 0.786 Test Loss: 1.757 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.770859956741333
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.875 Vali Acc: 0.832 Test Loss: 0.875 Test Acc: 0.832
Validation loss decreased (-0.803456 --> -0.832361).  Saving model ...
Epoch: 10 cost time: 3.7892627716064453
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.806 Vali Acc: 0.827 Test Loss: 0.806 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7635955810546875
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.841 Vali Acc: 0.809 Test Loss: 0.841 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.765576124191284
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.089 Vali Acc: 0.792 Test Loss: 2.089 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7844691276550293
Epoch: 13, Steps: 17 | Train Loss: 0.161 Vali Loss: 1.170 Vali Acc: 0.838 Test Loss: 1.170 Test Acc: 0.838
Validation loss decreased (-0.832361 --> -0.838139).  Saving model ...
Epoch: 14 cost time: 3.815044403076172
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 2.274 Vali Acc: 0.838 Test Loss: 2.274 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7793030738830566
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 6.679 Vali Acc: 0.711 Test Loss: 6.679 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7694613933563232
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 3.327 Vali Acc: 0.728 Test Loss: 3.327 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.766935110092163
Epoch: 17, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.445 Vali Acc: 0.751 Test Loss: 3.445 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8192827701568604
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 3.496 Vali Acc: 0.780 Test Loss: 3.496 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7644879817962646
Epoch: 19, Steps: 17 | Train Loss: 0.162 Vali Loss: 6.100 Vali Acc: 0.757 Test Loss: 6.100 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7816355228424072
Epoch: 20, Steps: 17 | Train Loss: 0.254 Vali Loss: 4.180 Vali Acc: 0.803 Test Loss: 4.180 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.802379608154297
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 3.915 Vali Acc: 0.803 Test Loss: 3.915 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7787818908691406
Epoch: 22, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.993 Vali Acc: 0.803 Test Loss: 3.993 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.7922885417938232
Epoch: 23, Steps: 17 | Train Loss: 0.083 Vali Loss: 5.018 Vali Acc: 0.786 Test Loss: 5.018 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 404694791
model size : 1546.64MB
2025-04-28 12:35:29.930395: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:35:29.949647: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745843729.972622 1561524 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745843729.979758 1561524 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:35:30.002939: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.042483568191528
Epoch: 1, Steps: 17 | Train Loss: 1.678 Vali Loss: 0.911 Vali Acc: 0.555 Test Loss: 0.911 Test Acc: 0.555
Validation loss decreased (inf --> -0.554904).  Saving model ...
Epoch: 2 cost time: 3.9711833000183105
Epoch: 2, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.693 Vali Acc: 0.757 Test Loss: 0.693 Test Acc: 0.757
Validation loss decreased (-0.554904 --> -0.757219).  Saving model ...
Epoch: 3 cost time: 3.738515615463257
Epoch: 3, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.622 Vali Acc: 0.694 Test Loss: 1.622 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.662933111190796
Epoch: 4, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.405 Vali Acc: 0.682 Test Loss: 1.405 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6721248626708984
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.778 Vali Acc: 0.809 Test Loss: 0.778 Test Acc: 0.809
Validation loss decreased (-0.757219 --> -0.809241).  Saving model ...
Epoch: 6 cost time: 3.698612928390503
Epoch: 6, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.089 Vali Acc: 0.769 Test Loss: 1.089 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7057511806488037
Epoch: 7, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.547 Vali Acc: 0.809 Test Loss: 1.547 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6669721603393555
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.309 Vali Acc: 0.780 Test Loss: 1.309 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.687791585922241
Epoch: 9, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.340 Vali Acc: 0.827 Test Loss: 1.340 Test Acc: 0.827
Validation loss decreased (-0.809241 --> -0.826576).  Saving model ...
Epoch: 10 cost time: 3.741180896759033
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.882 Vali Acc: 0.780 Test Loss: 1.882 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.664093255996704
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.725 Vali Acc: 0.803 Test Loss: 1.725 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6589581966400146
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.682 Vali Acc: 0.775 Test Loss: 1.682 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6878037452697754
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.384 Vali Acc: 0.803 Test Loss: 2.384 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6697206497192383
Epoch: 14, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.362 Vali Acc: 0.780 Test Loss: 2.362 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6639151573181152
Epoch: 15, Steps: 17 | Train Loss: 0.129 Vali Loss: 2.739 Vali Acc: 0.757 Test Loss: 2.739 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6760034561157227
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.911 Vali Acc: 0.809 Test Loss: 1.911 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.6860835552215576
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.827 Test Loss: 1.677 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.672010660171509
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.815 Test Loss: 1.684 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.6866841316223145
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.815 Test Loss: 1.659 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 403832391
model size : 1543.35MB
2025-04-28 12:37:56.180502: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:37:56.199888: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745843876.223568 1570302 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745843876.230932 1570302 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:37:56.255532: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.701771974563599
Epoch: 1, Steps: 17 | Train Loss: 2.278 Vali Loss: 3.248 Vali Acc: 0.572 Test Loss: 3.248 Test Acc: 0.572
Validation loss decreased (inf --> -0.572222).  Saving model ...
Epoch: 2 cost time: 3.628279685974121
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 3.401 Vali Acc: 0.595 Test Loss: 3.401 Test Acc: 0.595
Validation loss decreased (-0.572222 --> -0.595342).  Saving model ...
Epoch: 3 cost time: 3.6299941539764404
Epoch: 3, Steps: 17 | Train Loss: 1.027 Vali Loss: 2.660 Vali Acc: 0.751 Test Loss: 2.660 Test Acc: 0.751
Validation loss decreased (-0.595342 --> -0.751418).  Saving model ...
Epoch: 4 cost time: 3.618140459060669
Epoch: 4, Steps: 17 | Train Loss: 1.015 Vali Loss: 7.979 Vali Acc: 0.618 Test Loss: 7.979 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.583866596221924
Epoch: 5, Steps: 17 | Train Loss: 0.345 Vali Loss: 4.493 Vali Acc: 0.746 Test Loss: 4.493 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.6200835704803467
Epoch: 6, Steps: 17 | Train Loss: 0.159 Vali Loss: 5.093 Vali Acc: 0.728 Test Loss: 5.093 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.589590072631836
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 3.145 Vali Acc: 0.809 Test Loss: 3.145 Test Acc: 0.809
Validation loss decreased (-0.751418 --> -0.809217).  Saving model ...
Epoch: 8 cost time: 3.63002872467041
Epoch: 8, Steps: 17 | Train Loss: 0.071 Vali Loss: 3.214 Vali Acc: 0.740 Test Loss: 3.214 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.594909429550171
Epoch: 9, Steps: 17 | Train Loss: 0.320 Vali Loss: 4.121 Vali Acc: 0.746 Test Loss: 4.121 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5747578144073486
Epoch: 10, Steps: 17 | Train Loss: 0.086 Vali Loss: 5.796 Vali Acc: 0.723 Test Loss: 5.796 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5902607440948486
Epoch: 11, Steps: 17 | Train Loss: 0.123 Vali Loss: 6.239 Vali Acc: 0.653 Test Loss: 6.239 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.578423261642456
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 4.396 Vali Acc: 0.711 Test Loss: 4.396 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6186769008636475
Epoch: 13, Steps: 17 | Train Loss: 0.244 Vali Loss: 3.021 Vali Acc: 0.775 Test Loss: 3.021 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5980734825134277
Epoch: 14, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.957 Vali Acc: 0.832 Test Loss: 1.957 Test Acc: 0.832
Validation loss decreased (-0.809217 --> -0.832350).  Saving model ...
Epoch: 15 cost time: 3.6440927982330322
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 3.558 Vali Acc: 0.757 Test Loss: 3.558 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6204776763916016
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 7.960 Vali Acc: 0.676 Test Loss: 7.960 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6367430686950684
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 5.724 Vali Acc: 0.763 Test Loss: 5.724 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6011414527893066
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 10.149 Vali Acc: 0.717 Test Loss: 10.149 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6048896312713623
Epoch: 19, Steps: 17 | Train Loss: 0.152 Vali Loss: 9.569 Vali Acc: 0.694 Test Loss: 9.569 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.596421718597412
Epoch: 20, Steps: 17 | Train Loss: 0.377 Vali Loss: 5.426 Vali Acc: 0.740 Test Loss: 5.426 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.572261095046997
Epoch: 21, Steps: 17 | Train Loss: 0.069 Vali Loss: 12.492 Vali Acc: 0.618 Test Loss: 12.492 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.59214186668396
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 9.870 Vali Acc: 0.717 Test Loss: 9.870 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.58717942237854
Epoch: 23, Steps: 17 | Train Loss: 0.203 Vali Loss: 6.704 Vali Acc: 0.746 Test Loss: 6.704 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.602431535720825
Epoch: 24, Steps: 17 | Train Loss: 0.133 Vali Loss: 10.617 Vali Acc: 0.699 Test Loss: 10.617 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 205855527
model size : 786.71MB
2025-04-28 12:40:44.955023: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:40:44.974683: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745844044.997721 1581271 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745844045.004764 1581271 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:40:45.028059: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.199979782104492
Epoch: 1, Steps: 17 | Train Loss: 1.767 Vali Loss: 2.104 Vali Acc: 0.578 Test Loss: 2.104 Test Acc: 0.578
Validation loss decreased (inf --> -0.578014).  Saving model ...
Epoch: 2 cost time: 2.874676465988159
Epoch: 2, Steps: 17 | Train Loss: 0.745 Vali Loss: 1.830 Vali Acc: 0.711 Test Loss: 1.830 Test Acc: 0.711
Validation loss decreased (-0.578014 --> -0.710964).  Saving model ...
Epoch: 3 cost time: 2.892406940460205
Epoch: 3, Steps: 17 | Train Loss: 0.333 Vali Loss: 2.167 Vali Acc: 0.728 Test Loss: 2.167 Test Acc: 0.728
Validation loss decreased (-0.710964 --> -0.728302).  Saving model ...
Epoch: 4 cost time: 2.8760159015655518
Epoch: 4, Steps: 17 | Train Loss: 0.251 Vali Loss: 2.999 Vali Acc: 0.688 Test Loss: 2.999 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.867907762527466
Epoch: 5, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.858 Vali Acc: 0.671 Test Loss: 3.858 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.85390043258667
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 3.725 Vali Acc: 0.676 Test Loss: 3.725 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8685710430145264
Epoch: 7, Steps: 17 | Train Loss: 0.083 Vali Loss: 2.883 Vali Acc: 0.769 Test Loss: 2.883 Test Acc: 0.769
Validation loss decreased (-0.728302 --> -0.768757).  Saving model ...
Epoch: 8 cost time: 2.8983042240142822
Epoch: 8, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.885 Vali Acc: 0.711 Test Loss: 2.885 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.882556676864624
Epoch: 9, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.891 Vali Acc: 0.786 Test Loss: 1.891 Test Acc: 0.786
Validation loss decreased (-0.768757 --> -0.786108).  Saving model ...
Epoch: 10 cost time: 2.9394724369049072
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.598 Vali Acc: 0.815 Test Loss: 1.598 Test Acc: 0.815
Validation loss decreased (-0.786108 --> -0.815013).  Saving model ...
Epoch: 11 cost time: 2.887572765350342
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.556 Vali Acc: 0.803 Test Loss: 1.556 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8741047382354736
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.055 Vali Acc: 0.763 Test Loss: 4.055 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.855350971221924
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.687 Vali Acc: 0.786 Test Loss: 2.687 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.84612774848938
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.240 Vali Acc: 0.757 Test Loss: 3.240 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.852454900741577
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.925 Vali Acc: 0.775 Test Loss: 2.925 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.868788719177246
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.798 Test Loss: 2.313 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.863816022872925
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.220 Vali Acc: 0.803 Test Loss: 2.220 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8809244632720947
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.229 Vali Acc: 0.803 Test Loss: 2.229 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.86248779296875
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.237 Vali Acc: 0.803 Test Loss: 2.237 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.893157720565796
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.191 Vali Acc: 0.803 Test Loss: 2.191 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 198090023
model size : 757.09MB
2025-04-28 12:42:46.221009: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:42:46.239867: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745844166.262368 1590361 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745844166.269424 1590361 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:42:46.292868: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8172481060028076
Epoch: 1, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.067 Vali Acc: 0.526 Test Loss: 1.067 Test Acc: 0.526
Validation loss decreased (inf --> -0.526001).  Saving model ...
Epoch: 2 cost time: 2.626201629638672
Epoch: 2, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.917 Vali Acc: 0.757 Test Loss: 0.917 Test Acc: 0.757
Validation loss decreased (-0.526001 --> -0.757216).  Saving model ...
Epoch: 3 cost time: 2.6614863872528076
Epoch: 3, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.740 Vali Acc: 0.815 Test Loss: 0.740 Test Acc: 0.815
Validation loss decreased (-0.757216 --> -0.815021).  Saving model ...
Epoch: 4 cost time: 2.644575595855713
Epoch: 4, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.521 Vali Acc: 0.717 Test Loss: 1.521 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6206254959106445
Epoch: 5, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.157 Vali Acc: 0.717 Test Loss: 2.157 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.632744312286377
Epoch: 6, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.370 Vali Acc: 0.746 Test Loss: 1.370 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.610949754714966
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.153 Vali Acc: 0.798 Test Loss: 1.153 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6119465827941895
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.960 Vali Acc: 0.757 Test Loss: 0.960 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.644258975982666
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.926 Vali Acc: 0.740 Test Loss: 1.926 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.632383108139038
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 2.076 Vali Acc: 0.746 Test Loss: 2.076 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.635653257369995
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.411 Vali Acc: 0.775 Test Loss: 1.411 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.648195266723633
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.751 Test Loss: 1.882 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.614197015762329
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.265 Vali Acc: 0.769 Test Loss: 1.265 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 195501575
model size : 747.22MB
2025-04-28 12:44:05.430742: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:44:05.449757: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745844245.472486 1596347 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745844245.479393 1596347 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:44:05.502233: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8990893363952637
Epoch: 1, Steps: 17 | Train Loss: 1.568 Vali Loss: 0.832 Vali Acc: 0.653 Test Loss: 0.832 Test Acc: 0.653
Validation loss decreased (inf --> -0.653171).  Saving model ...
Epoch: 2 cost time: 2.5865566730499268
Epoch: 2, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.579 Vali Acc: 0.792 Test Loss: 0.579 Test Acc: 0.792
Validation loss decreased (-0.653171 --> -0.791902).  Saving model ...
Epoch: 3 cost time: 2.6244750022888184
Epoch: 3, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.525 Vali Acc: 0.717 Test Loss: 1.525 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.553030490875244
Epoch: 4, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.561 Vali Acc: 0.694 Test Loss: 2.561 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5826685428619385
Epoch: 5, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.700 Vali Acc: 0.717 Test Loss: 1.700 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5872130393981934
Epoch: 6, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.417 Vali Acc: 0.775 Test Loss: 1.417 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5785861015319824
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.499 Vali Acc: 0.757 Test Loss: 1.499 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5714101791381836
Epoch: 8, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.110 Vali Acc: 0.711 Test Loss: 2.110 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.600524663925171
Epoch: 9, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.040 Vali Acc: 0.763 Test Loss: 1.040 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5725886821746826
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.821 Vali Acc: 0.821 Test Loss: 0.821 Test Acc: 0.821
Validation loss decreased (-0.791902 --> -0.820801).  Saving model ...
Epoch: 11 cost time: 2.637862205505371
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.803 Test Loss: 0.797 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5904808044433594
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.746 Test Loss: 1.048 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5710456371307373
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.751 Test Loss: 1.093 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5865728855133057
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.751 Test Loss: 1.081 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.556657314300537
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.751 Test Loss: 1.093 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.560743570327759
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.083 Vali Acc: 0.751 Test Loss: 1.083 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.596292018890381
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.751 Test Loss: 1.080 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.589951515197754
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.084 Vali Acc: 0.751 Test Loss: 1.084 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.565746307373047
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.751 Test Loss: 1.081 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.587026596069336
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.757 Test Loss: 1.068 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 194207431
model size : 742.28MB
2025-04-28 12:45:53.673131: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:45:53.692407: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745844353.715522 1605399 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745844353.722619 1605399 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:45:53.746029: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6745121479034424
Epoch: 1, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.314 Vali Acc: 0.578 Test Loss: 1.314 Test Acc: 0.578
Validation loss decreased (inf --> -0.578022).  Saving model ...
Epoch: 2 cost time: 2.5072193145751953
Epoch: 2, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
Validation loss decreased (-0.578022 --> -0.809242).  Saving model ...
Epoch: 3 cost time: 2.5758721828460693
Epoch: 3, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.805 Vali Acc: 0.757 Test Loss: 0.805 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5235636234283447
Epoch: 4, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.861 Vali Acc: 0.740 Test Loss: 0.861 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.519970655441284
Epoch: 5, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.285 Vali Acc: 0.728 Test Loss: 1.285 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5423202514648438
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.229 Vali Acc: 0.780 Test Loss: 1.229 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4979405403137207
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.202 Vali Acc: 0.792 Test Loss: 1.202 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4935922622680664
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.775 Vali Acc: 0.780 Test Loss: 1.775 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5086615085601807
Epoch: 9, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.738 Vali Acc: 0.763 Test Loss: 1.738 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5226047039031982
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.350 Vali Acc: 0.786 Test Loss: 1.350 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5175228118896484
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.757 Test Loss: 1.900 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.498906135559082
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.046 Vali Acc: 0.821 Test Loss: 1.046 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820799).  Saving model ...
Epoch: 13 cost time: 2.5519001483917236
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.279 Vali Acc: 0.746 Test Loss: 2.279 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.505152702331543
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.095 Vali Acc: 0.803 Test Loss: 1.095 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.511127233505249
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.803 Test Loss: 1.048 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.53035831451416
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.803 Test Loss: 1.070 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5015885829925537
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.803 Test Loss: 1.061 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.494065046310425
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.803 Test Loss: 1.049 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.528642177581787
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.803 Test Loss: 1.051 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.5001323223114014
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.803 Test Loss: 1.054 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5124034881591797
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.803 Test Loss: 1.046 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.521510362625122
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.803 Test Loss: 1.046 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 193344807
model size : 738.99MB
2025-04-28 12:47:46.313549: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:47:46.332786: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745844466.356104 1615298 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745844466.363202 1615298 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:47:46.387362: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.670260190963745
Epoch: 1, Steps: 17 | Train Loss: 1.533 Vali Loss: 0.921 Vali Acc: 0.642 Test Loss: 0.921 Test Acc: 0.642
Validation loss decreased (inf --> -0.641609).  Saving model ...
Epoch: 2 cost time: 2.4379167556762695
Epoch: 2, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.971 Vali Acc: 0.682 Test Loss: 0.971 Test Acc: 0.682
Validation loss decreased (-0.641609 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 2.5330870151519775
Epoch: 3, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.848 Vali Acc: 0.792 Test Loss: 0.848 Test Acc: 0.792
Validation loss decreased (-0.682071 --> -0.791899).  Saving model ...
Epoch: 4 cost time: 2.4810407161712646
Epoch: 4, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
Validation loss decreased (-0.791899 --> -0.809242).  Saving model ...
Epoch: 5 cost time: 2.479252576828003
Epoch: 5, Steps: 17 | Train Loss: 0.052 Vali Loss: 2.054 Vali Acc: 0.665 Test Loss: 2.054 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.453325033187866
Epoch: 6, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.279 Vali Acc: 0.746 Test Loss: 1.279 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4950170516967773
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.792 Test Loss: 1.032 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4720704555511475
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.815 Test Loss: 0.984 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815019).  Saving model ...
Epoch: 9 cost time: 2.5011446475982666
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.821 Test Loss: 0.911 Test Acc: 0.821
Validation loss decreased (-0.815019 --> -0.820800).  Saving model ...
Epoch: 10 cost time: 2.4798214435577393
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.827 Test Loss: 0.873 Test Acc: 0.827
Validation loss decreased (-0.820800 --> -0.826581).  Saving model ...
Epoch: 11 cost time: 2.4705777168273926
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.827 Test Loss: 0.886 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.471266508102417
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.827 Test Loss: 0.870 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 13 cost time: 2.4842727184295654
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.856 Vali Acc: 0.827 Test Loss: 0.856 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 14 cost time: 2.492684841156006
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.827 Test Loss: 0.852 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 15 cost time: 2.4656333923339844
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.827 Test Loss: 0.848 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 16 cost time: 2.4817686080932617
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.827 Test Loss: 0.848 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 17 cost time: 2.4876437187194824
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.827 Test Loss: 0.828 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 18 cost time: 2.5165517330169678
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.827 Test Loss: 0.831 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.423388719558716
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.827 Test Loss: 0.828 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 20 cost time: 2.4497451782226562
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.827 Test Loss: 0.831 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.471071481704712
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.827 Test Loss: 0.825 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 22 cost time: 2.4632861614227295
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.827 Test Loss: 0.815 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826581).  Saving model ...
Epoch: 23 cost time: 3.8558499813079834
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.827 Test Loss: 0.806 Test Acc: 0.827
Validation loss decreased (-0.826581 --> -0.826582).  Saving model ...
Epoch: 24 cost time: 2.4827072620391846
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.827 Test Loss: 0.792 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826582).  Saving model ...
Epoch: 25 cost time: 2.466042995452881
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.827 Test Loss: 0.799 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4311459064483643
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.827 Test Loss: 0.791 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826582).  Saving model ...
Epoch: 27 cost time: 2.484391450881958
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.827 Test Loss: 0.796 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4340603351593018
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.827 Test Loss: 0.802 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.4625356197357178
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.827 Test Loss: 0.794 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.445465326309204
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.827 Test Loss: 0.786 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826582).  Saving model ...
Epoch: 31 cost time: 2.4591217041015625
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.800 Vali Acc: 0.827 Test Loss: 0.800 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4519803524017334
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.827 Test Loss: 0.785 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826582).  Saving model ...
Epoch: 33 cost time: 2.4620983600616455
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.832 Test Loss: 0.780 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832362).  Saving model ...
Epoch: 34 cost time: 2.453127145767212
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.827 Test Loss: 0.786 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.438014030456543
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.827 Test Loss: 0.791 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.424508571624756
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.844 Test Loss: 0.784 Test Acc: 0.844
Validation loss decreased (-0.832362 --> -0.843923).  Saving model ...
Epoch: 37 cost time: 2.4740707874298096
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843923).  Saving model ...
Epoch: 38 cost time: 2.4761300086975098
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843923).  Saving model ...
Epoch: 39 cost time: 2.4972634315490723
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.4816854000091553
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843923).  Saving model ...
Epoch: 41 cost time: 2.4880223274230957
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.844 Test Loss: 0.770 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.4968349933624268
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.4648680686950684
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.761 Vali Acc: 0.844 Test Loss: 0.761 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843923).  Saving model ...
Epoch: 44 cost time: 3.0222678184509277
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.4941818714141846
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.844 Test Loss: 0.755 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843923).  Saving model ...
Epoch: 46 cost time: 2.4856739044189453
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843923).  Saving model ...
Epoch: 47 cost time: 2.4945664405822754
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 2.465190887451172
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.844 Test Loss: 0.764 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.475593090057373
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.844 Test Loss: 0.763 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.4911093711853027
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 192482183
model size : 735.70MB
2025-04-28 12:52:25.342629: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:52:25.362021: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745844745.384726 1637637 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745844745.391717 1637637 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:52:25.415217: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7735183238983154
Epoch: 1, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.032 Vali Acc: 0.647 Test Loss: 1.032 Test Acc: 0.647
Validation loss decreased (inf --> -0.647389).  Saving model ...
Epoch: 2 cost time: 2.5200095176696777
Epoch: 2, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.546 Vali Acc: 0.780 Test Loss: 0.546 Test Acc: 0.780
Validation loss decreased (-0.647389 --> -0.780341).  Saving model ...
Epoch: 3 cost time: 3.7547125816345215
Epoch: 3, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
Validation loss decreased (-0.780341 --> -0.843926).  Saving model ...
Epoch: 4 cost time: 2.525453567504883
Epoch: 4, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.679 Vali Acc: 0.792 Test Loss: 0.679 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.529104709625244
Epoch: 5, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.936 Vali Acc: 0.751 Test Loss: 0.936 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5318496227264404
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.589 Vali Acc: 0.815 Test Loss: 0.589 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5106353759765625
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.916 Vali Acc: 0.757 Test Loss: 0.916 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5263943672180176
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.657 Vali Acc: 0.798 Test Loss: 0.657 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5263657569885254
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.780 Test Loss: 0.693 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.501500129699707
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.589 Vali Acc: 0.832 Test Loss: 0.589 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5075113773345947
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.562 Vali Acc: 0.815 Test Loss: 0.562 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.546442985534668
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.832 Test Loss: 0.557 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.51554012298584
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.821 Test Loss: 0.564 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 192050983
model size : 734.05MB
2025-04-28 12:53:43.612203: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:53:43.631028: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745844823.652979 1643614 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745844823.659906 1643614 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:53:43.682343: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 10.750680685043335
Epoch: 1, Steps: 17 | Train Loss: 8.762 Vali Loss: 13.811 Vali Acc: 0.532 Test Loss: 13.811 Test Acc: 0.532
Validation loss decreased (inf --> -0.531654).  Saving model ...
Epoch: 2 cost time: 9.632615566253662
Epoch: 2, Steps: 17 | Train Loss: 2.894 Vali Loss: 7.903 Vali Acc: 0.572 Test Loss: 7.903 Test Acc: 0.572
Validation loss decreased (-0.531654 --> -0.572175).  Saving model ...
Epoch: 3 cost time: 9.645078182220459
Epoch: 3, Steps: 17 | Train Loss: 1.015 Vali Loss: 5.734 Vali Acc: 0.682 Test Loss: 5.734 Test Acc: 0.682
Validation loss decreased (-0.572175 --> -0.682024).  Saving model ...
Epoch: 4 cost time: 9.631499290466309
Epoch: 4, Steps: 17 | Train Loss: 0.221 Vali Loss: 3.281 Vali Acc: 0.798 Test Loss: 3.281 Test Acc: 0.798
Validation loss decreased (-0.682024 --> -0.797655).  Saving model ...
Epoch: 5 cost time: 9.59726071357727
Epoch: 5, Steps: 17 | Train Loss: 0.697 Vali Loss: 17.171 Vali Acc: 0.699 Test Loss: 17.171 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.525723934173584
Epoch: 6, Steps: 17 | Train Loss: 1.139 Vali Loss: 15.167 Vali Acc: 0.642 Test Loss: 15.167 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.537763357162476
Epoch: 7, Steps: 17 | Train Loss: 0.495 Vali Loss: 9.178 Vali Acc: 0.682 Test Loss: 9.178 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.537389278411865
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 11.539 Vali Acc: 0.728 Test Loss: 11.539 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.535613298416138
Epoch: 9, Steps: 17 | Train Loss: 0.431 Vali Loss: 10.898 Vali Acc: 0.763 Test Loss: 10.898 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 9.54274320602417
Epoch: 10, Steps: 17 | Train Loss: 0.865 Vali Loss: 11.232 Vali Acc: 0.757 Test Loss: 11.232 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.525407314300537
Epoch: 11, Steps: 17 | Train Loss: 0.591 Vali Loss: 17.432 Vali Acc: 0.682 Test Loss: 17.432 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.51736855506897
Epoch: 12, Steps: 17 | Train Loss: 1.029 Vali Loss: 12.117 Vali Acc: 0.763 Test Loss: 12.117 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 9.549019575119019
Epoch: 13, Steps: 17 | Train Loss: 0.599 Vali Loss: 10.740 Vali Acc: 0.780 Test Loss: 10.740 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 9.536343336105347
Epoch: 14, Steps: 17 | Train Loss: 0.614 Vali Loss: 23.478 Vali Acc: 0.694 Test Loss: 23.478 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 940325511
model size : 3592.73MB
2025-04-28 12:58:01.540819: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 12:58:01.560039: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745845081.583157 1650751 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745845081.590238 1650751 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 12:58:01.613485: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.572600841522217
Epoch: 1, Steps: 17 | Train Loss: 2.392 Vali Loss: 4.305 Vali Acc: 0.514 Test Loss: 4.305 Test Acc: 0.514
Validation loss decreased (inf --> -0.514408).  Saving model ...
Epoch: 2 cost time: 7.342371702194214
Epoch: 2, Steps: 17 | Train Loss: 1.482 Vali Loss: 3.738 Vali Acc: 0.653 Test Loss: 3.738 Test Acc: 0.653
Validation loss decreased (-0.514408 --> -0.653142).  Saving model ...
Epoch: 3 cost time: 7.341684818267822
Epoch: 3, Steps: 17 | Train Loss: 0.678 Vali Loss: 4.475 Vali Acc: 0.682 Test Loss: 4.475 Test Acc: 0.682
Validation loss decreased (-0.653142 --> -0.682036).  Saving model ...
Epoch: 4 cost time: 7.37022066116333
Epoch: 4, Steps: 17 | Train Loss: 0.288 Vali Loss: 1.868 Vali Acc: 0.815 Test Loss: 1.868 Test Acc: 0.815
Validation loss decreased (-0.682036 --> -0.815010).  Saving model ...
Epoch: 5 cost time: 7.344775676727295
Epoch: 5, Steps: 17 | Train Loss: 0.391 Vali Loss: 2.172 Vali Acc: 0.827 Test Loss: 2.172 Test Acc: 0.827
Validation loss decreased (-0.815010 --> -0.826568).  Saving model ...
Epoch: 6 cost time: 7.3669726848602295
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 4.824 Vali Acc: 0.798 Test Loss: 4.824 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.341287612915039
Epoch: 7, Steps: 17 | Train Loss: 0.137 Vali Loss: 5.448 Vali Acc: 0.723 Test Loss: 5.448 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.348065376281738
Epoch: 8, Steps: 17 | Train Loss: 0.337 Vali Loss: 4.484 Vali Acc: 0.798 Test Loss: 4.484 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.373678207397461
Epoch: 9, Steps: 17 | Train Loss: 0.264 Vali Loss: 7.437 Vali Acc: 0.740 Test Loss: 7.437 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.389294862747192
Epoch: 10, Steps: 17 | Train Loss: 0.361 Vali Loss: 8.393 Vali Acc: 0.676 Test Loss: 8.393 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.342912197113037
Epoch: 11, Steps: 17 | Train Loss: 0.644 Vali Loss: 13.335 Vali Acc: 0.723 Test Loss: 13.335 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.373884677886963
Epoch: 12, Steps: 17 | Train Loss: 0.399 Vali Loss: 6.331 Vali Acc: 0.844 Test Loss: 6.331 Test Acc: 0.844
Validation loss decreased (-0.826568 --> -0.843867).  Saving model ...
Epoch: 13 cost time: 7.3796093463897705
Epoch: 13, Steps: 17 | Train Loss: 0.938 Vali Loss: 11.560 Vali Acc: 0.751 Test Loss: 11.560 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.377243518829346
Epoch: 14, Steps: 17 | Train Loss: 1.137 Vali Loss: 33.158 Vali Acc: 0.653 Test Loss: 33.158 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.363714933395386
Epoch: 15, Steps: 17 | Train Loss: 0.625 Vali Loss: 19.073 Vali Acc: 0.676 Test Loss: 19.073 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.368520259857178
Epoch: 16, Steps: 17 | Train Loss: 0.493 Vali Loss: 19.911 Vali Acc: 0.717 Test Loss: 19.911 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.374105215072632
Epoch: 17, Steps: 17 | Train Loss: 0.474 Vali Loss: 14.661 Vali Acc: 0.775 Test Loss: 14.661 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.364875316619873
Epoch: 18, Steps: 17 | Train Loss: 0.931 Vali Loss: 33.748 Vali Acc: 0.723 Test Loss: 33.748 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.387576341629028
Epoch: 19, Steps: 17 | Train Loss: 0.305 Vali Loss: 11.690 Vali Acc: 0.775 Test Loss: 11.690 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.365929365158081
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 28.794 Vali Acc: 0.723 Test Loss: 28.794 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.377606391906738
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 22.423 Vali Acc: 0.671 Test Loss: 22.423 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 7.372824192047119
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 23.949 Vali Acc: 0.671 Test Loss: 23.949 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 909263495
model size : 3474.24MB
2025-04-28 13:03:18.346230: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:03:18.365346: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745845398.387990 1661484 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745845398.394986 1661484 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:03:18.418072: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.058725357055664
Epoch: 1, Steps: 17 | Train Loss: 2.982 Vali Loss: 4.128 Vali Acc: 0.491 Test Loss: 4.128 Test Acc: 0.491
Validation loss decreased (inf --> -0.491288).  Saving model ...
Epoch: 2 cost time: 6.900894403457642
Epoch: 2, Steps: 17 | Train Loss: 0.916 Vali Loss: 4.732 Vali Acc: 0.555 Test Loss: 4.732 Test Acc: 0.555
Validation loss decreased (-0.491288 --> -0.554866).  Saving model ...
Epoch: 3 cost time: 6.873262166976929
Epoch: 3, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.577 Vali Acc: 0.751 Test Loss: 2.577 Test Acc: 0.751
Validation loss decreased (-0.554866 --> -0.751419).  Saving model ...
Epoch: 4 cost time: 6.899461030960083
Epoch: 4, Steps: 17 | Train Loss: 0.230 Vali Loss: 1.966 Vali Acc: 0.798 Test Loss: 1.966 Test Acc: 0.798
Validation loss decreased (-0.751419 --> -0.797668).  Saving model ...
Epoch: 5 cost time: 6.907498121261597
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 3.817 Vali Acc: 0.757 Test Loss: 3.817 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.851189851760864
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.778 Vali Acc: 0.775 Test Loss: 1.778 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.86170506477356
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.133 Vali Acc: 0.769 Test Loss: 2.133 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.847977876663208
Epoch: 8, Steps: 17 | Train Loss: 0.060 Vali Loss: 4.709 Vali Acc: 0.734 Test Loss: 4.709 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.874069452285767
Epoch: 9, Steps: 17 | Train Loss: 0.168 Vali Loss: 3.510 Vali Acc: 0.803 Test Loss: 3.510 Test Acc: 0.803
Validation loss decreased (-0.797668 --> -0.803433).  Saving model ...
Epoch: 10 cost time: 6.877901554107666
Epoch: 10, Steps: 17 | Train Loss: 0.698 Vali Loss: 6.069 Vali Acc: 0.630 Test Loss: 6.069 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.853429079055786
Epoch: 11, Steps: 17 | Train Loss: 1.119 Vali Loss: 23.466 Vali Acc: 0.543 Test Loss: 23.466 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.855521202087402
Epoch: 12, Steps: 17 | Train Loss: 2.193 Vali Loss: 8.943 Vali Acc: 0.682 Test Loss: 8.943 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.878331899642944
Epoch: 13, Steps: 17 | Train Loss: 0.277 Vali Loss: 7.620 Vali Acc: 0.757 Test Loss: 7.620 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.849655389785767
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 10.564 Vali Acc: 0.699 Test Loss: 10.564 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.846713542938232
Epoch: 15, Steps: 17 | Train Loss: 0.510 Vali Loss: 15.652 Vali Acc: 0.717 Test Loss: 15.652 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.851878881454468
Epoch: 16, Steps: 17 | Train Loss: 0.495 Vali Loss: 11.684 Vali Acc: 0.775 Test Loss: 11.684 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.865420818328857
Epoch: 17, Steps: 17 | Train Loss: 1.386 Vali Loss: 13.772 Vali Acc: 0.786 Test Loss: 13.772 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.839001893997192
Epoch: 18, Steps: 17 | Train Loss: 0.598 Vali Loss: 19.125 Vali Acc: 0.717 Test Loss: 19.125 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.800050258636475
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 30.705 Vali Acc: 0.694 Test Loss: 30.705 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 898909703
model size : 3434.74MB
2025-04-28 13:07:54.545940: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:07:54.565941: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745845674.588590 1670799 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745845674.595517 1670799 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:07:54.618747: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.818457841873169
Epoch: 1, Steps: 17 | Train Loss: 1.791 Vali Loss: 1.734 Vali Acc: 0.671 Test Loss: 1.734 Test Acc: 0.671
Validation loss decreased (inf --> -0.670503).  Saving model ...
Epoch: 2 cost time: 6.496272563934326
Epoch: 2, Steps: 17 | Train Loss: 0.325 Vali Loss: 2.144 Vali Acc: 0.653 Test Loss: 2.144 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.49153470993042
Epoch: 3, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.605 Vali Acc: 0.711 Test Loss: 1.605 Test Acc: 0.711
Validation loss decreased (-0.670503 --> -0.710967).  Saving model ...
Epoch: 4 cost time: 6.547576904296875
Epoch: 4, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.532 Vali Acc: 0.809 Test Loss: 1.532 Test Acc: 0.809
Validation loss decreased (-0.710967 --> -0.809233).  Saving model ...
Epoch: 5 cost time: 6.546801328659058
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 3.731 Vali Acc: 0.705 Test Loss: 3.731 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.498319387435913
Epoch: 6, Steps: 17 | Train Loss: 0.296 Vali Loss: 3.844 Vali Acc: 0.792 Test Loss: 3.844 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.491720914840698
Epoch: 7, Steps: 17 | Train Loss: 0.297 Vali Loss: 3.695 Vali Acc: 0.763 Test Loss: 3.695 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.492244243621826
Epoch: 8, Steps: 17 | Train Loss: 0.117 Vali Loss: 3.331 Vali Acc: 0.763 Test Loss: 3.331 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.489908933639526
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 3.160 Vali Acc: 0.775 Test Loss: 3.160 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.513656139373779
Epoch: 10, Steps: 17 | Train Loss: 0.198 Vali Loss: 5.081 Vali Acc: 0.751 Test Loss: 5.081 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.517151355743408
Epoch: 11, Steps: 17 | Train Loss: 0.591 Vali Loss: 5.118 Vali Acc: 0.775 Test Loss: 5.118 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 6.490716457366943
Epoch: 12, Steps: 17 | Train Loss: 0.203 Vali Loss: 5.755 Vali Acc: 0.751 Test Loss: 5.755 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.492563724517822
Epoch: 13, Steps: 17 | Train Loss: 0.166 Vali Loss: 9.442 Vali Acc: 0.711 Test Loss: 9.442 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 6.502179145812988
Epoch: 14, Steps: 17 | Train Loss: 0.344 Vali Loss: 7.312 Vali Acc: 0.757 Test Loss: 7.312 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 893733127
model size : 3414.99MB
2025-04-28 13:11:05.721060: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:11:05.740623: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745845865.764216 1677656 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745845865.771862 1677656 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:11:05.796009: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.459523439407349
Epoch: 1, Steps: 17 | Train Loss: 1.870 Vali Loss: 2.338 Vali Acc: 0.624 Test Loss: 2.338 Test Acc: 0.624
Validation loss decreased (inf --> -0.624254).  Saving model ...
Epoch: 2 cost time: 6.306206703186035
Epoch: 2, Steps: 17 | Train Loss: 0.852 Vali Loss: 2.378 Vali Acc: 0.688 Test Loss: 2.378 Test Acc: 0.688
Validation loss decreased (-0.624254 --> -0.687837).  Saving model ...
Epoch: 3 cost time: 6.3560872077941895
Epoch: 3, Steps: 17 | Train Loss: 0.417 Vali Loss: 1.749 Vali Acc: 0.751 Test Loss: 1.749 Test Acc: 0.751
Validation loss decreased (-0.687837 --> -0.751428).  Saving model ...
Epoch: 4 cost time: 6.301434755325317
Epoch: 4, Steps: 17 | Train Loss: 0.203 Vali Loss: 2.522 Vali Acc: 0.642 Test Loss: 2.522 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.311438083648682
Epoch: 5, Steps: 17 | Train Loss: 0.038 Vali Loss: 2.195 Vali Acc: 0.746 Test Loss: 2.195 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.286485195159912
Epoch: 6, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.703 Vali Acc: 0.769 Test Loss: 2.703 Test Acc: 0.769
Validation loss decreased (-0.751428 --> -0.768759).  Saving model ...
Epoch: 7 cost time: 6.35991644859314
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.971 Vali Acc: 0.798 Test Loss: 2.971 Test Acc: 0.798
Validation loss decreased (-0.768759 --> -0.797658).  Saving model ...
Epoch: 8 cost time: 6.370001792907715
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 3.876 Vali Acc: 0.711 Test Loss: 3.876 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.301743745803833
Epoch: 9, Steps: 17 | Train Loss: 0.195 Vali Loss: 3.147 Vali Acc: 0.775 Test Loss: 3.147 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.329548597335815
Epoch: 10, Steps: 17 | Train Loss: 0.160 Vali Loss: 5.374 Vali Acc: 0.723 Test Loss: 5.374 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.342467546463013
Epoch: 11, Steps: 17 | Train Loss: 0.189 Vali Loss: 4.625 Vali Acc: 0.734 Test Loss: 4.625 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.325169563293457
Epoch: 12, Steps: 17 | Train Loss: 0.363 Vali Loss: 3.341 Vali Acc: 0.734 Test Loss: 3.341 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.3185999393463135
Epoch: 13, Steps: 17 | Train Loss: 0.452 Vali Loss: 7.558 Vali Acc: 0.769 Test Loss: 7.558 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.31791615486145
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 9.389 Vali Acc: 0.699 Test Loss: 9.389 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.310206890106201
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 9.880 Vali Acc: 0.763 Test Loss: 9.880 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.325397729873657
Epoch: 16, Steps: 17 | Train Loss: 0.704 Vali Loss: 6.154 Vali Acc: 0.792 Test Loss: 6.154 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.327082872390747
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 9.865 Vali Acc: 0.751 Test Loss: 9.865 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 890282631
model size : 3401.83MB
2025-04-28 13:14:58.960562: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:14:58.979673: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745846099.002761 1685951 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745846099.009784 1685951 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:14:59.033129: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.335995197296143
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 0.781 Vali Acc: 0.699 Test Loss: 0.781 Test Acc: 0.699
Validation loss decreased (inf --> -0.699414).  Saving model ...
Epoch: 2 cost time: 6.069756031036377
Epoch: 2, Steps: 17 | Train Loss: 0.626 Vali Loss: 1.810 Vali Acc: 0.676 Test Loss: 1.810 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.070350646972656
Epoch: 3, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.324 Vali Acc: 0.728 Test Loss: 1.324 Test Acc: 0.728
Validation loss decreased (-0.699414 --> -0.728310).  Saving model ...
Epoch: 4 cost time: 6.0682854652404785
Epoch: 4, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.611 Vali Acc: 0.792 Test Loss: 1.611 Test Acc: 0.792
Validation loss decreased (-0.728310 --> -0.791891).  Saving model ...
Epoch: 5 cost time: 6.115783214569092
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 2.038 Vali Acc: 0.786 Test Loss: 2.038 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.074287176132202
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 2.074 Vali Acc: 0.809 Test Loss: 2.074 Test Acc: 0.809
Validation loss decreased (-0.791891 --> -0.809228).  Saving model ...
Epoch: 7 cost time: 6.1408326625823975
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.152 Vali Acc: 0.792 Test Loss: 2.152 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.0585548877716064
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.613 Vali Acc: 0.821 Test Loss: 1.613 Test Acc: 0.821
Validation loss decreased (-0.809228 --> -0.820793).  Saving model ...
Epoch: 9 cost time: 6.128885507583618
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.663 Vali Acc: 0.827 Test Loss: 1.663 Test Acc: 0.827
Validation loss decreased (-0.820793 --> -0.826573).  Saving model ...
Epoch: 10 cost time: 6.106916666030884
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 4.653 Vali Acc: 0.618 Test Loss: 4.653 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.076031923294067
Epoch: 11, Steps: 17 | Train Loss: 0.414 Vali Loss: 2.895 Vali Acc: 0.711 Test Loss: 2.895 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.056838274002075
Epoch: 12, Steps: 17 | Train Loss: 0.514 Vali Loss: 3.051 Vali Acc: 0.832 Test Loss: 3.051 Test Acc: 0.832
Validation loss decreased (-0.826573 --> -0.832339).  Saving model ...
Epoch: 13 cost time: 6.062929630279541
Epoch: 13, Steps: 17 | Train Loss: 0.208 Vali Loss: 3.995 Vali Acc: 0.798 Test Loss: 3.995 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.039582967758179
Epoch: 14, Steps: 17 | Train Loss: 0.260 Vali Loss: 3.296 Vali Acc: 0.815 Test Loss: 3.296 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.0284624099731445
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 3.227 Vali Acc: 0.815 Test Loss: 3.227 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.038102388381958
Epoch: 16, Steps: 17 | Train Loss: 0.074 Vali Loss: 5.948 Vali Acc: 0.751 Test Loss: 5.948 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.029947280883789
Epoch: 17, Steps: 17 | Train Loss: 0.075 Vali Loss: 6.969 Vali Acc: 0.734 Test Loss: 6.969 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.061725854873657
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 5.441 Vali Acc: 0.786 Test Loss: 5.441 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.026543855667114
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 10.241 Vali Acc: 0.746 Test Loss: 10.241 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.052827596664429
Epoch: 20, Steps: 17 | Train Loss: 0.190 Vali Loss: 8.415 Vali Acc: 0.775 Test Loss: 8.415 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.041099786758423
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 9.277 Vali Acc: 0.775 Test Loss: 9.277 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.02137565612793
Epoch: 22, Steps: 17 | Train Loss: 0.754 Vali Loss: 9.473 Vali Acc: 0.798 Test Loss: 9.473 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 886832135
model size : 3388.67MB
2025-04-28 13:19:51.734544: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:19:51.753629: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745846391.776448 1696583 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745846391.783613 1696583 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:19:51.807866: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.261646747589111
Epoch: 1, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.299 Vali Acc: 0.665 Test Loss: 1.299 Test Acc: 0.665
Validation loss decreased (inf --> -0.664727).  Saving model ...
Epoch: 2 cost time: 6.230158805847168
Epoch: 2, Steps: 17 | Train Loss: 0.425 Vali Loss: 1.399 Vali Acc: 0.688 Test Loss: 1.399 Test Acc: 0.688
Validation loss decreased (-0.664727 --> -0.687847).  Saving model ...
Epoch: 3 cost time: 6.174903154373169
Epoch: 3, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.675 Vali Acc: 0.711 Test Loss: 1.675 Test Acc: 0.711
Validation loss decreased (-0.687847 --> -0.710966).  Saving model ...
Epoch: 4 cost time: 6.19755482673645
Epoch: 4, Steps: 17 | Train Loss: 0.093 Vali Loss: 2.248 Vali Acc: 0.740 Test Loss: 2.248 Test Acc: 0.740
Validation loss decreased (-0.710966 --> -0.739862).  Saving model ...
Epoch: 5 cost time: 6.189076900482178
Epoch: 5, Steps: 17 | Train Loss: 0.189 Vali Loss: 2.794 Vali Acc: 0.746 Test Loss: 2.794 Test Acc: 0.746
Validation loss decreased (-0.739862 --> -0.745637).  Saving model ...
Epoch: 6 cost time: 6.202286005020142
Epoch: 6, Steps: 17 | Train Loss: 0.099 Vali Loss: 2.915 Vali Acc: 0.723 Test Loss: 2.915 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.153988838195801
Epoch: 7, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.343 Vali Acc: 0.821 Test Loss: 1.343 Test Acc: 0.821
Validation loss decreased (-0.745637 --> -0.820796).  Saving model ...
Epoch: 8 cost time: 6.177495241165161
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.990 Vali Acc: 0.798 Test Loss: 1.990 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.156186103820801
Epoch: 9, Steps: 17 | Train Loss: 0.228 Vali Loss: 2.458 Vali Acc: 0.821 Test Loss: 2.458 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.141025543212891
Epoch: 10, Steps: 17 | Train Loss: 0.162 Vali Loss: 5.453 Vali Acc: 0.705 Test Loss: 5.453 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.1758222579956055
Epoch: 11, Steps: 17 | Train Loss: 0.033 Vali Loss: 3.127 Vali Acc: 0.769 Test Loss: 3.127 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.174192428588867
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 7.306 Vali Acc: 0.618 Test Loss: 7.306 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.1707422733306885
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 5.092 Vali Acc: 0.694 Test Loss: 5.092 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.195131063461304
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 5.860 Vali Acc: 0.659 Test Loss: 5.860 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.2195048332214355
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 5.575 Vali Acc: 0.734 Test Loss: 5.575 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.18220591545105
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 4.727 Vali Acc: 0.751 Test Loss: 4.727 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.180927038192749
Epoch: 17, Steps: 17 | Train Loss: 0.388 Vali Loss: 3.445 Vali Acc: 0.792 Test Loss: 3.445 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 885107335
model size : 3382.09MB
2025-04-28 13:23:47.359578: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:23:47.378510: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745846627.400843 1704888 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745846627.407673 1704888 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:23:47.430643: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.82318115234375
Epoch: 1, Steps: 17 | Train Loss: 2.603 Vali Loss: 3.286 Vali Acc: 0.618 Test Loss: 3.286 Test Acc: 0.618
Validation loss decreased (inf --> -0.618464).  Saving model ...
Epoch: 2 cost time: 5.469613313674927
Epoch: 2, Steps: 17 | Train Loss: 1.681 Vali Loss: 6.631 Vali Acc: 0.613 Test Loss: 6.631 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.471043348312378
Epoch: 3, Steps: 17 | Train Loss: 1.133 Vali Loss: 4.721 Vali Acc: 0.630 Test Loss: 4.721 Test Acc: 0.630
Validation loss decreased (-0.618464 --> -0.630011).  Saving model ...
Epoch: 4 cost time: 5.489247560501099
Epoch: 4, Steps: 17 | Train Loss: 0.569 Vali Loss: 6.777 Vali Acc: 0.647 Test Loss: 6.777 Test Acc: 0.647
Validation loss decreased (-0.630011 --> -0.647331).  Saving model ...
Epoch: 5 cost time: 5.469179630279541
Epoch: 5, Steps: 17 | Train Loss: 0.109 Vali Loss: 7.931 Vali Acc: 0.717 Test Loss: 7.931 Test Acc: 0.717
Validation loss decreased (-0.647331 --> -0.716684).  Saving model ...
Epoch: 6 cost time: 5.498547077178955
Epoch: 6, Steps: 17 | Train Loss: 0.402 Vali Loss: 7.199 Vali Acc: 0.653 Test Loss: 7.199 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.4646124839782715
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 12.210 Vali Acc: 0.642 Test Loss: 12.210 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.473557949066162
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 4.719 Vali Acc: 0.803 Test Loss: 4.719 Test Acc: 0.803
Validation loss decreased (-0.716684 --> -0.803421).  Saving model ...
Epoch: 9 cost time: 5.513667583465576
Epoch: 9, Steps: 17 | Train Loss: 0.325 Vali Loss: 9.543 Vali Acc: 0.694 Test Loss: 9.543 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.495773553848267
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 3.753 Vali Acc: 0.803 Test Loss: 3.753 Test Acc: 0.803
Validation loss decreased (-0.803421 --> -0.803431).  Saving model ...
Epoch: 11 cost time: 5.4805262088775635
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 6.673 Vali Acc: 0.705 Test Loss: 6.673 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.461385011672974
Epoch: 12, Steps: 17 | Train Loss: 0.510 Vali Loss: 4.514 Vali Acc: 0.728 Test Loss: 4.514 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.456575155258179
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 6.561 Vali Acc: 0.728 Test Loss: 6.561 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.452287912368774
Epoch: 14, Steps: 17 | Train Loss: 0.263 Vali Loss: 7.124 Vali Acc: 0.763 Test Loss: 7.124 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.467473983764648
Epoch: 15, Steps: 17 | Train Loss: 0.239 Vali Loss: 14.440 Vali Acc: 0.699 Test Loss: 14.440 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.447557210922241
Epoch: 16, Steps: 17 | Train Loss: 0.233 Vali Loss: 14.069 Vali Acc: 0.653 Test Loss: 14.069 Test Acc: 0.653
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.45595383644104
Epoch: 17, Steps: 17 | Train Loss: 0.367 Vali Loss: 10.998 Vali Acc: 0.803 Test Loss: 10.998 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.451121091842651
Epoch: 18, Steps: 17 | Train Loss: 0.110 Vali Loss: 17.462 Vali Acc: 0.682 Test Loss: 17.462 Test Acc: 0.682
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.442206859588623
Epoch: 19, Steps: 17 | Train Loss: 0.310 Vali Loss: 13.606 Vali Acc: 0.751 Test Loss: 13.606 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.463505744934082
Epoch: 20, Steps: 17 | Train Loss: 0.101 Vali Loss: 20.701 Vali Acc: 0.734 Test Loss: 20.701 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 430701895
model size : 1645.85MB
2025-04-28 13:27:19.482803: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:27:19.501440: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745846839.524709 1714359 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745846839.531740 1714359 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:27:19.554621: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.554632186889648
Epoch: 1, Steps: 17 | Train Loss: 2.838 Vali Loss: 1.583 Vali Acc: 0.624 Test Loss: 1.583 Test Acc: 0.624
Validation loss decreased (inf --> -0.624262).  Saving model ...
Epoch: 2 cost time: 4.363671064376831
Epoch: 2, Steps: 17 | Train Loss: 0.824 Vali Loss: 2.615 Vali Acc: 0.688 Test Loss: 2.615 Test Acc: 0.688
Validation loss decreased (-0.624262 --> -0.687835).  Saving model ...
Epoch: 3 cost time: 4.33096981048584
Epoch: 3, Steps: 17 | Train Loss: 0.415 Vali Loss: 3.215 Vali Acc: 0.682 Test Loss: 3.215 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.299438714981079
Epoch: 4, Steps: 17 | Train Loss: 0.219 Vali Loss: 3.464 Vali Acc: 0.671 Test Loss: 3.464 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.305147409439087
Epoch: 5, Steps: 17 | Train Loss: 0.240 Vali Loss: 1.954 Vali Acc: 0.803 Test Loss: 1.954 Test Acc: 0.803
Validation loss decreased (-0.687835 --> -0.803449).  Saving model ...
Epoch: 6 cost time: 4.336521863937378
Epoch: 6, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.973 Vali Acc: 0.792 Test Loss: 1.973 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.318222761154175
Epoch: 7, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.633 Vali Acc: 0.798 Test Loss: 1.633 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.28726601600647
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.488 Vali Acc: 0.809 Test Loss: 2.488 Test Acc: 0.809
Validation loss decreased (-0.803449 --> -0.809224).  Saving model ...
Epoch: 9 cost time: 4.30962872505188
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 3.094 Vali Acc: 0.757 Test Loss: 3.094 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.279940605163574
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.296 Vali Acc: 0.780 Test Loss: 3.296 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.300293922424316
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 4.358 Vali Acc: 0.780 Test Loss: 4.358 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.252379655838013
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 5.312 Vali Acc: 0.786 Test Loss: 5.312 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.252010822296143
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 3.096 Vali Acc: 0.786 Test Loss: 3.096 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.2541162967681885
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.667 Vali Acc: 0.705 Test Loss: 5.667 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.257207632064819
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.396 Vali Acc: 0.780 Test Loss: 2.396 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.292077302932739
Epoch: 16, Steps: 17 | Train Loss: 0.237 Vali Loss: 11.181 Vali Acc: 0.601 Test Loss: 11.181 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.289994955062866
Epoch: 17, Steps: 17 | Train Loss: 0.849 Vali Loss: 9.143 Vali Acc: 0.665 Test Loss: 9.143 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.289638996124268
Epoch: 18, Steps: 17 | Train Loss: 0.213 Vali Loss: 7.557 Vali Acc: 0.751 Test Loss: 7.557 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 415170887
model size : 1586.60MB
2025-04-28 13:29:52.994323: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:29:53.013069: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745846993.035189 1722744 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745846993.042094 1722744 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:29:53.064841: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.833116769790649
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 1.162 Vali Acc: 0.590 Test Loss: 1.162 Test Acc: 0.590
Validation loss decreased (inf --> -0.589584).  Saving model ...
Epoch: 2 cost time: 3.796082019805908
Epoch: 2, Steps: 17 | Train Loss: 0.594 Vali Loss: 1.354 Vali Acc: 0.688 Test Loss: 1.354 Test Acc: 0.688
Validation loss decreased (-0.589584 --> -0.687848).  Saving model ...
Epoch: 3 cost time: 3.788800001144409
Epoch: 3, Steps: 17 | Train Loss: 0.695 Vali Loss: 1.761 Vali Acc: 0.711 Test Loss: 1.761 Test Acc: 0.711
Validation loss decreased (-0.687848 --> -0.710965).  Saving model ...
Epoch: 4 cost time: 3.815002202987671
Epoch: 4, Steps: 17 | Train Loss: 0.347 Vali Loss: 1.702 Vali Acc: 0.723 Test Loss: 1.702 Test Acc: 0.723
Validation loss decreased (-0.710965 --> -0.722526).  Saving model ...
Epoch: 5 cost time: 3.865450382232666
Epoch: 5, Steps: 17 | Train Loss: 0.205 Vali Loss: 2.120 Vali Acc: 0.734 Test Loss: 2.120 Test Acc: 0.734
Validation loss decreased (-0.722526 --> -0.734083).  Saving model ...
Epoch: 6 cost time: 3.8383054733276367
Epoch: 6, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.224 Vali Acc: 0.757 Test Loss: 2.224 Test Acc: 0.757
Validation loss decreased (-0.734083 --> -0.757203).  Saving model ...
Epoch: 7 cost time: 3.7957489490509033
Epoch: 7, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.956 Vali Acc: 0.792 Test Loss: 1.956 Test Acc: 0.792
Validation loss decreased (-0.757203 --> -0.791888).  Saving model ...
Epoch: 8 cost time: 3.8382420539855957
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 3.095 Vali Acc: 0.769 Test Loss: 3.095 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.791196584701538
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.827 Test Loss: 2.388 Test Acc: 0.827
Validation loss decreased (-0.791888 --> -0.826566).  Saving model ...
Epoch: 10 cost time: 3.8393936157226562
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.102 Vali Acc: 0.803 Test Loss: 2.102 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.797757625579834
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.121 Vali Acc: 0.798 Test Loss: 2.121 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7883033752441406
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.115 Vali Acc: 0.798 Test Loss: 2.115 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.784497022628784
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.798 Test Loss: 2.140 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.785186767578125
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.150 Vali Acc: 0.798 Test Loss: 2.150 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.80716872215271
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.093 Vali Acc: 0.798 Test Loss: 2.093 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.7814109325408936
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.127 Vali Acc: 0.798 Test Loss: 2.127 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.8085644245147705
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.115 Vali Acc: 0.798 Test Loss: 2.115 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.8026533126831055
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.798 Test Loss: 2.146 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7871601581573486
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.118 Vali Acc: 0.798 Test Loss: 2.118 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 409993991
model size : 1566.85MB
2025-04-28 13:32:36.120840: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:32:36.139975: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745847156.162362 1731589 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745847156.169184 1731589 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:32:36.192091: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.763117551803589
Epoch: 1, Steps: 17 | Train Loss: 1.705 Vali Loss: 0.816 Vali Acc: 0.728 Test Loss: 0.816 Test Acc: 0.728
Validation loss decreased (inf --> -0.728316).  Saving model ...
Epoch: 2 cost time: 3.690814971923828
Epoch: 2, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.601 Vali Acc: 0.682 Test Loss: 1.601 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6106724739074707
Epoch: 3, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.879 Vali Acc: 0.792 Test Loss: 0.879 Test Acc: 0.792
Validation loss decreased (-0.728316 --> -0.791899).  Saving model ...
Epoch: 4 cost time: 3.663292169570923
Epoch: 4, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.210 Vali Acc: 0.803 Test Loss: 1.210 Test Acc: 0.803
Validation loss decreased (-0.791899 --> -0.803456).  Saving model ...
Epoch: 5 cost time: 3.6817703247070312
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.511 Vali Acc: 0.757 Test Loss: 1.511 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6442933082580566
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.756 Vali Acc: 0.780 Test Loss: 1.756 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6644670963287354
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.415 Vali Acc: 0.821 Test Loss: 1.415 Test Acc: 0.821
Validation loss decreased (-0.803456 --> -0.820795).  Saving model ...
Epoch: 8 cost time: 3.903252124786377
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.170 Vali Acc: 0.792 Test Loss: 2.170 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.707207441329956
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 3.338 Vali Acc: 0.775 Test Loss: 3.338 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6722140312194824
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.320 Vali Acc: 0.815 Test Loss: 1.320 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.67915940284729
Epoch: 11, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.182 Vali Acc: 0.827 Test Loss: 2.182 Test Acc: 0.827
Validation loss decreased (-0.820795 --> -0.826568).  Saving model ...
Epoch: 12 cost time: 4.44284987449646
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 3.456 Vali Acc: 0.769 Test Loss: 3.456 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.661350965499878
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.050 Vali Acc: 0.798 Test Loss: 3.050 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.6698930263519287
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 3.802 Vali Acc: 0.757 Test Loss: 3.802 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.654608726501465
Epoch: 15, Steps: 17 | Train Loss: 0.072 Vali Loss: 2.278 Vali Acc: 0.803 Test Loss: 2.278 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6565871238708496
Epoch: 16, Steps: 17 | Train Loss: 0.207 Vali Loss: 2.703 Vali Acc: 0.740 Test Loss: 2.703 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.688901424407959
Epoch: 17, Steps: 17 | Train Loss: 0.166 Vali Loss: 3.864 Vali Acc: 0.780 Test Loss: 3.864 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.6902363300323486
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 3.803 Vali Acc: 0.751 Test Loss: 3.803 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.6748814582824707
Epoch: 19, Steps: 17 | Train Loss: 0.154 Vali Loss: 3.787 Vali Acc: 0.751 Test Loss: 3.787 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.6719653606414795
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 9.173 Vali Acc: 0.711 Test Loss: 9.173 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.674776792526245
Epoch: 21, Steps: 17 | Train Loss: 0.535 Vali Loss: 4.512 Vali Acc: 0.780 Test Loss: 4.512 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 407405703
model size : 1556.98MB
2025-04-28 13:35:17.994940: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:35:18.014226: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745847318.037224 1741270 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745847318.044466 1741270 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:35:18.068250: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.252315521240234
Epoch: 1, Steps: 17 | Train Loss: 1.600 Vali Loss: 1.149 Vali Acc: 0.653 Test Loss: 1.149 Test Acc: 0.653
Validation loss decreased (inf --> -0.653168).  Saving model ...
Epoch: 2 cost time: 3.9837052822113037
Epoch: 2, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.987 Vali Acc: 0.734 Test Loss: 0.987 Test Acc: 0.734
Validation loss decreased (-0.653168 --> -0.734094).  Saving model ...
Epoch: 3 cost time: 4.00170373916626
Epoch: 3, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.580 Vali Acc: 0.694 Test Loss: 1.580 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9638078212738037
Epoch: 4, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.349 Vali Acc: 0.763 Test Loss: 1.349 Test Acc: 0.763
Validation loss decreased (-0.734094 --> -0.762992).  Saving model ...
Epoch: 5 cost time: 3.9963858127593994
Epoch: 5, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.665 Vali Acc: 0.769 Test Loss: 1.665 Test Acc: 0.769
Validation loss decreased (-0.762992 --> -0.768769).  Saving model ...
Epoch: 6 cost time: 4.018713474273682
Epoch: 6, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.921 Vali Acc: 0.740 Test Loss: 2.921 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9732606410980225
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 2.319 Vali Acc: 0.728 Test Loss: 2.319 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9727909564971924
Epoch: 8, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.187 Vali Acc: 0.775 Test Loss: 2.187 Test Acc: 0.775
Validation loss decreased (-0.768769 --> -0.774545).  Saving model ...
Epoch: 9 cost time: 4.016337156295776
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.225 Vali Acc: 0.792 Test Loss: 1.225 Test Acc: 0.792
Validation loss decreased (-0.774545 --> -0.791895).  Saving model ...
Epoch: 10 cost time: 3.999568223953247
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.792 Test Loss: 1.133 Test Acc: 0.792
Validation loss decreased (-0.791895 --> -0.791896).  Saving model ...
Epoch: 11 cost time: 4.006032466888428
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.792 Test Loss: 1.122 Test Acc: 0.792
Validation loss decreased (-0.791896 --> -0.791896).  Saving model ...
Epoch: 12 cost time: 4.01444673538208
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.109 Vali Acc: 0.798 Test Loss: 1.109 Test Acc: 0.798
Validation loss decreased (-0.791896 --> -0.797677).  Saving model ...
Epoch: 13 cost time: 4.014174938201904
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.100 Vali Acc: 0.798 Test Loss: 1.100 Test Acc: 0.798
Validation loss decreased (-0.797677 --> -0.797677).  Saving model ...
Epoch: 14 cost time: 4.019573450088501
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.798 Test Loss: 1.105 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.97017502784729
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.079 Vali Acc: 0.803 Test Loss: 1.079 Test Acc: 0.803
Validation loss decreased (-0.797677 --> -0.803457).  Saving model ...
Epoch: 16 cost time: 3.9989266395568848
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.798 Test Loss: 1.081 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9695849418640137
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.803 Test Loss: 1.070 Test Acc: 0.803
Validation loss decreased (-0.803457 --> -0.803458).  Saving model ...
Epoch: 18 cost time: 3.9833662509918213
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.809 Test Loss: 1.092 Test Acc: 0.809
Validation loss decreased (-0.803458 --> -0.809238).  Saving model ...
Epoch: 19 cost time: 4.010920286178589
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.809 Test Loss: 1.081 Test Acc: 0.809
Validation loss decreased (-0.809238 --> -0.809238).  Saving model ...
Epoch: 20 cost time: 4.007864952087402
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.809 Test Loss: 1.075 Test Acc: 0.809
Validation loss decreased (-0.809238 --> -0.809238).  Saving model ...
Epoch: 21 cost time: 4.021255254745483
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.809 Test Loss: 1.071 Test Acc: 0.809
Validation loss decreased (-0.809238 --> -0.809238).  Saving model ...
Epoch: 22 cost time: 4.008640289306641
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.809 Test Loss: 1.078 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9737744331359863
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.052 Vali Acc: 0.803 Test Loss: 1.052 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.969987630844116
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.066 Vali Acc: 0.809 Test Loss: 1.066 Test Acc: 0.809
Validation loss decreased (-0.809238 --> -0.809238).  Saving model ...
Epoch: 25 cost time: 4.007290363311768
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.809 Test Loss: 1.049 Test Acc: 0.809
Validation loss decreased (-0.809238 --> -0.809238).  Saving model ...
Epoch: 26 cost time: 4.016238689422607
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.809 Test Loss: 1.065 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.9841887950897217
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.809 Test Loss: 1.089 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.9589531421661377
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.809 Test Loss: 1.065 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.9724647998809814
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.809 Test Loss: 1.090 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.988909959793091
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.074 Vali Acc: 0.798 Test Loss: 1.074 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.9862701892852783
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.798 Test Loss: 1.058 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.978147268295288
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.798 Test Loss: 1.053 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.000014066696167
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.068 Vali Acc: 0.798 Test Loss: 1.068 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.976346015930176
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.061 Vali Acc: 0.798 Test Loss: 1.061 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.991816282272339
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.043 Vali Acc: 0.798 Test Loss: 1.043 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 405680455
model size : 1550.40MB
2025-04-28 13:40:15.979201: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:40:15.998999: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745847616.021925 1757385 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745847616.028902 1757385 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:40:16.052264: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.929490327835083
Epoch: 1, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.219 Vali Acc: 0.630 Test Loss: 1.219 Test Acc: 0.630
Validation loss decreased (inf --> -0.630046).  Saving model ...
Epoch: 2 cost time: 3.7333836555480957
Epoch: 2, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.527 Vali Acc: 0.815 Test Loss: 0.527 Test Acc: 0.815
Validation loss decreased (-0.630046 --> -0.815024).  Saving model ...
Epoch: 3 cost time: 3.7330985069274902
Epoch: 3, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.307 Vali Acc: 0.728 Test Loss: 1.307 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.703636407852173
Epoch: 4, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.713 Vali Acc: 0.832 Test Loss: 0.713 Test Acc: 0.832
Validation loss decreased (-0.815024 --> -0.832363).  Saving model ...
Epoch: 5 cost time: 3.7138094902038574
Epoch: 5, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.970 Vali Acc: 0.757 Test Loss: 1.970 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6791977882385254
Epoch: 6, Steps: 17 | Train Loss: 0.052 Vali Loss: 2.103 Vali Acc: 0.734 Test Loss: 2.103 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6651387214660645
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.669 Vali Acc: 0.792 Test Loss: 1.669 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6773531436920166
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.447 Vali Acc: 0.769 Test Loss: 1.447 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.6693155765533447
Epoch: 9, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.808 Vali Acc: 0.688 Test Loss: 1.808 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.6840603351593018
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.922 Vali Acc: 0.746 Test Loss: 1.922 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.652770757675171
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 2.608 Vali Acc: 0.751 Test Loss: 2.608 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.6730666160583496
Epoch: 12, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.972 Vali Acc: 0.705 Test Loss: 1.972 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.666922092437744
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.952 Vali Acc: 0.734 Test Loss: 2.952 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.6766715049743652
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.723 Vali Acc: 0.792 Test Loss: 1.723 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 403955207
model size : 1543.81MB
2025-04-28 13:42:07.692764: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:42:07.712122: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745847727.734721 1763930 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745847727.741741 1763930 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:42:07.764735: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.876936197280884
Epoch: 1, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.030 Vali Acc: 0.601 Test Loss: 1.030 Test Acc: 0.601
Validation loss decreased (inf --> -0.601146).  Saving model ...
Epoch: 2 cost time: 3.6051127910614014
Epoch: 2, Steps: 17 | Train Loss: 0.476 Vali Loss: 1.267 Vali Acc: 0.682 Test Loss: 1.267 Test Acc: 0.682
Validation loss decreased (-0.601146 --> -0.682068).  Saving model ...
Epoch: 3 cost time: 3.5782041549682617
Epoch: 3, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.837 Vali Acc: 0.786 Test Loss: 0.837 Test Acc: 0.786
Validation loss decreased (-0.682068 --> -0.786119).  Saving model ...
Epoch: 4 cost time: 3.875694990158081
Epoch: 4, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.109 Vali Acc: 0.769 Test Loss: 1.109 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5595407485961914
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.101 Vali Acc: 0.786 Test Loss: 1.101 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.578789234161377
Epoch: 6, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.803 Test Loss: 0.840 Test Acc: 0.803
Validation loss decreased (-0.786119 --> -0.803460).  Saving model ...
Epoch: 7 cost time: 3.5942740440368652
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.798 Test Loss: 0.776 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5584354400634766
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.641 Vali Acc: 0.821 Test Loss: 0.641 Test Acc: 0.821
Validation loss decreased (-0.803460 --> -0.820803).  Saving model ...
Epoch: 9 cost time: 3.601093292236328
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.802 Vali Acc: 0.786 Test Loss: 0.802 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5730903148651123
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.185 Vali Acc: 0.763 Test Loss: 1.185 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.580866575241089
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.751 Test Loss: 1.191 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5667166709899902
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.757 Test Loss: 1.187 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5712506771087646
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.751 Test Loss: 1.178 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.571674108505249
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.757 Test Loss: 1.161 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.5611603260040283
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.769 Test Loss: 1.122 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.595147132873535
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.092 Vali Acc: 0.769 Test Loss: 1.092 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.576220750808716
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.769 Test Loss: 1.104 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.5898420810699463
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.769 Test Loss: 1.096 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 403092807
model size : 1540.53MB
2025-04-28 13:44:28.216352: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:44:28.235059: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745847868.257118 1772268 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745847868.264020 1772268 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:44:28.286678: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.815272331237793
Epoch: 1, Steps: 17 | Train Loss: 2.190 Vali Loss: 1.591 Vali Acc: 0.659 Test Loss: 1.591 Test Acc: 0.659
Validation loss decreased (inf --> -0.658944).  Saving model ...
Epoch: 2 cost time: 3.55472993850708
Epoch: 2, Steps: 17 | Train Loss: 1.022 Vali Loss: 3.368 Vali Acc: 0.566 Test Loss: 3.368 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.577972412109375
Epoch: 3, Steps: 17 | Train Loss: 1.497 Vali Loss: 2.200 Vali Acc: 0.757 Test Loss: 2.200 Test Acc: 0.757
Validation loss decreased (-0.658944 --> -0.757203).  Saving model ...
Epoch: 4 cost time: 3.572070837020874
Epoch: 4, Steps: 17 | Train Loss: 0.647 Vali Loss: 2.624 Vali Acc: 0.751 Test Loss: 2.624 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.535682439804077
Epoch: 5, Steps: 17 | Train Loss: 0.178 Vali Loss: 4.661 Vali Acc: 0.694 Test Loss: 4.661 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5271151065826416
Epoch: 6, Steps: 17 | Train Loss: 0.156 Vali Loss: 3.555 Vali Acc: 0.775 Test Loss: 3.555 Test Acc: 0.775
Validation loss decreased (-0.757203 --> -0.774531).  Saving model ...
Epoch: 7 cost time: 3.5506279468536377
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 7.501 Vali Acc: 0.682 Test Loss: 7.501 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5367188453674316
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 3.749 Vali Acc: 0.763 Test Loss: 3.749 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5454022884368896
Epoch: 9, Steps: 17 | Train Loss: 0.167 Vali Loss: 2.122 Vali Acc: 0.757 Test Loss: 2.122 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.518054962158203
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.093 Vali Acc: 0.775 Test Loss: 2.093 Test Acc: 0.775
Validation loss decreased (-0.774531 --> -0.774546).  Saving model ...
Epoch: 11 cost time: 3.5909197330474854
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 3.005 Vali Acc: 0.751 Test Loss: 3.005 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.517895221710205
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.392 Vali Acc: 0.734 Test Loss: 3.392 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.553495407104492
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 3.499 Vali Acc: 0.746 Test Loss: 3.499 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.534950017929077
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.308 Vali Acc: 0.763 Test Loss: 2.308 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.540564775466919
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.312 Vali Acc: 0.757 Test Loss: 2.312 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5314791202545166
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 5.077 Vali Acc: 0.717 Test Loss: 5.077 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.5549352169036865
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.597 Vali Acc: 0.705 Test Loss: 5.597 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.5444953441619873
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.661 Vali Acc: 0.699 Test Loss: 5.661 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.5452160835266113
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.691 Vali Acc: 0.699 Test Loss: 5.691 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.516547441482544
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.628 Vali Acc: 0.699 Test Loss: 5.628 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 205485735
model size : 785.30MB
2025-04-28 13:46:48.785224: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:46:48.805217: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745848008.827929 1781503 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745848008.834970 1781503 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:46:48.858446: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.10251522064209
Epoch: 1, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.424 Vali Acc: 0.584 Test Loss: 1.424 Test Acc: 0.584
Validation loss decreased (inf --> -0.583801).  Saving model ...
Epoch: 2 cost time: 2.891667604446411
Epoch: 2, Steps: 17 | Train Loss: 0.345 Vali Loss: 3.082 Vali Acc: 0.595 Test Loss: 3.082 Test Acc: 0.595
Validation loss decreased (-0.583801 --> -0.595345).  Saving model ...
Epoch: 3 cost time: 2.8975260257720947
Epoch: 3, Steps: 17 | Train Loss: 0.565 Vali Loss: 2.123 Vali Acc: 0.728 Test Loss: 2.123 Test Acc: 0.728
Validation loss decreased (-0.595345 --> -0.728302).  Saving model ...
Epoch: 4 cost time: 2.880784511566162
Epoch: 4, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.714 Vali Acc: 0.827 Test Loss: 1.714 Test Acc: 0.827
Validation loss decreased (-0.728302 --> -0.826572).  Saving model ...
Epoch: 5 cost time: 2.9083306789398193
Epoch: 5, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.929 Vali Acc: 0.792 Test Loss: 0.929 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.869072914123535
Epoch: 6, Steps: 17 | Train Loss: 0.140 Vali Loss: 3.586 Vali Acc: 0.723 Test Loss: 3.586 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8815033435821533
Epoch: 7, Steps: 17 | Train Loss: 0.091 Vali Loss: 2.230 Vali Acc: 0.803 Test Loss: 2.230 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8676280975341797
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 3.137 Vali Acc: 0.728 Test Loss: 3.137 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.848167896270752
Epoch: 9, Steps: 17 | Train Loss: 0.042 Vali Loss: 2.830 Vali Acc: 0.780 Test Loss: 2.830 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8579719066619873
Epoch: 10, Steps: 17 | Train Loss: 0.220 Vali Loss: 3.728 Vali Acc: 0.717 Test Loss: 3.728 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.8797998428344727
Epoch: 11, Steps: 17 | Train Loss: 0.090 Vali Loss: 4.567 Vali Acc: 0.711 Test Loss: 4.567 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.883901834487915
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.487 Vali Acc: 0.740 Test Loss: 3.487 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.846156358718872
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.275 Vali Acc: 0.728 Test Loss: 4.275 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8627171516418457
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 3.620 Vali Acc: 0.775 Test Loss: 3.620 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 197720231
model size : 755.68MB
2025-04-28 13:48:20.075959: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:48:20.095752: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745848100.119273 1787971 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745848100.126338 1787971 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:48:20.149743: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7631871700286865
Epoch: 1, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.586 Vali Acc: 0.422 Test Loss: 1.586 Test Acc: 0.422
Validation loss decreased (inf --> -0.421949).  Saving model ...
Epoch: 2 cost time: 2.672726631164551
Epoch: 2, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.950 Vali Acc: 0.792 Test Loss: 0.950 Test Acc: 0.792
Validation loss decreased (-0.421949 --> -0.791898).  Saving model ...
Epoch: 3 cost time: 2.669386625289917
Epoch: 3, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.312 Vali Acc: 0.769 Test Loss: 1.312 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6825764179229736
Epoch: 4, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.083 Vali Acc: 0.775 Test Loss: 2.083 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.686493158340454
Epoch: 5, Steps: 17 | Train Loss: 0.050 Vali Loss: 2.105 Vali Acc: 0.763 Test Loss: 2.105 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.648930311203003
Epoch: 6, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.090 Vali Acc: 0.798 Test Loss: 1.090 Test Acc: 0.798
Validation loss decreased (-0.791898 --> -0.797677).  Saving model ...
Epoch: 7 cost time: 2.6818912029266357
Epoch: 7, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.316 Vali Acc: 0.728 Test Loss: 2.316 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6624176502227783
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.815 Test Loss: 1.000 Test Acc: 0.815
Validation loss decreased (-0.797677 --> -0.815019).  Saving model ...
Epoch: 9 cost time: 2.691282033920288
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.815 Test Loss: 1.010 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6943867206573486
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.815 Test Loss: 0.994 Test Acc: 0.815
Validation loss decreased (-0.815019 --> -0.815019).  Saving model ...
Epoch: 11 cost time: 3.283205032348633
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.821 Test Loss: 0.994 Test Acc: 0.821
Validation loss decreased (-0.815019 --> -0.820799).  Saving model ...
Epoch: 12 cost time: 2.695619583129883
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.815 Test Loss: 0.998 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.686622142791748
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.815 Test Loss: 0.986 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6877493858337402
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.821 Test Loss: 0.988 Test Acc: 0.821
Validation loss decreased (-0.820799 --> -0.820799).  Saving model ...
Epoch: 15 cost time: 2.6838464736938477
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.821 Test Loss: 0.975 Test Acc: 0.821
Validation loss decreased (-0.820799 --> -0.820799).  Saving model ...
Epoch: 16 cost time: 2.7197163105010986
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.821 Test Loss: 0.990 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6310458183288574
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.821 Test Loss: 0.994 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.673740863800049
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.821 Test Loss: 0.994 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6567509174346924
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.821 Test Loss: 0.991 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.652827501296997
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.821 Test Loss: 0.971 Test Acc: 0.821
Validation loss decreased (-0.820799 --> -0.820800).  Saving model ...
Epoch: 21 cost time: 2.6795380115509033
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.977 Vali Acc: 0.821 Test Loss: 0.977 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.645653009414673
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.821 Test Loss: 0.987 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6467409133911133
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.821 Test Loss: 0.986 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6716816425323486
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.984 Vali Acc: 0.821 Test Loss: 0.984 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6437485218048096
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.821 Test Loss: 0.983 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.63779616355896
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.987 Vali Acc: 0.821 Test Loss: 0.987 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.6954994201660156
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.821 Test Loss: 0.975 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.655062198638916
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.953 Vali Acc: 0.821 Test Loss: 0.953 Test Acc: 0.821
Validation loss decreased (-0.820800 --> -0.820800).  Saving model ...
Epoch: 29 cost time: 2.711697816848755
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.821 Test Loss: 0.961 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6291582584381104
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.821 Test Loss: 0.967 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.6740944385528564
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.821 Test Loss: 0.975 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.660161256790161
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.821 Test Loss: 0.959 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.6442251205444336
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.821 Test Loss: 0.956 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.673123836517334
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.821 Test Loss: 0.965 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.6571834087371826
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.821 Test Loss: 0.965 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.660183906555176
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.966 Vali Acc: 0.821 Test Loss: 0.966 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.675293445587158
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.832 Test Loss: 0.945 Test Acc: 0.832
Validation loss decreased (-0.820800 --> -0.832360).  Saving model ...
Epoch: 38 cost time: 2.6900150775909424
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.960 Vali Acc: 0.832 Test Loss: 0.960 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.665764570236206
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.832 Test Loss: 0.962 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.664846181869507
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.832 Test Loss: 0.954 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.6576857566833496
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.832 Test Loss: 0.948 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.6650638580322266
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.832 Test Loss: 0.944 Test Acc: 0.832
Validation loss decreased (-0.832360 --> -0.832361).  Saving model ...
Epoch: 43 cost time: 2.685724973678589
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.832 Test Loss: 0.962 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.6582133769989014
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.832 Test Loss: 0.948 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.669109582901001
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.832 Test Loss: 0.943 Test Acc: 0.832
Validation loss decreased (-0.832361 --> -0.832361).  Saving model ...
Epoch: 46 cost time: 3.4731740951538086
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.827 Test Loss: 0.967 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.643359661102295
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.832 Test Loss: 0.947 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.6384363174438477
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.827 Test Loss: 0.964 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.6482996940612793
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.832 Test Loss: 0.925 Test Acc: 0.832
Validation loss decreased (-0.832361 --> -0.832361).  Saving model ...
Epoch: 50 cost time: 2.7018015384674072
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.947 Vali Acc: 0.832 Test Loss: 0.947 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 195131783
model size : 745.80MB
2025-04-28 13:52:49.965214: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:52:49.983931: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745848370.005843 1810322 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745848370.012687 1810322 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:52:50.035039: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.819575071334839
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.034 Vali Acc: 0.618 Test Loss: 1.034 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 2.5988950729370117
Epoch: 2, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.631 Vali Acc: 0.821 Test Loss: 0.631 Test Acc: 0.821
Validation loss decreased (-0.618487 --> -0.820803).  Saving model ...
Epoch: 3 cost time: 2.6316044330596924
Epoch: 3, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.948 Vali Acc: 0.780 Test Loss: 0.948 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5752792358398438
Epoch: 4, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.062 Vali Acc: 0.751 Test Loss: 1.062 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.576406717300415
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.020 Vali Acc: 0.803 Test Loss: 1.020 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.613102912902832
Epoch: 6, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.912 Vali Acc: 0.803 Test Loss: 0.912 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.592104434967041
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.479 Vali Acc: 0.763 Test Loss: 1.479 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.57791805267334
Epoch: 8, Steps: 17 | Train Loss: 0.028 Vali Loss: 2.214 Vali Acc: 0.740 Test Loss: 2.214 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5761518478393555
Epoch: 9, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.975 Vali Acc: 0.723 Test Loss: 1.975 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5824379920959473
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.157 Vali Acc: 0.757 Test Loss: 2.157 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.570415735244751
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.757 Test Loss: 1.779 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5929813385009766
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.975 Vali Acc: 0.763 Test Loss: 1.975 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 193837639
model size : 740.87MB
2025-04-28 13:54:02.498799: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:54:02.518335: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745848442.540930 1815869 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745848442.547847 1815869 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:54:02.571170: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.62308406829834
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 0.919 Vali Acc: 0.595 Test Loss: 0.919 Test Acc: 0.595
Validation loss decreased (inf --> -0.595367).  Saving model ...
Epoch: 2 cost time: 2.6460347175598145
Epoch: 2, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.592 Vali Acc: 0.798 Test Loss: 0.592 Test Acc: 0.798
Validation loss decreased (-0.595367 --> -0.797682).  Saving model ...
Epoch: 3 cost time: 2.5929107666015625
Epoch: 3, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.203 Vali Acc: 0.717 Test Loss: 1.203 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6114633083343506
Epoch: 4, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.979 Vali Acc: 0.786 Test Loss: 0.979 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.566305637359619
Epoch: 5, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.420 Vali Acc: 0.757 Test Loss: 1.420 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.607203483581543
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.045 Vali Acc: 0.821 Test Loss: 1.045 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820799).  Saving model ...
Epoch: 7 cost time: 2.599825143814087
Epoch: 7, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.080 Vali Acc: 0.775 Test Loss: 1.080 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6140384674072266
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.803 Test Loss: 1.020 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6001431941986084
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.809 Test Loss: 0.817 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.582096815109253
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.815 Test Loss: 0.737 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6010687351226807
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.832 Test Loss: 0.711 Test Acc: 0.832
Validation loss decreased (-0.820799 --> -0.832363).  Saving model ...
Epoch: 12 cost time: 2.613924503326416
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.821 Test Loss: 0.698 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5675089359283447
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.821 Test Loss: 0.690 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.586254119873047
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.821 Test Loss: 0.685 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.57047700881958
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.821 Test Loss: 0.684 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5748462677001953
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.821 Test Loss: 0.677 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.562143325805664
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.821 Test Loss: 0.673 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5614261627197266
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.671 Vali Acc: 0.827 Test Loss: 0.671 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5499980449676514
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.827 Test Loss: 0.675 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5793628692626953
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.827 Test Loss: 0.676 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5621895790100098
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.827 Test Loss: 0.672 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 192975015
model size : 737.58MB
2025-04-28 13:55:57.949003: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:55:57.967913: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745848557.990771 1825385 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745848557.997652 1825385 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:55:58.020628: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5069916248321533
Epoch: 1, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.177 Vali Acc: 0.642 Test Loss: 1.177 Test Acc: 0.642
Validation loss decreased (inf --> -0.641607).  Saving model ...
Epoch: 2 cost time: 2.528186559677124
Epoch: 2, Steps: 17 | Train Loss: 0.402 Vali Loss: 1.057 Vali Acc: 0.694 Test Loss: 1.057 Test Acc: 0.694
Validation loss decreased (-0.641607 --> -0.693631).  Saving model ...
Epoch: 3 cost time: 2.5055549144744873
Epoch: 3, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
Validation loss decreased (-0.693631 --> -0.809242).  Saving model ...
Epoch: 4 cost time: 2.5028955936431885
Epoch: 4, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.872 Vali Acc: 0.734 Test Loss: 0.872 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.483985662460327
Epoch: 5, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.376 Vali Acc: 0.699 Test Loss: 1.376 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.524712324142456
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.737 Vali Acc: 0.827 Test Loss: 0.737 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826582).  Saving model ...
Epoch: 7 cost time: 2.499485731124878
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
Validation loss decreased (-0.826582 --> -0.838145).  Saving model ...
Epoch: 8 cost time: 2.543182373046875
Epoch: 8, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.710 Vali Acc: 0.821 Test Loss: 0.710 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4691200256347656
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.762 Vali Acc: 0.786 Test Loss: 0.762 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.528362989425659
Epoch: 10, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.735 Vali Acc: 0.821 Test Loss: 0.735 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5307393074035645
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.892 Vali Acc: 0.827 Test Loss: 0.892 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4944427013397217
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.809 Test Loss: 0.706 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4881248474121094
Epoch: 13, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.809 Vali Acc: 0.815 Test Loss: 0.809 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.5222742557525635
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 2.708 Vali Acc: 0.763 Test Loss: 2.708 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.498138189315796
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.502 Vali Acc: 0.786 Test Loss: 1.502 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.508251905441284
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 2.287 Vali Acc: 0.775 Test Loss: 2.287 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.491006374359131
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.398 Vali Acc: 0.775 Test Loss: 1.398 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 192112391
model size : 734.29MB
2025-04-28 13:57:37.159071: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:57:37.178201: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745848657.200656 1833149 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745848657.207691 1833149 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:57:37.230704: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6825685501098633
Epoch: 1, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.013 Vali Acc: 0.595 Test Loss: 1.013 Test Acc: 0.595
Validation loss decreased (inf --> -0.595366).  Saving model ...
Epoch: 2 cost time: 2.5031330585479736
Epoch: 2, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.613 Vali Acc: 0.740 Test Loss: 0.613 Test Acc: 0.740
Validation loss decreased (-0.595366 --> -0.739878).  Saving model ...
Epoch: 3 cost time: 4.426565647125244
Epoch: 3, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.801 Vali Acc: 0.751 Test Loss: 0.801 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751437).  Saving model ...
Epoch: 4 cost time: 2.4934003353118896
Epoch: 4, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.895 Vali Acc: 0.769 Test Loss: 0.895 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768777).  Saving model ...
Epoch: 5 cost time: 2.542231559753418
Epoch: 5, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.671 Vali Acc: 0.827 Test Loss: 0.671 Test Acc: 0.827
Validation loss decreased (-0.768777 --> -0.826583).  Saving model ...
Epoch: 6 cost time: 2.4815385341644287
Epoch: 6, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.780 Test Loss: 0.933 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.502896785736084
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.801 Vali Acc: 0.775 Test Loss: 0.801 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4968464374542236
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.857 Vali Acc: 0.798 Test Loss: 0.857 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4862051010131836
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.189 Vali Acc: 0.734 Test Loss: 1.189 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.484943389892578
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.652 Vali Acc: 0.769 Test Loss: 0.652 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.5018179416656494
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.291 Vali Acc: 0.780 Test Loss: 1.291 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.469829797744751
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.223 Vali Acc: 0.769 Test Loss: 1.223 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.44956111907959
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.362 Vali Acc: 0.769 Test Loss: 1.362 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.5149950981140137
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.040 Vali Acc: 0.757 Test Loss: 1.040 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.4948930740356445
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.133 Vali Acc: 0.751 Test Loss: 2.133 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 191681191
model size : 732.64MB
2025-04-28 13:59:09.454799: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 13:59:09.474839: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745848749.498212 1840040 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745848749.505334 1840040 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 13:59:09.529026: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 8.746071577072144
Epoch: 1, Steps: 17 | Train Loss: 29.898 Vali Loss: 24.042 Vali Acc: 0.618 Test Loss: 24.042 Test Acc: 0.618
Validation loss decreased (inf --> -0.618257).  Saving model ...
Epoch: 2 cost time: 7.743510723114014
Epoch: 2, Steps: 17 | Train Loss: 29.919 Vali Loss: 60.451 Vali Acc: 0.584 Test Loss: 60.451 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.693879842758179
Epoch: 3, Steps: 17 | Train Loss: 24.780 Vali Loss: 59.594 Vali Acc: 0.699 Test Loss: 59.594 Test Acc: 0.699
Validation loss decreased (-0.618257 --> -0.698826).  Saving model ...
Epoch: 4 cost time: 7.712897539138794
Epoch: 4, Steps: 17 | Train Loss: 19.525 Vali Loss: 67.298 Vali Acc: 0.751 Test Loss: 67.298 Test Acc: 0.751
Validation loss decreased (-0.698826 --> -0.750772).  Saving model ...
Epoch: 5 cost time: 7.733061790466309
Epoch: 5, Steps: 17 | Train Loss: 11.195 Vali Loss: 117.939 Vali Acc: 0.694 Test Loss: 117.939 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.678016185760498
Epoch: 6, Steps: 17 | Train Loss: 10.347 Vali Loss: 131.316 Vali Acc: 0.578 Test Loss: 131.316 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.693898439407349
Epoch: 7, Steps: 17 | Train Loss: 10.061 Vali Loss: 82.790 Vali Acc: 0.694 Test Loss: 82.790 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.6847758293151855
Epoch: 8, Steps: 17 | Train Loss: 4.278 Vali Loss: 63.298 Vali Acc: 0.734 Test Loss: 63.298 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.6810832023620605
Epoch: 9, Steps: 17 | Train Loss: 3.433 Vali Loss: 49.852 Vali Acc: 0.717 Test Loss: 49.852 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.671730279922485
Epoch: 10, Steps: 17 | Train Loss: 0.673 Vali Loss: 44.867 Vali Acc: 0.751 Test Loss: 44.867 Test Acc: 0.751
Validation loss decreased (-0.750772 --> -0.750996).  Saving model ...
Epoch: 11 cost time: 7.73514461517334
Epoch: 11, Steps: 17 | Train Loss: 1.217 Vali Loss: 56.173 Vali Acc: 0.751 Test Loss: 56.173 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.672660827636719
Epoch: 12, Steps: 17 | Train Loss: 2.141 Vali Loss: 46.898 Vali Acc: 0.751 Test Loss: 46.898 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.696752548217773
Epoch: 13, Steps: 17 | Train Loss: 0.189 Vali Loss: 47.102 Vali Acc: 0.734 Test Loss: 47.102 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.679821491241455
Epoch: 14, Steps: 17 | Train Loss: 0.476 Vali Loss: 69.333 Vali Acc: 0.746 Test Loss: 69.333 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.684298038482666
Epoch: 15, Steps: 17 | Train Loss: 1.029 Vali Loss: 138.408 Vali Acc: 0.601 Test Loss: 138.408 Test Acc: 0.601
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.678864240646362
Epoch: 16, Steps: 17 | Train Loss: 6.356 Vali Loss: 88.724 Vali Acc: 0.728 Test Loss: 88.724 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.687723875045776
Epoch: 17, Steps: 17 | Train Loss: 4.958 Vali Loss: 53.620 Vali Acc: 0.769 Test Loss: 53.620 Test Acc: 0.769
Validation loss decreased (-0.750996 --> -0.768250).  Saving model ...
Epoch: 18 cost time: 7.709825038909912
Epoch: 18, Steps: 17 | Train Loss: 1.644 Vali Loss: 85.265 Vali Acc: 0.740 Test Loss: 85.265 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.669992923736572
Epoch: 19, Steps: 17 | Train Loss: 2.773 Vali Loss: 151.442 Vali Acc: 0.711 Test Loss: 151.442 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.679100275039673
Epoch: 20, Steps: 17 | Train Loss: 1.440 Vali Loss: 179.409 Vali Acc: 0.682 Test Loss: 179.409 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.689064264297485
Epoch: 21, Steps: 17 | Train Loss: 3.523 Vali Loss: 137.619 Vali Acc: 0.676 Test Loss: 137.619 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.676160097122192
Epoch: 22, Steps: 17 | Train Loss: 1.266 Vali Loss: 161.012 Vali Acc: 0.659 Test Loss: 161.012 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.691622495651245
Epoch: 23, Steps: 17 | Train Loss: 1.064 Vali Loss: 238.091 Vali Acc: 0.636 Test Loss: 238.091 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.675885915756226
Epoch: 24, Steps: 17 | Train Loss: 4.545 Vali Loss: 115.995 Vali Acc: 0.694 Test Loss: 115.995 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.683203458786011
Epoch: 25, Steps: 17 | Train Loss: 2.143 Vali Loss: 92.254 Vali Acc: 0.734 Test Loss: 92.254 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.690837860107422
Epoch: 26, Steps: 17 | Train Loss: 7.870 Vali Loss: 228.683 Vali Acc: 0.688 Test Loss: 228.683 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.687795877456665
Epoch: 27, Steps: 17 | Train Loss: 13.321 Vali Loss: 262.912 Vali Acc: 0.711 Test Loss: 262.912 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 731697415
model size : 2794.98MB
2025-04-28 14:05:24.373557: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:05:24.393366: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745849124.417106 1853112 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745849124.424257 1853112 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:05:24.448282: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.048935174942017
Epoch: 1, Steps: 17 | Train Loss: 15.474 Vali Loss: 24.787 Vali Acc: 0.457 Test Loss: 24.787 Test Acc: 0.457
Validation loss decreased (inf --> -0.456400).  Saving model ...
Epoch: 2 cost time: 5.965103626251221
Epoch: 2, Steps: 17 | Train Loss: 20.873 Vali Loss: 46.309 Vali Acc: 0.486 Test Loss: 46.309 Test Acc: 0.486
Validation loss decreased (-0.456400 --> -0.485086).  Saving model ...
Epoch: 3 cost time: 5.9195311069488525
Epoch: 3, Steps: 17 | Train Loss: 17.224 Vali Loss: 59.812 Vali Acc: 0.601 Test Loss: 59.812 Test Acc: 0.601
Validation loss decreased (-0.485086 --> -0.600558).  Saving model ...
Epoch: 4 cost time: 5.917536735534668
Epoch: 4, Steps: 17 | Train Loss: 13.119 Vali Loss: 126.389 Vali Acc: 0.474 Test Loss: 126.389 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.8670573234558105
Epoch: 5, Steps: 17 | Train Loss: 12.871 Vali Loss: 44.428 Vali Acc: 0.624 Test Loss: 44.428 Test Acc: 0.624
Validation loss decreased (-0.600558 --> -0.623833).  Saving model ...
Epoch: 6 cost time: 5.947041749954224
Epoch: 6, Steps: 17 | Train Loss: 3.083 Vali Loss: 11.836 Vali Acc: 0.792 Test Loss: 11.836 Test Acc: 0.792
Validation loss decreased (-0.623833 --> -0.791789).  Saving model ...
Epoch: 7 cost time: 5.914851427078247
Epoch: 7, Steps: 17 | Train Loss: 0.286 Vali Loss: 32.941 Vali Acc: 0.694 Test Loss: 32.941 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.879179000854492
Epoch: 8, Steps: 17 | Train Loss: 0.945 Vali Loss: 31.809 Vali Acc: 0.717 Test Loss: 31.809 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.8953857421875
Epoch: 9, Steps: 17 | Train Loss: 2.011 Vali Loss: 50.511 Vali Acc: 0.671 Test Loss: 50.511 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.85428261756897
Epoch: 10, Steps: 17 | Train Loss: 1.548 Vali Loss: 45.072 Vali Acc: 0.699 Test Loss: 45.072 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.865009546279907
Epoch: 11, Steps: 17 | Train Loss: 2.484 Vali Loss: 34.807 Vali Acc: 0.705 Test Loss: 34.807 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.873713254928589
Epoch: 12, Steps: 17 | Train Loss: 0.203 Vali Loss: 40.494 Vali Acc: 0.711 Test Loss: 40.494 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.865238189697266
Epoch: 13, Steps: 17 | Train Loss: 0.728 Vali Loss: 35.248 Vali Acc: 0.694 Test Loss: 35.248 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.88486123085022
Epoch: 14, Steps: 17 | Train Loss: 1.296 Vali Loss: 37.762 Vali Acc: 0.746 Test Loss: 37.762 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.8836846351623535
Epoch: 15, Steps: 17 | Train Loss: 2.112 Vali Loss: 42.344 Vali Acc: 0.682 Test Loss: 42.344 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.878255128860474
Epoch: 16, Steps: 17 | Train Loss: 0.456 Vali Loss: 64.379 Vali Acc: 0.682 Test Loss: 64.379 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 669573383
model size : 2558.00MB
2025-04-28 14:08:40.229428: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:08:40.248661: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745849320.271210 1860837 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745849320.278251 1860837 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:08:40.301666: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.26742959022522
Epoch: 1, Steps: 17 | Train Loss: 6.466 Vali Loss: 10.359 Vali Acc: 0.578 Test Loss: 10.359 Test Acc: 0.578
Validation loss decreased (inf --> -0.577931).  Saving model ...
Epoch: 2 cost time: 5.1288206577301025
Epoch: 2, Steps: 17 | Train Loss: 10.158 Vali Loss: 17.202 Vali Acc: 0.694 Test Loss: 17.202 Test Acc: 0.694
Validation loss decreased (-0.577931 --> -0.693470).  Saving model ...
Epoch: 3 cost time: 6.422520399093628
Epoch: 3, Steps: 17 | Train Loss: 10.242 Vali Loss: 22.967 Vali Acc: 0.613 Test Loss: 22.967 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.060877323150635
Epoch: 4, Steps: 17 | Train Loss: 6.190 Vali Loss: 48.515 Vali Acc: 0.538 Test Loss: 48.515 Test Acc: 0.538
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.061800241470337
Epoch: 5, Steps: 17 | Train Loss: 7.824 Vali Loss: 41.829 Vali Acc: 0.665 Test Loss: 41.829 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.078617095947266
Epoch: 6, Steps: 17 | Train Loss: 3.594 Vali Loss: 29.119 Vali Acc: 0.665 Test Loss: 29.119 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.053486108779907
Epoch: 7, Steps: 17 | Train Loss: 2.277 Vali Loss: 22.848 Vali Acc: 0.798 Test Loss: 22.848 Test Acc: 0.798
Validation loss decreased (-0.693470 --> -0.797459).  Saving model ...
Epoch: 8 cost time: 5.088433265686035
Epoch: 8, Steps: 17 | Train Loss: 1.299 Vali Loss: 18.631 Vali Acc: 0.786 Test Loss: 18.631 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.069523572921753
Epoch: 9, Steps: 17 | Train Loss: 0.770 Vali Loss: 17.712 Vali Acc: 0.734 Test Loss: 17.712 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.071946620941162
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 19.712 Vali Acc: 0.775 Test Loss: 19.712 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.069727897644043
Epoch: 11, Steps: 17 | Train Loss: 0.211 Vali Loss: 22.455 Vali Acc: 0.717 Test Loss: 22.455 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.0735626220703125
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 26.275 Vali Acc: 0.746 Test Loss: 26.275 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.072523832321167
Epoch: 13, Steps: 17 | Train Loss: 1.789 Vali Loss: 28.727 Vali Acc: 0.763 Test Loss: 28.727 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.065056562423706
Epoch: 14, Steps: 17 | Train Loss: 0.813 Vali Loss: 42.556 Vali Acc: 0.694 Test Loss: 42.556 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.0768725872039795
Epoch: 15, Steps: 17 | Train Loss: 1.767 Vali Loss: 33.272 Vali Acc: 0.711 Test Loss: 33.272 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.059392690658569
Epoch: 16, Steps: 17 | Train Loss: 3.758 Vali Loss: 38.218 Vali Acc: 0.728 Test Loss: 38.218 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.05229640007019
Epoch: 17, Steps: 17 | Train Loss: 0.488 Vali Loss: 34.176 Vali Acc: 0.751 Test Loss: 34.176 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 648865799
model size : 2479.01MB
2025-04-28 14:11:35.084015: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:11:35.102871: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745849495.124939 1868886 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745849495.131693 1868886 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:11:35.154130: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.985264301300049
Epoch: 1, Steps: 17 | Train Loss: 6.680 Vali Loss: 11.072 Vali Acc: 0.561 Test Loss: 11.072 Test Acc: 0.561
Validation loss decreased (inf --> -0.560583).  Saving model ...
Epoch: 2 cost time: 4.775367498397827
Epoch: 2, Steps: 17 | Train Loss: 6.119 Vali Loss: 15.814 Vali Acc: 0.682 Test Loss: 15.814 Test Acc: 0.682
Validation loss decreased (-0.560583 --> -0.681923).  Saving model ...
Epoch: 3 cost time: 4.775625944137573
Epoch: 3, Steps: 17 | Train Loss: 6.218 Vali Loss: 23.181 Vali Acc: 0.636 Test Loss: 23.181 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.745234251022339
Epoch: 4, Steps: 17 | Train Loss: 4.060 Vali Loss: 16.942 Vali Acc: 0.705 Test Loss: 16.942 Test Acc: 0.705
Validation loss decreased (-0.681923 --> -0.705033).  Saving model ...
Epoch: 5 cost time: 4.817582607269287
Epoch: 5, Steps: 17 | Train Loss: 3.476 Vali Loss: 36.229 Vali Acc: 0.636 Test Loss: 36.229 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.736755847930908
Epoch: 6, Steps: 17 | Train Loss: 3.369 Vali Loss: 18.741 Vali Acc: 0.763 Test Loss: 18.741 Test Acc: 0.763
Validation loss decreased (-0.705033 --> -0.762818).  Saving model ...
Epoch: 7 cost time: 4.792762517929077
Epoch: 7, Steps: 17 | Train Loss: 2.191 Vali Loss: 55.712 Vali Acc: 0.642 Test Loss: 55.712 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.753826856613159
Epoch: 8, Steps: 17 | Train Loss: 4.146 Vali Loss: 26.607 Vali Acc: 0.688 Test Loss: 26.607 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.740481376647949
Epoch: 9, Steps: 17 | Train Loss: 1.213 Vali Loss: 17.797 Vali Acc: 0.728 Test Loss: 17.797 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.745051622390747
Epoch: 10, Steps: 17 | Train Loss: 0.987 Vali Loss: 27.529 Vali Acc: 0.723 Test Loss: 27.529 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.771448135375977
Epoch: 11, Steps: 17 | Train Loss: 0.492 Vali Loss: 25.808 Vali Acc: 0.665 Test Loss: 25.808 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.73768162727356
Epoch: 12, Steps: 17 | Train Loss: 2.312 Vali Loss: 46.762 Vali Acc: 0.647 Test Loss: 46.762 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.7460503578186035
Epoch: 13, Steps: 17 | Train Loss: 1.499 Vali Loss: 23.336 Vali Acc: 0.798 Test Loss: 23.336 Test Acc: 0.798
Validation loss decreased (-0.762818 --> -0.797454).  Saving model ...
Epoch: 14 cost time: 4.753217935562134
Epoch: 14, Steps: 17 | Train Loss: 0.344 Vali Loss: 13.435 Vali Acc: 0.780 Test Loss: 13.435 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.764455318450928
Epoch: 15, Steps: 17 | Train Loss: 0.124 Vali Loss: 28.826 Vali Acc: 0.757 Test Loss: 28.826 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.727628707885742
Epoch: 16, Steps: 17 | Train Loss: 0.679 Vali Loss: 32.788 Vali Acc: 0.763 Test Loss: 32.788 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.753398180007935
Epoch: 17, Steps: 17 | Train Loss: 0.257 Vali Loss: 26.279 Vali Acc: 0.763 Test Loss: 26.279 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.746769428253174
Epoch: 18, Steps: 17 | Train Loss: 0.076 Vali Loss: 31.251 Vali Acc: 0.751 Test Loss: 31.251 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.734874963760376
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 33.618 Vali Acc: 0.780 Test Loss: 33.618 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.748466730117798
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 51.163 Vali Acc: 0.746 Test Loss: 51.163 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.7223711013793945
Epoch: 21, Steps: 17 | Train Loss: 1.082 Vali Loss: 61.803 Vali Acc: 0.740 Test Loss: 61.803 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.746874570846558
Epoch: 22, Steps: 17 | Train Loss: 1.092 Vali Loss: 28.932 Vali Acc: 0.775 Test Loss: 28.932 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.724328279495239
Epoch: 23, Steps: 17 | Train Loss: 2.552 Vali Loss: 34.860 Vali Acc: 0.763 Test Loss: 34.860 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 638512647
model size : 2439.51MB
2025-04-28 14:15:15.428066: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:15:15.446945: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745849715.469986 1879646 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745849715.476959 1879646 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:15:15.500046: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.081272840499878
Epoch: 1, Steps: 17 | Train Loss: 3.515 Vali Loss: 3.985 Vali Acc: 0.676 Test Loss: 3.985 Test Acc: 0.676
Validation loss decreased (inf --> -0.676261).  Saving model ...
Epoch: 2 cost time: 4.886923789978027
Epoch: 2, Steps: 17 | Train Loss: 2.205 Vali Loss: 5.233 Vali Acc: 0.740 Test Loss: 5.233 Test Acc: 0.740
Validation loss decreased (-0.676261 --> -0.739832).  Saving model ...
Epoch: 3 cost time: 4.874135494232178
Epoch: 3, Steps: 17 | Train Loss: 8.025 Vali Loss: 17.016 Vali Acc: 0.624 Test Loss: 17.016 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.833280801773071
Epoch: 4, Steps: 17 | Train Loss: 2.935 Vali Loss: 14.895 Vali Acc: 0.659 Test Loss: 14.895 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.811700820922852
Epoch: 5, Steps: 17 | Train Loss: 3.020 Vali Loss: 17.374 Vali Acc: 0.751 Test Loss: 17.374 Test Acc: 0.751
Validation loss decreased (-0.739832 --> -0.751271).  Saving model ...
Epoch: 6 cost time: 4.859506368637085
Epoch: 6, Steps: 17 | Train Loss: 3.217 Vali Loss: 15.898 Vali Acc: 0.740 Test Loss: 15.898 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.835275888442993
Epoch: 7, Steps: 17 | Train Loss: 2.778 Vali Loss: 21.042 Vali Acc: 0.682 Test Loss: 21.042 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.8245415687561035
Epoch: 8, Steps: 17 | Train Loss: 1.347 Vali Loss: 17.886 Vali Acc: 0.723 Test Loss: 17.886 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.824391603469849
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 26.126 Vali Acc: 0.671 Test Loss: 26.126 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.832672834396362
Epoch: 10, Steps: 17 | Train Loss: 1.082 Vali Loss: 24.275 Vali Acc: 0.757 Test Loss: 24.275 Test Acc: 0.757
Validation loss decreased (-0.751271 --> -0.756983).  Saving model ...
Epoch: 11 cost time: 4.879069805145264
Epoch: 11, Steps: 17 | Train Loss: 0.819 Vali Loss: 38.223 Vali Acc: 0.642 Test Loss: 38.223 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.837159872055054
Epoch: 12, Steps: 17 | Train Loss: 1.052 Vali Loss: 21.554 Vali Acc: 0.763 Test Loss: 21.554 Test Acc: 0.763
Validation loss decreased (-0.756983 --> -0.762790).  Saving model ...
Epoch: 13 cost time: 4.875442266464233
Epoch: 13, Steps: 17 | Train Loss: 1.031 Vali Loss: 17.545 Vali Acc: 0.803 Test Loss: 17.545 Test Acc: 0.803
Validation loss decreased (-0.762790 --> -0.803293).  Saving model ...
Epoch: 14 cost time: 4.865527868270874
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 13.552 Vali Acc: 0.827 Test Loss: 13.552 Test Acc: 0.827
Validation loss decreased (-0.803293 --> -0.826454).  Saving model ...
Epoch: 15 cost time: 4.848078966140747
Epoch: 15, Steps: 17 | Train Loss: 1.023 Vali Loss: 21.196 Vali Acc: 0.740 Test Loss: 21.196 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.8462865352630615
Epoch: 16, Steps: 17 | Train Loss: 0.591 Vali Loss: 16.018 Vali Acc: 0.809 Test Loss: 16.018 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.822157621383667
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 27.898 Vali Acc: 0.676 Test Loss: 27.898 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.8315558433532715
Epoch: 18, Steps: 17 | Train Loss: 0.530 Vali Loss: 18.832 Vali Acc: 0.723 Test Loss: 18.832 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.829364538192749
Epoch: 19, Steps: 17 | Train Loss: 0.554 Vali Loss: 23.373 Vali Acc: 0.780 Test Loss: 23.373 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.8350584506988525
Epoch: 20, Steps: 17 | Train Loss: 0.186 Vali Loss: 45.511 Vali Acc: 0.699 Test Loss: 45.511 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.850343465805054
Epoch: 21, Steps: 17 | Train Loss: 0.256 Vali Loss: 31.193 Vali Acc: 0.717 Test Loss: 31.193 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.818235158920288
Epoch: 22, Steps: 17 | Train Loss: 0.132 Vali Loss: 29.408 Vali Acc: 0.728 Test Loss: 29.408 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.833843231201172
Epoch: 23, Steps: 17 | Train Loss: 0.166 Vali Loss: 32.364 Vali Acc: 0.740 Test Loss: 32.364 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.836820363998413
Epoch: 24, Steps: 17 | Train Loss: 0.153 Vali Loss: 29.307 Vali Acc: 0.717 Test Loss: 29.307 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 629885959
model size : 2406.60MB
2025-04-28 14:19:18.926470: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:19:18.945678: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745849958.968566 1890924 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745849958.975756 1890924 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:19:18.999077: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.81232762336731
Epoch: 1, Steps: 17 | Train Loss: 3.647 Vali Loss: 3.055 Vali Acc: 0.653 Test Loss: 3.055 Test Acc: 0.653
Validation loss decreased (inf --> -0.653149).  Saving model ...
Epoch: 2 cost time: 4.656804800033569
Epoch: 2, Steps: 17 | Train Loss: 2.710 Vali Loss: 7.497 Vali Acc: 0.601 Test Loss: 7.497 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.563069105148315
Epoch: 3, Steps: 17 | Train Loss: 7.287 Vali Loss: 11.553 Vali Acc: 0.740 Test Loss: 11.553 Test Acc: 0.740
Validation loss decreased (-0.653149 --> -0.739769).  Saving model ...
Epoch: 4 cost time: 4.547678709030151
Epoch: 4, Steps: 17 | Train Loss: 5.302 Vali Loss: 8.557 Vali Acc: 0.740 Test Loss: 8.557 Test Acc: 0.740
Validation loss decreased (-0.739769 --> -0.739799).  Saving model ...
Epoch: 5 cost time: 4.557812452316284
Epoch: 5, Steps: 17 | Train Loss: 2.012 Vali Loss: 11.836 Vali Acc: 0.723 Test Loss: 11.836 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.539205312728882
Epoch: 6, Steps: 17 | Train Loss: 1.737 Vali Loss: 16.802 Vali Acc: 0.740 Test Loss: 16.802 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.5584588050842285
Epoch: 7, Steps: 17 | Train Loss: 1.731 Vali Loss: 19.878 Vali Acc: 0.659 Test Loss: 19.878 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.552018165588379
Epoch: 8, Steps: 17 | Train Loss: 1.528 Vali Loss: 7.489 Vali Acc: 0.780 Test Loss: 7.489 Test Acc: 0.780
Validation loss decreased (-0.739799 --> -0.780272).  Saving model ...
Epoch: 9 cost time: 4.572952032089233
Epoch: 9, Steps: 17 | Train Loss: 0.344 Vali Loss: 14.866 Vali Acc: 0.769 Test Loss: 14.866 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.532861709594727
Epoch: 10, Steps: 17 | Train Loss: 0.636 Vali Loss: 13.902 Vali Acc: 0.757 Test Loss: 13.902 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.5280303955078125
Epoch: 11, Steps: 17 | Train Loss: 0.283 Vali Loss: 11.320 Vali Acc: 0.780 Test Loss: 11.320 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.538771152496338
Epoch: 12, Steps: 17 | Train Loss: 0.382 Vali Loss: 13.989 Vali Acc: 0.746 Test Loss: 13.989 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.541869640350342
Epoch: 13, Steps: 17 | Train Loss: 0.443 Vali Loss: 30.731 Vali Acc: 0.694 Test Loss: 30.731 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.562609434127808
Epoch: 14, Steps: 17 | Train Loss: 1.128 Vali Loss: 25.455 Vali Acc: 0.757 Test Loss: 25.455 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.537797212600708
Epoch: 15, Steps: 17 | Train Loss: 3.035 Vali Loss: 11.278 Vali Acc: 0.775 Test Loss: 11.278 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.531363010406494
Epoch: 16, Steps: 17 | Train Loss: 0.257 Vali Loss: 10.276 Vali Acc: 0.803 Test Loss: 10.276 Test Acc: 0.803
Validation loss decreased (-0.780272 --> -0.803365).  Saving model ...
Epoch: 17 cost time: 4.565007448196411
Epoch: 17, Steps: 17 | Train Loss: 0.403 Vali Loss: 10.147 Vali Acc: 0.786 Test Loss: 10.147 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.524469614028931
Epoch: 18, Steps: 17 | Train Loss: 0.057 Vali Loss: 9.646 Vali Acc: 0.838 Test Loss: 9.646 Test Acc: 0.838
Validation loss decreased (-0.803365 --> -0.838054).  Saving model ...
Epoch: 19 cost time: 4.570619344711304
Epoch: 19, Steps: 17 | Train Loss: 0.085 Vali Loss: 17.735 Vali Acc: 0.751 Test Loss: 17.735 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.525633811950684
Epoch: 20, Steps: 17 | Train Loss: 1.321 Vali Loss: 21.653 Vali Acc: 0.780 Test Loss: 21.653 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.5230712890625
Epoch: 21, Steps: 17 | Train Loss: 0.409 Vali Loss: 25.036 Vali Acc: 0.763 Test Loss: 25.036 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.563080549240112
Epoch: 22, Steps: 17 | Train Loss: 0.355 Vali Loss: 12.550 Vali Acc: 0.827 Test Loss: 12.550 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.5680811405181885
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 15.522 Vali Acc: 0.809 Test Loss: 15.522 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.595738172531128
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 16.334 Vali Acc: 0.803 Test Loss: 16.334 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 9.500336647033691
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 16.456 Vali Acc: 0.798 Test Loss: 16.456 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.547774791717529
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 16.526 Vali Acc: 0.798 Test Loss: 16.526 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.585076332092285
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 16.535 Vali Acc: 0.803 Test Loss: 16.535 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.31541895866394
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 16.487 Vali Acc: 0.798 Test Loss: 16.487 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 622984967
model size : 2380.28MB
2025-04-28 14:23:52.874900: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:23:52.893995: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745850232.920694 1904935 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745850232.927740 1904935 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:23:52.954885: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 7.164827108383179
Epoch: 1, Steps: 17 | Train Loss: 2.911 Vali Loss: 4.355 Vali Acc: 0.590 Test Loss: 4.355 Test Acc: 0.590
Validation loss decreased (inf --> -0.589552).  Saving model ...
Epoch: 2 cost time: 4.581040620803833
Epoch: 2, Steps: 17 | Train Loss: 3.706 Vali Loss: 4.023 Vali Acc: 0.699 Test Loss: 4.023 Test Acc: 0.699
Validation loss decreased (-0.589552 --> -0.699382).  Saving model ...
Epoch: 3 cost time: 5.875812768936157
Epoch: 3, Steps: 17 | Train Loss: 3.621 Vali Loss: 7.403 Vali Acc: 0.717 Test Loss: 7.403 Test Acc: 0.717
Validation loss decreased (-0.699382 --> -0.716689).  Saving model ...
Epoch: 4 cost time: 8.826643943786621
Epoch: 4, Steps: 17 | Train Loss: 1.117 Vali Loss: 4.535 Vali Acc: 0.786 Test Loss: 4.535 Test Acc: 0.786
Validation loss decreased (-0.716689 --> -0.786082).  Saving model ...
Epoch: 5 cost time: 4.51114821434021
Epoch: 5, Steps: 17 | Train Loss: 2.200 Vali Loss: 13.622 Vali Acc: 0.676 Test Loss: 13.622 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.939783811569214
Epoch: 6, Steps: 17 | Train Loss: 1.988 Vali Loss: 10.049 Vali Acc: 0.711 Test Loss: 10.049 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.806550741195679
Epoch: 7, Steps: 17 | Train Loss: 1.309 Vali Loss: 16.175 Vali Acc: 0.757 Test Loss: 16.175 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.054566621780396
Epoch: 8, Steps: 17 | Train Loss: 0.720 Vali Loss: 10.530 Vali Acc: 0.746 Test Loss: 10.530 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.36061429977417
Epoch: 9, Steps: 17 | Train Loss: 1.789 Vali Loss: 25.481 Vali Acc: 0.746 Test Loss: 25.481 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.97629189491272
Epoch: 10, Steps: 17 | Train Loss: 1.617 Vali Loss: 7.901 Vali Acc: 0.821 Test Loss: 7.901 Test Acc: 0.821
Validation loss decreased (-0.786082 --> -0.820730).  Saving model ...
Epoch: 11 cost time: 8.95971417427063
Epoch: 11, Steps: 17 | Train Loss: 1.253 Vali Loss: 20.802 Vali Acc: 0.728 Test Loss: 20.802 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.7341628074646
Epoch: 12, Steps: 17 | Train Loss: 2.285 Vali Loss: 14.841 Vali Acc: 0.827 Test Loss: 14.841 Test Acc: 0.827
Validation loss decreased (-0.820730 --> -0.826441).  Saving model ...
Epoch: 13 cost time: 9.364288091659546
Epoch: 13, Steps: 17 | Train Loss: 0.659 Vali Loss: 24.844 Vali Acc: 0.699 Test Loss: 24.844 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.485856771469116
Epoch: 14, Steps: 17 | Train Loss: 0.529 Vali Loss: 12.874 Vali Acc: 0.803 Test Loss: 12.874 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.9500181674957275
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 16.707 Vali Acc: 0.780 Test Loss: 16.707 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.344296932220459
Epoch: 16, Steps: 17 | Train Loss: 0.522 Vali Loss: 20.158 Vali Acc: 0.769 Test Loss: 20.158 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.546118974685669
Epoch: 17, Steps: 17 | Train Loss: 0.287 Vali Loss: 22.227 Vali Acc: 0.786 Test Loss: 22.227 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.646133184432983
Epoch: 18, Steps: 17 | Train Loss: 0.166 Vali Loss: 26.671 Vali Acc: 0.751 Test Loss: 26.671 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.870126008987427
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 18.975 Vali Acc: 0.786 Test Loss: 18.975 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.914721012115479
Epoch: 20, Steps: 17 | Train Loss: 0.119 Vali Loss: 23.593 Vali Acc: 0.769 Test Loss: 23.593 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.6423468589782715
Epoch: 21, Steps: 17 | Train Loss: 0.430 Vali Loss: 26.577 Vali Acc: 0.769 Test Loss: 26.577 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.794861078262329
Epoch: 22, Steps: 17 | Train Loss: 0.386 Vali Loss: 25.957 Vali Acc: 0.763 Test Loss: 25.957 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 621261063
model size : 2373.70MB
2025-04-28 14:29:26.836743: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:29:26.855042: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745850566.876768 1921761 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745850566.883537 1921761 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:29:26.905965: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.574585199356079
Epoch: 1, Steps: 17 | Train Loss: 12.339 Vali Loss: 25.521 Vali Acc: 0.416 Test Loss: 25.521 Test Acc: 0.416
Validation loss decreased (inf --> -0.415930).  Saving model ...
Epoch: 2 cost time: 4.460700511932373
Epoch: 2, Steps: 17 | Train Loss: 14.112 Vali Loss: 40.597 Vali Acc: 0.555 Test Loss: 40.597 Test Acc: 0.555
Validation loss decreased (-0.415930 --> -0.554507).  Saving model ...
Epoch: 3 cost time: 4.46445369720459
Epoch: 3, Steps: 17 | Train Loss: 15.031 Vali Loss: 26.727 Vali Acc: 0.671 Test Loss: 26.727 Test Acc: 0.671
Validation loss decreased (-0.554507 --> -0.670253).  Saving model ...
Epoch: 4 cost time: 4.459644317626953
Epoch: 4, Steps: 17 | Train Loss: 15.256 Vali Loss: 89.453 Vali Acc: 0.613 Test Loss: 89.453 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.425913333892822
Epoch: 5, Steps: 17 | Train Loss: 10.251 Vali Loss: 26.852 Vali Acc: 0.746 Test Loss: 26.852 Test Acc: 0.746
Validation loss decreased (-0.670253 --> -0.745396).  Saving model ...
Epoch: 6 cost time: 4.45650577545166
Epoch: 6, Steps: 17 | Train Loss: 3.702 Vali Loss: 26.565 Vali Acc: 0.711 Test Loss: 26.565 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.4220802783966064
Epoch: 7, Steps: 17 | Train Loss: 1.965 Vali Loss: 45.166 Vali Acc: 0.688 Test Loss: 45.166 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.440253496170044
Epoch: 8, Steps: 17 | Train Loss: 2.921 Vali Loss: 33.721 Vali Acc: 0.728 Test Loss: 33.721 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.44352126121521
Epoch: 9, Steps: 17 | Train Loss: 3.384 Vali Loss: 68.064 Vali Acc: 0.561 Test Loss: 68.064 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.4330267906188965
Epoch: 10, Steps: 17 | Train Loss: 2.414 Vali Loss: 44.366 Vali Acc: 0.676 Test Loss: 44.366 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.411019325256348
Epoch: 11, Steps: 17 | Train Loss: 0.393 Vali Loss: 55.048 Vali Acc: 0.671 Test Loss: 55.048 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.424259662628174
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 28.844 Vali Acc: 0.763 Test Loss: 28.844 Test Acc: 0.763
Validation loss decreased (-0.745396 --> -0.762717).  Saving model ...
Epoch: 13 cost time: 4.464379787445068
Epoch: 13, Steps: 17 | Train Loss: 0.680 Vali Loss: 42.950 Vali Acc: 0.705 Test Loss: 42.950 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.414718389511108
Epoch: 14, Steps: 17 | Train Loss: 0.455 Vali Loss: 50.747 Vali Acc: 0.642 Test Loss: 50.747 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.415910720825195
Epoch: 15, Steps: 17 | Train Loss: 0.579 Vali Loss: 36.582 Vali Acc: 0.723 Test Loss: 36.582 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.424880743026733
Epoch: 16, Steps: 17 | Train Loss: 0.362 Vali Loss: 47.788 Vali Acc: 0.653 Test Loss: 47.788 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.424667835235596
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 44.582 Vali Acc: 0.676 Test Loss: 44.582 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.433639049530029
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 53.734 Vali Acc: 0.659 Test Loss: 53.734 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.434487342834473
Epoch: 19, Steps: 17 | Train Loss: 0.189 Vali Loss: 78.664 Vali Acc: 0.630 Test Loss: 78.664 Test Acc: 0.630
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.424691438674927
Epoch: 20, Steps: 17 | Train Loss: 1.755 Vali Loss: 101.853 Vali Acc: 0.647 Test Loss: 101.853 Test Acc: 0.647
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.437045335769653
Epoch: 21, Steps: 17 | Train Loss: 7.038 Vali Loss: 49.371 Vali Acc: 0.763 Test Loss: 49.371 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.4339563846588135
Epoch: 22, Steps: 17 | Train Loss: 2.506 Vali Loss: 41.139 Vali Acc: 0.780 Test Loss: 41.139 Test Acc: 0.780
Validation loss decreased (-0.762717 --> -0.779935).  Saving model ...
Epoch: 23 cost time: 4.471546173095703
Epoch: 23, Steps: 17 | Train Loss: 1.063 Vali Loss: 43.528 Vali Acc: 0.734 Test Loss: 43.528 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.424379825592041
Epoch: 24, Steps: 17 | Train Loss: 0.801 Vali Loss: 24.792 Vali Acc: 0.809 Test Loss: 24.792 Test Acc: 0.809
Validation loss decreased (-0.779935 --> -0.809001).  Saving model ...
Epoch: 25 cost time: 4.461072683334351
Epoch: 25, Steps: 17 | Train Loss: 0.909 Vali Loss: 55.857 Vali Acc: 0.723 Test Loss: 55.857 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.422825336456299
Epoch: 26, Steps: 17 | Train Loss: 2.796 Vali Loss: 77.740 Vali Acc: 0.694 Test Loss: 77.740 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.435798168182373
Epoch: 27, Steps: 17 | Train Loss: 3.025 Vali Loss: 48.740 Vali Acc: 0.769 Test Loss: 48.740 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.423358678817749
Epoch: 28, Steps: 17 | Train Loss: 1.268 Vali Loss: 30.333 Vali Acc: 0.809 Test Loss: 30.333 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.441839218139648
Epoch: 29, Steps: 17 | Train Loss: 0.056 Vali Loss: 88.929 Vali Acc: 0.723 Test Loss: 88.929 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.43021035194397
Epoch: 30, Steps: 17 | Train Loss: 1.270 Vali Loss: 47.336 Vali Acc: 0.780 Test Loss: 47.336 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.444035530090332
Epoch: 31, Steps: 17 | Train Loss: 0.353 Vali Loss: 44.225 Vali Acc: 0.798 Test Loss: 44.225 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.434444427490234
Epoch: 32, Steps: 17 | Train Loss: 1.144 Vali Loss: 31.029 Vali Acc: 0.780 Test Loss: 31.029 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.453394651412964
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 44.821 Vali Acc: 0.751 Test Loss: 44.821 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.422250270843506
Epoch: 34, Steps: 17 | Train Loss: 0.037 Vali Loss: 35.973 Vali Acc: 0.821 Test Loss: 35.973 Test Acc: 0.821
Validation loss decreased (-0.809001 --> -0.820450).  Saving model ...
Epoch: 35 cost time: 4.4596076011657715
Epoch: 35, Steps: 17 | Train Loss: 2.605 Vali Loss: 34.138 Vali Acc: 0.809 Test Loss: 34.138 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.477071523666382
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 48.303 Vali Acc: 0.734 Test Loss: 48.303 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.428595542907715
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 51.361 Vali Acc: 0.711 Test Loss: 51.361 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.429007530212402
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 51.985 Vali Acc: 0.711 Test Loss: 51.985 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.436957836151123
Epoch: 39, Steps: 17 | Train Loss: 0.158 Vali Loss: 74.611 Vali Acc: 0.746 Test Loss: 74.611 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.419288635253906
Epoch: 40, Steps: 17 | Train Loss: 1.283 Vali Loss: 43.120 Vali Acc: 0.751 Test Loss: 43.120 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.434437990188599
Epoch: 41, Steps: 17 | Train Loss: 0.973 Vali Loss: 71.631 Vali Acc: 0.711 Test Loss: 71.631 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.429279565811157
Epoch: 42, Steps: 17 | Train Loss: 0.540 Vali Loss: 62.011 Vali Acc: 0.763 Test Loss: 62.011 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.439500093460083
Epoch: 43, Steps: 17 | Train Loss: 0.545 Vali Loss: 53.035 Vali Acc: 0.728 Test Loss: 53.035 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.418740749359131
Epoch: 44, Steps: 17 | Train Loss: 0.766 Vali Loss: 54.399 Vali Acc: 0.803 Test Loss: 54.399 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 334293127
model size : 1277.12MB
2025-04-28 14:35:24.673288: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:35:24.692683: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745850924.716034 1942323 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745850924.723071 1942323 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:35:24.746658: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.4934141635894775
Epoch: 1, Steps: 17 | Train Loss: 5.523 Vali Loss: 7.535 Vali Acc: 0.491 Test Loss: 7.535 Test Acc: 0.491
Validation loss decreased (inf --> -0.491254).  Saving model ...
Epoch: 2 cost time: 3.303370952606201
Epoch: 2, Steps: 17 | Train Loss: 10.657 Vali Loss: 28.594 Vali Acc: 0.520 Test Loss: 28.594 Test Acc: 0.520
Validation loss decreased (-0.491254 --> -0.519945).  Saving model ...
Epoch: 3 cost time: 3.289473533630371
Epoch: 3, Steps: 17 | Train Loss: 10.038 Vali Loss: 15.001 Vali Acc: 0.705 Test Loss: 15.001 Test Acc: 0.705
Validation loss decreased (-0.519945 --> -0.705052).  Saving model ...
Epoch: 4 cost time: 3.313706159591675
Epoch: 4, Steps: 17 | Train Loss: 5.881 Vali Loss: 48.797 Vali Acc: 0.613 Test Loss: 48.797 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2522923946380615
Epoch: 5, Steps: 17 | Train Loss: 6.853 Vali Loss: 27.141 Vali Acc: 0.630 Test Loss: 27.141 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2630178928375244
Epoch: 6, Steps: 17 | Train Loss: 0.681 Vali Loss: 16.432 Vali Acc: 0.751 Test Loss: 16.432 Test Acc: 0.751
Validation loss decreased (-0.705052 --> -0.751281).  Saving model ...
Epoch: 7 cost time: 3.298306941986084
Epoch: 7, Steps: 17 | Train Loss: 2.417 Vali Loss: 10.918 Vali Acc: 0.809 Test Loss: 10.918 Test Acc: 0.809
Validation loss decreased (-0.751281 --> -0.809139).  Saving model ...
Epoch: 8 cost time: 3.3133552074432373
Epoch: 8, Steps: 17 | Train Loss: 0.380 Vali Loss: 18.170 Vali Acc: 0.763 Test Loss: 18.170 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.258561611175537
Epoch: 9, Steps: 17 | Train Loss: 1.689 Vali Loss: 18.582 Vali Acc: 0.740 Test Loss: 18.582 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.2687416076660156
Epoch: 10, Steps: 17 | Train Loss: 1.023 Vali Loss: 18.421 Vali Acc: 0.751 Test Loss: 18.421 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.265554904937744
Epoch: 11, Steps: 17 | Train Loss: 0.274 Vali Loss: 11.376 Vali Acc: 0.827 Test Loss: 11.376 Test Acc: 0.827
Validation loss decreased (-0.809139 --> -0.826476).  Saving model ...
Epoch: 12 cost time: 3.306806802749634
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 25.014 Vali Acc: 0.647 Test Loss: 25.014 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2680013179779053
Epoch: 13, Steps: 17 | Train Loss: 0.688 Vali Loss: 20.784 Vali Acc: 0.803 Test Loss: 20.784 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2749905586242676
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 18.470 Vali Acc: 0.728 Test Loss: 18.470 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2671196460723877
Epoch: 15, Steps: 17 | Train Loss: 0.811 Vali Loss: 33.477 Vali Acc: 0.694 Test Loss: 33.477 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.2730772495269775
Epoch: 16, Steps: 17 | Train Loss: 2.834 Vali Loss: 34.483 Vali Acc: 0.705 Test Loss: 34.483 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2614476680755615
Epoch: 17, Steps: 17 | Train Loss: 0.955 Vali Loss: 29.471 Vali Acc: 0.757 Test Loss: 29.471 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.270677328109741
Epoch: 18, Steps: 17 | Train Loss: 0.076 Vali Loss: 18.438 Vali Acc: 0.792 Test Loss: 18.438 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2768213748931885
Epoch: 19, Steps: 17 | Train Loss: 0.242 Vali Loss: 24.878 Vali Acc: 0.763 Test Loss: 24.878 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.258772373199463
Epoch: 20, Steps: 17 | Train Loss: 0.263 Vali Loss: 24.441 Vali Acc: 0.792 Test Loss: 24.441 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.2894272804260254
Epoch: 21, Steps: 17 | Train Loss: 0.404 Vali Loss: 20.457 Vali Acc: 0.809 Test Loss: 20.457 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 303231111
model size : 1158.63MB
2025-04-28 14:37:56.056121: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:37:56.075829: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851076.098783 1951958 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851076.105705 1951958 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:37:56.128518: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.0859527587890625
Epoch: 1, Steps: 17 | Train Loss: 4.611 Vali Loss: 3.822 Vali Acc: 0.613 Test Loss: 3.822 Test Acc: 0.613
Validation loss decreased (inf --> -0.612679).  Saving model ...
Epoch: 2 cost time: 2.890932321548462
Epoch: 2, Steps: 17 | Train Loss: 3.145 Vali Loss: 6.006 Vali Acc: 0.659 Test Loss: 6.006 Test Acc: 0.659
Validation loss decreased (-0.612679 --> -0.658899).  Saving model ...
Epoch: 3 cost time: 2.8988492488861084
Epoch: 3, Steps: 17 | Train Loss: 2.766 Vali Loss: 12.620 Vali Acc: 0.642 Test Loss: 12.620 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.833500862121582
Epoch: 4, Steps: 17 | Train Loss: 5.411 Vali Loss: 10.968 Vali Acc: 0.694 Test Loss: 10.968 Test Acc: 0.694
Validation loss decreased (-0.658899 --> -0.693532).  Saving model ...
Epoch: 5 cost time: 2.876986026763916
Epoch: 5, Steps: 17 | Train Loss: 1.022 Vali Loss: 15.312 Vali Acc: 0.757 Test Loss: 15.312 Test Acc: 0.757
Validation loss decreased (-0.693532 --> -0.757072).  Saving model ...
Epoch: 6 cost time: 3.402294158935547
Epoch: 6, Steps: 17 | Train Loss: 2.202 Vali Loss: 9.264 Vali Acc: 0.786 Test Loss: 9.264 Test Acc: 0.786
Validation loss decreased (-0.757072 --> -0.786035).  Saving model ...
Epoch: 7 cost time: 2.8855507373809814
Epoch: 7, Steps: 17 | Train Loss: 1.027 Vali Loss: 12.176 Vali Acc: 0.780 Test Loss: 12.176 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8311877250671387
Epoch: 8, Steps: 17 | Train Loss: 0.645 Vali Loss: 12.109 Vali Acc: 0.751 Test Loss: 12.109 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8350071907043457
Epoch: 9, Steps: 17 | Train Loss: 0.605 Vali Loss: 9.500 Vali Acc: 0.763 Test Loss: 9.500 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8516650199890137
Epoch: 10, Steps: 17 | Train Loss: 0.887 Vali Loss: 13.112 Vali Acc: 0.780 Test Loss: 13.112 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.852518320083618
Epoch: 11, Steps: 17 | Train Loss: 0.616 Vali Loss: 10.392 Vali Acc: 0.740 Test Loss: 10.392 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.858668565750122
Epoch: 12, Steps: 17 | Train Loss: 0.414 Vali Loss: 14.597 Vali Acc: 0.624 Test Loss: 14.597 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.839855670928955
Epoch: 13, Steps: 17 | Train Loss: 0.749 Vali Loss: 16.216 Vali Acc: 0.740 Test Loss: 16.216 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.836829423904419
Epoch: 14, Steps: 17 | Train Loss: 0.563 Vali Loss: 20.088 Vali Acc: 0.694 Test Loss: 20.088 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.843181848526001
Epoch: 15, Steps: 17 | Train Loss: 0.744 Vali Loss: 22.585 Vali Acc: 0.757 Test Loss: 22.585 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8767361640930176
Epoch: 16, Steps: 17 | Train Loss: 0.303 Vali Loss: 19.876 Vali Acc: 0.682 Test Loss: 19.876 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 292877319
model size : 1119.13MB
2025-04-28 14:39:48.638549: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:39:48.657726: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851188.680194 1959339 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851188.687109 1959339 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:39:48.710095: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9441685676574707
Epoch: 1, Steps: 17 | Train Loss: 3.797 Vali Loss: 3.624 Vali Acc: 0.561 Test Loss: 3.624 Test Acc: 0.561
Validation loss decreased (inf --> -0.560657).  Saving model ...
Epoch: 2 cost time: 2.7131528854370117
Epoch: 2, Steps: 17 | Train Loss: 2.417 Vali Loss: 3.991 Vali Acc: 0.711 Test Loss: 3.991 Test Acc: 0.711
Validation loss decreased (-0.560657 --> -0.710943).  Saving model ...
Epoch: 3 cost time: 2.736689567565918
Epoch: 3, Steps: 17 | Train Loss: 2.566 Vali Loss: 5.622 Vali Acc: 0.746 Test Loss: 5.622 Test Acc: 0.746
Validation loss decreased (-0.710943 --> -0.745609).  Saving model ...
Epoch: 4 cost time: 2.7118008136749268
Epoch: 4, Steps: 17 | Train Loss: 1.925 Vali Loss: 9.366 Vali Acc: 0.705 Test Loss: 9.366 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.699810743331909
Epoch: 5, Steps: 17 | Train Loss: 1.576 Vali Loss: 8.033 Vali Acc: 0.775 Test Loss: 8.033 Test Acc: 0.775
Validation loss decreased (-0.745609 --> -0.774486).  Saving model ...
Epoch: 6 cost time: 2.7327768802642822
Epoch: 6, Steps: 17 | Train Loss: 3.069 Vali Loss: 16.341 Vali Acc: 0.711 Test Loss: 16.341 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.711700439453125
Epoch: 7, Steps: 17 | Train Loss: 3.261 Vali Loss: 26.455 Vali Acc: 0.671 Test Loss: 26.455 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7311532497406006
Epoch: 8, Steps: 17 | Train Loss: 2.030 Vali Loss: 13.584 Vali Acc: 0.659 Test Loss: 13.584 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7281296253204346
Epoch: 9, Steps: 17 | Train Loss: 0.458 Vali Loss: 10.680 Vali Acc: 0.798 Test Loss: 10.680 Test Acc: 0.798
Validation loss decreased (-0.774486 --> -0.797581).  Saving model ...
Epoch: 10 cost time: 2.7214701175689697
Epoch: 10, Steps: 17 | Train Loss: 0.194 Vali Loss: 15.611 Vali Acc: 0.740 Test Loss: 15.611 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.686159372329712
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 10.018 Vali Acc: 0.769 Test Loss: 10.018 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6958577632904053
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 20.160 Vali Acc: 0.694 Test Loss: 20.160 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6961424350738525
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 11.889 Vali Acc: 0.780 Test Loss: 11.889 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6910247802734375
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 12.494 Vali Acc: 0.746 Test Loss: 12.494 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.729395866394043
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 19.728 Vali Acc: 0.734 Test Loss: 19.728 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.691331386566162
Epoch: 16, Steps: 17 | Train Loss: 0.421 Vali Loss: 12.684 Vali Acc: 0.705 Test Loss: 12.684 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.688955783843994
Epoch: 17, Steps: 17 | Train Loss: 0.706 Vali Loss: 24.478 Vali Acc: 0.642 Test Loss: 24.478 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7060599327087402
Epoch: 18, Steps: 17 | Train Loss: 0.161 Vali Loss: 9.841 Vali Acc: 0.763 Test Loss: 9.841 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.6952030658721924
Epoch: 19, Steps: 17 | Train Loss: 0.097 Vali Loss: 14.190 Vali Acc: 0.746 Test Loss: 14.190 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 287700743
model size : 1099.39MB
2025-04-28 14:41:48.381651: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:41:48.400318: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851308.422419 1968010 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851308.429257 1968010 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:41:48.451542: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.744985818862915
Epoch: 1, Steps: 17 | Train Loss: 2.508 Vali Loss: 2.788 Vali Acc: 0.572 Test Loss: 2.788 Test Acc: 0.572
Validation loss decreased (inf --> -0.572226).  Saving model ...
Epoch: 2 cost time: 2.6071250438690186
Epoch: 2, Steps: 17 | Train Loss: 3.365 Vali Loss: 5.597 Vali Acc: 0.555 Test Loss: 5.597 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.577540159225464
Epoch: 3, Steps: 17 | Train Loss: 3.008 Vali Loss: 6.981 Vali Acc: 0.671 Test Loss: 6.981 Test Acc: 0.671
Validation loss decreased (-0.572226 --> -0.670450).  Saving model ...
Epoch: 4 cost time: 2.6310081481933594
Epoch: 4, Steps: 17 | Train Loss: 3.653 Vali Loss: 7.611 Vali Acc: 0.740 Test Loss: 7.611 Test Acc: 0.740
Validation loss decreased (-0.670450 --> -0.739808).  Saving model ...
Epoch: 5 cost time: 2.6299350261688232
Epoch: 5, Steps: 17 | Train Loss: 1.372 Vali Loss: 13.150 Vali Acc: 0.717 Test Loss: 13.150 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5997684001922607
Epoch: 6, Steps: 17 | Train Loss: 2.403 Vali Loss: 7.342 Vali Acc: 0.757 Test Loss: 7.342 Test Acc: 0.757
Validation loss decreased (-0.739808 --> -0.757152).  Saving model ...
Epoch: 7 cost time: 2.6197431087493896
Epoch: 7, Steps: 17 | Train Loss: 0.886 Vali Loss: 4.851 Vali Acc: 0.815 Test Loss: 4.851 Test Acc: 0.815
Validation loss decreased (-0.757152 --> -0.814980).  Saving model ...
Epoch: 8 cost time: 2.6362149715423584
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 7.953 Vali Acc: 0.775 Test Loss: 7.953 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5818898677825928
Epoch: 9, Steps: 17 | Train Loss: 0.047 Vali Loss: 3.620 Vali Acc: 0.838 Test Loss: 3.620 Test Acc: 0.838
Validation loss decreased (-0.814980 --> -0.838114).  Saving model ...
Epoch: 10 cost time: 2.6352109909057617
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 7.885 Vali Acc: 0.809 Test Loss: 7.885 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.592982053756714
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 7.530 Vali Acc: 0.809 Test Loss: 7.530 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.595353603363037
Epoch: 12, Steps: 17 | Train Loss: 0.573 Vali Loss: 7.991 Vali Acc: 0.780 Test Loss: 7.991 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5918688774108887
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 11.819 Vali Acc: 0.705 Test Loss: 11.819 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6000280380249023
Epoch: 14, Steps: 17 | Train Loss: 1.223 Vali Loss: 16.129 Vali Acc: 0.665 Test Loss: 16.129 Test Acc: 0.665
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5891504287719727
Epoch: 15, Steps: 17 | Train Loss: 0.721 Vali Loss: 13.493 Vali Acc: 0.676 Test Loss: 13.493 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.59330415725708
Epoch: 16, Steps: 17 | Train Loss: 0.544 Vali Loss: 12.649 Vali Acc: 0.723 Test Loss: 12.649 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.576838731765747
Epoch: 17, Steps: 17 | Train Loss: 0.912 Vali Loss: 10.143 Vali Acc: 0.786 Test Loss: 10.143 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5958452224731445
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 9.065 Vali Acc: 0.809 Test Loss: 9.065 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5836052894592285
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 19.964 Vali Acc: 0.746 Test Loss: 19.964 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 283387399
model size : 1082.93MB
2025-04-28 14:43:50.406542: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:43:50.425555: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851430.448106 1976688 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851430.455022 1976688 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:43:50.477684: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.658134698867798
Epoch: 1, Steps: 17 | Train Loss: 2.111 Vali Loss: 2.334 Vali Acc: 0.561 Test Loss: 2.334 Test Acc: 0.561
Validation loss decreased (inf --> -0.560670).  Saving model ...
Epoch: 2 cost time: 2.5234198570251465
Epoch: 2, Steps: 17 | Train Loss: 1.111 Vali Loss: 3.697 Vali Acc: 0.653 Test Loss: 3.697 Test Acc: 0.653
Validation loss decreased (-0.560670 --> -0.653142).  Saving model ...
Epoch: 3 cost time: 2.543778896331787
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 3.595 Vali Acc: 0.676 Test Loss: 3.595 Test Acc: 0.676
Validation loss decreased (-0.653142 --> -0.676265).  Saving model ...
Epoch: 4 cost time: 2.5899407863616943
Epoch: 4, Steps: 17 | Train Loss: 0.722 Vali Loss: 4.517 Vali Acc: 0.792 Test Loss: 4.517 Test Acc: 0.792
Validation loss decreased (-0.676265 --> -0.791862).  Saving model ...
Epoch: 5 cost time: 2.533031940460205
Epoch: 5, Steps: 17 | Train Loss: 0.528 Vali Loss: 8.032 Vali Acc: 0.705 Test Loss: 8.032 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5220038890838623
Epoch: 6, Steps: 17 | Train Loss: 2.885 Vali Loss: 8.172 Vali Acc: 0.763 Test Loss: 8.172 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5247950553894043
Epoch: 7, Steps: 17 | Train Loss: 1.192 Vali Loss: 7.683 Vali Acc: 0.694 Test Loss: 7.683 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.503361940383911
Epoch: 8, Steps: 17 | Train Loss: 0.333 Vali Loss: 8.360 Vali Acc: 0.734 Test Loss: 8.360 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.526083469390869
Epoch: 9, Steps: 17 | Train Loss: 0.317 Vali Loss: 9.958 Vali Acc: 0.728 Test Loss: 9.958 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.502133846282959
Epoch: 10, Steps: 17 | Train Loss: 0.250 Vali Loss: 7.153 Vali Acc: 0.763 Test Loss: 7.153 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5100979804992676
Epoch: 11, Steps: 17 | Train Loss: 0.025 Vali Loss: 5.723 Vali Acc: 0.809 Test Loss: 5.723 Test Acc: 0.809
Validation loss decreased (-0.791862 --> -0.809191).  Saving model ...
Epoch: 12 cost time: 2.5358359813690186
Epoch: 12, Steps: 17 | Train Loss: 0.269 Vali Loss: 10.825 Vali Acc: 0.705 Test Loss: 10.825 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.508694887161255
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 8.639 Vali Acc: 0.746 Test Loss: 8.639 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5342748165130615
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 9.181 Vali Acc: 0.728 Test Loss: 9.181 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.513519287109375
Epoch: 15, Steps: 17 | Train Loss: 0.203 Vali Loss: 8.463 Vali Acc: 0.723 Test Loss: 8.463 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.51064133644104
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 9.245 Vali Acc: 0.763 Test Loss: 9.245 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5157299041748047
Epoch: 17, Steps: 17 | Train Loss: 0.533 Vali Loss: 12.038 Vali Acc: 0.751 Test Loss: 12.038 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5045132637023926
Epoch: 18, Steps: 17 | Train Loss: 0.485 Vali Loss: 6.915 Vali Acc: 0.780 Test Loss: 6.915 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5200986862182617
Epoch: 19, Steps: 17 | Train Loss: 0.262 Vali Loss: 10.091 Vali Acc: 0.751 Test Loss: 10.091 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5139334201812744
Epoch: 20, Steps: 17 | Train Loss: 0.153 Vali Loss: 14.918 Vali Acc: 0.717 Test Loss: 14.918 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5043106079101562
Epoch: 21, Steps: 17 | Train Loss: 0.574 Vali Loss: 12.700 Vali Acc: 0.769 Test Loss: 12.700 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 279936903
model size : 1069.77MB
2025-04-28 14:45:57.325915: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:45:57.345181: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851557.368021 1986222 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851557.375076 1986222 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:45:57.398582: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6245570182800293
Epoch: 1, Steps: 17 | Train Loss: 2.028 Vali Loss: 1.378 Vali Acc: 0.676 Test Loss: 1.378 Test Acc: 0.676
Validation loss decreased (inf --> -0.676287).  Saving model ...
Epoch: 2 cost time: 2.6936755180358887
Epoch: 2, Steps: 17 | Train Loss: 0.637 Vali Loss: 1.692 Vali Acc: 0.775 Test Loss: 1.692 Test Acc: 0.775
Validation loss decreased (-0.676287 --> -0.774550).  Saving model ...
Epoch: 3 cost time: 2.679192066192627
Epoch: 3, Steps: 17 | Train Loss: 2.189 Vali Loss: 4.164 Vali Acc: 0.676 Test Loss: 4.164 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.675199508666992
Epoch: 4, Steps: 17 | Train Loss: 1.179 Vali Loss: 4.097 Vali Acc: 0.728 Test Loss: 4.097 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.654837131500244
Epoch: 5, Steps: 17 | Train Loss: 1.311 Vali Loss: 5.279 Vali Acc: 0.728 Test Loss: 5.279 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6536104679107666
Epoch: 6, Steps: 17 | Train Loss: 0.452 Vali Loss: 12.491 Vali Acc: 0.671 Test Loss: 12.491 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6665873527526855
Epoch: 7, Steps: 17 | Train Loss: 1.608 Vali Loss: 5.518 Vali Acc: 0.699 Test Loss: 5.518 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.668808937072754
Epoch: 8, Steps: 17 | Train Loss: 0.862 Vali Loss: 5.310 Vali Acc: 0.746 Test Loss: 5.310 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.653496503829956
Epoch: 9, Steps: 17 | Train Loss: 0.218 Vali Loss: 6.778 Vali Acc: 0.723 Test Loss: 6.778 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.659428358078003
Epoch: 10, Steps: 17 | Train Loss: 0.465 Vali Loss: 7.677 Vali Acc: 0.711 Test Loss: 7.677 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6432204246520996
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 6.404 Vali Acc: 0.815 Test Loss: 6.404 Test Acc: 0.815
Validation loss decreased (-0.774550 --> -0.814965).  Saving model ...
Epoch: 12 cost time: 2.6916730403900146
Epoch: 12, Steps: 17 | Train Loss: 0.107 Vali Loss: 6.014 Vali Acc: 0.838 Test Loss: 6.014 Test Acc: 0.838
Validation loss decreased (-0.814965 --> -0.838090).  Saving model ...
Epoch: 13 cost time: 2.671356201171875
Epoch: 13, Steps: 17 | Train Loss: 0.094 Vali Loss: 7.643 Vali Acc: 0.798 Test Loss: 7.643 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.683924436569214
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 10.876 Vali Acc: 0.757 Test Loss: 10.876 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.658263921737671
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 7.424 Vali Acc: 0.786 Test Loss: 7.424 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.665318489074707
Epoch: 16, Steps: 17 | Train Loss: 0.099 Vali Loss: 5.497 Vali Acc: 0.827 Test Loss: 5.497 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.68831205368042
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 6.825 Vali Acc: 0.809 Test Loss: 6.825 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.6509850025177
Epoch: 18, Steps: 17 | Train Loss: 0.134 Vali Loss: 4.400 Vali Acc: 0.821 Test Loss: 4.400 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.662902355194092
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 4.045 Vali Acc: 0.821 Test Loss: 4.045 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6597402095794678
Epoch: 20, Steps: 17 | Train Loss: 0.104 Vali Loss: 3.474 Vali Acc: 0.821 Test Loss: 3.474 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6479344367980957
Epoch: 21, Steps: 17 | Train Loss: 1.052 Vali Loss: 10.026 Vali Acc: 0.798 Test Loss: 10.026 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.6632437705993652
Epoch: 22, Steps: 17 | Train Loss: 0.630 Vali Loss: 4.049 Vali Acc: 0.815 Test Loss: 4.049 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 279074951
model size : 1066.48MB
2025-04-28 14:48:08.440735: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:48:08.460045: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851688.483369 1996201 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851688.490398 1996201 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:48:08.513643: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.09025764465332
Epoch: 1, Steps: 17 | Train Loss: 6.717 Vali Loss: 10.165 Vali Acc: 0.676 Test Loss: 10.165 Test Acc: 0.676
Validation loss decreased (inf --> -0.676199).  Saving model ...
Epoch: 2 cost time: 3.265211343765259
Epoch: 2, Steps: 17 | Train Loss: 5.421 Vali Loss: 20.701 Vali Acc: 0.538 Test Loss: 20.701 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9516537189483643
Epoch: 3, Steps: 17 | Train Loss: 3.385 Vali Loss: 20.650 Vali Acc: 0.532 Test Loss: 20.650 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.967940092086792
Epoch: 4, Steps: 17 | Train Loss: 6.604 Vali Loss: 24.903 Vali Acc: 0.647 Test Loss: 24.903 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.943263292312622
Epoch: 5, Steps: 17 | Train Loss: 2.992 Vali Loss: 17.469 Vali Acc: 0.751 Test Loss: 17.469 Test Acc: 0.751
Validation loss decreased (-0.676199 --> -0.751270).  Saving model ...
Epoch: 6 cost time: 3.735032320022583
Epoch: 6, Steps: 17 | Train Loss: 2.219 Vali Loss: 28.618 Vali Acc: 0.671 Test Loss: 28.618 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9358229637145996
Epoch: 7, Steps: 17 | Train Loss: 1.978 Vali Loss: 19.766 Vali Acc: 0.763 Test Loss: 19.766 Test Acc: 0.763
Validation loss decreased (-0.751270 --> -0.762808).  Saving model ...
Epoch: 8 cost time: 2.977429151535034
Epoch: 8, Steps: 17 | Train Loss: 0.859 Vali Loss: 21.217 Vali Acc: 0.699 Test Loss: 21.217 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.957923650741577
Epoch: 9, Steps: 17 | Train Loss: 2.616 Vali Loss: 32.627 Vali Acc: 0.734 Test Loss: 32.627 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9519453048706055
Epoch: 10, Steps: 17 | Train Loss: 1.453 Vali Loss: 14.310 Vali Acc: 0.786 Test Loss: 14.310 Test Acc: 0.786
Validation loss decreased (-0.762808 --> -0.785984).  Saving model ...
Epoch: 11 cost time: 2.9799346923828125
Epoch: 11, Steps: 17 | Train Loss: 0.518 Vali Loss: 16.382 Vali Acc: 0.769 Test Loss: 16.382 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9497663974761963
Epoch: 12, Steps: 17 | Train Loss: 0.512 Vali Loss: 25.952 Vali Acc: 0.757 Test Loss: 25.952 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.953784465789795
Epoch: 13, Steps: 17 | Train Loss: 1.875 Vali Loss: 24.970 Vali Acc: 0.751 Test Loss: 24.970 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9555485248565674
Epoch: 14, Steps: 17 | Train Loss: 1.088 Vali Loss: 18.396 Vali Acc: 0.757 Test Loss: 18.396 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.971794366836548
Epoch: 15, Steps: 17 | Train Loss: 0.865 Vali Loss: 20.140 Vali Acc: 0.728 Test Loss: 20.140 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.934143304824829
Epoch: 16, Steps: 17 | Train Loss: 0.457 Vali Loss: 32.357 Vali Acc: 0.717 Test Loss: 32.357 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9479825496673584
Epoch: 17, Steps: 17 | Train Loss: 0.904 Vali Loss: 20.708 Vali Acc: 0.734 Test Loss: 20.708 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.9709579944610596
Epoch: 18, Steps: 17 | Train Loss: 0.378 Vali Loss: 30.095 Vali Acc: 0.688 Test Loss: 30.095 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9503095149993896
Epoch: 19, Steps: 17 | Train Loss: 0.966 Vali Loss: 39.689 Vali Acc: 0.676 Test Loss: 39.689 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.963224411010742
Epoch: 20, Steps: 17 | Train Loss: 0.489 Vali Loss: 30.166 Vali Acc: 0.682 Test Loss: 30.166 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 159257671
model size : 608.47MB
2025-04-28 14:50:13.588944: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:50:13.607756: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851813.630540 2005310 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851813.637492 2005310 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:50:13.660388: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.445997714996338
Epoch: 1, Steps: 17 | Train Loss: 3.650 Vali Loss: 1.747 Vali Acc: 0.618 Test Loss: 1.747 Test Acc: 0.618
Validation loss decreased (inf --> -0.618480).  Saving model ...
Epoch: 2 cost time: 2.315741539001465
Epoch: 2, Steps: 17 | Train Loss: 1.711 Vali Loss: 3.533 Vali Acc: 0.728 Test Loss: 3.533 Test Acc: 0.728
Validation loss decreased (-0.618480 --> -0.728288).  Saving model ...
Epoch: 3 cost time: 2.302969455718994
Epoch: 3, Steps: 17 | Train Loss: 1.316 Vali Loss: 6.736 Vali Acc: 0.705 Test Loss: 6.736 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2986366748809814
Epoch: 4, Steps: 17 | Train Loss: 2.768 Vali Loss: 15.859 Vali Acc: 0.549 Test Loss: 15.859 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2578608989715576
Epoch: 5, Steps: 17 | Train Loss: 2.509 Vali Loss: 4.959 Vali Acc: 0.827 Test Loss: 4.959 Test Acc: 0.827
Validation loss decreased (-0.728288 --> -0.826540).  Saving model ...
Epoch: 6 cost time: 2.30417537689209
Epoch: 6, Steps: 17 | Train Loss: 1.577 Vali Loss: 10.305 Vali Acc: 0.757 Test Loss: 10.305 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2580645084381104
Epoch: 7, Steps: 17 | Train Loss: 4.671 Vali Loss: 17.929 Vali Acc: 0.694 Test Loss: 17.929 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.258287191390991
Epoch: 8, Steps: 17 | Train Loss: 0.769 Vali Loss: 10.807 Vali Acc: 0.705 Test Loss: 10.807 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2850403785705566
Epoch: 9, Steps: 17 | Train Loss: 0.277 Vali Loss: 13.798 Vali Acc: 0.711 Test Loss: 13.798 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.274888038635254
Epoch: 10, Steps: 17 | Train Loss: 0.411 Vali Loss: 12.299 Vali Acc: 0.699 Test Loss: 12.299 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.274629592895508
Epoch: 11, Steps: 17 | Train Loss: 0.536 Vali Loss: 13.002 Vali Acc: 0.746 Test Loss: 13.002 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2540030479431152
Epoch: 12, Steps: 17 | Train Loss: 0.240 Vali Loss: 20.711 Vali Acc: 0.676 Test Loss: 20.711 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.2822043895721436
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 6.436 Vali Acc: 0.786 Test Loss: 6.436 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2639238834381104
Epoch: 14, Steps: 17 | Train Loss: 0.166 Vali Loss: 11.432 Vali Acc: 0.711 Test Loss: 11.432 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.259735345840454
Epoch: 15, Steps: 17 | Train Loss: 0.349 Vali Loss: 14.505 Vali Acc: 0.717 Test Loss: 14.505 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 143726663
model size : 549.23MB
2025-04-28 14:51:33.851342: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:51:33.870352: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745851893.892630 2012133 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745851893.899523 2012133 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:51:33.922319: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.22165846824646
Epoch: 1, Steps: 17 | Train Loss: 2.482 Vali Loss: 2.029 Vali Acc: 0.595 Test Loss: 2.029 Test Acc: 0.595
Validation loss decreased (inf --> -0.595355).  Saving model ...
Epoch: 2 cost time: 1.9487268924713135
Epoch: 2, Steps: 17 | Train Loss: 1.204 Vali Loss: 7.557 Vali Acc: 0.538 Test Loss: 7.557 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9432690143585205
Epoch: 3, Steps: 17 | Train Loss: 4.228 Vali Loss: 11.976 Vali Acc: 0.642 Test Loss: 11.976 Test Acc: 0.642
Validation loss decreased (-0.595355 --> -0.641499).  Saving model ...
Epoch: 4 cost time: 1.96575927734375
Epoch: 4, Steps: 17 | Train Loss: 1.326 Vali Loss: 3.490 Vali Acc: 0.746 Test Loss: 3.490 Test Acc: 0.746
Validation loss decreased (-0.641499 --> -0.745630).  Saving model ...
Epoch: 5 cost time: 2.025318145751953
Epoch: 5, Steps: 17 | Train Loss: 0.917 Vali Loss: 7.219 Vali Acc: 0.682 Test Loss: 7.219 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9516701698303223
Epoch: 6, Steps: 17 | Train Loss: 1.921 Vali Loss: 6.677 Vali Acc: 0.757 Test Loss: 6.677 Test Acc: 0.757
Validation loss decreased (-0.745630 --> -0.757159).  Saving model ...
Epoch: 7 cost time: 1.9652104377746582
Epoch: 7, Steps: 17 | Train Loss: 1.077 Vali Loss: 13.197 Vali Acc: 0.682 Test Loss: 13.197 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9372541904449463
Epoch: 8, Steps: 17 | Train Loss: 0.390 Vali Loss: 9.971 Vali Acc: 0.694 Test Loss: 9.971 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9636507034301758
Epoch: 9, Steps: 17 | Train Loss: 0.476 Vali Loss: 8.433 Vali Acc: 0.723 Test Loss: 8.433 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.935490608215332
Epoch: 10, Steps: 17 | Train Loss: 0.169 Vali Loss: 6.549 Vali Acc: 0.746 Test Loss: 6.549 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.928858757019043
Epoch: 11, Steps: 17 | Train Loss: 0.273 Vali Loss: 9.178 Vali Acc: 0.763 Test Loss: 9.178 Test Acc: 0.763
Validation loss decreased (-0.757159 --> -0.762914).  Saving model ...
Epoch: 12 cost time: 1.9390993118286133
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 8.745 Vali Acc: 0.780 Test Loss: 8.745 Test Acc: 0.780
Validation loss decreased (-0.762914 --> -0.780259).  Saving model ...
Epoch: 13 cost time: 1.9728143215179443
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 7.819 Vali Acc: 0.751 Test Loss: 7.819 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9644155502319336
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 8.570 Vali Acc: 0.757 Test Loss: 8.570 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9400677680969238
Epoch: 15, Steps: 17 | Train Loss: 0.118 Vali Loss: 5.441 Vali Acc: 0.803 Test Loss: 5.441 Test Acc: 0.803
Validation loss decreased (-0.780259 --> -0.803414).  Saving model ...
Epoch: 16 cost time: 1.9806127548217773
Epoch: 16, Steps: 17 | Train Loss: 0.193 Vali Loss: 14.859 Vali Acc: 0.740 Test Loss: 14.859 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9452238082885742
Epoch: 17, Steps: 17 | Train Loss: 0.658 Vali Loss: 7.424 Vali Acc: 0.763 Test Loss: 7.424 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9381473064422607
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 8.549 Vali Acc: 0.751 Test Loss: 8.549 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9367811679840088
Epoch: 19, Steps: 17 | Train Loss: 0.175 Vali Loss: 7.679 Vali Acc: 0.751 Test Loss: 7.679 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9554588794708252
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 8.744 Vali Acc: 0.798 Test Loss: 8.744 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9355504512786865
Epoch: 21, Steps: 17 | Train Loss: 0.204 Vali Loss: 6.050 Vali Acc: 0.780 Test Loss: 6.050 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9434196949005127
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 5.724 Vali Acc: 0.775 Test Loss: 5.724 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9597210884094238
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 6.564 Vali Acc: 0.769 Test Loss: 6.564 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9619133472442627
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 10.464 Vali Acc: 0.780 Test Loss: 10.464 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.940929889678955
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 10.416 Vali Acc: 0.769 Test Loss: 10.416 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 138549767
model size : 529.48MB
2025-04-28 14:53:27.073322: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:53:27.093112: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852007.116458 2023292 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852007.123536 2023292 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:53:27.147302: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.189352512359619
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 0.922 Vali Acc: 0.688 Test Loss: 0.922 Test Acc: 0.688
Validation loss decreased (inf --> -0.687852).  Saving model ...
Epoch: 2 cost time: 1.9021215438842773
Epoch: 2, Steps: 17 | Train Loss: 0.959 Vali Loss: 3.370 Vali Acc: 0.642 Test Loss: 3.370 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9009013175964355
Epoch: 3, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.564 Vali Acc: 0.757 Test Loss: 2.564 Test Acc: 0.757
Validation loss decreased (-0.687852 --> -0.757200).  Saving model ...
Epoch: 4 cost time: 1.9314815998077393
Epoch: 4, Steps: 17 | Train Loss: 1.089 Vali Loss: 8.884 Vali Acc: 0.636 Test Loss: 8.884 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.909156322479248
Epoch: 5, Steps: 17 | Train Loss: 0.929 Vali Loss: 4.057 Vali Acc: 0.780 Test Loss: 4.057 Test Acc: 0.780
Validation loss decreased (-0.757200 --> -0.780306).  Saving model ...
Epoch: 6 cost time: 1.9361042976379395
Epoch: 6, Steps: 17 | Train Loss: 0.940 Vali Loss: 8.277 Vali Acc: 0.746 Test Loss: 8.277 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8960833549499512
Epoch: 7, Steps: 17 | Train Loss: 1.019 Vali Loss: 8.451 Vali Acc: 0.705 Test Loss: 8.451 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8847215175628662
Epoch: 8, Steps: 17 | Train Loss: 0.337 Vali Loss: 6.253 Vali Acc: 0.746 Test Loss: 6.253 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8923215866088867
Epoch: 9, Steps: 17 | Train Loss: 0.204 Vali Loss: 7.290 Vali Acc: 0.711 Test Loss: 7.290 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9071283340454102
Epoch: 10, Steps: 17 | Train Loss: 0.042 Vali Loss: 4.270 Vali Acc: 0.798 Test Loss: 4.270 Test Acc: 0.798
Validation loss decreased (-0.780306 --> -0.797645).  Saving model ...
Epoch: 11 cost time: 1.9206500053405762
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 6.290 Vali Acc: 0.734 Test Loss: 6.290 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8810772895812988
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 4.852 Vali Acc: 0.780 Test Loss: 4.852 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8784449100494385
Epoch: 13, Steps: 17 | Train Loss: 0.268 Vali Loss: 12.643 Vali Acc: 0.659 Test Loss: 12.643 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8989741802215576
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 7.104 Vali Acc: 0.717 Test Loss: 7.104 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9041612148284912
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 10.008 Vali Acc: 0.711 Test Loss: 10.008 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9064176082611084
Epoch: 16, Steps: 17 | Train Loss: 0.224 Vali Loss: 6.779 Vali Acc: 0.734 Test Loss: 6.779 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9024252891540527
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 10.038 Vali Acc: 0.659 Test Loss: 10.038 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8989784717559814
Epoch: 18, Steps: 17 | Train Loss: 0.095 Vali Loss: 11.385 Vali Acc: 0.699 Test Loss: 11.385 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9037675857543945
Epoch: 19, Steps: 17 | Train Loss: 0.338 Vali Loss: 12.283 Vali Acc: 0.728 Test Loss: 12.283 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8833544254302979
Epoch: 20, Steps: 17 | Train Loss: 0.164 Vali Loss: 9.064 Vali Acc: 0.786 Test Loss: 9.064 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 135961479
model size : 519.61MB
2025-04-28 14:54:58.130024: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:54:58.149010: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852098.171262 2032261 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852098.178196 2032261 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:54:58.200929: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1668174266815186
Epoch: 1, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.251 Vali Acc: 0.595 Test Loss: 1.251 Test Acc: 0.595
Validation loss decreased (inf --> -0.595363).  Saving model ...
Epoch: 2 cost time: 1.9002091884613037
Epoch: 2, Steps: 17 | Train Loss: 1.090 Vali Loss: 3.390 Vali Acc: 0.636 Test Loss: 3.390 Test Acc: 0.636
Validation loss decreased (-0.595363 --> -0.635804).  Saving model ...
Epoch: 3 cost time: 1.9072637557983398
Epoch: 3, Steps: 17 | Train Loss: 0.658 Vali Loss: 5.725 Vali Acc: 0.578 Test Loss: 5.725 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.90492582321167
Epoch: 4, Steps: 17 | Train Loss: 1.503 Vali Loss: 4.965 Vali Acc: 0.653 Test Loss: 4.965 Test Acc: 0.653
Validation loss decreased (-0.635804 --> -0.653130).  Saving model ...
Epoch: 5 cost time: 1.8969659805297852
Epoch: 5, Steps: 17 | Train Loss: 0.725 Vali Loss: 9.314 Vali Acc: 0.613 Test Loss: 9.314 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9661130905151367
Epoch: 6, Steps: 17 | Train Loss: 1.850 Vali Loss: 11.683 Vali Acc: 0.607 Test Loss: 11.683 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.894270896911621
Epoch: 7, Steps: 17 | Train Loss: 0.525 Vali Loss: 4.614 Vali Acc: 0.746 Test Loss: 4.614 Test Acc: 0.746
Validation loss decreased (-0.653130 --> -0.745619).  Saving model ...
Epoch: 8 cost time: 1.9247198104858398
Epoch: 8, Steps: 17 | Train Loss: 0.522 Vali Loss: 6.856 Vali Acc: 0.751 Test Loss: 6.856 Test Acc: 0.751
Validation loss decreased (-0.745619 --> -0.751377).  Saving model ...
Epoch: 9 cost time: 1.937427282333374
Epoch: 9, Steps: 17 | Train Loss: 0.455 Vali Loss: 6.833 Vali Acc: 0.763 Test Loss: 6.833 Test Acc: 0.763
Validation loss decreased (-0.751377 --> -0.762937).  Saving model ...
Epoch: 10 cost time: 1.9091758728027344
Epoch: 10, Steps: 17 | Train Loss: 0.172 Vali Loss: 6.987 Vali Acc: 0.728 Test Loss: 6.987 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.900742530822754
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 7.411 Vali Acc: 0.723 Test Loss: 7.411 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9247286319732666
Epoch: 12, Steps: 17 | Train Loss: 0.068 Vali Loss: 9.498 Vali Acc: 0.723 Test Loss: 9.498 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.917696237564087
Epoch: 13, Steps: 17 | Train Loss: 0.164 Vali Loss: 3.658 Vali Acc: 0.757 Test Loss: 3.658 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9008750915527344
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 4.537 Vali Acc: 0.780 Test Loss: 4.537 Test Acc: 0.780
Validation loss decreased (-0.762937 --> -0.780301).  Saving model ...
Epoch: 15 cost time: 1.92673659324646
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 5.335 Vali Acc: 0.746 Test Loss: 5.335 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9152464866638184
Epoch: 16, Steps: 17 | Train Loss: 0.110 Vali Loss: 7.260 Vali Acc: 0.694 Test Loss: 7.260 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9132137298583984
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.363 Vali Acc: 0.757 Test Loss: 4.363 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9159674644470215
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.223 Vali Acc: 0.740 Test Loss: 5.223 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9018528461456299
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.403 Vali Acc: 0.740 Test Loss: 5.403 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9391443729400635
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.507 Vali Acc: 0.740 Test Loss: 5.507 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9042277336120605
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.450 Vali Acc: 0.740 Test Loss: 5.450 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9129552841186523
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.581 Vali Acc: 0.734 Test Loss: 5.581 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8995122909545898
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.520 Vali Acc: 0.740 Test Loss: 5.520 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9071753025054932
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.372 Vali Acc: 0.751 Test Loss: 5.372 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7803468208092486
model parameter : 133804807
model size : 511.38MB
2025-04-28 14:56:47.960082: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:56:47.979613: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852208.003385 2042987 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852208.010522 2042987 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:56:48.034143: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.089238166809082
Epoch: 1, Steps: 17 | Train Loss: 1.612 Vali Loss: 0.690 Vali Acc: 0.723 Test Loss: 0.690 Test Acc: 0.723
Validation loss decreased (inf --> -0.722536).  Saving model ...
Epoch: 2 cost time: 1.8551344871520996
Epoch: 2, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.145 Vali Acc: 0.775 Test Loss: 1.145 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774555).  Saving model ...
Epoch: 3 cost time: 1.913710355758667
Epoch: 3, Steps: 17 | Train Loss: 0.331 Vali Loss: 3.917 Vali Acc: 0.613 Test Loss: 3.917 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.876556396484375
Epoch: 4, Steps: 17 | Train Loss: 0.989 Vali Loss: 3.527 Vali Acc: 0.647 Test Loss: 3.527 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8833343982696533
Epoch: 5, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.758 Vali Acc: 0.775 Test Loss: 1.758 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8903450965881348
Epoch: 6, Steps: 17 | Train Loss: 0.098 Vali Loss: 2.526 Vali Acc: 0.728 Test Loss: 2.526 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9153664112091064
Epoch: 7, Steps: 17 | Train Loss: 0.114 Vali Loss: 4.833 Vali Acc: 0.711 Test Loss: 4.833 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8607635498046875
Epoch: 8, Steps: 17 | Train Loss: 0.256 Vali Loss: 3.556 Vali Acc: 0.809 Test Loss: 3.556 Test Acc: 0.809
Validation loss decreased (-0.774555 --> -0.809213).  Saving model ...
Epoch: 9 cost time: 1.909855604171753
Epoch: 9, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.770 Vali Acc: 0.780 Test Loss: 3.770 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8936302661895752
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 5.297 Vali Acc: 0.775 Test Loss: 5.297 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8994324207305908
Epoch: 11, Steps: 17 | Train Loss: 0.718 Vali Loss: 4.805 Vali Acc: 0.775 Test Loss: 4.805 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8889358043670654
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 4.259 Vali Acc: 0.815 Test Loss: 4.259 Test Acc: 0.815
Validation loss decreased (-0.809213 --> -0.814986).  Saving model ...
Epoch: 13 cost time: 1.9252662658691406
Epoch: 13, Steps: 17 | Train Loss: 0.078 Vali Loss: 4.503 Vali Acc: 0.763 Test Loss: 4.503 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9164459705352783
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 5.188 Vali Acc: 0.786 Test Loss: 5.188 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8772101402282715
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.548 Vali Acc: 0.786 Test Loss: 3.548 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8512873649597168
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 7.864 Vali Acc: 0.734 Test Loss: 7.864 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8952898979187012
Epoch: 17, Steps: 17 | Train Loss: 0.111 Vali Loss: 5.999 Vali Acc: 0.803 Test Loss: 5.999 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8713126182556152
Epoch: 18, Steps: 17 | Train Loss: 0.395 Vali Loss: 6.006 Vali Acc: 0.717 Test Loss: 6.006 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8678126335144043
Epoch: 19, Steps: 17 | Train Loss: 0.528 Vali Loss: 9.949 Vali Acc: 0.653 Test Loss: 9.949 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8652231693267822
Epoch: 20, Steps: 17 | Train Loss: 0.631 Vali Loss: 3.236 Vali Acc: 0.832 Test Loss: 3.236 Test Acc: 0.832
Validation loss decreased (-0.814986 --> -0.832338).  Saving model ...
Epoch: 21 cost time: 1.892310619354248
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 5.863 Vali Acc: 0.775 Test Loss: 5.863 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.864060401916504
Epoch: 22, Steps: 17 | Train Loss: 0.375 Vali Loss: 7.398 Vali Acc: 0.769 Test Loss: 7.398 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8471953868865967
Epoch: 23, Steps: 17 | Train Loss: 0.196 Vali Loss: 5.277 Vali Acc: 0.803 Test Loss: 5.277 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8857064247131348
Epoch: 24, Steps: 17 | Train Loss: 0.270 Vali Loss: 8.770 Vali Acc: 0.723 Test Loss: 8.770 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8548791408538818
Epoch: 25, Steps: 17 | Train Loss: 0.534 Vali Loss: 6.808 Vali Acc: 0.798 Test Loss: 6.808 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8801312446594238
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 6.380 Vali Acc: 0.769 Test Loss: 6.380 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.874110460281372
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 3.182 Vali Acc: 0.832 Test Loss: 3.182 Test Acc: 0.832
Validation loss decreased (-0.832338 --> -0.832338).  Saving model ...
Epoch: 28 cost time: 1.873232364654541
Epoch: 28, Steps: 17 | Train Loss: 0.096 Vali Loss: 3.459 Vali Acc: 0.815 Test Loss: 3.459 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8940927982330322
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.000 Vali Acc: 0.803 Test Loss: 6.000 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8510339260101318
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 8.661 Vali Acc: 0.769 Test Loss: 8.661 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8551859855651855
Epoch: 31, Steps: 17 | Train Loss: 0.138 Vali Loss: 6.006 Vali Acc: 0.803 Test Loss: 6.006 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8633019924163818
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 3.914 Vali Acc: 0.821 Test Loss: 3.914 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8706917762756348
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 6.256 Vali Acc: 0.850 Test Loss: 6.256 Test Acc: 0.850
Validation loss decreased (-0.832338 --> -0.849648).  Saving model ...
Epoch: 34 cost time: 1.8957288265228271
Epoch: 34, Steps: 17 | Train Loss: 0.035 Vali Loss: 6.470 Vali Acc: 0.815 Test Loss: 6.470 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8819427490234375
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.752 Vali Acc: 0.809 Test Loss: 4.752 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.852294683456421
Epoch: 36, Steps: 17 | Train Loss: 0.025 Vali Loss: 3.922 Vali Acc: 0.803 Test Loss: 3.922 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.8785028457641602
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.609 Vali Acc: 0.815 Test Loss: 6.609 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8971285820007324
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 4.815 Vali Acc: 0.798 Test Loss: 4.815 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.888169288635254
Epoch: 39, Steps: 17 | Train Loss: 0.034 Vali Loss: 10.958 Vali Acc: 0.751 Test Loss: 10.958 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8807041645050049
Epoch: 40, Steps: 17 | Train Loss: 0.086 Vali Loss: 3.973 Vali Acc: 0.838 Test Loss: 3.973 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8680036067962646
Epoch: 41, Steps: 17 | Train Loss: 0.274 Vali Loss: 9.119 Vali Acc: 0.798 Test Loss: 9.119 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8599021434783936
Epoch: 42, Steps: 17 | Train Loss: 0.076 Vali Loss: 8.051 Vali Acc: 0.786 Test Loss: 8.051 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.8830771446228027
Epoch: 43, Steps: 17 | Train Loss: 0.012 Vali Loss: 10.898 Vali Acc: 0.757 Test Loss: 10.898 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 132079559
model size : 504.80MB
2025-04-28 14:59:43.538838: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 14:59:43.557834: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852383.580003 2061967 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852383.586817 2061967 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 14:59:43.609763: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.12858247756958
Epoch: 1, Steps: 17 | Train Loss: 2.044 Vali Loss: 1.113 Vali Acc: 0.549 Test Loss: 1.113 Test Acc: 0.549
Validation loss decreased (inf --> -0.549122).  Saving model ...
Epoch: 2 cost time: 1.815122127532959
Epoch: 2, Steps: 17 | Train Loss: 0.519 Vali Loss: 2.455 Vali Acc: 0.613 Test Loss: 2.455 Test Acc: 0.613
Validation loss decreased (-0.549122 --> -0.612692).  Saving model ...
Epoch: 3 cost time: 1.8160829544067383
Epoch: 3, Steps: 17 | Train Loss: 0.744 Vali Loss: 2.208 Vali Acc: 0.694 Test Loss: 2.208 Test Acc: 0.694
Validation loss decreased (-0.612692 --> -0.693620).  Saving model ...
Epoch: 4 cost time: 1.834343433380127
Epoch: 4, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.487 Vali Acc: 0.746 Test Loss: 1.487 Test Acc: 0.746
Validation loss decreased (-0.693620 --> -0.745650).  Saving model ...
Epoch: 5 cost time: 1.8375470638275146
Epoch: 5, Steps: 17 | Train Loss: 0.255 Vali Loss: 3.167 Vali Acc: 0.723 Test Loss: 3.167 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8231658935546875
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 3.051 Vali Acc: 0.728 Test Loss: 3.051 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8600988388061523
Epoch: 7, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.638 Vali Acc: 0.815 Test Loss: 2.638 Test Acc: 0.815
Validation loss decreased (-0.745650 --> -0.815003).  Saving model ...
Epoch: 8 cost time: 1.825648307800293
Epoch: 8, Steps: 17 | Train Loss: 0.281 Vali Loss: 5.536 Vali Acc: 0.682 Test Loss: 5.536 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8062055110931396
Epoch: 9, Steps: 17 | Train Loss: 0.656 Vali Loss: 4.969 Vali Acc: 0.694 Test Loss: 4.969 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8472330570220947
Epoch: 10, Steps: 17 | Train Loss: 0.363 Vali Loss: 4.506 Vali Acc: 0.746 Test Loss: 4.506 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8432202339172363
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 2.732 Vali Acc: 0.780 Test Loss: 2.732 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8362948894500732
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 3.356 Vali Acc: 0.792 Test Loss: 3.356 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8389229774475098
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 3.099 Vali Acc: 0.763 Test Loss: 3.099 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8501875400543213
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 5.612 Vali Acc: 0.751 Test Loss: 5.612 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7962641716003418
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 3.014 Vali Acc: 0.769 Test Loss: 3.014 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.818577766418457
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.279 Vali Acc: 0.815 Test Loss: 2.279 Test Acc: 0.815
Validation loss decreased (-0.815003 --> -0.815006).  Saving model ...
Epoch: 17 cost time: 1.8204925060272217
Epoch: 17, Steps: 17 | Train Loss: 0.140 Vali Loss: 6.308 Vali Acc: 0.786 Test Loss: 6.308 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8383705615997314
Epoch: 18, Steps: 17 | Train Loss: 0.151 Vali Loss: 4.288 Vali Acc: 0.786 Test Loss: 4.288 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8166635036468506
Epoch: 19, Steps: 17 | Train Loss: 0.156 Vali Loss: 3.909 Vali Acc: 0.792 Test Loss: 3.909 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8233859539031982
Epoch: 20, Steps: 17 | Train Loss: 0.036 Vali Loss: 3.193 Vali Acc: 0.809 Test Loss: 3.193 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8195440769195557
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.785 Vali Acc: 0.844 Test Loss: 2.785 Test Acc: 0.844
Validation loss decreased (-0.815006 --> -0.843903).  Saving model ...
Epoch: 22 cost time: 1.838071584701538
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 4.393 Vali Acc: 0.780 Test Loss: 4.393 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8223350048065186
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 2.900 Vali Acc: 0.780 Test Loss: 2.900 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.838292121887207
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 4.558 Vali Acc: 0.746 Test Loss: 4.558 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8252971172332764
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 3.491 Vali Acc: 0.815 Test Loss: 3.491 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8250880241394043
Epoch: 26, Steps: 17 | Train Loss: 0.050 Vali Loss: 4.166 Vali Acc: 0.769 Test Loss: 4.166 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8349924087524414
Epoch: 27, Steps: 17 | Train Loss: 0.128 Vali Loss: 6.297 Vali Acc: 0.775 Test Loss: 6.297 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8374567031860352
Epoch: 28, Steps: 17 | Train Loss: 0.218 Vali Loss: 6.069 Vali Acc: 0.786 Test Loss: 6.069 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8293864727020264
Epoch: 29, Steps: 17 | Train Loss: 0.087 Vali Loss: 11.358 Vali Acc: 0.705 Test Loss: 11.358 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8037843704223633
Epoch: 30, Steps: 17 | Train Loss: 0.652 Vali Loss: 9.329 Vali Acc: 0.711 Test Loss: 9.329 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8062703609466553
Epoch: 31, Steps: 17 | Train Loss: 0.065 Vali Loss: 6.062 Vali Acc: 0.786 Test Loss: 6.062 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 131648583
model size : 503.15MB
2025-04-28 15:01:52.679420: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 15:01:52.698665: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852512.721297 2075708 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852512.728346 2075708 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 15:01:52.751530: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.233781099319458
Epoch: 1, Steps: 17 | Train Loss: 3.732 Vali Loss: 2.526 Vali Acc: 0.624 Test Loss: 2.526 Test Acc: 0.624
Validation loss decreased (inf --> -0.624252).  Saving model ...
Epoch: 2 cost time: 1.9756736755371094
Epoch: 2, Steps: 17 | Train Loss: 1.870 Vali Loss: 6.272 Vali Acc: 0.665 Test Loss: 6.272 Test Acc: 0.665
Validation loss decreased (-0.624252 --> -0.664677).  Saving model ...
Epoch: 3 cost time: 1.9558868408203125
Epoch: 3, Steps: 17 | Train Loss: 4.405 Vali Loss: 14.488 Vali Acc: 0.520 Test Loss: 14.488 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9648802280426025
Epoch: 4, Steps: 17 | Train Loss: 2.314 Vali Loss: 9.190 Vali Acc: 0.653 Test Loss: 9.190 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9416799545288086
Epoch: 5, Steps: 17 | Train Loss: 0.816 Vali Loss: 7.618 Vali Acc: 0.740 Test Loss: 7.618 Test Acc: 0.740
Validation loss decreased (-0.664677 --> -0.739808).  Saving model ...
Epoch: 6 cost time: 1.9779741764068604
Epoch: 6, Steps: 17 | Train Loss: 1.811 Vali Loss: 8.410 Vali Acc: 0.769 Test Loss: 8.410 Test Acc: 0.769
Validation loss decreased (-0.739808 --> -0.768702).  Saving model ...
Epoch: 7 cost time: 1.9650778770446777
Epoch: 7, Steps: 17 | Train Loss: 0.388 Vali Loss: 8.147 Vali Acc: 0.763 Test Loss: 8.147 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.940373420715332
Epoch: 8, Steps: 17 | Train Loss: 0.411 Vali Loss: 9.987 Vali Acc: 0.751 Test Loss: 9.987 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9609286785125732
Epoch: 9, Steps: 17 | Train Loss: 1.089 Vali Loss: 17.906 Vali Acc: 0.665 Test Loss: 17.906 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9861466884613037
Epoch: 10, Steps: 17 | Train Loss: 2.372 Vali Loss: 6.993 Vali Acc: 0.746 Test Loss: 6.993 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9691290855407715
Epoch: 11, Steps: 17 | Train Loss: 0.210 Vali Loss: 5.608 Vali Acc: 0.769 Test Loss: 5.608 Test Acc: 0.769
Validation loss decreased (-0.768702 --> -0.768730).  Saving model ...
Epoch: 12 cost time: 1.9864215850830078
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 5.354 Vali Acc: 0.763 Test Loss: 5.354 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.990670919418335
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 9.652 Vali Acc: 0.705 Test Loss: 9.652 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9657669067382812
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 9.338 Vali Acc: 0.711 Test Loss: 9.338 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.958665370941162
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 16.862 Vali Acc: 0.665 Test Loss: 16.862 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9724466800689697
Epoch: 16, Steps: 17 | Train Loss: 0.639 Vali Loss: 13.837 Vali Acc: 0.636 Test Loss: 13.837 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9630367755889893
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 11.894 Vali Acc: 0.723 Test Loss: 11.894 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9729657173156738
Epoch: 18, Steps: 17 | Train Loss: 0.070 Vali Loss: 9.763 Vali Acc: 0.728 Test Loss: 9.763 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9772365093231201
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 9.520 Vali Acc: 0.694 Test Loss: 9.520 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9737277030944824
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 21.713 Vali Acc: 0.636 Test Loss: 21.713 Test Acc: 0.636
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9512743949890137
Epoch: 21, Steps: 17 | Train Loss: 0.254 Vali Loss: 10.939 Vali Acc: 0.665 Test Loss: 10.939 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7687861271676301
model parameter : 77656615
model size : 296.72MB
2025-04-28 15:03:30.481319: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 15:03:30.500485: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852610.523067 2085127 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852610.530107 2085127 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 15:03:30.552919: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9284658432006836
Epoch: 1, Steps: 17 | Train Loss: 2.100 Vali Loss: 2.088 Vali Acc: 0.647 Test Loss: 2.088 Test Acc: 0.647
Validation loss decreased (inf --> -0.647378).  Saving model ...
Epoch: 2 cost time: 1.6572847366333008
Epoch: 2, Steps: 17 | Train Loss: 2.127 Vali Loss: 4.048 Vali Acc: 0.590 Test Loss: 4.048 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6906416416168213
Epoch: 3, Steps: 17 | Train Loss: 4.088 Vali Loss: 9.434 Vali Acc: 0.607 Test Loss: 9.434 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6669042110443115
Epoch: 4, Steps: 17 | Train Loss: 2.217 Vali Loss: 5.954 Vali Acc: 0.705 Test Loss: 5.954 Test Acc: 0.705
Validation loss decreased (-0.647378 --> -0.705143).  Saving model ...
Epoch: 5 cost time: 1.6971220970153809
Epoch: 5, Steps: 17 | Train Loss: 0.546 Vali Loss: 3.568 Vali Acc: 0.792 Test Loss: 3.568 Test Acc: 0.792
Validation loss decreased (-0.705143 --> -0.791872).  Saving model ...
Epoch: 6 cost time: 1.6820900440216064
Epoch: 6, Steps: 17 | Train Loss: 0.669 Vali Loss: 6.586 Vali Acc: 0.746 Test Loss: 6.586 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6738612651824951
Epoch: 7, Steps: 17 | Train Loss: 1.094 Vali Loss: 8.337 Vali Acc: 0.688 Test Loss: 8.337 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6765646934509277
Epoch: 8, Steps: 17 | Train Loss: 0.338 Vali Loss: 11.661 Vali Acc: 0.694 Test Loss: 11.661 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6626081466674805
Epoch: 9, Steps: 17 | Train Loss: 0.204 Vali Loss: 3.796 Vali Acc: 0.821 Test Loss: 3.796 Test Acc: 0.821
Validation loss decreased (-0.791872 --> -0.820771).  Saving model ...
Epoch: 10 cost time: 1.6559765338897705
Epoch: 10, Steps: 17 | Train Loss: 0.131 Vali Loss: 4.276 Vali Acc: 0.723 Test Loss: 4.276 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6819415092468262
Epoch: 11, Steps: 17 | Train Loss: 0.076 Vali Loss: 5.510 Vali Acc: 0.717 Test Loss: 5.510 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6584973335266113
Epoch: 12, Steps: 17 | Train Loss: 0.052 Vali Loss: 3.651 Vali Acc: 0.763 Test Loss: 3.651 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.66096830368042
Epoch: 13, Steps: 17 | Train Loss: 0.002 Vali Loss: 4.097 Vali Acc: 0.763 Test Loss: 4.097 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.644639253616333
Epoch: 14, Steps: 17 | Train Loss: 0.011 Vali Loss: 7.231 Vali Acc: 0.740 Test Loss: 7.231 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6589038372039795
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 6.279 Vali Acc: 0.734 Test Loss: 6.279 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6538100242614746
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.625 Vali Acc: 0.734 Test Loss: 5.625 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6568012237548828
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.349 Vali Acc: 0.740 Test Loss: 5.349 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.642958402633667
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.325 Vali Acc: 0.740 Test Loss: 5.325 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.650022029876709
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.324 Vali Acc: 0.740 Test Loss: 5.324 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 69891111
model size : 267.10MB
2025-04-28 15:04:47.576818: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 15:04:47.596138: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852687.618565 2093622 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852687.625436 2093622 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 15:04:47.648420: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7914671897888184
Epoch: 1, Steps: 17 | Train Loss: 1.817 Vali Loss: 1.359 Vali Acc: 0.624 Test Loss: 1.359 Test Acc: 0.624
Validation loss decreased (inf --> -0.624264).  Saving model ...
Epoch: 2 cost time: 1.55802583694458
Epoch: 2, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.939 Vali Acc: 0.723 Test Loss: 0.939 Test Acc: 0.723
Validation loss decreased (-0.624264 --> -0.722534).  Saving model ...
Epoch: 3 cost time: 1.5669326782226562
Epoch: 3, Steps: 17 | Train Loss: 0.986 Vali Loss: 2.817 Vali Acc: 0.740 Test Loss: 2.817 Test Acc: 0.740
Validation loss decreased (-0.722534 --> -0.739856).  Saving model ...
Epoch: 4 cost time: 1.5434129238128662
Epoch: 4, Steps: 17 | Train Loss: 0.588 Vali Loss: 4.247 Vali Acc: 0.694 Test Loss: 4.247 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5480172634124756
Epoch: 5, Steps: 17 | Train Loss: 0.523 Vali Loss: 5.831 Vali Acc: 0.688 Test Loss: 5.831 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.554969310760498
Epoch: 6, Steps: 17 | Train Loss: 0.228 Vali Loss: 5.443 Vali Acc: 0.757 Test Loss: 5.443 Test Acc: 0.757
Validation loss decreased (-0.739856 --> -0.757171).  Saving model ...
Epoch: 7 cost time: 1.5826873779296875
Epoch: 7, Steps: 17 | Train Loss: 0.834 Vali Loss: 6.344 Vali Acc: 0.676 Test Loss: 6.344 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.564192771911621
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 6.785 Vali Acc: 0.717 Test Loss: 6.785 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5689871311187744
Epoch: 9, Steps: 17 | Train Loss: 0.290 Vali Loss: 1.737 Vali Acc: 0.809 Test Loss: 1.737 Test Acc: 0.809
Validation loss decreased (-0.757171 --> -0.809231).  Saving model ...
Epoch: 10 cost time: 1.9485652446746826
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 4.575 Vali Acc: 0.723 Test Loss: 4.575 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5446531772613525
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.394 Vali Acc: 0.786 Test Loss: 2.394 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.554306983947754
Epoch: 12, Steps: 17 | Train Loss: 0.077 Vali Loss: 5.229 Vali Acc: 0.671 Test Loss: 5.229 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5376050472259521
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 4.721 Vali Acc: 0.647 Test Loss: 4.721 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.547229290008545
Epoch: 14, Steps: 17 | Train Loss: 0.582 Vali Loss: 5.738 Vali Acc: 0.671 Test Loss: 5.738 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5375895500183105
Epoch: 15, Steps: 17 | Train Loss: 0.130 Vali Loss: 5.935 Vali Acc: 0.717 Test Loss: 5.935 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5422430038452148
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 4.387 Vali Acc: 0.757 Test Loss: 4.387 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5812444686889648
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.533 Vali Acc: 0.803 Test Loss: 2.533 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5514769554138184
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.432 Vali Acc: 0.809 Test Loss: 2.432 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5481300354003906
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.384 Vali Acc: 0.821 Test Loss: 2.384 Test Acc: 0.821
Validation loss decreased (-0.809231 --> -0.820785).  Saving model ...
Epoch: 20 cost time: 1.5467767715454102
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.821 Test Loss: 2.372 Test Acc: 0.821
Validation loss decreased (-0.820785 --> -0.820786).  Saving model ...
Epoch: 21 cost time: 1.553847074508667
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.370 Vali Acc: 0.821 Test Loss: 2.370 Test Acc: 0.821
Validation loss decreased (-0.820786 --> -0.820786).  Saving model ...
Epoch: 22 cost time: 1.568352222442627
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.358 Vali Acc: 0.821 Test Loss: 2.358 Test Acc: 0.821
Validation loss decreased (-0.820786 --> -0.820786).  Saving model ...
Epoch: 23 cost time: 2.2325243949890137
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.395 Vali Acc: 0.821 Test Loss: 2.395 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5648655891418457
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.356 Vali Acc: 0.821 Test Loss: 2.356 Test Acc: 0.821
Validation loss decreased (-0.820786 --> -0.820786).  Saving model ...
Epoch: 25 cost time: 1.5818698406219482
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.345 Vali Acc: 0.821 Test Loss: 2.345 Test Acc: 0.821
Validation loss decreased (-0.820786 --> -0.820786).  Saving model ...
Epoch: 26 cost time: 1.5621764659881592
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.388 Vali Acc: 0.821 Test Loss: 2.388 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5307297706604004
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.821 Test Loss: 2.367 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5999772548675537
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.389 Vali Acc: 0.821 Test Loss: 2.389 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5441207885742188
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.373 Vali Acc: 0.821 Test Loss: 2.373 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5728256702423096
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.378 Vali Acc: 0.821 Test Loss: 2.378 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5323870182037354
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.821 Test Loss: 2.372 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.599076271057129
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.387 Vali Acc: 0.821 Test Loss: 2.387 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5534889698028564
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.391 Vali Acc: 0.821 Test Loss: 2.391 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.579411506652832
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.372 Vali Acc: 0.821 Test Loss: 2.372 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5665433406829834
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.390 Vali Acc: 0.821 Test Loss: 2.390 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 67302663
model size : 257.22MB
2025-04-28 15:06:55.126091: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 15:06:55.144862: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852815.167244 2109039 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852815.174128 2109039 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 15:06:55.196975: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.842184066772461
Epoch: 1, Steps: 17 | Train Loss: 1.760 Vali Loss: 1.258 Vali Acc: 0.590 Test Loss: 1.258 Test Acc: 0.590
Validation loss decreased (inf --> -0.589583).  Saving model ...
Epoch: 2 cost time: 1.5378057956695557
Epoch: 2, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.388 Vali Acc: 0.711 Test Loss: 1.388 Test Acc: 0.711
Validation loss decreased (-0.589583 --> -0.710969).  Saving model ...
Epoch: 3 cost time: 1.5388877391815186
Epoch: 3, Steps: 17 | Train Loss: 0.402 Vali Loss: 2.951 Vali Acc: 0.705 Test Loss: 2.951 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.543358325958252
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 4.846 Vali Acc: 0.526 Test Loss: 4.846 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5281014442443848
Epoch: 5, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.926 Vali Acc: 0.699 Test Loss: 2.926 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5364305973052979
Epoch: 6, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.997 Vali Acc: 0.775 Test Loss: 1.997 Test Acc: 0.775
Validation loss decreased (-0.710969 --> -0.774547).  Saving model ...
Epoch: 7 cost time: 1.542327880859375
Epoch: 7, Steps: 17 | Train Loss: 0.114 Vali Loss: 3.283 Vali Acc: 0.705 Test Loss: 3.283 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5616376399993896
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 2.424 Vali Acc: 0.723 Test Loss: 2.424 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5311908721923828
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.082 Vali Acc: 0.763 Test Loss: 2.082 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5458927154541016
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 2.968 Vali Acc: 0.775 Test Loss: 2.968 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5492608547210693
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 3.344 Vali Acc: 0.746 Test Loss: 3.344 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5396695137023926
Epoch: 12, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.490 Vali Acc: 0.792 Test Loss: 1.490 Test Acc: 0.792
Validation loss decreased (-0.774547 --> -0.791893).  Saving model ...
Epoch: 13 cost time: 1.5466840267181396
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.238 Vali Acc: 0.746 Test Loss: 2.238 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5266187191009521
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 3.552 Vali Acc: 0.757 Test Loss: 3.552 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.531118631362915
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 5.547 Vali Acc: 0.671 Test Loss: 5.547 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5603220462799072
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 4.245 Vali Acc: 0.717 Test Loss: 4.245 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.54518723487854
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.109 Vali Acc: 0.769 Test Loss: 2.109 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5336802005767822
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.769 Test Loss: 2.206 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5275280475616455
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.698 Vali Acc: 0.728 Test Loss: 2.698 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5324747562408447
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.130 Vali Acc: 0.740 Test Loss: 3.130 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.554556131362915
Epoch: 21, Steps: 17 | Train Loss: 0.085 Vali Loss: 3.888 Vali Acc: 0.699 Test Loss: 3.888 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5294134616851807
Epoch: 22, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.461 Vali Acc: 0.803 Test Loss: 2.461 Test Acc: 0.803
Validation loss decreased (-0.791893 --> -0.803444).  Saving model ...
Epoch: 23 cost time: 1.5440361499786377
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.377 Vali Acc: 0.775 Test Loss: 2.377 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5470623970031738
Epoch: 24, Steps: 17 | Train Loss: 0.414 Vali Loss: 7.507 Vali Acc: 0.815 Test Loss: 7.507 Test Acc: 0.815
Validation loss decreased (-0.803444 --> -0.814954).  Saving model ...
Epoch: 25 cost time: 1.5464727878570557
Epoch: 25, Steps: 17 | Train Loss: 0.253 Vali Loss: 5.405 Vali Acc: 0.792 Test Loss: 5.405 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5320987701416016
Epoch: 26, Steps: 17 | Train Loss: 0.068 Vali Loss: 4.405 Vali Acc: 0.821 Test Loss: 4.405 Test Acc: 0.821
Validation loss decreased (-0.814954 --> -0.820765).  Saving model ...
Epoch: 27 cost time: 1.5113649368286133
Epoch: 27, Steps: 17 | Train Loss: 0.104 Vali Loss: 4.699 Vali Acc: 0.763 Test Loss: 4.699 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5073559284210205
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 6.255 Vali Acc: 0.705 Test Loss: 6.255 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5403826236724854
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 5.308 Vali Acc: 0.763 Test Loss: 5.308 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5072453022003174
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.175 Vali Acc: 0.740 Test Loss: 5.175 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5144457817077637
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.348 Vali Acc: 0.734 Test Loss: 5.348 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5043721199035645
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.332 Vali Acc: 0.734 Test Loss: 5.332 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5383155345916748
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.319 Vali Acc: 0.734 Test Loss: 5.319 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5294244289398193
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.349 Vali Acc: 0.734 Test Loss: 5.349 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5410337448120117
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.229 Vali Acc: 0.740 Test Loss: 5.229 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.527597427368164
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 5.188 Vali Acc: 0.740 Test Loss: 5.188 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 66008519
model size : 252.29MB
2025-04-28 15:08:59.838450: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 15:08:59.858041: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745852939.881547 2124864 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745852939.888497 2124864 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 15:08:59.911859: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7581822872161865
Epoch: 1, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.135 Vali Acc: 0.630 Test Loss: 1.135 Test Acc: 0.630
Validation loss decreased (inf --> -0.630046).  Saving model ...
Epoch: 2 cost time: 1.4980576038360596
Epoch: 2, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.422 Vali Acc: 0.821 Test Loss: 0.422 Test Acc: 0.821
Validation loss decreased (-0.630046 --> -0.820805).  Saving model ...
Epoch: 3 cost time: 1.5047309398651123
Epoch: 3, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.802 Vali Acc: 0.665 Test Loss: 1.802 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4867773056030273
Epoch: 4, Steps: 17 | Train Loss: 0.477 Vali Loss: 2.378 Vali Acc: 0.653 Test Loss: 2.378 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5142111778259277
Epoch: 5, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.123 Vali Acc: 0.798 Test Loss: 1.123 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.495887041091919
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 2.389 Vali Acc: 0.734 Test Loss: 2.389 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.495490312576294
Epoch: 7, Steps: 17 | Train Loss: 0.508 Vali Loss: 2.013 Vali Acc: 0.769 Test Loss: 2.013 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.481177568435669
Epoch: 8, Steps: 17 | Train Loss: 0.250 Vali Loss: 2.509 Vali Acc: 0.740 Test Loss: 2.509 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5158870220184326
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.301 Vali Acc: 0.844 Test Loss: 1.301 Test Acc: 0.844
Validation loss decreased (-0.820805 --> -0.843918).  Saving model ...
Epoch: 10 cost time: 1.5021693706512451
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.849 Vali Acc: 0.844 Test Loss: 1.849 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4941346645355225
Epoch: 11, Steps: 17 | Train Loss: 0.020 Vali Loss: 3.174 Vali Acc: 0.798 Test Loss: 3.174 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4866228103637695
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 3.704 Vali Acc: 0.746 Test Loss: 3.704 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5198752880096436
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 3.278 Vali Acc: 0.769 Test Loss: 3.278 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5160551071166992
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.827 Test Loss: 1.827 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5009031295776367
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 4.423 Vali Acc: 0.769 Test Loss: 4.423 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5065829753875732
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 3.264 Vali Acc: 0.780 Test Loss: 3.264 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5046367645263672
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 4.480 Vali Acc: 0.786 Test Loss: 4.480 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.532543420791626
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 3.060 Vali Acc: 0.809 Test Loss: 3.060 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5162734985351562
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 2.122 Vali Acc: 0.844 Test Loss: 2.122 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 64930183
model size : 248.17MB
2025-04-28 15:10:11.862341: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 15:10:11.881689: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745853011.904357 2133337 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745853011.911403 2133337 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 15:10:11.934677: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.656273365020752
Epoch: 1, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.017 Vali Acc: 0.659 Test Loss: 1.017 Test Acc: 0.659
Validation loss decreased (inf --> -0.658949).  Saving model ...
Epoch: 2 cost time: 1.5032930374145508
Epoch: 2, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.528 Vali Acc: 0.786 Test Loss: 0.528 Test Acc: 0.786
Validation loss decreased (-0.658949 --> -0.786122).  Saving model ...
Epoch: 3 cost time: 1.4869751930236816
Epoch: 3, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.767 Vali Acc: 0.803 Test Loss: 0.767 Test Acc: 0.803
Validation loss decreased (-0.786122 --> -0.803461).  Saving model ...
Epoch: 4 cost time: 1.4643843173980713
Epoch: 4, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.201 Vali Acc: 0.809 Test Loss: 1.201 Test Acc: 0.809
Validation loss decreased (-0.803461 --> -0.809237).  Saving model ...
Epoch: 5 cost time: 1.477569580078125
Epoch: 5, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.670 Vali Acc: 0.717 Test Loss: 1.670 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.506397008895874
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.338 Vali Acc: 0.832 Test Loss: 1.338 Test Acc: 0.832
Validation loss decreased (-0.809237 --> -0.832357).  Saving model ...
Epoch: 7 cost time: 1.467862844467163
Epoch: 7, Steps: 17 | Train Loss: 0.094 Vali Loss: 3.566 Vali Acc: 0.699 Test Loss: 3.566 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.458897590637207
Epoch: 8, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.135 Vali Acc: 0.780 Test Loss: 2.135 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.457099199295044
Epoch: 9, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.362 Vali Acc: 0.827 Test Loss: 1.362 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4904184341430664
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.741 Vali Acc: 0.775 Test Loss: 1.741 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4506924152374268
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 2.048 Vali Acc: 0.740 Test Loss: 2.048 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4967639446258545
Epoch: 12, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.654 Vali Acc: 0.855 Test Loss: 1.654 Test Acc: 0.855
Validation loss decreased (-0.832357 --> -0.855475).  Saving model ...
Epoch: 13 cost time: 1.477126121520996
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 2.356 Vali Acc: 0.775 Test Loss: 2.356 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5174007415771484
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 3.401 Vali Acc: 0.775 Test Loss: 3.401 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4934978485107422
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.694 Vali Acc: 0.792 Test Loss: 1.694 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.499786615371704
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 3.730 Vali Acc: 0.734 Test Loss: 3.730 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5097527503967285
Epoch: 17, Steps: 17 | Train Loss: 0.085 Vali Loss: 2.467 Vali Acc: 0.763 Test Loss: 2.467 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5190327167510986
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.263 Vali Acc: 0.786 Test Loss: 2.263 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4823188781738281
Epoch: 19, Steps: 17 | Train Loss: 0.147 Vali Loss: 5.309 Vali Acc: 0.688 Test Loss: 5.309 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4584333896636963
Epoch: 20, Steps: 17 | Train Loss: 0.348 Vali Loss: 4.336 Vali Acc: 0.665 Test Loss: 4.336 Test Acc: 0.665
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4520065784454346
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.646 Vali Acc: 0.803 Test Loss: 3.646 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.464881420135498
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 2.112 Vali Acc: 0.769 Test Loss: 2.112 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 64067559
model size : 244.88MB
2025-04-28 15:11:33.353029: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-28 15:11:33.372446: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745853093.395204 2143108 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745853093.402252 2143108 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-04-28 15:11:33.425475: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          ./dataset/PEMS-SF/  
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints       

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.691817045211792
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.053 Vali Acc: 0.578 Test Loss: 1.053 Test Acc: 0.578
Validation loss decreased (inf --> -0.578024).  Saving model ...
Epoch: 2 cost time: 1.4789886474609375
Epoch: 2, Steps: 17 | Train Loss: 0.344 Vali Loss: 1.055 Vali Acc: 0.676 Test Loss: 1.055 Test Acc: 0.676
Validation loss decreased (-0.578024 --> -0.676290).  Saving model ...
Epoch: 3 cost time: 1.4661169052124023
Epoch: 3, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.804 Vali Acc: 0.780 Test Loss: 0.804 Test Acc: 0.780
Validation loss decreased (-0.676290 --> -0.780339).  Saving model ...
Epoch: 4 cost time: 1.4856150150299072
Epoch: 4, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.922 Vali Acc: 0.832 Test Loss: 0.922 Test Acc: 0.832
Validation loss decreased (-0.780339 --> -0.832361).  Saving model ...
Epoch: 5 cost time: 1.4917645454406738
Epoch: 5, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.907 Vali Acc: 0.792 Test Loss: 0.907 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.510051965713501
Epoch: 6, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.124 Vali Acc: 0.780 Test Loss: 1.124 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4910192489624023
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.194 Vali Acc: 0.763 Test Loss: 1.194 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5058238506317139
Epoch: 8, Steps: 17 | Train Loss: 0.021 Vali Loss: 2.088 Vali Acc: 0.751 Test Loss: 2.088 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5518243312835693
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.059 Vali Acc: 0.775 Test Loss: 2.059 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.483780860900879
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.277 Vali Acc: 0.757 Test Loss: 1.277 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.512223482131958
Epoch: 11, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.366 Vali Acc: 0.786 Test Loss: 1.366 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.510054588317871
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 2.241 Vali Acc: 0.757 Test Loss: 2.241 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4802510738372803
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.458 Vali Acc: 0.798 Test Loss: 1.458 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4808919429779053
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.701 Vali Acc: 0.775 Test Loss: 1.701 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 63852071
model size : 244.06MB
