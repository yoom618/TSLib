Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6782867908477783
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.375 Vali Acc: 0.289 Test Loss: 1.375 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.8320531845092773
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.302 Vali Acc: 0.520 Test Loss: 1.302 Test Acc: 0.520
Validation loss decreased (-0.289460 --> -0.519724).  Saving model ...
Epoch: 3 cost time: 1.469783067703247
Epoch: 3, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.184 Vali Acc: 0.586 Test Loss: 1.184 Test Acc: 0.586
Validation loss decreased (-0.519724 --> -0.585514).  Saving model ...
Epoch: 4 cost time: 1.9589638710021973
Epoch: 4, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.032 Vali Acc: 0.638 Test Loss: 1.032 Test Acc: 0.638
Validation loss decreased (-0.585514 --> -0.638148).  Saving model ...
Epoch: 5 cost time: 1.5889770984649658
Epoch: 5, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.849 Vali Acc: 0.724 Test Loss: 0.849 Test Acc: 0.724
Validation loss decreased (-0.638148 --> -0.723676).  Saving model ...
Epoch: 6 cost time: 1.4198522567749023
Epoch: 6, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.697 Vali Acc: 0.750 Test Loss: 0.697 Test Acc: 0.750
Validation loss decreased (-0.723676 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.9559082984924316
Epoch: 7, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.3480687141418457
Epoch: 8, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 9 cost time: 1.883113145828247
Epoch: 9, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.505 Vali Acc: 0.770 Test Loss: 0.505 Test Acc: 0.770
Validation loss decreased (-0.749995 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 1.360412836074829
Epoch: 10, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.497 Vali Acc: 0.776 Test Loss: 0.497 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 1.5461211204528809
Epoch: 11, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8264119625091553
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8463149070739746
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.7962369918823242
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.616990089416504
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.6225812435150146
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.574 Vali Acc: 0.803 Test Loss: 0.574 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5883638858795166
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7862110137939453
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6065330505371094
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.283891201019287
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9610390663146973
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5214076042175293
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6434962749481201
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3733654022216797
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0158259868621826
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1185732
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6577839851379395
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.379 Vali Acc: 0.263 Test Loss: 1.379 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.2451558113098145
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.311 Vali Acc: 0.434 Test Loss: 1.311 Test Acc: 0.434
Validation loss decreased (-0.263144 --> -0.434197).  Saving model ...
Epoch: 3 cost time: 1.5370311737060547
Epoch: 3, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.199 Vali Acc: 0.579 Test Loss: 1.199 Test Acc: 0.579
Validation loss decreased (-0.434197 --> -0.578935).  Saving model ...
Epoch: 4 cost time: 1.4733905792236328
Epoch: 4, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.052 Vali Acc: 0.645 Test Loss: 1.052 Test Acc: 0.645
Validation loss decreased (-0.578935 --> -0.644726).  Saving model ...
Epoch: 5 cost time: 1.4991021156311035
Epoch: 5, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.896 Vali Acc: 0.658 Test Loss: 0.896 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.3597216606140137
Epoch: 6, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.749 Vali Acc: 0.684 Test Loss: 0.749 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.0833189487457275
Epoch: 7, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717099).  Saving model ...
Epoch: 8 cost time: 1.432291030883789
Epoch: 8, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
Validation loss decreased (-0.717099 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.4679555892944336
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.542 Vali Acc: 0.743 Test Loss: 0.542 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4403183460235596
Epoch: 10, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 11 cost time: 1.524817705154419
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.527 Vali Acc: 0.757 Test Loss: 0.527 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7544314861297607
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.531 Vali Acc: 0.770 Test Loss: 0.531 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769732).  Saving model ...
Epoch: 13 cost time: 1.3411741256713867
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.3168926239013672
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3675754070281982
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.4490184783935547
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.420419454574585
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2917089462280273
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4039838314056396
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.196324110031128
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4608418941497803
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1926891803741455
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.645 Vali Acc: 0.789 Test Loss: 0.645 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3985073566436768
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5118463039398193
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.789 Test Loss: 0.664 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3828763961791992
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.349327802658081
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1185764
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.540474891662598
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.386 Vali Acc: 0.243 Test Loss: 1.386 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.6048939228057861
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.340 Vali Acc: 0.355 Test Loss: 1.340 Test Acc: 0.355
Validation loss decreased (-0.243407 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.605600118637085
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.264 Vali Acc: 0.467 Test Loss: 1.264 Test Acc: 0.467
Validation loss decreased (-0.355250 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.8111445903778076
Epoch: 4, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.168 Vali Acc: 0.553 Test Loss: 1.168 Test Acc: 0.553
Validation loss decreased (-0.467093 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.3292715549468994
Epoch: 5, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.068 Vali Acc: 0.566 Test Loss: 1.068 Test Acc: 0.566
Validation loss decreased (-0.552620 --> -0.565779).  Saving model ...
Epoch: 6 cost time: 1.610611915588379
Epoch: 6, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.959 Vali Acc: 0.618 Test Loss: 0.959 Test Acc: 0.618
Validation loss decreased (-0.565779 --> -0.618411).  Saving model ...
Epoch: 7 cost time: 1.5486557483673096
Epoch: 7, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.851 Vali Acc: 0.691 Test Loss: 0.851 Test Acc: 0.691
Validation loss decreased (-0.618411 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 1.5831022262573242
Epoch: 8, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.5020289421081543
Epoch: 9, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.675 Vali Acc: 0.743 Test Loss: 0.675 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 10 cost time: 1.5770072937011719
Epoch: 10, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.8805220127105713
Epoch: 11, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.4771015644073486
Epoch: 12, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.6637966632843018
Epoch: 13, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.6679699420928955
Epoch: 14, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.636411190032959
Epoch: 15, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 16 cost time: 1.2842779159545898
Epoch: 16, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.481419324874878
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.3532066345214844
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.439767599105835
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6418895721435547
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8200876712799072
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5113282203674316
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4287829399108887
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6023027896881104
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.826636552810669
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1069440841674805
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6616065502166748
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1173508
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7344160079956055
Epoch: 1, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.363 Vali Acc: 0.289 Test Loss: 1.363 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.4244399070739746
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.321 Vali Acc: 0.434 Test Loss: 1.321 Test Acc: 0.434
Validation loss decreased (-0.289460 --> -0.434197).  Saving model ...
Epoch: 3 cost time: 1.7485055923461914
Epoch: 3, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.249 Vali Acc: 0.559 Test Loss: 1.249 Test Acc: 0.559
Validation loss decreased (-0.434197 --> -0.559198).  Saving model ...
Epoch: 4 cost time: 1.648772954940796
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.159 Vali Acc: 0.651 Test Loss: 1.159 Test Acc: 0.651
Validation loss decreased (-0.559198 --> -0.651304).  Saving model ...
Epoch: 5 cost time: 1.6169674396514893
Epoch: 5, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.062 Vali Acc: 0.671 Test Loss: 1.062 Test Acc: 0.671
Validation loss decreased (-0.651304 --> -0.671042).  Saving model ...
Epoch: 6 cost time: 1.4679372310638428
Epoch: 6, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.956 Vali Acc: 0.704 Test Loss: 0.956 Test Acc: 0.704
Validation loss decreased (-0.671042 --> -0.703938).  Saving model ...
Epoch: 7 cost time: 1.6738507747650146
Epoch: 7, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.858 Vali Acc: 0.724 Test Loss: 0.858 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723676).  Saving model ...
Epoch: 8 cost time: 1.8723571300506592
Epoch: 8, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.768 Vali Acc: 0.730 Test Loss: 0.768 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 9 cost time: 1.7575962543487549
Epoch: 9, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 1.614675521850586
Epoch: 10, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.8753867149353027
Epoch: 11, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8027989864349365
Epoch: 12, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.881561040878296
Epoch: 13, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776311).  Saving model ...
Epoch: 14 cost time: 2.1731650829315186
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7818875312805176
Epoch: 15, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 16 cost time: 1.8524858951568604
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.498 Vali Acc: 0.776 Test Loss: 0.498 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 2.0194997787475586
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.506 Vali Acc: 0.770 Test Loss: 0.506 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9792397022247314
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 1.585707426071167
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.057374954223633
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.152435302734375
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.528470039367676
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0634801387786865
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0179262161254883
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0439453125
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.1379568576812744
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8637444972991943
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9317905902862549
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1170500
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.644718647003174
Epoch: 1, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.360 Vali Acc: 0.283 Test Loss: 1.360 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.933429479598999
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.311 Vali Acc: 0.467 Test Loss: 1.311 Test Acc: 0.467
Validation loss decreased (-0.282881 --> -0.467092).  Saving model ...
Epoch: 3 cost time: 1.4669289588928223
Epoch: 3, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.239 Vali Acc: 0.572 Test Loss: 1.239 Test Acc: 0.572
Validation loss decreased (-0.467092 --> -0.572356).  Saving model ...
Epoch: 4 cost time: 1.3993754386901855
Epoch: 4, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.153 Vali Acc: 0.651 Test Loss: 1.153 Test Acc: 0.651
Validation loss decreased (-0.572356 --> -0.651304).  Saving model ...
Epoch: 5 cost time: 1.3763618469238281
Epoch: 5, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.060 Vali Acc: 0.691 Test Loss: 1.060 Test Acc: 0.691
Validation loss decreased (-0.651304 --> -0.690779).  Saving model ...
Epoch: 6 cost time: 1.6698787212371826
Epoch: 6, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.965 Vali Acc: 0.743 Test Loss: 0.965 Test Acc: 0.743
Validation loss decreased (-0.690779 --> -0.743411).  Saving model ...
Epoch: 7 cost time: 1.776054859161377
Epoch: 7, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.869 Vali Acc: 0.770 Test Loss: 0.869 Test Acc: 0.770
Validation loss decreased (-0.743411 --> -0.769728).  Saving model ...
Epoch: 8 cost time: 1.3854312896728516
Epoch: 8, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.781 Vali Acc: 0.796 Test Loss: 0.781 Test Acc: 0.796
Validation loss decreased (-0.769728 --> -0.796045).  Saving model ...
Epoch: 9 cost time: 1.5275654792785645
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.704 Vali Acc: 0.803 Test Loss: 0.704 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802625).  Saving model ...
Epoch: 10 cost time: 1.5976004600524902
Epoch: 10, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.642 Vali Acc: 0.757 Test Loss: 0.642 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5375003814697266
Epoch: 11, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.585587739944458
Epoch: 12, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.439521074295044
Epoch: 13, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.530 Vali Acc: 0.770 Test Loss: 0.530 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6313555240631104
Epoch: 14, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.760479211807251
Epoch: 15, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.502 Vali Acc: 0.763 Test Loss: 0.502 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.804079532623291
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.504 Vali Acc: 0.763 Test Loss: 0.504 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7719495296478271
Epoch: 17, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.502 Vali Acc: 0.763 Test Loss: 0.502 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6532750129699707
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.508 Vali Acc: 0.757 Test Loss: 0.508 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7375504970550537
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.516 Vali Acc: 0.763 Test Loss: 0.516 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1170532
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.687936782836914
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.389 Vali Acc: 0.283 Test Loss: 1.389 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 2.221679210662842
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.356 Vali Acc: 0.322 Test Loss: 1.356 Test Acc: 0.322
Validation loss decreased (-0.282881 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.7918846607208252
Epoch: 3, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.297 Vali Acc: 0.447 Test Loss: 1.297 Test Acc: 0.447
Validation loss decreased (-0.322355 --> -0.447355).  Saving model ...
Epoch: 4 cost time: 1.7039213180541992
Epoch: 4, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.226 Vali Acc: 0.592 Test Loss: 1.226 Test Acc: 0.592
Validation loss decreased (-0.447355 --> -0.592093).  Saving model ...
Epoch: 5 cost time: 1.544604778289795
Epoch: 5, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.151 Vali Acc: 0.632 Test Loss: 1.151 Test Acc: 0.632
Validation loss decreased (-0.592093 --> -0.631567).  Saving model ...
Epoch: 6 cost time: 1.7069509029388428
Epoch: 6, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.070 Vali Acc: 0.658 Test Loss: 1.070 Test Acc: 0.658
Validation loss decreased (-0.631567 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 1.568678379058838
Epoch: 7, Steps: 10 | Train Loss: 0.843 Vali Loss: 0.988 Vali Acc: 0.678 Test Loss: 0.988 Test Acc: 0.678
Validation loss decreased (-0.657884 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 1.568582534790039
Epoch: 8, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.899 Vali Acc: 0.711 Test Loss: 0.899 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710517).  Saving model ...
Epoch: 9 cost time: 1.7775566577911377
Epoch: 9, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.813 Vali Acc: 0.711 Test Loss: 0.813 Test Acc: 0.711
Validation loss decreased (-0.710517 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 1.6316256523132324
Epoch: 10, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
Validation loss decreased (-0.710518 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.7700998783111572
Epoch: 11, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.664 Vali Acc: 0.757 Test Loss: 0.664 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 1.563124656677246
Epoch: 12, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
Validation loss decreased (-0.756572 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.445051908493042
Epoch: 13, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4079220294952393
Epoch: 14, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.760143518447876
Epoch: 15, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.504 Vali Acc: 0.803 Test Loss: 0.504 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 1.4473726749420166
Epoch: 16, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 1.5609114170074463
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.602356195449829
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 1.3333022594451904
Epoch: 19, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7777845859527588
Epoch: 20, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.6381707191467285
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.529 Vali Acc: 0.816 Test Loss: 0.529 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8149678707122803
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.554 Vali Acc: 0.816 Test Loss: 0.554 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6562080383300781
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4942479133605957
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.591677188873291
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.605 Vali Acc: 0.816 Test Loss: 0.605 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4126818180084229
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.625 Vali Acc: 0.822 Test Loss: 0.625 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 27 cost time: 1.5662710666656494
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6025636196136475
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.671 Vali Acc: 0.809 Test Loss: 0.671 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6720707416534424
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.124614715576172
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.689 Vali Acc: 0.809 Test Loss: 0.689 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6030030250549316
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.698 Vali Acc: 0.816 Test Loss: 0.698 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.972982406616211
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.724 Vali Acc: 0.822 Test Loss: 0.724 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9313690662384033
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.822 Test Loss: 0.721 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.635284185409546
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4748561382293701
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.822 Test Loss: 0.779 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.765467882156372
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.822 Test Loss: 0.793 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1167524
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 6.0534141063690186
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.368 Vali Acc: 0.329 Test Loss: 1.368 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 2.0660645961761475
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.307 Vali Acc: 0.493 Test Loss: 1.307 Test Acc: 0.493
Validation loss decreased (-0.328934 --> -0.493408).  Saving model ...
Epoch: 3 cost time: 1.8692982196807861
Epoch: 3, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.200 Vali Acc: 0.513 Test Loss: 1.200 Test Acc: 0.513
Validation loss decreased (-0.493408 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 2.0266478061676025
Epoch: 4, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.060 Vali Acc: 0.605 Test Loss: 1.060 Test Acc: 0.605
Validation loss decreased (-0.513146 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.80961012840271
Epoch: 5, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.902 Vali Acc: 0.671 Test Loss: 0.902 Test Acc: 0.671
Validation loss decreased (-0.605253 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.956103801727295
Epoch: 6, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
Validation loss decreased (-0.671044 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.9308013916015625
Epoch: 7, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.6571416854858398
Epoch: 8, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.936232328414917
Epoch: 9, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.515873432159424
Epoch: 10, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 11 cost time: 2.0093414783477783
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 12 cost time: 2.1469428539276123
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.9175832271575928
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.620405912399292
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.995713472366333
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.157379627227783
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0824248790740967
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.294583559036255
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1707422733306885
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8627972602844238
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9695909023284912
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.789 Test Loss: 0.634 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7425282001495361
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.884963035583496
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.754624605178833
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1180356
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.646133184432983
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.361 Vali Acc: 0.316 Test Loss: 1.361 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 2.6440117359161377
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.294 Vali Acc: 0.454 Test Loss: 1.294 Test Acc: 0.454
Validation loss decreased (-0.315776 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.9411871433258057
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.172 Vali Acc: 0.572 Test Loss: 1.172 Test Acc: 0.572
Validation loss decreased (-0.453934 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 2.0130393505096436
Epoch: 4, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.024 Vali Acc: 0.625 Test Loss: 1.024 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 2.01959228515625
Epoch: 5, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.878 Vali Acc: 0.684 Test Loss: 0.878 Test Acc: 0.684
Validation loss decreased (-0.624990 --> -0.684202).  Saving model ...
Epoch: 6 cost time: 2.156032085418701
Epoch: 6, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.740 Vali Acc: 0.743 Test Loss: 0.740 Test Acc: 0.743
Validation loss decreased (-0.684202 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 2.016601800918579
Epoch: 7, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.631 Vali Acc: 0.763 Test Loss: 0.631 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 2.103778839111328
Epoch: 8, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 2.0226082801818848
Epoch: 9, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.8477118015289307
Epoch: 10, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.528 Vali Acc: 0.757 Test Loss: 0.528 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7468163967132568
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 12 cost time: 1.9597058296203613
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.924992322921753
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 2.005451202392578
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.821763038635254
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.00596284866333
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0050389766693115
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.849430799484253
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0707273483276367
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.598952293395996
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.604185104370117
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2948334217071533
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.249591112136841
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.047889232635498
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 25 cost time: 1.8299026489257812
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.669 Vali Acc: 0.803 Test Loss: 0.669 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1101927757263184
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 27 cost time: 2.0998499393463135
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0123517513275146
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.809 Test Loss: 0.698 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.057493209838867
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9367539882659912
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.0734450817108154
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.809 Test Loss: 0.714 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1221225261688232
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.171900749206543
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.0942459106445312
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.809 Test Loss: 0.725 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.1339526176452637
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.816 Test Loss: 0.740 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 36 cost time: 1.9581658840179443
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.749 Vali Acc: 0.816 Test Loss: 0.749 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8316564559936523
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.816 Test Loss: 0.754 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7119228839874268
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.809 Test Loss: 0.757 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.3577799797058105
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.816 Test Loss: 0.765 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.496671199798584
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.809 Test Loss: 0.770 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.886132001876831
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.809 Test Loss: 0.778 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.3440985679626465
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.809 Test Loss: 0.781 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.001523971557617
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.816 Test Loss: 0.778 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 2.4633395671844482
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.822 Test Loss: 0.784 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822361).  Saving model ...
Epoch: 45 cost time: 2.4969780445098877
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.926285982131958
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.236192226409912
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.809 Test Loss: 0.808 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8621177673339844
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.809 Test Loss: 0.809 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.9583535194396973
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.816 Test Loss: 0.817 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.0153684616088867
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.816 Test Loss: 0.821 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1180388
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.702130317687988
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.370 Vali Acc: 0.322 Test Loss: 1.370 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.935472011566162
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.323 Vali Acc: 0.414 Test Loss: 1.323 Test Acc: 0.414
Validation loss decreased (-0.322355 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 1.8526699542999268
Epoch: 3, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.244 Vali Acc: 0.526 Test Loss: 1.244 Test Acc: 0.526
Validation loss decreased (-0.414460 --> -0.526303).  Saving model ...
Epoch: 4 cost time: 1.9792439937591553
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.144 Vali Acc: 0.618 Test Loss: 1.144 Test Acc: 0.618
Validation loss decreased (-0.526303 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 1.9351930618286133
Epoch: 5, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.044 Vali Acc: 0.638 Test Loss: 1.044 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638147).  Saving model ...
Epoch: 6 cost time: 1.630915880203247
Epoch: 6, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.935 Vali Acc: 0.678 Test Loss: 0.935 Test Acc: 0.678
Validation loss decreased (-0.638147 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 1.8988804817199707
Epoch: 7, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.835 Vali Acc: 0.704 Test Loss: 0.835 Test Acc: 0.704
Validation loss decreased (-0.677622 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 1.6600837707519531
Epoch: 8, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.743 Vali Acc: 0.757 Test Loss: 0.743 Test Acc: 0.757
Validation loss decreased (-0.703939 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 1.6271862983703613
Epoch: 9, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
Validation loss decreased (-0.756572 --> -0.789467).  Saving model ...
Epoch: 10 cost time: 1.5889246463775635
Epoch: 10, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.861557960510254
Epoch: 11, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 2.085381269454956
Epoch: 12, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.6543233394622803
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.508 Vali Acc: 0.776 Test Loss: 0.508 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8095414638519287
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.495 Vali Acc: 0.809 Test Loss: 0.495 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809206).  Saving model ...
Epoch: 15 cost time: 2.187333822250366
Epoch: 15, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 16 cost time: 2.0000391006469727
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.842165231704712
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.503 Vali Acc: 0.809 Test Loss: 0.503 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.581953525543213
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8106019496917725
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.514 Vali Acc: 0.809 Test Loss: 0.514 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6979289054870605
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8277173042297363
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8347771167755127
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7443559169769287
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6967456340789795
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8672606945037842
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1168132
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.796288013458252
Epoch: 1, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.354 Vali Acc: 0.342 Test Loss: 1.354 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.9328396320343018
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.307 Vali Acc: 0.507 Test Loss: 1.307 Test Acc: 0.507
Validation loss decreased (-0.342092 --> -0.506566).  Saving model ...
Epoch: 3 cost time: 1.8114709854125977
Epoch: 3, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.230 Vali Acc: 0.645 Test Loss: 1.230 Test Acc: 0.645
Validation loss decreased (-0.506566 --> -0.644725).  Saving model ...
Epoch: 4 cost time: 1.6830461025238037
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.136 Vali Acc: 0.684 Test Loss: 1.136 Test Acc: 0.684
Validation loss decreased (-0.644725 --> -0.684199).  Saving model ...
Epoch: 5 cost time: 2.1915242671966553
Epoch: 5, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.028 Vali Acc: 0.724 Test Loss: 1.028 Test Acc: 0.724
Validation loss decreased (-0.684199 --> -0.723674).  Saving model ...
Epoch: 6 cost time: 1.8932464122772217
Epoch: 6, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
Validation loss decreased (-0.723674 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 1.9471068382263184
Epoch: 7, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.817 Vali Acc: 0.750 Test Loss: 0.817 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 8 cost time: 1.775848150253296
Epoch: 8, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.729 Vali Acc: 0.757 Test Loss: 0.729 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 1.823261022567749
Epoch: 9, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8286447525024414
Epoch: 10, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.9849321842193604
Epoch: 11, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.558 Vali Acc: 0.743 Test Loss: 0.558 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0330679416656494
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.526 Vali Acc: 0.730 Test Loss: 0.526 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7625105381011963
Epoch: 13, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.509 Vali Acc: 0.737 Test Loss: 0.509 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9766383171081543
Epoch: 14, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.497 Vali Acc: 0.770 Test Loss: 0.497 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769732).  Saving model ...
Epoch: 15 cost time: 1.5321934223175049
Epoch: 15, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.491 Vali Acc: 0.770 Test Loss: 0.491 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 16 cost time: 1.7050869464874268
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.494 Vali Acc: 0.770 Test Loss: 0.494 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7992973327636719
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.493 Vali Acc: 0.770 Test Loss: 0.493 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.100475549697876
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 19 cost time: 1.8391284942626953
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2858760356903076
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7411096096038818
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9256818294525146
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 2.2836387157440186
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9011893272399902
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.833570957183838
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8259079456329346
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.865931749343872
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7507679462432861
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9524767398834229
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.327213764190674
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.095355749130249
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.663 Vali Acc: 0.783 Test Loss: 0.663 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9301753044128418
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.669 Vali Acc: 0.770 Test Loss: 0.669 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1165124
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.08979606628418
Epoch: 1, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.367 Vali Acc: 0.382 Test Loss: 1.367 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 2.2669131755828857
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.323 Vali Acc: 0.447 Test Loss: 1.323 Test Acc: 0.447
Validation loss decreased (-0.381565 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 1.59220552444458
Epoch: 3, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.253 Vali Acc: 0.572 Test Loss: 1.253 Test Acc: 0.572
Validation loss decreased (-0.447355 --> -0.572356).  Saving model ...
Epoch: 4 cost time: 2.074218511581421
Epoch: 4, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.167 Vali Acc: 0.697 Test Loss: 1.167 Test Acc: 0.697
Validation loss decreased (-0.572356 --> -0.697357).  Saving model ...
Epoch: 5 cost time: 1.5650014877319336
Epoch: 5, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.075 Vali Acc: 0.730 Test Loss: 1.075 Test Acc: 0.730
Validation loss decreased (-0.697357 --> -0.730252).  Saving model ...
Epoch: 6 cost time: 1.5633773803710938
Epoch: 6, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.976 Vali Acc: 0.750 Test Loss: 0.976 Test Acc: 0.750
Validation loss decreased (-0.730252 --> -0.749990).  Saving model ...
Epoch: 7 cost time: 1.7289516925811768
Epoch: 7, Steps: 10 | Train Loss: 0.750 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 1.8275527954101562
Epoch: 8, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.789 Vali Acc: 0.783 Test Loss: 0.789 Test Acc: 0.783
Validation loss decreased (-0.749991 --> -0.782887).  Saving model ...
Epoch: 9 cost time: 1.9371588230133057
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.712 Vali Acc: 0.776 Test Loss: 0.712 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8757519721984863
Epoch: 10, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789467).  Saving model ...
Epoch: 11 cost time: 1.7783384323120117
Epoch: 11, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.933229684829712
Epoch: 12, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7052810192108154
Epoch: 13, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2334506511688232
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0096731185913086
Epoch: 15, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.89225172996521
Epoch: 16, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9558191299438477
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7512376308441162
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.001552104949951
Epoch: 19, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.223707437515259
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7599270343780518
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1165156
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.429525375366211
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.384 Vali Acc: 0.243 Test Loss: 1.384 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.179960250854492
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.355 Vali Acc: 0.296 Test Loss: 1.355 Test Acc: 0.296
Validation loss decreased (-0.243407 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.8489141464233398
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.302 Vali Acc: 0.447 Test Loss: 1.302 Test Acc: 0.447
Validation loss decreased (-0.296039 --> -0.447355).  Saving model ...
Epoch: 4 cost time: 1.8509221076965332
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.230 Vali Acc: 0.658 Test Loss: 1.230 Test Acc: 0.658
Validation loss decreased (-0.447355 --> -0.657882).  Saving model ...
Epoch: 5 cost time: 1.868297815322876
Epoch: 5, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.151 Vali Acc: 0.684 Test Loss: 1.151 Test Acc: 0.684
Validation loss decreased (-0.657882 --> -0.684199).  Saving model ...
Epoch: 6 cost time: 2.087444543838501
Epoch: 6, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.065 Vali Acc: 0.704 Test Loss: 1.065 Test Acc: 0.704
Validation loss decreased (-0.684199 --> -0.703937).  Saving model ...
Epoch: 7 cost time: 2.0321102142333984
Epoch: 7, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
Validation loss decreased (-0.703937 --> -0.717096).  Saving model ...
Epoch: 8 cost time: 1.8432419300079346
Epoch: 8, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.883 Vali Acc: 0.724 Test Loss: 0.883 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 9 cost time: 1.8151729106903076
Epoch: 9, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
Validation loss decreased (-0.723675 --> -0.749992).  Saving model ...
Epoch: 10 cost time: 2.1845428943634033
Epoch: 10, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.725 Vali Acc: 0.743 Test Loss: 0.725 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7765016555786133
Epoch: 11, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.8844127655029297
Epoch: 12, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 2.011868953704834
Epoch: 13, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.9980745315551758
Epoch: 14, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 15 cost time: 1.8015966415405273
Epoch: 15, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 16 cost time: 2.0213143825531006
Epoch: 16, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 1.5681688785552979
Epoch: 17, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.667431116104126
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7947759628295898
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1808974742889404
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 2.1790771484375
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7550973892211914
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0539307594299316
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9579434394836426
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4420113563537598
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.680 Vali Acc: 0.809 Test Loss: 0.680 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 26 cost time: 1.9229934215545654
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2457971572875977
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.715 Vali Acc: 0.803 Test Loss: 0.715 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1307883262634277
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9534337520599365
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9676551818847656
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.767 Vali Acc: 0.809 Test Loss: 0.767 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9001655578613281
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2870888710021973
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8990747928619385
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.814 Vali Acc: 0.809 Test Loss: 0.814 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8540878295898438
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.827 Vali Acc: 0.809 Test Loss: 0.827 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9544024467468262
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.828 Vali Acc: 0.809 Test Loss: 0.828 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1162148
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.421980142593384
Epoch: 1, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.320 Vali Acc: 0.368 Test Loss: 1.320 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 2.5070207118988037
Epoch: 2, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.054 Vali Acc: 0.605 Test Loss: 1.054 Test Acc: 0.605
Validation loss decreased (-0.368408 --> -0.605253).  Saving model ...
Epoch: 3 cost time: 2.675698757171631
Epoch: 3, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.605253 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 1.9643783569335938
Epoch: 4, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.717098 --> -0.776310).  Saving model ...
Epoch: 5 cost time: 1.9067494869232178
Epoch: 5, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8062970638275146
Epoch: 6, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 2.4493539333343506
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 2.438359022140503
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0978431701660156
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.675 Vali Acc: 0.809 Test Loss: 0.675 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 10 cost time: 2.471215009689331
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.809 Test Loss: 0.696 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1924118995666504
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0897457599639893
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3512802124023438
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.809 Test Loss: 0.731 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.233058214187622
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.803 Test Loss: 0.751 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.4796950817108154
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.240873098373413
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4049222469329834
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.809 Test Loss: 0.780 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0994527339935303
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.517951726913452
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.809 Test Loss: 0.812 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4275972
model size : 16.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.008833885192871
Epoch: 1, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.279 Vali Acc: 0.493 Test Loss: 1.279 Test Acc: 0.493
Validation loss decreased (inf --> -0.493408).  Saving model ...
Epoch: 2 cost time: 2.2715702056884766
Epoch: 2, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.022 Vali Acc: 0.658 Test Loss: 1.022 Test Acc: 0.658
Validation loss decreased (-0.493408 --> -0.657885).  Saving model ...
Epoch: 3 cost time: 2.039137840270996
Epoch: 3, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.771 Vali Acc: 0.664 Test Loss: 0.771 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664466).  Saving model ...
Epoch: 4 cost time: 2.0497992038726807
Epoch: 4, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.599 Vali Acc: 0.743 Test Loss: 0.599 Test Acc: 0.743
Validation loss decreased (-0.664466 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.707207202911377
Epoch: 5, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.7278940677642822
Epoch: 6, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 2.3619773387908936
Epoch: 7, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 2.3115506172180176
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 9 cost time: 2.2457220554351807
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.582324504852295
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.776 Test Loss: 0.682 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2946081161499023
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.776 Test Loss: 0.706 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.875622510910034
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3693387508392334
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.776 Test Loss: 0.735 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5392966270446777
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.776 Test Loss: 0.747 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3367395401000977
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.776 Test Loss: 0.751 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.117670774459839
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.776 Test Loss: 0.760 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1240155696868896
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0963616371154785
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.783 Test Loss: 0.789 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 4276100
model size : 16.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.166205644607544
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.328 Vali Acc: 0.368 Test Loss: 1.328 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.9143261909484863
Epoch: 2, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.158 Vali Acc: 0.553 Test Loss: 1.158 Test Acc: 0.553
Validation loss decreased (-0.368408 --> -0.552620).  Saving model ...
Epoch: 3 cost time: 1.9486911296844482
Epoch: 3, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.951 Vali Acc: 0.651 Test Loss: 0.951 Test Acc: 0.651
Validation loss decreased (-0.552620 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 1.5684363842010498
Epoch: 4, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.754 Vali Acc: 0.730 Test Loss: 0.754 Test Acc: 0.730
Validation loss decreased (-0.651306 --> -0.730256).  Saving model ...
Epoch: 5 cost time: 1.725848913192749
Epoch: 5, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.632 Vali Acc: 0.763 Test Loss: 0.632 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.8263134956359863
Epoch: 6, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.554 Vali Acc: 0.743 Test Loss: 0.554 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1243391036987305
Epoch: 7, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 8 cost time: 1.6196961402893066
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.769732 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 2.1131515502929688
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.769399642944336
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9938993453979492
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9236226081848145
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9034254550933838
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9561259746551514
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5652186870574951
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6669652462005615
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8644819259643555
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7193386554718018
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 4233220
model size : 16.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.3223466873168945
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.326 Vali Acc: 0.474 Test Loss: 1.326 Test Acc: 0.474
Validation loss decreased (inf --> -0.473671).  Saving model ...
Epoch: 2 cost time: 1.906175136566162
Epoch: 2, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.180 Vali Acc: 0.638 Test Loss: 1.180 Test Acc: 0.638
Validation loss decreased (-0.473671 --> -0.638146).  Saving model ...
Epoch: 3 cost time: 1.6985821723937988
Epoch: 3, Steps: 10 | Train Loss: 0.951 Vali Loss: 0.993 Vali Acc: 0.691 Test Loss: 0.993 Test Acc: 0.691
Validation loss decreased (-0.638146 --> -0.690780).  Saving model ...
Epoch: 4 cost time: 1.9309098720550537
Epoch: 4, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.814 Vali Acc: 0.711 Test Loss: 0.814 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.4908316135406494
Epoch: 5, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.675 Vali Acc: 0.730 Test Loss: 0.675 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 2.159536600112915
Epoch: 6, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.890043020248413
Epoch: 7, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.556 Vali Acc: 0.750 Test Loss: 0.556 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.797511100769043
Epoch: 8, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.5689902305603027
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9567325115203857
Epoch: 10, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.8549857139587402
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0656015872955322
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8039207458496094
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1462624073028564
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.8295714855194092
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7964558601379395
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9478106498718262
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9274888038635254
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5937232971191406
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.72731351852417
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.985781192779541
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.724 Vali Acc: 0.803 Test Loss: 0.724 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8820650577545166
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4739124774932861
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.737 Vali Acc: 0.789 Test Loss: 0.737 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7677218914031982
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 4215044
model size : 16.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.380330801010132
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.360 Vali Acc: 0.342 Test Loss: 1.360 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.9479522705078125
Epoch: 2, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.226 Vali Acc: 0.546 Test Loss: 1.226 Test Acc: 0.546
Validation loss decreased (-0.342092 --> -0.546040).  Saving model ...
Epoch: 3 cost time: 1.7739040851593018
Epoch: 3, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.054 Vali Acc: 0.651 Test Loss: 1.054 Test Acc: 0.651
Validation loss decreased (-0.546040 --> -0.651305).  Saving model ...
Epoch: 4 cost time: 1.8910722732543945
Epoch: 4, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.869 Vali Acc: 0.684 Test Loss: 0.869 Test Acc: 0.684
Validation loss decreased (-0.651305 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.7851381301879883
Epoch: 5, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.736 Vali Acc: 0.697 Test Loss: 0.736 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 6 cost time: 2.0463249683380127
Epoch: 6, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.653 Vali Acc: 0.730 Test Loss: 0.653 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 2.020617723464966
Epoch: 7, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.609 Vali Acc: 0.743 Test Loss: 0.609 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.8437235355377197
Epoch: 8, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.6834347248077393
Epoch: 9, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.640798807144165
Epoch: 10, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.846297025680542
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6652963161468506
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.7028801441192627
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.599 Vali Acc: 0.770 Test Loss: 0.599 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.161137580871582
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.739053726196289
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8766794204711914
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8467817306518555
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 18 cost time: 2.0585992336273193
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8103923797607422
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.01310133934021
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8793630599975586
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.776 Test Loss: 0.712 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.106231212615967
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.724 Vali Acc: 0.776 Test Loss: 0.724 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.978532075881958
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.212028741836548
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.010362148284912
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.747 Vali Acc: 0.789 Test Loss: 0.747 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.024521589279175
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7771403789520264
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 4215172
model size : 16.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.849970579147339
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.360 Vali Acc: 0.355 Test Loss: 1.360 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.7728960514068604
Epoch: 2, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.239 Vali Acc: 0.520 Test Loss: 1.239 Test Acc: 0.520
Validation loss decreased (-0.355250 --> -0.519724).  Saving model ...
Epoch: 3 cost time: 2.255131244659424
Epoch: 3, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.078 Vali Acc: 0.671 Test Loss: 1.078 Test Acc: 0.671
Validation loss decreased (-0.519724 --> -0.671042).  Saving model ...
Epoch: 4 cost time: 2.334043025970459
Epoch: 4, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.895 Vali Acc: 0.737 Test Loss: 0.895 Test Acc: 0.737
Validation loss decreased (-0.671042 --> -0.736833).  Saving model ...
Epoch: 5 cost time: 2.0960066318511963
Epoch: 5, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.748 Vali Acc: 0.763 Test Loss: 0.748 Test Acc: 0.763
Validation loss decreased (-0.736833 --> -0.763150).  Saving model ...
Epoch: 6 cost time: 1.944809913635254
Epoch: 6, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.104682207107544
Epoch: 7, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 2.057309627532959
Epoch: 8, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1193289756774902
Epoch: 9, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9966371059417725
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 1.784761667251587
Epoch: 11, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3650758266448975
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9564669132232666
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 2.1959917545318604
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.7913856506347656
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.8442997932434082
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.210216522216797
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.219862699508667
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.796 Test Loss: 0.635 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9489963054656982
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1444108486175537
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9920554161071777
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.678 Vali Acc: 0.796 Test Loss: 0.678 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.005556344985962
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.796 Test Loss: 0.688 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.170473337173462
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.789 Test Loss: 0.701 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.774174690246582
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.789 Test Loss: 0.712 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1273279190063477
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4209284
model size : 16.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.4073567390441895
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.367 Vali Acc: 0.309 Test Loss: 1.367 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 2.001570701599121
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.242 Vali Acc: 0.559 Test Loss: 1.242 Test Acc: 0.559
Validation loss decreased (-0.309197 --> -0.559198).  Saving model ...
Epoch: 3 cost time: 1.5592365264892578
Epoch: 3, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.058 Vali Acc: 0.645 Test Loss: 1.058 Test Acc: 0.645
Validation loss decreased (-0.559198 --> -0.644726).  Saving model ...
Epoch: 4 cost time: 1.6617701053619385
Epoch: 4, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.855 Vali Acc: 0.671 Test Loss: 0.855 Test Acc: 0.671
Validation loss decreased (-0.644726 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 1.4845929145812988
Epoch: 5, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.671044 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.6524579524993896
Epoch: 6, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.597 Vali Acc: 0.724 Test Loss: 0.597 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 7 cost time: 1.830686330795288
Epoch: 7, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
Validation loss decreased (-0.723678 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.858001947402954
Epoch: 8, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.535 Vali Acc: 0.743 Test Loss: 0.535 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8632230758666992
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.588813304901123
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.8535172939300537
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9280109405517578
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.746417760848999
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 14 cost time: 2.1717944145202637
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8888139724731445
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8095061779022217
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5925650596618652
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 18 cost time: 1.7551953792572021
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.346020460128784
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8895018100738525
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.694 Vali Acc: 0.789 Test Loss: 0.694 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9952807426452637
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.796 Test Loss: 0.700 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7503061294555664
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1504030227661133
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8510620594024658
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.803 Test Loss: 0.734 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9534363746643066
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.796 Test Loss: 0.753 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.010167360305786
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7424473762512207
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.809 Test Loss: 0.757 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 28 cost time: 1.7308387756347656
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.026806592941284
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.755 Vali Acc: 0.796 Test Loss: 0.755 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6319553852081299
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8650808334350586
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.842921495437622
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.816 Test Loss: 0.781 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815782).  Saving model ...
Epoch: 33 cost time: 1.732764720916748
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.816 Test Loss: 0.789 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8525638580322266
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.809 Test Loss: 0.797 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.0514891147613525
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.816 Test Loss: 0.801 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8500237464904785
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.809 Test Loss: 0.807 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.050558567047119
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.816 Test Loss: 0.813 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8738110065460205
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.816 Test Loss: 0.818 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.8519647121429443
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.809 Test Loss: 0.822 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.8023784160614014
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.816 Test Loss: 0.827 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.8560349941253662
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.809 Test Loss: 0.832 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.7645139694213867
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.803 Test Loss: 0.839 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1138564
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.205169200897217
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.6647815704345703
Epoch: 2, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.195 Vali Acc: 0.572 Test Loss: 1.195 Test Acc: 0.572
Validation loss decreased (-0.374987 --> -0.572356).  Saving model ...
Epoch: 3 cost time: 1.7899882793426514
Epoch: 3, Steps: 10 | Train Loss: 0.936 Vali Loss: 0.989 Vali Acc: 0.638 Test Loss: 0.989 Test Acc: 0.638
Validation loss decreased (-0.572356 --> -0.638148).  Saving model ...
Epoch: 4 cost time: 1.6004338264465332
Epoch: 4, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.794 Vali Acc: 0.730 Test Loss: 0.794 Test Acc: 0.730
Validation loss decreased (-0.638148 --> -0.730255).  Saving model ...
Epoch: 5 cost time: 2.0608885288238525
Epoch: 5, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.641 Vali Acc: 0.743 Test Loss: 0.641 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.5194222927093506
Epoch: 6, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.554 Vali Acc: 0.757 Test Loss: 0.554 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 2.032870292663574
Epoch: 7, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.522 Vali Acc: 0.757 Test Loss: 0.522 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 8 cost time: 2.147923469543457
Epoch: 8, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.519 Vali Acc: 0.757 Test Loss: 0.519 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 9 cost time: 2.1000125408172607
Epoch: 9, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.756574 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.8584706783294678
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.7593724727630615
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9307646751403809
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.085989236831665
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.7152633666992188
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9983196258544922
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9216318130493164
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.039813280105591
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0816195011138916
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6541016101837158
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.789 Test Loss: 0.666 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.621750831604004
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0193777084350586
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.157597780227661
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.796 Test Loss: 0.697 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9442613124847412
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1138628
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.118116140365601
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.351 Vali Acc: 0.296 Test Loss: 1.351 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 2.0377445220947266
Epoch: 2, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.259 Vali Acc: 0.513 Test Loss: 1.259 Test Acc: 0.513
Validation loss decreased (-0.296039 --> -0.513145).  Saving model ...
Epoch: 3 cost time: 1.9529192447662354
Epoch: 3, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.131 Vali Acc: 0.592 Test Loss: 1.131 Test Acc: 0.592
Validation loss decreased (-0.513145 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 1.7056279182434082
Epoch: 4, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.997 Vali Acc: 0.645 Test Loss: 0.997 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644727).  Saving model ...
Epoch: 5 cost time: 2.04529070854187
Epoch: 5, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.860 Vali Acc: 0.684 Test Loss: 0.860 Test Acc: 0.684
Validation loss decreased (-0.644727 --> -0.684202).  Saving model ...
Epoch: 6 cost time: 1.7906248569488525
Epoch: 6, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.745 Vali Acc: 0.711 Test Loss: 0.745 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 1.8847439289093018
Epoch: 7, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 8 cost time: 1.978715419769287
Epoch: 8, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.592 Vali Acc: 0.743 Test Loss: 0.592 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.7010064125061035
Epoch: 9, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743416).  Saving model ...
Epoch: 10 cost time: 1.8200008869171143
Epoch: 10, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.743416 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 2.0935821533203125
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.624525785446167
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.527 Vali Acc: 0.757 Test Loss: 0.527 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.604017734527588
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.541 Vali Acc: 0.763 Test Loss: 0.541 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8786437511444092
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6491835117340088
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.075364828109741
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.020374059677124
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.829143762588501
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.556994915008545
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.776 Test Loss: 0.616 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.516706943511963
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.627 Vali Acc: 0.770 Test Loss: 0.627 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.826878309249878
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.8652760982513428
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8673624992370605
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9002432823181152
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.915752649307251
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7338812351226807
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.783 Test Loss: 0.679 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6589107513427734
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.577113151550293
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.783 Test Loss: 0.679 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.75679349899292
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8156981468200684
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.894045114517212
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 1117188
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.549096345901489
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.349 Vali Acc: 0.362 Test Loss: 1.349 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 1.8480384349822998
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.272 Vali Acc: 0.454 Test Loss: 1.272 Test Acc: 0.454
Validation loss decreased (-0.361829 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.6054062843322754
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.161 Vali Acc: 0.572 Test Loss: 1.161 Test Acc: 0.572
Validation loss decreased (-0.453935 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 1.555800437927246
Epoch: 4, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.035 Vali Acc: 0.645 Test Loss: 1.035 Test Acc: 0.645
Validation loss decreased (-0.572357 --> -0.644726).  Saving model ...
Epoch: 5 cost time: 1.8913450241088867
Epoch: 5, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.905 Vali Acc: 0.678 Test Loss: 0.905 Test Acc: 0.678
Validation loss decreased (-0.644726 --> -0.677623).  Saving model ...
Epoch: 6 cost time: 1.4456970691680908
Epoch: 6, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.787 Vali Acc: 0.697 Test Loss: 0.787 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 1.3464598655700684
Epoch: 7, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.688 Vali Acc: 0.763 Test Loss: 0.688 Test Acc: 0.763
Validation loss decreased (-0.697361 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.8208575248718262
Epoch: 8, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.613 Vali Acc: 0.770 Test Loss: 0.613 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.6717331409454346
Epoch: 9, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8259286880493164
Epoch: 10, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.526 Vali Acc: 0.763 Test Loss: 0.526 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.709869146347046
Epoch: 11, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.508 Vali Acc: 0.763 Test Loss: 0.508 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7143149375915527
Epoch: 12, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.498 Vali Acc: 0.757 Test Loss: 0.498 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5904207229614258
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.7546412944793701
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.493 Vali Acc: 0.809 Test Loss: 0.493 Test Acc: 0.809
Validation loss decreased (-0.782890 --> -0.809206).  Saving model ...
Epoch: 15 cost time: 1.7995150089263916
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 16 cost time: 1.612222671508789
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.499 Vali Acc: 0.816 Test Loss: 0.499 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4583837985992432
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.511 Vali Acc: 0.816 Test Loss: 0.511 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6142725944519043
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5040736198425293
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6403894424438477
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.545 Vali Acc: 0.816 Test Loss: 0.545 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7659921646118164
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.796797513961792
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4799294471740723
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9313404560089111
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.583 Vali Acc: 0.816 Test Loss: 0.583 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.569467544555664
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1108100
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.432959794998169
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.372 Vali Acc: 0.296 Test Loss: 1.372 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.8120181560516357
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.304 Vali Acc: 0.454 Test Loss: 1.304 Test Acc: 0.454
Validation loss decreased (-0.296039 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.8432981967926025
Epoch: 3, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.205 Vali Acc: 0.599 Test Loss: 1.205 Test Acc: 0.599
Validation loss decreased (-0.453934 --> -0.598672).  Saving model ...
Epoch: 4 cost time: 1.6004118919372559
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.091 Vali Acc: 0.645 Test Loss: 1.091 Test Acc: 0.645
Validation loss decreased (-0.598672 --> -0.644726).  Saving model ...
Epoch: 5 cost time: 1.8025257587432861
Epoch: 5, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.972 Vali Acc: 0.717 Test Loss: 0.972 Test Acc: 0.717
Validation loss decreased (-0.644726 --> -0.717096).  Saving model ...
Epoch: 6 cost time: 1.910780906677246
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.857 Vali Acc: 0.704 Test Loss: 0.857 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8134796619415283
Epoch: 7, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.754 Vali Acc: 0.730 Test Loss: 0.754 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.8556654453277588
Epoch: 8, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.676 Vali Acc: 0.770 Test Loss: 0.676 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.6302266120910645
Epoch: 9, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.6528401374816895
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.8346731662750244
Epoch: 11, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.5483872890472412
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.9468693733215332
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6732139587402344
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8027684688568115
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8429477214813232
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9009525775909424
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8326759338378906
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8145053386688232
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.579 Vali Acc: 0.789 Test Loss: 0.579 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7138545513153076
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5338075160980225
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7329580783843994
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1108164
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.326416969299316
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.340 Vali Acc: 0.395 Test Loss: 1.340 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 1.9566221237182617
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.276 Vali Acc: 0.533 Test Loss: 1.276 Test Acc: 0.533
Validation loss decreased (-0.394723 --> -0.532882).  Saving model ...
Epoch: 3 cost time: 1.4999315738677979
Epoch: 3, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.193 Vali Acc: 0.612 Test Loss: 1.193 Test Acc: 0.612
Validation loss decreased (-0.532882 --> -0.611830).  Saving model ...
Epoch: 4 cost time: 1.5942020416259766
Epoch: 4, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.103 Vali Acc: 0.618 Test Loss: 1.103 Test Acc: 0.618
Validation loss decreased (-0.611830 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 1.589123249053955
Epoch: 5, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.003 Vali Acc: 0.651 Test Loss: 1.003 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.7460193634033203
Epoch: 6, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.909 Vali Acc: 0.678 Test Loss: 0.909 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 1.6641910076141357
Epoch: 7, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.815 Vali Acc: 0.697 Test Loss: 0.815 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 1.631990671157837
Epoch: 8, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.732 Vali Acc: 0.737 Test Loss: 0.732 Test Acc: 0.737
Validation loss decreased (-0.697360 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.659179925918579
Epoch: 9, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 1.8732049465179443
Epoch: 10, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
Validation loss decreased (-0.763151 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.7091317176818848
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.6439237594604492
Epoch: 12, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.9399797916412354
Epoch: 13, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.5231423377990723
Epoch: 14, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.12343692779541
Epoch: 15, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6694715023040771
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7151196002960205
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7632622718811035
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6234185695648193
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.713317632675171
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.103097438812256
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8393161296844482
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5994787216186523
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.598 Vali Acc: 0.803 Test Loss: 0.598 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1105220
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.581184148788452
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.381 Vali Acc: 0.342 Test Loss: 1.381 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 1.2958195209503174
Epoch: 2, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.310 Vali Acc: 0.414 Test Loss: 1.310 Test Acc: 0.414
Validation loss decreased (-0.342091 --> -0.414461).  Saving model ...
Epoch: 3 cost time: 1.3417234420776367
Epoch: 3, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.208 Vali Acc: 0.507 Test Loss: 1.208 Test Acc: 0.507
Validation loss decreased (-0.414461 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.5284862518310547
Epoch: 4, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.074 Vali Acc: 0.605 Test Loss: 1.074 Test Acc: 0.605
Validation loss decreased (-0.506567 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.4258408546447754
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.936 Vali Acc: 0.664 Test Loss: 0.936 Test Acc: 0.664
Validation loss decreased (-0.605252 --> -0.664464).  Saving model ...
Epoch: 6 cost time: 1.2857956886291504
Epoch: 6, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.802 Vali Acc: 0.684 Test Loss: 0.802 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.5253775119781494
Epoch: 7, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.684 Vali Acc: 0.743 Test Loss: 0.684 Test Acc: 0.743
Validation loss decreased (-0.684203 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.6726925373077393
Epoch: 8, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.603 Vali Acc: 0.743 Test Loss: 0.603 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.6239259243011475
Epoch: 9, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.565 Vali Acc: 0.743 Test Loss: 0.565 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 1.4018282890319824
Epoch: 10, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.3688254356384277
Epoch: 11, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.4691567420959473
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.6085150241851807
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7757246494293213
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.736800193786621
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.8733551502227783
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.60719633102417
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.8252503871917725
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2854862213134766
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5306756496429443
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7084949016571045
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4296910762786865
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4163260459899902
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4811336994171143
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3809735774993896
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.674 Vali Acc: 0.796 Test Loss: 0.674 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6197783946990967
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.678 Vali Acc: 0.796 Test Loss: 0.678 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.643165111541748
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 319428
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.226382732391357
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.364 Vali Acc: 0.336 Test Loss: 1.364 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.6307966709136963
Epoch: 2, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.292 Vali Acc: 0.474 Test Loss: 1.292 Test Acc: 0.474
Validation loss decreased (-0.335513 --> -0.473671).  Saving model ...
Epoch: 3 cost time: 1.4730701446533203
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.180 Vali Acc: 0.599 Test Loss: 1.180 Test Acc: 0.599
Validation loss decreased (-0.473671 --> -0.598672).  Saving model ...
Epoch: 4 cost time: 1.4009544849395752
Epoch: 4, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.053 Vali Acc: 0.658 Test Loss: 1.053 Test Acc: 0.658
Validation loss decreased (-0.598672 --> -0.657884).  Saving model ...
Epoch: 5 cost time: 1.8145968914031982
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.919 Vali Acc: 0.691 Test Loss: 0.919 Test Acc: 0.691
Validation loss decreased (-0.657884 --> -0.690780).  Saving model ...
Epoch: 6 cost time: 1.7046668529510498
Epoch: 6, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.792 Vali Acc: 0.711 Test Loss: 0.792 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.5051043033599854
Epoch: 7, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
Validation loss decreased (-0.710518 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.633371353149414
Epoch: 8, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.601 Vali Acc: 0.743 Test Loss: 0.601 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6007037162780762
Epoch: 9, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.547 Vali Acc: 0.757 Test Loss: 0.547 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.692403793334961
Epoch: 10, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.518 Vali Acc: 0.743 Test Loss: 0.518 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0566391944885254
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.500 Vali Acc: 0.743 Test Loss: 0.500 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.032822370529175
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.503 Vali Acc: 0.757 Test Loss: 0.503 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 13 cost time: 1.6682085990905762
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.508 Vali Acc: 0.757 Test Loss: 0.508 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6537060737609863
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.518 Vali Acc: 0.757 Test Loss: 0.518 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.54604172706604
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
Validation loss decreased (-0.756574 --> -0.782890).  Saving model ...
Epoch: 16 cost time: 1.5054452419281006
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9735090732574463
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3252184391021729
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6694798469543457
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.8332276344299316
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.58491849899292
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.857680320739746
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4486329555511475
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5946900844573975
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6826286315917969
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5563132762908936
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7854294776916504
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 28 cost time: 1.5675873756408691
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.640 Vali Acc: 0.776 Test Loss: 0.640 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.459765911102295
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.650 Vali Acc: 0.776 Test Loss: 0.650 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.719893217086792
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.401075839996338
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.621368408203125
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.6365814208984375
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4350202083587646
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.9018900394439697
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2265784740447998
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4137890338897705
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 319460
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.097055673599243
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.380 Vali Acc: 0.329 Test Loss: 1.380 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.0526154041290283
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.335 Vali Acc: 0.441 Test Loss: 1.335 Test Acc: 0.441
Validation loss decreased (-0.328934 --> -0.440776).  Saving model ...
Epoch: 3 cost time: 1.2866556644439697
Epoch: 3, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.268 Vali Acc: 0.546 Test Loss: 1.268 Test Acc: 0.546
Validation loss decreased (-0.440776 --> -0.546040).  Saving model ...
Epoch: 4 cost time: 1.4103071689605713
Epoch: 4, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.186 Vali Acc: 0.612 Test Loss: 1.186 Test Acc: 0.612
Validation loss decreased (-0.546040 --> -0.611830).  Saving model ...
Epoch: 5 cost time: 1.464402675628662
Epoch: 5, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.099 Vali Acc: 0.632 Test Loss: 1.099 Test Acc: 0.632
Validation loss decreased (-0.611830 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 1.5348765850067139
Epoch: 6, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.013 Vali Acc: 0.645 Test Loss: 1.013 Test Acc: 0.645
Validation loss decreased (-0.631568 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.5878088474273682
Epoch: 7, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.926 Vali Acc: 0.664 Test Loss: 0.926 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 1.5982260704040527
Epoch: 8, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.846 Vali Acc: 0.664 Test Loss: 0.846 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664465).  Saving model ...
Epoch: 9 cost time: 1.4483017921447754
Epoch: 9, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.764 Vali Acc: 0.704 Test Loss: 0.764 Test Acc: 0.704
Validation loss decreased (-0.664465 --> -0.703940).  Saving model ...
Epoch: 10 cost time: 1.7599842548370361
Epoch: 10, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.706 Vali Acc: 0.711 Test Loss: 0.706 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.5156543254852295
Epoch: 11, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.3944032192230225
Epoch: 12, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.4364674091339111
Epoch: 13, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4666013717651367
Epoch: 14, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.4725840091705322
Epoch: 15, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.528 Vali Acc: 0.770 Test Loss: 0.528 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 16 cost time: 1.566620111465454
Epoch: 16, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 1.5746028423309326
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 18 cost time: 1.4494175910949707
Epoch: 18, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 19 cost time: 1.4702613353729248
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.438178539276123
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2761499881744385
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4217965602874756
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.5208816528320312
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1510488986968994
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5708942413330078
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5680105686187744
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7968032360076904
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7674968242645264
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4732029438018799
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.637272596359253
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5665545463562012
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.599 Vali Acc: 0.796 Test Loss: 0.599 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 1.7403953075408936
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2314486503601074
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7015647888183594
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.665024757385254
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.6646971702575684
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.770 Test Loss: 0.643 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6001510620117188
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.789 Test Loss: 0.650 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5929179191589355
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.5291378498077393
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.70756196975708
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.4735381603240967
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 308740
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.055660247802734
Epoch: 1, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.323 Vali Acc: 0.434 Test Loss: 1.323 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.4327430725097656
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.282 Vali Acc: 0.533 Test Loss: 1.282 Test Acc: 0.533
Validation loss decreased (-0.434197 --> -0.532882).  Saving model ...
Epoch: 3 cost time: 1.5864195823669434
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.229 Vali Acc: 0.592 Test Loss: 1.229 Test Acc: 0.592
Validation loss decreased (-0.532882 --> -0.592093).  Saving model ...
Epoch: 4 cost time: 1.5812580585479736
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.163 Vali Acc: 0.618 Test Loss: 1.163 Test Acc: 0.618
Validation loss decreased (-0.592093 --> -0.618409).  Saving model ...
Epoch: 5 cost time: 1.5493407249450684
Epoch: 5, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.097 Vali Acc: 0.605 Test Loss: 1.097 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5541207790374756
Epoch: 6, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.020 Vali Acc: 0.638 Test Loss: 1.020 Test Acc: 0.638
Validation loss decreased (-0.618409 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.2963104248046875
Epoch: 7, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.950 Vali Acc: 0.691 Test Loss: 0.950 Test Acc: 0.691
Validation loss decreased (-0.638148 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 1.5477683544158936
Epoch: 8, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.878 Vali Acc: 0.684 Test Loss: 0.878 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7126450538635254
Epoch: 9, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.806 Vali Acc: 0.711 Test Loss: 0.806 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 1.6172516345977783
Epoch: 10, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.743 Vali Acc: 0.697 Test Loss: 0.743 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6596004962921143
Epoch: 11, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.683 Vali Acc: 0.730 Test Loss: 0.683 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 12 cost time: 1.5925519466400146
Epoch: 12, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.636 Vali Acc: 0.730 Test Loss: 0.636 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 13 cost time: 1.6410014629364014
Epoch: 13, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.572115421295166
Epoch: 14, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.572 Vali Acc: 0.743 Test Loss: 0.572 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3987269401550293
Epoch: 15, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.551 Vali Acc: 0.763 Test Loss: 0.551 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.542473316192627
Epoch: 16, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.534 Vali Acc: 0.763 Test Loss: 0.534 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 17 cost time: 1.5664377212524414
Epoch: 17, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.763153 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 1.3497669696807861
Epoch: 18, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 19 cost time: 1.3063130378723145
Epoch: 19, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 20 cost time: 1.5284945964813232
Epoch: 20, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 21 cost time: 1.3355107307434082
Epoch: 21, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.4887077808380127
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5196504592895508
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4541797637939453
Epoch: 24, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5073308944702148
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.540 Vali Acc: 0.809 Test Loss: 0.540 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 26 cost time: 1.4685335159301758
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3971164226531982
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2397007942199707
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.567 Vali Acc: 0.809 Test Loss: 0.567 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4349639415740967
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3336422443389893
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2788865566253662
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5903494358062744
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5392873287200928
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4155292510986328
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5550217628479004
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 304196
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3617072105407715
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.350 Vali Acc: 0.316 Test Loss: 1.350 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.8176748752593994
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.313 Vali Acc: 0.375 Test Loss: 1.313 Test Acc: 0.375
Validation loss decreased (-0.315776 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.477879285812378
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.261 Vali Acc: 0.487 Test Loss: 1.261 Test Acc: 0.487
Validation loss decreased (-0.374987 --> -0.486829).  Saving model ...
Epoch: 4 cost time: 1.8250906467437744
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.200 Vali Acc: 0.559 Test Loss: 1.200 Test Acc: 0.559
Validation loss decreased (-0.486829 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.5086894035339355
Epoch: 5, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.133 Vali Acc: 0.605 Test Loss: 1.133 Test Acc: 0.605
Validation loss decreased (-0.559199 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 1.7960081100463867
Epoch: 6, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.061 Vali Acc: 0.625 Test Loss: 1.061 Test Acc: 0.625
Validation loss decreased (-0.605252 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 1.5459647178649902
Epoch: 7, Steps: 10 | Train Loss: 0.904 Vali Loss: 0.984 Vali Acc: 0.671 Test Loss: 0.984 Test Acc: 0.671
Validation loss decreased (-0.624989 --> -0.671043).  Saving model ...
Epoch: 8 cost time: 1.5494050979614258
Epoch: 8, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.910 Vali Acc: 0.691 Test Loss: 0.910 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690780).  Saving model ...
Epoch: 9 cost time: 1.4995660781860352
Epoch: 9, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.837 Vali Acc: 0.704 Test Loss: 0.837 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 1.575934886932373
Epoch: 10, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.770 Vali Acc: 0.704 Test Loss: 0.770 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 1.5235185623168945
Epoch: 11, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 1.3947725296020508
Epoch: 12, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.665 Vali Acc: 0.730 Test Loss: 0.665 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 13 cost time: 1.5928888320922852
Epoch: 13, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 1.4858124256134033
Epoch: 14, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.5175566673278809
Epoch: 15, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.6433346271514893
Epoch: 16, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.5166029930114746
Epoch: 17, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6029586791992188
Epoch: 18, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.506 Vali Acc: 0.770 Test Loss: 0.506 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5073018074035645
Epoch: 19, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 20 cost time: 1.445310115814209
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 21 cost time: 1.5143201351165771
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.5444817543029785
Epoch: 22, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 23 cost time: 1.882981777191162
Epoch: 23, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5198168754577637
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4696848392486572
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.475616216659546
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6705224514007568
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4979701042175293
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3042688369750977
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 30 cost time: 1.4117813110351562
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 1.4812545776367188
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.377634048461914
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2954685688018799
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4571614265441895
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2362794876098633
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.385450839996338
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2297370433807373
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3637518882751465
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4366319179534912
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5420210361480713
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.675 Vali Acc: 0.816 Test Loss: 0.675 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 304228
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.224440574645996
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.402 Vali Acc: 0.191 Test Loss: 1.402 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 1.407837152481079
Epoch: 2, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.379 Vali Acc: 0.250 Test Loss: 1.379 Test Acc: 0.250
Validation loss decreased (-0.190775 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.5420987606048584
Epoch: 3, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.335 Vali Acc: 0.316 Test Loss: 1.335 Test Acc: 0.316
Validation loss decreased (-0.249986 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 1.5461416244506836
Epoch: 4, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.282 Vali Acc: 0.447 Test Loss: 1.282 Test Acc: 0.447
Validation loss decreased (-0.315776 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 1.4469349384307861
Epoch: 5, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.223 Vali Acc: 0.533 Test Loss: 1.223 Test Acc: 0.533
Validation loss decreased (-0.447356 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 1.626777172088623
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.160 Vali Acc: 0.553 Test Loss: 1.160 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 1.397423505783081
Epoch: 7, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.092 Vali Acc: 0.586 Test Loss: 1.092 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 1.3654348850250244
Epoch: 8, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.026 Vali Acc: 0.671 Test Loss: 1.026 Test Acc: 0.671
Validation loss decreased (-0.585515 --> -0.671042).  Saving model ...
Epoch: 9 cost time: 1.5148546695709229
Epoch: 9, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.959 Vali Acc: 0.691 Test Loss: 0.959 Test Acc: 0.691
Validation loss decreased (-0.671042 --> -0.690780).  Saving model ...
Epoch: 10 cost time: 1.341745138168335
Epoch: 10, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.887 Vali Acc: 0.711 Test Loss: 0.887 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710517).  Saving model ...
Epoch: 11 cost time: 1.0868308544158936
Epoch: 11, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.820 Vali Acc: 0.743 Test Loss: 0.820 Test Acc: 0.743
Validation loss decreased (-0.710517 --> -0.743413).  Saving model ...
Epoch: 12 cost time: 1.3708741664886475
Epoch: 12, Steps: 10 | Train Loss: 0.579 Vali Loss: 0.756 Vali Acc: 0.763 Test Loss: 0.756 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 13 cost time: 1.2752268314361572
Epoch: 13, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
Validation loss decreased (-0.763150 --> -0.802625).  Saving model ...
Epoch: 14 cost time: 1.582561731338501
Epoch: 14, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.562101125717163
Epoch: 15, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 1.3544178009033203
Epoch: 16, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4849541187286377
Epoch: 17, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4939873218536377
Epoch: 18, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.7048735618591309
Epoch: 19, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.5954251289367676
Epoch: 20, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5401649475097656
Epoch: 21, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5589590072631836
Epoch: 22, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.362816333770752
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4328820705413818
Epoch: 24, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6041779518127441
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6801035404205322
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.549576759338379
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3168578147888184
Epoch: 28, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2315144538879395
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 30 cost time: 1.3601617813110352
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 31 cost time: 1.854010820388794
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5867688655853271
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4787101745605469
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.607 Vali Acc: 0.836 Test Loss: 0.607 Test Acc: 0.836
Validation loss decreased (-0.822363 --> -0.835520).  Saving model ...
Epoch: 34 cost time: 1.45646071434021
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.842 Test Loss: 0.611 Test Acc: 0.842
Validation loss decreased (-0.835520 --> -0.842099).  Saving model ...
Epoch: 35 cost time: 1.3294038772583008
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4775362014770508
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.635 Vali Acc: 0.836 Test Loss: 0.635 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4412784576416016
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.836 Test Loss: 0.655 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7104406356811523
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.666 Vali Acc: 0.816 Test Loss: 0.666 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4871752262115479
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.673 Vali Acc: 0.822 Test Loss: 0.673 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4825108051300049
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.678 Vali Acc: 0.836 Test Loss: 0.678 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2869443893432617
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.699 Vali Acc: 0.822 Test Loss: 0.699 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.574418306350708
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.702 Vali Acc: 0.816 Test Loss: 0.702 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4439616203308105
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.716 Vali Acc: 0.816 Test Loss: 0.716 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.4697580337524414
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.836 Test Loss: 0.735 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 302756
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.878058433532715
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.326 Vali Acc: 0.414 Test Loss: 1.326 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 2.6524014472961426
Epoch: 2, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.047 Vali Acc: 0.678 Test Loss: 1.047 Test Acc: 0.678
Validation loss decreased (-0.414460 --> -0.677621).  Saving model ...
Epoch: 3 cost time: 2.3932580947875977
Epoch: 3, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
Validation loss decreased (-0.677621 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 2.5580828189849854
Epoch: 4, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
Validation loss decreased (-0.717098 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 2.3160340785980225
Epoch: 5, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 2.2293567657470703
Epoch: 6, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 2.078829288482666
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.178685426712036
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0211448669433594
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.128988265991211
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 11 cost time: 2.60123610496521
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2543094158172607
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1879045963287354
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2939419746398926
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.809 Test Loss: 0.724 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0539422035217285
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.803 Test Loss: 0.735 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8784830570220947
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.3815512657165527
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.809 Test Loss: 0.768 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2215723991394043
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.809 Test Loss: 0.776 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7898812294006348
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.816 Test Loss: 0.787 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 20 cost time: 2.1436450481414795
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.809 Test Loss: 0.788 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.144717216491699
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2488691806793213
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3215315341949463
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.803 Test Loss: 0.821 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1842126846313477
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.820 Vali Acc: 0.809 Test Loss: 0.820 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2198774814605713
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.809 Test Loss: 0.817 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3984780311584473
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.828 Vali Acc: 0.803 Test Loss: 0.828 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.6489338874816895
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.809 Test Loss: 0.830 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.4790220260620117
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.803 Test Loss: 0.845 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.247472047805786
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.809 Test Loss: 0.843 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 4266756
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.464346408843994
Epoch: 1, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.296 Vali Acc: 0.480 Test Loss: 1.296 Test Acc: 0.480
Validation loss decreased (inf --> -0.480250).  Saving model ...
Epoch: 2 cost time: 2.16693115234375
Epoch: 2, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.030 Vali Acc: 0.645 Test Loss: 1.030 Test Acc: 0.645
Validation loss decreased (-0.480250 --> -0.644727).  Saving model ...
Epoch: 3 cost time: 2.5656790733337402
Epoch: 3, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
Validation loss decreased (-0.644727 --> -0.710519).  Saving model ...
Epoch: 4 cost time: 2.5428032875061035
Epoch: 4, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.581 Vali Acc: 0.743 Test Loss: 0.581 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 2.3602654933929443
Epoch: 5, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763153).  Saving model ...
Epoch: 6 cost time: 2.466298818588257
Epoch: 6, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 2.4452805519104004
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 8 cost time: 2.369184732437134
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4439101219177246
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.549203872680664
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3595833778381348
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.213775396347046
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.803 Test Loss: 0.718 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6776340007781982
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.809 Test Loss: 0.725 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809203).  Saving model ...
Epoch: 14 cost time: 2.2041096687316895
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.235506296157837
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2479939460754395
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.809 Test Loss: 0.772 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4341917037963867
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.809 Test Loss: 0.778 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2871899604797363
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.028841733932495
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.803 Test Loss: 0.799 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1700260639190674
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.803 Test Loss: 0.803 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.468071222305298
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.803 Test Loss: 0.810 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.468280792236328
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.803 Test Loss: 0.818 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.4632885456085205
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.803 Test Loss: 0.830 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4266884
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.763010740280151
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.323 Vali Acc: 0.441 Test Loss: 1.323 Test Acc: 0.441
Validation loss decreased (inf --> -0.440776).  Saving model ...
Epoch: 2 cost time: 2.3596534729003906
Epoch: 2, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.150 Vali Acc: 0.586 Test Loss: 1.150 Test Acc: 0.586
Validation loss decreased (-0.440776 --> -0.585515).  Saving model ...
Epoch: 3 cost time: 2.098092794418335
Epoch: 3, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.945 Vali Acc: 0.645 Test Loss: 0.945 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644727).  Saving model ...
Epoch: 4 cost time: 2.1723010540008545
Epoch: 4, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.747 Vali Acc: 0.691 Test Loss: 0.747 Test Acc: 0.691
Validation loss decreased (-0.644727 --> -0.690782).  Saving model ...
Epoch: 5 cost time: 2.3444528579711914
Epoch: 5, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.616 Vali Acc: 0.743 Test Loss: 0.616 Test Acc: 0.743
Validation loss decreased (-0.690782 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 2.286787509918213
Epoch: 6, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.556 Vali Acc: 0.743 Test Loss: 0.556 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 2.0290634632110596
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.523 Vali Acc: 0.757 Test Loss: 0.523 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756574).  Saving model ...
Epoch: 8 cost time: 2.203669786453247
Epoch: 8, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.531 Vali Acc: 0.770 Test Loss: 0.531 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769732).  Saving model ...
Epoch: 9 cost time: 1.7757251262664795
Epoch: 9, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 2.145928382873535
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0825393199920654
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 2.1999106407165527
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.088840961456299
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2919139862060547
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4032139778137207
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.116878032684326
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.789 Test Loss: 0.643 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9867970943450928
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.312690496444702
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.0900702476501465
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.10207462310791
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.789 Test Loss: 0.694 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.988847255706787
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.796 Test Loss: 0.707 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 4224004
model size : 16.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9758822917938232
Epoch: 1, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.344 Vali Acc: 0.336 Test Loss: 1.344 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 2.1771509647369385
Epoch: 2, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.197 Vali Acc: 0.533 Test Loss: 1.197 Test Acc: 0.533
Validation loss decreased (-0.335513 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 1.9138643741607666
Epoch: 3, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.001 Vali Acc: 0.625 Test Loss: 1.001 Test Acc: 0.625
Validation loss decreased (-0.532883 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.9319934844970703
Epoch: 4, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.823 Vali Acc: 0.704 Test Loss: 0.823 Test Acc: 0.704
Validation loss decreased (-0.624990 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 2.144379138946533
Epoch: 5, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.676 Vali Acc: 0.737 Test Loss: 0.676 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 2.190690279006958
Epoch: 6, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
Validation loss decreased (-0.736835 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 2.078571081161499
Epoch: 7, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 2.2040092945098877
Epoch: 8, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.9737634658813477
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 2.1381428241729736
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 11 cost time: 1.928879737854004
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.553 Vali Acc: 0.803 Test Loss: 0.553 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9373152256011963
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.570 Vali Acc: 0.816 Test Loss: 0.570 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.999650001525879
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.585 Vali Acc: 0.816 Test Loss: 0.585 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.278707504272461
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.600 Vali Acc: 0.816 Test Loss: 0.600 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2915587425231934
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.822 Test Loss: 0.618 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1274728775024414
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.633 Vali Acc: 0.816 Test Loss: 0.633 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5502564907073975
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.646 Vali Acc: 0.822 Test Loss: 0.646 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0206003189086914
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.816 Test Loss: 0.649 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.05026912689209
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.816 Test Loss: 0.660 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.051642894744873
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.822 Test Loss: 0.676 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 4205828
model size : 16.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9353177547454834
Epoch: 1, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.305 Vali Acc: 0.474 Test Loss: 1.305 Test Acc: 0.474
Validation loss decreased (inf --> -0.473671).  Saving model ...
Epoch: 2 cost time: 1.7824366092681885
Epoch: 2, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.168 Vali Acc: 0.625 Test Loss: 1.168 Test Acc: 0.625
Validation loss decreased (-0.473671 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 1.74287748336792
Epoch: 3, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.6998379230499268
Epoch: 4, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.841 Vali Acc: 0.691 Test Loss: 0.841 Test Acc: 0.691
Validation loss decreased (-0.624990 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.6856689453125
Epoch: 5, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.5582842826843262
Epoch: 6, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.633 Vali Acc: 0.730 Test Loss: 0.633 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 1.79197096824646
Epoch: 7, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.5117287635803223
Epoch: 8, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.567 Vali Acc: 0.750 Test Loss: 0.567 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.56374192237854
Epoch: 9, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.6949236392974854
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.4382359981536865
Epoch: 11, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 2.0198750495910645
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6770873069763184
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.610 Vali Acc: 0.783 Test Loss: 0.610 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5537645816802979
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7977492809295654
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 16 cost time: 1.688659429550171
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5696280002593994
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.666 Vali Acc: 0.789 Test Loss: 0.666 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.907543659210205
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8784053325653076
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6667616367340088
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9004082679748535
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.724 Vali Acc: 0.789 Test Loss: 0.724 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9441843032836914
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.541811466217041
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.743 Vali Acc: 0.796 Test Loss: 0.743 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 24 cost time: 1.8934409618377686
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5157439708709717
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.796 Test Loss: 0.763 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.943760633468628
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.770 Vali Acc: 0.796 Test Loss: 0.770 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.909921407699585
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.796 Test Loss: 0.777 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.818695068359375
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.796 Test Loss: 0.789 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7247099876403809
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.796 Test Loss: 0.800 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9498236179351807
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.796 Test Loss: 0.805 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.0594072341918945
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.814 Vali Acc: 0.796 Test Loss: 0.814 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7840642929077148
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.796 Test Loss: 0.830 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.752854585647583
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.833 Vali Acc: 0.796 Test Loss: 0.833 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 4205956
model size : 16.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.268097162246704
Epoch: 1, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.312 Vali Acc: 0.487 Test Loss: 1.312 Test Acc: 0.487
Validation loss decreased (inf --> -0.486829).  Saving model ...
Epoch: 2 cost time: 1.8097500801086426
Epoch: 2, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.183 Vali Acc: 0.605 Test Loss: 1.183 Test Acc: 0.605
Validation loss decreased (-0.486829 --> -0.605251).  Saving model ...
Epoch: 3 cost time: 1.9216539859771729
Epoch: 3, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.016 Vali Acc: 0.704 Test Loss: 1.016 Test Acc: 0.704
Validation loss decreased (-0.605251 --> -0.703937).  Saving model ...
Epoch: 4 cost time: 2.078511953353882
Epoch: 4, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.865 Vali Acc: 0.697 Test Loss: 0.865 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9980881214141846
Epoch: 5, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
Validation loss decreased (-0.703937 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.7465901374816895
Epoch: 6, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.629 Vali Acc: 0.776 Test Loss: 0.629 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.5885310173034668
Epoch: 7, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.98734450340271
Epoch: 8, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8592259883880615
Epoch: 9, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.541 Vali Acc: 0.757 Test Loss: 0.541 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8316960334777832
Epoch: 10, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8632426261901855
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9030487537384033
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.7222058773040771
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.87837815284729
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.138234853744507
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8428289890289307
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 17 cost time: 1.9268717765808105
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 1.8456060886383057
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0025763511657715
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.654 Vali Acc: 0.796 Test Loss: 0.654 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9757626056671143
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.102684736251831
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.809 Test Loss: 0.689 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.121397018432617
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.700 Vali Acc: 0.809 Test Loss: 0.700 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9853127002716064
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.809 Test Loss: 0.717 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9256017208099365
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.0132999420166016
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.734 Vali Acc: 0.803 Test Loss: 0.734 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9185607433319092
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6264569759368896
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.803 Test Loss: 0.756 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4200068
model size : 16.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.893904447555542
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.350 Vali Acc: 0.316 Test Loss: 1.350 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.6252856254577637
Epoch: 2, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.217 Vali Acc: 0.553 Test Loss: 1.217 Test Acc: 0.553
Validation loss decreased (-0.315776 --> -0.552619).  Saving model ...
Epoch: 3 cost time: 1.8771238327026367
Epoch: 3, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.030 Vali Acc: 0.625 Test Loss: 1.030 Test Acc: 0.625
Validation loss decreased (-0.552619 --> -0.624990).  Saving model ...
Epoch: 4 cost time: 1.6755273342132568
Epoch: 4, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.820 Vali Acc: 0.697 Test Loss: 0.820 Test Acc: 0.697
Validation loss decreased (-0.624990 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 1.6349270343780518
Epoch: 5, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.663 Vali Acc: 0.724 Test Loss: 0.663 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723678).  Saving model ...
Epoch: 6 cost time: 1.7044172286987305
Epoch: 6, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.7356719970703125
Epoch: 7, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.5939209461212158
Epoch: 8, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.8133440017700195
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.025890350341797
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815784).  Saving model ...
Epoch: 11 cost time: 1.6459548473358154
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.575 Vali Acc: 0.816 Test Loss: 0.575 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.845921277999878
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7989537715911865
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5826027393341064
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.617 Vali Acc: 0.809 Test Loss: 0.617 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6871016025543213
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4815330505371094
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5537285804748535
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.486405849456787
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.816 Test Loss: 0.665 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.433091640472412
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.227550745010376
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1133956
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.898425817489624
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.321 Vali Acc: 0.395 Test Loss: 1.321 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 1.8368968963623047
Epoch: 2, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.178 Vali Acc: 0.592 Test Loss: 1.178 Test Acc: 0.592
Validation loss decreased (-0.394724 --> -0.592093).  Saving model ...
Epoch: 3 cost time: 1.5884079933166504
Epoch: 3, Steps: 10 | Train Loss: 0.898 Vali Loss: 0.985 Vali Acc: 0.645 Test Loss: 0.985 Test Acc: 0.645
Validation loss decreased (-0.592093 --> -0.644727).  Saving model ...
Epoch: 4 cost time: 1.618582010269165
Epoch: 4, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.798 Vali Acc: 0.697 Test Loss: 0.798 Test Acc: 0.697
Validation loss decreased (-0.644727 --> -0.697360).  Saving model ...
Epoch: 5 cost time: 1.6372363567352295
Epoch: 5, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.667 Vali Acc: 0.724 Test Loss: 0.667 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723678).  Saving model ...
Epoch: 6 cost time: 1.5634746551513672
Epoch: 6, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.842200756072998
Epoch: 7, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.6345555782318115
Epoch: 8, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2876906394958496
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.3913235664367676
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3970682621002197
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5250566005706787
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3012654781341553
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.639 Vali Acc: 0.770 Test Loss: 0.639 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.680809736251831
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.654 Vali Acc: 0.776 Test Loss: 0.654 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5233955383300781
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.663 Vali Acc: 0.770 Test Loss: 0.663 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7961037158966064
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.673 Vali Acc: 0.776 Test Loss: 0.673 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5397982597351074
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.686 Vali Acc: 0.776 Test Loss: 0.686 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8038277626037598
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 19 cost time: 1.6944365501403809
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.776 Test Loss: 0.712 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5846984386444092
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5421504974365234
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4121482372283936
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3727638721466064
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6332237720489502
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.776 Test Loss: 0.753 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6361496448516846
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.789 Test Loss: 0.758 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 26 cost time: 1.46075439453125
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.783 Test Loss: 0.768 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3526344299316406
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.776 Test Loss: 0.774 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5129992961883545
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.776 Test Loss: 0.774 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.561537504196167
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.783 Test Loss: 0.793 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7397913932800293
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.783 Test Loss: 0.809 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5358519554138184
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.776 Test Loss: 0.814 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.807011604309082
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.776 Test Loss: 0.831 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4900805950164795
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.783 Test Loss: 0.829 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8207674026489258
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.789 Test Loss: 0.836 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1862354278564453
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.789 Test Loss: 0.846 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1134020
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.173138856887817
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.347 Vali Acc: 0.349 Test Loss: 1.347 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.402599811553955
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.250 Vali Acc: 0.513 Test Loss: 1.250 Test Acc: 0.513
Validation loss decreased (-0.348671 --> -0.513145).  Saving model ...
Epoch: 3 cost time: 1.3335490226745605
Epoch: 3, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.126 Vali Acc: 0.586 Test Loss: 1.126 Test Acc: 0.586
Validation loss decreased (-0.513145 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.4678518772125244
Epoch: 4, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.990 Vali Acc: 0.664 Test Loss: 0.990 Test Acc: 0.664
Validation loss decreased (-0.585515 --> -0.664464).  Saving model ...
Epoch: 5 cost time: 1.4164268970489502
Epoch: 5, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.850 Vali Acc: 0.697 Test Loss: 0.850 Test Acc: 0.697
Validation loss decreased (-0.664464 --> -0.697360).  Saving model ...
Epoch: 6 cost time: 1.3860502243041992
Epoch: 6, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.718 Vali Acc: 0.724 Test Loss: 0.718 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.4402735233306885
Epoch: 7, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.628 Vali Acc: 0.743 Test Loss: 0.628 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.5459239482879639
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.6159725189208984
Epoch: 9, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.483306646347046
Epoch: 10, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.521 Vali Acc: 0.763 Test Loss: 0.521 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4935767650604248
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3977158069610596
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4563632011413574
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4754681587219238
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.5653717517852783
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3484954833984375
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.4372146129608154
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3901901245117188
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3146090507507324
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2837200164794922
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6604835987091064
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5674512386322021
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4132723808288574
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5949289798736572
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.546280860900879
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9997735023498535
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1112580
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7259364128112793
Epoch: 1, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.4180793762207031
Epoch: 2, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
Validation loss decreased (-0.374987 --> -0.480250).  Saving model ...
Epoch: 3 cost time: 1.472574234008789
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.159 Vali Acc: 0.632 Test Loss: 1.159 Test Acc: 0.632
Validation loss decreased (-0.480250 --> -0.631567).  Saving model ...
Epoch: 4 cost time: 1.4582552909851074
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.037 Vali Acc: 0.664 Test Loss: 1.037 Test Acc: 0.664
Validation loss decreased (-0.631567 --> -0.664463).  Saving model ...
Epoch: 5 cost time: 1.4698448181152344
Epoch: 5, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.909 Vali Acc: 0.697 Test Loss: 0.909 Test Acc: 0.697
Validation loss decreased (-0.664463 --> -0.697359).  Saving model ...
Epoch: 6 cost time: 1.4098381996154785
Epoch: 6, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.792 Vali Acc: 0.711 Test Loss: 0.792 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.3995294570922852
Epoch: 7, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
Validation loss decreased (-0.710518 --> -0.776309).  Saving model ...
Epoch: 8 cost time: 1.4321320056915283
Epoch: 8, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.159921646118164
Epoch: 9, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0280003547668457
Epoch: 10, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.536 Vali Acc: 0.770 Test Loss: 0.536 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0571768283843994
Epoch: 11, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1244275569915771
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776311).  Saving model ...
Epoch: 13 cost time: 1.3474981784820557
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.4540891647338867
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.508 Vali Acc: 0.776 Test Loss: 0.508 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.628636121749878
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4932618141174316
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7416162490844727
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5172557830810547
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.4772179126739502
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5255484580993652
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6730384826660156
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5911133289337158
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4878730773925781
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5884945392608643
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.452561378479004
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7158353328704834
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4679667949676514
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.783 Test Loss: 0.642 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4484601020812988
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1103492
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.511159658432007
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.368 Vali Acc: 0.362 Test Loss: 1.368 Test Acc: 0.362
Validation loss decreased (inf --> -0.361828).  Saving model ...
Epoch: 2 cost time: 1.4395010471343994
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.300 Vali Acc: 0.467 Test Loss: 1.300 Test Acc: 0.467
Validation loss decreased (-0.361828 --> -0.467092).  Saving model ...
Epoch: 3 cost time: 1.4880852699279785
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.201 Vali Acc: 0.586 Test Loss: 1.201 Test Acc: 0.586
Validation loss decreased (-0.467092 --> -0.585514).  Saving model ...
Epoch: 4 cost time: 1.5542149543762207
Epoch: 4, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.086 Vali Acc: 0.645 Test Loss: 1.086 Test Acc: 0.645
Validation loss decreased (-0.585514 --> -0.644726).  Saving model ...
Epoch: 5 cost time: 1.3791537284851074
Epoch: 5, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.967 Vali Acc: 0.678 Test Loss: 0.967 Test Acc: 0.678
Validation loss decreased (-0.644726 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.5814182758331299
Epoch: 6, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.854 Vali Acc: 0.684 Test Loss: 0.854 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 1.5280098915100098
Epoch: 7, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.756 Vali Acc: 0.697 Test Loss: 0.756 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.5698585510253906
Epoch: 8, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 9 cost time: 1.6707353591918945
Epoch: 9, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.3124499320983887
Epoch: 10, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.581 Vali Acc: 0.750 Test Loss: 0.581 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.475147008895874
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.5440559387207031
Epoch: 12, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763153).  Saving model ...
Epoch: 13 cost time: 1.307560682296753
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.531 Vali Acc: 0.763 Test Loss: 0.531 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 14 cost time: 1.3562123775482178
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 15 cost time: 1.2971980571746826
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4309513568878174
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.3716247081756592
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4663779735565186
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.247567892074585
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4318268299102783
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4018127918243408
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5708248615264893
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3800017833709717
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4636776447296143
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.331378698348999
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.496178388595581
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4288063049316406
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.430171012878418
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1103556
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.012460470199585
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.372 Vali Acc: 0.309 Test Loss: 1.372 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.5509724617004395
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.309 Vali Acc: 0.447 Test Loss: 1.309 Test Acc: 0.447
Validation loss decreased (-0.309197 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 1.640378713607788
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.222 Vali Acc: 0.539 Test Loss: 1.222 Test Acc: 0.539
Validation loss decreased (-0.447355 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 1.6069493293762207
Epoch: 4, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.126 Vali Acc: 0.612 Test Loss: 1.126 Test Acc: 0.612
Validation loss decreased (-0.539461 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 1.69581937789917
Epoch: 5, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.021 Vali Acc: 0.638 Test Loss: 1.021 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.4949920177459717
Epoch: 6, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.914 Vali Acc: 0.678 Test Loss: 0.914 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 1.5675804615020752
Epoch: 7, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.822 Vali Acc: 0.691 Test Loss: 0.822 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 1.4628043174743652
Epoch: 8, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.739 Vali Acc: 0.730 Test Loss: 0.739 Test Acc: 0.730
Validation loss decreased (-0.690781 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.5482769012451172
Epoch: 9, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
Validation loss decreased (-0.730256 --> -0.782888).  Saving model ...
Epoch: 10 cost time: 1.4199841022491455
Epoch: 10, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 11 cost time: 1.5549943447113037
Epoch: 11, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.531374216079712
Epoch: 12, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5480356216430664
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.6532812118530273
Epoch: 14, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.457787036895752
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.5465130805969238
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4922583103179932
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4378039836883545
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6443886756896973
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3602662086486816
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4983623027801514
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6744728088378906
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.569669246673584
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5263850688934326
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.349241018295288
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.642 Vali Acc: 0.803 Test Loss: 0.642 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.639220952987671
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5524628162384033
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6197688579559326
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.684 Vali Acc: 0.796 Test Loss: 0.684 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4999418258666992
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5818521976470947
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.694 Vali Acc: 0.796 Test Loss: 0.694 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.6358988285064697
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.709 Vali Acc: 0.809 Test Loss: 0.709 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809203).  Saving model ...
Epoch: 32 cost time: 1.393324851989746
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.809 Test Loss: 0.718 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.5405898094177246
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6444778442382812
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.745 Vali Acc: 0.796 Test Loss: 0.745 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4299006462097168
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5764894485473633
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.765 Vali Acc: 0.803 Test Loss: 0.765 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4036474227905273
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.803 Test Loss: 0.781 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3776302337646484
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.803 Test Loss: 0.794 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3977370262145996
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5217745304107666
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6294066905975342
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.796 Test Loss: 0.820 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1100612
model size : 4.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8321194648742676
Epoch: 1, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.376 Vali Acc: 0.362 Test Loss: 1.376 Test Acc: 0.362
Validation loss decreased (inf --> -0.361828).  Saving model ...
Epoch: 2 cost time: 1.3864097595214844
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.302 Vali Acc: 0.447 Test Loss: 1.302 Test Acc: 0.447
Validation loss decreased (-0.361828 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 1.278061866760254
Epoch: 3, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.192 Vali Acc: 0.599 Test Loss: 1.192 Test Acc: 0.599
Validation loss decreased (-0.447355 --> -0.598672).  Saving model ...
Epoch: 4 cost time: 1.3611786365509033
Epoch: 4, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.066 Vali Acc: 0.599 Test Loss: 1.066 Test Acc: 0.599
Validation loss decreased (-0.598672 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 1.5523908138275146
Epoch: 5, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.932 Vali Acc: 0.632 Test Loss: 0.932 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631570).  Saving model ...
Epoch: 6 cost time: 1.2112109661102295
Epoch: 6, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.805 Vali Acc: 0.704 Test Loss: 0.805 Test Acc: 0.704
Validation loss decreased (-0.631570 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.2153966426849365
Epoch: 7, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.707 Vali Acc: 0.737 Test Loss: 0.707 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.5080819129943848
Epoch: 8, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.281367301940918
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.3806688785552979
Epoch: 10, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.2713611125946045
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.1929659843444824
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.4514729976654053
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1915395259857178
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.3205130100250244
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4021811485290527
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1758224964141846
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9909546375274658
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2208638191223145
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.614 Vali Acc: 0.776 Test Loss: 0.614 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3435413837432861
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.622 Vali Acc: 0.776 Test Loss: 0.622 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5080780982971191
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.196091651916504
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4181530475616455
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3263864517211914
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 317124
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.08847975730896
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.358 Vali Acc: 0.355 Test Loss: 1.358 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.4309208393096924
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.285 Vali Acc: 0.454 Test Loss: 1.285 Test Acc: 0.454
Validation loss decreased (-0.355250 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.726888656616211
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.188 Vali Acc: 0.566 Test Loss: 1.188 Test Acc: 0.566
Validation loss decreased (-0.453935 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.3680214881896973
Epoch: 4, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.071 Vali Acc: 0.632 Test Loss: 1.071 Test Acc: 0.632
Validation loss decreased (-0.565778 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.5262231826782227
Epoch: 5, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.938 Vali Acc: 0.711 Test Loss: 0.938 Test Acc: 0.711
Validation loss decreased (-0.631568 --> -0.710517).  Saving model ...
Epoch: 6 cost time: 1.456653118133545
Epoch: 6, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.817 Vali Acc: 0.724 Test Loss: 0.817 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 1.5612168312072754
Epoch: 7, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
Validation loss decreased (-0.723676 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.247241497039795
Epoch: 8, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.21317720413208
Epoch: 9, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.3629817962646484
Epoch: 10, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6084785461425781
Epoch: 11, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.1791250705718994
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 1.4758007526397705
Epoch: 13, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2300493717193604
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.278841257095337
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.326368808746338
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1330113410949707
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.375396728515625
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3372981548309326
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.579 Vali Acc: 0.789 Test Loss: 0.579 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3203256130218506
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.403010606765747
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4993255138397217
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.3298497200012207
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 24 cost time: 1.4187934398651123
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.468975305557251
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4230079650878906
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3383057117462158
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3005404472351074
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4491138458251953
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6210927963256836
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.377434253692627
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 32 cost time: 1.268937587738037
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4638242721557617
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.796 Test Loss: 0.694 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.490389347076416
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1770570278167725
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.789 Test Loss: 0.715 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.353888750076294
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7739825248718262
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4009439945220947
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2932777404785156
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.796 Test Loss: 0.732 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.4177954196929932
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.332714319229126
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.752 Vali Acc: 0.803 Test Loss: 0.752 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 317156
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9776809215545654
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.372 Vali Acc: 0.303 Test Loss: 1.372 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.213618278503418
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.326 Vali Acc: 0.382 Test Loss: 1.326 Test Acc: 0.382
Validation loss decreased (-0.302618 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.2949373722076416
Epoch: 3, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.263 Vali Acc: 0.507 Test Loss: 1.263 Test Acc: 0.507
Validation loss decreased (-0.381566 --> -0.506566).  Saving model ...
Epoch: 4 cost time: 1.215649127960205
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.193 Vali Acc: 0.579 Test Loss: 1.193 Test Acc: 0.579
Validation loss decreased (-0.506566 --> -0.578935).  Saving model ...
Epoch: 5 cost time: 1.3780882358551025
Epoch: 5, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.109 Vali Acc: 0.605 Test Loss: 1.109 Test Acc: 0.605
Validation loss decreased (-0.578935 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 1.6122229099273682
Epoch: 6, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.015 Vali Acc: 0.645 Test Loss: 1.015 Test Acc: 0.645
Validation loss decreased (-0.605252 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.5208194255828857
Epoch: 7, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.931 Vali Acc: 0.678 Test Loss: 0.931 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 1.3149986267089844
Epoch: 8, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.845 Vali Acc: 0.717 Test Loss: 0.845 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 9 cost time: 1.2048389911651611
Epoch: 9, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.771 Vali Acc: 0.717 Test Loss: 0.771 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.3787751197814941
Epoch: 10, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.634364366531372
Epoch: 11, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.540924072265625
Epoch: 12, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.1640584468841553
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.568 Vali Acc: 0.750 Test Loss: 0.568 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0952696800231934
Epoch: 14, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.542 Vali Acc: 0.757 Test Loss: 0.542 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3520920276641846
Epoch: 15, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 16 cost time: 1.338653326034546
Epoch: 16, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 17 cost time: 1.2589023113250732
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 1.258981704711914
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.552323818206787
Epoch: 19, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.495 Vali Acc: 0.803 Test Loss: 0.495 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.249851942062378
Epoch: 20, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.2318062782287598
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2714202404022217
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3210761547088623
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2257707118988037
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3103132247924805
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4208486080169678
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4097862243652344
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5738224983215332
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2730724811553955
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.564 Vali Acc: 0.816 Test Loss: 0.564 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 30 cost time: 1.3507449626922607
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4627997875213623
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3552312850952148
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2351441383361816
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.279731273651123
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.809 Test Loss: 0.594 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7125375270843506
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2976372241973877
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3624086380004883
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.395725965499878
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3824381828308105
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 306436
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5281167030334473
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.382 Vali Acc: 0.276 Test Loss: 1.382 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.233170509338379
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.348 Vali Acc: 0.355 Test Loss: 1.348 Test Acc: 0.355
Validation loss decreased (-0.276302 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.2835869789123535
Epoch: 3, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.295 Vali Acc: 0.454 Test Loss: 1.295 Test Acc: 0.454
Validation loss decreased (-0.355250 --> -0.453934).  Saving model ...
Epoch: 4 cost time: 1.3245835304260254
Epoch: 4, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.231 Vali Acc: 0.474 Test Loss: 1.231 Test Acc: 0.474
Validation loss decreased (-0.453934 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 1.250887155532837
Epoch: 5, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.160 Vali Acc: 0.566 Test Loss: 1.160 Test Acc: 0.566
Validation loss decreased (-0.473672 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 1.2593717575073242
Epoch: 6, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.084 Vali Acc: 0.645 Test Loss: 1.084 Test Acc: 0.645
Validation loss decreased (-0.565778 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 1.258467435836792
Epoch: 7, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.002 Vali Acc: 0.691 Test Loss: 1.002 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690779).  Saving model ...
Epoch: 8 cost time: 1.3113884925842285
Epoch: 8, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.921 Vali Acc: 0.704 Test Loss: 0.921 Test Acc: 0.704
Validation loss decreased (-0.690779 --> -0.703938).  Saving model ...
Epoch: 9 cost time: 1.3382747173309326
Epoch: 9, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.839 Vali Acc: 0.717 Test Loss: 0.839 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 1.1696829795837402
Epoch: 10, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.765 Vali Acc: 0.743 Test Loss: 0.765 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743413).  Saving model ...
Epoch: 11 cost time: 1.1374869346618652
Epoch: 11, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.149094581604004
Epoch: 12, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.639 Vali Acc: 0.757 Test Loss: 0.639 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.2944514751434326
Epoch: 13, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.2698378562927246
Epoch: 14, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.1934547424316406
Epoch: 15, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2693791389465332
Epoch: 16, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 1.265122890472412
Epoch: 17, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 18 cost time: 1.314035177230835
Epoch: 18, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 19 cost time: 1.0700907707214355
Epoch: 19, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.482 Vali Acc: 0.783 Test Loss: 0.482 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 20 cost time: 1.2665722370147705
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.479 Vali Acc: 0.783 Test Loss: 0.479 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 21 cost time: 1.1777350902557373
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.478 Vali Acc: 0.783 Test Loss: 0.478 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 22 cost time: 1.2443366050720215
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.142336130142212
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.392535924911499
Epoch: 24, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2245163917541504
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2853691577911377
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.310295581817627
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.5269124507904053
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.461524486541748
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 30 cost time: 1.1287622451782227
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.160811185836792
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1259636878967285
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4329302310943604
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2084736824035645
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2312731742858887
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2181775569915771
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2219939231872559
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1745433807373047
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.310380220413208
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 301892
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3926875591278076
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.377 Vali Acc: 0.349 Test Loss: 1.377 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.127213954925537
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.340 Vali Acc: 0.395 Test Loss: 1.340 Test Acc: 0.395
Validation loss decreased (-0.348670 --> -0.394723).  Saving model ...
Epoch: 3 cost time: 1.2837145328521729
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.285 Vali Acc: 0.526 Test Loss: 1.285 Test Acc: 0.526
Validation loss decreased (-0.394723 --> -0.526303).  Saving model ...
Epoch: 4 cost time: 1.5228416919708252
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.220 Vali Acc: 0.605 Test Loss: 1.220 Test Acc: 0.605
Validation loss decreased (-0.526303 --> -0.605251).  Saving model ...
Epoch: 5 cost time: 1.295884132385254
Epoch: 5, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.147 Vali Acc: 0.651 Test Loss: 1.147 Test Acc: 0.651
Validation loss decreased (-0.605251 --> -0.651304).  Saving model ...
Epoch: 6 cost time: 1.4634416103363037
Epoch: 6, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.073 Vali Acc: 0.678 Test Loss: 1.073 Test Acc: 0.678
Validation loss decreased (-0.651304 --> -0.677621).  Saving model ...
Epoch: 7 cost time: 1.317384958267212
Epoch: 7, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.993 Vali Acc: 0.697 Test Loss: 0.993 Test Acc: 0.697
Validation loss decreased (-0.677621 --> -0.697358).  Saving model ...
Epoch: 8 cost time: 1.2790312767028809
Epoch: 8, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.913 Vali Acc: 0.730 Test Loss: 0.913 Test Acc: 0.730
Validation loss decreased (-0.697358 --> -0.730254).  Saving model ...
Epoch: 9 cost time: 1.3282747268676758
Epoch: 9, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.836 Vali Acc: 0.730 Test Loss: 0.836 Test Acc: 0.730
Validation loss decreased (-0.730254 --> -0.730255).  Saving model ...
Epoch: 10 cost time: 1.3449211120605469
Epoch: 10, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.763 Vali Acc: 0.763 Test Loss: 0.763 Test Acc: 0.763
Validation loss decreased (-0.730255 --> -0.763150).  Saving model ...
Epoch: 11 cost time: 1.4472177028656006
Epoch: 11, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.702 Vali Acc: 0.770 Test Loss: 0.702 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 1.3655998706817627
Epoch: 12, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.649 Vali Acc: 0.757 Test Loss: 0.649 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3638091087341309
Epoch: 13, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.403843641281128
Epoch: 14, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.4154200553894043
Epoch: 15, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.433544635772705
Epoch: 16, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.3994667530059814
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 18 cost time: 1.25761079788208
Epoch: 18, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.3213822841644287
Epoch: 19, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.2938148975372314
Epoch: 20, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.489 Vali Acc: 0.796 Test Loss: 0.489 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5860016345977783
Epoch: 21, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3279337882995605
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2480649948120117
Epoch: 23, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 24 cost time: 1.4008169174194336
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.497 Vali Acc: 0.816 Test Loss: 0.497 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 25 cost time: 1.4083225727081299
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.384342908859253
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2212042808532715
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2534654140472412
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.526 Vali Acc: 0.816 Test Loss: 0.526 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2752933502197266
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.426806926727295
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2325663566589355
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3304474353790283
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2300269603729248
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1852402687072754
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.590 Vali Acc: 0.816 Test Loss: 0.590 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 301924
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.890167713165283
Epoch: 1, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.390 Vali Acc: 0.237 Test Loss: 1.390 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.4035582542419434
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.364 Vali Acc: 0.349 Test Loss: 1.364 Test Acc: 0.349
Validation loss decreased (-0.236828 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.2861213684082031
Epoch: 3, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.323 Vali Acc: 0.414 Test Loss: 1.323 Test Acc: 0.414
Validation loss decreased (-0.348671 --> -0.414460).  Saving model ...
Epoch: 4 cost time: 1.4573540687561035
Epoch: 4, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.272 Vali Acc: 0.487 Test Loss: 1.272 Test Acc: 0.487
Validation loss decreased (-0.414460 --> -0.486829).  Saving model ...
Epoch: 5 cost time: 1.0390260219573975
Epoch: 5, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.219 Vali Acc: 0.513 Test Loss: 1.219 Test Acc: 0.513
Validation loss decreased (-0.486829 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 1.2246885299682617
Epoch: 6, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.157 Vali Acc: 0.605 Test Loss: 1.157 Test Acc: 0.605
Validation loss decreased (-0.513146 --> -0.605252).  Saving model ...
Epoch: 7 cost time: 1.369483232498169
Epoch: 7, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.097 Vali Acc: 0.632 Test Loss: 1.097 Test Acc: 0.632
Validation loss decreased (-0.605252 --> -0.631568).  Saving model ...
Epoch: 8 cost time: 1.382798671722412
Epoch: 8, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.031 Vali Acc: 0.651 Test Loss: 1.031 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651305).  Saving model ...
Epoch: 9 cost time: 1.2477118968963623
Epoch: 9, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.964 Vali Acc: 0.671 Test Loss: 0.964 Test Acc: 0.671
Validation loss decreased (-0.651305 --> -0.671043).  Saving model ...
Epoch: 10 cost time: 1.3064324855804443
Epoch: 10, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.902 Vali Acc: 0.691 Test Loss: 0.902 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690780).  Saving model ...
Epoch: 11 cost time: 1.3917837142944336
Epoch: 11, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.835 Vali Acc: 0.730 Test Loss: 0.835 Test Acc: 0.730
Validation loss decreased (-0.690780 --> -0.730255).  Saving model ...
Epoch: 12 cost time: 1.1814579963684082
Epoch: 12, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.775 Vali Acc: 0.737 Test Loss: 0.775 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736834).  Saving model ...
Epoch: 13 cost time: 1.348621129989624
Epoch: 13, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.719 Vali Acc: 0.730 Test Loss: 0.719 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.235553503036499
Epoch: 14, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.674 Vali Acc: 0.743 Test Loss: 0.674 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 15 cost time: 1.2913105487823486
Epoch: 15, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.630 Vali Acc: 0.763 Test Loss: 0.630 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.345262050628662
Epoch: 16, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2476716041564941
Epoch: 17, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.3450133800506592
Epoch: 18, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.2400214672088623
Epoch: 19, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2615251541137695
Epoch: 20, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.218742847442627
Epoch: 21, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3324849605560303
Epoch: 22, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.528 Vali Acc: 0.770 Test Loss: 0.528 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3878874778747559
Epoch: 23, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.25642991065979
Epoch: 24, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.528 Vali Acc: 0.770 Test Loss: 0.528 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2878596782684326
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3815789222717285
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3353817462921143
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 1.3691513538360596
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3983361721038818
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.368065357208252
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 31 cost time: 1.6249933242797852
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.607 Vali Acc: 0.809 Test Loss: 0.607 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 32 cost time: 1.4191555976867676
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.326052188873291
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.627640962600708
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0417876243591309
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.228654384613037
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.287024974822998
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.706 Vali Acc: 0.789 Test Loss: 0.706 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4067890644073486
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1550185680389404
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2429935932159424
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.739 Vali Acc: 0.816 Test Loss: 0.739 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 41 cost time: 1.359243631362915
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4607610702514648
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.768 Vali Acc: 0.803 Test Loss: 0.768 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4525721073150635
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.765 Vali Acc: 0.809 Test Loss: 0.765 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3865931034088135
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.802 Vali Acc: 0.809 Test Loss: 0.802 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2187168598175049
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.794 Vali Acc: 0.803 Test Loss: 0.794 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3100669384002686
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.812 Vali Acc: 0.816 Test Loss: 0.812 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3501930236816406
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.819 Vali Acc: 0.816 Test Loss: 0.819 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.180774211883545
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.824 Vali Acc: 0.809 Test Loss: 0.824 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1937053203582764
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.832 Vali Acc: 0.809 Test Loss: 0.832 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.2889978885650635
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 300452
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8288726806640625
Epoch: 1, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.144 Vali Acc: 0.566 Test Loss: 1.144 Test Acc: 0.566
Validation loss decreased (inf --> -0.565778).  Saving model ...
Epoch: 2 cost time: 1.7779533863067627
Epoch: 2, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.717 Vali Acc: 0.691 Test Loss: 0.717 Test Acc: 0.691
Validation loss decreased (-0.565778 --> -0.690782).  Saving model ...
Epoch: 3 cost time: 1.5529439449310303
Epoch: 3, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
Validation loss decreased (-0.690782 --> -0.749994).  Saving model ...
Epoch: 4 cost time: 1.7830770015716553
Epoch: 4, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 5 cost time: 1.868943452835083
Epoch: 5, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.831106185913086
Epoch: 6, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9180257320404053
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802625).  Saving model ...
Epoch: 8 cost time: 1.877915382385254
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6047139167785645
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8386099338531494
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.770 Test Loss: 0.775 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.084956407546997
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.770 Test Loss: 0.790 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.97554349899292
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.776 Test Loss: 0.804 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7969040870666504
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.770 Test Loss: 0.808 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.848728895187378
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.770 Test Loss: 0.808 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.779477596282959
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.817 Vali Acc: 0.776 Test Loss: 0.817 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.589905023574829
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.776 Test Loss: 0.827 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7736406326293945
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.776 Test Loss: 0.832 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3454468
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.114238977432251
Epoch: 1, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.113 Vali Acc: 0.566 Test Loss: 1.113 Test Acc: 0.566
Validation loss decreased (inf --> -0.565778).  Saving model ...
Epoch: 2 cost time: 1.753673791885376
Epoch: 2, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
Validation loss decreased (-0.565778 --> -0.736836).  Saving model ...
Epoch: 3 cost time: 2.1191325187683105
Epoch: 3, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.736836 --> -0.782889).  Saving model ...
Epoch: 4 cost time: 1.4910054206848145
Epoch: 4, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.437934160232544
Epoch: 5, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.632 Vali Acc: 0.776 Test Loss: 0.632 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4387338161468506
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.679 Vali Acc: 0.783 Test Loss: 0.679 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6187448501586914
Epoch: 7, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.749 Vali Acc: 0.796 Test Loss: 0.749 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796045).  Saving model ...
Epoch: 8 cost time: 1.6737475395202637
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.769 Vali Acc: 0.789 Test Loss: 0.769 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.728177547454834
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8700456619262695
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.783 Test Loss: 0.778 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6135520935058594
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.785569667816162
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.776 Test Loss: 0.790 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.780848741531372
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.776 Test Loss: 0.805 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.655214786529541
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.776 Test Loss: 0.815 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.107753038406372
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.783 Test Loss: 0.816 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9266490936279297
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.783 Test Loss: 0.829 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.878072738647461
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 3454724
model size : 13.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.866013765335083
Epoch: 1, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.247 Vali Acc: 0.513 Test Loss: 1.247 Test Acc: 0.513
Validation loss decreased (inf --> -0.513145).  Saving model ...
Epoch: 2 cost time: 1.8551805019378662
Epoch: 2, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.885 Vali Acc: 0.645 Test Loss: 0.885 Test Acc: 0.645
Validation loss decreased (-0.513145 --> -0.644728).  Saving model ...
Epoch: 3 cost time: 1.6701176166534424
Epoch: 3, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
Validation loss decreased (-0.644728 --> -0.743414).  Saving model ...
Epoch: 4 cost time: 1.6985859870910645
Epoch: 4, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.863553524017334
Epoch: 5, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.659905195236206
Epoch: 6, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 1.7083308696746826
Epoch: 7, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4255032539367676
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.518263816833496
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.627 Vali Acc: 0.776 Test Loss: 0.627 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4339501857757568
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6978209018707275
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 12 cost time: 1.4537389278411865
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5498888492584229
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7980897426605225
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6194181442260742
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.476529598236084
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3841283321380615
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.789 Test Loss: 0.718 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5590810775756836
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.796 Test Loss: 0.725 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4255545139312744
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.796 Test Loss: 0.730 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.49190354347229
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.796 Test Loss: 0.747 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5005977153778076
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.803 Test Loss: 0.753 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 22 cost time: 1.6433193683624268
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6399688720703125
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.803 Test Loss: 0.768 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7281968593597412
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.573155164718628
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.803 Test Loss: 0.780 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6339826583862305
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7818584442138672
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.803 Test Loss: 0.785 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.559239149093628
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.796 Test Loss: 0.791 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.665287971496582
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.796 Test Loss: 0.802 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7001707553863525
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.429347276687622
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.803 Test Loss: 0.815 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3362820
model size : 12.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5669167041778564
Epoch: 1, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.240 Vali Acc: 0.493 Test Loss: 1.240 Test Acc: 0.493
Validation loss decreased (inf --> -0.493409).  Saving model ...
Epoch: 2 cost time: 1.5049395561218262
Epoch: 2, Steps: 10 | Train Loss: 0.950 Vali Loss: 0.944 Vali Acc: 0.625 Test Loss: 0.944 Test Acc: 0.625
Validation loss decreased (-0.493409 --> -0.624991).  Saving model ...
Epoch: 3 cost time: 1.437849760055542
Epoch: 3, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.727 Vali Acc: 0.691 Test Loss: 0.727 Test Acc: 0.691
Validation loss decreased (-0.624991 --> -0.690782).  Saving model ...
Epoch: 4 cost time: 1.5607969760894775
Epoch: 4, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717099).  Saving model ...
Epoch: 5 cost time: 1.4468648433685303
Epoch: 5, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.561 Vali Acc: 0.750 Test Loss: 0.561 Test Acc: 0.750
Validation loss decreased (-0.717099 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.4980411529541016
Epoch: 6, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.547 Vali Acc: 0.757 Test Loss: 0.547 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.5666708946228027
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.4996557235717773
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.5818636417388916
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.579 Vali Acc: 0.789 Test Loss: 0.579 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.4650936126708984
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.5831329822540283
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3879201412200928
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.615 Vali Acc: 0.796 Test Loss: 0.615 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6287784576416016
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4513628482818604
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5772905349731445
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.638 Vali Acc: 0.796 Test Loss: 0.638 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5440890789031982
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5933501720428467
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.796 Test Loss: 0.661 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8524327278137207
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 19 cost time: 1.5944995880126953
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5008506774902344
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.796 Test Loss: 0.686 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3705732822418213
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.796 Test Loss: 0.697 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.412240743637085
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.803 Test Loss: 0.703 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4713284969329834
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6041576862335205
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.796 Test Loss: 0.723 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3177227973937988
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.796 Test Loss: 0.723 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.71323823928833
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.731 Vali Acc: 0.796 Test Loss: 0.731 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5638728141784668
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.796 Test Loss: 0.738 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.441051721572876
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.796 Test Loss: 0.747 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3332612
model size : 12.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5829429626464844
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.245 Vali Acc: 0.493 Test Loss: 1.245 Test Acc: 0.493
Validation loss decreased (inf --> -0.493409).  Saving model ...
Epoch: 2 cost time: 1.507777452468872
Epoch: 2, Steps: 10 | Train Loss: 0.970 Vali Loss: 0.955 Vali Acc: 0.651 Test Loss: 0.955 Test Acc: 0.651
Validation loss decreased (-0.493409 --> -0.651306).  Saving model ...
Epoch: 3 cost time: 1.4912559986114502
Epoch: 3, Steps: 10 | Train Loss: 0.569 Vali Loss: 0.740 Vali Acc: 0.704 Test Loss: 0.740 Test Acc: 0.704
Validation loss decreased (-0.651306 --> -0.703940).  Saving model ...
Epoch: 4 cost time: 1.3208775520324707
Epoch: 4, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743415).  Saving model ...
Epoch: 5 cost time: 1.4870529174804688
Epoch: 5, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.332338571548462
Epoch: 6, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.423410177230835
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.540743350982666
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.489858627319336
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.4606285095214844
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.796 Test Loss: 0.587 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3136050701141357
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5346360206604004
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.483410358428955
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.386434555053711
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.642 Vali Acc: 0.776 Test Loss: 0.642 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4631516933441162
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5628459453582764
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.667 Vali Acc: 0.783 Test Loss: 0.667 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4416673183441162
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6698260307312012
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2989418506622314
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.796 Test Loss: 0.694 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3332868
model size : 12.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0940446853637695
Epoch: 1, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.322 Vali Acc: 0.401 Test Loss: 1.322 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 1.2810344696044922
Epoch: 2, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.096 Vali Acc: 0.651 Test Loss: 1.096 Test Acc: 0.651
Validation loss decreased (-0.401303 --> -0.651305).  Saving model ...
Epoch: 3 cost time: 1.4988172054290771
Epoch: 3, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.868 Vali Acc: 0.671 Test Loss: 0.868 Test Acc: 0.671
Validation loss decreased (-0.651305 --> -0.671044).  Saving model ...
Epoch: 4 cost time: 1.3436083793640137
Epoch: 4, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.710 Vali Acc: 0.724 Test Loss: 0.710 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723677).  Saving model ...
Epoch: 5 cost time: 1.3301751613616943
Epoch: 5, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.3824455738067627
Epoch: 6, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.3624367713928223
Epoch: 7, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.573 Vali Acc: 0.757 Test Loss: 0.573 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.362705945968628
Epoch: 8, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.3572018146514893
Epoch: 9, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2787630558013916
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.2191455364227295
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.4825706481933594
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5307509899139404
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.22896409034729
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 1.496537685394287
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.495063304901123
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4145355224609375
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4516026973724365
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 19 cost time: 1.3375890254974365
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.666 Vali Acc: 0.796 Test Loss: 0.666 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.578547477722168
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3155522346496582
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.796 Test Loss: 0.678 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3665990829467773
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.796 Test Loss: 0.686 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4120185375213623
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.796 Test Loss: 0.700 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.431523323059082
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.796 Test Loss: 0.708 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5822081565856934
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.796 Test Loss: 0.725 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2913002967834473
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4595465660095215
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.809 Test Loss: 0.740 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3807737827301025
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.809 Test Loss: 0.739 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3314948
model size : 12.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3780264854431152
Epoch: 1, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.181 Vali Acc: 0.474 Test Loss: 1.181 Test Acc: 0.474
Validation loss decreased (inf --> -0.473672).  Saving model ...
Epoch: 2 cost time: 1.2771897315979004
Epoch: 2, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.863 Vali Acc: 0.632 Test Loss: 0.863 Test Acc: 0.632
Validation loss decreased (-0.473672 --> -0.631570).  Saving model ...
Epoch: 3 cost time: 1.1609973907470703
Epoch: 3, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.631570 --> -0.756573).  Saving model ...
Epoch: 4 cost time: 1.2594819068908691
Epoch: 4, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.529 Vali Acc: 0.763 Test Loss: 0.529 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763153).  Saving model ...
Epoch: 5 cost time: 1.3483176231384277
Epoch: 5, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.493 Vali Acc: 0.789 Test Loss: 0.493 Test Acc: 0.789
Validation loss decreased (-0.763153 --> -0.789469).  Saving model ...
Epoch: 6 cost time: 1.2678959369659424
Epoch: 6, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.501 Vali Acc: 0.770 Test Loss: 0.501 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4271628856658936
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.323695421218872
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.1216495037078857
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 1.246084213256836
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1707394123077393
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1337344646453857
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1341164112091064
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4142382144927979
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3202812671661377
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1854791641235352
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5381715297698975
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3376328945159912
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4647924900054932
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 940804
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6410112380981445
Epoch: 1, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.197 Vali Acc: 0.520 Test Loss: 1.197 Test Acc: 0.520
Validation loss decreased (inf --> -0.519725).  Saving model ...
Epoch: 2 cost time: 1.6021537780761719
Epoch: 2, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.823 Vali Acc: 0.711 Test Loss: 0.823 Test Acc: 0.711
Validation loss decreased (-0.519725 --> -0.710518).  Saving model ...
Epoch: 3 cost time: 1.407994031906128
Epoch: 3, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
Validation loss decreased (-0.710518 --> -0.776310).  Saving model ...
Epoch: 4 cost time: 1.7834503650665283
Epoch: 4, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2370977401733398
Epoch: 5, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 1.6168324947357178
Epoch: 6, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.440643310546875
Epoch: 7, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2810752391815186
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.639481782913208
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4309959411621094
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7941646575927734
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.435821771621704
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1971824169158936
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.671 Vali Acc: 0.776 Test Loss: 0.671 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0713000297546387
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3821306228637695
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 16 cost time: 1.4697551727294922
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.522125005722046
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5929837226867676
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.783 Test Loss: 0.714 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2575597763061523
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5072522163391113
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4252307415008545
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3326067924499512
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.796 Test Loss: 0.753 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 23 cost time: 1.2470359802246094
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.796 Test Loss: 0.761 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4315698146820068
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.803 Test Loss: 0.765 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802624).  Saving model ...
Epoch: 25 cost time: 1.2033360004425049
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.809 Test Loss: 0.770 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 26 cost time: 1.2386531829833984
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4649720191955566
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.803 Test Loss: 0.788 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4799525737762451
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.796 Test Loss: 0.797 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7134921550750732
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.803 Test Loss: 0.798 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.384387731552124
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.803 Test Loss: 0.801 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.478388786315918
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.796 Test Loss: 0.810 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4904015064239502
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.796 Test Loss: 0.816 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0446248054504395
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.803 Test Loss: 0.823 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4207580089569092
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.789 Test Loss: 0.822 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3938584327697754
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.796 Test Loss: 0.835 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 940932
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.415701389312744
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.303 Vali Acc: 0.349 Test Loss: 1.303 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.1746716499328613
Epoch: 2, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.089 Vali Acc: 0.579 Test Loss: 1.089 Test Acc: 0.579
Validation loss decreased (-0.348671 --> -0.578936).  Saving model ...
Epoch: 3 cost time: 1.2212915420532227
Epoch: 3, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.874 Vali Acc: 0.645 Test Loss: 0.874 Test Acc: 0.645
Validation loss decreased (-0.578936 --> -0.644728).  Saving model ...
Epoch: 4 cost time: 1.3011798858642578
Epoch: 4, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.717 Vali Acc: 0.724 Test Loss: 0.717 Test Acc: 0.724
Validation loss decreased (-0.644728 --> -0.723677).  Saving model ...
Epoch: 5 cost time: 1.5448048114776611
Epoch: 5, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 6 cost time: 1.2468621730804443
Epoch: 6, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.2388801574707031
Epoch: 7, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.2634341716766357
Epoch: 8, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.226518154144287
Epoch: 9, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.141587495803833
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.165055751800537
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2302112579345703
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2494077682495117
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2522366046905518
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.612 Vali Acc: 0.770 Test Loss: 0.612 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2100591659545898
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.626 Vali Acc: 0.770 Test Loss: 0.626 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.210038423538208
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.638 Vali Acc: 0.776 Test Loss: 0.638 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1486830711364746
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.436631679534912
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.649 Vali Acc: 0.770 Test Loss: 0.649 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.361053228378296
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.657 Vali Acc: 0.776 Test Loss: 0.657 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0627496242523193
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.776 Test Loss: 0.663 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 894980
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.283245086669922
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.351 Vali Acc: 0.349 Test Loss: 1.351 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.1382577419281006
Epoch: 2, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.173 Vali Acc: 0.507 Test Loss: 1.173 Test Acc: 0.507
Validation loss decreased (-0.348671 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 1.4128458499908447
Epoch: 3, Steps: 10 | Train Loss: 0.898 Vali Loss: 0.975 Vali Acc: 0.605 Test Loss: 0.975 Test Acc: 0.605
Validation loss decreased (-0.506567 --> -0.605253).  Saving model ...
Epoch: 4 cost time: 1.2509493827819824
Epoch: 4, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.808 Vali Acc: 0.658 Test Loss: 0.808 Test Acc: 0.658
Validation loss decreased (-0.605253 --> -0.657887).  Saving model ...
Epoch: 5 cost time: 1.1183526515960693
Epoch: 5, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.694 Vali Acc: 0.724 Test Loss: 0.694 Test Acc: 0.724
Validation loss decreased (-0.657887 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.2641096115112305
Epoch: 6, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.623 Vali Acc: 0.704 Test Loss: 0.623 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1407065391540527
Epoch: 7, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.588 Vali Acc: 0.724 Test Loss: 0.588 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 8 cost time: 1.2365961074829102
Epoch: 8, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.0671143531799316
Epoch: 9, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763153).  Saving model ...
Epoch: 10 cost time: 1.2049527168273926
Epoch: 10, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.1062901020050049
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2327280044555664
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3283500671386719
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.245656967163086
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.084618330001831
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.253890037536621
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2372517585754395
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.296051025390625
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.210254430770874
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2971806526184082
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2698454856872559
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3588528633117676
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1249096393585205
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.618 Vali Acc: 0.776 Test Loss: 0.618 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2534050941467285
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3121323585510254
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 26 cost time: 1.1674740314483643
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3821852207183838
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3646929264068604
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3034746646881104
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0831871032714844
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1359663009643555
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3286025524139404
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1503324508666992
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.796 Test Loss: 0.691 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2834250926971436
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.796 Test Loss: 0.699 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1951780319213867
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.796 Test Loss: 0.707 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 879876
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.733360528945923
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.300 Vali Acc: 0.414 Test Loss: 1.300 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 1.3906421661376953
Epoch: 2, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.112 Vali Acc: 0.586 Test Loss: 1.112 Test Acc: 0.586
Validation loss decreased (-0.414461 --> -0.585515).  Saving model ...
Epoch: 3 cost time: 1.3390259742736816
Epoch: 3, Steps: 10 | Train Loss: 0.869 Vali Loss: 0.917 Vali Acc: 0.697 Test Loss: 0.917 Test Acc: 0.697
Validation loss decreased (-0.585515 --> -0.697359).  Saving model ...
Epoch: 4 cost time: 1.4676282405853271
Epoch: 4, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.769 Vali Acc: 0.711 Test Loss: 0.769 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.3837428092956543
Epoch: 5, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.675 Vali Acc: 0.717 Test Loss: 0.675 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717099).  Saving model ...
Epoch: 6 cost time: 1.500054121017456
Epoch: 6, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.618 Vali Acc: 0.730 Test Loss: 0.618 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 1.3003592491149902
Epoch: 7, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.573 Vali Acc: 0.730 Test Loss: 0.573 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 1.3860459327697754
Epoch: 8, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.1644909381866455
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.3346529006958008
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.3355059623718262
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3631389141082764
Epoch: 12, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3701090812683105
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.563 Vali Acc: 0.796 Test Loss: 0.563 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.5465404987335205
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3779513835906982
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4798457622528076
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2951126098632812
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.592 Vali Acc: 0.770 Test Loss: 0.592 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4058895111083984
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2505688667297363
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1738998889923096
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3927593231201172
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1479525566101074
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2981512546539307
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 880004
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.70188570022583
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.369 Vali Acc: 0.368 Test Loss: 1.369 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 1.2700304985046387
Epoch: 2, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.239 Vali Acc: 0.487 Test Loss: 1.239 Test Acc: 0.487
Validation loss decreased (-0.368407 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.3282697200775146
Epoch: 3, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.087 Vali Acc: 0.586 Test Loss: 1.087 Test Acc: 0.586
Validation loss decreased (-0.486830 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.2241792678833008
Epoch: 4, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.930 Vali Acc: 0.664 Test Loss: 0.930 Test Acc: 0.664
Validation loss decreased (-0.585515 --> -0.664464).  Saving model ...
Epoch: 5 cost time: 1.1688852310180664
Epoch: 5, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.804 Vali Acc: 0.704 Test Loss: 0.804 Test Acc: 0.704
Validation loss decreased (-0.664464 --> -0.703939).  Saving model ...
Epoch: 6 cost time: 1.3284997940063477
Epoch: 6, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.724 Vali Acc: 0.737 Test Loss: 0.724 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 7 cost time: 1.1161177158355713
Epoch: 7, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.3003020286560059
Epoch: 8, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.628 Vali Acc: 0.737 Test Loss: 0.628 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.204545259475708
Epoch: 9, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.606 Vali Acc: 0.737 Test Loss: 0.606 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.1018776893615723
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.051279067993164
Epoch: 11, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.1920311450958252
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2478137016296387
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.2805044651031494
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.2206015586853027
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2712314128875732
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3654475212097168
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.254263162612915
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.391904354095459
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.605 Vali Acc: 0.776 Test Loss: 0.605 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4343602657318115
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.614 Vali Acc: 0.789 Test Loss: 0.614 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.3682944774627686
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3258838653564453
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2971842288970947
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2583167552947998
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 25 cost time: 1.1484622955322266
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.658 Vali Acc: 0.796 Test Loss: 0.658 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1255300045013428
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 27 cost time: 1.162019968032837
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3704946041107178
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3746881484985352
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.796 Test Loss: 0.698 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3179864883422852
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1019816398620605
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.715 Vali Acc: 0.803 Test Loss: 0.715 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2910475730895996
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 33 cost time: 1.0341966152191162
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3377811908721924
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.080981969833374
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2326953411102295
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.763 Vali Acc: 0.809 Test Loss: 0.763 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0759317874908447
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.809 Test Loss: 0.772 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4001498222351074
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.809 Test Loss: 0.794 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2087464332580566
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.3124980926513672
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.809 Test Loss: 0.800 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.292672872543335
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.809 Test Loss: 0.812 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.2095098495483398
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.809 Test Loss: 0.816 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 871044
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3453192710876465
Epoch: 1, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.242 Vali Acc: 0.434 Test Loss: 1.242 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 1.409189224243164
Epoch: 2, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
Validation loss decreased (-0.434198 --> -0.624990).  Saving model ...
Epoch: 3 cost time: 1.1540305614471436
Epoch: 3, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.783 Vali Acc: 0.691 Test Loss: 0.783 Test Acc: 0.691
Validation loss decreased (-0.624990 --> -0.690782).  Saving model ...
Epoch: 4 cost time: 1.2467288970947266
Epoch: 4, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.658 Vali Acc: 0.730 Test Loss: 0.658 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 1.2015478610992432
Epoch: 5, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.128389596939087
Epoch: 6, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.536 Vali Acc: 0.763 Test Loss: 0.536 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763153).  Saving model ...
Epoch: 7 cost time: 1.194401741027832
Epoch: 7, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 8 cost time: 1.2963685989379883
Epoch: 8, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 9 cost time: 1.192866563796997
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1535043716430664
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1320548057556152
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2738444805145264
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1557259559631348
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.1171212196350098
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 0.9359655380249023
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1780009269714355
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1498782634735107
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3142495155334473
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.623 Vali Acc: 0.796 Test Loss: 0.623 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0656332969665527
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.370223045349121
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1430039405822754
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3451628684997559
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2265498638153076
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4498608112335205
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 273796
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8196070194244385
Epoch: 1, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.265 Vali Acc: 0.487 Test Loss: 1.265 Test Acc: 0.487
Validation loss decreased (inf --> -0.486829).  Saving model ...
Epoch: 2 cost time: 1.070631980895996
Epoch: 2, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.035 Vali Acc: 0.658 Test Loss: 1.035 Test Acc: 0.658
Validation loss decreased (-0.486829 --> -0.657884).  Saving model ...
Epoch: 3 cost time: 1.2504560947418213
Epoch: 3, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.811 Vali Acc: 0.724 Test Loss: 0.811 Test Acc: 0.724
Validation loss decreased (-0.657884 --> -0.723676).  Saving model ...
Epoch: 4 cost time: 1.187962293624878
Epoch: 4, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
Validation loss decreased (-0.723676 --> -0.749993).  Saving model ...
Epoch: 5 cost time: 1.223966121673584
Epoch: 5, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.601 Vali Acc: 0.743 Test Loss: 0.601 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.181694746017456
Epoch: 6, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 0.9760758876800537
Epoch: 7, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.227543592453003
Epoch: 8, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.28532075881958
Epoch: 9, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3241691589355469
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2120256423950195
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.215951919555664
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1991965770721436
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.339963436126709
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2102181911468506
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1427016258239746
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.614 Vali Acc: 0.776 Test Loss: 0.614 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.121978998184204
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 273860
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.175258159637451
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.362 Vali Acc: 0.316 Test Loss: 1.362 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.0458838939666748
Epoch: 2, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.223 Vali Acc: 0.487 Test Loss: 1.223 Test Acc: 0.487
Validation loss decreased (-0.315776 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 1.1937344074249268
Epoch: 3, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.049 Vali Acc: 0.671 Test Loss: 1.049 Test Acc: 0.671
Validation loss decreased (-0.486830 --> -0.671042).  Saving model ...
Epoch: 4 cost time: 0.9927117824554443
Epoch: 4, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.898 Vali Acc: 0.717 Test Loss: 0.898 Test Acc: 0.717
Validation loss decreased (-0.671042 --> -0.717096).  Saving model ...
Epoch: 5 cost time: 1.0808284282684326
Epoch: 5, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.782 Vali Acc: 0.743 Test Loss: 0.782 Test Acc: 0.743
Validation loss decreased (-0.717096 --> -0.743413).  Saving model ...
Epoch: 6 cost time: 1.0450537204742432
Epoch: 6, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.699 Vali Acc: 0.757 Test Loss: 0.699 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 1.0190904140472412
Epoch: 7, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0682756900787354
Epoch: 8, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.0340125560760498
Epoch: 9, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.1894686222076416
Epoch: 10, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0670263767242432
Epoch: 11, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1005158424377441
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.1302549839019775
Epoch: 13, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.1437182426452637
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1617257595062256
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1516499519348145
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1534438133239746
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0995664596557617
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1559181213378906
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9882345199584961
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3755888938903809
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1342036724090576
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0972621440887451
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 250884
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.484841823577881
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.436 Vali Acc: 0.250 Test Loss: 1.436 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.180363416671753
Epoch: 2, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.339 Vali Acc: 0.388 Test Loss: 1.339 Test Acc: 0.388
Validation loss decreased (-0.249986 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.2165851593017578
Epoch: 3, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.388145 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.1560444831848145
Epoch: 4, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.059 Vali Acc: 0.579 Test Loss: 1.059 Test Acc: 0.579
Validation loss decreased (-0.499988 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 1.2976922988891602
Epoch: 5, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.933 Vali Acc: 0.658 Test Loss: 0.933 Test Acc: 0.658
Validation loss decreased (-0.578937 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 1.1911194324493408
Epoch: 6, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.829 Vali Acc: 0.684 Test Loss: 0.829 Test Acc: 0.684
Validation loss decreased (-0.657885 --> -0.684202).  Saving model ...
Epoch: 7 cost time: 1.1498782634735107
Epoch: 7, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.737 Vali Acc: 0.711 Test Loss: 0.737 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 1.2165839672088623
Epoch: 8, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.667 Vali Acc: 0.743 Test Loss: 0.667 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.226393461227417
Epoch: 9, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.19191312789917
Epoch: 10, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.064767837524414
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.092998743057251
Epoch: 12, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.556 Vali Acc: 0.750 Test Loss: 0.556 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1561346054077148
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.0796630382537842
Epoch: 14, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.0980243682861328
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.044795274734497
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1296546459197998
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.1008706092834473
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2148487567901611
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.088221549987793
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.1334786415100098
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9797759056091309
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1949057579040527
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2407939434051514
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0398411750793457
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1161935329437256
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1750848293304443
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0990707874298096
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.2738375663757324
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0805182456970215
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 31 cost time: 1.0960092544555664
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2902698516845703
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1132941246032715
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1967155933380127
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2527122497558594
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.152360200881958
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2546827793121338
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2262282371520996
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.167414903640747
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1929354667663574
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 41 cost time: 1.3709659576416016
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.663 Vali Acc: 0.803 Test Loss: 0.663 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.215693712234497
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4563860893249512
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.693 Vali Acc: 0.796 Test Loss: 0.693 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.184105396270752
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.796 Test Loss: 0.697 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1358578205108643
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0839331150054932
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1483561992645264
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.070685625076294
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1367042064666748
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 50 cost time: 1.054595708847046
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.803 Test Loss: 0.739 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 243332
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.069221019744873
Epoch: 1, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.307 Vali Acc: 0.362 Test Loss: 1.307 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 0.9727375507354736
Epoch: 2, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.206 Vali Acc: 0.474 Test Loss: 1.206 Test Acc: 0.474
Validation loss decreased (-0.361829 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 0.9404010772705078
Epoch: 3, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.086 Vali Acc: 0.566 Test Loss: 1.086 Test Acc: 0.566
Validation loss decreased (-0.473672 --> -0.565779).  Saving model ...
Epoch: 4 cost time: 1.0693256855010986
Epoch: 4, Steps: 10 | Train Loss: 0.935 Vali Loss: 0.978 Vali Acc: 0.612 Test Loss: 0.978 Test Acc: 0.612
Validation loss decreased (-0.565779 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.1449286937713623
Epoch: 5, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.868 Vali Acc: 0.658 Test Loss: 0.868 Test Acc: 0.658
Validation loss decreased (-0.611832 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.0983905792236328
Epoch: 6, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.784 Vali Acc: 0.684 Test Loss: 0.784 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.1746714115142822
Epoch: 7, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.721 Vali Acc: 0.724 Test Loss: 0.721 Test Acc: 0.724
Validation loss decreased (-0.684203 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.0905907154083252
Epoch: 8, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.2309892177581787
Epoch: 9, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.9971089363098145
Epoch: 10, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.2434849739074707
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.2255990505218506
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.0894441604614258
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.1698312759399414
Epoch: 14, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1202671527862549
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9704174995422363
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.074303388595581
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.549 Vali Acc: 0.743 Test Loss: 0.549 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.108316421508789
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0915987491607666
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.3460114002227783
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.757 Test Loss: 0.555 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.055232048034668
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1236999034881592
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 23 cost time: 1.2133729457855225
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1461191177368164
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2967336177825928
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.416001796722412
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1195621490478516
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.588 Vali Acc: 0.763 Test Loss: 0.588 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.071765422821045
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.201261043548584
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2195258140563965
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2718656063079834
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.616 Vali Acc: 0.776 Test Loss: 0.616 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.158348560333252
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 243396
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.329080820083618
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.371 Vali Acc: 0.309 Test Loss: 1.371 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.3783094882965088
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.285 Vali Acc: 0.474 Test Loss: 1.285 Test Acc: 0.474
Validation loss decreased (-0.309197 --> -0.473671).  Saving model ...
Epoch: 3 cost time: 1.1602766513824463
Epoch: 3, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.176 Vali Acc: 0.566 Test Loss: 1.176 Test Acc: 0.566
Validation loss decreased (-0.473671 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.1194994449615479
Epoch: 4, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.066 Vali Acc: 0.605 Test Loss: 1.066 Test Acc: 0.605
Validation loss decreased (-0.565778 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.0990831851959229
Epoch: 5, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.968 Vali Acc: 0.632 Test Loss: 0.968 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 1.2817330360412598
Epoch: 6, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.872 Vali Acc: 0.691 Test Loss: 0.872 Test Acc: 0.691
Validation loss decreased (-0.631569 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 1.123720645904541
Epoch: 7, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.796 Vali Acc: 0.704 Test Loss: 0.796 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 1.1811015605926514
Epoch: 8, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.737 Vali Acc: 0.711 Test Loss: 0.737 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.1442759037017822
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.686 Vali Acc: 0.730 Test Loss: 0.686 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.153660535812378
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.642 Vali Acc: 0.763 Test Loss: 0.642 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 1.436246633529663
Epoch: 11, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2784960269927979
Epoch: 12, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.1882667541503906
Epoch: 13, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.1427996158599854
Epoch: 14, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.1109106540679932
Epoch: 15, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.0843384265899658
Epoch: 16, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3232007026672363
Epoch: 17, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2580866813659668
Epoch: 18, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1274175643920898
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.0932879447937012
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.28118896484375
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4708528518676758
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.240551233291626
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3285136222839355
Epoch: 24, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.326408863067627
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2570106983184814
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.617790699005127
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1081268787384033
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3011078834533691
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.258544921875
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.573 Vali Acc: 0.803 Test Loss: 0.573 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3741734027862549
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3665733337402344
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2165939807891846
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1190299987792969
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 35 cost time: 1.2023706436157227
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3140156269073486
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2400951385498047
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.796 Test Loss: 0.625 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3993637561798096
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2674322128295898
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1761891841888428
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3906664848327637
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.664 Vali Acc: 0.803 Test Loss: 0.664 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2027866840362549
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.796 Test Loss: 0.676 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1024746894836426
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.809 Test Loss: 0.689 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0247166156768799
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 238916
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1316750049591064
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.362 Vali Acc: 0.329 Test Loss: 1.362 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.1642160415649414
Epoch: 2, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.226 Vali Acc: 0.480 Test Loss: 1.226 Test Acc: 0.480
Validation loss decreased (-0.328934 --> -0.480251).  Saving model ...
Epoch: 3 cost time: 1.3013122081756592
Epoch: 3, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.054 Vali Acc: 0.599 Test Loss: 1.054 Test Acc: 0.599
Validation loss decreased (-0.480251 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 1.0881946086883545
Epoch: 4, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.889 Vali Acc: 0.684 Test Loss: 0.889 Test Acc: 0.684
Validation loss decreased (-0.598674 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.0451631546020508
Epoch: 5, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.758 Vali Acc: 0.684 Test Loss: 0.758 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 6 cost time: 1.1389133930206299
Epoch: 6, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.667 Vali Acc: 0.730 Test Loss: 0.667 Test Acc: 0.730
Validation loss decreased (-0.684203 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.201578140258789
Epoch: 7, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.0504236221313477
Epoch: 8, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.2310364246368408
Epoch: 9, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.2568037509918213
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2033202648162842
Epoch: 11, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1158409118652344
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 1.2173902988433838
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2126152515411377
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1151068210601807
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2766754627227783
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.176121711730957
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1074464321136475
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2049293518066406
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.216130018234253
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.05611252784729
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1320111751556396
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 87748
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5330371856689453
Epoch: 1, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.347 Vali Acc: 0.401 Test Loss: 1.347 Test Acc: 0.401
Validation loss decreased (inf --> -0.401302).  Saving model ...
Epoch: 2 cost time: 1.1440813541412354
Epoch: 2, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.214 Vali Acc: 0.533 Test Loss: 1.214 Test Acc: 0.533
Validation loss decreased (-0.401302 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 1.3881614208221436
Epoch: 3, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.046 Vali Acc: 0.599 Test Loss: 1.046 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 1.0525143146514893
Epoch: 4, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.877 Vali Acc: 0.717 Test Loss: 0.877 Test Acc: 0.717
Validation loss decreased (-0.598674 --> -0.717096).  Saving model ...
Epoch: 5 cost time: 1.2095162868499756
Epoch: 5, Steps: 10 | Train Loss: 0.579 Vali Loss: 0.760 Vali Acc: 0.730 Test Loss: 0.760 Test Acc: 0.730
Validation loss decreased (-0.717096 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 0.987023115158081
Epoch: 6, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.3670408725738525
Epoch: 7, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.117030382156372
Epoch: 8, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.0615978240966797
Epoch: 9, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.555 Vali Acc: 0.757 Test Loss: 0.555 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1612498760223389
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.177994728088379
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.533 Vali Acc: 0.757 Test Loss: 0.533 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.988452672958374
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.1649866104125977
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.2406706809997559
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3810291290283203
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2201001644134521
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1936869621276855
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.210449457168579
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.275968313217163
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2231645584106445
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0064244270324707
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1974353790283203
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0455372333526611
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.145465612411499
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1382508277893066
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1055409908294678
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0023117065429688
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 87780
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6669764518737793
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.395 Vali Acc: 0.283 Test Loss: 1.395 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.2573957443237305
Epoch: 2, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.320 Vali Acc: 0.329 Test Loss: 1.320 Test Acc: 0.329
Validation loss decreased (-0.282881 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.0727498531341553
Epoch: 3, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.216 Vali Acc: 0.493 Test Loss: 1.216 Test Acc: 0.493
Validation loss decreased (-0.328934 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.1145045757293701
Epoch: 4, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.105 Vali Acc: 0.559 Test Loss: 1.105 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.3072998523712158
Epoch: 5, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.000 Vali Acc: 0.612 Test Loss: 1.000 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.0207533836364746
Epoch: 6, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.908 Vali Acc: 0.691 Test Loss: 0.908 Test Acc: 0.691
Validation loss decreased (-0.611832 --> -0.690780).  Saving model ...
Epoch: 7 cost time: 1.328789234161377
Epoch: 7, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.828 Vali Acc: 0.717 Test Loss: 0.828 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.3099141120910645
Epoch: 8, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.761 Vali Acc: 0.730 Test Loss: 0.761 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.241727590560913
Epoch: 9, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.2664453983306885
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.673 Vali Acc: 0.724 Test Loss: 0.673 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2617676258087158
Epoch: 11, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.294029712677002
Epoch: 12, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.608 Vali Acc: 0.743 Test Loss: 0.608 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2819736003875732
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0903675556182861
Epoch: 14, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.571 Vali Acc: 0.757 Test Loss: 0.571 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.2837634086608887
Epoch: 15, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.1380963325500488
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1324365139007568
Epoch: 17, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.540 Vali Acc: 0.750 Test Loss: 0.540 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1667132377624512
Epoch: 18, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 19 cost time: 1.127826452255249
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.530 Vali Acc: 0.763 Test Loss: 0.530 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9969878196716309
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 21 cost time: 1.0872645378112793
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 22 cost time: 1.1027400493621826
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 23 cost time: 1.2315654754638672
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 24 cost time: 1.1889898777008057
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1956465244293213
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.301091194152832
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 1.1155710220336914
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.165010690689087
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1449947357177734
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0602567195892334
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.170729637145996
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 1.1471939086914062
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2752299308776855
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0730342864990234
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1441316604614258
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1755993366241455
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2351679801940918
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2508676052093506
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1396734714508057
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.097867727279663
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3216116428375244
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 76292
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0832417011260986
Epoch: 1, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.352 Vali Acc: 0.316 Test Loss: 1.352 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.9979503154754639
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.306 Vali Acc: 0.368 Test Loss: 1.306 Test Acc: 0.368
Validation loss decreased (-0.315776 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.053206205368042
Epoch: 3, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.239 Vali Acc: 0.421 Test Loss: 1.239 Test Acc: 0.421
Validation loss decreased (-0.368408 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.0936274528503418
Epoch: 4, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.158 Vali Acc: 0.507 Test Loss: 1.158 Test Acc: 0.507
Validation loss decreased (-0.421040 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 1.0100595951080322
Epoch: 5, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.081 Vali Acc: 0.566 Test Loss: 1.081 Test Acc: 0.566
Validation loss decreased (-0.506567 --> -0.565779).  Saving model ...
Epoch: 6 cost time: 0.9213030338287354
Epoch: 6, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.997 Vali Acc: 0.625 Test Loss: 0.997 Test Acc: 0.625
Validation loss decreased (-0.565779 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.0678491592407227
Epoch: 7, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.918 Vali Acc: 0.664 Test Loss: 0.918 Test Acc: 0.664
Validation loss decreased (-0.624990 --> -0.664465).  Saving model ...
Epoch: 8 cost time: 0.9350781440734863
Epoch: 8, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.847 Vali Acc: 0.671 Test Loss: 0.847 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 0.7912478446960449
Epoch: 9, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.786 Vali Acc: 0.704 Test Loss: 0.786 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 10 cost time: 0.8330767154693604
Epoch: 10, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.734 Vali Acc: 0.704 Test Loss: 0.734 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 1.032667636871338
Epoch: 11, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.691 Vali Acc: 0.711 Test Loss: 0.691 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 0.9669911861419678
Epoch: 12, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.657 Vali Acc: 0.711 Test Loss: 0.657 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710520).  Saving model ...
Epoch: 13 cost time: 1.050992488861084
Epoch: 13, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
Validation loss decreased (-0.710520 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 1.094930648803711
Epoch: 14, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 0.8395986557006836
Epoch: 15, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.11262845993042
Epoch: 16, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.119642734527588
Epoch: 17, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.0966358184814453
Epoch: 18, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.0798439979553223
Epoch: 19, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0896084308624268
Epoch: 20, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 21 cost time: 0.9011647701263428
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9982030391693115
Epoch: 22, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1324479579925537
Epoch: 23, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0876069068908691
Epoch: 24, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2470343112945557
Epoch: 25, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.486 Vali Acc: 0.776 Test Loss: 0.486 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0668563842773438
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.485 Vali Acc: 0.783 Test Loss: 0.485 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.033865213394165
Epoch: 27, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0340709686279297
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.487 Vali Acc: 0.776 Test Loss: 0.487 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2063648700714111
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.489 Vali Acc: 0.776 Test Loss: 0.489 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8998816013336182
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 72516
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2515881061553955
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.420 Vali Acc: 0.230 Test Loss: 1.420 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.1678466796875
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.374 Vali Acc: 0.296 Test Loss: 1.374 Test Acc: 0.296
Validation loss decreased (-0.230249 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 0.9692599773406982
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.299 Vali Acc: 0.428 Test Loss: 1.299 Test Acc: 0.428
Validation loss decreased (-0.296039 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.0406513214111328
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.213 Vali Acc: 0.539 Test Loss: 1.213 Test Acc: 0.539
Validation loss decreased (-0.427619 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.014312744140625
Epoch: 5, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.125 Vali Acc: 0.618 Test Loss: 1.125 Test Acc: 0.618
Validation loss decreased (-0.539462 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.1283257007598877
Epoch: 6, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.043 Vali Acc: 0.645 Test Loss: 1.043 Test Acc: 0.645
Validation loss decreased (-0.618410 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 1.1039938926696777
Epoch: 7, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.963 Vali Acc: 0.638 Test Loss: 0.963 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2631540298461914
Epoch: 8, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.896 Vali Acc: 0.664 Test Loss: 0.896 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664465).  Saving model ...
Epoch: 9 cost time: 1.0881984233856201
Epoch: 9, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.826 Vali Acc: 0.691 Test Loss: 0.826 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.0422296524047852
Epoch: 10, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.768 Vali Acc: 0.711 Test Loss: 0.768 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.0854103565216064
Epoch: 11, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.726 Vali Acc: 0.717 Test Loss: 0.726 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 0.9853003025054932
Epoch: 12, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 1.2482595443725586
Epoch: 13, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.652 Vali Acc: 0.737 Test Loss: 0.652 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 0.9988152980804443
Epoch: 14, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 15 cost time: 1.1864795684814453
Epoch: 15, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.606 Vali Acc: 0.737 Test Loss: 0.606 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 16 cost time: 0.9508390426635742
Epoch: 16, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 17 cost time: 1.03273344039917
Epoch: 17, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.572 Vali Acc: 0.750 Test Loss: 0.572 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 0.8693323135375977
Epoch: 18, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.556 Vali Acc: 0.750 Test Loss: 0.556 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 1.1151385307312012
Epoch: 19, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.544 Vali Acc: 0.757 Test Loss: 0.544 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756574).  Saving model ...
Epoch: 20 cost time: 1.1056196689605713
Epoch: 20, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.532 Vali Acc: 0.757 Test Loss: 0.532 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 21 cost time: 1.0466742515563965
Epoch: 21, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 22 cost time: 0.9069337844848633
Epoch: 22, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 23 cost time: 1.0366482734680176
Epoch: 23, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.515 Vali Acc: 0.763 Test Loss: 0.515 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4053421020507812
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.511 Vali Acc: 0.763 Test Loss: 0.511 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2622358798980713
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.507 Vali Acc: 0.763 Test Loss: 0.507 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2287495136260986
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.504 Vali Acc: 0.763 Test Loss: 0.504 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3188652992248535
Epoch: 27, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.501 Vali Acc: 0.770 Test Loss: 0.501 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 28 cost time: 1.2421479225158691
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.501 Vali Acc: 0.770 Test Loss: 0.501 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 29 cost time: 1.0087926387786865
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789469).  Saving model ...
Epoch: 30 cost time: 1.1665260791778564
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0638675689697266
Epoch: 31, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2199995517730713
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9384613037109375
Epoch: 33, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 34 cost time: 1.0159635543823242
Epoch: 34, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9611320495605469
Epoch: 35, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2970759868621826
Epoch: 36, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 37 cost time: 1.15702486038208
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2330670356750488
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2166504859924316
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2164785861968994
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2828319072723389
Epoch: 41, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.319998025894165
Epoch: 42, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2822434902191162
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1991543769836426
Epoch: 44, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3727962970733643
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2690656185150146
Epoch: 46, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 72548
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6444802284240723
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.8613588809967041
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
Validation loss decreased (-0.243407 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 0.9329042434692383
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.335 Vali Acc: 0.375 Test Loss: 1.335 Test Acc: 0.375
Validation loss decreased (-0.269723 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.0020978450775146
Epoch: 4, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.271 Vali Acc: 0.421 Test Loss: 1.271 Test Acc: 0.421
Validation loss decreased (-0.374987 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 0.9849104881286621
Epoch: 5, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.202 Vali Acc: 0.526 Test Loss: 1.202 Test Acc: 0.526
Validation loss decreased (-0.421040 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 1.0063645839691162
Epoch: 6, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.135 Vali Acc: 0.559 Test Loss: 1.135 Test Acc: 0.559
Validation loss decreased (-0.526304 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 1.0102355480194092
Epoch: 7, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.067 Vali Acc: 0.599 Test Loss: 1.067 Test Acc: 0.599
Validation loss decreased (-0.559199 --> -0.598674).  Saving model ...
Epoch: 8 cost time: 0.9960050582885742
Epoch: 8, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.001 Vali Acc: 0.632 Test Loss: 1.001 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631569).  Saving model ...
Epoch: 9 cost time: 0.9765357971191406
Epoch: 9, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.941 Vali Acc: 0.645 Test Loss: 0.941 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644727).  Saving model ...
Epoch: 10 cost time: 0.8782322406768799
Epoch: 10, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.887 Vali Acc: 0.658 Test Loss: 0.887 Test Acc: 0.658
Validation loss decreased (-0.644727 --> -0.657886).  Saving model ...
Epoch: 11 cost time: 0.9810061454772949
Epoch: 11, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.836 Vali Acc: 0.671 Test Loss: 0.836 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 12 cost time: 1.1287918090820312
Epoch: 12, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.794 Vali Acc: 0.684 Test Loss: 0.794 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684203).  Saving model ...
Epoch: 13 cost time: 0.9716897010803223
Epoch: 13, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.758 Vali Acc: 0.697 Test Loss: 0.758 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 14 cost time: 1.0306382179260254
Epoch: 14, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 15 cost time: 0.9938888549804688
Epoch: 15, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.701 Vali Acc: 0.711 Test Loss: 0.701 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0480067729949951
Epoch: 16, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.675 Vali Acc: 0.724 Test Loss: 0.675 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 1.1039402484893799
Epoch: 17, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 18 cost time: 0.9907948970794678
Epoch: 18, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.639 Vali Acc: 0.757 Test Loss: 0.639 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 19 cost time: 1.0772075653076172
Epoch: 19, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 0.8819022178649902
Epoch: 20, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.047316551208496
Epoch: 21, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1635198593139648
Epoch: 22, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.850165843963623
Epoch: 23, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9953262805938721
Epoch: 24, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.564 Vali Acc: 0.770 Test Loss: 0.564 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8436846733093262
Epoch: 25, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 0.997704029083252
Epoch: 26, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.174422025680542
Epoch: 27, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9217021465301514
Epoch: 28, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.2486929893493652
Epoch: 29, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0447328090667725
Epoch: 30, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.105243444442749
Epoch: 31, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 1.0632774829864502
Epoch: 32, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9225673675537109
Epoch: 33, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 34 cost time: 0.9033424854278564
Epoch: 34, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 35 cost time: 0.985783576965332
Epoch: 35, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 36 cost time: 0.9501831531524658
Epoch: 36, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.00132155418396
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.534 Vali Acc: 0.822 Test Loss: 0.534 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 38 cost time: 1.0178277492523193
Epoch: 38, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9140124320983887
Epoch: 39, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0524468421936035
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.418609857559204
Epoch: 41, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2109534740447998
Epoch: 42, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0366771221160889
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1665458679199219
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1489484310150146
Epoch: 45, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.2342560291290283
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.577 Vali Acc: 0.809 Test Loss: 0.577 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1602559089660645
Epoch: 47, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 70308
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.257028818130493
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.386 Vali Acc: 0.296 Test Loss: 1.386 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.4972028732299805
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.336 Vali Acc: 0.368 Test Loss: 1.336 Test Acc: 0.368
Validation loss decreased (-0.296039 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.3704841136932373
Epoch: 3, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.237 Vali Acc: 0.487 Test Loss: 1.237 Test Acc: 0.487
Validation loss decreased (-0.368408 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 1.5248711109161377
Epoch: 4, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.097 Vali Acc: 0.618 Test Loss: 1.097 Test Acc: 0.618
Validation loss decreased (-0.486830 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 1.347177267074585
Epoch: 5, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.945 Vali Acc: 0.651 Test Loss: 0.945 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.3015904426574707
Epoch: 6, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.799 Vali Acc: 0.711 Test Loss: 0.799 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.1873548030853271
Epoch: 7, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.677 Vali Acc: 0.750 Test Loss: 0.677 Test Acc: 0.750
Validation loss decreased (-0.710518 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.1963975429534912
Epoch: 8, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 0.9912300109863281
Epoch: 9, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.561 Vali Acc: 0.743 Test Loss: 0.561 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4291048049926758
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.545 Vali Acc: 0.750 Test Loss: 0.545 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4372978210449219
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 12 cost time: 1.308136224746704
Epoch: 12, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.553 Vali Acc: 0.763 Test Loss: 0.553 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.2891099452972412
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.264620304107666
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4499776363372803
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.4693381786346436
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.6131680011749268
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.518897533416748
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5244419574737549
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7765662670135498
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.618166446685791
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3722858428955078
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 23 cost time: 1.4555037021636963
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.681 Vali Acc: 0.796 Test Loss: 0.681 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7305588722229004
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.686 Vali Acc: 0.796 Test Loss: 0.686 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5648009777069092
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.697 Vali Acc: 0.796 Test Loss: 0.697 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7933287620544434
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 27 cost time: 1.5078659057617188
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7375295162200928
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7645702362060547
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.726 Vali Acc: 0.803 Test Loss: 0.726 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6258196830749512
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4075379371643066
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4076011180877686
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.753 Vali Acc: 0.803 Test Loss: 0.753 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6571359634399414
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.803 Test Loss: 0.758 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2430787086486816
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.486947774887085
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5976223945617676
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.803 Test Loss: 0.782 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 632004
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.431816577911377
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.357 Vali Acc: 0.355 Test Loss: 1.357 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.3687634468078613
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.285 Vali Acc: 0.599 Test Loss: 1.285 Test Acc: 0.599
Validation loss decreased (-0.355250 --> -0.598671).  Saving model ...
Epoch: 3 cost time: 1.4459714889526367
Epoch: 3, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.166 Vali Acc: 0.618 Test Loss: 1.166 Test Acc: 0.618
Validation loss decreased (-0.598671 --> -0.618409).  Saving model ...
Epoch: 4 cost time: 1.6292438507080078
Epoch: 4, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.027 Vali Acc: 0.658 Test Loss: 1.027 Test Acc: 0.658
Validation loss decreased (-0.618409 --> -0.657884).  Saving model ...
Epoch: 5 cost time: 1.7070250511169434
Epoch: 5, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.870 Vali Acc: 0.711 Test Loss: 0.870 Test Acc: 0.711
Validation loss decreased (-0.657884 --> -0.710518).  Saving model ...
Epoch: 6 cost time: 1.7880759239196777
Epoch: 6, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.740 Vali Acc: 0.730 Test Loss: 0.740 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.5541601181030273
Epoch: 7, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.5919699668884277
Epoch: 8, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.2385361194610596
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.534 Vali Acc: 0.737 Test Loss: 0.534 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3685250282287598
Epoch: 10, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.517 Vali Acc: 0.750 Test Loss: 0.517 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 11 cost time: 1.3732407093048096
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.507 Vali Acc: 0.770 Test Loss: 0.507 Test Acc: 0.770
Validation loss decreased (-0.749995 --> -0.769732).  Saving model ...
Epoch: 12 cost time: 1.4365622997283936
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.769732 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.5371770858764648
Epoch: 13, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5018134117126465
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6339538097381592
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6816554069519043
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6018517017364502
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7269747257232666
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.565 Vali Acc: 0.809 Test Loss: 0.565 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 1.5990626811981201
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5935609340667725
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8117730617523193
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.694969654083252
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7148127555847168
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8604354858398438
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6024019718170166
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7831079959869385
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6209611892700195
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.809 Test Loss: 0.655 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.761143445968628
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 632036
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7453298568725586
Epoch: 1, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.379 Vali Acc: 0.362 Test Loss: 1.379 Test Acc: 0.362
Validation loss decreased (inf --> -0.361828).  Saving model ...
Epoch: 2 cost time: 1.398824691772461
Epoch: 2, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.332 Vali Acc: 0.428 Test Loss: 1.332 Test Acc: 0.428
Validation loss decreased (-0.361828 --> -0.427618).  Saving model ...
Epoch: 3 cost time: 1.3679580688476562
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.255 Vali Acc: 0.533 Test Loss: 1.255 Test Acc: 0.533
Validation loss decreased (-0.427618 --> -0.532882).  Saving model ...
Epoch: 4 cost time: 1.7371008396148682
Epoch: 4, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.164 Vali Acc: 0.586 Test Loss: 1.164 Test Acc: 0.586
Validation loss decreased (-0.532882 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.6845290660858154
Epoch: 5, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.067 Vali Acc: 0.618 Test Loss: 1.067 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.5595970153808594
Epoch: 6, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.964 Vali Acc: 0.651 Test Loss: 0.964 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 1.7740156650543213
Epoch: 7, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.871 Vali Acc: 0.671 Test Loss: 0.871 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671044).  Saving model ...
Epoch: 8 cost time: 1.4986121654510498
Epoch: 8, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.776 Vali Acc: 0.711 Test Loss: 0.776 Test Acc: 0.711
Validation loss decreased (-0.671044 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.7748148441314697
Epoch: 9, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.691 Vali Acc: 0.770 Test Loss: 0.691 Test Acc: 0.770
Validation loss decreased (-0.710519 --> -0.769730).  Saving model ...
Epoch: 10 cost time: 1.5242865085601807
Epoch: 10, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 11 cost time: 1.5043339729309082
Epoch: 11, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.81205153465271
Epoch: 12, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.5813043117523193
Epoch: 13, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.6504886150360107
Epoch: 14, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.488 Vali Acc: 0.803 Test Loss: 0.488 Test Acc: 0.803
Validation loss decreased (-0.782890 --> -0.802627).  Saving model ...
Epoch: 15 cost time: 1.5570881366729736
Epoch: 15, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.478 Vali Acc: 0.796 Test Loss: 0.478 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5130712985992432
Epoch: 16, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.477 Vali Acc: 0.789 Test Loss: 0.477 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6964266300201416
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.481 Vali Acc: 0.789 Test Loss: 0.481 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4346439838409424
Epoch: 18, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.481 Vali Acc: 0.796 Test Loss: 0.481 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6475660800933838
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2836365699768066
Epoch: 20, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.636098861694336
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4028432369232178
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.517 Vali Acc: 0.803 Test Loss: 0.517 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4291377067565918
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6558096408843994
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 619780
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.587484121322632
Epoch: 1, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.365 Vali Acc: 0.270 Test Loss: 1.365 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.495307445526123
Epoch: 2, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.317 Vali Acc: 0.388 Test Loss: 1.317 Test Acc: 0.388
Validation loss decreased (-0.269723 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.858790397644043
Epoch: 3, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.245 Vali Acc: 0.546 Test Loss: 1.245 Test Acc: 0.546
Validation loss decreased (-0.388145 --> -0.546040).  Saving model ...
Epoch: 4 cost time: 1.446838617324829
Epoch: 4, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.163 Vali Acc: 0.599 Test Loss: 1.163 Test Acc: 0.599
Validation loss decreased (-0.546040 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.4796218872070312
Epoch: 5, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.070 Vali Acc: 0.651 Test Loss: 1.070 Test Acc: 0.651
Validation loss decreased (-0.598673 --> -0.651305).  Saving model ...
Epoch: 6 cost time: 1.6901137828826904
Epoch: 6, Steps: 10 | Train Loss: 0.872 Vali Loss: 0.977 Vali Acc: 0.658 Test Loss: 0.977 Test Acc: 0.658
Validation loss decreased (-0.651305 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.3847575187683105
Epoch: 7, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.876 Vali Acc: 0.684 Test Loss: 0.876 Test Acc: 0.684
Validation loss decreased (-0.657885 --> -0.684202).  Saving model ...
Epoch: 8 cost time: 1.4840848445892334
Epoch: 8, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.787 Vali Acc: 0.724 Test Loss: 0.787 Test Acc: 0.724
Validation loss decreased (-0.684202 --> -0.723676).  Saving model ...
Epoch: 9 cost time: 1.3428034782409668
Epoch: 9, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.707 Vali Acc: 0.724 Test Loss: 0.707 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.4450054168701172
Epoch: 10, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.651 Vali Acc: 0.737 Test Loss: 0.651 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.4826209545135498
Epoch: 11, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.6140823364257812
Epoch: 12, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.6833810806274414
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.551 Vali Acc: 0.763 Test Loss: 0.551 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.521977186203003
Epoch: 14, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 15 cost time: 1.636127233505249
Epoch: 15, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.518 Vali Acc: 0.750 Test Loss: 0.518 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5722362995147705
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.511 Vali Acc: 0.757 Test Loss: 0.511 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.809091567993164
Epoch: 17, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.512 Vali Acc: 0.757 Test Loss: 0.512 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7616784572601318
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 19 cost time: 1.5583860874176025
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.788323163986206
Epoch: 20, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4477880001068115
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.534144639968872
Epoch: 22, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5744214057922363
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.583465576171875
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5889363288879395
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.6246588230133057
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6704177856445312
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.610 Vali Acc: 0.776 Test Loss: 0.610 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8946764469146729
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5805552005767822
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6420402526855469
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.645 Vali Acc: 0.776 Test Loss: 0.645 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4413299560546875
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9792802333831787
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 33 cost time: 1.5667853355407715
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6242475509643555
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.783 Test Loss: 0.691 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6191151142120361
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5015578269958496
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 37 cost time: 1.483278512954712
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.730 Vali Acc: 0.796 Test Loss: 0.730 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.614804744720459
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3862924575805664
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.755 Vali Acc: 0.796 Test Loss: 0.755 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4322490692138672
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.752 Vali Acc: 0.796 Test Loss: 0.752 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4031648635864258
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.764 Vali Acc: 0.796 Test Loss: 0.764 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3787693977355957
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4761383533477783
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.789 Test Loss: 0.804 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.7329366207122803
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.789 Test Loss: 0.815 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.367354393005371
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.823 Vali Acc: 0.796 Test Loss: 0.823 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.5078585147857666
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.826 Vali Acc: 0.789 Test Loss: 0.826 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 616772
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.731022834777832
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.365 Vali Acc: 0.250 Test Loss: 1.365 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.3149123191833496
Epoch: 2, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.320 Vali Acc: 0.454 Test Loss: 1.320 Test Acc: 0.454
Validation loss decreased (-0.249986 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.4121196269989014
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.253 Vali Acc: 0.612 Test Loss: 1.253 Test Acc: 0.612
Validation loss decreased (-0.453934 --> -0.611830).  Saving model ...
Epoch: 4 cost time: 1.3095078468322754
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.178 Vali Acc: 0.638 Test Loss: 1.178 Test Acc: 0.638
Validation loss decreased (-0.611830 --> -0.638146).  Saving model ...
Epoch: 5 cost time: 1.3688926696777344
Epoch: 5, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.098 Vali Acc: 0.684 Test Loss: 1.098 Test Acc: 0.684
Validation loss decreased (-0.638146 --> -0.684200).  Saving model ...
Epoch: 6 cost time: 1.4047787189483643
Epoch: 6, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.015 Vali Acc: 0.717 Test Loss: 1.015 Test Acc: 0.717
Validation loss decreased (-0.684200 --> -0.717095).  Saving model ...
Epoch: 7 cost time: 1.2617008686065674
Epoch: 7, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.929 Vali Acc: 0.737 Test Loss: 0.929 Test Acc: 0.737
Validation loss decreased (-0.717095 --> -0.736833).  Saving model ...
Epoch: 8 cost time: 1.397505283355713
Epoch: 8, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.845 Vali Acc: 0.724 Test Loss: 0.845 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2971241474151611
Epoch: 9, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.771 Vali Acc: 0.724 Test Loss: 0.771 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8206067085266113
Epoch: 10, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.708 Vali Acc: 0.743 Test Loss: 0.708 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743414).  Saving model ...
Epoch: 11 cost time: 1.51613187789917
Epoch: 11, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 12 cost time: 1.7478721141815186
Epoch: 12, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.4007155895233154
Epoch: 13, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.7648265361785889
Epoch: 14, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.441645860671997
Epoch: 15, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3169360160827637
Epoch: 16, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.501298427581787
Epoch: 17, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4373867511749268
Epoch: 18, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.05424427986145
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5617766380310059
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3538627624511719
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.4891626834869385
Epoch: 22, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4861774444580078
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4464523792266846
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3692328929901123
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5987458229064941
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4292051792144775
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6070880889892578
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4306557178497314
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5586864948272705
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3431756496429443
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.615 Vali Acc: 0.796 Test Loss: 0.615 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 616804
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.358644962310791
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.418 Vali Acc: 0.164 Test Loss: 1.418 Test Acc: 0.164
Validation loss decreased (inf --> -0.164460).  Saving model ...
Epoch: 2 cost time: 1.3541927337646484
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.401 Vali Acc: 0.237 Test Loss: 1.401 Test Acc: 0.237
Validation loss decreased (-0.164460 --> -0.236828).  Saving model ...
Epoch: 3 cost time: 1.4580321311950684
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.236828 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.394294023513794
Epoch: 4, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.300 Vali Acc: 0.487 Test Loss: 1.300 Test Acc: 0.487
Validation loss decreased (-0.374986 --> -0.486829).  Saving model ...
Epoch: 5 cost time: 1.4494647979736328
Epoch: 5, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.229 Vali Acc: 0.592 Test Loss: 1.229 Test Acc: 0.592
Validation loss decreased (-0.486829 --> -0.592093).  Saving model ...
Epoch: 6 cost time: 1.3812754154205322
Epoch: 6, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.152 Vali Acc: 0.651 Test Loss: 1.152 Test Acc: 0.651
Validation loss decreased (-0.592093 --> -0.651304).  Saving model ...
Epoch: 7 cost time: 1.4721179008483887
Epoch: 7, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.070 Vali Acc: 0.678 Test Loss: 1.070 Test Acc: 0.678
Validation loss decreased (-0.651304 --> -0.677621).  Saving model ...
Epoch: 8 cost time: 1.3945415019989014
Epoch: 8, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.987 Vali Acc: 0.711 Test Loss: 0.987 Test Acc: 0.711
Validation loss decreased (-0.677621 --> -0.710516).  Saving model ...
Epoch: 9 cost time: 1.3404524326324463
Epoch: 9, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.905 Vali Acc: 0.730 Test Loss: 0.905 Test Acc: 0.730
Validation loss decreased (-0.710516 --> -0.730254).  Saving model ...
Epoch: 10 cost time: 1.298227310180664
Epoch: 10, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.828 Vali Acc: 0.757 Test Loss: 0.828 Test Acc: 0.757
Validation loss decreased (-0.730254 --> -0.756571).  Saving model ...
Epoch: 11 cost time: 1.3329987525939941
Epoch: 11, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763150).  Saving model ...
Epoch: 12 cost time: 1.3350496292114258
Epoch: 12, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.696 Vali Acc: 0.770 Test Loss: 0.696 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 13 cost time: 1.3077728748321533
Epoch: 13, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 1.3216917514801025
Epoch: 14, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3756277561187744
Epoch: 15, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.475755214691162
Epoch: 16, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.4097034931182861
Epoch: 17, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 1.390105962753296
Epoch: 18, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.500 Vali Acc: 0.763 Test Loss: 0.500 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.195570945739746
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.491 Vali Acc: 0.770 Test Loss: 0.491 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3578169345855713
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.488 Vali Acc: 0.776 Test Loss: 0.488 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3398356437683105
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.486 Vali Acc: 0.776 Test Loss: 0.486 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3772602081298828
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.488 Vali Acc: 0.770 Test Loss: 0.488 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3308732509613037
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 24 cost time: 1.388061285018921
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 25 cost time: 1.4937450885772705
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 26 cost time: 1.404085397720337
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 27 cost time: 1.4725162982940674
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4759550094604492
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4002070426940918
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.557 Vali Acc: 0.816 Test Loss: 0.557 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 30 cost time: 1.5592460632324219
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5695559978485107
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3182947635650635
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4561541080474854
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.379870891571045
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4668967723846436
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3357939720153809
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2771997451782227
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.809 Test Loss: 0.676 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.551236867904663
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.4432373046875
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 613796
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4224367141723633
Epoch: 1, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.356 Vali Acc: 0.414 Test Loss: 1.356 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 1.5015015602111816
Epoch: 2, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.290 Vali Acc: 0.559 Test Loss: 1.290 Test Acc: 0.559
Validation loss decreased (-0.414460 --> -0.559198).  Saving model ...
Epoch: 3 cost time: 1.5438530445098877
Epoch: 3, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.183 Vali Acc: 0.612 Test Loss: 1.183 Test Acc: 0.612
Validation loss decreased (-0.559198 --> -0.611830).  Saving model ...
Epoch: 4 cost time: 1.5142254829406738
Epoch: 4, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.040 Vali Acc: 0.658 Test Loss: 1.040 Test Acc: 0.658
Validation loss decreased (-0.611830 --> -0.657884).  Saving model ...
Epoch: 5 cost time: 1.443871259689331
Epoch: 5, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.888 Vali Acc: 0.691 Test Loss: 0.888 Test Acc: 0.691
Validation loss decreased (-0.657884 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.4139580726623535
Epoch: 6, Steps: 10 | Train Loss: 0.579 Vali Loss: 0.752 Vali Acc: 0.711 Test Loss: 0.752 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 1.5388484001159668
Epoch: 7, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 8 cost time: 1.6435847282409668
Epoch: 8, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.554 Vali Acc: 0.743 Test Loss: 0.554 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743416).  Saving model ...
Epoch: 9 cost time: 1.4259231090545654
Epoch: 9, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.521 Vali Acc: 0.750 Test Loss: 0.521 Test Acc: 0.750
Validation loss decreased (-0.743416 --> -0.749995).  Saving model ...
Epoch: 10 cost time: 1.5016453266143799
Epoch: 10, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.499 Vali Acc: 0.763 Test Loss: 0.499 Test Acc: 0.763
Validation loss decreased (-0.749995 --> -0.763153).  Saving model ...
Epoch: 11 cost time: 1.4624271392822266
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.494 Vali Acc: 0.770 Test Loss: 0.494 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 12 cost time: 1.7709691524505615
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 13 cost time: 1.2954306602478027
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 14 cost time: 1.615645408630371
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.5399765968322754
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.5453593730926514
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.386347770690918
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8913624286651611
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7187504768371582
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.5195868015289307
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5283329486846924
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6253225803375244
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.535365343093872
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3731775283813477
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.546170949935913
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.627 Vali Acc: 0.803 Test Loss: 0.627 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5690157413482666
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4013707637786865
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4177613258361816
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2868025302886963
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 626628
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1232733726501465
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.361 Vali Acc: 0.257 Test Loss: 1.361 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.2291946411132812
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.297 Vali Acc: 0.408 Test Loss: 1.297 Test Acc: 0.408
Validation loss decreased (-0.256565 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.3980536460876465
Epoch: 3, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.182 Vali Acc: 0.507 Test Loss: 1.182 Test Acc: 0.507
Validation loss decreased (-0.407882 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.5534169673919678
Epoch: 4, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.046 Vali Acc: 0.579 Test Loss: 1.046 Test Acc: 0.579
Validation loss decreased (-0.506567 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 1.394568920135498
Epoch: 5, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.900 Vali Acc: 0.645 Test Loss: 0.900 Test Acc: 0.645
Validation loss decreased (-0.578937 --> -0.644728).  Saving model ...
Epoch: 6 cost time: 1.5338776111602783
Epoch: 6, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.749 Vali Acc: 0.711 Test Loss: 0.749 Test Acc: 0.711
Validation loss decreased (-0.644728 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 1.3345811367034912
Epoch: 7, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.639 Vali Acc: 0.743 Test Loss: 0.639 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.3563225269317627
Epoch: 8, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.565 Vali Acc: 0.743 Test Loss: 0.565 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.6190769672393799
Epoch: 9, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 1.4051342010498047
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 1.4793307781219482
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.494 Vali Acc: 0.776 Test Loss: 0.494 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.550705909729004
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 1.6466422080993652
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.554175853729248
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.519 Vali Acc: 0.816 Test Loss: 0.519 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 1.598217487335205
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6312839984893799
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.539503812789917
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3772716522216797
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4596035480499268
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5993762016296387
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.498816967010498
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.218292236328125
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5189495086669922
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.624 Vali Acc: 0.816 Test Loss: 0.624 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6181621551513672
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.822 Test Loss: 0.640 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 25 cost time: 1.3341493606567383
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.816 Test Loss: 0.650 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.446457862854004
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5186216831207275
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.658 Vali Acc: 0.816 Test Loss: 0.658 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6439259052276611
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.668 Vali Acc: 0.816 Test Loss: 0.668 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4635069370269775
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.816 Test Loss: 0.677 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4663994312286377
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.816 Test Loss: 0.688 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3033945560455322
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4328904151916504
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3698210716247559
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.706 Vali Acc: 0.816 Test Loss: 0.706 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.490696668624878
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.816 Test Loss: 0.716 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 626660
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.744727611541748
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.392 Vali Acc: 0.257 Test Loss: 1.392 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.5500166416168213
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.352 Vali Acc: 0.342 Test Loss: 1.352 Test Acc: 0.342
Validation loss decreased (-0.256565 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.3907432556152344
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.284 Vali Acc: 0.480 Test Loss: 1.284 Test Acc: 0.480
Validation loss decreased (-0.342092 --> -0.480250).  Saving model ...
Epoch: 4 cost time: 1.3291327953338623
Epoch: 4, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.197 Vali Acc: 0.599 Test Loss: 1.197 Test Acc: 0.599
Validation loss decreased (-0.480250 --> -0.598672).  Saving model ...
Epoch: 5 cost time: 1.4558079242706299
Epoch: 5, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.106 Vali Acc: 0.612 Test Loss: 1.106 Test Acc: 0.612
Validation loss decreased (-0.598672 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 1.4563100337982178
Epoch: 6, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.009 Vali Acc: 0.645 Test Loss: 1.009 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.5458521842956543
Epoch: 7, Steps: 10 | Train Loss: 0.718 Vali Loss: 0.914 Vali Acc: 0.691 Test Loss: 0.914 Test Acc: 0.691
Validation loss decreased (-0.644727 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 1.598764181137085
Epoch: 8, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.823 Vali Acc: 0.711 Test Loss: 0.823 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 1.6150624752044678
Epoch: 9, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 1.5043447017669678
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.669 Vali Acc: 0.757 Test Loss: 0.669 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.6030306816101074
Epoch: 11, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.618 Vali Acc: 0.776 Test Loss: 0.618 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.5793037414550781
Epoch: 12, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.433631420135498
Epoch: 13, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.557 Vali Acc: 0.763 Test Loss: 0.557 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.406632661819458
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5113179683685303
Epoch: 15, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 16 cost time: 1.6326384544372559
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4725255966186523
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.398674488067627
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 19 cost time: 1.15220046043396
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.3444068431854248
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3434937000274658
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.4401073455810547
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4580295085906982
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.439624309539795
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4986052513122559
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.489461898803711
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3745934963226318
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.610 Vali Acc: 0.796 Test Loss: 0.610 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5213818550109863
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6763741970062256
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.576643705368042
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5551416873931885
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 614404
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.360976457595825
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.379 Vali Acc: 0.263 Test Loss: 1.379 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.4064700603485107
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.338 Vali Acc: 0.329 Test Loss: 1.338 Test Acc: 0.329
Validation loss decreased (-0.263144 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.4465196132659912
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.267 Vali Acc: 0.526 Test Loss: 1.267 Test Acc: 0.526
Validation loss decreased (-0.328934 --> -0.526303).  Saving model ...
Epoch: 4 cost time: 1.2606863975524902
Epoch: 4, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.177 Vali Acc: 0.586 Test Loss: 1.177 Test Acc: 0.586
Validation loss decreased (-0.526303 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.5548944473266602
Epoch: 5, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.080 Vali Acc: 0.645 Test Loss: 1.080 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 6 cost time: 1.370163917541504
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.984 Vali Acc: 0.658 Test Loss: 0.984 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.5256574153900146
Epoch: 7, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.885 Vali Acc: 0.671 Test Loss: 0.885 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 8 cost time: 1.1389312744140625
Epoch: 8, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.794 Vali Acc: 0.691 Test Loss: 0.794 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 9 cost time: 1.5424270629882812
Epoch: 9, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.712 Vali Acc: 0.730 Test Loss: 0.712 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.243316411972046
Epoch: 10, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.649 Vali Acc: 0.737 Test Loss: 0.649 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.3841590881347656
Epoch: 11, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.3451149463653564
Epoch: 12, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.357276439666748
Epoch: 13, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.534 Vali Acc: 0.757 Test Loss: 0.534 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756574).  Saving model ...
Epoch: 14 cost time: 1.1640655994415283
Epoch: 14, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.520 Vali Acc: 0.757 Test Loss: 0.520 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 15 cost time: 1.3553211688995361
Epoch: 15, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.509 Vali Acc: 0.750 Test Loss: 0.509 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3954541683197021
Epoch: 16, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.501 Vali Acc: 0.737 Test Loss: 0.501 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5464866161346436
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.498 Vali Acc: 0.757 Test Loss: 0.498 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 18 cost time: 1.3985874652862549
Epoch: 18, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.502 Vali Acc: 0.770 Test Loss: 0.502 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769732).  Saving model ...
Epoch: 19 cost time: 1.1683440208435059
Epoch: 19, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.502 Vali Acc: 0.757 Test Loss: 0.502 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3654437065124512
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.511 Vali Acc: 0.770 Test Loss: 0.511 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1893784999847412
Epoch: 21, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.265956163406372
Epoch: 22, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.277963399887085
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.2427616119384766
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 1.1293840408325195
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3341827392578125
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3035151958465576
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.117020845413208
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.305598258972168
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.532888412475586
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4405205249786377
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.363219976425171
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3472421169281006
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.60860013961792
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.633 Vali Acc: 0.776 Test Loss: 0.633 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 611396
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5007455348968506
Epoch: 1, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.381 Vali Acc: 0.316 Test Loss: 1.381 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.4244215488433838
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.345 Vali Acc: 0.375 Test Loss: 1.345 Test Acc: 0.375
Validation loss decreased (-0.315776 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.5603876113891602
Epoch: 3, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.6007883548736572
Epoch: 4, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.208 Vali Acc: 0.579 Test Loss: 1.208 Test Acc: 0.579
Validation loss decreased (-0.499987 --> -0.578935).  Saving model ...
Epoch: 5 cost time: 1.3945086002349854
Epoch: 5, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.127 Vali Acc: 0.645 Test Loss: 1.127 Test Acc: 0.645
Validation loss decreased (-0.578935 --> -0.644726).  Saving model ...
Epoch: 6 cost time: 1.5188250541687012
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.042 Vali Acc: 0.684 Test Loss: 1.042 Test Acc: 0.684
Validation loss decreased (-0.644726 --> -0.684200).  Saving model ...
Epoch: 7 cost time: 1.532700777053833
Epoch: 7, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.948 Vali Acc: 0.691 Test Loss: 0.948 Test Acc: 0.691
Validation loss decreased (-0.684200 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 1.4840021133422852
Epoch: 8, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.862 Vali Acc: 0.711 Test Loss: 0.862 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 1.5438766479492188
Epoch: 9, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.775 Vali Acc: 0.757 Test Loss: 0.775 Test Acc: 0.757
Validation loss decreased (-0.710518 --> -0.756571).  Saving model ...
Epoch: 10 cost time: 1.4727518558502197
Epoch: 10, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.713 Vali Acc: 0.770 Test Loss: 0.713 Test Acc: 0.770
Validation loss decreased (-0.756571 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 1.6159675121307373
Epoch: 11, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4198439121246338
Epoch: 12, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4392783641815186
Epoch: 13, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.3157451152801514
Epoch: 14, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.2636277675628662
Epoch: 15, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5052614212036133
Epoch: 16, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.5629551410675049
Epoch: 17, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4672410488128662
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.511 Vali Acc: 0.770 Test Loss: 0.511 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4205069541931152
Epoch: 19, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.511 Vali Acc: 0.770 Test Loss: 0.511 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.455273151397705
Epoch: 20, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 21 cost time: 1.3646690845489502
Epoch: 21, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.461378812789917
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4625284671783447
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4153718948364258
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.418409824371338
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5456418991088867
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4574103355407715
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.4154541492462158
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.718034267425537
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 1.499561071395874
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.333280324935913
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.404994249343872
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3436849117279053
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.569892168045044
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 35 cost time: 1.3923940658569336
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2949671745300293
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.809 Test Loss: 0.646 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4660797119140625
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5780017375946045
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3847708702087402
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.429833173751831
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3272805213928223
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.568598747253418
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.809 Test Loss: 0.711 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.3659248352050781
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.4875149726867676
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.809 Test Loss: 0.728 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 611428
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.615952491760254
Epoch: 1, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.349 Vali Acc: 0.342 Test Loss: 1.349 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.229677677154541
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.309 Vali Acc: 0.454 Test Loss: 1.309 Test Acc: 0.454
Validation loss decreased (-0.342092 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.2163898944854736
Epoch: 3, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.252 Vali Acc: 0.539 Test Loss: 1.252 Test Acc: 0.539
Validation loss decreased (-0.453934 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 1.282884120941162
Epoch: 4, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.188 Vali Acc: 0.599 Test Loss: 1.188 Test Acc: 0.599
Validation loss decreased (-0.539461 --> -0.598672).  Saving model ...
Epoch: 5 cost time: 1.5963232517242432
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.120 Vali Acc: 0.678 Test Loss: 1.120 Test Acc: 0.678
Validation loss decreased (-0.598672 --> -0.677620).  Saving model ...
Epoch: 6 cost time: 1.3601579666137695
Epoch: 6, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.046 Vali Acc: 0.704 Test Loss: 1.046 Test Acc: 0.704
Validation loss decreased (-0.677620 --> -0.703937).  Saving model ...
Epoch: 7 cost time: 1.2304470539093018
Epoch: 7, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.963 Vali Acc: 0.704 Test Loss: 0.963 Test Acc: 0.704
Validation loss decreased (-0.703937 --> -0.703938).  Saving model ...
Epoch: 8 cost time: 1.2257139682769775
Epoch: 8, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.885 Vali Acc: 0.717 Test Loss: 0.885 Test Acc: 0.717
Validation loss decreased (-0.703938 --> -0.717096).  Saving model ...
Epoch: 9 cost time: 1.1843574047088623
Epoch: 9, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.811 Vali Acc: 0.737 Test Loss: 0.811 Test Acc: 0.737
Validation loss decreased (-0.717096 --> -0.736834).  Saving model ...
Epoch: 10 cost time: 1.3461394309997559
Epoch: 10, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.735 Vali Acc: 0.737 Test Loss: 0.735 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.1849663257598877
Epoch: 11, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.666 Vali Acc: 0.743 Test Loss: 0.666 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.2547364234924316
Epoch: 12, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.2158727645874023
Epoch: 13, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.4543747901916504
Epoch: 14, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.3415169715881348
Epoch: 15, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789469).  Saving model ...
Epoch: 16 cost time: 1.3372328281402588
Epoch: 16, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 17 cost time: 1.520324468612671
Epoch: 17, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.469 Vali Acc: 0.789 Test Loss: 0.469 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 18 cost time: 1.3884320259094238
Epoch: 18, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.461 Vali Acc: 0.789 Test Loss: 0.461 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 1.2317168712615967
Epoch: 19, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.461 Vali Acc: 0.783 Test Loss: 0.461 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4532418251037598
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.462 Vali Acc: 0.789 Test Loss: 0.462 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2817234992980957
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.463 Vali Acc: 0.783 Test Loss: 0.463 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3458468914031982
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.468 Vali Acc: 0.770 Test Loss: 0.468 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.430748701095581
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.379453420639038
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.481 Vali Acc: 0.796 Test Loss: 0.481 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 25 cost time: 1.358544111251831
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 26 cost time: 1.2808127403259277
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.491 Vali Acc: 0.803 Test Loss: 0.491 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.333998680114746
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2790358066558838
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 29 cost time: 1.3585669994354248
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3364951610565186
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3253815174102783
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2016031742095947
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.576 Vali Acc: 0.809 Test Loss: 0.576 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3868319988250732
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.591 Vali Acc: 0.816 Test Loss: 0.591 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 34 cost time: 1.2185111045837402
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.596 Vali Acc: 0.816 Test Loss: 0.596 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0944530963897705
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.606 Vali Acc: 0.816 Test Loss: 0.606 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2752265930175781
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4505577087402344
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.822 Test Loss: 0.627 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 38 cost time: 1.3614702224731445
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.645 Vali Acc: 0.822 Test Loss: 0.645 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.232222318649292
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.642 Vali Acc: 0.822 Test Loss: 0.642 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3080418109893799
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.31929612159729
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.655 Vali Acc: 0.822 Test Loss: 0.655 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.423417329788208
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.679 Vali Acc: 0.829 Test Loss: 0.679 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 43 cost time: 1.400862693786621
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.701 Vali Acc: 0.829 Test Loss: 0.701 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4200432300567627
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.822 Test Loss: 0.714 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.358116626739502
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.822 Test Loss: 0.722 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2613892555236816
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.822 Test Loss: 0.724 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2230937480926514
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.829 Test Loss: 0.748 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1961123943328857
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.829 Test Loss: 0.766 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0797231197357178
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.829 Test Loss: 0.775 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2825946807861328
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.829 Test Loss: 0.778 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 608420
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3718881607055664
Epoch: 1, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.262 Vali Acc: 0.526 Test Loss: 1.262 Test Acc: 0.526
Validation loss decreased (inf --> -0.526303).  Saving model ...
Epoch: 2 cost time: 1.7859008312225342
Epoch: 2, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.001 Vali Acc: 0.632 Test Loss: 1.001 Test Acc: 0.632
Validation loss decreased (-0.526303 --> -0.631569).  Saving model ...
Epoch: 3 cost time: 1.7188029289245605
Epoch: 3, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.716 Vali Acc: 0.757 Test Loss: 0.716 Test Acc: 0.757
Validation loss decreased (-0.631569 --> -0.756572).  Saving model ...
Epoch: 4 cost time: 1.562398910522461
Epoch: 4, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.4853475093841553
Epoch: 5, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5407226085662842
Epoch: 6, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789469).  Saving model ...
Epoch: 7 cost time: 1.3911094665527344
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809205).  Saving model ...
Epoch: 8 cost time: 1.4493370056152344
Epoch: 8, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4451429843902588
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4626843929290771
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.822 Test Loss: 0.672 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822362).  Saving model ...
Epoch: 11 cost time: 1.301870584487915
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6935653686523438
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6223976612091064
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5155513286590576
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.816 Test Loss: 0.730 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.568349838256836
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.738 Vali Acc: 0.809 Test Loss: 0.738 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.663322925567627
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.748 Vali Acc: 0.816 Test Loss: 0.748 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5721869468688965
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.809 Test Loss: 0.758 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5679521560668945
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.816 Test Loss: 0.767 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4227542877197266
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.829 Test Loss: 0.777 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828940).  Saving model ...
Epoch: 20 cost time: 1.449171543121338
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.816 Test Loss: 0.782 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3523979187011719
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.816 Test Loss: 0.792 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6569154262542725
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.816 Test Loss: 0.803 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4715235233306885
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.809 Test Loss: 0.810 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6040089130401611
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.809 Test Loss: 0.819 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5814464092254639
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.809 Test Loss: 0.813 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5449166297912598
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.809 Test Loss: 0.825 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6845977306365967
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.816 Test Loss: 0.837 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.690969705581665
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6935184001922607
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.809 Test Loss: 0.851 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 2245380
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9638783931732178
Epoch: 1, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.333 Vali Acc: 0.388 Test Loss: 1.333 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.5991923809051514
Epoch: 2, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.069 Vali Acc: 0.599 Test Loss: 1.069 Test Acc: 0.599
Validation loss decreased (-0.388145 --> -0.598674).  Saving model ...
Epoch: 3 cost time: 1.8160498142242432
Epoch: 3, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.784 Vali Acc: 0.724 Test Loss: 0.784 Test Acc: 0.724
Validation loss decreased (-0.598674 --> -0.723676).  Saving model ...
Epoch: 4 cost time: 1.7631585597991943
Epoch: 4, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736836).  Saving model ...
Epoch: 5 cost time: 1.6837949752807617
Epoch: 5, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.555 Vali Acc: 0.750 Test Loss: 0.555 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 1.8050098419189453
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.7910990715026855
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.9219729900360107
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789467).  Saving model ...
Epoch: 9 cost time: 2.0701165199279785
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7390577793121338
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.724 Vali Acc: 0.789 Test Loss: 0.724 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6430373191833496
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4406280517578125
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.762 Vali Acc: 0.789 Test Loss: 0.762 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5755729675292969
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.789 Test Loss: 0.770 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5159544944763184
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7477695941925049
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.789 Test Loss: 0.794 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7222611904144287
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.789 Test Loss: 0.803 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.577996015548706
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.789 Test Loss: 0.815 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7366671562194824
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 2245508
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7633607387542725
Epoch: 1, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.305 Vali Acc: 0.434 Test Loss: 1.305 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.7403008937835693
Epoch: 2, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.143 Vali Acc: 0.592 Test Loss: 1.143 Test Acc: 0.592
Validation loss decreased (-0.434197 --> -0.592094).  Saving model ...
Epoch: 3 cost time: 1.608112096786499
Epoch: 3, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.951 Vali Acc: 0.678 Test Loss: 0.951 Test Acc: 0.678
Validation loss decreased (-0.592094 --> -0.677622).  Saving model ...
Epoch: 4 cost time: 1.757491111755371
Epoch: 4, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.774 Vali Acc: 0.684 Test Loss: 0.774 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684203).  Saving model ...
Epoch: 5 cost time: 1.6537914276123047
Epoch: 5, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.650 Vali Acc: 0.704 Test Loss: 0.650 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703941).  Saving model ...
Epoch: 6 cost time: 1.4568192958831787
Epoch: 6, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.594 Vali Acc: 0.730 Test Loss: 0.594 Test Acc: 0.730
Validation loss decreased (-0.703941 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 1.4950251579284668
Epoch: 7, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.469897747039795
Epoch: 8, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.7346265316009521
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.6950833797454834
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6738994121551514
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6014180183410645
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.629 Vali Acc: 0.763 Test Loss: 0.629 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.516442060470581
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5687203407287598
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4870047569274902
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.674 Vali Acc: 0.770 Test Loss: 0.674 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.485982894897461
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.776 Test Loss: 0.688 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 17 cost time: 1.7074296474456787
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.770 Test Loss: 0.698 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7783849239349365
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.643298625946045
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.770 Test Loss: 0.724 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7757551670074463
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.776 Test Loss: 0.730 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6995434761047363
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.776 Test Loss: 0.739 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6336479187011719
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.776 Test Loss: 0.751 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.647386074066162
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.762 Vali Acc: 0.770 Test Loss: 0.762 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6720280647277832
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.776 Test Loss: 0.765 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6236906051635742
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.770 Test Loss: 0.773 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8068015575408936
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.776 Test Loss: 0.777 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 2202628
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1951279640197754
Epoch: 1, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.5875401496887207
Epoch: 2, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.4988019466400146
Epoch: 3, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.023 Vali Acc: 0.651 Test Loss: 1.023 Test Acc: 0.651
Validation loss decreased (-0.499988 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 1.5759360790252686
Epoch: 4, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.843 Vali Acc: 0.711 Test Loss: 0.843 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.6462795734405518
Epoch: 5, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.700 Vali Acc: 0.730 Test Loss: 0.700 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 1.5165715217590332
Epoch: 6, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.560532569885254
Epoch: 7, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.542177677154541
Epoch: 8, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.6152064800262451
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.5983998775482178
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.549 Vali Acc: 0.803 Test Loss: 0.549 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.717787265777588
Epoch: 11, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.7233870029449463
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5925393104553223
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.594 Vali Acc: 0.809 Test Loss: 0.594 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7238876819610596
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.593827486038208
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7713263034820557
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6074461936950684
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6948277950286865
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7307178974151611
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.465341567993164
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5737473964691162
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2184452
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.563239574432373
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.346 Vali Acc: 0.408 Test Loss: 1.346 Test Acc: 0.408
Validation loss decreased (inf --> -0.407881).  Saving model ...
Epoch: 2 cost time: 1.5028133392333984
Epoch: 2, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.219 Vali Acc: 0.559 Test Loss: 1.219 Test Acc: 0.559
Validation loss decreased (-0.407881 --> -0.559198).  Saving model ...
Epoch: 3 cost time: 1.412794828414917
Epoch: 3, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.062 Vali Acc: 0.586 Test Loss: 1.062 Test Acc: 0.586
Validation loss decreased (-0.559198 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.4889671802520752
Epoch: 4, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.895 Vali Acc: 0.658 Test Loss: 0.895 Test Acc: 0.658
Validation loss decreased (-0.585516 --> -0.657886).  Saving model ...
Epoch: 5 cost time: 1.3007276058197021
Epoch: 5, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.757 Vali Acc: 0.704 Test Loss: 0.757 Test Acc: 0.704
Validation loss decreased (-0.657886 --> -0.703940).  Saving model ...
Epoch: 6 cost time: 1.3716633319854736
Epoch: 6, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.660 Vali Acc: 0.730 Test Loss: 0.660 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 1.5462229251861572
Epoch: 7, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.605 Vali Acc: 0.743 Test Loss: 0.605 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.4509992599487305
Epoch: 8, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.574 Vali Acc: 0.757 Test Loss: 0.574 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.5226349830627441
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.568011999130249
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.4395766258239746
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.3754565715789795
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5284554958343506
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4952125549316406
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4476661682128906
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5439412593841553
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.647 Vali Acc: 0.789 Test Loss: 0.647 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7218444347381592
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5029089450836182
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4664645195007324
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.796 Test Loss: 0.682 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.581352949142456
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.694 Vali Acc: 0.776 Test Loss: 0.694 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.441983938217163
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 2184580
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5214502811431885
Epoch: 1, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.349 Vali Acc: 0.408 Test Loss: 1.349 Test Acc: 0.408
Validation loss decreased (inf --> -0.407881).  Saving model ...
Epoch: 2 cost time: 1.3739840984344482
Epoch: 2, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.232 Vali Acc: 0.612 Test Loss: 1.232 Test Acc: 0.612
Validation loss decreased (-0.407881 --> -0.611830).  Saving model ...
Epoch: 3 cost time: 1.3826344013214111
Epoch: 3, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.070 Vali Acc: 0.664 Test Loss: 1.070 Test Acc: 0.664
Validation loss decreased (-0.611830 --> -0.664463).  Saving model ...
Epoch: 4 cost time: 1.3232882022857666
Epoch: 4, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.903 Vali Acc: 0.704 Test Loss: 0.903 Test Acc: 0.704
Validation loss decreased (-0.664463 --> -0.703938).  Saving model ...
Epoch: 5 cost time: 1.4838285446166992
Epoch: 5, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.753 Vali Acc: 0.757 Test Loss: 0.753 Test Acc: 0.757
Validation loss decreased (-0.703938 --> -0.756571).  Saving model ...
Epoch: 6 cost time: 1.4449405670166016
Epoch: 6, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.756571 --> -0.763151).  Saving model ...
Epoch: 7 cost time: 1.3470981121063232
Epoch: 7, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.4099938869476318
Epoch: 8, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4268193244934082
Epoch: 9, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3536760807037354
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5342259407043457
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.536 Vali Acc: 0.770 Test Loss: 0.536 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.393420696258545
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.6090376377105713
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.6003427505493164
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4430301189422607
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.4997363090515137
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.51993727684021
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4452564716339111
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5130689144134521
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.636 Vali Acc: 0.809 Test Loss: 0.636 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 20 cost time: 1.5672924518585205
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.470893383026123
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1817123889923096
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2990117073059082
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4078612327575684
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.809 Test Loss: 0.690 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4682867527008057
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.518545150756836
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4743049144744873
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4098989963531494
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.734 Vali Acc: 0.796 Test Loss: 0.734 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4929900169372559
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.803 Test Loss: 0.747 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2178692
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.006174087524414
Epoch: 1, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.333 Vali Acc: 0.434 Test Loss: 1.333 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.2129008769989014
Epoch: 2, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.206 Vali Acc: 0.605 Test Loss: 1.206 Test Acc: 0.605
Validation loss decreased (-0.434197 --> -0.605251).  Saving model ...
Epoch: 3 cost time: 1.2177934646606445
Epoch: 3, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.035 Vali Acc: 0.658 Test Loss: 1.035 Test Acc: 0.658
Validation loss decreased (-0.605251 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 1.276482343673706
Epoch: 4, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.833 Vali Acc: 0.704 Test Loss: 0.833 Test Acc: 0.704
Validation loss decreased (-0.657884 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.3235161304473877
Epoch: 5, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.667 Vali Acc: 0.743 Test Loss: 0.667 Test Acc: 0.743
Validation loss decreased (-0.703939 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 1.351597547531128
Epoch: 6, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.3355598449707031
Epoch: 7, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.4190821647644043
Epoch: 8, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796048).  Saving model ...
Epoch: 9 cost time: 1.217921257019043
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3384804725646973
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.4517319202423096
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.548 Vali Acc: 0.816 Test Loss: 0.548 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 12 cost time: 1.352407693862915
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.568 Vali Acc: 0.816 Test Loss: 0.568 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2892851829528809
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3487286567687988
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4024600982666016
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.611 Vali Acc: 0.822 Test Loss: 0.611 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 16 cost time: 1.5250582695007324
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.288874626159668
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.261904001235962
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3001453876495361
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2391784191131592
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.816 Test Loss: 0.677 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4772961139678955
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3624238967895508
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3182189464569092
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.809 Test Loss: 0.707 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4190902709960938
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.816 Test Loss: 0.710 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5328700542449951
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.715 Vali Acc: 0.816 Test Loss: 0.715 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 614788
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.200570583343506
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.354 Vali Acc: 0.375 Test Loss: 1.354 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 1.140817642211914
Epoch: 2, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.207 Vali Acc: 0.566 Test Loss: 1.207 Test Acc: 0.566
Validation loss decreased (-0.374986 --> -0.565777).  Saving model ...
Epoch: 3 cost time: 1.0702872276306152
Epoch: 3, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.014 Vali Acc: 0.651 Test Loss: 1.014 Test Acc: 0.651
Validation loss decreased (-0.565777 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 1.2065601348876953
Epoch: 4, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.825 Vali Acc: 0.671 Test Loss: 0.825 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 1.1862874031066895
Epoch: 5, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.679 Vali Acc: 0.730 Test Loss: 0.679 Test Acc: 0.730
Validation loss decreased (-0.671044 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 1.2477617263793945
Epoch: 6, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.328704833984375
Epoch: 7, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.3008601665496826
Epoch: 8, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.174009084701538
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.3493287563323975
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3513274192810059
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4150893688201904
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4453938007354736
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 14 cost time: 1.2072386741638184
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.321099042892456
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.796 Test Loss: 0.662 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2886273860931396
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2048888206481934
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2977490425109863
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.404841423034668
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.809 Test Loss: 0.696 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 20 cost time: 1.1044762134552002
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.803 Test Loss: 0.705 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.15647554397583
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.721 Vali Acc: 0.809 Test Loss: 0.721 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2978613376617432
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.732 Vali Acc: 0.809 Test Loss: 0.732 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1629550457000732
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.803 Test Loss: 0.739 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2100160121917725
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3071410655975342
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.163893699645996
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.803 Test Loss: 0.765 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2466232776641846
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3546781539916992
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.803 Test Loss: 0.783 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3532662391662598
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.803 Test Loss: 0.790 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 614852
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9085144996643066
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.368 Vali Acc: 0.296 Test Loss: 1.368 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.1130354404449463
Epoch: 2, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.276 Vali Acc: 0.447 Test Loss: 1.276 Test Acc: 0.447
Validation loss decreased (-0.296039 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 1.1796269416809082
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.150 Vali Acc: 0.559 Test Loss: 1.150 Test Acc: 0.559
Validation loss decreased (-0.447356 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.2412681579589844
Epoch: 4, Steps: 10 | Train Loss: 0.948 Vali Loss: 1.013 Vali Acc: 0.625 Test Loss: 1.013 Test Acc: 0.625
Validation loss decreased (-0.559199 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 1.3721163272857666
Epoch: 5, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.884 Vali Acc: 0.658 Test Loss: 0.884 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.1714043617248535
Epoch: 6, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.766 Vali Acc: 0.724 Test Loss: 0.766 Test Acc: 0.724
Validation loss decreased (-0.657886 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.1988701820373535
Epoch: 7, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.673 Vali Acc: 0.730 Test Loss: 0.673 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.1942863464355469
Epoch: 8, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.3774526119232178
Epoch: 9, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.129155158996582
Epoch: 10, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 11 cost time: 1.2567214965820312
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.535 Vali Acc: 0.743 Test Loss: 0.535 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2308740615844727
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.534 Vali Acc: 0.757 Test Loss: 0.534 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2252824306488037
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.544 Vali Acc: 0.757 Test Loss: 0.544 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.276064395904541
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.1296536922454834
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.080986738204956
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2852668762207031
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9805610179901123
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.1689598560333252
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.610 Vali Acc: 0.776 Test Loss: 0.610 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0679404735565186
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.622 Vali Acc: 0.776 Test Loss: 0.622 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.134469985961914
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2204859256744385
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3098092079162598
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.633 Vali Acc: 0.783 Test Loss: 0.633 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 24 cost time: 1.2034733295440674
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.496825933456421
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2759344577789307
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1019861698150635
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1867632865905762
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1571588516235352
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 30 cost time: 1.1834304332733154
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1754300594329834
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1128315925598145
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.783 Test Loss: 0.705 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.131448745727539
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2195823192596436
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1910293102264404
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.206099271774292
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.783 Test Loss: 0.735 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1841602325439453
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2050752639770508
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.172945499420166
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 593412
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0285730361938477
Epoch: 1, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.321 Vali Acc: 0.454 Test Loss: 1.321 Test Acc: 0.454
Validation loss decreased (inf --> -0.453934).  Saving model ...
Epoch: 2 cost time: 1.2520761489868164
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.243 Vali Acc: 0.566 Test Loss: 1.243 Test Acc: 0.566
Validation loss decreased (-0.453934 --> -0.565777).  Saving model ...
Epoch: 3 cost time: 1.2567648887634277
Epoch: 3, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.141 Vali Acc: 0.625 Test Loss: 1.141 Test Acc: 0.625
Validation loss decreased (-0.565777 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 1.2475802898406982
Epoch: 4, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.030 Vali Acc: 0.658 Test Loss: 1.030 Test Acc: 0.658
Validation loss decreased (-0.624989 --> -0.657884).  Saving model ...
Epoch: 5 cost time: 1.258094310760498
Epoch: 5, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.910 Vali Acc: 0.678 Test Loss: 0.910 Test Acc: 0.678
Validation loss decreased (-0.657884 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.2645232677459717
Epoch: 6, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.799 Vali Acc: 0.717 Test Loss: 0.799 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 7 cost time: 1.2333199977874756
Epoch: 7, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.712 Vali Acc: 0.737 Test Loss: 0.712 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.1735987663269043
Epoch: 8, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.1925101280212402
Epoch: 9, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.3278577327728271
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.1137356758117676
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.252312421798706
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.3013439178466797
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.2654953002929688
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.20296049118042
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.194694995880127
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.168999433517456
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.314561367034912
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3023717403411865
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3784246444702148
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2813606262207031
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5098741054534912
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.172529697418213
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 584324
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.265747308731079
Epoch: 1, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.336 Vali Acc: 0.283 Test Loss: 1.336 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.2641055583953857
Epoch: 2, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.268 Vali Acc: 0.454 Test Loss: 1.268 Test Acc: 0.454
Validation loss decreased (-0.282881 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 1.2655165195465088
Epoch: 3, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
Validation loss decreased (-0.453935 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 1.2356982231140137
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.071 Vali Acc: 0.599 Test Loss: 1.071 Test Acc: 0.599
Validation loss decreased (-0.519725 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.1908283233642578
Epoch: 5, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.960 Vali Acc: 0.638 Test Loss: 0.960 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.091536283493042
Epoch: 6, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.846 Vali Acc: 0.678 Test Loss: 0.846 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 1.0913896560668945
Epoch: 7, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.754 Vali Acc: 0.697 Test Loss: 0.754 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.0181033611297607
Epoch: 8, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.673 Vali Acc: 0.717 Test Loss: 0.673 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 9 cost time: 0.960029125213623
Epoch: 9, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.615 Vali Acc: 0.743 Test Loss: 0.615 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 1.1696081161499023
Epoch: 10, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.10384202003479
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.545 Vali Acc: 0.743 Test Loss: 0.545 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1026685237884521
Epoch: 12, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 13 cost time: 1.2160236835479736
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.756574 --> -0.776311).  Saving model ...
Epoch: 14 cost time: 1.1382818222045898
Epoch: 14, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 15 cost time: 1.1636486053466797
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3043999671936035
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.163111686706543
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.782890 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.198660135269165
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2178921699523926
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1777241230010986
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1398627758026123
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2559690475463867
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1748943328857422
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1972105503082275
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1454851627349854
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1807358264923096
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0543503761291504
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 584388
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.743398666381836
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.416 Vali Acc: 0.217 Test Loss: 1.416 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.2574317455291748
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.365 Vali Acc: 0.349 Test Loss: 1.365 Test Acc: 0.349
Validation loss decreased (-0.217091 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.0838046073913574
Epoch: 3, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.284 Vali Acc: 0.467 Test Loss: 1.284 Test Acc: 0.467
Validation loss decreased (-0.348671 --> -0.467092).  Saving model ...
Epoch: 4 cost time: 1.234203577041626
Epoch: 4, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.189 Vali Acc: 0.553 Test Loss: 1.189 Test Acc: 0.553
Validation loss decreased (-0.467092 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.271169900894165
Epoch: 5, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.095 Vali Acc: 0.599 Test Loss: 1.095 Test Acc: 0.599
Validation loss decreased (-0.552620 --> -0.598673).  Saving model ...
Epoch: 6 cost time: 1.3382675647735596
Epoch: 6, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.993 Vali Acc: 0.638 Test Loss: 0.993 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.2495150566101074
Epoch: 7, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.894 Vali Acc: 0.671 Test Loss: 0.894 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671044).  Saving model ...
Epoch: 8 cost time: 1.0405073165893555
Epoch: 8, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.798 Vali Acc: 0.730 Test Loss: 0.798 Test Acc: 0.730
Validation loss decreased (-0.671044 --> -0.730255).  Saving model ...
Epoch: 9 cost time: 1.1518049240112305
Epoch: 9, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1817739009857178
Epoch: 10, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.647 Vali Acc: 0.757 Test Loss: 0.647 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.2175686359405518
Epoch: 11, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2457704544067383
Epoch: 12, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.565 Vali Acc: 0.763 Test Loss: 0.565 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.2215640544891357
Epoch: 13, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.1349937915802002
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2664296627044678
Epoch: 15, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 16 cost time: 1.1747593879699707
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2364442348480225
Epoch: 17, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1136341094970703
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0823123455047607
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1928808689117432
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.0721673965454102
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 1.0735080242156982
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1889393329620361
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2215726375579834
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2687325477600098
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4684529304504395
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2526602745056152
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.189568281173706
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2901787757873535
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.623 Vali Acc: 0.796 Test Loss: 0.623 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.211036205291748
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 31 cost time: 1.178971290588379
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2944846153259277
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.657 Vali Acc: 0.803 Test Loss: 0.657 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2480831146240234
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.663 Vali Acc: 0.803 Test Loss: 0.663 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2271323204040527
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.672 Vali Acc: 0.796 Test Loss: 0.672 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2669148445129395
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1321079730987549
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.796 Test Loss: 0.696 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2963342666625977
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2910797595977783
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.721 Vali Acc: 0.796 Test Loss: 0.721 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2511584758758545
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.269761085510254
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 581444
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9514503479003906
Epoch: 1, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.360 Vali Acc: 0.355 Test Loss: 1.360 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.0545227527618408
Epoch: 2, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.283 Vali Acc: 0.487 Test Loss: 1.283 Test Acc: 0.487
Validation loss decreased (-0.355250 --> -0.486829).  Saving model ...
Epoch: 3 cost time: 1.1341960430145264
Epoch: 3, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.184 Vali Acc: 0.546 Test Loss: 1.184 Test Acc: 0.546
Validation loss decreased (-0.486829 --> -0.546041).  Saving model ...
Epoch: 4 cost time: 0.9678146839141846
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.066 Vali Acc: 0.586 Test Loss: 1.066 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585516).  Saving model ...
Epoch: 5 cost time: 1.0452792644500732
Epoch: 5, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.933 Vali Acc: 0.658 Test Loss: 0.933 Test Acc: 0.658
Validation loss decreased (-0.585516 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 1.010678768157959
Epoch: 6, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.807 Vali Acc: 0.697 Test Loss: 0.807 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.0506205558776855
Epoch: 7, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.0484039783477783
Epoch: 8, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 0.9416041374206543
Epoch: 9, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.568 Vali Acc: 0.770 Test Loss: 0.568 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.151491403579712
Epoch: 10, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.089261770248413
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 12 cost time: 1.2215003967285156
Epoch: 12, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 13 cost time: 1.1890571117401123
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9850690364837646
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.10321044921875
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9790167808532715
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1393933296203613
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 0.9227519035339355
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9299471378326416
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 1.0476536750793457
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.602 Vali Acc: 0.776 Test Loss: 0.602 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2270023822784424
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.11720609664917
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.212890386581421
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1067454814910889
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.634 Vali Acc: 0.789 Test Loss: 0.634 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9881787300109863
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2370059490203857
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0893349647521973
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.113168478012085
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 29 cost time: 1.0467994213104248
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9645299911499023
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9346175193786621
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.789 Test Loss: 0.692 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1318104267120361
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0204687118530273
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0176289081573486
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.796 Test Loss: 0.712 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0700109004974365
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.789 Test Loss: 0.715 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.159043788909912
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0595839023590088
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.789 Test Loss: 0.730 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0789754390716553
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.796 Test Loss: 0.738 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 180420
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0352160930633545
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.379 Vali Acc: 0.257 Test Loss: 1.379 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.053514003753662
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.299 Vali Acc: 0.474 Test Loss: 1.299 Test Acc: 0.474
Validation loss decreased (-0.256565 --> -0.473671).  Saving model ...
Epoch: 3 cost time: 1.070957899093628
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.189 Vali Acc: 0.632 Test Loss: 1.189 Test Acc: 0.632
Validation loss decreased (-0.473671 --> -0.631567).  Saving model ...
Epoch: 4 cost time: 1.0998542308807373
Epoch: 4, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9865942001342773
Epoch: 5, Steps: 10 | Train Loss: 0.837 Vali Loss: 0.933 Vali Acc: 0.684 Test Loss: 0.933 Test Acc: 0.684
Validation loss decreased (-0.631567 --> -0.684201).  Saving model ...
Epoch: 6 cost time: 1.3239083290100098
Epoch: 6, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.801 Vali Acc: 0.711 Test Loss: 0.801 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.1211802959442139
Epoch: 7, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.688 Vali Acc: 0.743 Test Loss: 0.688 Test Acc: 0.743
Validation loss decreased (-0.710518 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.0941839218139648
Epoch: 8, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 0.9368436336517334
Epoch: 9, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.1290764808654785
Epoch: 10, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 1.1334152221679688
Epoch: 11, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 12 cost time: 1.1052043437957764
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 1.183333396911621
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 14 cost time: 1.0690064430236816
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 0.9877421855926514
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 1.1588306427001953
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0779545307159424
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9084746837615967
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1172022819519043
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0793688297271729
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0810637474060059
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1893408298492432
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0597670078277588
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9669091701507568
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.108788013458252
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.597 Vali Acc: 0.803 Test Loss: 0.597 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 180452
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9703447818756104
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.361 Vali Acc: 0.309 Test Loss: 1.361 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.1011340618133545
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.316 Vali Acc: 0.428 Test Loss: 1.316 Test Acc: 0.428
Validation loss decreased (-0.309197 --> -0.427618).  Saving model ...
Epoch: 3 cost time: 1.1204500198364258
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.252 Vali Acc: 0.539 Test Loss: 1.252 Test Acc: 0.539
Validation loss decreased (-0.427618 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 1.1247856616973877
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.178 Vali Acc: 0.572 Test Loss: 1.178 Test Acc: 0.572
Validation loss decreased (-0.539461 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.0552172660827637
Epoch: 5, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.098 Vali Acc: 0.632 Test Loss: 1.098 Test Acc: 0.632
Validation loss decreased (-0.572357 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 1.0286283493041992
Epoch: 6, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.014 Vali Acc: 0.658 Test Loss: 1.014 Test Acc: 0.658
Validation loss decreased (-0.631568 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.0165729522705078
Epoch: 7, Steps: 10 | Train Loss: 0.791 Vali Loss: 0.927 Vali Acc: 0.691 Test Loss: 0.927 Test Acc: 0.691
Validation loss decreased (-0.657885 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 0.9710583686828613
Epoch: 8, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.848 Vali Acc: 0.684 Test Loss: 0.848 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0273158550262451
Epoch: 9, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.766 Vali Acc: 0.724 Test Loss: 0.766 Test Acc: 0.724
Validation loss decreased (-0.690780 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.1299030780792236
Epoch: 10, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.704 Vali Acc: 0.724 Test Loss: 0.704 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.0148561000823975
Epoch: 11, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.647 Vali Acc: 0.730 Test Loss: 0.647 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 12 cost time: 0.9778141975402832
Epoch: 12, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.609 Vali Acc: 0.743 Test Loss: 0.609 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 1.0802631378173828
Epoch: 13, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.582 Vali Acc: 0.730 Test Loss: 0.582 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0752310752868652
Epoch: 14, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0566353797912598
Epoch: 15, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756574).  Saving model ...
Epoch: 16 cost time: 1.0205600261688232
Epoch: 16, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.528 Vali Acc: 0.757 Test Loss: 0.528 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 17 cost time: 1.0224575996398926
Epoch: 17, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.519 Vali Acc: 0.757 Test Loss: 0.519 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 18 cost time: 1.0367765426635742
Epoch: 18, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
Validation loss decreased (-0.756574 --> -0.776311).  Saving model ...
Epoch: 19 cost time: 1.0185596942901611
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1278748512268066
Epoch: 20, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9616799354553223
Epoch: 21, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 0.9413671493530273
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.1876144409179688
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8734095096588135
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9804794788360596
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 1.0065126419067383
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8987479209899902
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9313137531280518
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8514056205749512
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0008227825164795
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.576 Vali Acc: 0.789 Test Loss: 0.576 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8761916160583496
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8885557651519775
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8989059925079346
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9605617523193359
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.594 Vali Acc: 0.796 Test Loss: 0.594 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0387513637542725
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.599 Vali Acc: 0.796 Test Loss: 0.599 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 169732
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.100095272064209
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.377 Vali Acc: 0.303 Test Loss: 1.377 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.965545654296875
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.343 Vali Acc: 0.388 Test Loss: 1.343 Test Acc: 0.388
Validation loss decreased (-0.302618 --> -0.388144).  Saving model ...
Epoch: 3 cost time: 1.0402734279632568
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.287 Vali Acc: 0.493 Test Loss: 1.287 Test Acc: 0.493
Validation loss decreased (-0.388144 --> -0.493408).  Saving model ...
Epoch: 4 cost time: 1.0295915603637695
Epoch: 4, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.220 Vali Acc: 0.566 Test Loss: 1.220 Test Acc: 0.566
Validation loss decreased (-0.493408 --> -0.565777).  Saving model ...
Epoch: 5 cost time: 0.9322984218597412
Epoch: 5, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.152 Vali Acc: 0.632 Test Loss: 1.152 Test Acc: 0.632
Validation loss decreased (-0.565777 --> -0.631567).  Saving model ...
Epoch: 6 cost time: 1.0485162734985352
Epoch: 6, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.075 Vali Acc: 0.658 Test Loss: 1.075 Test Acc: 0.658
Validation loss decreased (-0.631567 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 0.9453561305999756
Epoch: 7, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.997 Vali Acc: 0.704 Test Loss: 0.997 Test Acc: 0.704
Validation loss decreased (-0.657884 --> -0.703937).  Saving model ...
Epoch: 8 cost time: 0.9567186832427979
Epoch: 8, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.917 Vali Acc: 0.711 Test Loss: 0.917 Test Acc: 0.711
Validation loss decreased (-0.703937 --> -0.710517).  Saving model ...
Epoch: 9 cost time: 0.9868869781494141
Epoch: 9, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.838 Vali Acc: 0.724 Test Loss: 0.838 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723676).  Saving model ...
Epoch: 10 cost time: 0.8799037933349609
Epoch: 10, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.772 Vali Acc: 0.724 Test Loss: 0.772 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723676).  Saving model ...
Epoch: 11 cost time: 1.039461612701416
Epoch: 11, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.716 Vali Acc: 0.743 Test Loss: 0.716 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 0.9759399890899658
Epoch: 12, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.672 Vali Acc: 0.730 Test Loss: 0.672 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0226995944976807
Epoch: 13, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.630 Vali Acc: 0.724 Test Loss: 0.630 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.889915943145752
Epoch: 14, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.0109527111053467
Epoch: 15, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 1.0151383876800537
Epoch: 16, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.550 Vali Acc: 0.750 Test Loss: 0.550 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 17 cost time: 0.966832160949707
Epoch: 17, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
Validation loss decreased (-0.749995 --> -0.763153).  Saving model ...
Epoch: 18 cost time: 1.0219526290893555
Epoch: 18, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.528 Vali Acc: 0.757 Test Loss: 0.528 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9210834503173828
Epoch: 19, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 20 cost time: 0.902369499206543
Epoch: 20, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 21 cost time: 0.8790199756622314
Epoch: 21, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 22 cost time: 0.9354846477508545
Epoch: 22, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 0.9876420497894287
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9361279010772705
Epoch: 24, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9298453330993652
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8880617618560791
Epoch: 26, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9578666687011719
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0361061096191406
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0126526355743408
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9029014110565186
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9438092708587646
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9727907180786133
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 165188
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.709764003753662
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.385 Vali Acc: 0.237 Test Loss: 1.385 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.0071918964385986
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.352 Vali Acc: 0.303 Test Loss: 1.352 Test Acc: 0.303
Validation loss decreased (-0.236828 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 0.8366055488586426
Epoch: 3, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.301 Vali Acc: 0.388 Test Loss: 1.301 Test Acc: 0.388
Validation loss decreased (-0.302618 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.1301629543304443
Epoch: 4, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.242 Vali Acc: 0.487 Test Loss: 1.242 Test Acc: 0.487
Validation loss decreased (-0.388145 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.0788695812225342
Epoch: 5, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.177 Vali Acc: 0.566 Test Loss: 1.177 Test Acc: 0.566
Validation loss decreased (-0.486830 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 1.0607402324676514
Epoch: 6, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.110 Vali Acc: 0.618 Test Loss: 1.110 Test Acc: 0.618
Validation loss decreased (-0.565778 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 0.9807009696960449
Epoch: 7, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.040 Vali Acc: 0.651 Test Loss: 1.040 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651305).  Saving model ...
Epoch: 8 cost time: 1.0145032405853271
Epoch: 8, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.970 Vali Acc: 0.671 Test Loss: 0.970 Test Acc: 0.671
Validation loss decreased (-0.651305 --> -0.671043).  Saving model ...
Epoch: 9 cost time: 1.0774412155151367
Epoch: 9, Steps: 10 | Train Loss: 0.756 Vali Loss: 0.891 Vali Acc: 0.704 Test Loss: 0.891 Test Acc: 0.704
Validation loss decreased (-0.671043 --> -0.703938).  Saving model ...
Epoch: 10 cost time: 0.9097046852111816
Epoch: 10, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.816 Vali Acc: 0.724 Test Loss: 0.816 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723676).  Saving model ...
Epoch: 11 cost time: 0.9248249530792236
Epoch: 11, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.746 Vali Acc: 0.750 Test Loss: 0.746 Test Acc: 0.750
Validation loss decreased (-0.723676 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 0.9340794086456299
Epoch: 12, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.688 Vali Acc: 0.757 Test Loss: 0.688 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.074333906173706
Epoch: 13, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 0.9927825927734375
Epoch: 14, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.054086685180664
Epoch: 15, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 0.9597687721252441
Epoch: 16, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9704387187957764
Epoch: 17, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9159073829650879
Epoch: 18, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0630769729614258
Epoch: 19, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.497 Vali Acc: 0.770 Test Loss: 0.497 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8996806144714355
Epoch: 20, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0333774089813232
Epoch: 21, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.483 Vali Acc: 0.776 Test Loss: 0.483 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0061705112457275
Epoch: 22, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.478 Vali Acc: 0.770 Test Loss: 0.478 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9652225971221924
Epoch: 23, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.478 Vali Acc: 0.770 Test Loss: 0.478 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.996502161026001
Epoch: 24, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.481 Vali Acc: 0.783 Test Loss: 0.481 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0053966045379639
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.481 Vali Acc: 0.783 Test Loss: 0.481 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 165220
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.82034969329834
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.378 Vali Acc: 0.289 Test Loss: 1.378 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.9179651737213135
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.350 Vali Acc: 0.322 Test Loss: 1.350 Test Acc: 0.322
Validation loss decreased (-0.289460 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 0.9951803684234619
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.307 Vali Acc: 0.395 Test Loss: 1.307 Test Acc: 0.395
Validation loss decreased (-0.322355 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 0.9348855018615723
Epoch: 4, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
Validation loss decreased (-0.394724 --> -0.519724).  Saving model ...
Epoch: 5 cost time: 0.9960339069366455
Epoch: 5, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.204 Vali Acc: 0.599 Test Loss: 1.204 Test Acc: 0.599
Validation loss decreased (-0.519724 --> -0.598672).  Saving model ...
Epoch: 6 cost time: 0.9085690975189209
Epoch: 6, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.145 Vali Acc: 0.658 Test Loss: 1.145 Test Acc: 0.658
Validation loss decreased (-0.598672 --> -0.657883).  Saving model ...
Epoch: 7 cost time: 0.9244780540466309
Epoch: 7, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.083 Vali Acc: 0.664 Test Loss: 1.083 Test Acc: 0.664
Validation loss decreased (-0.657883 --> -0.664463).  Saving model ...
Epoch: 8 cost time: 0.938955545425415
Epoch: 8, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.022 Vali Acc: 0.684 Test Loss: 1.022 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684200).  Saving model ...
Epoch: 9 cost time: 0.9892232418060303
Epoch: 9, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.959 Vali Acc: 0.691 Test Loss: 0.959 Test Acc: 0.691
Validation loss decreased (-0.684200 --> -0.690780).  Saving model ...
Epoch: 10 cost time: 0.997389554977417
Epoch: 10, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.897 Vali Acc: 0.704 Test Loss: 0.897 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703938).  Saving model ...
Epoch: 11 cost time: 0.8589305877685547
Epoch: 11, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.833 Vali Acc: 0.730 Test Loss: 0.833 Test Acc: 0.730
Validation loss decreased (-0.703938 --> -0.730255).  Saving model ...
Epoch: 12 cost time: 1.0849642753601074
Epoch: 12, Steps: 10 | Train Loss: 0.579 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 1.0135185718536377
Epoch: 13, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.733 Vali Acc: 0.750 Test Loss: 0.733 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 0.9876418113708496
Epoch: 14, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.691 Vali Acc: 0.770 Test Loss: 0.691 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769730).  Saving model ...
Epoch: 15 cost time: 0.9672319889068604
Epoch: 15, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 1.0555915832519531
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.616 Vali Acc: 0.776 Test Loss: 0.616 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.0669028759002686
Epoch: 17, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1039042472839355
Epoch: 18, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 0.872748851776123
Epoch: 19, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 0.8943972587585449
Epoch: 20, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.0194973945617676
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 0.978456974029541
Epoch: 22, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9201183319091797
Epoch: 23, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8927104473114014
Epoch: 24, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8786976337432861
Epoch: 25, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8774735927581787
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.999744176864624
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.835416316986084
Epoch: 28, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9020097255706787
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8093857765197754
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8587510585784912
Epoch: 31, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 32 cost time: 0.8636140823364258
Epoch: 32, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9121992588043213
Epoch: 33, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9483935832977295
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0131580829620361
Epoch: 35, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9732761383056641
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9595930576324463
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9370479583740234
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9726436138153076
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0543267726898193
Epoch: 40, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.622 Vali Acc: 0.796 Test Loss: 0.622 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.823216438293457
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 163748
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0740694999694824
Epoch: 1, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.320 Vali Acc: 0.428 Test Loss: 1.320 Test Acc: 0.428
Validation loss decreased (inf --> -0.427618).  Saving model ...
Epoch: 2 cost time: 1.385056972503662
Epoch: 2, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.036 Vali Acc: 0.658 Test Loss: 1.036 Test Acc: 0.658
Validation loss decreased (-0.427618 --> -0.657884).  Saving model ...
Epoch: 3 cost time: 1.4217686653137207
Epoch: 3, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.739 Vali Acc: 0.737 Test Loss: 0.739 Test Acc: 0.737
Validation loss decreased (-0.657884 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 1.5036208629608154
Epoch: 4, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 1.4434597492218018
Epoch: 5, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.3941144943237305
Epoch: 6, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3344426155090332
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.409627914428711
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3677208423614502
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802624).  Saving model ...
Epoch: 10 cost time: 1.5737476348876953
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.744 Vali Acc: 0.809 Test Loss: 0.744 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 11 cost time: 1.3202202320098877
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.766 Vali Acc: 0.803 Test Loss: 0.766 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.313302993774414
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.803 Test Loss: 0.764 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2761883735656738
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.809 Test Loss: 0.771 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4402868747711182
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.796 Test Loss: 0.766 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2842438220977783
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4583239555358887
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.789 Test Loss: 0.802 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5923566818237305
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.789 Test Loss: 0.814 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5601789951324463
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.796 Test Loss: 0.816 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4663660526275635
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.796 Test Loss: 0.827 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5312981605529785
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2236164
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3373188972473145
Epoch: 1, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.291 Vali Acc: 0.461 Test Loss: 1.291 Test Acc: 0.461
Validation loss decreased (inf --> -0.460513).  Saving model ...
Epoch: 2 cost time: 1.2623398303985596
Epoch: 2, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.028 Vali Acc: 0.691 Test Loss: 1.028 Test Acc: 0.691
Validation loss decreased (-0.460513 --> -0.690779).  Saving model ...
Epoch: 3 cost time: 1.2412588596343994
Epoch: 3, Steps: 10 | Train Loss: 0.651 Vali Loss: 0.744 Vali Acc: 0.750 Test Loss: 0.744 Test Acc: 0.750
Validation loss decreased (-0.690779 --> -0.749993).  Saving model ...
Epoch: 4 cost time: 1.5129337310791016
Epoch: 4, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.200279951095581
Epoch: 5, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3627784252166748
Epoch: 6, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.4364967346191406
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 8 cost time: 1.368842363357544
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.602 Vali Acc: 0.816 Test Loss: 0.602 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 9 cost time: 1.3565106391906738
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.645 Vali Acc: 0.816 Test Loss: 0.645 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4520626068115234
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2753920555114746
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.816 Test Loss: 0.696 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1966774463653564
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.816 Test Loss: 0.713 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3371756076812744
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.809 Test Loss: 0.728 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3773303031921387
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.816 Test Loss: 0.747 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3223707675933838
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.816 Test Loss: 0.760 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2954113483428955
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.816 Test Loss: 0.772 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4140572547912598
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.816 Test Loss: 0.781 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2443361282348633
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.816 Test Loss: 0.795 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 2236292
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1249547004699707
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.337 Vali Acc: 0.342 Test Loss: 1.337 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.268692970275879
Epoch: 2, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.164 Vali Acc: 0.586 Test Loss: 1.164 Test Acc: 0.586
Validation loss decreased (-0.342092 --> -0.585515).  Saving model ...
Epoch: 3 cost time: 1.3338994979858398
Epoch: 3, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.955 Vali Acc: 0.678 Test Loss: 0.955 Test Acc: 0.678
Validation loss decreased (-0.585515 --> -0.677622).  Saving model ...
Epoch: 4 cost time: 1.3479955196380615
Epoch: 4, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.772 Vali Acc: 0.711 Test Loss: 0.772 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.3551480770111084
Epoch: 5, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.644 Vali Acc: 0.743 Test Loss: 0.644 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.310271978378296
Epoch: 6, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.573 Vali Acc: 0.743 Test Loss: 0.573 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 1.3979401588439941
Epoch: 7, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743416).  Saving model ...
Epoch: 8 cost time: 1.409339189529419
Epoch: 8, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.544 Vali Acc: 0.757 Test Loss: 0.544 Test Acc: 0.757
Validation loss decreased (-0.743416 --> -0.756574).  Saving model ...
Epoch: 9 cost time: 1.3882453441619873
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.4845948219299316
Epoch: 10, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4386134147644043
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.618 Vali Acc: 0.776 Test Loss: 0.618 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.4345946311950684
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.638 Vali Acc: 0.776 Test Loss: 0.638 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4348549842834473
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 1.543865442276001
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.386932373046875
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.776 Test Loss: 0.672 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3368782997131348
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2732272148132324
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.275564432144165
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.776 Test Loss: 0.694 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2196154594421387
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.136411428451538
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3488433361053467
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.776 Test Loss: 0.734 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2724800109863281
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.789 Test Loss: 0.741 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 23 cost time: 1.3261628150939941
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3668856620788574
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5676825046539307
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.296778678894043
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.789 Test Loss: 0.771 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3383419513702393
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.210071325302124
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.783 Test Loss: 0.792 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.277923583984375
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.783 Test Loss: 0.789 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1759312152862549
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.783 Test Loss: 0.800 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2176332473754883
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.789 Test Loss: 0.800 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.292405605316162
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.796 Test Loss: 0.807 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796045).  Saving model ...
Epoch: 33 cost time: 1.3927302360534668
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.803 Test Loss: 0.821 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802623).  Saving model ...
Epoch: 34 cost time: 1.393045425415039
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3671715259552002
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.789 Test Loss: 0.828 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1791183948516846
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.789 Test Loss: 0.834 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4432082176208496
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.789 Test Loss: 0.841 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.302189588546753
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.796 Test Loss: 0.847 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1062183380126953
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.796 Test Loss: 0.856 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.4321048259735107
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.796 Test Loss: 0.865 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4344160556793213
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.789 Test Loss: 0.876 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.2855169773101807
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.796 Test Loss: 0.875 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4429876804351807
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.796 Test Loss: 0.884 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2193412
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.880951404571533
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.338 Vali Acc: 0.342 Test Loss: 1.338 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.3616828918457031
Epoch: 2, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.205 Vali Acc: 0.520 Test Loss: 1.205 Test Acc: 0.520
Validation loss decreased (-0.342092 --> -0.519725).  Saving model ...
Epoch: 3 cost time: 1.250387191772461
Epoch: 3, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.033 Vali Acc: 0.658 Test Loss: 1.033 Test Acc: 0.658
Validation loss decreased (-0.519725 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 1.251535415649414
Epoch: 4, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.856 Vali Acc: 0.704 Test Loss: 0.856 Test Acc: 0.704
Validation loss decreased (-0.657884 --> -0.703939).  Saving model ...
Epoch: 5 cost time: 1.4203784465789795
Epoch: 5, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.703 Vali Acc: 0.763 Test Loss: 0.703 Test Acc: 0.763
Validation loss decreased (-0.703939 --> -0.763151).  Saving model ...
Epoch: 6 cost time: 1.2789278030395508
Epoch: 6, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2838776111602783
Epoch: 7, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.270024061203003
Epoch: 8, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782890).  Saving model ...
Epoch: 9 cost time: 1.4566609859466553
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0996851921081543
Epoch: 10, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.3867409229278564
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3824520111083984
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.275644302368164
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.255110740661621
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3065240383148193
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2440605163574219
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.258317470550537
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.309196949005127
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4732072353363037
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.661 Vali Acc: 0.803 Test Loss: 0.661 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3510758876800537
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3397679328918457
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4336035251617432
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.363647222518921
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.710 Vali Acc: 0.796 Test Loss: 0.710 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2175236
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8948681354522705
Epoch: 1, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.311 Vali Acc: 0.382 Test Loss: 1.311 Test Acc: 0.382
Validation loss decreased (inf --> -0.381566).  Saving model ...
Epoch: 2 cost time: 1.3343100547790527
Epoch: 2, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.182 Vali Acc: 0.612 Test Loss: 1.182 Test Acc: 0.612
Validation loss decreased (-0.381566 --> -0.611830).  Saving model ...
Epoch: 3 cost time: 1.3102195262908936
Epoch: 3, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.020 Vali Acc: 0.664 Test Loss: 1.020 Test Acc: 0.664
Validation loss decreased (-0.611830 --> -0.664463).  Saving model ...
Epoch: 4 cost time: 1.3523316383361816
Epoch: 4, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.859 Vali Acc: 0.691 Test Loss: 0.859 Test Acc: 0.691
Validation loss decreased (-0.664463 --> -0.690781).  Saving model ...
Epoch: 5 cost time: 1.1712379455566406
Epoch: 5, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.731 Vali Acc: 0.724 Test Loss: 0.731 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.3099255561828613
Epoch: 6, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.643 Vali Acc: 0.737 Test Loss: 0.643 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 7 cost time: 1.429654598236084
Epoch: 7, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.589 Vali Acc: 0.743 Test Loss: 0.589 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.395637035369873
Epoch: 8, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.559 Vali Acc: 0.770 Test Loss: 0.559 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.3345062732696533
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.259371042251587
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3891587257385254
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.576 Vali Acc: 0.789 Test Loss: 0.576 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.2942092418670654
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.3080649375915527
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3019895553588867
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4513912200927734
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4745419025421143
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3794376850128174
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4106011390686035
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.479311466217041
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5223345756530762
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3897309303283691
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3455805778503418
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 2175364
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.084343433380127
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.340 Vali Acc: 0.414 Test Loss: 1.340 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 1.1353840827941895
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.223 Vali Acc: 0.618 Test Loss: 1.223 Test Acc: 0.618
Validation loss decreased (-0.414460 --> -0.618409).  Saving model ...
Epoch: 3 cost time: 1.4566824436187744
Epoch: 3, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.077 Vali Acc: 0.697 Test Loss: 1.077 Test Acc: 0.697
Validation loss decreased (-0.618409 --> -0.697358).  Saving model ...
Epoch: 4 cost time: 1.4633376598358154
Epoch: 4, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.923 Vali Acc: 0.711 Test Loss: 0.923 Test Acc: 0.711
Validation loss decreased (-0.697358 --> -0.710517).  Saving model ...
Epoch: 5 cost time: 1.4476139545440674
Epoch: 5, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.774 Vali Acc: 0.724 Test Loss: 0.774 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723676).  Saving model ...
Epoch: 6 cost time: 1.425022840499878
Epoch: 6, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.657 Vali Acc: 0.743 Test Loss: 0.657 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.3841164112091064
Epoch: 7, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 1.282944679260254
Epoch: 8, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.540 Vali Acc: 0.750 Test Loss: 0.540 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 9 cost time: 1.410048007965088
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.521 Vali Acc: 0.763 Test Loss: 0.521 Test Acc: 0.763
Validation loss decreased (-0.749995 --> -0.763153).  Saving model ...
Epoch: 10 cost time: 1.411116123199463
Epoch: 10, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 1.3534252643585205
Epoch: 11, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 12 cost time: 1.4782414436340332
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.3801984786987305
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4471442699432373
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4091112613677979
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3070273399353027
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4941701889038086
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.419588565826416
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.376072883605957
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.816 Test Loss: 0.611 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 20 cost time: 1.4320497512817383
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5270445346832275
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4481244087219238
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5431537628173828
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5461928844451904
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4280571937561035
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4495158195495605
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5834434032440186
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4584393501281738
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4170303344726562
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.803 Test Loss: 0.737 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 2169476
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.070551872253418
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.319 Vali Acc: 0.414 Test Loss: 1.319 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 1.2282352447509766
Epoch: 2, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.189 Vali Acc: 0.599 Test Loss: 1.189 Test Acc: 0.599
Validation loss decreased (-0.414460 --> -0.598672).  Saving model ...
Epoch: 3 cost time: 1.3503224849700928
Epoch: 3, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.003 Vali Acc: 0.711 Test Loss: 1.003 Test Acc: 0.711
Validation loss decreased (-0.598672 --> -0.710516).  Saving model ...
Epoch: 4 cost time: 1.3860580921173096
Epoch: 4, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.800 Vali Acc: 0.724 Test Loss: 0.800 Test Acc: 0.724
Validation loss decreased (-0.710516 --> -0.723676).  Saving model ...
Epoch: 5 cost time: 1.2433693408966064
Epoch: 5, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743415).  Saving model ...
Epoch: 6 cost time: 1.1805498600006104
Epoch: 6, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 1.1113231182098389
Epoch: 7, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.2778704166412354
Epoch: 8, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.0306034088134766
Epoch: 9, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1706154346466064
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.1979503631591797
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1304607391357422
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.2073724269866943
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1442680358886719
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1610329151153564
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 1.2145166397094727
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.789 Test Loss: 0.662 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1710350513458252
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1832873821258545
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.796 Test Loss: 0.692 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1765236854553223
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1893925666809082
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 21 cost time: 1.0740416049957275
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2235908508300781
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.796 Test Loss: 0.729 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2721071243286133
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.734 Vali Acc: 0.796 Test Loss: 0.734 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1457688808441162
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.803 Test Loss: 0.750 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.10422945022583
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.066788911819458
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1945006847381592
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.796 Test Loss: 0.778 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1591813564300537
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.796 Test Loss: 0.782 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.051265001296997
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 30 cost time: 1.1235156059265137
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2987027168273926
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.392759084701538
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.809 Test Loss: 0.808 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.198721170425415
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.809 Test Loss: 0.820 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2659494876861572
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.822 Test Loss: 0.813 Test Acc: 0.822
Validation loss decreased (-0.809203 --> -0.822360).  Saving model ...
Epoch: 35 cost time: 1.349001407623291
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.816 Test Loss: 0.821 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.276700735092163
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.816 Test Loss: 0.829 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0995738506317139
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.809 Test Loss: 0.828 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1668264865875244
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.816 Test Loss: 0.840 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0921094417572021
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.822 Test Loss: 0.851 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.242936134338379
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.809 Test Loss: 0.861 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2228028774261475
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.809 Test Loss: 0.858 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3190827369689941
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.809 Test Loss: 0.851 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1317265033721924
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.816 Test Loss: 0.856 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2848048210144043
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.816 Test Loss: 0.861 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 610180
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6466526985168457
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.345 Vali Acc: 0.349 Test Loss: 1.345 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.0390822887420654
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.195 Vali Acc: 0.605 Test Loss: 1.195 Test Acc: 0.605
Validation loss decreased (-0.348671 --> -0.605251).  Saving model ...
Epoch: 3 cost time: 1.2823808193206787
Epoch: 3, Steps: 10 | Train Loss: 0.960 Vali Loss: 0.998 Vali Acc: 0.645 Test Loss: 0.998 Test Acc: 0.645
Validation loss decreased (-0.605251 --> -0.644727).  Saving model ...
Epoch: 4 cost time: 1.1533524990081787
Epoch: 4, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.807 Vali Acc: 0.664 Test Loss: 0.807 Test Acc: 0.664
Validation loss decreased (-0.644727 --> -0.664466).  Saving model ...
Epoch: 5 cost time: 1.0987622737884521
Epoch: 5, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.666 Vali Acc: 0.730 Test Loss: 0.666 Test Acc: 0.730
Validation loss decreased (-0.664466 --> -0.730257).  Saving model ...
Epoch: 6 cost time: 1.068115234375
Epoch: 6, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.1434500217437744
Epoch: 7, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.547 Vali Acc: 0.757 Test Loss: 0.547 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9311492443084717
Epoch: 8, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.543 Vali Acc: 0.743 Test Loss: 0.543 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9407284259796143
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 0.969933271408081
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.0087220668792725
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0512735843658447
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1337792873382568
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1200675964355469
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.783 Test Loss: 0.643 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 15 cost time: 1.2895071506500244
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0601017475128174
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2302708625793457
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0992059707641602
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.783 Test Loss: 0.693 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2531859874725342
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 1.0922553539276123
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0161802768707275
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.042567491531372
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0790777206420898
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9259557723999023
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.776 Test Loss: 0.744 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9806804656982422
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.789 Test Loss: 0.758 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0804073810577393
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.759 Vali Acc: 0.776 Test Loss: 0.759 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1162703037261963
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0154359340667725
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.789 Test Loss: 0.774 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0667428970336914
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.776 Test Loss: 0.775 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 610244
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.403698444366455
Epoch: 1, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.300 Vali Acc: 0.533 Test Loss: 1.300 Test Acc: 0.533
Validation loss decreased (inf --> -0.532882).  Saving model ...
Epoch: 2 cost time: 1.0545451641082764
Epoch: 2, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.206 Vali Acc: 0.638 Test Loss: 1.206 Test Acc: 0.638
Validation loss decreased (-0.532882 --> -0.638146).  Saving model ...
Epoch: 3 cost time: 1.0340921878814697
Epoch: 3, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.085 Vali Acc: 0.658 Test Loss: 1.085 Test Acc: 0.658
Validation loss decreased (-0.638146 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 1.1462786197662354
Epoch: 4, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.955 Vali Acc: 0.651 Test Loss: 0.955 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0929670333862305
Epoch: 5, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.829 Vali Acc: 0.697 Test Loss: 0.829 Test Acc: 0.697
Validation loss decreased (-0.657884 --> -0.697360).  Saving model ...
Epoch: 6 cost time: 1.0169224739074707
Epoch: 6, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.719 Vali Acc: 0.724 Test Loss: 0.719 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.083674430847168
Epoch: 7, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.636 Vali Acc: 0.743 Test Loss: 0.636 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.1450788974761963
Epoch: 8, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.0673668384552002
Epoch: 9, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.544 Vali Acc: 0.743 Test Loss: 0.544 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0574157238006592
Epoch: 10, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 0.9294312000274658
Epoch: 11, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1817824840545654
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2111189365386963
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0067732334136963
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0118401050567627
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.226541519165039
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1442091464996338
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2986862659454346
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.579 Vali Acc: 0.789 Test Loss: 0.579 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.122375726699829
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3284680843353271
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2137112617492676
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.253734827041626
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1300489902496338
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0687973499298096
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 25 cost time: 1.0148847103118896
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.085878849029541
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9690141677856445
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1350524425506592
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.040466547012329
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.671 Vali Acc: 0.783 Test Loss: 0.671 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1824798583984375
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0311486721038818
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.701 Vali Acc: 0.789 Test Loss: 0.701 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3414924144744873
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2736363410949707
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2700607776641846
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 588804
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.677095890045166
Epoch: 1, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.339 Vali Acc: 0.421 Test Loss: 1.339 Test Acc: 0.421
Validation loss decreased (inf --> -0.421039).  Saving model ...
Epoch: 2 cost time: 1.162144660949707
Epoch: 2, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.265 Vali Acc: 0.572 Test Loss: 1.265 Test Acc: 0.572
Validation loss decreased (-0.421039 --> -0.572356).  Saving model ...
Epoch: 3 cost time: 1.0022878646850586
Epoch: 3, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.158 Vali Acc: 0.632 Test Loss: 1.158 Test Acc: 0.632
Validation loss decreased (-0.572356 --> -0.631567).  Saving model ...
Epoch: 4 cost time: 1.1532888412475586
Epoch: 4, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.045 Vali Acc: 0.678 Test Loss: 1.045 Test Acc: 0.678
Validation loss decreased (-0.631567 --> -0.677621).  Saving model ...
Epoch: 5 cost time: 1.0889832973480225
Epoch: 5, Steps: 10 | Train Loss: 0.835 Vali Loss: 0.930 Vali Acc: 0.671 Test Loss: 0.930 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1585259437561035
Epoch: 6, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.819 Vali Acc: 0.717 Test Loss: 0.819 Test Acc: 0.717
Validation loss decreased (-0.677621 --> -0.717097).  Saving model ...
Epoch: 7 cost time: 1.062201738357544
Epoch: 7, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.721 Vali Acc: 0.743 Test Loss: 0.721 Test Acc: 0.743
Validation loss decreased (-0.717097 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.2657346725463867
Epoch: 8, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.644 Vali Acc: 0.770 Test Loss: 0.644 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.2130696773529053
Epoch: 9, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.187406063079834
Epoch: 10, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.0828051567077637
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.2136740684509277
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.528 Vali Acc: 0.757 Test Loss: 0.528 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2348148822784424
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.138688325881958
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.521 Vali Acc: 0.763 Test Loss: 0.521 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1370301246643066
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 16 cost time: 1.1173744201660156
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.013044834136963
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 0.975405216217041
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0569653511047363
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0074450969696045
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.120999813079834
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2453804016113281
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.2814242839813232
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2184524536132812
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0765397548675537
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 26 cost time: 1.1658027172088623
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.191098690032959
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.133357286453247
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2127256393432617
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1182587146759033
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0708072185516357
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.675 Vali Acc: 0.789 Test Loss: 0.675 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1690406799316406
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.047403335571289
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1024785041809082
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9957373142242432
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 579716
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.834014415740967
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.391 Vali Acc: 0.276 Test Loss: 1.391 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.0221381187438965
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.325 Vali Acc: 0.368 Test Loss: 1.325 Test Acc: 0.368
Validation loss decreased (-0.276302 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.079059362411499
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.225 Vali Acc: 0.572 Test Loss: 1.225 Test Acc: 0.572
Validation loss decreased (-0.368408 --> -0.572356).  Saving model ...
Epoch: 4 cost time: 0.9056603908538818
Epoch: 4, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.116 Vali Acc: 0.638 Test Loss: 1.116 Test Acc: 0.638
Validation loss decreased (-0.572356 --> -0.638147).  Saving model ...
Epoch: 5 cost time: 1.1499764919281006
Epoch: 5, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.996 Vali Acc: 0.678 Test Loss: 0.996 Test Acc: 0.678
Validation loss decreased (-0.638147 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.203444004058838
Epoch: 6, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.878 Vali Acc: 0.730 Test Loss: 0.878 Test Acc: 0.730
Validation loss decreased (-0.677622 --> -0.730254).  Saving model ...
Epoch: 7 cost time: 1.1584746837615967
Epoch: 7, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.771 Vali Acc: 0.763 Test Loss: 0.771 Test Acc: 0.763
Validation loss decreased (-0.730254 --> -0.763150).  Saving model ...
Epoch: 8 cost time: 1.226236343383789
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.199958086013794
Epoch: 9, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
Validation loss decreased (-0.763150 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.1658821105957031
Epoch: 10, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.0694587230682373
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.0793068408966064
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.551 Vali Acc: 0.763 Test Loss: 0.551 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0707473754882812
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.08613920211792
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1037392616271973
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.0297844409942627
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.221099853515625
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0339381694793701
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.08133864402771
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.093348503112793
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1643660068511963
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1045422554016113
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.161452293395996
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1308135986328125
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1566784381866455
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.618 Vali Acc: 0.776 Test Loss: 0.618 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1342377662658691
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1641428470611572
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1825292110443115
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 579780
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6126766204833984
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.366 Vali Acc: 0.355 Test Loss: 1.366 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 1.0633339881896973
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.307 Vali Acc: 0.474 Test Loss: 1.307 Test Acc: 0.474
Validation loss decreased (-0.355249 --> -0.473671).  Saving model ...
Epoch: 3 cost time: 0.8717617988586426
Epoch: 3, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.223 Vali Acc: 0.533 Test Loss: 1.223 Test Acc: 0.533
Validation loss decreased (-0.473671 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.0306782722473145
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.131 Vali Acc: 0.599 Test Loss: 1.131 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.1740410327911377
Epoch: 5, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.031 Vali Acc: 0.605 Test Loss: 1.031 Test Acc: 0.605
Validation loss decreased (-0.598673 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 1.1063435077667236
Epoch: 6, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.926 Vali Acc: 0.697 Test Loss: 0.926 Test Acc: 0.697
Validation loss decreased (-0.605253 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 1.1099588871002197
Epoch: 7, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.832 Vali Acc: 0.711 Test Loss: 0.832 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 1.0631694793701172
Epoch: 8, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.749 Vali Acc: 0.757 Test Loss: 0.749 Test Acc: 0.757
Validation loss decreased (-0.710518 --> -0.756571).  Saving model ...
Epoch: 9 cost time: 1.090003490447998
Epoch: 9, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
Validation loss decreased (-0.756571 --> -0.789467).  Saving model ...
Epoch: 10 cost time: 1.0666320323944092
Epoch: 10, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789467).  Saving model ...
Epoch: 11 cost time: 1.1184818744659424
Epoch: 11, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.088376522064209
Epoch: 12, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1223993301391602
Epoch: 13, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 14 cost time: 1.1251583099365234
Epoch: 14, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1582002639770508
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9804553985595703
Epoch: 16, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.144486665725708
Epoch: 17, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.000596284866333
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2244164943695068
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.101975679397583
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1345407962799072
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1079328060150146
Epoch: 22, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1371376514434814
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 576836
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3617124557495117
Epoch: 1, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.323 Vali Acc: 0.454 Test Loss: 1.323 Test Acc: 0.454
Validation loss decreased (inf --> -0.453934).  Saving model ...
Epoch: 2 cost time: 1.0195598602294922
Epoch: 2, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.242 Vali Acc: 0.579 Test Loss: 1.242 Test Acc: 0.579
Validation loss decreased (-0.453934 --> -0.578935).  Saving model ...
Epoch: 3 cost time: 1.046308994293213
Epoch: 3, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.137 Vali Acc: 0.632 Test Loss: 1.137 Test Acc: 0.632
Validation loss decreased (-0.578935 --> -0.631568).  Saving model ...
Epoch: 4 cost time: 1.1140222549438477
Epoch: 4, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.015 Vali Acc: 0.651 Test Loss: 1.015 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651306).  Saving model ...
Epoch: 5 cost time: 0.9722986221313477
Epoch: 5, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.885 Vali Acc: 0.691 Test Loss: 0.885 Test Acc: 0.691
Validation loss decreased (-0.651306 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 0.975257158279419
Epoch: 6, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.761 Vali Acc: 0.743 Test Loss: 0.761 Test Acc: 0.743
Validation loss decreased (-0.690781 --> -0.743413).  Saving model ...
Epoch: 7 cost time: 1.0398552417755127
Epoch: 7, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.661 Vali Acc: 0.757 Test Loss: 0.661 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 1.056858777999878
Epoch: 8, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.0461509227752686
Epoch: 9, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0343983173370361
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 11 cost time: 0.9359512329101562
Epoch: 11, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 12 cost time: 0.9365770816802979
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 0.9421093463897705
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9095723628997803
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0198259353637695
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 0.9800782203674316
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9431343078613281
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8982264995574951
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9659593105316162
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.796 Test Loss: 0.585 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.036741018295288
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.933020830154419
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.603 Vali Acc: 0.789 Test Loss: 0.603 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0061900615692139
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9734070301055908
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.017554521560669
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9448974132537842
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 26 cost time: 1.0490894317626953
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9172577857971191
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9922523498535156
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.057936668395996
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.862896203994751
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.669 Vali Acc: 0.803 Test Loss: 0.669 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9857146739959717
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.927377462387085
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.094602346420288
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.694 Vali Acc: 0.809 Test Loss: 0.694 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 34 cost time: 1.043233871459961
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0193226337432861
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.698 Vali Acc: 0.803 Test Loss: 0.698 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0958425998687744
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9818413257598877
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.706 Vali Acc: 0.803 Test Loss: 0.706 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9941530227661133
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0128257274627686
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9631736278533936
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9481348991394043
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0181398391723633
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9949722290039062
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.809 Test Loss: 0.745 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 178116
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.519596576690674
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.377 Vali Acc: 0.289 Test Loss: 1.377 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.018171787261963
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.299 Vali Acc: 0.526 Test Loss: 1.299 Test Acc: 0.526
Validation loss decreased (-0.289460 --> -0.526303).  Saving model ...
Epoch: 3 cost time: 1.0125446319580078
Epoch: 3, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.194 Vali Acc: 0.664 Test Loss: 1.194 Test Acc: 0.664
Validation loss decreased (-0.526303 --> -0.664462).  Saving model ...
Epoch: 4 cost time: 0.8995511531829834
Epoch: 4, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.073 Vali Acc: 0.717 Test Loss: 1.073 Test Acc: 0.717
Validation loss decreased (-0.664462 --> -0.717095).  Saving model ...
Epoch: 5 cost time: 0.922213077545166
Epoch: 5, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.937 Vali Acc: 0.717 Test Loss: 0.937 Test Acc: 0.717
Validation loss decreased (-0.717095 --> -0.717096).  Saving model ...
Epoch: 6 cost time: 0.9288589954376221
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.810 Vali Acc: 0.763 Test Loss: 0.810 Test Acc: 0.763
Validation loss decreased (-0.717096 --> -0.763150).  Saving model ...
Epoch: 7 cost time: 0.9379754066467285
Epoch: 7, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 0.8478908538818359
Epoch: 8, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9990036487579346
Epoch: 9, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 0.9311699867248535
Epoch: 10, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0104360580444336
Epoch: 11, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.509 Vali Acc: 0.770 Test Loss: 0.509 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0055460929870605
Epoch: 12, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0055341720581055
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 14 cost time: 0.9302053451538086
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.927020788192749
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8965294361114502
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0405571460723877
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0079784393310547
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9576730728149414
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.931250810623169
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9568581581115723
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 0.8892760276794434
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9121279716491699
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9233770370483398
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0005052089691162
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9222321510314941
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0039703845977783
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9580016136169434
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.803 Test Loss: 0.632 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8762891292572021
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9490180015563965
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0255358219146729
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 178148
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4156970977783203
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.390 Vali Acc: 0.289 Test Loss: 1.390 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.0125839710235596
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.348 Vali Acc: 0.375 Test Loss: 1.348 Test Acc: 0.375
Validation loss decreased (-0.289460 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.9300854206085205
Epoch: 3, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.286 Vali Acc: 0.507 Test Loss: 1.286 Test Acc: 0.507
Validation loss decreased (-0.374987 --> -0.506566).  Saving model ...
Epoch: 4 cost time: 1.0039558410644531
Epoch: 4, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.212 Vali Acc: 0.553 Test Loss: 1.212 Test Acc: 0.553
Validation loss decreased (-0.506566 --> -0.552619).  Saving model ...
Epoch: 5 cost time: 0.9997518062591553
Epoch: 5, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.133 Vali Acc: 0.553 Test Loss: 1.133 Test Acc: 0.553
Validation loss decreased (-0.552619 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 0.8175320625305176
Epoch: 6, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.046 Vali Acc: 0.645 Test Loss: 1.046 Test Acc: 0.645
Validation loss decreased (-0.552620 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 1.0049550533294678
Epoch: 7, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.956 Vali Acc: 0.664 Test Loss: 0.956 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 0.9261953830718994
Epoch: 8, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.870 Vali Acc: 0.671 Test Loss: 0.870 Test Acc: 0.671
Validation loss decreased (-0.664464 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 0.9020793437957764
Epoch: 9, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.789 Vali Acc: 0.704 Test Loss: 0.789 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 0.9771192073822021
Epoch: 10, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 0.9411056041717529
Epoch: 11, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.659 Vali Acc: 0.724 Test Loss: 0.659 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 12 cost time: 0.8555710315704346
Epoch: 12, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.0151336193084717
Epoch: 13, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 0.995929479598999
Epoch: 14, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736837).  Saving model ...
Epoch: 15 cost time: 0.9322731494903564
Epoch: 15, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.535 Vali Acc: 0.750 Test Loss: 0.535 Test Acc: 0.750
Validation loss decreased (-0.736837 --> -0.749995).  Saving model ...
Epoch: 16 cost time: 0.9749867916107178
Epoch: 16, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.524 Vali Acc: 0.737 Test Loss: 0.524 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9799416065216064
Epoch: 17, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.519 Vali Acc: 0.750 Test Loss: 0.519 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 18 cost time: 0.9146239757537842
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.749995 --> -0.776311).  Saving model ...
Epoch: 19 cost time: 0.9287166595458984
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.513 Vali Acc: 0.763 Test Loss: 0.513 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9233264923095703
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.517 Vali Acc: 0.757 Test Loss: 0.517 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8734283447265625
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9212369918823242
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0181150436401367
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8813848495483398
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9344396591186523
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9383533000946045
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 0.9260396957397461
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9333386421203613
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9325315952301025
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9426555633544922
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.568 Vali Acc: 0.770 Test Loss: 0.568 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9256083965301514
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9577004909515381
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0952839851379395
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.587 Vali Acc: 0.783 Test Loss: 0.587 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8992626667022705
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8546085357666016
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9727616310119629
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 167428
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.418508529663086
Epoch: 1, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.375 Vali Acc: 0.316 Test Loss: 1.375 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.8600244522094727
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.340 Vali Acc: 0.355 Test Loss: 1.340 Test Acc: 0.355
Validation loss decreased (-0.315776 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 0.8772826194763184
Epoch: 3, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.290 Vali Acc: 0.408 Test Loss: 1.290 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 0.9746561050415039
Epoch: 4, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.231 Vali Acc: 0.474 Test Loss: 1.231 Test Acc: 0.474
Validation loss decreased (-0.407882 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 0.8942108154296875
Epoch: 5, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.166 Vali Acc: 0.553 Test Loss: 1.166 Test Acc: 0.553
Validation loss decreased (-0.473672 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 0.9418411254882812
Epoch: 6, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.099 Vali Acc: 0.599 Test Loss: 1.099 Test Acc: 0.599
Validation loss decreased (-0.552620 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 0.926008939743042
Epoch: 7, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.024 Vali Acc: 0.638 Test Loss: 1.024 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638148).  Saving model ...
Epoch: 8 cost time: 0.9945223331451416
Epoch: 8, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.954 Vali Acc: 0.651 Test Loss: 0.954 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 9 cost time: 0.8736157417297363
Epoch: 9, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.878 Vali Acc: 0.691 Test Loss: 0.878 Test Acc: 0.691
Validation loss decreased (-0.651306 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 0.8754541873931885
Epoch: 10, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.810 Vali Acc: 0.704 Test Loss: 0.810 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703939).  Saving model ...
Epoch: 11 cost time: 0.9382717609405518
Epoch: 11, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.751 Vali Acc: 0.724 Test Loss: 0.751 Test Acc: 0.724
Validation loss decreased (-0.703939 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 0.9770231246948242
Epoch: 12, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 0.8984432220458984
Epoch: 13, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.650 Vali Acc: 0.730 Test Loss: 0.650 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8828125
Epoch: 14, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.613 Vali Acc: 0.743 Test Loss: 0.613 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 0.9768643379211426
Epoch: 15, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 0.8917214870452881
Epoch: 16, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 0.8674445152282715
Epoch: 17, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 0.8302702903747559
Epoch: 18, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.532 Vali Acc: 0.750 Test Loss: 0.532 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0452463626861572
Epoch: 19, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.527 Vali Acc: 0.743 Test Loss: 0.527 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8806192874908447
Epoch: 20, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8458325862884521
Epoch: 21, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.523 Vali Acc: 0.757 Test Loss: 0.523 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9352035522460938
Epoch: 22, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 23 cost time: 0.9433610439300537
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 24 cost time: 0.8791999816894531
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 25 cost time: 1.0001702308654785
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9262828826904297
Epoch: 26, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9310927391052246
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 0.919611930847168
Epoch: 28, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8922498226165771
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.937286376953125
Epoch: 30, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8696091175079346
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7981808185577393
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9555420875549316
Epoch: 33, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9113049507141113
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8587017059326172
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.961052417755127
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9393000602722168
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 162884
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.72670316696167
Epoch: 1, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.341 Vali Acc: 0.375 Test Loss: 1.341 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.9213442802429199
Epoch: 2, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.306 Vali Acc: 0.408 Test Loss: 1.306 Test Acc: 0.408
Validation loss decreased (-0.374987 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.0022475719451904
Epoch: 3, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.254 Vali Acc: 0.493 Test Loss: 1.254 Test Acc: 0.493
Validation loss decreased (-0.407882 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.0011587142944336
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.193 Vali Acc: 0.579 Test Loss: 1.193 Test Acc: 0.579
Validation loss decreased (-0.493409 --> -0.578935).  Saving model ...
Epoch: 5 cost time: 0.8046841621398926
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.123 Vali Acc: 0.645 Test Loss: 1.123 Test Acc: 0.645
Validation loss decreased (-0.578935 --> -0.644726).  Saving model ...
Epoch: 6 cost time: 0.8722164630889893
Epoch: 6, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.050 Vali Acc: 0.684 Test Loss: 1.050 Test Acc: 0.684
Validation loss decreased (-0.644726 --> -0.684200).  Saving model ...
Epoch: 7 cost time: 0.9120044708251953
Epoch: 7, Steps: 10 | Train Loss: 0.880 Vali Loss: 0.979 Vali Acc: 0.697 Test Loss: 0.979 Test Acc: 0.697
Validation loss decreased (-0.684200 --> -0.697359).  Saving model ...
Epoch: 8 cost time: 0.8936026096343994
Epoch: 8, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.900 Vali Acc: 0.717 Test Loss: 0.900 Test Acc: 0.717
Validation loss decreased (-0.697359 --> -0.717096).  Saving model ...
Epoch: 9 cost time: 0.8964061737060547
Epoch: 9, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.826 Vali Acc: 0.763 Test Loss: 0.826 Test Acc: 0.763
Validation loss decreased (-0.717096 --> -0.763150).  Saving model ...
Epoch: 10 cost time: 0.9038317203521729
Epoch: 10, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.756 Vali Acc: 0.776 Test Loss: 0.756 Test Acc: 0.776
Validation loss decreased (-0.763150 --> -0.776308).  Saving model ...
Epoch: 11 cost time: 0.9471728801727295
Epoch: 11, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 0.9535560607910156
Epoch: 12, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 13 cost time: 1.035970687866211
Epoch: 13, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.606 Vali Acc: 0.776 Test Loss: 0.606 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.979910135269165
Epoch: 14, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 0.9395308494567871
Epoch: 15, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 0.9390113353729248
Epoch: 16, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 0.9785354137420654
Epoch: 17, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 18 cost time: 1.0329668521881104
Epoch: 18, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 0.8782608509063721
Epoch: 19, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 20 cost time: 0.8445398807525635
Epoch: 20, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9730677604675293
Epoch: 21, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.489 Vali Acc: 0.796 Test Loss: 0.489 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 0.9949319362640381
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9694416522979736
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.488 Vali Acc: 0.783 Test Loss: 0.488 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8702049255371094
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0298230648040771
Epoch: 25, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.495 Vali Acc: 0.789 Test Loss: 0.495 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9210014343261719
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9965600967407227
Epoch: 27, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9541645050048828
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9654946327209473
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0130870342254639
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 0.8110430240631104
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8610930442810059
Epoch: 32, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9893467426300049
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.925950288772583
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8604593276977539
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8512916564941406
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8817901611328125
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9783270359039307
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8594624996185303
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.893855094909668
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 162916
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6309046745300293
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.384 Vali Acc: 0.283 Test Loss: 1.384 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.9847109317779541
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.357 Vali Acc: 0.289 Test Loss: 1.357 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.9574952125549316
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.318 Vali Acc: 0.329 Test Loss: 1.318 Test Acc: 0.329
Validation loss decreased (-0.289460 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 0.8725829124450684
Epoch: 4, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.269 Vali Acc: 0.480 Test Loss: 1.269 Test Acc: 0.480
Validation loss decreased (-0.328934 --> -0.480250).  Saving model ...
Epoch: 5 cost time: 0.9399623870849609
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.218 Vali Acc: 0.533 Test Loss: 1.218 Test Acc: 0.533
Validation loss decreased (-0.480250 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 0.9960620403289795
Epoch: 6, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.158 Vali Acc: 0.566 Test Loss: 1.158 Test Acc: 0.566
Validation loss decreased (-0.532883 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 0.9598016738891602
Epoch: 7, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.092 Vali Acc: 0.632 Test Loss: 1.092 Test Acc: 0.632
Validation loss decreased (-0.565778 --> -0.631568).  Saving model ...
Epoch: 8 cost time: 0.9133529663085938
Epoch: 8, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.030 Vali Acc: 0.678 Test Loss: 1.030 Test Acc: 0.678
Validation loss decreased (-0.631568 --> -0.677621).  Saving model ...
Epoch: 9 cost time: 0.9611625671386719
Epoch: 9, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.968 Vali Acc: 0.684 Test Loss: 0.968 Test Acc: 0.684
Validation loss decreased (-0.677621 --> -0.684201).  Saving model ...
Epoch: 10 cost time: 0.9651780128479004
Epoch: 10, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.900 Vali Acc: 0.697 Test Loss: 0.900 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697359).  Saving model ...
Epoch: 11 cost time: 0.9741325378417969
Epoch: 11, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.839 Vali Acc: 0.730 Test Loss: 0.839 Test Acc: 0.730
Validation loss decreased (-0.697359 --> -0.730255).  Saving model ...
Epoch: 12 cost time: 0.8945529460906982
Epoch: 12, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.780 Vali Acc: 0.730 Test Loss: 0.780 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730255).  Saving model ...
Epoch: 13 cost time: 0.8598403930664062
Epoch: 13, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 0.9924824237823486
Epoch: 14, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 0.9613034725189209
Epoch: 15, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 0.9917037487030029
Epoch: 16, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 0.8870344161987305
Epoch: 17, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 0.9178531169891357
Epoch: 18, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.969810962677002
Epoch: 19, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 1.0025081634521484
Epoch: 20, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8657855987548828
Epoch: 21, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9065449237823486
Epoch: 22, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9482157230377197
Epoch: 23, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 24 cost time: 0.9601056575775146
Epoch: 24, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 25 cost time: 1.0507526397705078
Epoch: 25, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 26 cost time: 0.9981615543365479
Epoch: 26, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9650652408599854
Epoch: 27, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9847090244293213
Epoch: 28, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.981299877166748
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9437534809112549
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9216189384460449
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 32 cost time: 0.9418282508850098
Epoch: 32, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.935032844543457
Epoch: 33, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9699280261993408
Epoch: 34, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8606488704681396
Epoch: 35, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9324195384979248
Epoch: 36, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.565 Vali Acc: 0.803 Test Loss: 0.565 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7986860275268555
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9902443885803223
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9328994750976562
Epoch: 39, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.917823076248169
Epoch: 40, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0585334300994873
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 161444
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.621659994125366
Epoch: 1, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.091 Vali Acc: 0.599 Test Loss: 1.091 Test Acc: 0.599
Validation loss decreased (inf --> -0.598673).  Saving model ...
Epoch: 2 cost time: 1.2258355617523193
Epoch: 2, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.685 Vali Acc: 0.730 Test Loss: 0.685 Test Acc: 0.730
Validation loss decreased (-0.598673 --> -0.730256).  Saving model ...
Epoch: 3 cost time: 1.2610220909118652
Epoch: 3, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769732).  Saving model ...
Epoch: 4 cost time: 1.2746937274932861
Epoch: 4, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782889).  Saving model ...
Epoch: 5 cost time: 1.270362377166748
Epoch: 5, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2927093505859375
Epoch: 6, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.688 Vali Acc: 0.776 Test Loss: 0.688 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2129194736480713
Epoch: 7, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.27288818359375
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.783 Test Loss: 0.732 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2792513370513916
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.776 Test Loss: 0.756 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.284031629562378
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.796 Test Loss: 0.777 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796045).  Saving model ...
Epoch: 11 cost time: 1.3153600692749023
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.803 Test Loss: 0.785 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802624).  Saving model ...
Epoch: 12 cost time: 1.2573840618133545
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.783 Test Loss: 0.793 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.305328130722046
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2240333557128906
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2586121559143066
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2667906284332275
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.783 Test Loss: 0.819 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2346916198730469
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.796 Test Loss: 0.820 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3151230812072754
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.789 Test Loss: 0.835 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2307190895080566
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.789 Test Loss: 0.843 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.186063289642334
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.789 Test Loss: 0.847 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2320857048034668
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.783 Test Loss: 0.852 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1838596
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.699885368347168
Epoch: 1, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.117 Vali Acc: 0.539 Test Loss: 1.117 Test Acc: 0.539
Validation loss decreased (inf --> -0.539463).  Saving model ...
Epoch: 2 cost time: 1.308262825012207
Epoch: 2, Steps: 10 | Train Loss: 0.638 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
Validation loss decreased (-0.539463 --> -0.736835).  Saving model ...
Epoch: 3 cost time: 1.2881271839141846
Epoch: 3, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.546 Vali Acc: 0.737 Test Loss: 0.546 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736837).  Saving model ...
Epoch: 4 cost time: 1.257934808731079
Epoch: 4, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
Validation loss decreased (-0.736837 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.2840723991394043
Epoch: 5, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 6 cost time: 1.2751173973083496
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 7 cost time: 1.216700553894043
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.704 Vali Acc: 0.776 Test Loss: 0.704 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3224539756774902
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.715 Vali Acc: 0.789 Test Loss: 0.715 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2590875625610352
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.776 Test Loss: 0.729 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3088672161102295
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2176620960235596
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3109171390533447
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2906198501586914
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.789 Test Loss: 0.762 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2702031135559082
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.783 Test Loss: 0.773 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.277129888534546
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.783 Test Loss: 0.773 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3901312351226807
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 17 cost time: 1.392481803894043
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.796 Test Loss: 0.791 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3414390087127686
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.796 Test Loss: 0.801 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2736313343048096
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.789 Test Loss: 0.812 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3759615421295166
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.789 Test Loss: 0.816 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2244436740875244
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.193655252456665
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.776 Test Loss: 0.838 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3694393634796143
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.783 Test Loss: 0.842 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3172261714935303
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.783 Test Loss: 0.852 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3501551151275635
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.783 Test Loss: 0.855 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3189430236816406
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.789 Test Loss: 0.870 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1838852
model size : 7.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.754352331161499
Epoch: 1, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.215 Vali Acc: 0.474 Test Loss: 1.215 Test Acc: 0.474
Validation loss decreased (inf --> -0.473672).  Saving model ...
Epoch: 2 cost time: 1.039684772491455
Epoch: 2, Steps: 10 | Train Loss: 0.938 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
Validation loss decreased (-0.473672 --> -0.710518).  Saving model ...
Epoch: 3 cost time: 1.1920952796936035
Epoch: 3, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.649 Vali Acc: 0.770 Test Loss: 0.649 Test Acc: 0.770
Validation loss decreased (-0.710518 --> -0.769730).  Saving model ...
Epoch: 4 cost time: 1.07598876953125
Epoch: 4, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.551 Vali Acc: 0.763 Test Loss: 0.551 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2013444900512695
Epoch: 5, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.1226592063903809
Epoch: 6, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.514 Vali Acc: 0.816 Test Loss: 0.514 Test Acc: 0.816
Validation loss decreased (-0.776310 --> -0.815784).  Saving model ...
Epoch: 7 cost time: 1.232013463973999
Epoch: 7, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0852024555206299
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1342246532440186
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.049814224243164
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1351888179779053
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.789 Test Loss: 0.639 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1833853721618652
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.651 Vali Acc: 0.776 Test Loss: 0.651 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1567189693450928
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9668123722076416
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1515178680419922
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0389318466186523
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1746948
model size : 6.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.770664930343628
Epoch: 1, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.312 Vali Acc: 0.414 Test Loss: 1.312 Test Acc: 0.414
Validation loss decreased (inf --> -0.414461).  Saving model ...
Epoch: 2 cost time: 1.0417933464050293
Epoch: 2, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.023 Vali Acc: 0.605 Test Loss: 1.023 Test Acc: 0.605
Validation loss decreased (-0.414461 --> -0.605253).  Saving model ...
Epoch: 3 cost time: 1.1348562240600586
Epoch: 3, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.777 Vali Acc: 0.678 Test Loss: 0.777 Test Acc: 0.678
Validation loss decreased (-0.605253 --> -0.677624).  Saving model ...
Epoch: 4 cost time: 1.1605424880981445
Epoch: 4, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.677624 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.089395523071289
Epoch: 5, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.052903413772583
Epoch: 6, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.026813268661499
Epoch: 7, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.073899269104004
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.065478801727295
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.0136678218841553
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1312329769134521
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0478432178497314
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 1.1354153156280518
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.626 Vali Acc: 0.789 Test Loss: 0.626 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2134482860565186
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2175841331481934
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.097416639328003
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.655 Vali Acc: 0.803 Test Loss: 0.655 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 1.1428699493408203
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0679335594177246
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1343295574188232
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0953404903411865
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0626580715179443
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1417040824890137
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.156334638595581
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.796 Test Loss: 0.704 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0586297512054443
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.796 Test Loss: 0.714 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1075975894927979
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0499584674835205
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.809 Test Loss: 0.736 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 27 cost time: 1.0511059761047363
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.796 Test Loss: 0.744 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.037876844406128
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.803 Test Loss: 0.750 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0666189193725586
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.752 Vali Acc: 0.803 Test Loss: 0.752 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0425610542297363
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0927095413208008
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.803 Test Loss: 0.760 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0957789421081543
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.763 Vali Acc: 0.803 Test Loss: 0.763 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9812564849853516
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.796 Test Loss: 0.766 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0306270122528076
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.796 Test Loss: 0.771 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.115912675857544
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.796 Test Loss: 0.770 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1003961563110352
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.796 Test Loss: 0.780 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1716740
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.695702314376831
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.287 Vali Acc: 0.408 Test Loss: 1.287 Test Acc: 0.408
Validation loss decreased (inf --> -0.407882).  Saving model ...
Epoch: 2 cost time: 1.1993770599365234
Epoch: 2, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.003 Vali Acc: 0.671 Test Loss: 1.003 Test Acc: 0.671
Validation loss decreased (-0.407882 --> -0.671043).  Saving model ...
Epoch: 3 cost time: 1.148550033569336
Epoch: 3, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.771 Vali Acc: 0.743 Test Loss: 0.771 Test Acc: 0.743
Validation loss decreased (-0.671043 --> -0.743413).  Saving model ...
Epoch: 4 cost time: 1.1383388042449951
Epoch: 4, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.662 Vali Acc: 0.757 Test Loss: 0.662 Test Acc: 0.757
Validation loss decreased (-0.743413 --> -0.756572).  Saving model ...
Epoch: 5 cost time: 1.1076939105987549
Epoch: 5, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0965549945831299
Epoch: 6, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.0584001541137695
Epoch: 7, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.0398344993591309
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0283551216125488
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1175813674926758
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1469676494598389
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.166337251663208
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.067746639251709
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 14 cost time: 1.1975960731506348
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.681 Vali Acc: 0.776 Test Loss: 0.681 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0831940174102783
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.698 Vali Acc: 0.776 Test Loss: 0.698 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1466681957244873
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.701 Vali Acc: 0.776 Test Loss: 0.701 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.072479009628296
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.770 Test Loss: 0.722 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.224151849746704
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.776 Test Loss: 0.727 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.112365961074829
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1265223026275635
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0732362270355225
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.752 Vali Acc: 0.776 Test Loss: 0.752 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1713144779205322
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.755 Vali Acc: 0.776 Test Loss: 0.755 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.162196397781372
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.764 Vali Acc: 0.783 Test Loss: 0.764 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1716996
model size : 6.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5058295726776123
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.338 Vali Acc: 0.434 Test Loss: 1.338 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.128580093383789
Epoch: 2, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.109 Vali Acc: 0.612 Test Loss: 1.109 Test Acc: 0.612
Validation loss decreased (-0.434197 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 1.0844554901123047
Epoch: 3, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.873 Vali Acc: 0.697 Test Loss: 0.873 Test Acc: 0.697
Validation loss decreased (-0.611831 --> -0.697360).  Saving model ...
Epoch: 4 cost time: 1.1043193340301514
Epoch: 4, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.717 Vali Acc: 0.757 Test Loss: 0.717 Test Acc: 0.757
Validation loss decreased (-0.697360 --> -0.756572).  Saving model ...
Epoch: 5 cost time: 1.1132493019104004
Epoch: 5, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.0352840423583984
Epoch: 6, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.122908115386963
Epoch: 7, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.159660816192627
Epoch: 8, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.561 Vali Acc: 0.750 Test Loss: 0.561 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1442632675170898
Epoch: 9, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0951528549194336
Epoch: 10, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.586 Vali Acc: 0.776 Test Loss: 0.586 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.179241418838501
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.121511459350586
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.613 Vali Acc: 0.770 Test Loss: 0.613 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.07578444480896
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.630 Vali Acc: 0.763 Test Loss: 0.630 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1351301670074463
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.638 Vali Acc: 0.776 Test Loss: 0.638 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2290174961090088
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1734600067138672
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1131975650787354
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 18 cost time: 1.2025110721588135
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 19 cost time: 1.2845139503479004
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2930169105529785
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2156174182891846
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2387182712554932
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2159271240234375
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.276932954788208
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2213499546051025
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1639189720153809
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.255011796951294
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1123552322387695
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1699076
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.787968873977661
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.278 Vali Acc: 0.447 Test Loss: 1.278 Test Acc: 0.447
Validation loss decreased (inf --> -0.447356).  Saving model ...
Epoch: 2 cost time: 1.0223596096038818
Epoch: 2, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.910 Vali Acc: 0.625 Test Loss: 0.910 Test Acc: 0.625
Validation loss decreased (-0.447356 --> -0.624991).  Saving model ...
Epoch: 3 cost time: 1.0771021842956543
Epoch: 3, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
Validation loss decreased (-0.624991 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 1.2367377281188965
Epoch: 4, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.578 Vali Acc: 0.730 Test Loss: 0.578 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 5 cost time: 1.0295062065124512
Epoch: 5, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.11195969581604
Epoch: 6, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.0737898349761963
Epoch: 7, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.048360824584961
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.605 Vali Acc: 0.776 Test Loss: 0.605 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.0237882137298584
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.635 Vali Acc: 0.796 Test Loss: 0.635 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796046).  Saving model ...
Epoch: 10 cost time: 1.034487247467041
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.642 Vali Acc: 0.783 Test Loss: 0.642 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9548037052154541
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9906837940216064
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.673 Vali Acc: 0.776 Test Loss: 0.673 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9962000846862793
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1124954223632812
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.709 Vali Acc: 0.776 Test Loss: 0.709 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1084635257720947
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.776 Test Loss: 0.723 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0580735206604004
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2434337139129639
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0496525764465332
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.748 Vali Acc: 0.783 Test Loss: 0.748 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1634528636932373
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.748 Vali Acc: 0.783 Test Loss: 0.748 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 526084
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.286017894744873
Epoch: 1, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.219 Vali Acc: 0.454 Test Loss: 1.219 Test Acc: 0.454
Validation loss decreased (inf --> -0.453935).  Saving model ...
Epoch: 2 cost time: 0.8096933364868164
Epoch: 2, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.857 Vali Acc: 0.671 Test Loss: 0.857 Test Acc: 0.671
Validation loss decreased (-0.453935 --> -0.671044).  Saving model ...
Epoch: 3 cost time: 0.9743878841400146
Epoch: 3, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.652 Vali Acc: 0.730 Test Loss: 0.652 Test Acc: 0.730
Validation loss decreased (-0.671044 --> -0.730257).  Saving model ...
Epoch: 4 cost time: 0.9555466175079346
Epoch: 4, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
Validation loss decreased (-0.730257 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 1.1145455837249756
Epoch: 5, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.101409673690796
Epoch: 6, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.0065536499023438
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.15360426902771
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1084017753601074
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.637 Vali Acc: 0.770 Test Loss: 0.637 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.064218282699585
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.655 Vali Acc: 0.763 Test Loss: 0.655 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2510194778442383
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.664 Vali Acc: 0.770 Test Loss: 0.664 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.108860731124878
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.031167984008789
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0582165718078613
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.699 Vali Acc: 0.770 Test Loss: 0.699 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1126375198364258
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.776 Test Loss: 0.708 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0830130577087402
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.770 Test Loss: 0.713 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1040072441101074
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.763 Test Loss: 0.729 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 526212
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6064209938049316
Epoch: 1, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.298 Vali Acc: 0.447 Test Loss: 1.298 Test Acc: 0.447
Validation loss decreased (inf --> -0.447355).  Saving model ...
Epoch: 2 cost time: 1.0461440086364746
Epoch: 2, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.074 Vali Acc: 0.579 Test Loss: 1.074 Test Acc: 0.579
Validation loss decreased (-0.447355 --> -0.578937).  Saving model ...
Epoch: 3 cost time: 0.934326171875
Epoch: 3, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.856 Vali Acc: 0.651 Test Loss: 0.856 Test Acc: 0.651
Validation loss decreased (-0.578937 --> -0.651307).  Saving model ...
Epoch: 4 cost time: 1.018855094909668
Epoch: 4, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.714 Vali Acc: 0.691 Test Loss: 0.714 Test Acc: 0.691
Validation loss decreased (-0.651307 --> -0.690782).  Saving model ...
Epoch: 5 cost time: 0.9685788154602051
Epoch: 5, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.619 Vali Acc: 0.724 Test Loss: 0.619 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723678).  Saving model ...
Epoch: 6 cost time: 0.9351174831390381
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
Validation loss decreased (-0.723678 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.064037561416626
Epoch: 7, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.017390489578247
Epoch: 8, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.018211841583252
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0102241039276123
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0574531555175781
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.0795700550079346
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.10038161277771
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0853173732757568
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.11873197555542
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.996985673904419
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.972524881362915
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9028089046478271
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.622 Vali Acc: 0.776 Test Loss: 0.622 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0159707069396973
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 0.9617612361907959
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9922988414764404
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.656 Vali Acc: 0.789 Test Loss: 0.656 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.092031717300415
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.07173752784729
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0250062942504883
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9948787689208984
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0293002128601074
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.099679708480835
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9606010913848877
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9910304546356201
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 480260
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6751821041107178
Epoch: 1, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.244 Vali Acc: 0.546 Test Loss: 1.244 Test Acc: 0.546
Validation loss decreased (inf --> -0.546040).  Saving model ...
Epoch: 2 cost time: 1.0490124225616455
Epoch: 2, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.074 Vali Acc: 0.658 Test Loss: 1.074 Test Acc: 0.658
Validation loss decreased (-0.546040 --> -0.657884).  Saving model ...
Epoch: 3 cost time: 0.936901330947876
Epoch: 3, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.890 Vali Acc: 0.658 Test Loss: 0.890 Test Acc: 0.658
Validation loss decreased (-0.657884 --> -0.657886).  Saving model ...
Epoch: 4 cost time: 0.9591681957244873
Epoch: 4, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.742 Vali Acc: 0.697 Test Loss: 0.742 Test Acc: 0.697
Validation loss decreased (-0.657886 --> -0.697361).  Saving model ...
Epoch: 5 cost time: 1.000840663909912
Epoch: 5, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.651 Vali Acc: 0.737 Test Loss: 0.651 Test Acc: 0.737
Validation loss decreased (-0.697361 --> -0.736836).  Saving model ...
Epoch: 6 cost time: 0.937164306640625
Epoch: 6, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
Validation loss decreased (-0.736836 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.0018632411956787
Epoch: 7, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9057421684265137
Epoch: 8, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8861434459686279
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 10 cost time: 0.911179780960083
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 0.9067447185516357
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.829444169998169
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9576616287231445
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 0.84189772605896
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.994476318359375
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9338386058807373
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9057996273040771
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.553 Vali Acc: 0.776 Test Loss: 0.553 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9177894592285156
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9206833839416504
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9090185165405273
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9533514976501465
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9713540077209473
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8721375465393066
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 465156
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.354860305786133
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.306 Vali Acc: 0.395 Test Loss: 1.306 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 0.9904482364654541
Epoch: 2, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.136 Vali Acc: 0.612 Test Loss: 1.136 Test Acc: 0.612
Validation loss decreased (-0.394724 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 0.9795985221862793
Epoch: 3, Steps: 10 | Train Loss: 0.899 Vali Loss: 0.951 Vali Acc: 0.658 Test Loss: 0.951 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657885).  Saving model ...
Epoch: 4 cost time: 1.0601465702056885
Epoch: 4, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.787 Vali Acc: 0.724 Test Loss: 0.787 Test Acc: 0.724
Validation loss decreased (-0.657885 --> -0.723676).  Saving model ...
Epoch: 5 cost time: 0.9604759216308594
Epoch: 5, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.681 Vali Acc: 0.757 Test Loss: 0.681 Test Acc: 0.757
Validation loss decreased (-0.723676 --> -0.756572).  Saving model ...
Epoch: 6 cost time: 0.9342849254608154
Epoch: 6, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 0.9810285568237305
Epoch: 7, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 0.9897778034210205
Epoch: 8, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9945647716522217
Epoch: 9, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.542 Vali Acc: 0.757 Test Loss: 0.542 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8630654811859131
Epoch: 10, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 0.9602229595184326
Epoch: 11, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0694468021392822
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 0.9787251949310303
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9818987846374512
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 0.9844527244567871
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.111276388168335
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.211829423904419
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.162285566329956
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0809307098388672
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1072654724121094
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0451948642730713
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1639766693115234
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.040299654006958
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0337107181549072
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 465284
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8355233669281006
Epoch: 1, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.339 Vali Acc: 0.329 Test Loss: 1.339 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.049607276916504
Epoch: 2, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.328934 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.0346338748931885
Epoch: 3, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.077 Vali Acc: 0.579 Test Loss: 1.077 Test Acc: 0.579
Validation loss decreased (-0.499988 --> -0.578937).  Saving model ...
Epoch: 4 cost time: 1.035240888595581
Epoch: 4, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.943 Vali Acc: 0.605 Test Loss: 0.943 Test Acc: 0.605
Validation loss decreased (-0.578937 --> -0.605254).  Saving model ...
Epoch: 5 cost time: 1.0569331645965576
Epoch: 5, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.823 Vali Acc: 0.691 Test Loss: 0.823 Test Acc: 0.691
Validation loss decreased (-0.605254 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.0182409286499023
Epoch: 6, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.747 Vali Acc: 0.691 Test Loss: 0.747 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 7 cost time: 0.960134744644165
Epoch: 7, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.688 Vali Acc: 0.717 Test Loss: 0.688 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.0209603309631348
Epoch: 8, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.644 Vali Acc: 0.717 Test Loss: 0.644 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 9 cost time: 1.0541675090789795
Epoch: 9, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.717099 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.0663480758666992
Epoch: 10, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.0131139755249023
Epoch: 11, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.0869386196136475
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0264918804168701
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0022151470184326
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.064558744430542
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 0.9402315616607666
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9340479373931885
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 0.970482349395752
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 0.9687166213989258
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.999976396560669
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 0.9097270965576172
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8924462795257568
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0078201293945312
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 24 cost time: 0.9570717811584473
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.632 Vali Acc: 0.796 Test Loss: 0.632 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9905683994293213
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 26 cost time: 1.0335493087768555
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9246339797973633
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.010425090789795
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9751217365264893
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0494194030761719
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0749948024749756
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.672 Vali Acc: 0.803 Test Loss: 0.672 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0165619850158691
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0001230239868164
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.691 Vali Acc: 0.803 Test Loss: 0.691 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.020226001739502
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.698 Vali Acc: 0.803 Test Loss: 0.698 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9886140823364258
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 36 cost time: 0.9646320343017578
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.809 Test Loss: 0.712 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0221943855285645
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.809 Test Loss: 0.718 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9568765163421631
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.724 Vali Acc: 0.816 Test Loss: 0.724 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815782).  Saving model ...
Epoch: 39 cost time: 0.9986410140991211
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.816 Test Loss: 0.732 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0302886962890625
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.733 Vali Acc: 0.816 Test Loss: 0.733 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.061391830444336
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0427889823913574
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.816 Test Loss: 0.744 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0463154315948486
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.752 Vali Acc: 0.816 Test Loss: 0.752 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9262332916259766
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.809 Test Loss: 0.766 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.021897792816162
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.809 Test Loss: 0.777 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9435968399047852
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9079940319061279
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.793 Vali Acc: 0.809 Test Loss: 0.793 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9511170387268066
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.809 Test Loss: 0.807 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 456324
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.638195037841797
Epoch: 1, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.299 Vali Acc: 0.434 Test Loss: 1.299 Test Acc: 0.434
Validation loss decreased (inf --> -0.434198).  Saving model ...
Epoch: 2 cost time: 0.8829085826873779
Epoch: 2, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.085 Vali Acc: 0.599 Test Loss: 1.085 Test Acc: 0.599
Validation loss decreased (-0.434198 --> -0.598673).  Saving model ...
Epoch: 3 cost time: 0.8158788681030273
Epoch: 3, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.844 Vali Acc: 0.691 Test Loss: 0.844 Test Acc: 0.691
Validation loss decreased (-0.598673 --> -0.690781).  Saving model ...
Epoch: 4 cost time: 0.972405195236206
Epoch: 4, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
Validation loss decreased (-0.690781 --> -0.756572).  Saving model ...
Epoch: 5 cost time: 0.8442234992980957
Epoch: 5, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 0.8522627353668213
Epoch: 6, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7731759548187256
Epoch: 7, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 0.9250891208648682
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8263249397277832
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8664107322692871
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9215245246887207
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.956188440322876
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9168877601623535
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.770 Test Loss: 0.599 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8981151580810547
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8908276557922363
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.066575288772583
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9641234874725342
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.640 Vali Acc: 0.770 Test Loss: 0.640 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 164740
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5550975799560547
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.335 Vali Acc: 0.322 Test Loss: 1.335 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 0.9355800151824951
Epoch: 2, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.087 Vali Acc: 0.605 Test Loss: 1.087 Test Acc: 0.605
Validation loss decreased (-0.322355 --> -0.605252).  Saving model ...
Epoch: 3 cost time: 0.8719050884246826
Epoch: 3, Steps: 10 | Train Loss: 0.749 Vali Loss: 0.841 Vali Acc: 0.678 Test Loss: 0.841 Test Acc: 0.678
Validation loss decreased (-0.605252 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 0.8975222110748291
Epoch: 4, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.683 Vali Acc: 0.730 Test Loss: 0.683 Test Acc: 0.730
Validation loss decreased (-0.677623 --> -0.730256).  Saving model ...
Epoch: 5 cost time: 0.9155161380767822
Epoch: 5, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
Validation loss decreased (-0.730256 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 0.9501168727874756
Epoch: 6, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9206101894378662
Epoch: 7, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.534 Vali Acc: 0.763 Test Loss: 0.534 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.057873249053955
Epoch: 8, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9345436096191406
Epoch: 9, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9695639610290527
Epoch: 10, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0151124000549316
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 0.8308267593383789
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8884463310241699
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9540197849273682
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7993552684783936
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9759902954101562
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8421046733856201
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.789 Test Loss: 0.607 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 0.9369428157806396
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0230629444122314
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.999363899230957
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0806529521942139
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9723272323608398
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 23 cost time: 0.9903855323791504
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 24 cost time: 0.8516209125518799
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0158882141113281
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.661 Vali Acc: 0.796 Test Loss: 0.661 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9060263633728027
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8446676731109619
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8433136940002441
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8528101444244385
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7768018245697021
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7820031642913818
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8282613754272461
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.783 Test Loss: 0.705 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7329010963439941
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.701 Vali Acc: 0.789 Test Loss: 0.701 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 164804
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.312830924987793
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.380 Vali Acc: 0.289 Test Loss: 1.380 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.6992456912994385
Epoch: 2, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.243 Vali Acc: 0.447 Test Loss: 1.243 Test Acc: 0.447
Validation loss decreased (-0.289460 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 0.8093490600585938
Epoch: 3, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.075 Vali Acc: 0.513 Test Loss: 1.075 Test Acc: 0.513
Validation loss decreased (-0.447356 --> -0.513147).  Saving model ...
Epoch: 4 cost time: 0.9444081783294678
Epoch: 4, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.924 Vali Acc: 0.612 Test Loss: 0.924 Test Acc: 0.612
Validation loss decreased (-0.513147 --> -0.611833).  Saving model ...
Epoch: 5 cost time: 0.9384415149688721
Epoch: 5, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.798 Vali Acc: 0.684 Test Loss: 0.798 Test Acc: 0.684
Validation loss decreased (-0.611833 --> -0.684203).  Saving model ...
Epoch: 6 cost time: 0.9194133281707764
Epoch: 6, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.716 Vali Acc: 0.711 Test Loss: 0.716 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 1.008364200592041
Epoch: 7, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.659 Vali Acc: 0.724 Test Loss: 0.659 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 8 cost time: 0.9158651828765869
Epoch: 8, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.616 Vali Acc: 0.730 Test Loss: 0.616 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 0.8782556056976318
Epoch: 9, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.9643762111663818
Epoch: 10, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.576 Vali Acc: 0.743 Test Loss: 0.576 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9330389499664307
Epoch: 11, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8592791557312012
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.8706371784210205
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8186793327331543
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.565 Vali Acc: 0.750 Test Loss: 0.565 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8461894989013672
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 0.9200839996337891
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8339450359344482
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 0.8107922077178955
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8780066967010498
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8254151344299316
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8378398418426514
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9751267433166504
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8584434986114502
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9171314239501953
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.932408332824707
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 0.826732873916626
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8893229961395264
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.630 Vali Acc: 0.770 Test Loss: 0.630 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8578243255615234
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.635 Vali Acc: 0.776 Test Loss: 0.635 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8306257724761963
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.639 Vali Acc: 0.776 Test Loss: 0.639 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8690242767333984
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.770 Test Loss: 0.643 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8424813747406006
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8767781257629395
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9074482917785645
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.654 Vali Acc: 0.770 Test Loss: 0.654 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8750350475311279
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9328536987304688
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.668 Vali Acc: 0.770 Test Loss: 0.668 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 141828
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6435749530792236
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.352 Vali Acc: 0.382 Test Loss: 1.352 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 0.9365661144256592
Epoch: 2, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.248 Vali Acc: 0.579 Test Loss: 1.248 Test Acc: 0.579
Validation loss decreased (-0.381565 --> -0.578935).  Saving model ...
Epoch: 3 cost time: 0.8240289688110352
Epoch: 3, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.113 Vali Acc: 0.618 Test Loss: 1.113 Test Acc: 0.618
Validation loss decreased (-0.578935 --> -0.618410).  Saving model ...
Epoch: 4 cost time: 0.9949193000793457
Epoch: 4, Steps: 10 | Train Loss: 0.922 Vali Loss: 0.979 Vali Acc: 0.664 Test Loss: 0.979 Test Acc: 0.664
Validation loss decreased (-0.618410 --> -0.664464).  Saving model ...
Epoch: 5 cost time: 0.9572477340698242
Epoch: 5, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.858 Vali Acc: 0.724 Test Loss: 0.858 Test Acc: 0.724
Validation loss decreased (-0.664464 --> -0.723676).  Saving model ...
Epoch: 6 cost time: 0.8878834247589111
Epoch: 6, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.765 Vali Acc: 0.724 Test Loss: 0.765 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 0.9106345176696777
Epoch: 7, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.701 Vali Acc: 0.737 Test Loss: 0.701 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 0.8487880229949951
Epoch: 8, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 0.8812644481658936
Epoch: 9, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 0.8636200428009033
Epoch: 10, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 0.8877661228179932
Epoch: 11, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 12 cost time: 0.9145655632019043
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769732).  Saving model ...
Epoch: 13 cost time: 0.8506443500518799
Epoch: 13, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 14 cost time: 0.9072039127349854
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 15 cost time: 0.9857966899871826
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.505 Vali Acc: 0.763 Test Loss: 0.505 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9287106990814209
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.505 Vali Acc: 0.757 Test Loss: 0.505 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8750452995300293
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.504 Vali Acc: 0.770 Test Loss: 0.504 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.012091875076294
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.503 Vali Acc: 0.770 Test Loss: 0.503 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8794174194335938
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.503 Vali Acc: 0.770 Test Loss: 0.503 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9379289150238037
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.506 Vali Acc: 0.763 Test Loss: 0.506 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0171399116516113
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.508 Vali Acc: 0.776 Test Loss: 0.508 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 22 cost time: 0.9672045707702637
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 23 cost time: 0.9168791770935059
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0445506572723389
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8480160236358643
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0012657642364502
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.901371955871582
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9104435443878174
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0028471946716309
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8771758079528809
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9132583141326904
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9338469505310059
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 134276
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.533101797103882
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.380 Vali Acc: 0.316 Test Loss: 1.380 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.806403398513794
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.288 Vali Acc: 0.401 Test Loss: 1.288 Test Acc: 0.401
Validation loss decreased (-0.315776 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 0.7863616943359375
Epoch: 3, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.161 Vali Acc: 0.513 Test Loss: 1.161 Test Acc: 0.513
Validation loss decreased (-0.401303 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 0.8206498622894287
Epoch: 4, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.032 Vali Acc: 0.632 Test Loss: 1.032 Test Acc: 0.632
Validation loss decreased (-0.513146 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 0.8138988018035889
Epoch: 5, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.917 Vali Acc: 0.684 Test Loss: 0.917 Test Acc: 0.684
Validation loss decreased (-0.631569 --> -0.684201).  Saving model ...
Epoch: 6 cost time: 0.7958457469940186
Epoch: 6, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.819 Vali Acc: 0.697 Test Loss: 0.819 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 0.7557342052459717
Epoch: 7, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.744 Vali Acc: 0.697 Test Loss: 0.744 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 0.8130249977111816
Epoch: 8, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.686 Vali Acc: 0.730 Test Loss: 0.686 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 0.8733954429626465
Epoch: 9, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 0.8463432788848877
Epoch: 10, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 0.91965651512146
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 0.8795692920684814
Epoch: 12, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 0.9587945938110352
Epoch: 13, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 0.877335786819458
Epoch: 14, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 0.9730632305145264
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 0.9885647296905518
Epoch: 16, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 0.9132380485534668
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9279730319976807
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 0.8800513744354248
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9157235622406006
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9196858406066895
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8829498291015625
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9921505451202393
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8762333393096924
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.787933349609375
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8635668754577637
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8796830177307129
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8765096664428711
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 134340
model size : 0.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.627486228942871
Epoch: 1, Steps: 10 | Train Loss: 1.490 Vali Loss: 1.449 Vali Acc: 0.257 Test Loss: 1.449 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 0.9377570152282715
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.391 Vali Acc: 0.322 Test Loss: 1.391 Test Acc: 0.322
Validation loss decreased (-0.256564 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.0220277309417725
Epoch: 3, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.294 Vali Acc: 0.461 Test Loss: 1.294 Test Acc: 0.461
Validation loss decreased (-0.322355 --> -0.460513).  Saving model ...
Epoch: 4 cost time: 0.9595723152160645
Epoch: 4, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.189 Vali Acc: 0.526 Test Loss: 1.189 Test Acc: 0.526
Validation loss decreased (-0.460513 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 0.9798517227172852
Epoch: 5, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.079 Vali Acc: 0.612 Test Loss: 1.079 Test Acc: 0.612
Validation loss decreased (-0.526304 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 0.9170913696289062
Epoch: 6, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.980 Vali Acc: 0.638 Test Loss: 0.980 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 0.891904354095459
Epoch: 7, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.891 Vali Acc: 0.691 Test Loss: 0.891 Test Acc: 0.691
Validation loss decreased (-0.638148 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 0.8741083145141602
Epoch: 8, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.818 Vali Acc: 0.684 Test Loss: 0.818 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8222005367279053
Epoch: 9, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.760 Vali Acc: 0.697 Test Loss: 0.760 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 0.784588098526001
Epoch: 10, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.715 Vali Acc: 0.704 Test Loss: 0.715 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 0.874065637588501
Epoch: 11, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717099).  Saving model ...
Epoch: 12 cost time: 0.8445947170257568
Epoch: 12, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.642 Vali Acc: 0.730 Test Loss: 0.642 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 13 cost time: 0.9635953903198242
Epoch: 13, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.623 Vali Acc: 0.743 Test Loss: 0.623 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 0.9281959533691406
Epoch: 14, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9004356861114502
Epoch: 15, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8455414772033691
Epoch: 16, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 0.9418478012084961
Epoch: 17, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0052375793457031
Epoch: 18, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.570 Vali Acc: 0.743 Test Loss: 0.570 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9105706214904785
Epoch: 19, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 20 cost time: 0.9918296337127686
Epoch: 20, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 0.9384453296661377
Epoch: 21, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 1.0006365776062012
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 0.9355568885803223
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.0113801956176758
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 0.9019308090209961
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0352413654327393
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9730861186981201
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8891429901123047
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9244973659515381
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8859248161315918
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9544663429260254
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.583 Vali Acc: 0.757 Test Loss: 0.583 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9046475887298584
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0210559368133545
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0210895538330078
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 35 cost time: 1.0538644790649414
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.001932144165039
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8981785774230957
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.613 Vali Acc: 0.776 Test Loss: 0.613 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0209155082702637
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9878168106079102
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0446338653564453
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0016965866088867
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.789 Test Loss: 0.634 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9099273681640625
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.651 Vali Acc: 0.783 Test Loss: 0.651 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8775410652160645
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.653 Vali Acc: 0.789 Test Loss: 0.653 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8883712291717529
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 129860
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.609201192855835
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.338 Vali Acc: 0.375 Test Loss: 1.338 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.9359426498413086
Epoch: 2, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.194 Vali Acc: 0.572 Test Loss: 1.194 Test Acc: 0.572
Validation loss decreased (-0.374987 --> -0.572356).  Saving model ...
Epoch: 3 cost time: 0.8305704593658447
Epoch: 3, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.027 Vali Acc: 0.632 Test Loss: 1.027 Test Acc: 0.632
Validation loss decreased (-0.572356 --> -0.631569).  Saving model ...
Epoch: 4 cost time: 0.8702826499938965
Epoch: 4, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.882 Vali Acc: 0.684 Test Loss: 0.882 Test Acc: 0.684
Validation loss decreased (-0.631569 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 0.8252456188201904
Epoch: 5, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 0.7932925224304199
Epoch: 6, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.673 Vali Acc: 0.730 Test Loss: 0.673 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 0.8685801029205322
Epoch: 7, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 8 cost time: 0.9657104015350342
Epoch: 8, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 0.8682208061218262
Epoch: 9, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 0.9377598762512207
Epoch: 10, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 0.9278500080108643
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 0.8993639945983887
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.975114107131958
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 0.9881188869476318
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0597724914550781
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9766824245452881
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9887583255767822
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.543 Vali Acc: 0.750 Test Loss: 0.543 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.938225269317627
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0115931034088135
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9464378356933594
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9508602619171143
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9999840259552002
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9323217868804932
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 57796
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.505000114440918
Epoch: 1, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.342 Vali Acc: 0.375 Test Loss: 1.342 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.9049737453460693
Epoch: 2, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.374987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.861788272857666
Epoch: 3, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.024 Vali Acc: 0.592 Test Loss: 1.024 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592095).  Saving model ...
Epoch: 4 cost time: 0.9737586975097656
Epoch: 4, Steps: 10 | Train Loss: 0.704 Vali Loss: 0.869 Vali Acc: 0.671 Test Loss: 0.869 Test Acc: 0.671
Validation loss decreased (-0.592095 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 0.8821737766265869
Epoch: 5, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.758 Vali Acc: 0.697 Test Loss: 0.758 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 6 cost time: 0.9811336994171143
Epoch: 6, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.681 Vali Acc: 0.737 Test Loss: 0.681 Test Acc: 0.737
Validation loss decreased (-0.697361 --> -0.736835).  Saving model ...
Epoch: 7 cost time: 0.9439661502838135
Epoch: 7, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.0004754066467285
Epoch: 8, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.573 Vali Acc: 0.750 Test Loss: 0.573 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9147608280181885
Epoch: 9, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.02781081199646
Epoch: 10, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9453284740447998
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0255939960479736
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9015817642211914
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 0.9515173435211182
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 0.9447107315063477
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9049100875854492
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.070223331451416
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.923088550567627
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0449676513671875
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9407751560211182
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9036836624145508
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9025704860687256
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8777914047241211
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.916435718536377
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8637523651123047
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0000412464141846
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 57828
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.442983627319336
Epoch: 1, Steps: 10 | Train Loss: 1.567 Vali Loss: 1.415 Vali Acc: 0.250 Test Loss: 1.415 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.9344186782836914
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.351 Vali Acc: 0.349 Test Loss: 1.351 Test Acc: 0.349
Validation loss decreased (-0.249986 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.8704218864440918
Epoch: 3, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.250 Vali Acc: 0.493 Test Loss: 1.250 Test Acc: 0.493
Validation loss decreased (-0.348671 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 0.9618139266967773
Epoch: 4, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.142 Vali Acc: 0.599 Test Loss: 1.142 Test Acc: 0.599
Validation loss decreased (-0.493409 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 0.9550535678863525
Epoch: 5, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.040 Vali Acc: 0.664 Test Loss: 1.040 Test Acc: 0.664
Validation loss decreased (-0.598673 --> -0.664463).  Saving model ...
Epoch: 6 cost time: 0.9902791976928711
Epoch: 6, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.946 Vali Acc: 0.697 Test Loss: 0.946 Test Acc: 0.697
Validation loss decreased (-0.664463 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 1.0359723567962646
Epoch: 7, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.864 Vali Acc: 0.704 Test Loss: 0.864 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703939).  Saving model ...
Epoch: 8 cost time: 0.9590625762939453
Epoch: 8, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.804 Vali Acc: 0.704 Test Loss: 0.804 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 1.0848848819732666
Epoch: 9, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 0.8916194438934326
Epoch: 10, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.702 Vali Acc: 0.724 Test Loss: 0.702 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 0.949882984161377
Epoch: 11, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.663 Vali Acc: 0.730 Test Loss: 0.663 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 12 cost time: 0.8303267955780029
Epoch: 12, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 0.9054691791534424
Epoch: 13, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.615 Vali Acc: 0.743 Test Loss: 0.615 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 0.9431865215301514
Epoch: 14, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 0.8877055644989014
Epoch: 15, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 0.8978657722473145
Epoch: 16, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.571 Vali Acc: 0.750 Test Loss: 0.571 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8837344646453857
Epoch: 17, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.563 Vali Acc: 0.743 Test Loss: 0.563 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0505344867706299
Epoch: 18, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.553 Vali Acc: 0.750 Test Loss: 0.553 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8793065547943115
Epoch: 19, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 0.906008243560791
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 0.8155207633972168
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9899756908416748
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 0.9916284084320068
Epoch: 23, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 0.978426456451416
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8828823566436768
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 0.7309503555297852
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8757059574127197
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8903377056121826
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8050882816314697
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 30 cost time: 0.814446210861206
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.552 Vali Acc: 0.789 Test Loss: 0.552 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9339377880096436
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8737688064575195
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8327195644378662
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0039081573486328
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8892126083374023
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0033156871795654
Epoch: 36, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8483614921569824
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.021071434020996
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9370596408843994
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.579 Vali Acc: 0.789 Test Loss: 0.579 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 46340
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.505189895629883
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.372 Vali Acc: 0.289 Test Loss: 1.372 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.8874096870422363
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.313 Vali Acc: 0.349 Test Loss: 1.313 Test Acc: 0.349
Validation loss decreased (-0.289460 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.973703145980835
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.240 Vali Acc: 0.408 Test Loss: 1.240 Test Acc: 0.408
Validation loss decreased (-0.348671 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 0.8828887939453125
Epoch: 4, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.160 Vali Acc: 0.493 Test Loss: 1.160 Test Acc: 0.493
Validation loss decreased (-0.407882 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 1.109050989151001
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.084 Vali Acc: 0.539 Test Loss: 1.084 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539463).  Saving model ...
Epoch: 6 cost time: 0.9053716659545898
Epoch: 6, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.004 Vali Acc: 0.559 Test Loss: 1.004 Test Acc: 0.559
Validation loss decreased (-0.539463 --> -0.559200).  Saving model ...
Epoch: 7 cost time: 0.9307105541229248
Epoch: 7, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.929 Vali Acc: 0.605 Test Loss: 0.929 Test Acc: 0.605
Validation loss decreased (-0.559200 --> -0.605254).  Saving model ...
Epoch: 8 cost time: 1.0116281509399414
Epoch: 8, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.854 Vali Acc: 0.651 Test Loss: 0.854 Test Acc: 0.651
Validation loss decreased (-0.605254 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 0.863053560256958
Epoch: 9, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.799 Vali Acc: 0.651 Test Loss: 0.799 Test Acc: 0.651
Validation loss decreased (-0.651307 --> -0.651308).  Saving model ...
Epoch: 10 cost time: 0.9153809547424316
Epoch: 10, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.749 Vali Acc: 0.697 Test Loss: 0.749 Test Acc: 0.697
Validation loss decreased (-0.651308 --> -0.697361).  Saving model ...
Epoch: 11 cost time: 0.8337023258209229
Epoch: 11, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.707 Vali Acc: 0.711 Test Loss: 0.707 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 0.8225455284118652
Epoch: 12, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.664 Vali Acc: 0.724 Test Loss: 0.664 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 13 cost time: 0.8169546127319336
Epoch: 13, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 0.8065032958984375
Epoch: 14, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 0.8104095458984375
Epoch: 15, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 0.8442144393920898
Epoch: 16, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 0.8871901035308838
Epoch: 17, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 0.9701137542724609
Epoch: 18, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.0114593505859375
Epoch: 19, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.000199556350708
Epoch: 20, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.078120470046997
Epoch: 21, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 22 cost time: 1.0434050559997559
Epoch: 22, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 23 cost time: 1.0616075992584229
Epoch: 23, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 24 cost time: 0.9478969573974609
Epoch: 24, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.506 Vali Acc: 0.770 Test Loss: 0.506 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9083499908447266
Epoch: 25, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 26 cost time: 0.9186508655548096
Epoch: 26, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 27 cost time: 0.9044697284698486
Epoch: 27, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796048).  Saving model ...
Epoch: 28 cost time: 0.9317917823791504
Epoch: 28, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9941587448120117
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 30 cost time: 0.9271221160888672
Epoch: 30, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 31 cost time: 0.9464664459228516
Epoch: 31, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9675745964050293
Epoch: 32, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9729194641113281
Epoch: 33, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0416474342346191
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9299933910369873
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0042686462402344
Epoch: 36, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.87408447265625
Epoch: 37, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 38 cost time: 0.8522868156433105
Epoch: 38, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8988049030303955
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8360803127288818
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9340205192565918
Epoch: 41, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7993662357330322
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8735136985778809
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8177709579467773
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9219517707824707
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 46 cost time: 0.8348703384399414
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.541 Vali Acc: 0.816 Test Loss: 0.541 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9517192840576172
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0223889350891113
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.550 Vali Acc: 0.816 Test Loss: 0.550 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9565126895904541
Epoch: 49, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.0764522552490234
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 42564
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5154500007629395
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.8770227432250977
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.368 Vali Acc: 0.303 Test Loss: 1.368 Test Acc: 0.303
Validation loss decreased (-0.243407 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 0.8687493801116943
Epoch: 3, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.289 Vali Acc: 0.342 Test Loss: 1.289 Test Acc: 0.342
Validation loss decreased (-0.302618 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 0.8694071769714355
Epoch: 4, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.198 Vali Acc: 0.441 Test Loss: 1.198 Test Acc: 0.441
Validation loss decreased (-0.342092 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 0.8625748157501221
Epoch: 5, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.112 Vali Acc: 0.566 Test Loss: 1.112 Test Acc: 0.566
Validation loss decreased (-0.440777 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 0.9974684715270996
Epoch: 6, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.030 Vali Acc: 0.638 Test Loss: 1.030 Test Acc: 0.638
Validation loss decreased (-0.565778 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 0.86232590675354
Epoch: 7, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.956 Vali Acc: 0.678 Test Loss: 0.956 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 0.9767742156982422
Epoch: 8, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.880 Vali Acc: 0.711 Test Loss: 0.880 Test Acc: 0.711
Validation loss decreased (-0.677622 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 0.8429257869720459
Epoch: 9, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.822 Vali Acc: 0.704 Test Loss: 0.822 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9890196323394775
Epoch: 10, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.770 Vali Acc: 0.737 Test Loss: 0.770 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736834).  Saving model ...
Epoch: 11 cost time: 0.8717970848083496
Epoch: 11, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.723 Vali Acc: 0.743 Test Loss: 0.723 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 0.8274552822113037
Epoch: 12, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.687 Vali Acc: 0.730 Test Loss: 0.687 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.886760950088501
Epoch: 13, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.658 Vali Acc: 0.724 Test Loss: 0.658 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8280081748962402
Epoch: 14, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.631 Vali Acc: 0.743 Test Loss: 0.631 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 0.814885139465332
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 0.7548987865447998
Epoch: 16, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.595 Vali Acc: 0.776 Test Loss: 0.595 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 0.8158431053161621
Epoch: 17, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 0.7941458225250244
Epoch: 18, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 0.838810920715332
Epoch: 19, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.804358720779419
Epoch: 20, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.871516227722168
Epoch: 21, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 0.8401148319244385
Epoch: 22, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 0.9061012268066406
Epoch: 23, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 24 cost time: 0.8609254360198975
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 25 cost time: 0.797879695892334
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8144805431365967
Epoch: 26, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8298904895782471
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8453905582427979
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8478171825408936
Epoch: 29, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9932405948638916
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.870354175567627
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.521 Vali Acc: 0.803 Test Loss: 0.521 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9041283130645752
Epoch: 32, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.899172306060791
Epoch: 33, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 34 cost time: 0.8273811340332031
Epoch: 34, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8263053894042969
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8234720230102539
Epoch: 36, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9163699150085449
Epoch: 37, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.525 Vali Acc: 0.809 Test Loss: 0.525 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9331521987915039
Epoch: 38, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8418307304382324
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8383138179779053
Epoch: 40, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9063475131988525
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 42 cost time: 0.9921956062316895
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 43 cost time: 0.8119726181030273
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7949185371398926
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7824916839599609
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.550 Vali Acc: 0.822 Test Loss: 0.550 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.750835657119751
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8679924011230469
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8194289207458496
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.560 Vali Acc: 0.822 Test Loss: 0.560 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7634127140045166
Epoch: 49, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8353617191314697
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.567 Vali Acc: 0.822 Test Loss: 0.567 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 42596
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4873790740966797
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.364 Vali Acc: 0.270 Test Loss: 1.364 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.9701271057128906
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.330 Vali Acc: 0.322 Test Loss: 1.330 Test Acc: 0.322
Validation loss decreased (-0.269723 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 0.8418500423431396
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.281 Vali Acc: 0.388 Test Loss: 1.281 Test Acc: 0.388
Validation loss decreased (-0.322355 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 0.9153792858123779
Epoch: 4, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.222 Vali Acc: 0.474 Test Loss: 1.222 Test Acc: 0.474
Validation loss decreased (-0.388145 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 0.8407032489776611
Epoch: 5, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.160 Vali Acc: 0.539 Test Loss: 1.160 Test Acc: 0.539
Validation loss decreased (-0.473672 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 0.8347747325897217
Epoch: 6, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.096 Vali Acc: 0.586 Test Loss: 1.096 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 0.9332995414733887
Epoch: 7, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.032 Vali Acc: 0.625 Test Loss: 1.032 Test Acc: 0.625
Validation loss decreased (-0.585515 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 0.8264343738555908
Epoch: 8, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.969 Vali Acc: 0.645 Test Loss: 0.969 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644727).  Saving model ...
Epoch: 9 cost time: 0.8270080089569092
Epoch: 9, Steps: 10 | Train Loss: 0.784 Vali Loss: 0.919 Vali Acc: 0.645 Test Loss: 0.919 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 10 cost time: 0.9051096439361572
Epoch: 10, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.859 Vali Acc: 0.691 Test Loss: 0.859 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690781).  Saving model ...
Epoch: 11 cost time: 1.037872076034546
Epoch: 11, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.816 Vali Acc: 0.691 Test Loss: 0.816 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 0.904402494430542
Epoch: 12, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.774 Vali Acc: 0.691 Test Loss: 0.774 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 13 cost time: 0.8819317817687988
Epoch: 13, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.741 Vali Acc: 0.704 Test Loss: 0.741 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 14 cost time: 0.8260848522186279
Epoch: 14, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.710 Vali Acc: 0.724 Test Loss: 0.710 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 15 cost time: 0.9059913158416748
Epoch: 15, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.681 Vali Acc: 0.724 Test Loss: 0.681 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 16 cost time: 0.9369330406188965
Epoch: 16, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 17 cost time: 0.8124780654907227
Epoch: 17, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.635 Vali Acc: 0.743 Test Loss: 0.635 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 18 cost time: 0.898496150970459
Epoch: 18, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 0.6965341567993164
Epoch: 19, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.597 Vali Acc: 0.743 Test Loss: 0.597 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8888607025146484
Epoch: 20, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 21 cost time: 0.8346424102783203
Epoch: 21, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 0.7405829429626465
Epoch: 22, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 0.8654723167419434
Epoch: 23, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.553 Vali Acc: 0.763 Test Loss: 0.553 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 0.8272824287414551
Epoch: 24, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 0.905217170715332
Epoch: 25, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 0.9094183444976807
Epoch: 26, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.529 Vali Acc: 0.763 Test Loss: 0.529 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9138836860656738
Epoch: 27, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 28 cost time: 0.9371774196624756
Epoch: 28, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 29 cost time: 0.9408786296844482
Epoch: 29, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 30 cost time: 0.9733965396881104
Epoch: 30, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.507 Vali Acc: 0.770 Test Loss: 0.507 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9082612991333008
Epoch: 31, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0085203647613525
Epoch: 32, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8688881397247314
Epoch: 33, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9076385498046875
Epoch: 34, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 35 cost time: 0.8370330333709717
Epoch: 35, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8843903541564941
Epoch: 36, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 37 cost time: 0.9678525924682617
Epoch: 37, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.947211742401123
Epoch: 38, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 39 cost time: 0.8512759208679199
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9451966285705566
Epoch: 40, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.070265293121338
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9253396987915039
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9419031143188477
Epoch: 43, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.522 Vali Acc: 0.796 Test Loss: 0.522 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 44 cost time: 0.8919603824615479
Epoch: 44, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.895972728729248
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9473991394042969
Epoch: 46, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 47 cost time: 0.948340654373169
Epoch: 47, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9266738891601562
Epoch: 48, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8756368160247803
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9491934776306152
Epoch: 50, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 40356
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.726820707321167
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.385 Vali Acc: 0.270 Test Loss: 1.385 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.1588807106018066
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.341 Vali Acc: 0.382 Test Loss: 1.341 Test Acc: 0.382
Validation loss decreased (-0.269723 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.1244659423828125
Epoch: 3, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.248 Vali Acc: 0.539 Test Loss: 1.248 Test Acc: 0.539
Validation loss decreased (-0.381566 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 1.178614854812622
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.121 Vali Acc: 0.605 Test Loss: 1.121 Test Acc: 0.605
Validation loss decreased (-0.539461 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.1093566417694092
Epoch: 5, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.984 Vali Acc: 0.638 Test Loss: 0.984 Test Acc: 0.638
Validation loss decreased (-0.605252 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.0235939025878906
Epoch: 6, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.824 Vali Acc: 0.697 Test Loss: 0.824 Test Acc: 0.697
Validation loss decreased (-0.638148 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.0811669826507568
Epoch: 7, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.689 Vali Acc: 0.743 Test Loss: 0.689 Test Acc: 0.743
Validation loss decreased (-0.697360 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.1153802871704102
Epoch: 8, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.594 Vali Acc: 0.743 Test Loss: 0.594 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.0878844261169434
Epoch: 9, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.132375955581665
Epoch: 10, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 11 cost time: 1.0841243267059326
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 12 cost time: 1.1441872119903564
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.520 Vali Acc: 0.763 Test Loss: 0.520 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.114687204360962
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1524240970611572
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.0720584392547607
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.1219291687011719
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0494039058685303
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.0126407146453857
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0676448345184326
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.613 Vali Acc: 0.796 Test Loss: 0.613 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1172559261322021
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1832644939422607
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1953847408294678
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 23 cost time: 1.0390472412109375
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1515638828277588
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1435637474060059
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0592176914215088
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.676 Vali Acc: 0.809 Test Loss: 0.676 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1024811267852783
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.686 Vali Acc: 0.809 Test Loss: 0.686 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1660616397857666
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.689 Vali Acc: 0.809 Test Loss: 0.689 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1075854301452637
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.693 Vali Acc: 0.809 Test Loss: 0.693 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9608006477355957
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.704 Vali Acc: 0.809 Test Loss: 0.704 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0434744358062744
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.809 Test Loss: 0.717 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1244168281555176
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 355140
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.814126491546631
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.0422008037567139
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.323 Vali Acc: 0.454 Test Loss: 1.323 Test Acc: 0.454
Validation loss decreased (-0.249986 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.011373519897461
Epoch: 3, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.221 Vali Acc: 0.579 Test Loss: 1.221 Test Acc: 0.579
Validation loss decreased (-0.453934 --> -0.578935).  Saving model ...
Epoch: 4 cost time: 0.9836010932922363
Epoch: 4, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.091 Vali Acc: 0.671 Test Loss: 1.091 Test Acc: 0.671
Validation loss decreased (-0.578935 --> -0.671042).  Saving model ...
Epoch: 5 cost time: 1.0624191761016846
Epoch: 5, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.956 Vali Acc: 0.678 Test Loss: 0.956 Test Acc: 0.678
Validation loss decreased (-0.671042 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 0.9952054023742676
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 7 cost time: 1.0503571033477783
Epoch: 7, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.682 Vali Acc: 0.724 Test Loss: 0.682 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.1198890209197998
Epoch: 8, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
Validation loss decreased (-0.723677 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.0877132415771484
Epoch: 9, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.537 Vali Acc: 0.757 Test Loss: 0.537 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1903460025787354
Epoch: 10, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1958024501800537
Epoch: 11, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 12 cost time: 1.0938732624053955
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.507 Vali Acc: 0.803 Test Loss: 0.507 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 13 cost time: 1.1155853271484375
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1654644012451172
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.088733434677124
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1004879474639893
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.110969066619873
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1523876190185547
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1202034950256348
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.610 Vali Acc: 0.803 Test Loss: 0.610 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0629255771636963
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1769449710845947
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1691303253173828
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809204).  Saving model ...
Epoch: 23 cost time: 1.1467454433441162
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.651 Vali Acc: 0.809 Test Loss: 0.651 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1370835304260254
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0866780281066895
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.653 Vali Acc: 0.809 Test Loss: 0.653 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0649325847625732
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1042540073394775
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.118560791015625
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1046786308288574
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.703 Vali Acc: 0.809 Test Loss: 0.703 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1058180332183838
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.709 Vali Acc: 0.803 Test Loss: 0.709 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0669949054718018
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1827373504638672
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.809 Test Loss: 0.717 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 355172
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8160483837127686
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.373 Vali Acc: 0.296 Test Loss: 1.373 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.983783483505249
Epoch: 2, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.332 Vali Acc: 0.441 Test Loss: 1.332 Test Acc: 0.441
Validation loss decreased (-0.296039 --> -0.440776).  Saving model ...
Epoch: 3 cost time: 0.9648537635803223
Epoch: 3, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.272 Vali Acc: 0.493 Test Loss: 1.272 Test Acc: 0.493
Validation loss decreased (-0.440776 --> -0.493408).  Saving model ...
Epoch: 4 cost time: 0.9902667999267578
Epoch: 4, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.201 Vali Acc: 0.507 Test Loss: 1.201 Test Acc: 0.507
Validation loss decreased (-0.493408 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 1.053011417388916
Epoch: 5, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.119 Vali Acc: 0.618 Test Loss: 1.119 Test Acc: 0.618
Validation loss decreased (-0.506567 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 0.969036340713501
Epoch: 6, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.033 Vali Acc: 0.638 Test Loss: 1.033 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.1273009777069092
Epoch: 7, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.943 Vali Acc: 0.658 Test Loss: 0.943 Test Acc: 0.658
Validation loss decreased (-0.638148 --> -0.657885).  Saving model ...
Epoch: 8 cost time: 1.0645804405212402
Epoch: 8, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.856 Vali Acc: 0.678 Test Loss: 0.856 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.0682060718536377
Epoch: 9, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.772 Vali Acc: 0.697 Test Loss: 0.772 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 1.0024175643920898
Epoch: 10, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
Validation loss decreased (-0.697361 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.1653964519500732
Epoch: 11, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
Validation loss decreased (-0.736835 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.1315386295318604
Epoch: 12, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1452865600585938
Epoch: 13, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0456712245941162
Epoch: 14, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1544582843780518
Epoch: 15, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.523 Vali Acc: 0.783 Test Loss: 0.523 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9865729808807373
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789469).  Saving model ...
Epoch: 17 cost time: 1.0005104541778564
Epoch: 17, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 18 cost time: 0.9769973754882812
Epoch: 18, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9536316394805908
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 0.8961396217346191
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9226734638214111
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0539700984954834
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0557901859283447
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.056286096572876
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0326192378997803
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0371756553649902
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9998025894165039
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0429530143737793
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9909212589263916
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 342916
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.324694871902466
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.362 Vali Acc: 0.329 Test Loss: 1.362 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 0.9949846267700195
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.324 Vali Acc: 0.382 Test Loss: 1.324 Test Acc: 0.382
Validation loss decreased (-0.328934 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.0335566997528076
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.264 Vali Acc: 0.493 Test Loss: 1.264 Test Acc: 0.493
Validation loss decreased (-0.381566 --> -0.493408).  Saving model ...
Epoch: 4 cost time: 1.017852783203125
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.193 Vali Acc: 0.572 Test Loss: 1.193 Test Acc: 0.572
Validation loss decreased (-0.493408 --> -0.572356).  Saving model ...
Epoch: 5 cost time: 1.0627844333648682
Epoch: 5, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.110 Vali Acc: 0.625 Test Loss: 1.110 Test Acc: 0.625
Validation loss decreased (-0.572356 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.0255868434906006
Epoch: 6, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.021 Vali Acc: 0.678 Test Loss: 1.021 Test Acc: 0.678
Validation loss decreased (-0.624989 --> -0.677621).  Saving model ...
Epoch: 7 cost time: 1.0396454334259033
Epoch: 7, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.932 Vali Acc: 0.711 Test Loss: 0.932 Test Acc: 0.711
Validation loss decreased (-0.677621 --> -0.710517).  Saving model ...
Epoch: 8 cost time: 1.0322356224060059
Epoch: 8, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.843 Vali Acc: 0.711 Test Loss: 0.843 Test Acc: 0.711
Validation loss decreased (-0.710517 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 1.0002622604370117
Epoch: 9, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.763 Vali Acc: 0.730 Test Loss: 0.763 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 0.9675590991973877
Epoch: 10, Steps: 10 | Train Loss: 0.510 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 0.9824309349060059
Epoch: 11, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.643 Vali Acc: 0.730 Test Loss: 0.643 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9335558414459229
Epoch: 12, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.605 Vali Acc: 0.730 Test Loss: 0.605 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9838454723358154
Epoch: 13, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.573 Vali Acc: 0.730 Test Loss: 0.573 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9788913726806641
Epoch: 14, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.549 Vali Acc: 0.730 Test Loss: 0.549 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0460944175720215
Epoch: 15, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736837).  Saving model ...
Epoch: 16 cost time: 1.0474317073822021
Epoch: 16, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.531 Vali Acc: 0.743 Test Loss: 0.531 Test Acc: 0.743
Validation loss decreased (-0.736837 --> -0.743416).  Saving model ...
Epoch: 17 cost time: 1.0232203006744385
Epoch: 17, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.530 Vali Acc: 0.757 Test Loss: 0.530 Test Acc: 0.757
Validation loss decreased (-0.743416 --> -0.756574).  Saving model ...
Epoch: 18 cost time: 1.0204529762268066
Epoch: 18, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.756574 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.0614378452301025
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9932363033294678
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.068892240524292
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0293855667114258
Epoch: 22, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0325450897216797
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9971091747283936
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0283780097961426
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0161948204040527
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9434540271759033
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0235254764556885
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 339908
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6060869693756104
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.408 Vali Acc: 0.322 Test Loss: 1.408 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 0.9784886837005615
Epoch: 2, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.384 Vali Acc: 0.336 Test Loss: 1.384 Test Acc: 0.336
Validation loss decreased (-0.322354 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 0.9277365207672119
Epoch: 3, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.334 Vali Acc: 0.414 Test Loss: 1.334 Test Acc: 0.414
Validation loss decreased (-0.335512 --> -0.414460).  Saving model ...
Epoch: 4 cost time: 0.9874083995819092
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.268 Vali Acc: 0.586 Test Loss: 1.268 Test Acc: 0.586
Validation loss decreased (-0.414460 --> -0.585514).  Saving model ...
Epoch: 5 cost time: 0.9831347465515137
Epoch: 5, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.195 Vali Acc: 0.612 Test Loss: 1.195 Test Acc: 0.612
Validation loss decreased (-0.585514 --> -0.611830).  Saving model ...
Epoch: 6 cost time: 0.9708359241485596
Epoch: 6, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
Validation loss decreased (-0.611830 --> -0.677620).  Saving model ...
Epoch: 7 cost time: 0.9329485893249512
Epoch: 7, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.023 Vali Acc: 0.691 Test Loss: 1.023 Test Acc: 0.691
Validation loss decreased (-0.677620 --> -0.690779).  Saving model ...
Epoch: 8 cost time: 0.9650359153747559
Epoch: 8, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.929 Vali Acc: 0.730 Test Loss: 0.929 Test Acc: 0.730
Validation loss decreased (-0.690779 --> -0.730254).  Saving model ...
Epoch: 9 cost time: 1.0148305892944336
Epoch: 9, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.836 Vali Acc: 0.743 Test Loss: 0.836 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743413).  Saving model ...
Epoch: 10 cost time: 0.9264957904815674
Epoch: 10, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 11 cost time: 0.965911865234375
Epoch: 11, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.685 Vali Acc: 0.757 Test Loss: 0.685 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9173398017883301
Epoch: 12, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.626 Vali Acc: 0.770 Test Loss: 0.626 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 0.9306831359863281
Epoch: 13, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9497396945953369
Epoch: 14, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9225831031799316
Epoch: 15, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 0.9955320358276367
Epoch: 16, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 17 cost time: 0.9204902648925781
Epoch: 17, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 0.9130673408508301
Epoch: 18, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 0.8899827003479004
Epoch: 19, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.489 Vali Acc: 0.776 Test Loss: 0.489 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9137341976165771
Epoch: 20, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8825993537902832
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 0.9052739143371582
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.490 Vali Acc: 0.803 Test Loss: 0.490 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 23 cost time: 0.8946759700775146
Epoch: 23, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9071426391601562
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0209662914276123
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9911353588104248
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9800014495849609
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9945073127746582
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0623228549957275
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9221546649932861
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.547 Vali Acc: 0.809 Test Loss: 0.547 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 31 cost time: 1.091252326965332
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.554 Vali Acc: 0.809 Test Loss: 0.554 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0034582614898682
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0291728973388672
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9709055423736572
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9827473163604736
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0077893733978271
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9216389656066895
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9838612079620361
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9762251377105713
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0598654747009277
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 339940
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3523004055023193
Epoch: 1, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.369 Vali Acc: 0.349 Test Loss: 1.369 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.060546875
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.334 Vali Acc: 0.414 Test Loss: 1.334 Test Acc: 0.414
Validation loss decreased (-0.348671 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 0.9495847225189209
Epoch: 3, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.283 Vali Acc: 0.520 Test Loss: 1.283 Test Acc: 0.520
Validation loss decreased (-0.414460 --> -0.519724).  Saving model ...
Epoch: 4 cost time: 0.943988561630249
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.220 Vali Acc: 0.612 Test Loss: 1.220 Test Acc: 0.612
Validation loss decreased (-0.519724 --> -0.611830).  Saving model ...
Epoch: 5 cost time: 0.9517595767974854
Epoch: 5, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.150 Vali Acc: 0.664 Test Loss: 1.150 Test Acc: 0.664
Validation loss decreased (-0.611830 --> -0.664462).  Saving model ...
Epoch: 6 cost time: 0.9298524856567383
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.080 Vali Acc: 0.697 Test Loss: 1.080 Test Acc: 0.697
Validation loss decreased (-0.664462 --> -0.697358).  Saving model ...
Epoch: 7 cost time: 0.9646358489990234
Epoch: 7, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.002 Vali Acc: 0.711 Test Loss: 1.002 Test Acc: 0.711
Validation loss decreased (-0.697358 --> -0.710516).  Saving model ...
Epoch: 8 cost time: 0.9568450450897217
Epoch: 8, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.925 Vali Acc: 0.737 Test Loss: 0.925 Test Acc: 0.737
Validation loss decreased (-0.710516 --> -0.736833).  Saving model ...
Epoch: 9 cost time: 0.9388573169708252
Epoch: 9, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.846 Vali Acc: 0.743 Test Loss: 0.846 Test Acc: 0.743
Validation loss decreased (-0.736833 --> -0.743413).  Saving model ...
Epoch: 10 cost time: 0.9943854808807373
Epoch: 10, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.762 Vali Acc: 0.763 Test Loss: 0.762 Test Acc: 0.763
Validation loss decreased (-0.743413 --> -0.763150).  Saving model ...
Epoch: 11 cost time: 1.0122036933898926
Epoch: 11, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.693 Vali Acc: 0.770 Test Loss: 0.693 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 0.9344894886016846
Epoch: 12, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
Validation loss decreased (-0.769730 --> -0.809204).  Saving model ...
Epoch: 13 cost time: 1.019838571548462
Epoch: 13, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.583 Vali Acc: 0.809 Test Loss: 0.583 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.029630422592163
Epoch: 14, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0089445114135742
Epoch: 15, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9752001762390137
Epoch: 16, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9621200561523438
Epoch: 17, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.467 Vali Acc: 0.789 Test Loss: 0.467 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8864431381225586
Epoch: 18, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.456 Vali Acc: 0.809 Test Loss: 0.456 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 0.9838724136352539
Epoch: 19, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.443 Vali Acc: 0.789 Test Loss: 0.443 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9635453224182129
Epoch: 20, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.438 Vali Acc: 0.809 Test Loss: 0.438 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 21 cost time: 1.026122808456421
Epoch: 21, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.443 Vali Acc: 0.803 Test Loss: 0.443 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.963667631149292
Epoch: 22, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.447 Vali Acc: 0.809 Test Loss: 0.447 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0219883918762207
Epoch: 23, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.451 Vali Acc: 0.803 Test Loss: 0.451 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0201008319854736
Epoch: 24, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9729859828948975
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.464 Vali Acc: 0.816 Test Loss: 0.464 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 26 cost time: 1.0227952003479004
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.468 Vali Acc: 0.809 Test Loss: 0.468 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9226782321929932
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.473 Vali Acc: 0.809 Test Loss: 0.473 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9864368438720703
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9112541675567627
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.496 Vali Acc: 0.809 Test Loss: 0.496 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9845178127288818
Epoch: 30, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.502 Vali Acc: 0.809 Test Loss: 0.502 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9185254573822021
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.513 Vali Acc: 0.809 Test Loss: 0.513 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9845776557922363
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.523 Vali Acc: 0.809 Test Loss: 0.523 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9516541957855225
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.527 Vali Acc: 0.816 Test Loss: 0.527 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9698140621185303
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.539 Vali Acc: 0.822 Test Loss: 0.539 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822363).  Saving model ...
Epoch: 35 cost time: 1.00101900100708
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.562 Vali Acc: 0.816 Test Loss: 0.562 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0149149894714355
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.576 Vali Acc: 0.816 Test Loss: 0.576 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.094045877456665
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0393154621124268
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.591 Vali Acc: 0.822 Test Loss: 0.591 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0377213954925537
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.602 Vali Acc: 0.822 Test Loss: 0.602 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.009824514389038
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.610 Vali Acc: 0.822 Test Loss: 0.610 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0108277797698975
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.615 Vali Acc: 0.822 Test Loss: 0.615 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9402196407318115
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.623 Vali Acc: 0.822 Test Loss: 0.623 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.00527024269104
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.962141752243042
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 336932
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4257798194885254
Epoch: 1, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.383 Vali Acc: 0.309 Test Loss: 1.383 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.122771978378296
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.324 Vali Acc: 0.454 Test Loss: 1.324 Test Acc: 0.454
Validation loss decreased (-0.309197 --> -0.453934).  Saving model ...
Epoch: 3 cost time: 1.0082886219024658
Epoch: 3, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.238 Vali Acc: 0.513 Test Loss: 1.238 Test Acc: 0.513
Validation loss decreased (-0.453934 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 0.9129824638366699
Epoch: 4, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.103 Vali Acc: 0.651 Test Loss: 1.103 Test Acc: 0.651
Validation loss decreased (-0.513146 --> -0.651305).  Saving model ...
Epoch: 5 cost time: 0.9499766826629639
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.953 Vali Acc: 0.697 Test Loss: 0.953 Test Acc: 0.697
Validation loss decreased (-0.651305 --> -0.697359).  Saving model ...
Epoch: 6 cost time: 1.0981817245483398
Epoch: 6, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.810 Vali Acc: 0.711 Test Loss: 0.810 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 0.9146497249603271
Epoch: 7, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.675 Vali Acc: 0.730 Test Loss: 0.675 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 0.9691023826599121
Epoch: 8, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 0.9796583652496338
Epoch: 9, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 10 cost time: 1.1125125885009766
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 1.0970933437347412
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.155942440032959
Epoch: 12, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.0349411964416504
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.0629634857177734
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.045156717300415
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9671812057495117
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9977185726165771
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.012042760848999
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 0.9772753715515137
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9713842868804932
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.060192584991455
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.181159257888794
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1029038429260254
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0437462329864502
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0397448539733887
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1094539165496826
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1492888927459717
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1860549449920654
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.688 Vali Acc: 0.816 Test Loss: 0.688 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815783).  Saving model ...
Epoch: 29 cost time: 1.1322791576385498
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.809 Test Loss: 0.698 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0506229400634766
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.707 Vali Acc: 0.816 Test Loss: 0.707 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1239128112792969
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.706 Vali Acc: 0.809 Test Loss: 0.706 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0481810569763184
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.809 Test Loss: 0.716 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1478650569915771
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1403939723968506
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.735 Vali Acc: 0.803 Test Loss: 0.735 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1232521533966064
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.088501214981079
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0317285060882568
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.746 Vali Acc: 0.816 Test Loss: 0.746 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1008100509643555
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.816 Test Loss: 0.757 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 349764
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.608706474304199
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.385 Vali Acc: 0.289 Test Loss: 1.385 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.0836982727050781
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.333 Vali Acc: 0.408 Test Loss: 1.333 Test Acc: 0.408
Validation loss decreased (-0.289460 --> -0.407881).  Saving model ...
Epoch: 3 cost time: 1.0191066265106201
Epoch: 3, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.237 Vali Acc: 0.533 Test Loss: 1.237 Test Acc: 0.533
Validation loss decreased (-0.407881 --> -0.532882).  Saving model ...
Epoch: 4 cost time: 1.1078259944915771
Epoch: 4, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.110 Vali Acc: 0.638 Test Loss: 1.110 Test Acc: 0.638
Validation loss decreased (-0.532882 --> -0.638147).  Saving model ...
Epoch: 5 cost time: 1.0266339778900146
Epoch: 5, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.976 Vali Acc: 0.684 Test Loss: 0.976 Test Acc: 0.684
Validation loss decreased (-0.638147 --> -0.684201).  Saving model ...
Epoch: 6 cost time: 0.9744937419891357
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.836 Vali Acc: 0.704 Test Loss: 0.836 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.0384328365325928
Epoch: 7, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.706 Vali Acc: 0.743 Test Loss: 0.706 Test Acc: 0.743
Validation loss decreased (-0.703939 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.0085222721099854
Epoch: 8, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.613 Vali Acc: 0.750 Test Loss: 0.613 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.0074574947357178
Epoch: 9, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 0.9802024364471436
Epoch: 10, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9492983818054199
Epoch: 11, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0079951286315918
Epoch: 12, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9533212184906006
Epoch: 13, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 0.9685282707214355
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.516 Vali Acc: 0.803 Test Loss: 0.516 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 0.8783104419708252
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9943909645080566
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9882252216339111
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0322391986846924
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9083890914916992
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.571 Vali Acc: 0.803 Test Loss: 0.571 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9381999969482422
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0425255298614502
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0408260822296143
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 23 cost time: 1.0310242176055908
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9895448684692383
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9534752368927002
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.625 Vali Acc: 0.796 Test Loss: 0.625 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9805841445922852
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.635 Vali Acc: 0.816 Test Loss: 0.635 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815783).  Saving model ...
Epoch: 27 cost time: 0.9517068862915039
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0046463012695312
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.649 Vali Acc: 0.816 Test Loss: 0.649 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9932594299316406
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.657 Vali Acc: 0.822 Test Loss: 0.657 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 30 cost time: 0.9819610118865967
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.043835163116455
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.829 Test Loss: 0.678 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828941).  Saving model ...
Epoch: 32 cost time: 0.9722995758056641
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.822 Test Loss: 0.681 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9750988483428955
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.687 Vali Acc: 0.822 Test Loss: 0.687 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9004743099212646
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.829 Test Loss: 0.699 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9582905769348145
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.816 Test Loss: 0.704 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.01222562789917
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.714 Vali Acc: 0.816 Test Loss: 0.714 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9711587429046631
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.719 Vali Acc: 0.822 Test Loss: 0.719 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8999958038330078
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.726 Vali Acc: 0.816 Test Loss: 0.726 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8829121589660645
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.822 Test Loss: 0.733 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8730928897857666
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.822 Test Loss: 0.742 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9854533672332764
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 349796
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4613943099975586
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.354 Vali Acc: 0.342 Test Loss: 1.354 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 0.9918351173400879
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.311 Vali Acc: 0.421 Test Loss: 1.311 Test Acc: 0.421
Validation loss decreased (-0.342092 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.0138580799102783
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
Validation loss decreased (-0.421040 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.0313286781311035
Epoch: 4, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.178 Vali Acc: 0.533 Test Loss: 1.178 Test Acc: 0.533
Validation loss decreased (-0.467093 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 0.9120707511901855
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.090 Vali Acc: 0.605 Test Loss: 1.090 Test Acc: 0.605
Validation loss decreased (-0.532883 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 0.9553916454315186
Epoch: 6, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.997 Vali Acc: 0.638 Test Loss: 0.997 Test Acc: 0.638
Validation loss decreased (-0.605252 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 0.9096353054046631
Epoch: 7, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.903 Vali Acc: 0.651 Test Loss: 0.903 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 0.9647727012634277
Epoch: 8, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.805 Vali Acc: 0.697 Test Loss: 0.805 Test Acc: 0.697
Validation loss decreased (-0.651307 --> -0.697360).  Saving model ...
Epoch: 9 cost time: 0.9990317821502686
Epoch: 9, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.722 Vali Acc: 0.711 Test Loss: 0.722 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 0.9893112182617188
Epoch: 10, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.650 Vali Acc: 0.757 Test Loss: 0.650 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 0.9561605453491211
Epoch: 11, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.0320696830749512
Epoch: 12, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 0.9434754848480225
Epoch: 13, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 0.9501397609710693
Epoch: 14, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.0707366466522217
Epoch: 15, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 0.9955084323883057
Epoch: 16, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 1.0889441967010498
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9701995849609375
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9242918491363525
Epoch: 19, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0581045150756836
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.022524356842041
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0429162979125977
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0186147689819336
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0119776725769043
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0097191333770752
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0421631336212158
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 337540
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3976893424987793
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.366 Vali Acc: 0.296 Test Loss: 1.366 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.9519238471984863
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.320 Vali Acc: 0.375 Test Loss: 1.320 Test Acc: 0.375
Validation loss decreased (-0.296039 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.959099292755127
Epoch: 3, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.254 Vali Acc: 0.513 Test Loss: 1.254 Test Acc: 0.513
Validation loss decreased (-0.374987 --> -0.513145).  Saving model ...
Epoch: 4 cost time: 0.9322583675384521
Epoch: 4, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.179 Vali Acc: 0.605 Test Loss: 1.179 Test Acc: 0.605
Validation loss decreased (-0.513145 --> -0.605251).  Saving model ...
Epoch: 5 cost time: 0.9718518257141113
Epoch: 5, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.096 Vali Acc: 0.691 Test Loss: 1.096 Test Acc: 0.691
Validation loss decreased (-0.605251 --> -0.690779).  Saving model ...
Epoch: 6 cost time: 0.944115400314331
Epoch: 6, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.007 Vali Acc: 0.711 Test Loss: 1.007 Test Acc: 0.711
Validation loss decreased (-0.690779 --> -0.710516).  Saving model ...
Epoch: 7 cost time: 0.9938180446624756
Epoch: 7, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.918 Vali Acc: 0.737 Test Loss: 0.918 Test Acc: 0.737
Validation loss decreased (-0.710516 --> -0.736833).  Saving model ...
Epoch: 8 cost time: 0.9963877201080322
Epoch: 8, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.829 Vali Acc: 0.757 Test Loss: 0.829 Test Acc: 0.757
Validation loss decreased (-0.736833 --> -0.756571).  Saving model ...
Epoch: 9 cost time: 1.0121989250183105
Epoch: 9, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.748 Vali Acc: 0.757 Test Loss: 0.748 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756571).  Saving model ...
Epoch: 10 cost time: 1.0669171810150146
Epoch: 10, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9954509735107422
Epoch: 11, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0128872394561768
Epoch: 12, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
Validation loss decreased (-0.756571 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 0.9916367530822754
Epoch: 13, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 0.963280439376831
Epoch: 14, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 0.9466719627380371
Epoch: 15, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 16 cost time: 1.0149939060211182
Epoch: 16, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.512 Vali Acc: 0.763 Test Loss: 0.512 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0646636486053467
Epoch: 17, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.507 Vali Acc: 0.763 Test Loss: 0.507 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0388035774230957
Epoch: 18, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.508 Vali Acc: 0.763 Test Loss: 0.508 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0509979724884033
Epoch: 19, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0177936553955078
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.511 Vali Acc: 0.763 Test Loss: 0.511 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0332353115081787
Epoch: 21, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 22 cost time: 1.1211280822753906
Epoch: 22, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.513 Vali Acc: 0.763 Test Loss: 0.513 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0060291290283203
Epoch: 23, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.522 Vali Acc: 0.763 Test Loss: 0.522 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9679625034332275
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.531 Vali Acc: 0.770 Test Loss: 0.531 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0213911533355713
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0522959232330322
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0287585258483887
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0372977256774902
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0549023151397705
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1255228519439697
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0812833309173584
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 334532
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6893672943115234
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.370 Vali Acc: 0.257 Test Loss: 1.370 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.0208137035369873
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.339 Vali Acc: 0.421 Test Loss: 1.339 Test Acc: 0.421
Validation loss decreased (-0.256565 --> -0.421039).  Saving model ...
Epoch: 3 cost time: 0.9113333225250244
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.287 Vali Acc: 0.566 Test Loss: 1.287 Test Acc: 0.566
Validation loss decreased (-0.421039 --> -0.565777).  Saving model ...
Epoch: 4 cost time: 1.0279622077941895
Epoch: 4, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.224 Vali Acc: 0.605 Test Loss: 1.224 Test Acc: 0.605
Validation loss decreased (-0.565777 --> -0.605251).  Saving model ...
Epoch: 5 cost time: 0.9821736812591553
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.151 Vali Acc: 0.658 Test Loss: 1.151 Test Acc: 0.658
Validation loss decreased (-0.605251 --> -0.657883).  Saving model ...
Epoch: 6 cost time: 1.0284795761108398
Epoch: 6, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.074 Vali Acc: 0.684 Test Loss: 1.074 Test Acc: 0.684
Validation loss decreased (-0.657883 --> -0.684200).  Saving model ...
Epoch: 7 cost time: 1.0733497142791748
Epoch: 7, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.987 Vali Acc: 0.704 Test Loss: 0.987 Test Acc: 0.704
Validation loss decreased (-0.684200 --> -0.703937).  Saving model ...
Epoch: 8 cost time: 1.062119960784912
Epoch: 8, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.900 Vali Acc: 0.717 Test Loss: 0.900 Test Acc: 0.717
Validation loss decreased (-0.703937 --> -0.717096).  Saving model ...
Epoch: 9 cost time: 1.0700740814208984
Epoch: 9, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.815 Vali Acc: 0.724 Test Loss: 0.815 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723676).  Saving model ...
Epoch: 10 cost time: 1.0512669086456299
Epoch: 10, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.733 Vali Acc: 0.757 Test Loss: 0.733 Test Acc: 0.757
Validation loss decreased (-0.723676 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.1611261367797852
Epoch: 11, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.666 Vali Acc: 0.757 Test Loss: 0.666 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 1.1213245391845703
Epoch: 12, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.0875048637390137
Epoch: 13, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 0.9836523532867432
Epoch: 14, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.0875322818756104
Epoch: 15, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 16 cost time: 1.06929349899292
Epoch: 16, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 17 cost time: 0.9666163921356201
Epoch: 17, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 1.1117842197418213
Epoch: 18, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 19 cost time: 1.0558404922485352
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 20 cost time: 1.1537487506866455
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0425200462341309
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.500 Vali Acc: 0.789 Test Loss: 0.500 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0473358631134033
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0497124195098877
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9576253890991211
Epoch: 24, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 25 cost time: 0.9963600635528564
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0221712589263916
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0030925273895264
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9776430130004883
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0333359241485596
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 30 cost time: 1.108767032623291
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0503389835357666
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0620787143707275
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.599 Vali Acc: 0.803 Test Loss: 0.599 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0238087177276611
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.604 Vali Acc: 0.809 Test Loss: 0.604 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0808689594268799
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0329694747924805
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0285704135894775
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9134869575500488
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9644184112548828
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9053177833557129
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 334564
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.516641855239868
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.388 Vali Acc: 0.250 Test Loss: 1.388 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.9529614448547363
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.354 Vali Acc: 0.355 Test Loss: 1.354 Test Acc: 0.355
Validation loss decreased (-0.249986 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 0.9928629398345947
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (-0.355250 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.983985424041748
Epoch: 4, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.248 Vali Acc: 0.599 Test Loss: 1.248 Test Acc: 0.599
Validation loss decreased (-0.499987 --> -0.598672).  Saving model ...
Epoch: 5 cost time: 0.997056245803833
Epoch: 5, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.181 Vali Acc: 0.664 Test Loss: 1.181 Test Acc: 0.664
Validation loss decreased (-0.598672 --> -0.664462).  Saving model ...
Epoch: 6 cost time: 1.0438265800476074
Epoch: 6, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.108 Vali Acc: 0.697 Test Loss: 1.108 Test Acc: 0.697
Validation loss decreased (-0.664462 --> -0.697357).  Saving model ...
Epoch: 7 cost time: 0.967388391494751
Epoch: 7, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.030 Vali Acc: 0.737 Test Loss: 1.030 Test Acc: 0.737
Validation loss decreased (-0.697357 --> -0.736832).  Saving model ...
Epoch: 8 cost time: 1.0567128658294678
Epoch: 8, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
Validation loss decreased (-0.736832 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 1.103088140487671
Epoch: 9, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.866 Vali Acc: 0.743 Test Loss: 0.866 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.087578296661377
Epoch: 10, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.793 Vali Acc: 0.743 Test Loss: 0.793 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0585911273956299
Epoch: 11, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.727 Vali Acc: 0.763 Test Loss: 0.727 Test Acc: 0.763
Validation loss decreased (-0.749991 --> -0.763151).  Saving model ...
Epoch: 12 cost time: 1.0909202098846436
Epoch: 12, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.661 Vali Acc: 0.796 Test Loss: 0.661 Test Acc: 0.796
Validation loss decreased (-0.763151 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 1.0111849308013916
Epoch: 13, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1024022102355957
Epoch: 14, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0198452472686768
Epoch: 15, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
Validation loss decreased (-0.796046 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.0174589157104492
Epoch: 16, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.1448962688446045
Epoch: 17, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.099684715270996
Epoch: 18, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.0349977016448975
Epoch: 19, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.486 Vali Acc: 0.803 Test Loss: 0.486 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 0.9288818836212158
Epoch: 20, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
Validation loss decreased (-0.802627 --> -0.802627).  Saving model ...
Epoch: 21 cost time: 0.9816172122955322
Epoch: 21, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.05611252784729
Epoch: 22, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0296242237091064
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.490 Vali Acc: 0.809 Test Loss: 0.490 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 24 cost time: 0.9932873249053955
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0225355625152588
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0654425621032715
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.992429256439209
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0745584964752197
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0955133438110352
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0531132221221924
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.536 Vali Acc: 0.796 Test Loss: 0.536 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1021018028259277
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1326408386230469
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.086512565612793
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.585 Vali Acc: 0.803 Test Loss: 0.585 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 331556
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8683853149414062
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.307 Vali Acc: 0.434 Test Loss: 1.307 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.2452919483184814
Epoch: 2, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.051 Vali Acc: 0.691 Test Loss: 1.051 Test Acc: 0.691
Validation loss decreased (-0.434197 --> -0.690779).  Saving model ...
Epoch: 3 cost time: 1.3686482906341553
Epoch: 3, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.757 Vali Acc: 0.763 Test Loss: 0.757 Test Acc: 0.763
Validation loss decreased (-0.690779 --> -0.763150).  Saving model ...
Epoch: 4 cost time: 1.3034169673919678
Epoch: 4, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.173804521560669
Epoch: 5, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.3149640560150146
Epoch: 6, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 1.36893892288208
Epoch: 7, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815784).  Saving model ...
Epoch: 8 cost time: 1.258338212966919
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2469661235809326
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.315589189529419
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.678 Vali Acc: 0.809 Test Loss: 0.678 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2922122478485107
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.700 Vali Acc: 0.809 Test Loss: 0.700 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3546385765075684
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822361).  Saving model ...
Epoch: 13 cost time: 1.3210928440093994
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.822 Test Loss: 0.713 Test Acc: 0.822
Validation loss decreased (-0.822361 --> -0.822361).  Saving model ...
Epoch: 14 cost time: 1.2680583000183105
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.736 Vali Acc: 0.816 Test Loss: 0.736 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2711670398712158
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.816 Test Loss: 0.751 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3515326976776123
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.816 Test Loss: 0.777 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.265906810760498
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.816 Test Loss: 0.793 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3223731517791748
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.816 Test Loss: 0.796 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3458459377288818
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.816 Test Loss: 0.803 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3365895748138428
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.816 Test Loss: 0.820 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.364037036895752
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.816 Test Loss: 0.834 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3098077774047852
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.816 Test Loss: 0.842 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2776379585266113
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.816 Test Loss: 0.836 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1230084
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.827042579650879
Epoch: 1, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.271 Vali Acc: 0.546 Test Loss: 1.271 Test Acc: 0.546
Validation loss decreased (inf --> -0.546040).  Saving model ...
Epoch: 2 cost time: 1.3192157745361328
Epoch: 2, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.016 Vali Acc: 0.704 Test Loss: 1.016 Test Acc: 0.704
Validation loss decreased (-0.546040 --> -0.703937).  Saving model ...
Epoch: 3 cost time: 1.2050836086273193
Epoch: 3, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.756 Vali Acc: 0.730 Test Loss: 0.756 Test Acc: 0.730
Validation loss decreased (-0.703937 --> -0.730256).  Saving model ...
Epoch: 4 cost time: 1.2677907943725586
Epoch: 4, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.592 Vali Acc: 0.770 Test Loss: 0.592 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769731).  Saving model ...
Epoch: 5 cost time: 1.2232420444488525
Epoch: 5, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0929152965545654
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.1574676036834717
Epoch: 7, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.25236177444458
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.2142701148986816
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 10 cost time: 1.2574596405029297
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.684 Vali Acc: 0.803 Test Loss: 0.684 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2243340015411377
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
Validation loss decreased (-0.802625 --> -0.822361).  Saving model ...
Epoch: 12 cost time: 1.1587066650390625
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.809 Test Loss: 0.712 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2085888385772705
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.816 Test Loss: 0.730 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1500766277313232
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.816 Test Loss: 0.751 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.259199857711792
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.763 Vali Acc: 0.822 Test Loss: 0.763 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1686196327209473
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.829 Test Loss: 0.771 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828940).  Saving model ...
Epoch: 17 cost time: 1.2495684623718262
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.822 Test Loss: 0.778 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2317354679107666
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.822 Test Loss: 0.797 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2428669929504395
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.816 Test Loss: 0.802 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2165162563323975
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.816 Test Loss: 0.822 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3065826892852783
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.822 Test Loss: 0.830 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3740477561950684
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.829 Test Loss: 0.830 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2303128242492676
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.816 Test Loss: 0.836 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3346025943756104
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.816 Test Loss: 0.851 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.242645025253296
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.822 Test Loss: 0.855 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3005046844482422
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.822 Test Loss: 0.858 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1230212
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8716976642608643
Epoch: 1, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.333 Vali Acc: 0.434 Test Loss: 1.333 Test Acc: 0.434
Validation loss decreased (inf --> -0.434197).  Saving model ...
Epoch: 2 cost time: 1.2239603996276855
Epoch: 2, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.171 Vali Acc: 0.612 Test Loss: 1.171 Test Acc: 0.612
Validation loss decreased (-0.434197 --> -0.611830).  Saving model ...
Epoch: 3 cost time: 1.148453712463379
Epoch: 3, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.961 Vali Acc: 0.638 Test Loss: 0.961 Test Acc: 0.638
Validation loss decreased (-0.611830 --> -0.638148).  Saving model ...
Epoch: 4 cost time: 1.2333934307098389
Epoch: 4, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.775 Vali Acc: 0.737 Test Loss: 0.775 Test Acc: 0.737
Validation loss decreased (-0.638148 --> -0.736834).  Saving model ...
Epoch: 5 cost time: 1.2240192890167236
Epoch: 5, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.634 Vali Acc: 0.770 Test Loss: 0.634 Test Acc: 0.770
Validation loss decreased (-0.736834 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.189812421798706
Epoch: 6, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.1882367134094238
Epoch: 7, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.208960771560669
Epoch: 8, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.2074921131134033
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.2537641525268555
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2961275577545166
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2466769218444824
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2404508590698242
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0826048851013184
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.770 Test Loss: 0.638 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1408157348632812
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.092050552368164
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.650 Vali Acc: 0.789 Test Loss: 0.650 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.179286003112793
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.770 Test Loss: 0.670 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1483900547027588
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.776 Test Loss: 0.681 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2313246726989746
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1187332
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.932889223098755
Epoch: 1, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.331 Vali Acc: 0.382 Test Loss: 1.331 Test Acc: 0.382
Validation loss decreased (inf --> -0.381566).  Saving model ...
Epoch: 2 cost time: 1.2162854671478271
Epoch: 2, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.195 Vali Acc: 0.625 Test Loss: 1.195 Test Acc: 0.625
Validation loss decreased (-0.381566 --> -0.624988).  Saving model ...
Epoch: 3 cost time: 1.2306468486785889
Epoch: 3, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.026 Vali Acc: 0.704 Test Loss: 1.026 Test Acc: 0.704
Validation loss decreased (-0.624988 --> -0.703937).  Saving model ...
Epoch: 4 cost time: 1.2463746070861816
Epoch: 4, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
Validation loss decreased (-0.703937 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.2355942726135254
Epoch: 5, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.709 Vali Acc: 0.770 Test Loss: 0.709 Test Acc: 0.770
Validation loss decreased (-0.710518 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 1.2716889381408691
Epoch: 6, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3331968784332275
Epoch: 7, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.3077621459960938
Epoch: 8, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.530 Vali Acc: 0.770 Test Loss: 0.530 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3121123313903809
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.2700660228729248
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.304551124572754
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2050256729125977
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.559 Vali Acc: 0.803 Test Loss: 0.559 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.2408597469329834
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.574 Vali Acc: 0.796 Test Loss: 0.574 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2397687435150146
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.589 Vali Acc: 0.803 Test Loss: 0.589 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1679434776306152
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.610 Vali Acc: 0.796 Test Loss: 0.610 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2344064712524414
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2706589698791504
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.635 Vali Acc: 0.796 Test Loss: 0.635 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2602789402008057
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2027311325073242
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.656 Vali Acc: 0.796 Test Loss: 0.656 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3371293544769287
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.663 Vali Acc: 0.796 Test Loss: 0.663 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.220531702041626
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.679 Vali Acc: 0.803 Test Loss: 0.679 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2213163375854492
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1169156
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6672134399414062
Epoch: 1, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.343 Vali Acc: 0.329 Test Loss: 1.343 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.134519100189209
Epoch: 2, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.226 Vali Acc: 0.507 Test Loss: 1.226 Test Acc: 0.507
Validation loss decreased (-0.328934 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 1.1141915321350098
Epoch: 3, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.065 Vali Acc: 0.658 Test Loss: 1.065 Test Acc: 0.658
Validation loss decreased (-0.506567 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 1.1128692626953125
Epoch: 4, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.898 Vali Acc: 0.697 Test Loss: 0.898 Test Acc: 0.697
Validation loss decreased (-0.657884 --> -0.697359).  Saving model ...
Epoch: 5 cost time: 1.0773274898529053
Epoch: 5, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.763 Vali Acc: 0.704 Test Loss: 0.763 Test Acc: 0.704
Validation loss decreased (-0.697359 --> -0.703940).  Saving model ...
Epoch: 6 cost time: 1.3226594924926758
Epoch: 6, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.663 Vali Acc: 0.730 Test Loss: 0.663 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 1.171081304550171
Epoch: 7, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.1877224445343018
Epoch: 8, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.2445166110992432
Epoch: 9, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.544 Vali Acc: 0.757 Test Loss: 0.544 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2145891189575195
Epoch: 10, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.313835859298706
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.2023379802703857
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.296884536743164
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1924948692321777
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.593 Vali Acc: 0.803 Test Loss: 0.593 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1891522407531738
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1867151260375977
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2030467987060547
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3039958477020264
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.222224235534668
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.796 Test Loss: 0.653 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2264444828033447
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.658 Vali Acc: 0.796 Test Loss: 0.658 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1265764236450195
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1603834629058838
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.676 Vali Acc: 0.803 Test Loss: 0.676 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1169284
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9728643894195557
Epoch: 1, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.329 Vali Acc: 0.349 Test Loss: 1.329 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.2512788772583008
Epoch: 2, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.210 Vali Acc: 0.612 Test Loss: 1.210 Test Acc: 0.612
Validation loss decreased (-0.348671 --> -0.611830).  Saving model ...
Epoch: 3 cost time: 1.293508529663086
Epoch: 3, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.063 Vali Acc: 0.651 Test Loss: 1.063 Test Acc: 0.651
Validation loss decreased (-0.611830 --> -0.651305).  Saving model ...
Epoch: 4 cost time: 1.1625885963439941
Epoch: 4, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.915 Vali Acc: 0.697 Test Loss: 0.915 Test Acc: 0.697
Validation loss decreased (-0.651305 --> -0.697359).  Saving model ...
Epoch: 5 cost time: 1.272202730178833
Epoch: 5, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.778 Vali Acc: 0.743 Test Loss: 0.778 Test Acc: 0.743
Validation loss decreased (-0.697359 --> -0.743413).  Saving model ...
Epoch: 6 cost time: 1.219818115234375
Epoch: 6, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.670 Vali Acc: 0.770 Test Loss: 0.670 Test Acc: 0.770
Validation loss decreased (-0.743413 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 1.1725471019744873
Epoch: 7, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.3555080890655518
Epoch: 8, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2463386058807373
Epoch: 9, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 10 cost time: 1.345313310623169
Epoch: 10, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 1.1932494640350342
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.2934210300445557
Epoch: 12, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2695622444152832
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1827962398529053
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.1926844120025635
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.2441415786743164
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3427515029907227
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2417685985565186
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2763080596923828
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2789816856384277
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.250316858291626
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3057384490966797
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2193381786346436
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.796 Test Loss: 0.669 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2074127197265625
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2782578468322754
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1163396
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6799612045288086
Epoch: 1, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.333 Vali Acc: 0.362 Test Loss: 1.333 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 0.9934408664703369
Epoch: 2, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.212 Vali Acc: 0.579 Test Loss: 1.212 Test Acc: 0.579
Validation loss decreased (-0.361829 --> -0.578935).  Saving model ...
Epoch: 3 cost time: 0.9736099243164062
Epoch: 3, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.047 Vali Acc: 0.658 Test Loss: 1.047 Test Acc: 0.658
Validation loss decreased (-0.578935 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 0.9803426265716553
Epoch: 4, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.864 Vali Acc: 0.684 Test Loss: 0.864 Test Acc: 0.684
Validation loss decreased (-0.657884 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 0.9686970710754395
Epoch: 5, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.716 Vali Acc: 0.743 Test Loss: 0.716 Test Acc: 0.743
Validation loss decreased (-0.684202 --> -0.743414).  Saving model ...
Epoch: 6 cost time: 1.0023314952850342
Epoch: 6, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.073845624923706
Epoch: 7, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 0.9759619235992432
Epoch: 8, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.115781307220459
Epoch: 9, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.0246500968933105
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.0490875244140625
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.017850637435913
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0017046928405762
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.934006929397583
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9350810050964355
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9004290103912354
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.789 Test Loss: 0.668 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.953549861907959
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8801231384277344
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8746938705444336
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0901939868927002
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 352900
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7949533462524414
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.346 Vali Acc: 0.401 Test Loss: 1.346 Test Acc: 0.401
Validation loss decreased (inf --> -0.401302).  Saving model ...
Epoch: 2 cost time: 0.9404807090759277
Epoch: 2, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.211 Vali Acc: 0.559 Test Loss: 1.211 Test Acc: 0.559
Validation loss decreased (-0.401302 --> -0.559198).  Saving model ...
Epoch: 3 cost time: 0.9651572704315186
Epoch: 3, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.018 Vali Acc: 0.632 Test Loss: 1.018 Test Acc: 0.632
Validation loss decreased (-0.559198 --> -0.631569).  Saving model ...
Epoch: 4 cost time: 0.9634978771209717
Epoch: 4, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.820 Vali Acc: 0.684 Test Loss: 0.820 Test Acc: 0.684
Validation loss decreased (-0.631569 --> -0.684202).  Saving model ...
Epoch: 5 cost time: 1.0310213565826416
Epoch: 5, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.676 Vali Acc: 0.737 Test Loss: 0.676 Test Acc: 0.737
Validation loss decreased (-0.684202 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 0.9417557716369629
Epoch: 6, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.585 Vali Acc: 0.743 Test Loss: 0.585 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 0.9836926460266113
Epoch: 7, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.0211656093597412
Epoch: 8, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 9 cost time: 0.8663105964660645
Epoch: 9, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.047379732131958
Epoch: 10, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.0051813125610352
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0030169486999512
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.046710729598999
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.0046277046203613
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.063722848892212
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 1.076483964920044
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.656 Vali Acc: 0.803 Test Loss: 0.656 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0286734104156494
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0085821151733398
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.671 Vali Acc: 0.796 Test Loss: 0.671 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9895164966583252
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9722108840942383
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0384972095489502
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9527568817138672
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.071824073791504
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9613349437713623
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0320699214935303
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 352964
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.439898729324341
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.350 Vali Acc: 0.382 Test Loss: 1.350 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 0.9649457931518555
Epoch: 2, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.266 Vali Acc: 0.513 Test Loss: 1.266 Test Acc: 0.513
Validation loss decreased (-0.381565 --> -0.513145).  Saving model ...
Epoch: 3 cost time: 0.9063634872436523
Epoch: 3, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.147 Vali Acc: 0.539 Test Loss: 1.147 Test Acc: 0.539
Validation loss decreased (-0.513145 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.0679349899291992
Epoch: 4, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.017 Vali Acc: 0.632 Test Loss: 1.017 Test Acc: 0.632
Validation loss decreased (-0.539462 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 0.9063520431518555
Epoch: 5, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.888 Vali Acc: 0.664 Test Loss: 0.888 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 1.0076096057891846
Epoch: 6, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.769 Vali Acc: 0.717 Test Loss: 0.769 Test Acc: 0.717
Validation loss decreased (-0.664465 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.0119960308074951
Epoch: 7, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.666 Vali Acc: 0.743 Test Loss: 0.666 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.008568525314331
Epoch: 8, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.598 Vali Acc: 0.743 Test Loss: 0.598 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 0.9437747001647949
Epoch: 9, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.554 Vali Acc: 0.757 Test Loss: 0.554 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.0018959045410156
Epoch: 10, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9477834701538086
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.530 Vali Acc: 0.757 Test Loss: 0.530 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 12 cost time: 0.9946346282958984
Epoch: 12, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 0.9709258079528809
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 0.9136133193969727
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 0.985943078994751
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9465353488922119
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9488129615783691
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0492737293243408
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9461088180541992
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.007934331893921
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0832650661468506
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9872078895568848
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.015439510345459
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9762709140777588
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 331524
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4471054077148438
Epoch: 1, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.357 Vali Acc: 0.322 Test Loss: 1.357 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 0.9429173469543457
Epoch: 2, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.284 Vali Acc: 0.454 Test Loss: 1.284 Test Acc: 0.454
Validation loss decreased (-0.322355 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 0.9657042026519775
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.190 Vali Acc: 0.559 Test Loss: 1.190 Test Acc: 0.559
Validation loss decreased (-0.453935 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.0059881210327148
Epoch: 4, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.073 Vali Acc: 0.658 Test Loss: 1.073 Test Acc: 0.658
Validation loss decreased (-0.559199 --> -0.657884).  Saving model ...
Epoch: 5 cost time: 0.9137389659881592
Epoch: 5, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.957 Vali Acc: 0.711 Test Loss: 0.957 Test Acc: 0.711
Validation loss decreased (-0.657884 --> -0.710517).  Saving model ...
Epoch: 6 cost time: 0.9434676170349121
Epoch: 6, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.710517 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 0.9803287982940674
Epoch: 7, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.745 Vali Acc: 0.730 Test Loss: 0.745 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9569742679595947
Epoch: 8, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.668 Vali Acc: 0.730 Test Loss: 0.668 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9396052360534668
Epoch: 9, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 0.9750359058380127
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.0611870288848877
Epoch: 11, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9960181713104248
Epoch: 12, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.0087993144989014
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.533 Vali Acc: 0.750 Test Loss: 0.533 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.959113597869873
Epoch: 14, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.528 Vali Acc: 0.763 Test Loss: 0.528 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 15 cost time: 0.8885798454284668
Epoch: 15, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.018845796585083
Epoch: 16, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9901449680328369
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.553 Vali Acc: 0.763 Test Loss: 0.553 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0105726718902588
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 1.090097188949585
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.011059284210205
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.052201271057129
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 0.954268217086792
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.031275749206543
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.017491102218628
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 25 cost time: 0.9554767608642578
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.942241907119751
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 27 cost time: 1.0261669158935547
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8975722789764404
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0632238388061523
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9917888641357422
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.662 Vali Acc: 0.789 Test Loss: 0.662 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.09039306640625
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.672 Vali Acc: 0.796 Test Loss: 0.672 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0757334232330322
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.676 Vali Acc: 0.796 Test Loss: 0.676 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.032604455947876
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.681 Vali Acc: 0.796 Test Loss: 0.681 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.095428705215454
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.696 Vali Acc: 0.796 Test Loss: 0.696 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.070845127105713
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.023362636566162
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.709 Vali Acc: 0.796 Test Loss: 0.709 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 322436
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.768101692199707
Epoch: 1, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.345 Vali Acc: 0.401 Test Loss: 1.345 Test Acc: 0.401
Validation loss decreased (inf --> -0.401302).  Saving model ...
Epoch: 2 cost time: 1.0215353965759277
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.281 Vali Acc: 0.507 Test Loss: 1.281 Test Acc: 0.507
Validation loss decreased (-0.401302 --> -0.506566).  Saving model ...
Epoch: 3 cost time: 0.9210479259490967
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.190 Vali Acc: 0.553 Test Loss: 1.190 Test Acc: 0.553
Validation loss decreased (-0.506566 --> -0.552620).  Saving model ...
Epoch: 4 cost time: 1.0297839641571045
Epoch: 4, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.094 Vali Acc: 0.632 Test Loss: 1.094 Test Acc: 0.632
Validation loss decreased (-0.552620 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 0.9145739078521729
Epoch: 5, Steps: 10 | Train Loss: 0.893 Vali Loss: 0.986 Vali Acc: 0.664 Test Loss: 0.986 Test Acc: 0.664
Validation loss decreased (-0.631568 --> -0.664464).  Saving model ...
Epoch: 6 cost time: 1.054443597793579
Epoch: 6, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.884 Vali Acc: 0.704 Test Loss: 0.884 Test Acc: 0.704
Validation loss decreased (-0.664464 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.0120611190795898
Epoch: 7, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.785 Vali Acc: 0.711 Test Loss: 0.785 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 0.9648420810699463
Epoch: 8, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.0023720264434814
Epoch: 9, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.640 Vali Acc: 0.757 Test Loss: 0.640 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 0.9979438781738281
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.1158182621002197
Epoch: 11, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 0.9787313938140869
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.532 Vali Acc: 0.757 Test Loss: 0.532 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 13 cost time: 1.1529808044433594
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.522 Vali Acc: 0.750 Test Loss: 0.522 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0117151737213135
Epoch: 14, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769732).  Saving model ...
Epoch: 15 cost time: 1.0666282176971436
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 16 cost time: 1.1084399223327637
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 0.991074800491333
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0121703147888184
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.090470790863037
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9160323143005371
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0226974487304688
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0483949184417725
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0438966751098633
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0657305717468262
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9850015640258789
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0326461791992188
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.592 Vali Acc: 0.770 Test Loss: 0.592 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0625121593475342
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.602 Vali Acc: 0.776 Test Loss: 0.602 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.989893913269043
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 322500
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.531900405883789
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.370 Vali Acc: 0.270 Test Loss: 1.370 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.0865204334259033
Epoch: 2, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.313 Vali Acc: 0.395 Test Loss: 1.313 Test Acc: 0.395
Validation loss decreased (-0.269723 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.040266752243042
Epoch: 3, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.231 Vali Acc: 0.507 Test Loss: 1.231 Test Acc: 0.507
Validation loss decreased (-0.394724 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.1376636028289795
Epoch: 4, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.136 Vali Acc: 0.592 Test Loss: 1.136 Test Acc: 0.592
Validation loss decreased (-0.506567 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 1.0729358196258545
Epoch: 5, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.037 Vali Acc: 0.651 Test Loss: 1.037 Test Acc: 0.651
Validation loss decreased (-0.592094 --> -0.651305).  Saving model ...
Epoch: 6 cost time: 1.009387731552124
Epoch: 6, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.939 Vali Acc: 0.684 Test Loss: 0.939 Test Acc: 0.684
Validation loss decreased (-0.651305 --> -0.684201).  Saving model ...
Epoch: 7 cost time: 0.9758510589599609
Epoch: 7, Steps: 10 | Train Loss: 0.706 Vali Loss: 0.845 Vali Acc: 0.697 Test Loss: 0.845 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 0.9651501178741455
Epoch: 8, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.755 Vali Acc: 0.717 Test Loss: 0.755 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 0.9395089149475098
Epoch: 9, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.683 Vali Acc: 0.757 Test Loss: 0.683 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 0.9288702011108398
Epoch: 10, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.618 Vali Acc: 0.776 Test Loss: 0.618 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 0.9016902446746826
Epoch: 11, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 0.984320878982544
Epoch: 12, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 0.9436929225921631
Epoch: 13, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.0690746307373047
Epoch: 14, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9226529598236084
Epoch: 15, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1102776527404785
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9409923553466797
Epoch: 17, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.502 Vali Acc: 0.776 Test Loss: 0.502 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1479825973510742
Epoch: 18, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9141767024993896
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1288375854492188
Epoch: 20, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9312374591827393
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.028879165649414
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9001576900482178
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 319556
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.510044574737549
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.344 Vali Acc: 0.395 Test Loss: 1.344 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 0.8407137393951416
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.268 Vali Acc: 0.572 Test Loss: 1.268 Test Acc: 0.572
Validation loss decreased (-0.394723 --> -0.572356).  Saving model ...
Epoch: 3 cost time: 0.9364774227142334
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.163 Vali Acc: 0.632 Test Loss: 1.163 Test Acc: 0.632
Validation loss decreased (-0.572356 --> -0.631567).  Saving model ...
Epoch: 4 cost time: 0.8557288646697998
Epoch: 4, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.040 Vali Acc: 0.651 Test Loss: 1.040 Test Acc: 0.651
Validation loss decreased (-0.631567 --> -0.651305).  Saving model ...
Epoch: 5 cost time: 0.8106839656829834
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
Validation loss decreased (-0.651305 --> -0.710517).  Saving model ...
Epoch: 6 cost time: 0.7869114875793457
Epoch: 6, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.783 Vali Acc: 0.737 Test Loss: 0.783 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736834).  Saving model ...
Epoch: 7 cost time: 0.8194625377655029
Epoch: 7, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.675 Vali Acc: 0.750 Test Loss: 0.675 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.8392786979675293
Epoch: 8, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 0.8019139766693115
Epoch: 9, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 0.8604135513305664
Epoch: 10, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 0.8227429389953613
Epoch: 11, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 12 cost time: 0.9134724140167236
Epoch: 12, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.804966926574707
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8834061622619629
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 15 cost time: 0.8850107192993164
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.522 Vali Acc: 0.809 Test Loss: 0.522 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.869997501373291
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9092912673950195
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8960521221160889
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.561 Vali Acc: 0.816 Test Loss: 0.561 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9474818706512451
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8910107612609863
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.578 Vali Acc: 0.809 Test Loss: 0.578 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8804728984832764
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.592 Vali Acc: 0.829 Test Loss: 0.592 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828941).  Saving model ...
Epoch: 22 cost time: 0.9304533004760742
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8487453460693359
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8426179885864258
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8891763687133789
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8967108726501465
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8073000907897949
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9008018970489502
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8917865753173828
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.647 Vali Acc: 0.822 Test Loss: 0.647 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9007079601287842
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.653 Vali Acc: 0.829 Test Loss: 0.653 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9034805297851562
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 110916
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2335033416748047
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.797558069229126
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.315 Vali Acc: 0.388 Test Loss: 1.315 Test Acc: 0.388
Validation loss decreased (-0.269723 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 0.7909784317016602
Epoch: 3, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.222 Vali Acc: 0.513 Test Loss: 1.222 Test Acc: 0.513
Validation loss decreased (-0.388145 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 0.8932206630706787
Epoch: 4, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.108 Vali Acc: 0.625 Test Loss: 1.108 Test Acc: 0.625
Validation loss decreased (-0.513146 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.85408616065979
Epoch: 5, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.984 Vali Acc: 0.678 Test Loss: 0.984 Test Acc: 0.678
Validation loss decreased (-0.624989 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 0.9503915309906006
Epoch: 6, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.849 Vali Acc: 0.737 Test Loss: 0.849 Test Acc: 0.737
Validation loss decreased (-0.677622 --> -0.736834).  Saving model ...
Epoch: 7 cost time: 0.8606150150299072
Epoch: 7, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.732 Vali Acc: 0.763 Test Loss: 0.732 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 0.8877146244049072
Epoch: 8, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.640 Vali Acc: 0.776 Test Loss: 0.640 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 9 cost time: 0.9094672203063965
Epoch: 9, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 0.8555631637573242
Epoch: 10, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 0.9170246124267578
Epoch: 11, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.911715030670166
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9100744724273682
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8336143493652344
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7607884407043457
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8602943420410156
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8832902908325195
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8343753814697266
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8784818649291992
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 0.8761007785797119
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8681554794311523
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8172805309295654
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9397714138031006
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 0.9395737648010254
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.609 Vali Acc: 0.809 Test Loss: 0.609 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 25 cost time: 0.9641625881195068
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8764090538024902
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9279959201812744
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9475612640380859
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8719098567962646
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8406982421875
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.872197151184082
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8833014965057373
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8453469276428223
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8562493324279785
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 110948
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.539499044418335
Epoch: 1, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.368 Vali Acc: 0.289 Test Loss: 1.368 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.9188861846923828
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.330 Vali Acc: 0.388 Test Loss: 1.330 Test Acc: 0.388
Validation loss decreased (-0.289460 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 0.897209882736206
Epoch: 3, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.278 Vali Acc: 0.480 Test Loss: 1.278 Test Acc: 0.480
Validation loss decreased (-0.388145 --> -0.480250).  Saving model ...
Epoch: 4 cost time: 0.8929295539855957
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.211 Vali Acc: 0.546 Test Loss: 1.211 Test Acc: 0.546
Validation loss decreased (-0.480250 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 0.8156430721282959
Epoch: 5, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.140 Vali Acc: 0.559 Test Loss: 1.140 Test Acc: 0.559
Validation loss decreased (-0.546041 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 0.9499623775482178
Epoch: 6, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.058 Vali Acc: 0.586 Test Loss: 1.058 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585516).  Saving model ...
Epoch: 7 cost time: 0.8555905818939209
Epoch: 7, Steps: 10 | Train Loss: 0.816 Vali Loss: 0.971 Vali Acc: 0.645 Test Loss: 0.971 Test Acc: 0.645
Validation loss decreased (-0.585516 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 0.8549251556396484
Epoch: 8, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.887 Vali Acc: 0.651 Test Loss: 0.887 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 0.8905758857727051
Epoch: 9, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.803 Vali Acc: 0.671 Test Loss: 0.803 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671045).  Saving model ...
Epoch: 10 cost time: 0.8903145790100098
Epoch: 10, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.736 Vali Acc: 0.697 Test Loss: 0.736 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 11 cost time: 0.8520078659057617
Epoch: 11, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.675 Vali Acc: 0.711 Test Loss: 0.675 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710520).  Saving model ...
Epoch: 12 cost time: 0.8566524982452393
Epoch: 12, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.631 Vali Acc: 0.724 Test Loss: 0.631 Test Acc: 0.724
Validation loss decreased (-0.710520 --> -0.723678).  Saving model ...
Epoch: 13 cost time: 0.8128225803375244
Epoch: 13, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.594 Vali Acc: 0.730 Test Loss: 0.594 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 14 cost time: 0.909271240234375
Epoch: 14, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 15 cost time: 0.922102689743042
Epoch: 15, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736837).  Saving model ...
Epoch: 16 cost time: 0.8217487335205078
Epoch: 16, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.532 Vali Acc: 0.750 Test Loss: 0.532 Test Acc: 0.750
Validation loss decreased (-0.736837 --> -0.749995).  Saving model ...
Epoch: 17 cost time: 0.9245638847351074
Epoch: 17, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.521 Vali Acc: 0.743 Test Loss: 0.521 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9414317607879639
Epoch: 18, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.519 Vali Acc: 0.743 Test Loss: 0.519 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9153017997741699
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.519 Vali Acc: 0.743 Test Loss: 0.519 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9600179195404053
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.520 Vali Acc: 0.743 Test Loss: 0.520 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8430936336517334
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 22 cost time: 0.8499417304992676
Epoch: 22, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.525 Vali Acc: 0.757 Test Loss: 0.525 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756574).  Saving model ...
Epoch: 23 cost time: 0.8300154209136963
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 24 cost time: 0.9597244262695312
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8691561222076416
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9950623512268066
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9321122169494629
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9215667247772217
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 0.9335589408874512
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9344284534454346
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9175126552581787
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 32 cost time: 0.9784607887268066
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9597549438476562
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9009246826171875
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9084692001342773
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8777620792388916
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9991762638092041
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.594 Vali Acc: 0.789 Test Loss: 0.594 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 0.9097919464111328
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.603 Vali Acc: 0.789 Test Loss: 0.603 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8412845134735107
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9495844841003418
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.981712818145752
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9456543922424316
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9554905891418457
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9554708003997803
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9415590763092041
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9971849918365479
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8472514152526855
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 100228
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5113685131073
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.361 Vali Acc: 0.276 Test Loss: 1.361 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 0.9621543884277344
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.323 Vali Acc: 0.336 Test Loss: 1.323 Test Acc: 0.336
Validation loss decreased (-0.276302 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.9260995388031006
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.274 Vali Acc: 0.421 Test Loss: 1.274 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 0.9763896465301514
Epoch: 4, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.217 Vali Acc: 0.520 Test Loss: 1.217 Test Acc: 0.520
Validation loss decreased (-0.421040 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 0.9240484237670898
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.155 Vali Acc: 0.599 Test Loss: 1.155 Test Acc: 0.599
Validation loss decreased (-0.519725 --> -0.598673).  Saving model ...
Epoch: 6 cost time: 0.9686052799224854
Epoch: 6, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.083 Vali Acc: 0.645 Test Loss: 1.083 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644726).  Saving model ...
Epoch: 7 cost time: 0.9431941509246826
Epoch: 7, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.013 Vali Acc: 0.645 Test Loss: 1.013 Test Acc: 0.645
Validation loss decreased (-0.644726 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 0.9415295124053955
Epoch: 8, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.940 Vali Acc: 0.678 Test Loss: 0.940 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 1.007934808731079
Epoch: 9, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.867 Vali Acc: 0.704 Test Loss: 0.867 Test Acc: 0.704
Validation loss decreased (-0.677622 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 0.8689460754394531
Epoch: 10, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.796 Vali Acc: 0.691 Test Loss: 0.796 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8533916473388672
Epoch: 11, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.737 Vali Acc: 0.704 Test Loss: 0.737 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 12 cost time: 0.8370828628540039
Epoch: 12, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.681 Vali Acc: 0.717 Test Loss: 0.681 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 0.9478681087493896
Epoch: 13, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 0.8776106834411621
Epoch: 14, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 0.8632729053497314
Epoch: 15, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 0.9574732780456543
Epoch: 16, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.554 Vali Acc: 0.757 Test Loss: 0.554 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 0.8711404800415039
Epoch: 17, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.537 Vali Acc: 0.757 Test Loss: 0.537 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 18 cost time: 1.0035638809204102
Epoch: 18, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.522 Vali Acc: 0.757 Test Loss: 0.522 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 19 cost time: 0.9575526714324951
Epoch: 19, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.516 Vali Acc: 0.763 Test Loss: 0.516 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 20 cost time: 0.8998448848724365
Epoch: 20, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.512 Vali Acc: 0.763 Test Loss: 0.512 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 21 cost time: 0.9210009574890137
Epoch: 21, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.509 Vali Acc: 0.763 Test Loss: 0.509 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 22 cost time: 0.914865255355835
Epoch: 22, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.511 Vali Acc: 0.763 Test Loss: 0.511 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8873472213745117
Epoch: 23, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 24 cost time: 0.8565993309020996
Epoch: 24, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 25 cost time: 0.8547136783599854
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9633471965789795
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8738093376159668
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9893209934234619
Epoch: 28, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9103569984436035
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8844037055969238
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9499127864837646
Epoch: 31, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 0.9764587879180908
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9435601234436035
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9053130149841309
Epoch: 34, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9090430736541748
Epoch: 35, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9089233875274658
Epoch: 36, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8938956260681152
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 38 cost time: 0.8632526397705078
Epoch: 38, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8683090209960938
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9483897686004639
Epoch: 40, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9463949203491211
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8911044597625732
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.886587381362915
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.625 Vali Acc: 0.796 Test Loss: 0.625 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9640176296234131
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 45 cost time: 0.847949743270874
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8890554904937744
Epoch: 46, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.645 Vali Acc: 0.796 Test Loss: 0.645 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9458532333374023
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8081610202789307
Epoch: 48, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8613369464874268
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.819042444229126
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 95684
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.483726739883423
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.378 Vali Acc: 0.303 Test Loss: 1.378 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.9056010246276855
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.343 Vali Acc: 0.401 Test Loss: 1.343 Test Acc: 0.401
Validation loss decreased (-0.302618 --> -0.401302).  Saving model ...
Epoch: 3 cost time: 0.9523880481719971
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.296 Vali Acc: 0.493 Test Loss: 1.296 Test Acc: 0.493
Validation loss decreased (-0.401302 --> -0.493408).  Saving model ...
Epoch: 4 cost time: 0.950545072555542
Epoch: 4, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.239 Vali Acc: 0.553 Test Loss: 1.239 Test Acc: 0.553
Validation loss decreased (-0.493408 --> -0.552619).  Saving model ...
Epoch: 5 cost time: 0.8606736660003662
Epoch: 5, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.173 Vali Acc: 0.566 Test Loss: 1.173 Test Acc: 0.566
Validation loss decreased (-0.552619 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 0.9421396255493164
Epoch: 6, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.100 Vali Acc: 0.658 Test Loss: 1.100 Test Acc: 0.658
Validation loss decreased (-0.565778 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 0.8514342308044434
Epoch: 7, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.030 Vali Acc: 0.684 Test Loss: 1.030 Test Acc: 0.684
Validation loss decreased (-0.657884 --> -0.684200).  Saving model ...
Epoch: 8 cost time: 0.8837943077087402
Epoch: 8, Steps: 10 | Train Loss: 0.858 Vali Loss: 0.948 Vali Acc: 0.684 Test Loss: 0.948 Test Acc: 0.684
Validation loss decreased (-0.684200 --> -0.684201).  Saving model ...
Epoch: 9 cost time: 0.8913359642028809
Epoch: 9, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
Validation loss decreased (-0.684201 --> -0.717097).  Saving model ...
Epoch: 10 cost time: 0.9098148345947266
Epoch: 10, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.800 Vali Acc: 0.711 Test Loss: 0.800 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8424029350280762
Epoch: 11, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.735 Vali Acc: 0.757 Test Loss: 0.735 Test Acc: 0.757
Validation loss decreased (-0.717097 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 0.9442694187164307
Epoch: 12, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.677 Vali Acc: 0.770 Test Loss: 0.677 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 13 cost time: 0.8801405429840088
Epoch: 13, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.629 Vali Acc: 0.757 Test Loss: 0.629 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9753215312957764
Epoch: 14, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 0.9215073585510254
Epoch: 15, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 0.9599652290344238
Epoch: 16, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 0.9063482284545898
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.0541155338287354
Epoch: 18, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.511 Vali Acc: 0.789 Test Loss: 0.511 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.936734676361084
Epoch: 19, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.497 Vali Acc: 0.796 Test Loss: 0.497 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8845186233520508
Epoch: 20, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.488 Vali Acc: 0.796 Test Loss: 0.488 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8194849491119385
Epoch: 21, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 0.8788595199584961
Epoch: 22, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 23 cost time: 0.8462269306182861
Epoch: 23, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8530023097991943
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.488 Vali Acc: 0.809 Test Loss: 0.488 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8360855579376221
Epoch: 25, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.491 Vali Acc: 0.809 Test Loss: 0.491 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8387253284454346
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.493 Vali Acc: 0.816 Test Loss: 0.493 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9406063556671143
Epoch: 27, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.496 Vali Acc: 0.829 Test Loss: 0.496 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828942).  Saving model ...
Epoch: 28 cost time: 0.8924753665924072
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.501 Vali Acc: 0.816 Test Loss: 0.501 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9291353225708008
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.508 Vali Acc: 0.816 Test Loss: 0.508 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8866016864776611
Epoch: 30, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.515 Vali Acc: 0.829 Test Loss: 0.515 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9632441997528076
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.523 Vali Acc: 0.836 Test Loss: 0.523 Test Acc: 0.836
Validation loss decreased (-0.828942 --> -0.835521).  Saving model ...
Epoch: 32 cost time: 0.8726239204406738
Epoch: 32, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9890127182006836
Epoch: 33, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8679873943328857
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.540 Vali Acc: 0.816 Test Loss: 0.540 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8815202713012695
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.544 Vali Acc: 0.822 Test Loss: 0.544 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8275649547576904
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.548 Vali Acc: 0.822 Test Loss: 0.548 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8567557334899902
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.554 Vali Acc: 0.822 Test Loss: 0.554 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9162557125091553
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.565 Vali Acc: 0.822 Test Loss: 0.565 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8066010475158691
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8332593441009521
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.569 Vali Acc: 0.816 Test Loss: 0.569 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8972516059875488
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.586 Vali Acc: 0.822 Test Loss: 0.586 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 95716
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5452029705047607
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.421 Vali Acc: 0.263 Test Loss: 1.421 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 0.8894169330596924
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (-0.263144 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 0.7921509742736816
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.358 Vali Acc: 0.289 Test Loss: 1.358 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 0.8381967544555664
Epoch: 4, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.308 Vali Acc: 0.421 Test Loss: 1.308 Test Acc: 0.421
Validation loss decreased (-0.289460 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 0.8631505966186523
Epoch: 5, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.256 Vali Acc: 0.467 Test Loss: 1.256 Test Acc: 0.467
Validation loss decreased (-0.421040 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 0.7965681552886963
Epoch: 6, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.194 Vali Acc: 0.586 Test Loss: 1.194 Test Acc: 0.586
Validation loss decreased (-0.467093 --> -0.585514).  Saving model ...
Epoch: 7 cost time: 0.804938554763794
Epoch: 7, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.136 Vali Acc: 0.618 Test Loss: 1.136 Test Acc: 0.618
Validation loss decreased (-0.585514 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 0.8623926639556885
Epoch: 8, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.071 Vali Acc: 0.638 Test Loss: 1.071 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 0.7881715297698975
Epoch: 9, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.005 Vali Acc: 0.664 Test Loss: 1.005 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 0.8674960136413574
Epoch: 10, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.946 Vali Acc: 0.684 Test Loss: 0.946 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684201).  Saving model ...
Epoch: 11 cost time: 0.8391964435577393
Epoch: 11, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.884 Vali Acc: 0.697 Test Loss: 0.884 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 12 cost time: 0.8783445358276367
Epoch: 12, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717097).  Saving model ...
Epoch: 13 cost time: 0.7951581478118896
Epoch: 13, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.770 Vali Acc: 0.717 Test Loss: 0.770 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717098).  Saving model ...
Epoch: 14 cost time: 0.8752646446228027
Epoch: 14, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.721 Vali Acc: 0.730 Test Loss: 0.721 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 0.8452644348144531
Epoch: 15, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.678 Vali Acc: 0.763 Test Loss: 0.678 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 0.8493754863739014
Epoch: 16, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 0.8353621959686279
Epoch: 17, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.613 Vali Acc: 0.770 Test Loss: 0.613 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 0.9557814598083496
Epoch: 18, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 0.8841917514801025
Epoch: 19, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 0.8358268737792969
Epoch: 20, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 0.8659429550170898
Epoch: 21, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 0.7752935886383057
Epoch: 22, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 0.7933773994445801
Epoch: 23, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8086996078491211
Epoch: 24, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7578892707824707
Epoch: 25, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7782840728759766
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8826560974121094
Epoch: 27, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9664170742034912
Epoch: 28, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8992924690246582
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9025344848632812
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8906257152557373
Epoch: 31, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8703176975250244
Epoch: 32, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 94244
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6739583015441895
Epoch: 1, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 1.2670533657073975
Epoch: 2, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.024 Vali Acc: 0.632 Test Loss: 1.024 Test Acc: 0.632
Validation loss decreased (-0.499987 --> -0.631569).  Saving model ...
Epoch: 3 cost time: 1.1182241439819336
Epoch: 3, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.737 Vali Acc: 0.724 Test Loss: 0.737 Test Acc: 0.724
Validation loss decreased (-0.631569 --> -0.723677).  Saving model ...
Epoch: 4 cost time: 1.1317076683044434
Epoch: 4, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763152).  Saving model ...
Epoch: 5 cost time: 1.262636661529541
Epoch: 5, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 6 cost time: 1.1764414310455322
Epoch: 6, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 7 cost time: 1.2253761291503906
Epoch: 7, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1760263442993164
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.2361598014831543
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 10 cost time: 1.2205300331115723
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.660 Vali Acc: 0.816 Test Loss: 0.660 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815783).  Saving model ...
Epoch: 11 cost time: 1.1295859813690186
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.670 Vali Acc: 0.829 Test Loss: 0.670 Test Acc: 0.829
Validation loss decreased (-0.815783 --> -0.828941).  Saving model ...
Epoch: 12 cost time: 1.1624538898468018
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2053394317626953
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2101309299468994
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1342480182647705
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.829 Test Loss: 0.741 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2915101051330566
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.816 Test Loss: 0.744 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1595120429992676
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.816 Test Loss: 0.750 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2838010787963867
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.816 Test Loss: 0.768 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2658629417419434
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.816 Test Loss: 0.791 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1273248195648193
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.829 Test Loss: 0.796 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2457294464111328
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.822 Test Loss: 0.804 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1220868
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.395345449447632
Epoch: 1, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.295 Vali Acc: 0.493 Test Loss: 1.295 Test Acc: 0.493
Validation loss decreased (inf --> -0.493408).  Saving model ...
Epoch: 2 cost time: 1.1994247436523438
Epoch: 2, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.046 Vali Acc: 0.691 Test Loss: 1.046 Test Acc: 0.691
Validation loss decreased (-0.493408 --> -0.690779).  Saving model ...
Epoch: 3 cost time: 1.2181179523468018
Epoch: 3, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.759 Vali Acc: 0.717 Test Loss: 0.759 Test Acc: 0.717
Validation loss decreased (-0.690779 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 1.147092580795288
Epoch: 4, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 1.1528494358062744
Epoch: 5, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 6 cost time: 1.1201496124267578
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 7 cost time: 1.216064214706421
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1293506622314453
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 9 cost time: 1.2776572704315186
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.642 Vali Acc: 0.796 Test Loss: 0.642 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1805462837219238
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1528897285461426
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.689 Vali Acc: 0.809 Test Loss: 0.689 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1690924167633057
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.122666358947754
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2766749858856201
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.718 Vali Acc: 0.816 Test Loss: 0.718 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 15 cost time: 1.155076503753662
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2063558101654053
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.809 Test Loss: 0.751 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1185753345489502
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.816 Test Loss: 0.768 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.147230863571167
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.816 Test Loss: 0.779 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.246932029724121
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.816 Test Loss: 0.786 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.02156400680542
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.822 Test Loss: 0.794 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822360).  Saving model ...
Epoch: 21 cost time: 1.0071742534637451
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.816 Test Loss: 0.806 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.100170612335205
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.816 Test Loss: 0.816 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1706843376159668
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.816 Test Loss: 0.830 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.150585651397705
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.816 Test Loss: 0.835 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1615827083587646
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.816 Test Loss: 0.847 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1505229473114014
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.822 Test Loss: 0.848 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1172831058502197
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.822 Test Loss: 0.861 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2384467124938965
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.822 Test Loss: 0.863 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1107544898986816
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.822 Test Loss: 0.863 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1433696746826172
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.869 Vali Acc: 0.822 Test Loss: 0.869 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1220996
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7348170280456543
Epoch: 1, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.342 Vali Acc: 0.342 Test Loss: 1.342 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.2469592094421387
Epoch: 2, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.179 Vali Acc: 0.632 Test Loss: 1.179 Test Acc: 0.632
Validation loss decreased (-0.342092 --> -0.631567).  Saving model ...
Epoch: 3 cost time: 1.1617648601531982
Epoch: 3, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.978 Vali Acc: 0.671 Test Loss: 0.978 Test Acc: 0.671
Validation loss decreased (-0.631567 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 1.2644295692443848
Epoch: 4, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.801 Vali Acc: 0.678 Test Loss: 0.801 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677624).  Saving model ...
Epoch: 5 cost time: 1.279029369354248
Epoch: 5, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
Validation loss decreased (-0.677624 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 1.1939911842346191
Epoch: 6, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.299992322921753
Epoch: 7, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.233267068862915
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2008004188537598
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.2090363502502441
Epoch: 10, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.188202142715454
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2046799659729004
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1732590198516846
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1292684078216553
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0792481899261475
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2244374752044678
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1356697082519531
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.673 Vali Acc: 0.783 Test Loss: 0.673 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1589395999908447
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.681 Vali Acc: 0.796 Test Loss: 0.681 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 19 cost time: 1.3003029823303223
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.685 Vali Acc: 0.796 Test Loss: 0.685 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1972405910491943
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.696 Vali Acc: 0.789 Test Loss: 0.696 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1952495574951172
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3392484188079834
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.711 Vali Acc: 0.796 Test Loss: 0.711 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2414987087249756
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 24 cost time: 1.1904053688049316
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809203).  Saving model ...
Epoch: 25 cost time: 1.272887945175171
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1663544178009033
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.744 Vali Acc: 0.796 Test Loss: 0.744 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1900808811187744
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.751 Vali Acc: 0.803 Test Loss: 0.751 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2868163585662842
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.233217716217041
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.803 Test Loss: 0.771 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1537384986877441
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1860182285308838
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.803 Test Loss: 0.789 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1487822532653809
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1126906871795654
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.803 Test Loss: 0.793 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1346380710601807
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1178116
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.67807936668396
Epoch: 1, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.297 Vali Acc: 0.487 Test Loss: 1.297 Test Acc: 0.487
Validation loss decreased (inf --> -0.486829).  Saving model ...
Epoch: 2 cost time: 1.1266834735870361
Epoch: 2, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.169 Vali Acc: 0.632 Test Loss: 1.169 Test Acc: 0.632
Validation loss decreased (-0.486829 --> -0.631567).  Saving model ...
Epoch: 3 cost time: 1.1362934112548828
Epoch: 3, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.000 Vali Acc: 0.671 Test Loss: 1.000 Test Acc: 0.671
Validation loss decreased (-0.631567 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 1.0725386142730713
Epoch: 4, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.845 Vali Acc: 0.724 Test Loss: 0.845 Test Acc: 0.724
Validation loss decreased (-0.671043 --> -0.723676).  Saving model ...
Epoch: 5 cost time: 1.1448655128479004
Epoch: 5, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.710 Vali Acc: 0.750 Test Loss: 0.710 Test Acc: 0.750
Validation loss decreased (-0.723676 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.1099615097045898
Epoch: 6, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.1355762481689453
Epoch: 7, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1303822994232178
Epoch: 8, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.11507248878479
Epoch: 9, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.173799753189087
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1499943733215332
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.1435565948486328
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.122070074081421
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1499860286712646
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809204).  Saving model ...
Epoch: 15 cost time: 1.123417854309082
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.628 Vali Acc: 0.796 Test Loss: 0.628 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1498980522155762
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.642 Vali Acc: 0.796 Test Loss: 0.642 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0670185089111328
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0763273239135742
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0636415481567383
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0537323951721191
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.701 Vali Acc: 0.796 Test Loss: 0.701 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.174814224243164
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0896964073181152
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.714 Vali Acc: 0.796 Test Loss: 0.714 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0818867683410645
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.796 Test Loss: 0.722 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0831072330474854
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.735 Vali Acc: 0.796 Test Loss: 0.735 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1159940
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.660334587097168
Epoch: 1, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.334 Vali Acc: 0.388 Test Loss: 1.334 Test Acc: 0.388
Validation loss decreased (inf --> -0.388145).  Saving model ...
Epoch: 2 cost time: 1.2633426189422607
Epoch: 2, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.217 Vali Acc: 0.507 Test Loss: 1.217 Test Acc: 0.507
Validation loss decreased (-0.388145 --> -0.506567).  Saving model ...
Epoch: 3 cost time: 1.2214312553405762
Epoch: 3, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.055 Vali Acc: 0.651 Test Loss: 1.055 Test Acc: 0.651
Validation loss decreased (-0.506567 --> -0.651305).  Saving model ...
Epoch: 4 cost time: 1.1949069499969482
Epoch: 4, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.891 Vali Acc: 0.678 Test Loss: 0.891 Test Acc: 0.678
Validation loss decreased (-0.651305 --> -0.677623).  Saving model ...
Epoch: 5 cost time: 1.2383415699005127
Epoch: 5, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.752 Vali Acc: 0.724 Test Loss: 0.752 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.2501089572906494
Epoch: 6, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.642 Vali Acc: 0.750 Test Loss: 0.642 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 1.2100815773010254
Epoch: 7, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.1857988834381104
Epoch: 8, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2507126331329346
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1602246761322021
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1378393173217773
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.038353443145752
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1628167629241943
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.173255205154419
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.041111946105957
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1161413192749023
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1403002738952637
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.650 Vali Acc: 0.783 Test Loss: 0.650 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1060304641723633
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.127333641052246
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1589720249176025
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1442492008209229
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.692 Vali Acc: 0.789 Test Loss: 0.692 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 1160068
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5768282413482666
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.377 Vali Acc: 0.309 Test Loss: 1.377 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.009324550628662
Epoch: 2, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.269 Vali Acc: 0.553 Test Loss: 1.269 Test Acc: 0.553
Validation loss decreased (-0.309197 --> -0.552619).  Saving model ...
Epoch: 3 cost time: 1.1126160621643066
Epoch: 3, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.127 Vali Acc: 0.664 Test Loss: 1.127 Test Acc: 0.664
Validation loss decreased (-0.552619 --> -0.664462).  Saving model ...
Epoch: 4 cost time: 1.1674137115478516
Epoch: 4, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.973 Vali Acc: 0.704 Test Loss: 0.973 Test Acc: 0.704
Validation loss decreased (-0.664462 --> -0.703938).  Saving model ...
Epoch: 5 cost time: 1.2149980068206787
Epoch: 5, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.827 Vali Acc: 0.730 Test Loss: 0.827 Test Acc: 0.730
Validation loss decreased (-0.703938 --> -0.730255).  Saving model ...
Epoch: 6 cost time: 1.1179497241973877
Epoch: 6, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
Validation loss decreased (-0.730255 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 1.2192292213439941
Epoch: 7, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.644 Vali Acc: 0.770 Test Loss: 0.644 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.1696484088897705
Epoch: 8, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.104294776916504
Epoch: 9, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0579912662506104
Epoch: 10, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1010780334472656
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.030144453048706
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.080881118774414
Epoch: 13, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.097017765045166
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.044844150543213
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.027456521987915
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1339666843414307
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1016061305999756
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802625).  Saving model ...
Epoch: 19 cost time: 1.1603093147277832
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1805546283721924
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.663 Vali Acc: 0.796 Test Loss: 0.663 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.144394874572754
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.676 Vali Acc: 0.796 Test Loss: 0.676 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.119600534439087
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1616368293762207
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.796 Test Loss: 0.699 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.081017255783081
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0749728679656982
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1253786087036133
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0716338157653809
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.733 Vali Acc: 0.796 Test Loss: 0.733 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0632514953613281
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1154180
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.622973918914795
Epoch: 1, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.360 Vali Acc: 0.296 Test Loss: 1.360 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.9847080707550049
Epoch: 2, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.238 Vali Acc: 0.474 Test Loss: 1.238 Test Acc: 0.474
Validation loss decreased (-0.296039 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 0.9366476535797119
Epoch: 3, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.069 Vali Acc: 0.612 Test Loss: 1.069 Test Acc: 0.612
Validation loss decreased (-0.473672 --> -0.611831).  Saving model ...
Epoch: 4 cost time: 0.9349336624145508
Epoch: 4, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.871 Vali Acc: 0.664 Test Loss: 0.871 Test Acc: 0.664
Validation loss decreased (-0.611831 --> -0.664465).  Saving model ...
Epoch: 5 cost time: 0.8963456153869629
Epoch: 5, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.697 Vali Acc: 0.730 Test Loss: 0.697 Test Acc: 0.730
Validation loss decreased (-0.664465 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 0.9172463417053223
Epoch: 6, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 7 cost time: 0.8660764694213867
Epoch: 7, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 0.8433036804199219
Epoch: 8, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9845561981201172
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 0.8791327476501465
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8957810401916504
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 0.9349105358123779
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.951073169708252
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.635 Vali Acc: 0.796 Test Loss: 0.635 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9564342498779297
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.657 Vali Acc: 0.789 Test Loss: 0.657 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9985401630401611
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9548263549804688
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9899232387542725
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9144737720489502
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.693 Vali Acc: 0.796 Test Loss: 0.693 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9729752540588379
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.708 Vali Acc: 0.796 Test Loss: 0.708 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9214498996734619
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.714 Vali Acc: 0.796 Test Loss: 0.714 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8445839881896973
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.727 Vali Acc: 0.796 Test Loss: 0.727 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 348292
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.533050060272217
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.331 Vali Acc: 0.414 Test Loss: 1.331 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 0.9382123947143555
Epoch: 2, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.194 Vali Acc: 0.605 Test Loss: 1.194 Test Acc: 0.605
Validation loss decreased (-0.414460 --> -0.605251).  Saving model ...
Epoch: 3 cost time: 0.957766056060791
Epoch: 3, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.010 Vali Acc: 0.671 Test Loss: 1.010 Test Acc: 0.671
Validation loss decreased (-0.605251 --> -0.671043).  Saving model ...
Epoch: 4 cost time: 0.9074184894561768
Epoch: 4, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.822 Vali Acc: 0.711 Test Loss: 0.822 Test Acc: 0.711
Validation loss decreased (-0.671043 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 0.9562664031982422
Epoch: 5, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.682 Vali Acc: 0.737 Test Loss: 0.682 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 0.9115936756134033
Epoch: 6, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 0.9850695133209229
Epoch: 7, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 8 cost time: 0.9249372482299805
Epoch: 8, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 9 cost time: 0.8785519599914551
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 0.8926496505737305
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9617965221405029
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9539566040039062
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.592 Vali Acc: 0.816 Test Loss: 0.592 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 0.9422736167907715
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9211728572845459
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9165141582489014
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.816 Test Loss: 0.642 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9815731048583984
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.816 Test Loss: 0.654 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9593183994293213
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.803 Test Loss: 0.670 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9500494003295898
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8757684230804443
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.816 Test Loss: 0.684 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9016602039337158
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.697 Vali Acc: 0.816 Test Loss: 0.697 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9256644248962402
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.803 Test Loss: 0.709 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8884174823760986
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 348356
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5093538761138916
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.363 Vali Acc: 0.316 Test Loss: 1.363 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.9668262004852295
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.273 Vali Acc: 0.467 Test Loss: 1.273 Test Acc: 0.467
Validation loss decreased (-0.315776 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 0.8489034175872803
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.157 Vali Acc: 0.559 Test Loss: 1.157 Test Acc: 0.559
Validation loss decreased (-0.467093 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 0.9521465301513672
Epoch: 4, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.029 Vali Acc: 0.651 Test Loss: 1.029 Test Acc: 0.651
Validation loss decreased (-0.559199 --> -0.651306).  Saving model ...
Epoch: 5 cost time: 0.9336757659912109
Epoch: 5, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.898 Vali Acc: 0.678 Test Loss: 0.898 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677623).  Saving model ...
Epoch: 6 cost time: 0.7946248054504395
Epoch: 6, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.782 Vali Acc: 0.717 Test Loss: 0.782 Test Acc: 0.717
Validation loss decreased (-0.677623 --> -0.717097).  Saving model ...
Epoch: 7 cost time: 0.857579231262207
Epoch: 7, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 0.8418214321136475
Epoch: 8, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 0.8546433448791504
Epoch: 9, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 0.9803447723388672
Epoch: 10, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 0.9665508270263672
Epoch: 11, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0343542098999023
Epoch: 12, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.02848482131958
Epoch: 13, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.0421838760375977
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0126395225524902
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0258944034576416
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.057692527770996
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.031266689300537
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.1000051498413086
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 20 cost time: 0.9575846195220947
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 0.9772830009460449
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9091885089874268
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0111024379730225
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9712569713592529
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9235751628875732
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.654 Vali Acc: 0.803 Test Loss: 0.654 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9671337604522705
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0072522163391113
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.682 Vali Acc: 0.796 Test Loss: 0.682 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0688531398773193
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9890263080596924
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8843765258789062
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 326916
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.496199607849121
Epoch: 1, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.322 Vali Acc: 0.421 Test Loss: 1.322 Test Acc: 0.421
Validation loss decreased (inf --> -0.421039).  Saving model ...
Epoch: 2 cost time: 0.8703832626342773
Epoch: 2, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.248 Vali Acc: 0.487 Test Loss: 1.248 Test Acc: 0.487
Validation loss decreased (-0.421039 --> -0.486830).  Saving model ...
Epoch: 3 cost time: 0.9293711185455322
Epoch: 3, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.147 Vali Acc: 0.572 Test Loss: 1.147 Test Acc: 0.572
Validation loss decreased (-0.486830 --> -0.572357).  Saving model ...
Epoch: 4 cost time: 0.8824050426483154
Epoch: 4, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.037 Vali Acc: 0.605 Test Loss: 1.037 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 0.8821697235107422
Epoch: 5, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.925 Vali Acc: 0.671 Test Loss: 0.925 Test Acc: 0.671
Validation loss decreased (-0.605253 --> -0.671043).  Saving model ...
Epoch: 6 cost time: 0.8985884189605713
Epoch: 6, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.828 Vali Acc: 0.691 Test Loss: 0.828 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690781).  Saving model ...
Epoch: 7 cost time: 0.9207675457000732
Epoch: 7, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.733 Vali Acc: 0.724 Test Loss: 0.733 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 0.8959996700286865
Epoch: 8, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.9792091846466064
Epoch: 9, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 0.9176797866821289
Epoch: 10, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 0.910773515701294
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9960622787475586
Epoch: 12, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.896183967590332
Epoch: 13, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.516 Vali Acc: 0.789 Test Loss: 0.516 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 14 cost time: 0.9434728622436523
Epoch: 14, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8831219673156738
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 0.9655120372772217
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 0.8410167694091797
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.530 Vali Acc: 0.816 Test Loss: 0.530 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 18 cost time: 0.8718461990356445
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.539 Vali Acc: 0.816 Test Loss: 0.539 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8370885848999023
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8960363864898682
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.557 Vali Acc: 0.809 Test Loss: 0.557 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9340932369232178
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9905579090118408
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9164483547210693
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.578 Vali Acc: 0.816 Test Loss: 0.578 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9402790069580078
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.584 Vali Acc: 0.816 Test Loss: 0.584 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9526057243347168
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.816 Test Loss: 0.599 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8804104328155518
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9094271659851074
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.612 Vali Acc: 0.816 Test Loss: 0.612 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 317828
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.435819149017334
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.394 Vali Acc: 0.342 Test Loss: 1.394 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 0.792320966720581
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.336 Vali Acc: 0.395 Test Loss: 1.336 Test Acc: 0.395
Validation loss decreased (-0.342091 --> -0.394723).  Saving model ...
Epoch: 3 cost time: 0.8890798091888428
Epoch: 3, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.250 Vali Acc: 0.520 Test Loss: 1.250 Test Acc: 0.520
Validation loss decreased (-0.394723 --> -0.519724).  Saving model ...
Epoch: 4 cost time: 0.8820638656616211
Epoch: 4, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.142 Vali Acc: 0.618 Test Loss: 1.142 Test Acc: 0.618
Validation loss decreased (-0.519724 --> -0.618410).  Saving model ...
Epoch: 5 cost time: 0.907599687576294
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.036 Vali Acc: 0.638 Test Loss: 1.036 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 0.9462294578552246
Epoch: 6, Steps: 10 | Train Loss: 0.791 Vali Loss: 0.922 Vali Acc: 0.711 Test Loss: 0.922 Test Acc: 0.711
Validation loss decreased (-0.638148 --> -0.710517).  Saving model ...
Epoch: 7 cost time: 0.9943530559539795
Epoch: 7, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.814 Vali Acc: 0.697 Test Loss: 0.814 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9350461959838867
Epoch: 8, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 0.9605293273925781
Epoch: 9, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.649 Vali Acc: 0.763 Test Loss: 0.649 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 0.9789764881134033
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 0.9879765510559082
Epoch: 11, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 0.998521089553833
Epoch: 12, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.0338702201843262
Epoch: 13, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 14 cost time: 0.9970543384552002
Epoch: 14, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 15 cost time: 1.0883362293243408
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 16 cost time: 0.9309422969818115
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.513 Vali Acc: 0.776 Test Loss: 0.513 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1222543716430664
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 0.9363627433776855
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0490236282348633
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9791469573974609
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0348515510559082
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8712868690490723
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.0479772090911865
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9890549182891846
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0688481330871582
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0680651664733887
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.194718837738037
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.113220453262329
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0682954788208008
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1086387634277344
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.862637996673584
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0376293659210205
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 317892
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7687761783599854
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.371 Vali Acc: 0.276 Test Loss: 1.371 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 0.8894655704498291
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.318 Vali Acc: 0.375 Test Loss: 1.318 Test Acc: 0.375
Validation loss decreased (-0.276302 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.0142791271209717
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.241 Vali Acc: 0.487 Test Loss: 1.241 Test Acc: 0.487
Validation loss decreased (-0.374987 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 0.947073221206665
Epoch: 4, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.154 Vali Acc: 0.605 Test Loss: 1.154 Test Acc: 0.605
Validation loss decreased (-0.486830 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 0.9826622009277344
Epoch: 5, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.058 Vali Acc: 0.678 Test Loss: 1.058 Test Acc: 0.678
Validation loss decreased (-0.605252 --> -0.677621).  Saving model ...
Epoch: 6 cost time: 0.9489109516143799
Epoch: 6, Steps: 10 | Train Loss: 0.860 Vali Loss: 0.962 Vali Acc: 0.697 Test Loss: 0.962 Test Acc: 0.697
Validation loss decreased (-0.677621 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 0.8643069267272949
Epoch: 7, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.865 Vali Acc: 0.697 Test Loss: 0.865 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 0.9361691474914551
Epoch: 8, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.781 Vali Acc: 0.724 Test Loss: 0.781 Test Acc: 0.724
Validation loss decreased (-0.697360 --> -0.723676).  Saving model ...
Epoch: 9 cost time: 0.9495220184326172
Epoch: 9, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.703 Vali Acc: 0.763 Test Loss: 0.703 Test Acc: 0.763
Validation loss decreased (-0.723676 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 0.9422564506530762
Epoch: 10, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.642 Vali Acc: 0.776 Test Loss: 0.642 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 11 cost time: 0.9387462139129639
Epoch: 11, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 0.8931989669799805
Epoch: 12, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8879749774932861
Epoch: 13, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9205482006072998
Epoch: 14, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 0.8423953056335449
Epoch: 15, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.520 Vali Acc: 0.783 Test Loss: 0.520 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 16 cost time: 0.7909162044525146
Epoch: 16, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.517 Vali Acc: 0.776 Test Loss: 0.517 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9388277530670166
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 18 cost time: 0.9676039218902588
Epoch: 18, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9627645015716553
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9392595291137695
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0297017097473145
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 0.9662013053894043
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9188151359558105
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.918086051940918
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8612430095672607
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9383511543273926
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9004364013671875
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8712337017059326
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9278395175933838
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9174454212188721
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.630 Vali Acc: 0.796 Test Loss: 0.630 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 31 cost time: 0.9819064140319824
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9414992332458496
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9500997066497803
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9646584987640381
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9262785911560059
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.663 Vali Acc: 0.796 Test Loss: 0.663 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9610648155212402
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 37 cost time: 0.970327615737915
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.686 Vali Acc: 0.803 Test Loss: 0.686 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9794425964355469
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.006795883178711
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.872290849685669
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9704992771148682
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8626675605773926
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8603131771087646
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9046554565429688
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.746 Vali Acc: 0.803 Test Loss: 0.746 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8640353679656982
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.749 Vali Acc: 0.803 Test Loss: 0.749 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0144281387329102
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.754 Vali Acc: 0.803 Test Loss: 0.754 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 314948
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2947263717651367
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.389 Vali Acc: 0.230 Test Loss: 1.389 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 0.8004007339477539
Epoch: 2, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.320 Vali Acc: 0.401 Test Loss: 1.320 Test Acc: 0.401
Validation loss decreased (-0.230249 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 0.8163847923278809
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.224 Vali Acc: 0.539 Test Loss: 1.224 Test Acc: 0.539
Validation loss decreased (-0.401303 --> -0.539461).  Saving model ...
Epoch: 4 cost time: 0.7464382648468018
Epoch: 4, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.099 Vali Acc: 0.599 Test Loss: 1.099 Test Acc: 0.599
Validation loss decreased (-0.539461 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 0.7665348052978516
Epoch: 5, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.959 Vali Acc: 0.645 Test Loss: 0.959 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644727).  Saving model ...
Epoch: 6 cost time: 0.7430717945098877
Epoch: 6, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.829 Vali Acc: 0.671 Test Loss: 0.829 Test Acc: 0.671
Validation loss decreased (-0.644727 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 0.7597873210906982
Epoch: 7, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.713 Vali Acc: 0.724 Test Loss: 0.713 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 0.7621114253997803
Epoch: 8, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 0.7387378215789795
Epoch: 9, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.580 Vali Acc: 0.763 Test Loss: 0.580 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 0.7585811614990234
Epoch: 10, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 0.731069803237915
Epoch: 11, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 0.8319485187530518
Epoch: 12, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 13 cost time: 0.8836765289306641
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.538 Vali Acc: 0.783 Test Loss: 0.538 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 0.8398454189300537
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8815209865570068
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8547775745391846
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8576686382293701
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8647658824920654
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 0.9017572402954102
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8495786190032959
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8003771305084229
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8321516513824463
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.615 Vali Acc: 0.789 Test Loss: 0.615 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.755089521408081
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.625 Vali Acc: 0.796 Test Loss: 0.625 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8057370185852051
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.830146074295044
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8530056476593018
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.661 Vali Acc: 0.783 Test Loss: 0.661 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8035814762115479
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8725419044494629
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.670 Vali Acc: 0.783 Test Loss: 0.670 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 108612
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3574485778808594
Epoch: 1, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.338 Vali Acc: 0.368 Test Loss: 1.338 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 0.7863686084747314
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.265 Vali Acc: 0.526 Test Loss: 1.265 Test Acc: 0.526
Validation loss decreased (-0.368408 --> -0.526303).  Saving model ...
Epoch: 3 cost time: 0.8283994197845459
Epoch: 3, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.164 Vali Acc: 0.697 Test Loss: 1.164 Test Acc: 0.697
Validation loss decreased (-0.526303 --> -0.697357).  Saving model ...
Epoch: 4 cost time: 0.7397234439849854
Epoch: 4, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.048 Vali Acc: 0.704 Test Loss: 1.048 Test Acc: 0.704
Validation loss decreased (-0.697357 --> -0.703937).  Saving model ...
Epoch: 5 cost time: 0.8311095237731934
Epoch: 5, Steps: 10 | Train Loss: 0.858 Vali Loss: 0.917 Vali Acc: 0.743 Test Loss: 0.917 Test Acc: 0.743
Validation loss decreased (-0.703937 --> -0.743412).  Saving model ...
Epoch: 6 cost time: 0.800823450088501
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.800 Vali Acc: 0.730 Test Loss: 0.800 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8141369819641113
Epoch: 7, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.699 Vali Acc: 0.743 Test Loss: 0.699 Test Acc: 0.743
Validation loss decreased (-0.743412 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 0.7799701690673828
Epoch: 8, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 0.7767484188079834
Epoch: 9, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 0.8430612087249756
Epoch: 10, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 0.8400154113769531
Epoch: 11, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 12 cost time: 0.8619754314422607
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 0.8150124549865723
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 0.9224886894226074
Epoch: 14, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7564773559570312
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.540 Vali Acc: 0.803 Test Loss: 0.540 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 0.7873077392578125
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 17 cost time: 0.8508257865905762
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7494192123413086
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8299267292022705
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7943274974822998
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.811100959777832
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8690040111541748
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8543646335601807
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.781806230545044
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8097453117370605
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7907040119171143
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.647 Vali Acc: 0.816 Test Loss: 0.647 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 108644
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4416613578796387
Epoch: 1, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.339 Vali Acc: 0.414 Test Loss: 1.339 Test Acc: 0.414
Validation loss decreased (inf --> -0.414460).  Saving model ...
Epoch: 2 cost time: 0.8513476848602295
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.297 Vali Acc: 0.447 Test Loss: 1.297 Test Acc: 0.447
Validation loss decreased (-0.414460 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 0.8134243488311768
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.447355 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.8446497917175293
Epoch: 4, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.177 Vali Acc: 0.559 Test Loss: 1.177 Test Acc: 0.559
Validation loss decreased (-0.499988 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 0.7456047534942627
Epoch: 5, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.559199 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 0.8969190120697021
Epoch: 6, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.023 Vali Acc: 0.645 Test Loss: 1.023 Test Acc: 0.645
Validation loss decreased (-0.624989 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 0.7286639213562012
Epoch: 7, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.942 Vali Acc: 0.645 Test Loss: 0.942 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 0.7690303325653076
Epoch: 8, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.857 Vali Acc: 0.711 Test Loss: 0.857 Test Acc: 0.711
Validation loss decreased (-0.644727 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 0.814180850982666
Epoch: 9, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.775 Vali Acc: 0.737 Test Loss: 0.775 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736834).  Saving model ...
Epoch: 10 cost time: 0.7514491081237793
Epoch: 10, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.706 Vali Acc: 0.730 Test Loss: 0.706 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7905020713806152
Epoch: 11, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.658 Vali Acc: 0.743 Test Loss: 0.658 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 0.8427722454071045
Epoch: 12, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.9479837417602539
Epoch: 13, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 0.8455023765563965
Epoch: 14, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 0.9191572666168213
Epoch: 15, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9258213043212891
Epoch: 16, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.519 Vali Acc: 0.750 Test Loss: 0.519 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8635053634643555
Epoch: 17, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.514 Vali Acc: 0.757 Test Loss: 0.514 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8895304203033447
Epoch: 18, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.512 Vali Acc: 0.770 Test Loss: 0.512 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8589949607849121
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.505 Vali Acc: 0.770 Test Loss: 0.505 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8331778049468994
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.504 Vali Acc: 0.770 Test Loss: 0.504 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8873677253723145
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.503 Vali Acc: 0.770 Test Loss: 0.503 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7934222221374512
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8657217025756836
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 24 cost time: 0.7312066555023193
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 0.8337781429290771
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8341860771179199
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.770256757736206
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8511068820953369
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8944118022918701
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8294906616210938
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 0.9266602993011475
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9050111770629883
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8363385200500488
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9073336124420166
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9134478569030762
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8630123138427734
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9373636245727539
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8084547519683838
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8475923538208008
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 40 cost time: 0.8424665927886963
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7885756492614746
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8569891452789307
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8112819194793701
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7955770492553711
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.860637903213501
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8676919937133789
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8099732398986816
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7808740139007568
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7762072086334229
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.662 Vali Acc: 0.796 Test Loss: 0.662 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 97924
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.369448184967041
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.409 Vali Acc: 0.191 Test Loss: 1.409 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 0.7849142551422119
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.380 Vali Acc: 0.237 Test Loss: 1.380 Test Acc: 0.237
Validation loss decreased (-0.190775 --> -0.236828).  Saving model ...
Epoch: 3 cost time: 0.8257038593292236
Epoch: 3, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.330 Vali Acc: 0.355 Test Loss: 1.330 Test Acc: 0.355
Validation loss decreased (-0.236828 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 0.7772152423858643
Epoch: 4, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
Validation loss decreased (-0.355250 --> -0.480250).  Saving model ...
Epoch: 5 cost time: 0.808870792388916
Epoch: 5, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.205 Vali Acc: 0.539 Test Loss: 1.205 Test Acc: 0.539
Validation loss decreased (-0.480250 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 0.7904510498046875
Epoch: 6, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.136 Vali Acc: 0.572 Test Loss: 1.136 Test Acc: 0.572
Validation loss decreased (-0.539462 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 0.8454101085662842
Epoch: 7, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.064 Vali Acc: 0.625 Test Loss: 1.064 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.7966737747192383
Epoch: 8, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.986 Vali Acc: 0.664 Test Loss: 0.986 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664464).  Saving model ...
Epoch: 9 cost time: 0.8089296817779541
Epoch: 9, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.907 Vali Acc: 0.691 Test Loss: 0.907 Test Acc: 0.691
Validation loss decreased (-0.664464 --> -0.690780).  Saving model ...
Epoch: 10 cost time: 0.8876640796661377
Epoch: 10, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.834 Vali Acc: 0.704 Test Loss: 0.834 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 11 cost time: 0.7857580184936523
Epoch: 11, Steps: 10 | Train Loss: 0.568 Vali Loss: 0.770 Vali Acc: 0.737 Test Loss: 0.770 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736834).  Saving model ...
Epoch: 12 cost time: 0.7757401466369629
Epoch: 12, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.711 Vali Acc: 0.737 Test Loss: 0.711 Test Acc: 0.737
Validation loss decreased (-0.736834 --> -0.736835).  Saving model ...
Epoch: 13 cost time: 0.7539355754852295
Epoch: 13, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.665 Vali Acc: 0.724 Test Loss: 0.665 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8196353912353516
Epoch: 14, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.625 Vali Acc: 0.757 Test Loss: 0.625 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 0.834653377532959
Epoch: 15, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7783312797546387
Epoch: 16, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.573 Vali Acc: 0.757 Test Loss: 0.573 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 0.9060707092285156
Epoch: 17, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 18 cost time: 0.8475081920623779
Epoch: 18, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.544 Vali Acc: 0.750 Test Loss: 0.544 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8211827278137207
Epoch: 19, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769732).  Saving model ...
Epoch: 20 cost time: 0.8451917171478271
Epoch: 20, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 0.8392343521118164
Epoch: 21, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.530 Vali Acc: 0.770 Test Loss: 0.530 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8203451633453369
Epoch: 22, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 23 cost time: 0.8481431007385254
Epoch: 23, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 24 cost time: 0.8303267955780029
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 0.778461217880249
Epoch: 25, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7635538578033447
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7418086528778076
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.825563907623291
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7391860485076904
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7684361934661865
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7534894943237305
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7942452430725098
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8338773250579834
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7959926128387451
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 93380
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5372302532196045
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.388 Vali Acc: 0.243 Test Loss: 1.388 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.7866213321685791
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.353 Vali Acc: 0.349 Test Loss: 1.353 Test Acc: 0.349
Validation loss decreased (-0.243407 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.8696091175079346
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.305 Vali Acc: 0.441 Test Loss: 1.305 Test Acc: 0.441
Validation loss decreased (-0.348671 --> -0.440776).  Saving model ...
Epoch: 4 cost time: 0.7470381259918213
Epoch: 4, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.247 Vali Acc: 0.533 Test Loss: 1.247 Test Acc: 0.533
Validation loss decreased (-0.440776 --> -0.532882).  Saving model ...
Epoch: 5 cost time: 0.8345909118652344
Epoch: 5, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.182 Vali Acc: 0.618 Test Loss: 1.182 Test Acc: 0.618
Validation loss decreased (-0.532882 --> -0.618409).  Saving model ...
Epoch: 6 cost time: 0.7560901641845703
Epoch: 6, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.113 Vali Acc: 0.658 Test Loss: 1.113 Test Acc: 0.658
Validation loss decreased (-0.618409 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 0.7550926208496094
Epoch: 7, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.042 Vali Acc: 0.684 Test Loss: 1.042 Test Acc: 0.684
Validation loss decreased (-0.657884 --> -0.684200).  Saving model ...
Epoch: 8 cost time: 0.782250165939331
Epoch: 8, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.963 Vali Acc: 0.711 Test Loss: 0.963 Test Acc: 0.711
Validation loss decreased (-0.684200 --> -0.710517).  Saving model ...
Epoch: 9 cost time: 0.8009800910949707
Epoch: 9, Steps: 10 | Train Loss: 0.761 Vali Loss: 0.892 Vali Acc: 0.737 Test Loss: 0.892 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736833).  Saving model ...
Epoch: 10 cost time: 0.820570707321167
Epoch: 10, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.818 Vali Acc: 0.737 Test Loss: 0.818 Test Acc: 0.737
Validation loss decreased (-0.736833 --> -0.736834).  Saving model ...
Epoch: 11 cost time: 0.8715119361877441
Epoch: 11, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.754 Vali Acc: 0.750 Test Loss: 0.754 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.8459961414337158
Epoch: 12, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.698 Vali Acc: 0.757 Test Loss: 0.698 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 0.8003592491149902
Epoch: 13, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 14 cost time: 0.8834390640258789
Epoch: 14, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.615 Vali Acc: 0.770 Test Loss: 0.615 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 0.7681372165679932
Epoch: 15, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.581 Vali Acc: 0.770 Test Loss: 0.581 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 0.8237628936767578
Epoch: 16, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 0.7922358512878418
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 0.8020045757293701
Epoch: 18, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7788534164428711
Epoch: 19, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 0.7698094844818115
Epoch: 20, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 21 cost time: 0.8421428203582764
Epoch: 21, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 0.7578110694885254
Epoch: 22, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.508 Vali Acc: 0.796 Test Loss: 0.508 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 0.8151075839996338
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8347985744476318
Epoch: 24, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 25 cost time: 0.7619967460632324
Epoch: 25, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8181042671203613
Epoch: 26, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8353517055511475
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.861480712890625
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.526 Vali Acc: 0.803 Test Loss: 0.526 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.82826828956604
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8786041736602783
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.537 Vali Acc: 0.803 Test Loss: 0.537 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8662700653076172
Epoch: 31, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8636889457702637
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8398330211639404
Epoch: 33, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 34 cost time: 0.7515268325805664
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7817320823669434
Epoch: 35, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8517112731933594
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.563 Vali Acc: 0.803 Test Loss: 0.563 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7700262069702148
Epoch: 37, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8036394119262695
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.578 Vali Acc: 0.803 Test Loss: 0.578 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7876949310302734
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8045196533203125
Epoch: 40, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.592 Vali Acc: 0.809 Test Loss: 0.592 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.800910234451294
Epoch: 41, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7682740688323975
Epoch: 42, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8239643573760986
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 93412
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5894618034362793
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.400 Vali Acc: 0.283 Test Loss: 1.400 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.8439126014709473
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.378 Vali Acc: 0.336 Test Loss: 1.378 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 0.834954023361206
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.339 Vali Acc: 0.355 Test Loss: 1.339 Test Acc: 0.355
Validation loss decreased (-0.335513 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 0.8362243175506592
Epoch: 4, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.288 Vali Acc: 0.441 Test Loss: 1.288 Test Acc: 0.441
Validation loss decreased (-0.355250 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 0.8321187496185303
Epoch: 5, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.233 Vali Acc: 0.513 Test Loss: 1.233 Test Acc: 0.513
Validation loss decreased (-0.440777 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 0.8840970993041992
Epoch: 6, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.177 Vali Acc: 0.572 Test Loss: 1.177 Test Acc: 0.572
Validation loss decreased (-0.513146 --> -0.572357).  Saving model ...
Epoch: 7 cost time: 0.8057389259338379
Epoch: 7, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.110 Vali Acc: 0.645 Test Loss: 1.110 Test Acc: 0.645
Validation loss decreased (-0.572357 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 0.8005857467651367
Epoch: 8, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.047 Vali Acc: 0.671 Test Loss: 1.047 Test Acc: 0.671
Validation loss decreased (-0.644726 --> -0.671042).  Saving model ...
Epoch: 9 cost time: 0.7706558704376221
Epoch: 9, Steps: 10 | Train Loss: 0.869 Vali Loss: 0.972 Vali Acc: 0.671 Test Loss: 0.972 Test Acc: 0.671
Validation loss decreased (-0.671042 --> -0.671043).  Saving model ...
Epoch: 10 cost time: 0.771836519241333
Epoch: 10, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.906 Vali Acc: 0.691 Test Loss: 0.906 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690780).  Saving model ...
Epoch: 11 cost time: 0.8448262214660645
Epoch: 11, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.836 Vali Acc: 0.743 Test Loss: 0.836 Test Acc: 0.743
Validation loss decreased (-0.690780 --> -0.743413).  Saving model ...
Epoch: 12 cost time: 0.8312559127807617
Epoch: 12, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.8466660976409912
Epoch: 13, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
Validation loss decreased (-0.749992 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 0.7748997211456299
Epoch: 14, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.663 Vali Acc: 0.783 Test Loss: 0.663 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 15 cost time: 0.9321436882019043
Epoch: 15, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 0.7574656009674072
Epoch: 16, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815784).  Saving model ...
Epoch: 17 cost time: 0.8495907783508301
Epoch: 17, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8850150108337402
Epoch: 18, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8337814807891846
Epoch: 19, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8602099418640137
Epoch: 20, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7838940620422363
Epoch: 21, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.484 Vali Acc: 0.803 Test Loss: 0.484 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8336586952209473
Epoch: 22, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.88041090965271
Epoch: 23, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.476 Vali Acc: 0.796 Test Loss: 0.476 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7761156558990479
Epoch: 24, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.471 Vali Acc: 0.796 Test Loss: 0.471 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7818760871887207
Epoch: 25, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.852215051651001
Epoch: 26, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 91940
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8836405277252197
Epoch: 1, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (inf --> -0.499988).  Saving model ...
Epoch: 2 cost time: 1.0842466354370117
Epoch: 2, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.692 Vali Acc: 0.730 Test Loss: 0.692 Test Acc: 0.730
Validation loss decreased (-0.499988 --> -0.730256).  Saving model ...
Epoch: 3 cost time: 1.0713214874267578
Epoch: 3, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 4 cost time: 0.8744394779205322
Epoch: 4, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782888).  Saving model ...
Epoch: 5 cost time: 1.0881726741790771
Epoch: 5, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0166606903076172
Epoch: 6, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.666 Vali Acc: 0.783 Test Loss: 0.666 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.031902551651001
Epoch: 7, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0020644664764404
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 9 cost time: 1.0699419975280762
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809203).  Saving model ...
Epoch: 10 cost time: 1.0147106647491455
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.783 Test Loss: 0.773 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1235320568084717
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1415796279907227
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1335840225219727
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.789 Test Loss: 0.809 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0707457065582275
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.796 Test Loss: 0.811 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9949345588684082
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.789 Test Loss: 0.819 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.201291799545288
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.789 Test Loss: 0.825 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1355369091033936
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.796 Test Loss: 0.831 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1146652698516846
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.789 Test Loss: 0.836 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0441291332244873
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.789 Test Loss: 0.846 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1030660
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.755422830581665
Epoch: 1, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.107 Vali Acc: 0.599 Test Loss: 1.107 Test Acc: 0.599
Validation loss decreased (inf --> -0.598673).  Saving model ...
Epoch: 2 cost time: 1.1256616115570068
Epoch: 2, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.679 Vali Acc: 0.711 Test Loss: 0.679 Test Acc: 0.711
Validation loss decreased (-0.598673 --> -0.710520).  Saving model ...
Epoch: 3 cost time: 1.1051239967346191
Epoch: 3, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.710520 --> -0.776310).  Saving model ...
Epoch: 4 cost time: 1.12337064743042
Epoch: 4, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0563204288482666
Epoch: 5, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.662 Vali Acc: 0.770 Test Loss: 0.662 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1053857803344727
Epoch: 6, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.681 Vali Acc: 0.770 Test Loss: 0.681 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.062814712524414
Epoch: 7, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.770 Test Loss: 0.716 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0127999782562256
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.074477195739746
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.743 Vali Acc: 0.776 Test Loss: 0.743 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1058106422424316
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.763 Test Loss: 0.760 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0834226608276367
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.776 Test Loss: 0.790 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0739736557006836
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.776 Test Loss: 0.802 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0311145782470703
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.806 Vali Acc: 0.763 Test Loss: 0.806 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 1030916
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6571526527404785
Epoch: 1, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.211 Vali Acc: 0.533 Test Loss: 1.211 Test Acc: 0.533
Validation loss decreased (inf --> -0.532883).  Saving model ...
Epoch: 2 cost time: 0.7993648052215576
Epoch: 2, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.850 Vali Acc: 0.651 Test Loss: 0.850 Test Acc: 0.651
Validation loss decreased (-0.532883 --> -0.651307).  Saving model ...
Epoch: 3 cost time: 0.8401656150817871
Epoch: 3, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.656 Vali Acc: 0.724 Test Loss: 0.656 Test Acc: 0.724
Validation loss decreased (-0.651307 --> -0.723678).  Saving model ...
Epoch: 4 cost time: 0.7808775901794434
Epoch: 4, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 0.8307125568389893
Epoch: 5, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763153).  Saving model ...
Epoch: 6 cost time: 0.7929534912109375
Epoch: 6, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.548 Vali Acc: 0.776 Test Loss: 0.548 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 0.8516330718994141
Epoch: 7, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8704895973205566
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.614 Vali Acc: 0.770 Test Loss: 0.614 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8887505531311035
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9270825386047363
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9356241226196289
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9621608257293701
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.678 Vali Acc: 0.763 Test Loss: 0.678 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9286191463470459
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.679 Vali Acc: 0.770 Test Loss: 0.679 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9621989727020264
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.930316686630249
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.776 Test Loss: 0.700 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.944329023361206
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.770 Test Loss: 0.702 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 939012
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.3277108669281006
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.316 Vali Acc: 0.362 Test Loss: 1.316 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 0.964923620223999
Epoch: 2, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.044 Vali Acc: 0.566 Test Loss: 1.044 Test Acc: 0.566
Validation loss decreased (-0.361829 --> -0.565779).  Saving model ...
Epoch: 3 cost time: 0.9210247993469238
Epoch: 3, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.783 Vali Acc: 0.697 Test Loss: 0.783 Test Acc: 0.697
Validation loss decreased (-0.565779 --> -0.697361).  Saving model ...
Epoch: 4 cost time: 0.9168446063995361
Epoch: 4, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
Validation loss decreased (-0.697361 --> -0.763151).  Saving model ...
Epoch: 5 cost time: 0.836906909942627
Epoch: 5, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789468).  Saving model ...
Epoch: 6 cost time: 0.9154374599456787
Epoch: 6, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8662464618682861
Epoch: 7, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8903939723968506
Epoch: 8, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 0.864260196685791
Epoch: 9, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9126436710357666
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.988337516784668
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9653534889221191
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9751901626586914
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.634 Vali Acc: 0.789 Test Loss: 0.634 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.976210355758667
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8828222751617432
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9010255336761475
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8969259262084961
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8756780624389648
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.796 Test Loss: 0.685 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 19 cost time: 0.9846711158752441
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 20 cost time: 0.9818222522735596
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.796 Test Loss: 0.698 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9285986423492432
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9547507762908936
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.711 Vali Acc: 0.789 Test Loss: 0.711 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9573550224304199
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.716 Vali Acc: 0.796 Test Loss: 0.716 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8805787563323975
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9097020626068115
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9065616130828857
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.906954288482666
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.796 Test Loss: 0.739 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9612627029418945
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.752 Vali Acc: 0.803 Test Loss: 0.752 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9840388298034668
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.803 Test Loss: 0.753 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 908804
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.466735363006592
Epoch: 1, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.280 Vali Acc: 0.447 Test Loss: 1.280 Test Acc: 0.447
Validation loss decreased (inf --> -0.447356).  Saving model ...
Epoch: 2 cost time: 0.843712568283081
Epoch: 2, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.021 Vali Acc: 0.605 Test Loss: 1.021 Test Acc: 0.605
Validation loss decreased (-0.447356 --> -0.605253).  Saving model ...
Epoch: 3 cost time: 0.9191038608551025
Epoch: 3, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.760 Vali Acc: 0.717 Test Loss: 0.760 Test Acc: 0.717
Validation loss decreased (-0.605253 --> -0.717098).  Saving model ...
Epoch: 4 cost time: 0.9244740009307861
Epoch: 4, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749994).  Saving model ...
Epoch: 5 cost time: 0.8388826847076416
Epoch: 5, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.574 Vali Acc: 0.743 Test Loss: 0.574 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8733804225921631
Epoch: 6, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 0.8922967910766602
Epoch: 7, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 0.7846612930297852
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 0.8459513187408447
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 0.8097186088562012
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.808612585067749
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.617 Vali Acc: 0.796 Test Loss: 0.617 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8675439357757568
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8227024078369141
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.630 Vali Acc: 0.803 Test Loss: 0.630 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.859868049621582
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.635 Vali Acc: 0.803 Test Loss: 0.635 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8621525764465332
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 16 cost time: 0.8917653560638428
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8538575172424316
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.803 Test Loss: 0.662 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0209770202636719
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9017667770385742
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8844609260559082
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9026129245758057
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9494636058807373
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.711 Vali Acc: 0.809 Test Loss: 0.711 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9469313621520996
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9729137420654297
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8487529754638672
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 909060
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4727089405059814
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.393 Vali Acc: 0.289 Test Loss: 1.393 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 0.9674391746520996
Epoch: 2, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.289460 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.8942816257476807
Epoch: 3, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.926 Vali Acc: 0.658 Test Loss: 0.926 Test Acc: 0.658
Validation loss decreased (-0.499988 --> -0.657885).  Saving model ...
Epoch: 4 cost time: 0.957883358001709
Epoch: 4, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.752 Vali Acc: 0.730 Test Loss: 0.752 Test Acc: 0.730
Validation loss decreased (-0.657885 --> -0.730256).  Saving model ...
Epoch: 5 cost time: 0.8682773113250732
Epoch: 5, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 0.8826844692230225
Epoch: 6, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.8984770774841309
Epoch: 7, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.607 Vali Acc: 0.743 Test Loss: 0.607 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9084959030151367
Epoch: 8, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 0.9467976093292236
Epoch: 9, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.8532021045684814
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.592 Vali Acc: 0.770 Test Loss: 0.592 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.008500576019287
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.908872127532959
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9505062103271484
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.637 Vali Acc: 0.770 Test Loss: 0.637 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9145462512969971
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.647 Vali Acc: 0.770 Test Loss: 0.647 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9645299911499023
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.654 Vali Acc: 0.757 Test Loss: 0.654 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.046271562576294
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 17 cost time: 1.0044629573822021
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.671 Vali Acc: 0.776 Test Loss: 0.671 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9419732093811035
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 19 cost time: 0.967240571975708
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.763 Test Loss: 0.680 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9040026664733887
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.691 Vali Acc: 0.757 Test Loss: 0.691 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0002243518829346
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.706 Vali Acc: 0.783 Test Loss: 0.706 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9043967723846436
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9730620384216309
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.717 Vali Acc: 0.763 Test Loss: 0.717 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9485712051391602
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.717 Vali Acc: 0.770 Test Loss: 0.717 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9217829704284668
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.725 Vali Acc: 0.776 Test Loss: 0.725 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9349195957183838
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.736 Vali Acc: 0.776 Test Loss: 0.736 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9493567943572998
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.741 Vali Acc: 0.776 Test Loss: 0.741 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9721312522888184
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.747 Vali Acc: 0.776 Test Loss: 0.747 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 891140
model size : 3.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1846835613250732
Epoch: 1, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.291 Vali Acc: 0.441 Test Loss: 1.291 Test Acc: 0.441
Validation loss decreased (inf --> -0.440777).  Saving model ...
Epoch: 2 cost time: 0.8630247116088867
Epoch: 2, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.911 Vali Acc: 0.658 Test Loss: 0.911 Test Acc: 0.658
Validation loss decreased (-0.440777 --> -0.657886).  Saving model ...
Epoch: 3 cost time: 0.8487768173217773
Epoch: 3, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.677 Vali Acc: 0.737 Test Loss: 0.677 Test Acc: 0.737
Validation loss decreased (-0.657886 --> -0.736835).  Saving model ...
Epoch: 4 cost time: 0.8583264350891113
Epoch: 4, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 5 cost time: 0.8629066944122314
Epoch: 5, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.509 Vali Acc: 0.763 Test Loss: 0.509 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763153).  Saving model ...
Epoch: 6 cost time: 0.9007105827331543
Epoch: 6, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
Validation loss decreased (-0.763153 --> -0.789469).  Saving model ...
Epoch: 7 cost time: 0.933290958404541
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8745498657226562
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9450387954711914
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.022392749786377
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.655 Vali Acc: 0.776 Test Loss: 0.655 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.932654857635498
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9876120090484619
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.668 Vali Acc: 0.776 Test Loss: 0.668 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7684485912322998
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8921983242034912
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9246602058410645
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.881598949432373
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.776 Test Loss: 0.688 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 318724
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6467576026916504
Epoch: 1, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.181 Vali Acc: 0.566 Test Loss: 1.181 Test Acc: 0.566
Validation loss decreased (inf --> -0.565778).  Saving model ...
Epoch: 2 cost time: 0.9295699596405029
Epoch: 2, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.824 Vali Acc: 0.697 Test Loss: 0.824 Test Acc: 0.697
Validation loss decreased (-0.565778 --> -0.697360).  Saving model ...
Epoch: 3 cost time: 0.9771323204040527
Epoch: 3, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.635 Vali Acc: 0.717 Test Loss: 0.635 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717099).  Saving model ...
Epoch: 4 cost time: 0.9869043827056885
Epoch: 4, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
Validation loss decreased (-0.717099 --> -0.756574).  Saving model ...
Epoch: 5 cost time: 0.9412965774536133
Epoch: 5, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
Validation loss decreased (-0.756574 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.014725685119629
Epoch: 6, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9419350624084473
Epoch: 7, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 0.9047718048095703
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0068142414093018
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8298933506011963
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.636 Vali Acc: 0.770 Test Loss: 0.636 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9441630840301514
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9823167324066162
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.674 Vali Acc: 0.776 Test Loss: 0.674 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.934302806854248
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9698317050933838
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.692 Vali Acc: 0.776 Test Loss: 0.692 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9425020217895508
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.776 Test Loss: 0.698 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8802962303161621
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9715080261230469
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.708 Vali Acc: 0.776 Test Loss: 0.708 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 318852
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4183008670806885
Epoch: 1, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.311 Vali Acc: 0.349 Test Loss: 1.311 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 0.7459688186645508
Epoch: 2, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.067 Vali Acc: 0.599 Test Loss: 1.067 Test Acc: 0.599
Validation loss decreased (-0.348671 --> -0.598674).  Saving model ...
Epoch: 3 cost time: 0.7762043476104736
Epoch: 3, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.854 Vali Acc: 0.638 Test Loss: 0.854 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638149).  Saving model ...
Epoch: 4 cost time: 0.7759671211242676
Epoch: 4, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.695 Vali Acc: 0.704 Test Loss: 0.695 Test Acc: 0.704
Validation loss decreased (-0.638149 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 0.7374820709228516
Epoch: 5, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736836).  Saving model ...
Epoch: 6 cost time: 0.7554998397827148
Epoch: 6, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.7601127624511719
Epoch: 7, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 0.8058314323425293
Epoch: 8, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.544 Vali Acc: 0.757 Test Loss: 0.544 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7816288471221924
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.7759127616882324
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7756912708282471
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8558642864227295
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.795684814453125
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7495460510253906
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.770 Test Loss: 0.593 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7229371070861816
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 0.7792189121246338
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 0.7347981929779053
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7617044448852539
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 19 cost time: 0.7905478477478027
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.857501745223999
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.635 Vali Acc: 0.776 Test Loss: 0.635 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8315103054046631
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7577338218688965
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7792363166809082
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.653 Vali Acc: 0.776 Test Loss: 0.653 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0484046936035156
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8929481506347656
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.897324800491333
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8256566524505615
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8413240909576416
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.686 Vali Acc: 0.783 Test Loss: 0.686 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 272900
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8318326473236084
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.289 Vali Acc: 0.362 Test Loss: 1.289 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 0.9826889038085938
Epoch: 2, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.105 Vali Acc: 0.559 Test Loss: 1.105 Test Acc: 0.559
Validation loss decreased (-0.361829 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 0.9369986057281494
Epoch: 3, Steps: 10 | Train Loss: 0.873 Vali Loss: 0.935 Vali Acc: 0.651 Test Loss: 0.935 Test Acc: 0.651
Validation loss decreased (-0.559199 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 0.9348287582397461
Epoch: 4, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.780 Vali Acc: 0.711 Test Loss: 0.780 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 0.9360699653625488
Epoch: 5, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.672 Vali Acc: 0.750 Test Loss: 0.672 Test Acc: 0.750
Validation loss decreased (-0.710519 --> -0.749993).  Saving model ...
Epoch: 6 cost time: 1.0121750831604004
Epoch: 6, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.614 Vali Acc: 0.750 Test Loss: 0.614 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.8888616561889648
Epoch: 7, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 0.9535322189331055
Epoch: 8, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0041170120239258
Epoch: 9, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.527 Vali Acc: 0.763 Test Loss: 0.527 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.978327751159668
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9116559028625488
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.531 Vali Acc: 0.770 Test Loss: 0.531 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9020345211029053
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.532 Vali Acc: 0.783 Test Loss: 0.532 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 0.9967427253723145
Epoch: 13, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 0.9909040927886963
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0071995258331299
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.062513828277588
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1317307949066162
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0019140243530273
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9858543872833252
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9460170269012451
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9988956451416016
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9870884418487549
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.591 Vali Acc: 0.783 Test Loss: 0.591 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9987199306488037
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 257796
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7235286235809326
Epoch: 1, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.260 Vali Acc: 0.441 Test Loss: 1.260 Test Acc: 0.441
Validation loss decreased (inf --> -0.440777).  Saving model ...
Epoch: 2 cost time: 0.9339346885681152
Epoch: 2, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.091 Vali Acc: 0.612 Test Loss: 1.091 Test Acc: 0.612
Validation loss decreased (-0.440777 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 0.969581127166748
Epoch: 3, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.917 Vali Acc: 0.664 Test Loss: 0.917 Test Acc: 0.664
Validation loss decreased (-0.611831 --> -0.664465).  Saving model ...
Epoch: 4 cost time: 0.8081233501434326
Epoch: 4, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.768 Vali Acc: 0.724 Test Loss: 0.768 Test Acc: 0.724
Validation loss decreased (-0.664465 --> -0.723677).  Saving model ...
Epoch: 5 cost time: 0.8983583450317383
Epoch: 5, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.677 Vali Acc: 0.730 Test Loss: 0.677 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 6 cost time: 0.8698418140411377
Epoch: 6, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.9858906269073486
Epoch: 7, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.9143939018249512
Epoch: 8, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.571 Vali Acc: 0.750 Test Loss: 0.571 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.0084266662597656
Epoch: 9, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.0000464916229248
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 0.9989969730377197
Epoch: 11, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9619371891021729
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9219331741333008
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.877124547958374
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.060204029083252
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0551726818084717
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0976033210754395
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0751588344573975
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.0305781364440918
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.776 Test Loss: 0.617 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0397701263427734
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.621 Vali Acc: 0.776 Test Loss: 0.621 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0772228240966797
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.939741849899292
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 23 cost time: 0.9685728549957275
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8744034767150879
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.649 Vali Acc: 0.776 Test Loss: 0.649 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9709632396697998
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.049372911453247
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7893798351287842
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.677 Vali Acc: 0.776 Test Loss: 0.677 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9124808311462402
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0081124305725098
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.097066879272461
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.688 Vali Acc: 0.776 Test Loss: 0.688 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9644134044647217
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1896908283233643
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 257924
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.765976667404175
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.362 Vali Acc: 0.342 Test Loss: 1.362 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 0.976710319519043
Epoch: 2, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.236 Vali Acc: 0.474 Test Loss: 1.236 Test Acc: 0.474
Validation loss decreased (-0.342092 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 0.9690074920654297
Epoch: 3, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.084 Vali Acc: 0.553 Test Loss: 1.084 Test Acc: 0.553
Validation loss decreased (-0.473672 --> -0.552621).  Saving model ...
Epoch: 4 cost time: 0.8541724681854248
Epoch: 4, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.937 Vali Acc: 0.625 Test Loss: 0.937 Test Acc: 0.625
Validation loss decreased (-0.552621 --> -0.624991).  Saving model ...
Epoch: 5 cost time: 0.8992657661437988
Epoch: 5, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.822 Vali Acc: 0.632 Test Loss: 0.822 Test Acc: 0.632
Validation loss decreased (-0.624991 --> -0.631571).  Saving model ...
Epoch: 6 cost time: 0.8785619735717773
Epoch: 6, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.724 Vali Acc: 0.697 Test Loss: 0.724 Test Acc: 0.697
Validation loss decreased (-0.631571 --> -0.697361).  Saving model ...
Epoch: 7 cost time: 0.8723618984222412
Epoch: 7, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.662 Vali Acc: 0.711 Test Loss: 0.662 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710520).  Saving model ...
Epoch: 8 cost time: 0.8967797756195068
Epoch: 8, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
Validation loss decreased (-0.710520 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 0.9249110221862793
Epoch: 9, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.9593911170959473
Epoch: 10, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 0.9934802055358887
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 0.959618330001831
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 0.8736071586608887
Epoch: 13, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 0.9547042846679688
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0802593231201172
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.011035680770874
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9344732761383057
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9811618328094482
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.020951747894287
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.852470874786377
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.012042760848999
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9022612571716309
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9709534645080566
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 248964
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0052545070648193
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.299 Vali Acc: 0.474 Test Loss: 1.299 Test Acc: 0.474
Validation loss decreased (inf --> -0.473671).  Saving model ...
Epoch: 2 cost time: 1.0712287425994873
Epoch: 2, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.071 Vali Acc: 0.671 Test Loss: 1.071 Test Acc: 0.671
Validation loss decreased (-0.473671 --> -0.671042).  Saving model ...
Epoch: 3 cost time: 1.0048868656158447
Epoch: 3, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.839 Vali Acc: 0.737 Test Loss: 0.839 Test Acc: 0.737
Validation loss decreased (-0.671042 --> -0.736834).  Saving model ...
Epoch: 4 cost time: 1.0334892272949219
Epoch: 4, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.675 Vali Acc: 0.743 Test Loss: 0.675 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 5 cost time: 0.9346787929534912
Epoch: 5, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 0.9962422847747803
Epoch: 6, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 0.9960010051727295
Epoch: 7, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 8 cost time: 0.9344096183776855
Epoch: 8, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9156711101531982
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 0.9222702980041504
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8501496315002441
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.566 Vali Acc: 0.750 Test Loss: 0.566 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9742932319641113
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8819155693054199
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.0859575271606445
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8794031143188477
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.925257682800293
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0574114322662354
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.615 Vali Acc: 0.763 Test Loss: 0.615 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9771735668182373
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9321892261505127
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9540364742279053
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.651 Vali Acc: 0.776 Test Loss: 0.651 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9484751224517822
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0054919719696045
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.653 Vali Acc: 0.776 Test Loss: 0.653 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9949982166290283
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 110212
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5357935428619385
Epoch: 1, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.291 Vali Acc: 0.513 Test Loss: 1.291 Test Acc: 0.513
Validation loss decreased (inf --> -0.513145).  Saving model ...
Epoch: 2 cost time: 0.9334986209869385
Epoch: 2, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.043 Vali Acc: 0.625 Test Loss: 1.043 Test Acc: 0.625
Validation loss decreased (-0.513145 --> -0.624990).  Saving model ...
Epoch: 3 cost time: 0.9043464660644531
Epoch: 3, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.820 Vali Acc: 0.678 Test Loss: 0.820 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677623).  Saving model ...
Epoch: 4 cost time: 0.8602166175842285
Epoch: 4, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.673 Vali Acc: 0.737 Test Loss: 0.673 Test Acc: 0.737
Validation loss decreased (-0.677623 --> -0.736835).  Saving model ...
Epoch: 5 cost time: 0.9333815574645996
Epoch: 5, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 6 cost time: 0.9651131629943848
Epoch: 6, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.544 Vali Acc: 0.750 Test Loss: 0.544 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 7 cost time: 0.9771666526794434
Epoch: 7, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.749995 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.0055873394012451
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9872236251831055
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9421558380126953
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9878346920013428
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0089454650878906
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.561 Vali Acc: 0.776 Test Loss: 0.561 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9087281227111816
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0367708206176758
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9475243091583252
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8581910133361816
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8816554546356201
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 110276
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6347761154174805
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.459 Vali Acc: 0.178 Test Loss: 1.459 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 0.7992603778839111
Epoch: 2, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.321 Vali Acc: 0.316 Test Loss: 1.321 Test Acc: 0.316
Validation loss decreased (-0.177617 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 0.9345495700836182
Epoch: 3, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
Validation loss decreased (-0.315776 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 0.9024815559387207
Epoch: 4, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.977 Vali Acc: 0.605 Test Loss: 0.977 Test Acc: 0.605
Validation loss decreased (-0.519725 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 0.8653571605682373
Epoch: 5, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.842 Vali Acc: 0.664 Test Loss: 0.842 Test Acc: 0.664
Validation loss decreased (-0.605253 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 0.788222074508667
Epoch: 6, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.752 Vali Acc: 0.684 Test Loss: 0.752 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 0.9152994155883789
Epoch: 7, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 0.8036797046661377
Epoch: 8, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.640 Vali Acc: 0.737 Test Loss: 0.640 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 0.9093964099884033
Epoch: 9, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.607 Vali Acc: 0.743 Test Loss: 0.607 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 0.8136019706726074
Epoch: 10, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.0053393840789795
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.587 Vali Acc: 0.743 Test Loss: 0.587 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9520769119262695
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.578 Vali Acc: 0.750 Test Loss: 0.578 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0126886367797852
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 0.8990848064422607
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9299085140228271
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9393093585968018
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.858757734298706
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9431099891662598
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8566477298736572
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9420132637023926
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0119051933288574
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8150582313537598
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.919135332107544
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.626 Vali Acc: 0.757 Test Loss: 0.626 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 87300
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5026581287384033
Epoch: 1, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.289 Vali Acc: 0.428 Test Loss: 1.289 Test Acc: 0.428
Validation loss decreased (inf --> -0.427619).  Saving model ...
Epoch: 2 cost time: 0.9586944580078125
Epoch: 2, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.191 Vali Acc: 0.533 Test Loss: 1.191 Test Acc: 0.533
Validation loss decreased (-0.427619 --> -0.532883).  Saving model ...
Epoch: 3 cost time: 1.0222301483154297
Epoch: 3, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.068 Vali Acc: 0.599 Test Loss: 1.068 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 0.9013254642486572
Epoch: 4, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.947 Vali Acc: 0.671 Test Loss: 0.947 Test Acc: 0.671
Validation loss decreased (-0.598674 --> -0.671043).  Saving model ...
Epoch: 5 cost time: 0.97104811668396
Epoch: 5, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.836 Vali Acc: 0.711 Test Loss: 0.836 Test Acc: 0.711
Validation loss decreased (-0.671043 --> -0.710518).  Saving model ...
Epoch: 6 cost time: 0.9434783458709717
Epoch: 6, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 1.052145004272461
Epoch: 7, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.684 Vali Acc: 0.737 Test Loss: 0.684 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 0.9155664443969727
Epoch: 8, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.627 Vali Acc: 0.770 Test Loss: 0.627 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.0504562854766846
Epoch: 9, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.593 Vali Acc: 0.776 Test Loss: 0.593 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 0.8497238159179688
Epoch: 10, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 0.9915120601654053
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 0.9354703426361084
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.527 Vali Acc: 0.783 Test Loss: 0.527 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 0.9147300720214844
Epoch: 13, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 0.8308010101318359
Epoch: 14, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.0407376289367676
Epoch: 15, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.509 Vali Acc: 0.796 Test Loss: 0.509 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.048814058303833
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9822051525115967
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9203968048095703
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9430873394012451
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9523134231567383
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8940067291259766
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8678863048553467
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7786061763763428
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.877526044845581
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 79748
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.769315719604492
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.327 Vali Acc: 0.316 Test Loss: 1.327 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.8829517364501953
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.228 Vali Acc: 0.467 Test Loss: 1.228 Test Acc: 0.467
Validation loss decreased (-0.315776 --> -0.467093).  Saving model ...
Epoch: 3 cost time: 0.8356492519378662
Epoch: 3, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.101 Vali Acc: 0.599 Test Loss: 1.101 Test Acc: 0.599
Validation loss decreased (-0.467093 --> -0.598673).  Saving model ...
Epoch: 4 cost time: 0.8877232074737549
Epoch: 4, Steps: 10 | Train Loss: 0.938 Vali Loss: 0.969 Vali Acc: 0.671 Test Loss: 0.969 Test Acc: 0.671
Validation loss decreased (-0.598673 --> -0.671043).  Saving model ...
Epoch: 5 cost time: 0.9723644256591797
Epoch: 5, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.860 Vali Acc: 0.691 Test Loss: 0.860 Test Acc: 0.691
Validation loss decreased (-0.671043 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 0.9888136386871338
Epoch: 6, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.771 Vali Acc: 0.684 Test Loss: 0.771 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9886319637298584
Epoch: 7, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.701 Vali Acc: 0.717 Test Loss: 0.701 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.0239219665527344
Epoch: 8, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.0363309383392334
Epoch: 9, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 0.916558027267456
Epoch: 10, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 0.8976078033447266
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 0.9910671710968018
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.932072639465332
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9559025764465332
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 0.8308415412902832
Epoch: 15, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 0.9987649917602539
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9038136005401611
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9194719791412354
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.537 Vali Acc: 0.757 Test Loss: 0.537 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8812823295593262
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.0454728603363037
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.537 Vali Acc: 0.816 Test Loss: 0.537 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.0217094421386719
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9863870143890381
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9548397064208984
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.547 Vali Acc: 0.816 Test Loss: 0.547 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9544558525085449
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8232362270355225
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9804890155792236
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8616442680358887
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9931650161743164
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.027204990386963
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9963786602020264
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 79812
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1810576915740967
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.425 Vali Acc: 0.191 Test Loss: 1.425 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 0.9491825103759766
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.364 Vali Acc: 0.276 Test Loss: 1.364 Test Acc: 0.276
Validation loss decreased (-0.190775 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 0.9605402946472168
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.267 Vali Acc: 0.395 Test Loss: 1.267 Test Acc: 0.395
Validation loss decreased (-0.276302 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 0.888822078704834
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.160 Vali Acc: 0.493 Test Loss: 1.160 Test Acc: 0.493
Validation loss decreased (-0.394724 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 0.9172441959381104
Epoch: 5, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.056 Vali Acc: 0.592 Test Loss: 1.056 Test Acc: 0.592
Validation loss decreased (-0.493409 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 0.957758903503418
Epoch: 6, Steps: 10 | Train Loss: 0.842 Vali Loss: 0.957 Vali Acc: 0.651 Test Loss: 0.957 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 1.2200541496276855
Epoch: 7, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.869 Vali Acc: 0.711 Test Loss: 0.869 Test Acc: 0.711
Validation loss decreased (-0.651306 --> -0.710518).  Saving model ...
Epoch: 8 cost time: 0.8623113632202148
Epoch: 8, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.795 Vali Acc: 0.704 Test Loss: 0.795 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0959954261779785
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.741 Vali Acc: 0.730 Test Loss: 0.741 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 0.8908827304840088
Epoch: 10, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.694 Vali Acc: 0.743 Test Loss: 0.694 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 11 cost time: 0.9465365409851074
Epoch: 11, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.663 Vali Acc: 0.730 Test Loss: 0.663 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0207269191741943
Epoch: 12, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.629 Vali Acc: 0.730 Test Loss: 0.629 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9326841831207275
Epoch: 13, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.606 Vali Acc: 0.730 Test Loss: 0.606 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9114975929260254
Epoch: 14, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 0.9558346271514893
Epoch: 15, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 0.9281778335571289
Epoch: 16, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 0.9691007137298584
Epoch: 17, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 0.8820669651031494
Epoch: 18, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9526441097259521
Epoch: 19, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.197286605834961
Epoch: 20, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 0.8832488059997559
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0538067817687988
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.536 Vali Acc: 0.783 Test Loss: 0.536 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9643919467926025
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0630993843078613
Epoch: 24, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9936051368713379
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.540 Vali Acc: 0.783 Test Loss: 0.540 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0226774215698242
Epoch: 26, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 0.9148819446563721
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9908890724182129
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9298858642578125
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 0.9646031856536865
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.043886423110962
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1043918132781982
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.08750319480896
Epoch: 33, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9592010974884033
Epoch: 34, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0156683921813965
Epoch: 35, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1573007106781006
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0027832984924316
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.11177659034729
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8820242881774902
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 75332
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.518328905105591
Epoch: 1, Steps: 10 | Train Loss: 1.531 Vali Loss: 1.401 Vali Acc: 0.303 Test Loss: 1.401 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.9686074256896973
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.274 Vali Acc: 0.454 Test Loss: 1.274 Test Acc: 0.454
Validation loss decreased (-0.302618 --> -0.453935).  Saving model ...
Epoch: 3 cost time: 0.8702149391174316
Epoch: 3, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.093 Vali Acc: 0.658 Test Loss: 1.093 Test Acc: 0.658
Validation loss decreased (-0.453935 --> -0.657884).  Saving model ...
Epoch: 4 cost time: 1.019212245941162
Epoch: 4, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.915 Vali Acc: 0.684 Test Loss: 0.915 Test Acc: 0.684
Validation loss decreased (-0.657884 --> -0.684201).  Saving model ...
Epoch: 5 cost time: 0.9961261749267578
Epoch: 5, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.784 Vali Acc: 0.724 Test Loss: 0.784 Test Acc: 0.724
Validation loss decreased (-0.684201 --> -0.723676).  Saving model ...
Epoch: 6 cost time: 1.0096125602722168
Epoch: 6, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.676 Vali Acc: 0.757 Test Loss: 0.676 Test Acc: 0.757
Validation loss decreased (-0.723676 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 1.0014467239379883
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 0.9809870719909668
Epoch: 8, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9167327880859375
Epoch: 9, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.013070821762085
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 11 cost time: 1.0205445289611816
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.513 Vali Acc: 0.770 Test Loss: 0.513 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 12 cost time: 0.941756010055542
Epoch: 12, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 13 cost time: 0.9242801666259766
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 14 cost time: 1.0526881217956543
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0123422145843506
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9019951820373535
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9876184463500977
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9554948806762695
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.0890765190124512
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0807204246520996
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0450458526611328
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0802226066589355
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.783 Test Loss: 0.561 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1060361862182617
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.569 Vali Acc: 0.789 Test Loss: 0.569 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9550039768218994
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9807956218719482
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8971574306488037
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9704644680023193
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9383840560913086
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.595 Vali Acc: 0.783 Test Loss: 0.595 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps1_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 42820
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.200737714767456
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.379 Vali Acc: 0.230 Test Loss: 1.379 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.1166739463806152
Epoch: 2, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.228 Vali Acc: 0.526 Test Loss: 1.228 Test Acc: 0.526
Validation loss decreased (-0.230249 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 1.0992507934570312
Epoch: 3, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.039 Vali Acc: 0.651 Test Loss: 1.039 Test Acc: 0.651
Validation loss decreased (-0.526304 --> -0.651305).  Saving model ...
Epoch: 4 cost time: 0.9272620677947998
Epoch: 4, Steps: 10 | Train Loss: 0.779 Vali Loss: 0.877 Vali Acc: 0.711 Test Loss: 0.877 Test Acc: 0.711
Validation loss decreased (-0.651305 --> -0.710518).  Saving model ...
Epoch: 5 cost time: 1.111260175704956
Epoch: 5, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.746 Vali Acc: 0.724 Test Loss: 0.746 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.1493721008300781
Epoch: 6, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763151).  Saving model ...
Epoch: 7 cost time: 1.1119389533996582
Epoch: 7, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0735177993774414
Epoch: 8, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.0596122741699219
Epoch: 9, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.0285892486572266
Epoch: 10, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 0.9795780181884766
Epoch: 11, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 0.9568185806274414
Epoch: 12, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9819345474243164
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.145583152770996
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.159834623336792
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9890522956848145
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0583429336547852
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0340516567230225
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.529 Vali Acc: 0.783 Test Loss: 0.529 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0275747776031494
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.068512201309204
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8592886924743652
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.557 Vali Acc: 0.789 Test Loss: 0.557 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9890649318695068
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.958789587020874
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 42852
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.025846242904663
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.351 Vali Acc: 0.322 Test Loss: 1.351 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.0533452033996582
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.283 Vali Acc: 0.401 Test Loss: 1.283 Test Acc: 0.401
Validation loss decreased (-0.322355 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.0592553615570068
Epoch: 3, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.183 Vali Acc: 0.513 Test Loss: 1.183 Test Acc: 0.513
Validation loss decreased (-0.401303 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.0335066318511963
Epoch: 4, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.082 Vali Acc: 0.605 Test Loss: 1.082 Test Acc: 0.605
Validation loss decreased (-0.513146 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.2099957466125488
Epoch: 5, Steps: 10 | Train Loss: 0.943 Vali Loss: 0.983 Vali Acc: 0.658 Test Loss: 0.983 Test Acc: 0.658
Validation loss decreased (-0.605252 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 1.1440973281860352
Epoch: 6, Steps: 10 | Train Loss: 0.810 Vali Loss: 0.894 Vali Acc: 0.678 Test Loss: 0.894 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 0.9991648197174072
Epoch: 7, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.817 Vali Acc: 0.691 Test Loss: 0.817 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 1.05784010887146
Epoch: 8, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.755 Vali Acc: 0.724 Test Loss: 0.755 Test Acc: 0.724
Validation loss decreased (-0.690781 --> -0.723677).  Saving model ...
Epoch: 9 cost time: 1.0981552600860596
Epoch: 9, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.703 Vali Acc: 0.757 Test Loss: 0.703 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 1.140211820602417
Epoch: 10, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.171255350112915
Epoch: 11, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.2692861557006836
Epoch: 12, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.0512900352478027
Epoch: 13, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9991421699523926
Epoch: 14, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.13051176071167
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.0365238189697266
Epoch: 16, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.1041028499603271
Epoch: 17, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 0.9905102252960205
Epoch: 18, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9712555408477783
Epoch: 19, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 0.931316614151001
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.0033843517303467
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 22 cost time: 1.0748443603515625
Epoch: 22, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.0201365947723389
Epoch: 23, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0249395370483398
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9837007522583008
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9749855995178223
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0114707946777344
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1031405925750732
Epoch: 28, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 29 cost time: 1.1920244693756104
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1629080772399902
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.189589500427246
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.530 Vali Acc: 0.803 Test Loss: 0.530 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0106618404388428
Epoch: 32, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9926855564117432
Epoch: 33, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.535 Vali Acc: 0.803 Test Loss: 0.535 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1257810592651367
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1577045917510986
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.544 Vali Acc: 0.803 Test Loss: 0.544 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9690067768096924
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1228575706481934
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.093085527420044
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 31364
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5427844524383545
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.340 Vali Acc: 0.362 Test Loss: 1.340 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 0.910494327545166
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.288 Vali Acc: 0.395 Test Loss: 1.288 Test Acc: 0.395
Validation loss decreased (-0.361829 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 0.8988382816314697
Epoch: 3, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.216 Vali Acc: 0.441 Test Loss: 1.216 Test Acc: 0.441
Validation loss decreased (-0.394724 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 0.8007569313049316
Epoch: 4, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.133 Vali Acc: 0.513 Test Loss: 1.133 Test Acc: 0.513
Validation loss decreased (-0.440777 --> -0.513147).  Saving model ...
Epoch: 5 cost time: 0.8962769508361816
Epoch: 5, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.047 Vali Acc: 0.632 Test Loss: 1.047 Test Acc: 0.632
Validation loss decreased (-0.513147 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 0.8963208198547363
Epoch: 6, Steps: 10 | Train Loss: 0.878 Vali Loss: 0.964 Vali Acc: 0.684 Test Loss: 0.964 Test Acc: 0.684
Validation loss decreased (-0.631568 --> -0.684201).  Saving model ...
Epoch: 7 cost time: 0.9277870655059814
Epoch: 7, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.895 Vali Acc: 0.691 Test Loss: 0.895 Test Acc: 0.691
Validation loss decreased (-0.684201 --> -0.690781).  Saving model ...
Epoch: 8 cost time: 1.0664894580841064
Epoch: 8, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.827 Vali Acc: 0.697 Test Loss: 0.827 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697360).  Saving model ...
Epoch: 9 cost time: 0.9488098621368408
Epoch: 9, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.771 Vali Acc: 0.697 Test Loss: 0.771 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 0.796398401260376
Epoch: 10, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.719 Vali Acc: 0.704 Test Loss: 0.719 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 0.86897873878479
Epoch: 11, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.679 Vali Acc: 0.724 Test Loss: 0.679 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 1.0240662097930908
Epoch: 12, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.644 Vali Acc: 0.750 Test Loss: 0.644 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.8872683048248291
Epoch: 13, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.619 Vali Acc: 0.750 Test Loss: 0.619 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 0.8777143955230713
Epoch: 14, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 0.9149379730224609
Epoch: 15, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 0.8736476898193359
Epoch: 16, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9017047882080078
Epoch: 17, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9733121395111084
Epoch: 18, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.538 Vali Acc: 0.757 Test Loss: 0.538 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9796617031097412
Epoch: 19, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.527 Vali Acc: 0.757 Test Loss: 0.527 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.954742431640625
Epoch: 20, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.520 Vali Acc: 0.757 Test Loss: 0.520 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9438555240631104
Epoch: 21, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.510 Vali Acc: 0.757 Test Loss: 0.510 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0768406391143799
Epoch: 22, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.505 Vali Acc: 0.763 Test Loss: 0.505 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9028527736663818
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.500 Vali Acc: 0.763 Test Loss: 0.500 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8979430198669434
Epoch: 24, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.500 Vali Acc: 0.763 Test Loss: 0.500 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9060132503509521
Epoch: 25, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.497 Vali Acc: 0.770 Test Loss: 0.497 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 27588
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.887248992919922
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.420 Vali Acc: 0.230 Test Loss: 1.420 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.0472416877746582
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.369 Vali Acc: 0.289 Test Loss: 1.369 Test Acc: 0.289
Validation loss decreased (-0.230249 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.9561619758605957
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.291 Vali Acc: 0.395 Test Loss: 1.291 Test Acc: 0.395
Validation loss decreased (-0.289460 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 0.9706430435180664
Epoch: 4, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.204 Vali Acc: 0.520 Test Loss: 1.204 Test Acc: 0.520
Validation loss decreased (-0.394724 --> -0.519725).  Saving model ...
Epoch: 5 cost time: 0.9542582035064697
Epoch: 5, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.116 Vali Acc: 0.572 Test Loss: 1.116 Test Acc: 0.572
Validation loss decreased (-0.519725 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 0.9635508060455322
Epoch: 6, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.028 Vali Acc: 0.612 Test Loss: 1.028 Test Acc: 0.612
Validation loss decreased (-0.572357 --> -0.611832).  Saving model ...
Epoch: 7 cost time: 0.9526619911193848
Epoch: 7, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.946 Vali Acc: 0.658 Test Loss: 0.946 Test Acc: 0.658
Validation loss decreased (-0.611832 --> -0.657885).  Saving model ...
Epoch: 8 cost time: 0.8706324100494385
Epoch: 8, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.873 Vali Acc: 0.664 Test Loss: 0.873 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664465).  Saving model ...
Epoch: 9 cost time: 0.874983549118042
Epoch: 9, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.813 Vali Acc: 0.691 Test Loss: 0.813 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.006404161453247
Epoch: 10, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.759 Vali Acc: 0.697 Test Loss: 0.759 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 11 cost time: 0.9828987121582031
Epoch: 11, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 0.9122030735015869
Epoch: 12, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.684 Vali Acc: 0.743 Test Loss: 0.684 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 0.8506526947021484
Epoch: 13, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.653 Vali Acc: 0.750 Test Loss: 0.653 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 0.9518401622772217
Epoch: 14, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.629 Vali Acc: 0.757 Test Loss: 0.629 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 0.981149435043335
Epoch: 15, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 0.9860553741455078
Epoch: 16, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 0.947371244430542
Epoch: 17, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1364426612854004
Epoch: 18, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 1.0534512996673584
Epoch: 19, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.015709638595581
Epoch: 20, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.993539571762085
Epoch: 21, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9301927089691162
Epoch: 22, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0233783721923828
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0409438610076904
Epoch: 24, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9785618782043457
Epoch: 25, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.949164867401123
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0792350769042969
Epoch: 27, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9429068565368652
Epoch: 28, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8877120018005371
Epoch: 29, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps6_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 27620
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.735283374786377
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.412 Vali Acc: 0.276 Test Loss: 1.412 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.0742475986480713
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.376 Vali Acc: 0.362 Test Loss: 1.376 Test Acc: 0.362
Validation loss decreased (-0.276302 --> -0.361828).  Saving model ...
Epoch: 3 cost time: 0.9588375091552734
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.321 Vali Acc: 0.421 Test Loss: 1.321 Test Acc: 0.421
Validation loss decreased (-0.361828 --> -0.421039).  Saving model ...
Epoch: 4 cost time: 0.960153341293335
Epoch: 4, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.261 Vali Acc: 0.474 Test Loss: 1.261 Test Acc: 0.474
Validation loss decreased (-0.421039 --> -0.473672).  Saving model ...
Epoch: 5 cost time: 0.951218843460083
Epoch: 5, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.199 Vali Acc: 0.539 Test Loss: 1.199 Test Acc: 0.539
Validation loss decreased (-0.473672 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.0072643756866455
Epoch: 6, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.135 Vali Acc: 0.553 Test Loss: 1.135 Test Acc: 0.553
Validation loss decreased (-0.539462 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 0.8228449821472168
Epoch: 7, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.071 Vali Acc: 0.586 Test Loss: 1.071 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585516).  Saving model ...
Epoch: 8 cost time: 0.7722477912902832
Epoch: 8, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.011 Vali Acc: 0.592 Test Loss: 1.011 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592095).  Saving model ...
Epoch: 9 cost time: 0.977731466293335
Epoch: 9, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.959 Vali Acc: 0.599 Test Loss: 0.959 Test Acc: 0.599
Validation loss decreased (-0.592095 --> -0.598675).  Saving model ...
Epoch: 10 cost time: 0.9005496501922607
Epoch: 10, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.906 Vali Acc: 0.612 Test Loss: 0.906 Test Acc: 0.612
Validation loss decreased (-0.598675 --> -0.611833).  Saving model ...
Epoch: 11 cost time: 0.9062767028808594
Epoch: 11, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.860 Vali Acc: 0.651 Test Loss: 0.860 Test Acc: 0.651
Validation loss decreased (-0.611833 --> -0.651307).  Saving model ...
Epoch: 12 cost time: 0.9152028560638428
Epoch: 12, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.822 Vali Acc: 0.664 Test Loss: 0.822 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 13 cost time: 0.8197553157806396
Epoch: 13, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.791 Vali Acc: 0.664 Test Loss: 0.791 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664466).  Saving model ...
Epoch: 14 cost time: 0.7911345958709717
Epoch: 14, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.758 Vali Acc: 0.678 Test Loss: 0.758 Test Acc: 0.678
Validation loss decreased (-0.664466 --> -0.677624).  Saving model ...
Epoch: 15 cost time: 0.7756190299987793
Epoch: 15, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.730 Vali Acc: 0.684 Test Loss: 0.730 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 16 cost time: 0.9925873279571533
Epoch: 16, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.709 Vali Acc: 0.678 Test Loss: 0.709 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9023098945617676
Epoch: 17, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.686 Vali Acc: 0.691 Test Loss: 0.686 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690783).  Saving model ...
Epoch: 18 cost time: 0.8521215915679932
Epoch: 18, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.665 Vali Acc: 0.697 Test Loss: 0.665 Test Acc: 0.697
Validation loss decreased (-0.690783 --> -0.697362).  Saving model ...
Epoch: 19 cost time: 1.0447230339050293
Epoch: 19, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.647 Vali Acc: 0.724 Test Loss: 0.647 Test Acc: 0.724
Validation loss decreased (-0.697362 --> -0.723678).  Saving model ...
Epoch: 20 cost time: 1.0182271003723145
Epoch: 20, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.635 Vali Acc: 0.730 Test Loss: 0.635 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 21 cost time: 0.9624714851379395
Epoch: 21, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.622 Vali Acc: 0.730 Test Loss: 0.622 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 22 cost time: 0.8887817859649658
Epoch: 22, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.607 Vali Acc: 0.730 Test Loss: 0.607 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 23 cost time: 0.9652788639068604
Epoch: 23, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.595 Vali Acc: 0.743 Test Loss: 0.595 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 0.9298930168151855
Epoch: 24, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0662639141082764
Epoch: 25, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 0.9647543430328369
Epoch: 26, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9346330165863037
Epoch: 27, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 28 cost time: 1.0427067279815674
Epoch: 28, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 0.8857264518737793
Epoch: 29, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9164786338806152
Epoch: 30, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.561 Vali Acc: 0.757 Test Loss: 0.561 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8874115943908691
Epoch: 31, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 1.0106055736541748
Epoch: 32, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 0.8723089694976807
Epoch: 33, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7946834564208984
Epoch: 34, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 35 cost time: 0.962456226348877
Epoch: 35, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.556 Vali Acc: 0.770 Test Loss: 0.556 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.08475923538208
Epoch: 36, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8469133377075195
Epoch: 37, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9001293182373047
Epoch: 38, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 39 cost time: 0.8834030628204346
Epoch: 39, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8281459808349609
Epoch: 40, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.554 Vali Acc: 0.789 Test Loss: 0.554 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 41 cost time: 1.2374863624572754
Epoch: 41, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1353964805603027
Epoch: 42, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9116148948669434
Epoch: 43, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9714400768280029
Epoch: 44, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9305756092071533
Epoch: 45, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.981550931930542
Epoch: 46, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9708468914031982
Epoch: 47, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9292869567871094
Epoch: 48, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.572 Vali Acc: 0.796 Test Loss: 0.572 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 49 cost time: 0.9680290222167969
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0855376720428467
Epoch: 50, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.586 Vali Acc: 0.796 Test Loss: 0.586 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_RacketSports_ModernTCN_UEA_ftM_sl30_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 25380
model size : 0.11MB
