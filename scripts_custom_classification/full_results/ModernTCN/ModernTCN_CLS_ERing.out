Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6400928497314453
Epoch: 1, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.754 Vali Acc: 0.307 Test Loss: 1.754 Test Acc: 0.307
Validation loss decreased (inf --> -0.307390).  Saving model ...
Epoch: 2 cost time: 0.3840646743774414
Epoch: 2, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.741 Vali Acc: 0.352 Test Loss: 1.741 Test Acc: 0.352
Validation loss decreased (-0.307390 --> -0.351834).  Saving model ...
Epoch: 3 cost time: 0.41506147384643555
Epoch: 3, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.724 Vali Acc: 0.389 Test Loss: 1.724 Test Acc: 0.389
Validation loss decreased (-0.351834 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 0.4025540351867676
Epoch: 4, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.697 Vali Acc: 0.515 Test Loss: 1.697 Test Acc: 0.515
Validation loss decreased (-0.388872 --> -0.514798).  Saving model ...
Epoch: 5 cost time: 0.38766932487487793
Epoch: 5, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.659 Vali Acc: 0.674 Test Loss: 1.659 Test Acc: 0.674
Validation loss decreased (-0.514798 --> -0.674057).  Saving model ...
Epoch: 6 cost time: 0.4422798156738281
Epoch: 6, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.610 Vali Acc: 0.748 Test Loss: 1.610 Test Acc: 0.748
Validation loss decreased (-0.674057 --> -0.748132).  Saving model ...
Epoch: 7 cost time: 0.4713597297668457
Epoch: 7, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.547 Vali Acc: 0.785 Test Loss: 1.547 Test Acc: 0.785
Validation loss decreased (-0.748132 --> -0.785170).  Saving model ...
Epoch: 8 cost time: 0.4161496162414551
Epoch: 8, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.473 Vali Acc: 0.807 Test Loss: 1.473 Test Acc: 0.807
Validation loss decreased (-0.785170 --> -0.807393).  Saving model ...
Epoch: 9 cost time: 0.39934873580932617
Epoch: 9, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.385 Vali Acc: 0.841 Test Loss: 1.385 Test Acc: 0.841
Validation loss decreased (-0.807393 --> -0.840727).  Saving model ...
Epoch: 10 cost time: 0.47127628326416016
Epoch: 10, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.286 Vali Acc: 0.863 Test Loss: 1.286 Test Acc: 0.863
Validation loss decreased (-0.840727 --> -0.862950).  Saving model ...
Epoch: 11 cost time: 0.42755985260009766
Epoch: 11, Steps: 2 | Train Loss: 0.879 Vali Loss: 1.176 Vali Acc: 0.874 Test Loss: 1.176 Test Acc: 0.874
Validation loss decreased (-0.862950 --> -0.874062).  Saving model ...
Epoch: 12 cost time: 0.4013826847076416
Epoch: 12, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.059 Vali Acc: 0.885 Test Loss: 1.059 Test Acc: 0.885
Validation loss decreased (-0.874062 --> -0.885175).  Saving model ...
Epoch: 13 cost time: 0.4291248321533203
Epoch: 13, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.940 Vali Acc: 0.915 Test Loss: 0.940 Test Acc: 0.915
Validation loss decreased (-0.885175 --> -0.914805).  Saving model ...
Epoch: 14 cost time: 0.4185197353363037
Epoch: 14, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.824 Vali Acc: 0.926 Test Loss: 0.824 Test Acc: 0.926
Validation loss decreased (-0.914805 --> -0.925918).  Saving model ...
Epoch: 15 cost time: 0.39899611473083496
Epoch: 15, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.713 Vali Acc: 0.933 Test Loss: 0.713 Test Acc: 0.933
Validation loss decreased (-0.925918 --> -0.933326).  Saving model ...
Epoch: 16 cost time: 0.3958261013031006
Epoch: 16, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.614 Vali Acc: 0.930 Test Loss: 0.614 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3949320316314697
Epoch: 17, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.528 Vali Acc: 0.941 Test Loss: 0.528 Test Acc: 0.941
Validation loss decreased (-0.933326 --> -0.940735).  Saving model ...
Epoch: 18 cost time: 0.40284156799316406
Epoch: 18, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.456 Vali Acc: 0.941 Test Loss: 0.456 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 19 cost time: 0.41696810722351074
Epoch: 19, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.397 Vali Acc: 0.944 Test Loss: 0.397 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 20 cost time: 0.4123265743255615
Epoch: 20, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.3974800109863281
Epoch: 21, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.312 Vali Acc: 0.948 Test Loss: 0.312 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.40221309661865234
Epoch: 22, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.281 Vali Acc: 0.948 Test Loss: 0.281 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 23 cost time: 0.41948866844177246
Epoch: 23, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.41554689407348633
Epoch: 24, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.4300098419189453
Epoch: 25, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.41966676712036133
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4143552780151367
Epoch: 27, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.3915855884552002
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4092252254486084
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.3908045291900635
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.43367838859558105
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.4256110191345215
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.41403961181640625
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.3905069828033447
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 819174
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6262702941894531
Epoch: 1, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.721 Vali Acc: 0.604 Test Loss: 1.721 Test Acc: 0.604
Validation loss decreased (inf --> -0.603686).  Saving model ...
Epoch: 2 cost time: 0.45319223403930664
Epoch: 2, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.708 Vali Acc: 0.622 Test Loss: 1.708 Test Acc: 0.622
Validation loss decreased (-0.603686 --> -0.622205).  Saving model ...
Epoch: 3 cost time: 0.4213731288909912
Epoch: 3, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.694 Vali Acc: 0.630 Test Loss: 1.694 Test Acc: 0.630
Validation loss decreased (-0.622205 --> -0.629613).  Saving model ...
Epoch: 4 cost time: 0.3987619876861572
Epoch: 4, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.675 Vali Acc: 0.644 Test Loss: 1.675 Test Acc: 0.644
Validation loss decreased (-0.629613 --> -0.644428).  Saving model ...
Epoch: 5 cost time: 0.43381547927856445
Epoch: 5, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.649 Vali Acc: 0.681 Test Loss: 1.649 Test Acc: 0.681
Validation loss decreased (-0.644428 --> -0.681465).  Saving model ...
Epoch: 6 cost time: 0.4017503261566162
Epoch: 6, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.616 Vali Acc: 0.733 Test Loss: 1.616 Test Acc: 0.733
Validation loss decreased (-0.681465 --> -0.733317).  Saving model ...
Epoch: 7 cost time: 0.37769627571105957
Epoch: 7, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.576 Vali Acc: 0.770 Test Loss: 1.576 Test Acc: 0.770
Validation loss decreased (-0.733317 --> -0.770355).  Saving model ...
Epoch: 8 cost time: 0.3954813480377197
Epoch: 8, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.530 Vali Acc: 0.815 Test Loss: 1.530 Test Acc: 0.815
Validation loss decreased (-0.770355 --> -0.814800).  Saving model ...
Epoch: 9 cost time: 0.43340134620666504
Epoch: 9, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.476 Vali Acc: 0.833 Test Loss: 1.476 Test Acc: 0.833
Validation loss decreased (-0.814800 --> -0.833319).  Saving model ...
Epoch: 10 cost time: 0.4194366931915283
Epoch: 10, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.416 Vali Acc: 0.859 Test Loss: 1.416 Test Acc: 0.859
Validation loss decreased (-0.833319 --> -0.859245).  Saving model ...
Epoch: 11 cost time: 0.4014911651611328
Epoch: 11, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.348 Vali Acc: 0.863 Test Loss: 1.348 Test Acc: 0.863
Validation loss decreased (-0.859245 --> -0.862949).  Saving model ...
Epoch: 12 cost time: 0.5139901638031006
Epoch: 12, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.275 Vali Acc: 0.878 Test Loss: 1.275 Test Acc: 0.878
Validation loss decreased (-0.862949 --> -0.877765).  Saving model ...
Epoch: 13 cost time: 0.5163376331329346
Epoch: 13, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.199 Vali Acc: 0.889 Test Loss: 1.199 Test Acc: 0.889
Validation loss decreased (-0.877765 --> -0.888877).  Saving model ...
Epoch: 14 cost time: 0.4103734493255615
Epoch: 14, Steps: 2 | Train Loss: 0.841 Vali Loss: 1.118 Vali Acc: 0.904 Test Loss: 1.118 Test Acc: 0.904
Validation loss decreased (-0.888877 --> -0.903693).  Saving model ...
Epoch: 15 cost time: 0.41042399406433105
Epoch: 15, Steps: 2 | Train Loss: 0.794 Vali Loss: 1.035 Vali Acc: 0.919 Test Loss: 1.035 Test Acc: 0.919
Validation loss decreased (-0.903693 --> -0.918508).  Saving model ...
Epoch: 16 cost time: 0.3733863830566406
Epoch: 16, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.952 Vali Acc: 0.922 Test Loss: 0.952 Test Acc: 0.922
Validation loss decreased (-0.918508 --> -0.922213).  Saving model ...
Epoch: 17 cost time: 0.42503809928894043
Epoch: 17, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.871 Vali Acc: 0.937 Test Loss: 0.871 Test Acc: 0.937
Validation loss decreased (-0.922213 --> -0.937028).  Saving model ...
Epoch: 18 cost time: 0.4494311809539795
Epoch: 18, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.794 Vali Acc: 0.937 Test Loss: 0.794 Test Acc: 0.937
Validation loss decreased (-0.937028 --> -0.937029).  Saving model ...
Epoch: 19 cost time: 0.3925795555114746
Epoch: 19, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.721 Vali Acc: 0.941 Test Loss: 0.721 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940734).  Saving model ...
Epoch: 20 cost time: 0.5050036907196045
Epoch: 20, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.654 Vali Acc: 0.937 Test Loss: 0.654 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.48825764656066895
Epoch: 21, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.592 Vali Acc: 0.937 Test Loss: 0.592 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.45685577392578125
Epoch: 22, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.538 Vali Acc: 0.941 Test Loss: 0.538 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 23 cost time: 0.42153120040893555
Epoch: 23, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.491 Vali Acc: 0.941 Test Loss: 0.491 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 24 cost time: 0.41847825050354004
Epoch: 24, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.450 Vali Acc: 0.933 Test Loss: 0.450 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.41341638565063477
Epoch: 25, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.415 Vali Acc: 0.937 Test Loss: 0.415 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4662015438079834
Epoch: 26, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.39896678924560547
Epoch: 27, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.3913536071777344
Epoch: 28, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.338 Vali Acc: 0.944 Test Loss: 0.338 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 29 cost time: 0.43192028999328613
Epoch: 29, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.319 Vali Acc: 0.944 Test Loss: 0.319 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.4116027355194092
Epoch: 30, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.43027329444885254
Epoch: 31, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.395219087600708
Epoch: 32, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.38625121116638184
Epoch: 33, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4321274757385254
Epoch: 34, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.409686803817749
Epoch: 35, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.44219422340393066
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.4323577880859375
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4564700126647949
Epoch: 38, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.45685625076293945
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 791590
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7458558082580566
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.811 Vali Acc: 0.056 Test Loss: 1.811 Test Acc: 0.056
Validation loss decreased (inf --> -0.055537).  Saving model ...
Epoch: 2 cost time: 0.4483959674835205
Epoch: 2, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.801 Vali Acc: 0.056 Test Loss: 1.801 Test Acc: 0.056
Validation loss decreased (-0.055537 --> -0.055538).  Saving model ...
Epoch: 3 cost time: 0.3883364200592041
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.791 Vali Acc: 0.070 Test Loss: 1.791 Test Acc: 0.070
Validation loss decreased (-0.055538 --> -0.070352).  Saving model ...
Epoch: 4 cost time: 0.38718199729919434
Epoch: 4, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.778 Vali Acc: 0.104 Test Loss: 1.778 Test Acc: 0.104
Validation loss decreased (-0.070352 --> -0.103686).  Saving model ...
Epoch: 5 cost time: 0.43268585205078125
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.760 Vali Acc: 0.167 Test Loss: 1.760 Test Acc: 0.167
Validation loss decreased (-0.103686 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.4372122287750244
Epoch: 6, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.737 Vali Acc: 0.248 Test Loss: 1.737 Test Acc: 0.248
Validation loss decreased (-0.166649 --> -0.248131).  Saving model ...
Epoch: 7 cost time: 0.40891265869140625
Epoch: 7, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.708 Vali Acc: 0.385 Test Loss: 1.708 Test Acc: 0.385
Validation loss decreased (-0.248131 --> -0.385168).  Saving model ...
Epoch: 8 cost time: 0.4079573154449463
Epoch: 8, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.673 Vali Acc: 0.544 Test Loss: 1.673 Test Acc: 0.544
Validation loss decreased (-0.385168 --> -0.544428).  Saving model ...
Epoch: 9 cost time: 0.38773441314697266
Epoch: 9, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.633 Vali Acc: 0.615 Test Loss: 1.633 Test Acc: 0.615
Validation loss decreased (-0.544428 --> -0.614798).  Saving model ...
Epoch: 10 cost time: 0.42816638946533203
Epoch: 10, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.588 Vali Acc: 0.689 Test Loss: 1.588 Test Acc: 0.689
Validation loss decreased (-0.614798 --> -0.688873).  Saving model ...
Epoch: 11 cost time: 0.43387341499328613
Epoch: 11, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.538 Vali Acc: 0.730 Test Loss: 1.538 Test Acc: 0.730
Validation loss decreased (-0.688873 --> -0.729614).  Saving model ...
Epoch: 12 cost time: 0.4445984363555908
Epoch: 12, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.484 Vali Acc: 0.778 Test Loss: 1.484 Test Acc: 0.778
Validation loss decreased (-0.729614 --> -0.777763).  Saving model ...
Epoch: 13 cost time: 0.47255873680114746
Epoch: 13, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.426 Vali Acc: 0.800 Test Loss: 1.426 Test Acc: 0.800
Validation loss decreased (-0.777763 --> -0.799986).  Saving model ...
Epoch: 14 cost time: 0.39897942543029785
Epoch: 14, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.362 Vali Acc: 0.826 Test Loss: 1.362 Test Acc: 0.826
Validation loss decreased (-0.799986 --> -0.825912).  Saving model ...
Epoch: 15 cost time: 0.3959803581237793
Epoch: 15, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.294 Vali Acc: 0.833 Test Loss: 1.294 Test Acc: 0.833
Validation loss decreased (-0.825912 --> -0.833320).  Saving model ...
Epoch: 16 cost time: 0.40320444107055664
Epoch: 16, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.224 Vali Acc: 0.844 Test Loss: 1.224 Test Acc: 0.844
Validation loss decreased (-0.833320 --> -0.844432).  Saving model ...
Epoch: 17 cost time: 0.3923764228820801
Epoch: 17, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.150 Vali Acc: 0.848 Test Loss: 1.150 Test Acc: 0.848
Validation loss decreased (-0.844432 --> -0.848137).  Saving model ...
Epoch: 18 cost time: 0.41643643379211426
Epoch: 18, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.075 Vali Acc: 0.856 Test Loss: 1.075 Test Acc: 0.856
Validation loss decreased (-0.848137 --> -0.855545).  Saving model ...
Epoch: 19 cost time: 0.40761590003967285
Epoch: 19, Steps: 2 | Train Loss: 0.726 Vali Loss: 1.000 Vali Acc: 0.863 Test Loss: 1.000 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
Epoch: 20 cost time: 0.3954956531524658
Epoch: 20, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.926 Vali Acc: 0.867 Test Loss: 0.926 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 21 cost time: 0.41475367546081543
Epoch: 21, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.857 Vali Acc: 0.870 Test Loss: 0.857 Test Acc: 0.870
Validation loss decreased (-0.866657 --> -0.870362).  Saving model ...
Epoch: 22 cost time: 0.4173710346221924
Epoch: 22, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.791 Vali Acc: 0.874 Test Loss: 0.791 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
Epoch: 23 cost time: 0.4441337585449219
Epoch: 23, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.728 Vali Acc: 0.893 Test Loss: 0.728 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892585).  Saving model ...
Epoch: 24 cost time: 0.43109917640686035
Epoch: 24, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.671 Vali Acc: 0.896 Test Loss: 0.671 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896290).  Saving model ...
Epoch: 25 cost time: 0.4256162643432617
Epoch: 25, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.4331963062286377
Epoch: 26, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.572 Vali Acc: 0.900 Test Loss: 0.572 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.47359132766723633
Epoch: 27, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.531 Vali Acc: 0.904 Test Loss: 0.531 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 28 cost time: 0.43718814849853516
Epoch: 28, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.494 Vali Acc: 0.915 Test Loss: 0.494 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 29 cost time: 0.4173624515533447
Epoch: 29, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.462 Vali Acc: 0.922 Test Loss: 0.462 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 0.39615559577941895
Epoch: 30, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.434 Vali Acc: 0.922 Test Loss: 0.434 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 31 cost time: 0.416550874710083
Epoch: 31, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 32 cost time: 0.4106478691101074
Epoch: 32, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 33 cost time: 0.3955566883087158
Epoch: 33, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 0.4338846206665039
Epoch: 34, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.355 Vali Acc: 0.922 Test Loss: 0.355 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.4308755397796631
Epoch: 35, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.4233694076538086
Epoch: 36, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.329 Vali Acc: 0.926 Test Loss: 0.329 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 37 cost time: 0.45869970321655273
Epoch: 37, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929626).  Saving model ...
Epoch: 38 cost time: 0.4311485290527344
Epoch: 38, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.435410737991333
Epoch: 39, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 0.417402982711792
Epoch: 40, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.43712329864501953
Epoch: 41, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.47986340522766113
Epoch: 42, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.43940043449401855
Epoch: 43, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.44397497177124023
Epoch: 44, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.40483713150024414
Epoch: 45, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.41295313835144043
Epoch: 46, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.49779605865478516
Epoch: 47, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.42320728302001953
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.3981330394744873
Epoch: 49, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.5196690559387207
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 785478
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.614192008972168
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.795 Vali Acc: 0.115 Test Loss: 1.795 Test Acc: 0.115
Validation loss decreased (inf --> -0.114797).  Saving model ...
Epoch: 2 cost time: 0.38006067276000977
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.789 Vali Acc: 0.126 Test Loss: 1.789 Test Acc: 0.126
Validation loss decreased (-0.114797 --> -0.125908).  Saving model ...
Epoch: 3 cost time: 0.376450777053833
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.782 Vali Acc: 0.141 Test Loss: 1.782 Test Acc: 0.141
Validation loss decreased (-0.125908 --> -0.140723).  Saving model ...
Epoch: 4 cost time: 0.3636600971221924
Epoch: 4, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.774 Vali Acc: 0.159 Test Loss: 1.774 Test Acc: 0.159
Validation loss decreased (-0.140723 --> -0.159242).  Saving model ...
Epoch: 5 cost time: 0.449892520904541
Epoch: 5, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.762 Vali Acc: 0.200 Test Loss: 1.762 Test Acc: 0.200
Validation loss decreased (-0.159242 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.4650702476501465
Epoch: 6, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.745 Vali Acc: 0.263 Test Loss: 1.745 Test Acc: 0.263
Validation loss decreased (-0.199982 --> -0.262946).  Saving model ...
Epoch: 7 cost time: 0.378248929977417
Epoch: 7, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.724 Vali Acc: 0.344 Test Loss: 1.724 Test Acc: 0.344
Validation loss decreased (-0.262946 --> -0.344427).  Saving model ...
Epoch: 8 cost time: 0.3692739009857178
Epoch: 8, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.699 Vali Acc: 0.437 Test Loss: 1.699 Test Acc: 0.437
Validation loss decreased (-0.344427 --> -0.437020).  Saving model ...
Epoch: 9 cost time: 0.44367241859436035
Epoch: 9, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.669 Vali Acc: 0.515 Test Loss: 1.669 Test Acc: 0.515
Validation loss decreased (-0.437020 --> -0.514798).  Saving model ...
Epoch: 10 cost time: 0.39375948905944824
Epoch: 10, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.635 Vali Acc: 0.563 Test Loss: 1.635 Test Acc: 0.563
Validation loss decreased (-0.514798 --> -0.562947).  Saving model ...
Epoch: 11 cost time: 0.4548017978668213
Epoch: 11, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.595 Vali Acc: 0.637 Test Loss: 1.595 Test Acc: 0.637
Validation loss decreased (-0.562947 --> -0.637021).  Saving model ...
Epoch: 12 cost time: 0.38005638122558594
Epoch: 12, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.550 Vali Acc: 0.696 Test Loss: 1.550 Test Acc: 0.696
Validation loss decreased (-0.637021 --> -0.696281).  Saving model ...
Epoch: 13 cost time: 0.38640928268432617
Epoch: 13, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.501 Vali Acc: 0.744 Test Loss: 1.501 Test Acc: 0.744
Validation loss decreased (-0.696281 --> -0.744429).  Saving model ...
Epoch: 14 cost time: 0.3624107837677002
Epoch: 14, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.447 Vali Acc: 0.767 Test Loss: 1.447 Test Acc: 0.767
Validation loss decreased (-0.744429 --> -0.766652).  Saving model ...
Epoch: 15 cost time: 0.40955233573913574
Epoch: 15, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.390 Vali Acc: 0.789 Test Loss: 1.390 Test Acc: 0.789
Validation loss decreased (-0.766652 --> -0.788875).  Saving model ...
Epoch: 16 cost time: 0.38144564628601074
Epoch: 16, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.329 Vali Acc: 0.807 Test Loss: 1.329 Test Acc: 0.807
Validation loss decreased (-0.788875 --> -0.807394).  Saving model ...
Epoch: 17 cost time: 0.5278425216674805
Epoch: 17, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.265 Vali Acc: 0.852 Test Loss: 1.265 Test Acc: 0.852
Validation loss decreased (-0.807394 --> -0.851839).  Saving model ...
Epoch: 18 cost time: 0.3656797409057617
Epoch: 18, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.199 Vali Acc: 0.856 Test Loss: 1.199 Test Acc: 0.856
Validation loss decreased (-0.851839 --> -0.855544).  Saving model ...
Epoch: 19 cost time: 0.41671228408813477
Epoch: 19, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.132 Vali Acc: 0.867 Test Loss: 1.132 Test Acc: 0.867
Validation loss decreased (-0.855544 --> -0.866655).  Saving model ...
Epoch: 20 cost time: 0.4098494052886963
Epoch: 20, Steps: 2 | Train Loss: 0.834 Vali Loss: 1.065 Vali Acc: 0.878 Test Loss: 1.065 Test Acc: 0.878
Validation loss decreased (-0.866655 --> -0.877767).  Saving model ...
Epoch: 21 cost time: 0.4568502902984619
Epoch: 21, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.999 Vali Acc: 0.878 Test Loss: 0.999 Test Acc: 0.878
Validation loss decreased (-0.877767 --> -0.877768).  Saving model ...
Epoch: 22 cost time: 0.46036386489868164
Epoch: 22, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.935 Vali Acc: 0.881 Test Loss: 0.935 Test Acc: 0.881
Validation loss decreased (-0.877768 --> -0.881472).  Saving model ...
Epoch: 23 cost time: 0.36394786834716797
Epoch: 23, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.875 Vali Acc: 0.885 Test Loss: 0.875 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 24 cost time: 0.3809964656829834
Epoch: 24, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.817 Vali Acc: 0.885 Test Loss: 0.817 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885177).  Saving model ...
Epoch: 25 cost time: 0.40119218826293945
Epoch: 25, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.764 Vali Acc: 0.893 Test Loss: 0.764 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892585).  Saving model ...
Epoch: 26 cost time: 0.48250579833984375
Epoch: 26, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.714 Vali Acc: 0.893 Test Loss: 0.714 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 27 cost time: 0.432849645614624
Epoch: 27, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.669 Vali Acc: 0.904 Test Loss: 0.669 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903697).  Saving model ...
Epoch: 28 cost time: 0.3575592041015625
Epoch: 28, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.628 Vali Acc: 0.907 Test Loss: 0.628 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 29 cost time: 0.39769840240478516
Epoch: 29, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.590 Vali Acc: 0.915 Test Loss: 0.590 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 30 cost time: 0.50821852684021
Epoch: 30, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.555 Vali Acc: 0.919 Test Loss: 0.555 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 31 cost time: 0.4359884262084961
Epoch: 31, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.524 Vali Acc: 0.919 Test Loss: 0.524 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 32 cost time: 0.5430295467376709
Epoch: 32, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.496 Vali Acc: 0.919 Test Loss: 0.496 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 33 cost time: 0.3913238048553467
Epoch: 33, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.471 Vali Acc: 0.919 Test Loss: 0.471 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 34 cost time: 0.3742513656616211
Epoch: 34, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 35 cost time: 0.3898797035217285
Epoch: 35, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.427 Vali Acc: 0.930 Test Loss: 0.427 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 36 cost time: 0.4338717460632324
Epoch: 36, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.408 Vali Acc: 0.933 Test Loss: 0.408 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 0.3932771682739258
Epoch: 37, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.391 Vali Acc: 0.941 Test Loss: 0.391 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 38 cost time: 0.45735645294189453
Epoch: 38, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.375 Vali Acc: 0.941 Test Loss: 0.375 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 39 cost time: 0.3833763599395752
Epoch: 39, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.361 Vali Acc: 0.941 Test Loss: 0.361 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 40 cost time: 0.35633087158203125
Epoch: 40, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.46383190155029297
Epoch: 41, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.3660848140716553
Epoch: 42, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.3976759910583496
Epoch: 43, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.38170576095581055
Epoch: 44, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.310 Vali Acc: 0.941 Test Loss: 0.310 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.3814208507537842
Epoch: 45, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.3586246967315674
Epoch: 46, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.3867504596710205
Epoch: 47, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.4842064380645752
Epoch: 48, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.37156033515930176
Epoch: 49, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.33882927894592285
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 779398
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.792802333831787
Epoch: 1, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.811 Vali Acc: 0.119 Test Loss: 1.811 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.3917958736419678
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.808 Vali Acc: 0.126 Test Loss: 1.808 Test Acc: 0.126
Validation loss decreased (-0.118500 --> -0.125908).  Saving model ...
Epoch: 3 cost time: 0.3901793956756592
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.805 Vali Acc: 0.141 Test Loss: 1.805 Test Acc: 0.141
Validation loss decreased (-0.125908 --> -0.140723).  Saving model ...
Epoch: 4 cost time: 0.41008877754211426
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.799 Vali Acc: 0.159 Test Loss: 1.799 Test Acc: 0.159
Validation loss decreased (-0.140723 --> -0.159241).  Saving model ...
Epoch: 5 cost time: 0.3697521686553955
Epoch: 5, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.789 Vali Acc: 0.211 Test Loss: 1.789 Test Acc: 0.211
Validation loss decreased (-0.159241 --> -0.211093).  Saving model ...
Epoch: 6 cost time: 0.4174153804779053
Epoch: 6, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.774 Vali Acc: 0.274 Test Loss: 1.774 Test Acc: 0.274
Validation loss decreased (-0.211093 --> -0.274056).  Saving model ...
Epoch: 7 cost time: 0.43830132484436035
Epoch: 7, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.755 Vali Acc: 0.344 Test Loss: 1.755 Test Acc: 0.344
Validation loss decreased (-0.274056 --> -0.344427).  Saving model ...
Epoch: 8 cost time: 0.43300366401672363
Epoch: 8, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.731 Vali Acc: 0.419 Test Loss: 1.731 Test Acc: 0.419
Validation loss decreased (-0.344427 --> -0.418501).  Saving model ...
Epoch: 9 cost time: 0.4082956314086914
Epoch: 9, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.701 Vali Acc: 0.496 Test Loss: 1.701 Test Acc: 0.496
Validation loss decreased (-0.418501 --> -0.496279).  Saving model ...
Epoch: 10 cost time: 0.41933488845825195
Epoch: 10, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.667 Vali Acc: 0.559 Test Loss: 1.667 Test Acc: 0.559
Validation loss decreased (-0.496279 --> -0.559243).  Saving model ...
Epoch: 11 cost time: 0.39141011238098145
Epoch: 11, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.628 Vali Acc: 0.619 Test Loss: 1.628 Test Acc: 0.619
Validation loss decreased (-0.559243 --> -0.618502).  Saving model ...
Epoch: 12 cost time: 0.38878560066223145
Epoch: 12, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.584 Vali Acc: 0.652 Test Loss: 1.584 Test Acc: 0.652
Validation loss decreased (-0.618502 --> -0.651836).  Saving model ...
Epoch: 13 cost time: 0.46292996406555176
Epoch: 13, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.536 Vali Acc: 0.700 Test Loss: 1.536 Test Acc: 0.700
Validation loss decreased (-0.651836 --> -0.699985).  Saving model ...
Epoch: 14 cost time: 0.445559024810791
Epoch: 14, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.483 Vali Acc: 0.733 Test Loss: 1.483 Test Acc: 0.733
Validation loss decreased (-0.699985 --> -0.733319).  Saving model ...
Epoch: 15 cost time: 0.43053293228149414
Epoch: 15, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.427 Vali Acc: 0.767 Test Loss: 1.427 Test Acc: 0.767
Validation loss decreased (-0.733319 --> -0.766652).  Saving model ...
Epoch: 16 cost time: 0.42905664443969727
Epoch: 16, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.369 Vali Acc: 0.796 Test Loss: 1.369 Test Acc: 0.796
Validation loss decreased (-0.766652 --> -0.796283).  Saving model ...
Epoch: 17 cost time: 0.43969249725341797
Epoch: 17, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.307 Vali Acc: 0.815 Test Loss: 1.307 Test Acc: 0.815
Validation loss decreased (-0.796283 --> -0.814802).  Saving model ...
Epoch: 18 cost time: 0.42425990104675293
Epoch: 18, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.244 Vali Acc: 0.841 Test Loss: 1.244 Test Acc: 0.841
Validation loss decreased (-0.814802 --> -0.840728).  Saving model ...
Epoch: 19 cost time: 0.40315771102905273
Epoch: 19, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.180 Vali Acc: 0.863 Test Loss: 1.180 Test Acc: 0.863
Validation loss decreased (-0.840728 --> -0.862951).  Saving model ...
Epoch: 20 cost time: 0.4171140193939209
Epoch: 20, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.116 Vali Acc: 0.867 Test Loss: 1.116 Test Acc: 0.867
Validation loss decreased (-0.862951 --> -0.866656).  Saving model ...
Epoch: 21 cost time: 0.37863707542419434
Epoch: 21, Steps: 2 | Train Loss: 0.839 Vali Loss: 1.052 Vali Acc: 0.878 Test Loss: 1.052 Test Acc: 0.878
Validation loss decreased (-0.866656 --> -0.877767).  Saving model ...
Epoch: 22 cost time: 0.4098057746887207
Epoch: 22, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.989 Vali Acc: 0.881 Test Loss: 0.989 Test Acc: 0.881
Validation loss decreased (-0.877767 --> -0.881472).  Saving model ...
Epoch: 23 cost time: 0.4082643985748291
Epoch: 23, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.927 Vali Acc: 0.896 Test Loss: 0.927 Test Acc: 0.896
Validation loss decreased (-0.881472 --> -0.896287).  Saving model ...
Epoch: 24 cost time: 0.46457743644714355
Epoch: 24, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.867 Vali Acc: 0.911 Test Loss: 0.867 Test Acc: 0.911
Validation loss decreased (-0.896287 --> -0.911102).  Saving model ...
Epoch: 25 cost time: 0.4482383728027344
Epoch: 25, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.811 Vali Acc: 0.922 Test Loss: 0.811 Test Acc: 0.922
Validation loss decreased (-0.911102 --> -0.922214).  Saving model ...
Epoch: 26 cost time: 0.45184755325317383
Epoch: 26, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.757 Vali Acc: 0.922 Test Loss: 0.757 Test Acc: 0.922
Validation loss decreased (-0.922214 --> -0.922215).  Saving model ...
Epoch: 27 cost time: 0.405531644821167
Epoch: 27, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.707 Vali Acc: 0.926 Test Loss: 0.707 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 28 cost time: 0.40343594551086426
Epoch: 28, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.660 Vali Acc: 0.930 Test Loss: 0.660 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 29 cost time: 0.362227201461792
Epoch: 29, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.618 Vali Acc: 0.930 Test Loss: 0.618 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 30 cost time: 0.3950047492980957
Epoch: 30, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.578 Vali Acc: 0.933 Test Loss: 0.578 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933328).  Saving model ...
Epoch: 31 cost time: 0.39636707305908203
Epoch: 31, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.543 Vali Acc: 0.948 Test Loss: 0.543 Test Acc: 0.948
Validation loss decreased (-0.933328 --> -0.948143).  Saving model ...
Epoch: 32 cost time: 0.43605542182922363
Epoch: 32, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.511 Vali Acc: 0.948 Test Loss: 0.511 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 33 cost time: 0.45513486862182617
Epoch: 33, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.482 Vali Acc: 0.948 Test Loss: 0.482 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 34 cost time: 0.42455101013183594
Epoch: 34, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.456 Vali Acc: 0.948 Test Loss: 0.456 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 35 cost time: 0.48893260955810547
Epoch: 35, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.432 Vali Acc: 0.948 Test Loss: 0.432 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 36 cost time: 0.497211217880249
Epoch: 36, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.412 Vali Acc: 0.948 Test Loss: 0.412 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 37 cost time: 0.43032383918762207
Epoch: 37, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.393 Vali Acc: 0.948 Test Loss: 0.393 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 38 cost time: 0.4080028533935547
Epoch: 38, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.376 Vali Acc: 0.948 Test Loss: 0.376 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 39 cost time: 0.41225147247314453
Epoch: 39, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.362 Vali Acc: 0.952 Test Loss: 0.362 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 40 cost time: 0.40755271911621094
Epoch: 40, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.348 Vali Acc: 0.952 Test Loss: 0.348 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 41 cost time: 0.393798828125
Epoch: 41, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.336 Vali Acc: 0.952 Test Loss: 0.336 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 42 cost time: 0.4392673969268799
Epoch: 42, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.325 Vali Acc: 0.952 Test Loss: 0.325 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.48057126998901367
Epoch: 43, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.314 Vali Acc: 0.952 Test Loss: 0.314 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.49394893646240234
Epoch: 44, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.305 Vali Acc: 0.952 Test Loss: 0.305 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 45 cost time: 0.49693870544433594
Epoch: 45, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.296 Vali Acc: 0.956 Test Loss: 0.296 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.4497530460357666
Epoch: 46, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.289 Vali Acc: 0.956 Test Loss: 0.289 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.4618337154388428
Epoch: 47, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.282 Vali Acc: 0.956 Test Loss: 0.282 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.4237697124481201
Epoch: 48, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.956 Test Loss: 0.276 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.40433454513549805
Epoch: 49, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.270 Vali Acc: 0.956 Test Loss: 0.270 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.41002702713012695
Epoch: 50, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.264 Vali Acc: 0.956 Test Loss: 0.264 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 779494
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.715576410293579
Epoch: 1, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.810 Vali Acc: 0.126 Test Loss: 1.810 Test Acc: 0.126
Validation loss decreased (inf --> -0.125908).  Saving model ...
Epoch: 2 cost time: 0.38097596168518066
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.806 Vali Acc: 0.144 Test Loss: 1.806 Test Acc: 0.144
Validation loss decreased (-0.125908 --> -0.144426).  Saving model ...
Epoch: 3 cost time: 0.4356060028076172
Epoch: 3, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.801 Vali Acc: 0.167 Test Loss: 1.801 Test Acc: 0.167
Validation loss decreased (-0.144426 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.4765172004699707
Epoch: 4, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.795 Vali Acc: 0.207 Test Loss: 1.795 Test Acc: 0.207
Validation loss decreased (-0.166649 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 0.4373495578765869
Epoch: 5, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.785 Vali Acc: 0.244 Test Loss: 1.785 Test Acc: 0.244
Validation loss decreased (-0.207389 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 0.40429258346557617
Epoch: 6, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.771 Vali Acc: 0.307 Test Loss: 1.771 Test Acc: 0.307
Validation loss decreased (-0.244427 --> -0.307390).  Saving model ...
Epoch: 7 cost time: 0.4904794692993164
Epoch: 7, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.754 Vali Acc: 0.363 Test Loss: 1.754 Test Acc: 0.363
Validation loss decreased (-0.307390 --> -0.362945).  Saving model ...
Epoch: 8 cost time: 0.5086069107055664
Epoch: 8, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.732 Vali Acc: 0.385 Test Loss: 1.732 Test Acc: 0.385
Validation loss decreased (-0.362945 --> -0.385168).  Saving model ...
Epoch: 9 cost time: 0.43174052238464355
Epoch: 9, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.706 Vali Acc: 0.419 Test Loss: 1.706 Test Acc: 0.419
Validation loss decreased (-0.385168 --> -0.418501).  Saving model ...
Epoch: 10 cost time: 0.4433598518371582
Epoch: 10, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.677 Vali Acc: 0.430 Test Loss: 1.677 Test Acc: 0.430
Validation loss decreased (-0.418501 --> -0.429613).  Saving model ...
Epoch: 11 cost time: 0.5106303691864014
Epoch: 11, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.643 Vali Acc: 0.444 Test Loss: 1.643 Test Acc: 0.444
Validation loss decreased (-0.429613 --> -0.444428).  Saving model ...
Epoch: 12 cost time: 0.5234396457672119
Epoch: 12, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.605 Vali Acc: 0.474 Test Loss: 1.605 Test Acc: 0.474
Validation loss decreased (-0.444428 --> -0.474058).  Saving model ...
Epoch: 13 cost time: 0.4202077388763428
Epoch: 13, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.564 Vali Acc: 0.511 Test Loss: 1.564 Test Acc: 0.511
Validation loss decreased (-0.474058 --> -0.511095).  Saving model ...
Epoch: 14 cost time: 0.4197070598602295
Epoch: 14, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.520 Vali Acc: 0.552 Test Loss: 1.520 Test Acc: 0.552
Validation loss decreased (-0.511095 --> -0.551837).  Saving model ...
Epoch: 15 cost time: 0.4419996738433838
Epoch: 15, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.472 Vali Acc: 0.581 Test Loss: 1.472 Test Acc: 0.581
Validation loss decreased (-0.551837 --> -0.581467).  Saving model ...
Epoch: 16 cost time: 0.3963899612426758
Epoch: 16, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.423 Vali Acc: 0.615 Test Loss: 1.423 Test Acc: 0.615
Validation loss decreased (-0.581467 --> -0.614801).  Saving model ...
Epoch: 17 cost time: 0.46672987937927246
Epoch: 17, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.372 Vali Acc: 0.648 Test Loss: 1.372 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648134).  Saving model ...
Epoch: 18 cost time: 0.39540648460388184
Epoch: 18, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.318 Vali Acc: 0.693 Test Loss: 1.318 Test Acc: 0.693
Validation loss decreased (-0.648134 --> -0.692579).  Saving model ...
Epoch: 19 cost time: 0.4554612636566162
Epoch: 19, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.264 Vali Acc: 0.730 Test Loss: 1.264 Test Acc: 0.730
Validation loss decreased (-0.692579 --> -0.729617).  Saving model ...
Epoch: 20 cost time: 0.4782373905181885
Epoch: 20, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.209 Vali Acc: 0.748 Test Loss: 1.209 Test Acc: 0.748
Validation loss decreased (-0.729617 --> -0.748136).  Saving model ...
Epoch: 21 cost time: 0.4548957347869873
Epoch: 21, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.154 Vali Acc: 0.759 Test Loss: 1.154 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759248).  Saving model ...
Epoch: 22 cost time: 0.4721181392669678
Epoch: 22, Steps: 2 | Train Loss: 0.852 Vali Loss: 1.099 Vali Acc: 0.781 Test Loss: 1.099 Test Acc: 0.781
Validation loss decreased (-0.759248 --> -0.781470).  Saving model ...
Epoch: 23 cost time: 0.42763853073120117
Epoch: 23, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.045 Vali Acc: 0.807 Test Loss: 1.045 Test Acc: 0.807
Validation loss decreased (-0.781470 --> -0.807397).  Saving model ...
Epoch: 24 cost time: 0.425004243850708
Epoch: 24, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.992 Vali Acc: 0.819 Test Loss: 0.992 Test Acc: 0.819
Validation loss decreased (-0.807397 --> -0.818509).  Saving model ...
Epoch: 25 cost time: 0.4177591800689697
Epoch: 25, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.941 Vali Acc: 0.844 Test Loss: 0.941 Test Acc: 0.844
Validation loss decreased (-0.818509 --> -0.844435).  Saving model ...
Epoch: 26 cost time: 0.4748218059539795
Epoch: 26, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.891 Vali Acc: 0.852 Test Loss: 0.891 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
Epoch: 27 cost time: 0.42354893684387207
Epoch: 27, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.844 Vali Acc: 0.856 Test Loss: 0.844 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855547).  Saving model ...
Epoch: 28 cost time: 0.4954640865325928
Epoch: 28, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.800 Vali Acc: 0.863 Test Loss: 0.800 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 29 cost time: 0.48816776275634766
Epoch: 29, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.758 Vali Acc: 0.874 Test Loss: 0.758 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874066).  Saving model ...
Epoch: 30 cost time: 0.48351073265075684
Epoch: 30, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.718 Vali Acc: 0.874 Test Loss: 0.718 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874067).  Saving model ...
Epoch: 31 cost time: 0.4673457145690918
Epoch: 31, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.681 Vali Acc: 0.878 Test Loss: 0.681 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 32 cost time: 0.5453526973724365
Epoch: 32, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.646 Vali Acc: 0.889 Test Loss: 0.646 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888882).  Saving model ...
Epoch: 33 cost time: 0.41995668411254883
Epoch: 33, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.614 Vali Acc: 0.896 Test Loss: 0.614 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 34 cost time: 0.4845268726348877
Epoch: 34, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.584 Vali Acc: 0.904 Test Loss: 0.584 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 35 cost time: 0.4309415817260742
Epoch: 35, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.556 Vali Acc: 0.904 Test Loss: 0.556 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 36 cost time: 0.5019965171813965
Epoch: 36, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.529 Vali Acc: 0.907 Test Loss: 0.529 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 37 cost time: 0.4615952968597412
Epoch: 37, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.505 Vali Acc: 0.911 Test Loss: 0.505 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 38 cost time: 0.3923909664154053
Epoch: 38, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.482 Vali Acc: 0.915 Test Loss: 0.482 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 39 cost time: 0.4272797107696533
Epoch: 39, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.461 Vali Acc: 0.922 Test Loss: 0.461 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 40 cost time: 0.47324681282043457
Epoch: 40, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.442 Vali Acc: 0.922 Test Loss: 0.442 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 41 cost time: 0.5350115299224854
Epoch: 41, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.425 Vali Acc: 0.930 Test Loss: 0.425 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 42 cost time: 0.43402099609375
Epoch: 42, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.409 Vali Acc: 0.930 Test Loss: 0.409 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 43 cost time: 0.4118936061859131
Epoch: 43, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.394 Vali Acc: 0.930 Test Loss: 0.394 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 44 cost time: 0.40325140953063965
Epoch: 44, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.380 Vali Acc: 0.933 Test Loss: 0.380 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 45 cost time: 0.44698071479797363
Epoch: 45, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937033).  Saving model ...
Epoch: 46 cost time: 0.4999964237213135
Epoch: 46, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.357 Vali Acc: 0.937 Test Loss: 0.357 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 47 cost time: 0.442746639251709
Epoch: 47, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.346 Vali Acc: 0.937 Test Loss: 0.346 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 48 cost time: 0.4697456359863281
Epoch: 48, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 49 cost time: 0.4112536907196045
Epoch: 49, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 50 cost time: 0.39760327339172363
Epoch: 50, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.320 Vali Acc: 0.941 Test Loss: 0.320 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 776518
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.829408884048462
Epoch: 1, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.752 Vali Acc: 0.319 Test Loss: 1.752 Test Acc: 0.319
Validation loss decreased (inf --> -0.318501).  Saving model ...
Epoch: 2 cost time: 0.4239838123321533
Epoch: 2, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.744 Vali Acc: 0.367 Test Loss: 1.744 Test Acc: 0.367
Validation loss decreased (-0.318501 --> -0.366649).  Saving model ...
Epoch: 3 cost time: 0.400360107421875
Epoch: 3, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.736 Vali Acc: 0.419 Test Loss: 1.736 Test Acc: 0.419
Validation loss decreased (-0.366649 --> -0.418501).  Saving model ...
Epoch: 4 cost time: 0.45753002166748047
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.726 Vali Acc: 0.452 Test Loss: 1.726 Test Acc: 0.452
Validation loss decreased (-0.418501 --> -0.451835).  Saving model ...
Epoch: 5 cost time: 0.4127316474914551
Epoch: 5, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.714 Vali Acc: 0.496 Test Loss: 1.714 Test Acc: 0.496
Validation loss decreased (-0.451835 --> -0.496279).  Saving model ...
Epoch: 6 cost time: 0.4450490474700928
Epoch: 6, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.698 Vali Acc: 0.559 Test Loss: 1.698 Test Acc: 0.559
Validation loss decreased (-0.496279 --> -0.559242).  Saving model ...
Epoch: 7 cost time: 0.5030961036682129
Epoch: 7, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.680 Vali Acc: 0.589 Test Loss: 1.680 Test Acc: 0.589
Validation loss decreased (-0.559242 --> -0.588872).  Saving model ...
Epoch: 8 cost time: 0.45206212997436523
Epoch: 8, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.659 Vali Acc: 0.607 Test Loss: 1.659 Test Acc: 0.607
Validation loss decreased (-0.588872 --> -0.607391).  Saving model ...
Epoch: 9 cost time: 0.5286848545074463
Epoch: 9, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.635 Vali Acc: 0.633 Test Loss: 1.635 Test Acc: 0.633
Validation loss decreased (-0.607391 --> -0.633317).  Saving model ...
Epoch: 10 cost time: 0.42331385612487793
Epoch: 10, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.608 Vali Acc: 0.663 Test Loss: 1.608 Test Acc: 0.663
Validation loss decreased (-0.633317 --> -0.662947).  Saving model ...
Epoch: 11 cost time: 0.4525790214538574
Epoch: 11, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.577 Vali Acc: 0.693 Test Loss: 1.577 Test Acc: 0.693
Validation loss decreased (-0.662947 --> -0.692577).  Saving model ...
Epoch: 12 cost time: 0.44211912155151367
Epoch: 12, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.545 Vali Acc: 0.711 Test Loss: 1.545 Test Acc: 0.711
Validation loss decreased (-0.692577 --> -0.711096).  Saving model ...
Epoch: 13 cost time: 0.4301128387451172
Epoch: 13, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.509 Vali Acc: 0.733 Test Loss: 1.509 Test Acc: 0.733
Validation loss decreased (-0.711096 --> -0.733318).  Saving model ...
Epoch: 14 cost time: 0.3874037265777588
Epoch: 14, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.471 Vali Acc: 0.785 Test Loss: 1.471 Test Acc: 0.785
Validation loss decreased (-0.733318 --> -0.785170).  Saving model ...
Epoch: 15 cost time: 0.3724207878112793
Epoch: 15, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.431 Vali Acc: 0.807 Test Loss: 1.431 Test Acc: 0.807
Validation loss decreased (-0.785170 --> -0.807393).  Saving model ...
Epoch: 16 cost time: 0.43350791931152344
Epoch: 16, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.390 Vali Acc: 0.815 Test Loss: 1.390 Test Acc: 0.815
Validation loss decreased (-0.807393 --> -0.814801).  Saving model ...
Epoch: 17 cost time: 0.4225444793701172
Epoch: 17, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.347 Vali Acc: 0.830 Test Loss: 1.347 Test Acc: 0.830
Validation loss decreased (-0.814801 --> -0.829616).  Saving model ...
Epoch: 18 cost time: 0.48375821113586426
Epoch: 18, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.303 Vali Acc: 0.848 Test Loss: 1.303 Test Acc: 0.848
Validation loss decreased (-0.829616 --> -0.848135).  Saving model ...
Epoch: 19 cost time: 0.4156959056854248
Epoch: 19, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.257 Vali Acc: 0.874 Test Loss: 1.257 Test Acc: 0.874
Validation loss decreased (-0.848135 --> -0.874062).  Saving model ...
Epoch: 20 cost time: 0.4240398406982422
Epoch: 20, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.212 Vali Acc: 0.881 Test Loss: 1.212 Test Acc: 0.881
Validation loss decreased (-0.874062 --> -0.881469).  Saving model ...
Epoch: 21 cost time: 0.42813897132873535
Epoch: 21, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.165 Vali Acc: 0.889 Test Loss: 1.165 Test Acc: 0.889
Validation loss decreased (-0.881469 --> -0.888877).  Saving model ...
Epoch: 22 cost time: 0.4203367233276367
Epoch: 22, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.119 Vali Acc: 0.900 Test Loss: 1.119 Test Acc: 0.900
Validation loss decreased (-0.888877 --> -0.899989).  Saving model ...
Epoch: 23 cost time: 0.45285987854003906
Epoch: 23, Steps: 2 | Train Loss: 0.864 Vali Loss: 1.073 Vali Acc: 0.915 Test Loss: 1.073 Test Acc: 0.915
Validation loss decreased (-0.899989 --> -0.914804).  Saving model ...
Epoch: 24 cost time: 0.4788675308227539
Epoch: 24, Steps: 2 | Train Loss: 0.810 Vali Loss: 1.028 Vali Acc: 0.919 Test Loss: 1.028 Test Acc: 0.919
Validation loss decreased (-0.914804 --> -0.918508).  Saving model ...
Epoch: 25 cost time: 0.4785726070404053
Epoch: 25, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.983 Vali Acc: 0.926 Test Loss: 0.983 Test Acc: 0.926
Validation loss decreased (-0.918508 --> -0.925916).  Saving model ...
Epoch: 26 cost time: 0.47972702980041504
Epoch: 26, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.939 Vali Acc: 0.926 Test Loss: 0.939 Test Acc: 0.926
Validation loss decreased (-0.925916 --> -0.925917).  Saving model ...
Epoch: 27 cost time: 0.43589162826538086
Epoch: 27, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.896 Vali Acc: 0.926 Test Loss: 0.896 Test Acc: 0.926
Validation loss decreased (-0.925917 --> -0.925917).  Saving model ...
Epoch: 28 cost time: 0.39930295944213867
Epoch: 28, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.855 Vali Acc: 0.930 Test Loss: 0.855 Test Acc: 0.930
Validation loss decreased (-0.925917 --> -0.929621).  Saving model ...
Epoch: 29 cost time: 0.4070565700531006
Epoch: 29, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.815 Vali Acc: 0.930 Test Loss: 0.815 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929621).  Saving model ...
Epoch: 30 cost time: 0.4475116729736328
Epoch: 30, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.777 Vali Acc: 0.926 Test Loss: 0.777 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.47058749198913574
Epoch: 31, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.740 Vali Acc: 0.930 Test Loss: 0.740 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929622).  Saving model ...
Epoch: 32 cost time: 0.43845629692077637
Epoch: 32, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.704 Vali Acc: 0.930 Test Loss: 0.704 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929623).  Saving model ...
Epoch: 33 cost time: 0.43613457679748535
Epoch: 33, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.672 Vali Acc: 0.930 Test Loss: 0.672 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 34 cost time: 0.5043041706085205
Epoch: 34, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.641 Vali Acc: 0.930 Test Loss: 0.641 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 35 cost time: 0.45243334770202637
Epoch: 35, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.611 Vali Acc: 0.930 Test Loss: 0.611 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 36 cost time: 0.40917444229125977
Epoch: 36, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.584 Vali Acc: 0.933 Test Loss: 0.584 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933327).  Saving model ...
Epoch: 37 cost time: 0.40775609016418457
Epoch: 37, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.558 Vali Acc: 0.933 Test Loss: 0.558 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 38 cost time: 0.40453171730041504
Epoch: 38, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.534 Vali Acc: 0.933 Test Loss: 0.534 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 39 cost time: 0.42753148078918457
Epoch: 39, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.512 Vali Acc: 0.933 Test Loss: 0.512 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 40 cost time: 0.4296281337738037
Epoch: 40, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.491 Vali Acc: 0.933 Test Loss: 0.491 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 41 cost time: 0.44222378730773926
Epoch: 41, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.471 Vali Acc: 0.933 Test Loss: 0.471 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 42 cost time: 0.48950743675231934
Epoch: 42, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.453 Vali Acc: 0.937 Test Loss: 0.453 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.46099376678466797
Epoch: 43, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.437 Vali Acc: 0.937 Test Loss: 0.437 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 44 cost time: 0.6003284454345703
Epoch: 44, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.421 Vali Acc: 0.941 Test Loss: 0.421 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.459014892578125
Epoch: 45, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.406 Vali Acc: 0.937 Test Loss: 0.406 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4239661693572998
Epoch: 46, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4084188938140869
Epoch: 47, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.380 Vali Acc: 0.937 Test Loss: 0.380 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4376237392425537
Epoch: 48, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.40497636795043945
Epoch: 49, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.358 Vali Acc: 0.937 Test Loss: 0.358 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4406392574310303
Epoch: 50, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 773574
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.763643503189087
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.788 Vali Acc: 0.141 Test Loss: 1.788 Test Acc: 0.141
Validation loss decreased (inf --> -0.140723).  Saving model ...
Epoch: 2 cost time: 0.4305703639984131
Epoch: 2, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.773 Vali Acc: 0.152 Test Loss: 1.773 Test Acc: 0.152
Validation loss decreased (-0.140723 --> -0.151834).  Saving model ...
Epoch: 3 cost time: 0.48639869689941406
Epoch: 3, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.755 Vali Acc: 0.281 Test Loss: 1.755 Test Acc: 0.281
Validation loss decreased (-0.151834 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.5032174587249756
Epoch: 4, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.726 Vali Acc: 0.404 Test Loss: 1.726 Test Acc: 0.404
Validation loss decreased (-0.281464 --> -0.403686).  Saving model ...
Epoch: 5 cost time: 0.4044194221496582
Epoch: 5, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.686 Vali Acc: 0.522 Test Loss: 1.686 Test Acc: 0.522
Validation loss decreased (-0.403686 --> -0.522205).  Saving model ...
Epoch: 6 cost time: 0.4018559455871582
Epoch: 6, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.634 Vali Acc: 0.689 Test Loss: 1.634 Test Acc: 0.689
Validation loss decreased (-0.522205 --> -0.688873).  Saving model ...
Epoch: 7 cost time: 0.38657236099243164
Epoch: 7, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.571 Vali Acc: 0.789 Test Loss: 1.571 Test Acc: 0.789
Validation loss decreased (-0.688873 --> -0.788873).  Saving model ...
Epoch: 8 cost time: 0.4103412628173828
Epoch: 8, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.496 Vali Acc: 0.837 Test Loss: 1.496 Test Acc: 0.837
Validation loss decreased (-0.788873 --> -0.837022).  Saving model ...
Epoch: 9 cost time: 0.41384267807006836
Epoch: 9, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.410 Vali Acc: 0.874 Test Loss: 1.410 Test Acc: 0.874
Validation loss decreased (-0.837022 --> -0.874060).  Saving model ...
Epoch: 10 cost time: 0.39501214027404785
Epoch: 10, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.314 Vali Acc: 0.885 Test Loss: 1.314 Test Acc: 0.885
Validation loss decreased (-0.874060 --> -0.885172).  Saving model ...
Epoch: 11 cost time: 0.4032621383666992
Epoch: 11, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.209 Vali Acc: 0.904 Test Loss: 1.209 Test Acc: 0.904
Validation loss decreased (-0.885172 --> -0.903692).  Saving model ...
Epoch: 12 cost time: 0.40782856941223145
Epoch: 12, Steps: 2 | Train Loss: 0.779 Vali Loss: 1.097 Vali Acc: 0.900 Test Loss: 1.097 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4131755828857422
Epoch: 13, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.983 Vali Acc: 0.904 Test Loss: 0.983 Test Acc: 0.904
Validation loss decreased (-0.903692 --> -0.903694).  Saving model ...
Epoch: 14 cost time: 0.42363548278808594
Epoch: 14, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.869 Vali Acc: 0.919 Test Loss: 0.869 Test Acc: 0.919
Validation loss decreased (-0.903694 --> -0.918510).  Saving model ...
Epoch: 15 cost time: 0.4158635139465332
Epoch: 15, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.761 Vali Acc: 0.915 Test Loss: 0.761 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.40772223472595215
Epoch: 16, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.661 Vali Acc: 0.919 Test Loss: 0.661 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918512).  Saving model ...
Epoch: 17 cost time: 0.42640185356140137
Epoch: 17, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.573 Vali Acc: 0.919 Test Loss: 0.573 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 18 cost time: 0.40337324142456055
Epoch: 18, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.500 Vali Acc: 0.919 Test Loss: 0.500 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.470538854598999
Epoch: 19, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.438 Vali Acc: 0.922 Test Loss: 0.438 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 0.38768625259399414
Epoch: 20, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.388 Vali Acc: 0.926 Test Loss: 0.388 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.40279269218444824
Epoch: 21, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.346 Vali Acc: 0.926 Test Loss: 0.346 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.3770945072174072
Epoch: 22, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.3849356174468994
Epoch: 23, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.38501667976379395
Epoch: 24, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 0.4623394012451172
Epoch: 25, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.42291975021362305
Epoch: 26, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.41376304626464844
Epoch: 27, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.4710557460784912
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.38397741317749023
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.37864041328430176
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.3938870429992676
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.401839017868042
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.3783233165740967
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.3854687213897705
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.45108604431152344
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.4383516311645508
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.5313551425933838
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.44573974609375
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 39 cost time: 0.4273698329925537
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 40 cost time: 0.4139735698699951
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.39026737213134766
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.3811483383178711
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.3843355178833008
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.3829836845397949
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.39339351654052734
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.41455769538879395
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.4969656467437744
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5011751651763916
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.44037795066833496
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.3725745677947998
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 815590
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6265008449554443
Epoch: 1, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.777 Vali Acc: 0.307 Test Loss: 1.777 Test Acc: 0.307
Validation loss decreased (inf --> -0.307390).  Saving model ...
Epoch: 2 cost time: 0.4274437427520752
Epoch: 2, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.765 Vali Acc: 0.356 Test Loss: 1.765 Test Acc: 0.356
Validation loss decreased (-0.307390 --> -0.355538).  Saving model ...
Epoch: 3 cost time: 0.4332761764526367
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.753 Vali Acc: 0.367 Test Loss: 1.753 Test Acc: 0.367
Validation loss decreased (-0.355538 --> -0.366649).  Saving model ...
Epoch: 4 cost time: 0.4153118133544922
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.735 Vali Acc: 0.422 Test Loss: 1.735 Test Acc: 0.422
Validation loss decreased (-0.366649 --> -0.422205).  Saving model ...
Epoch: 5 cost time: 0.37381815910339355
Epoch: 5, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.711 Vali Acc: 0.574 Test Loss: 1.711 Test Acc: 0.574
Validation loss decreased (-0.422205 --> -0.574057).  Saving model ...
Epoch: 6 cost time: 0.41186976432800293
Epoch: 6, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.680 Vali Acc: 0.667 Test Loss: 1.680 Test Acc: 0.667
Validation loss decreased (-0.574057 --> -0.666650).  Saving model ...
Epoch: 7 cost time: 0.4075357913970947
Epoch: 7, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.642 Vali Acc: 0.719 Test Loss: 1.642 Test Acc: 0.719
Validation loss decreased (-0.666650 --> -0.718502).  Saving model ...
Epoch: 8 cost time: 0.3964560031890869
Epoch: 8, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.597 Vali Acc: 0.741 Test Loss: 1.597 Test Acc: 0.741
Validation loss decreased (-0.718502 --> -0.740725).  Saving model ...
Epoch: 9 cost time: 0.4101576805114746
Epoch: 9, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.545 Vali Acc: 0.756 Test Loss: 1.545 Test Acc: 0.756
Validation loss decreased (-0.740725 --> -0.755540).  Saving model ...
Epoch: 10 cost time: 0.3998379707336426
Epoch: 10, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.486 Vali Acc: 0.774 Test Loss: 1.486 Test Acc: 0.774
Validation loss decreased (-0.755540 --> -0.774059).  Saving model ...
Epoch: 11 cost time: 0.41177916526794434
Epoch: 11, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.420 Vali Acc: 0.804 Test Loss: 1.420 Test Acc: 0.804
Validation loss decreased (-0.774059 --> -0.803690).  Saving model ...
Epoch: 12 cost time: 0.3789393901824951
Epoch: 12, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.346 Vali Acc: 0.826 Test Loss: 1.346 Test Acc: 0.826
Validation loss decreased (-0.803690 --> -0.825912).  Saving model ...
Epoch: 13 cost time: 0.4351918697357178
Epoch: 13, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.267 Vali Acc: 0.856 Test Loss: 1.267 Test Acc: 0.856
Validation loss decreased (-0.825912 --> -0.855543).  Saving model ...
Epoch: 14 cost time: 0.47319984436035156
Epoch: 14, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.182 Vali Acc: 0.867 Test Loss: 1.182 Test Acc: 0.867
Validation loss decreased (-0.855543 --> -0.866655).  Saving model ...
Epoch: 15 cost time: 0.46108412742614746
Epoch: 15, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.093 Vali Acc: 0.881 Test Loss: 1.093 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881471).  Saving model ...
Epoch: 16 cost time: 0.42278528213500977
Epoch: 16, Steps: 2 | Train Loss: 0.763 Vali Loss: 1.003 Vali Acc: 0.893 Test Loss: 1.003 Test Acc: 0.893
Validation loss decreased (-0.881471 --> -0.892583).  Saving model ...
Epoch: 17 cost time: 0.38716912269592285
Epoch: 17, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.915 Vali Acc: 0.893 Test Loss: 0.915 Test Acc: 0.893
Validation loss decreased (-0.892583 --> -0.892583).  Saving model ...
Epoch: 18 cost time: 0.40909266471862793
Epoch: 18, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.829 Vali Acc: 0.896 Test Loss: 0.829 Test Acc: 0.896
Validation loss decreased (-0.892583 --> -0.896288).  Saving model ...
Epoch: 19 cost time: 0.42628049850463867
Epoch: 19, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.749 Vali Acc: 0.900 Test Loss: 0.749 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.44278812408447266
Epoch: 20, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.676 Vali Acc: 0.900 Test Loss: 0.676 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.43932294845581055
Epoch: 21, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.611 Vali Acc: 0.904 Test Loss: 0.611 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903698).  Saving model ...
Epoch: 22 cost time: 0.37838101387023926
Epoch: 22, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.553 Vali Acc: 0.904 Test Loss: 0.553 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 23 cost time: 0.3760643005371094
Epoch: 23, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.503 Vali Acc: 0.907 Test Loss: 0.503 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.5215389728546143
Epoch: 24, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.461 Vali Acc: 0.915 Test Loss: 0.461 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 25 cost time: 0.4269239902496338
Epoch: 25, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.426 Vali Acc: 0.919 Test Loss: 0.426 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 26 cost time: 0.41231656074523926
Epoch: 26, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.395 Vali Acc: 0.919 Test Loss: 0.395 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 27 cost time: 0.4569735527038574
Epoch: 27, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 28 cost time: 0.38042593002319336
Epoch: 28, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.349 Vali Acc: 0.919 Test Loss: 0.349 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 29 cost time: 0.4008479118347168
Epoch: 29, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.330 Vali Acc: 0.933 Test Loss: 0.330 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.42390894889831543
Epoch: 30, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.435288667678833
Epoch: 31, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 32 cost time: 0.3981485366821289
Epoch: 32, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.37064266204833984
Epoch: 33, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.43627357482910156
Epoch: 34, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.5130424499511719
Epoch: 35, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.4380767345428467
Epoch: 36, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.4430716037750244
Epoch: 37, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.41953372955322266
Epoch: 38, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.3972797393798828
Epoch: 39, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.42714405059814453
Epoch: 40, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.48809337615966797
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.4327969551086426
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.4378387928009033
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.4616281986236572
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.4398219585418701
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.4474058151245117
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.3928501605987549
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.4558906555175781
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.39728283882141113
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.39116382598876953
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 788006
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7036292552947998
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.772 Vali Acc: 0.196 Test Loss: 1.772 Test Acc: 0.196
Validation loss decreased (inf --> -0.196279).  Saving model ...
Epoch: 2 cost time: 0.45262956619262695
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.761 Vali Acc: 0.241 Test Loss: 1.761 Test Acc: 0.241
Validation loss decreased (-0.196279 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.4489302635192871
Epoch: 3, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.751 Vali Acc: 0.304 Test Loss: 1.751 Test Acc: 0.304
Validation loss decreased (-0.240723 --> -0.303686).  Saving model ...
Epoch: 4 cost time: 0.3758113384246826
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.736 Vali Acc: 0.348 Test Loss: 1.736 Test Acc: 0.348
Validation loss decreased (-0.303686 --> -0.348131).  Saving model ...
Epoch: 5 cost time: 0.3547213077545166
Epoch: 5, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.716 Vali Acc: 0.411 Test Loss: 1.716 Test Acc: 0.411
Validation loss decreased (-0.348131 --> -0.411094).  Saving model ...
Epoch: 6 cost time: 0.45966005325317383
Epoch: 6, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.691 Vali Acc: 0.463 Test Loss: 1.691 Test Acc: 0.463
Validation loss decreased (-0.411094 --> -0.462946).  Saving model ...
Epoch: 7 cost time: 0.3857417106628418
Epoch: 7, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.659 Vali Acc: 0.526 Test Loss: 1.659 Test Acc: 0.526
Validation loss decreased (-0.462946 --> -0.525909).  Saving model ...
Epoch: 8 cost time: 0.39347076416015625
Epoch: 8, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.622 Vali Acc: 0.600 Test Loss: 1.622 Test Acc: 0.600
Validation loss decreased (-0.525909 --> -0.599984).  Saving model ...
Epoch: 9 cost time: 0.3694908618927002
Epoch: 9, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.580 Vali Acc: 0.644 Test Loss: 1.580 Test Acc: 0.644
Validation loss decreased (-0.599984 --> -0.644429).  Saving model ...
Epoch: 10 cost time: 0.3807668685913086
Epoch: 10, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.531 Vali Acc: 0.678 Test Loss: 1.531 Test Acc: 0.678
Validation loss decreased (-0.644429 --> -0.677762).  Saving model ...
Epoch: 11 cost time: 0.4270162582397461
Epoch: 11, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.478 Vali Acc: 0.730 Test Loss: 1.478 Test Acc: 0.730
Validation loss decreased (-0.677762 --> -0.729615).  Saving model ...
Epoch: 12 cost time: 0.3989565372467041
Epoch: 12, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.420 Vali Acc: 0.770 Test Loss: 1.420 Test Acc: 0.770
Validation loss decreased (-0.729615 --> -0.770356).  Saving model ...
Epoch: 13 cost time: 0.431743860244751
Epoch: 13, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.357 Vali Acc: 0.800 Test Loss: 1.357 Test Acc: 0.800
Validation loss decreased (-0.770356 --> -0.799986).  Saving model ...
Epoch: 14 cost time: 0.4448385238647461
Epoch: 14, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.290 Vali Acc: 0.830 Test Loss: 1.290 Test Acc: 0.830
Validation loss decreased (-0.799986 --> -0.829617).  Saving model ...
Epoch: 15 cost time: 0.414703369140625
Epoch: 15, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.218 Vali Acc: 0.856 Test Loss: 1.218 Test Acc: 0.856
Validation loss decreased (-0.829617 --> -0.855543).  Saving model ...
Epoch: 16 cost time: 0.33829212188720703
Epoch: 16, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.145 Vali Acc: 0.885 Test Loss: 1.145 Test Acc: 0.885
Validation loss decreased (-0.855543 --> -0.885174).  Saving model ...
Epoch: 17 cost time: 0.3565800189971924
Epoch: 17, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.069 Vali Acc: 0.907 Test Loss: 1.069 Test Acc: 0.907
Validation loss decreased (-0.885174 --> -0.907397).  Saving model ...
Epoch: 18 cost time: 0.3886852264404297
Epoch: 18, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.992 Vali Acc: 0.911 Test Loss: 0.992 Test Acc: 0.911
Validation loss decreased (-0.907397 --> -0.911101).  Saving model ...
Epoch: 19 cost time: 0.4504580497741699
Epoch: 19, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.916 Vali Acc: 0.926 Test Loss: 0.916 Test Acc: 0.926
Validation loss decreased (-0.911101 --> -0.925917).  Saving model ...
Epoch: 20 cost time: 0.37896060943603516
Epoch: 20, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.842 Vali Acc: 0.933 Test Loss: 0.842 Test Acc: 0.933
Validation loss decreased (-0.925917 --> -0.933325).  Saving model ...
Epoch: 21 cost time: 0.41339755058288574
Epoch: 21, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.771 Vali Acc: 0.937 Test Loss: 0.771 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937029).  Saving model ...
Epoch: 22 cost time: 0.3855926990509033
Epoch: 22, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.706 Vali Acc: 0.941 Test Loss: 0.706 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940734).  Saving model ...
Epoch: 23 cost time: 0.43447017669677734
Epoch: 23, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.647 Vali Acc: 0.941 Test Loss: 0.647 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940734).  Saving model ...
Epoch: 24 cost time: 0.373119592666626
Epoch: 24, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.593 Vali Acc: 0.941 Test Loss: 0.593 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 25 cost time: 0.42959046363830566
Epoch: 25, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.544 Vali Acc: 0.944 Test Loss: 0.544 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 26 cost time: 0.3759622573852539
Epoch: 26, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.502 Vali Acc: 0.948 Test Loss: 0.502 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 27 cost time: 0.3429067134857178
Epoch: 27, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.464 Vali Acc: 0.948 Test Loss: 0.464 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 28 cost time: 0.36427950859069824
Epoch: 28, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.431 Vali Acc: 0.948 Test Loss: 0.431 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 29 cost time: 0.42264866828918457
Epoch: 29, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.401 Vali Acc: 0.948 Test Loss: 0.401 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 30 cost time: 0.3840930461883545
Epoch: 30, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.375 Vali Acc: 0.956 Test Loss: 0.375 Test Acc: 0.956
Validation loss decreased (-0.948144 --> -0.955552).  Saving model ...
Epoch: 31 cost time: 0.3550395965576172
Epoch: 31, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.352 Vali Acc: 0.956 Test Loss: 0.352 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 32 cost time: 0.3986964225769043
Epoch: 32, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.331 Vali Acc: 0.959 Test Loss: 0.331 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 33 cost time: 0.4001882076263428
Epoch: 33, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.314 Vali Acc: 0.963 Test Loss: 0.314 Test Acc: 0.963
Validation loss decreased (-0.959256 --> -0.962960).  Saving model ...
Epoch: 34 cost time: 0.38431406021118164
Epoch: 34, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.299 Vali Acc: 0.967 Test Loss: 0.299 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966664).  Saving model ...
Epoch: 35 cost time: 0.3935561180114746
Epoch: 35, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.286 Vali Acc: 0.967 Test Loss: 0.286 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 36 cost time: 0.4420018196105957
Epoch: 36, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 37 cost time: 0.37654590606689453
Epoch: 37, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.266 Vali Acc: 0.967 Test Loss: 0.266 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 38 cost time: 0.4381687641143799
Epoch: 38, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.257 Vali Acc: 0.967 Test Loss: 0.257 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 39 cost time: 0.38802385330200195
Epoch: 39, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.250 Vali Acc: 0.963 Test Loss: 0.250 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4209556579589844
Epoch: 40, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.243 Vali Acc: 0.963 Test Loss: 0.243 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.36953163146972656
Epoch: 41, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.237 Vali Acc: 0.963 Test Loss: 0.237 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.41173529624938965
Epoch: 42, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.366896390914917
Epoch: 43, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.3773355484008789
Epoch: 44, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.3547706604003906
Epoch: 45, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.3661191463470459
Epoch: 46, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.963 Test Loss: 0.216 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.3701481819152832
Epoch: 47, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.4348621368408203
Epoch: 48, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 781894
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.810256004333496
Epoch: 1, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.789 Vali Acc: 0.241 Test Loss: 1.789 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.47336649894714355
Epoch: 2, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.783 Vali Acc: 0.278 Test Loss: 1.783 Test Acc: 0.278
Validation loss decreased (-0.240723 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.45158815383911133
Epoch: 3, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.776 Vali Acc: 0.315 Test Loss: 1.776 Test Acc: 0.315
Validation loss decreased (-0.277760 --> -0.314797).  Saving model ...
Epoch: 4 cost time: 0.5542771816253662
Epoch: 4, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.766 Vali Acc: 0.333 Test Loss: 1.766 Test Acc: 0.333
Validation loss decreased (-0.314797 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.4185166358947754
Epoch: 5, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.752 Vali Acc: 0.348 Test Loss: 1.752 Test Acc: 0.348
Validation loss decreased (-0.333316 --> -0.348131).  Saving model ...
Epoch: 6 cost time: 0.4303162097930908
Epoch: 6, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.735 Vali Acc: 0.415 Test Loss: 1.735 Test Acc: 0.415
Validation loss decreased (-0.348131 --> -0.414797).  Saving model ...
Epoch: 7 cost time: 0.4309558868408203
Epoch: 7, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.712 Vali Acc: 0.470 Test Loss: 1.712 Test Acc: 0.470
Validation loss decreased (-0.414797 --> -0.470353).  Saving model ...
Epoch: 8 cost time: 0.5365619659423828
Epoch: 8, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.685 Vali Acc: 0.522 Test Loss: 1.685 Test Acc: 0.522
Validation loss decreased (-0.470353 --> -0.522205).  Saving model ...
Epoch: 9 cost time: 0.4519352912902832
Epoch: 9, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.653 Vali Acc: 0.600 Test Loss: 1.653 Test Acc: 0.600
Validation loss decreased (-0.522205 --> -0.599983).  Saving model ...
Epoch: 10 cost time: 0.46897101402282715
Epoch: 10, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.616 Vali Acc: 0.663 Test Loss: 1.616 Test Acc: 0.663
Validation loss decreased (-0.599983 --> -0.662947).  Saving model ...
Epoch: 11 cost time: 0.43979644775390625
Epoch: 11, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.575 Vali Acc: 0.693 Test Loss: 1.575 Test Acc: 0.693
Validation loss decreased (-0.662947 --> -0.692577).  Saving model ...
Epoch: 12 cost time: 0.5471763610839844
Epoch: 12, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.529 Vali Acc: 0.719 Test Loss: 1.529 Test Acc: 0.719
Validation loss decreased (-0.692577 --> -0.718503).  Saving model ...
Epoch: 13 cost time: 0.5628647804260254
Epoch: 13, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.478 Vali Acc: 0.741 Test Loss: 1.478 Test Acc: 0.741
Validation loss decreased (-0.718503 --> -0.740726).  Saving model ...
Epoch: 14 cost time: 0.43042850494384766
Epoch: 14, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.423 Vali Acc: 0.770 Test Loss: 1.423 Test Acc: 0.770
Validation loss decreased (-0.740726 --> -0.770356).  Saving model ...
Epoch: 15 cost time: 0.4194786548614502
Epoch: 15, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.364 Vali Acc: 0.793 Test Loss: 1.364 Test Acc: 0.793
Validation loss decreased (-0.770356 --> -0.792579).  Saving model ...
Epoch: 16 cost time: 0.45404839515686035
Epoch: 16, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.303 Vali Acc: 0.830 Test Loss: 1.303 Test Acc: 0.830
Validation loss decreased (-0.792579 --> -0.829617).  Saving model ...
Epoch: 17 cost time: 0.4393455982208252
Epoch: 17, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.239 Vali Acc: 0.837 Test Loss: 1.239 Test Acc: 0.837
Validation loss decreased (-0.829617 --> -0.837025).  Saving model ...
Epoch: 18 cost time: 0.4111447334289551
Epoch: 18, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.173 Vali Acc: 0.856 Test Loss: 1.173 Test Acc: 0.856
Validation loss decreased (-0.837025 --> -0.855544).  Saving model ...
Epoch: 19 cost time: 0.43024301528930664
Epoch: 19, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.106 Vali Acc: 0.867 Test Loss: 1.106 Test Acc: 0.867
Validation loss decreased (-0.855544 --> -0.866656).  Saving model ...
Epoch: 20 cost time: 0.43301868438720703
Epoch: 20, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.040 Vali Acc: 0.881 Test Loss: 1.040 Test Acc: 0.881
Validation loss decreased (-0.866656 --> -0.881471).  Saving model ...
Epoch: 21 cost time: 0.46694278717041016
Epoch: 21, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.975 Vali Acc: 0.889 Test Loss: 0.975 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888879).  Saving model ...
Epoch: 22 cost time: 0.48856663703918457
Epoch: 22, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.912 Vali Acc: 0.893 Test Loss: 0.912 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892583).  Saving model ...
Epoch: 23 cost time: 0.43738341331481934
Epoch: 23, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.852 Vali Acc: 0.896 Test Loss: 0.852 Test Acc: 0.896
Validation loss decreased (-0.892583 --> -0.896288).  Saving model ...
Epoch: 24 cost time: 0.4740569591522217
Epoch: 24, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.796 Vali Acc: 0.900 Test Loss: 0.796 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899992).  Saving model ...
Epoch: 25 cost time: 0.46978282928466797
Epoch: 25, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.744 Vali Acc: 0.900 Test Loss: 0.744 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 0.5035185813903809
Epoch: 26, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.695 Vali Acc: 0.904 Test Loss: 0.695 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 27 cost time: 0.4977567195892334
Epoch: 27, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.651 Vali Acc: 0.904 Test Loss: 0.651 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 28 cost time: 0.4617190361022949
Epoch: 28, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.610 Vali Acc: 0.907 Test Loss: 0.610 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 29 cost time: 0.44141387939453125
Epoch: 29, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.573 Vali Acc: 0.919 Test Loss: 0.573 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 30 cost time: 0.46349215507507324
Epoch: 30, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.539 Vali Acc: 0.926 Test Loss: 0.539 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 31 cost time: 0.4015214443206787
Epoch: 31, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.509 Vali Acc: 0.926 Test Loss: 0.509 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 32 cost time: 0.4529745578765869
Epoch: 32, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.482 Vali Acc: 0.926 Test Loss: 0.482 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 33 cost time: 0.43662524223327637
Epoch: 33, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.456 Vali Acc: 0.933 Test Loss: 0.456 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.41733336448669434
Epoch: 34, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.433 Vali Acc: 0.933 Test Loss: 0.433 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.4610891342163086
Epoch: 35, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.413 Vali Acc: 0.933 Test Loss: 0.413 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 36 cost time: 0.46009349822998047
Epoch: 36, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 0.4513249397277832
Epoch: 37, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.4689183235168457
Epoch: 38, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 39 cost time: 0.4114799499511719
Epoch: 39, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.349 Vali Acc: 0.937 Test Loss: 0.349 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.4266805648803711
Epoch: 40, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.4092864990234375
Epoch: 41, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.327 Vali Acc: 0.937 Test Loss: 0.327 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.41100120544433594
Epoch: 42, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.317 Vali Acc: 0.937 Test Loss: 0.317 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.4298722743988037
Epoch: 43, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.5450847148895264
Epoch: 44, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.301 Vali Acc: 0.937 Test Loss: 0.301 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 45 cost time: 0.49413537979125977
Epoch: 45, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 46 cost time: 0.4333343505859375
Epoch: 46, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.287 Vali Acc: 0.937 Test Loss: 0.287 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 47 cost time: 0.45648765563964844
Epoch: 47, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.5788702964782715
Epoch: 48, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.43630361557006836
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.48320889472961426
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 775814
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7143962383270264
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.798 Vali Acc: 0.137 Test Loss: 1.798 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.3966336250305176
Epoch: 2, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.792 Vali Acc: 0.163 Test Loss: 1.792 Test Acc: 0.163
Validation loss decreased (-0.137019 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.4188389778137207
Epoch: 3, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.786 Vali Acc: 0.181 Test Loss: 1.786 Test Acc: 0.181
Validation loss decreased (-0.162945 --> -0.181464).  Saving model ...
Epoch: 4 cost time: 0.43214988708496094
Epoch: 4, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.777 Vali Acc: 0.230 Test Loss: 1.777 Test Acc: 0.230
Validation loss decreased (-0.181464 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.45159316062927246
Epoch: 5, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.764 Vali Acc: 0.263 Test Loss: 1.764 Test Acc: 0.263
Validation loss decreased (-0.229612 --> -0.262945).  Saving model ...
Epoch: 6 cost time: 0.4761519432067871
Epoch: 6, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.748 Vali Acc: 0.281 Test Loss: 1.748 Test Acc: 0.281
Validation loss decreased (-0.262945 --> -0.281464).  Saving model ...
Epoch: 7 cost time: 0.4474461078643799
Epoch: 7, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.726 Vali Acc: 0.337 Test Loss: 1.726 Test Acc: 0.337
Validation loss decreased (-0.281464 --> -0.337020).  Saving model ...
Epoch: 8 cost time: 0.5627577304840088
Epoch: 8, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.700 Vali Acc: 0.433 Test Loss: 1.700 Test Acc: 0.433
Validation loss decreased (-0.337020 --> -0.433316).  Saving model ...
Epoch: 9 cost time: 0.47734999656677246
Epoch: 9, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.670 Vali Acc: 0.533 Test Loss: 1.670 Test Acc: 0.533
Validation loss decreased (-0.433316 --> -0.533317).  Saving model ...
Epoch: 10 cost time: 0.4234318733215332
Epoch: 10, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.633 Vali Acc: 0.641 Test Loss: 1.633 Test Acc: 0.641
Validation loss decreased (-0.533317 --> -0.640724).  Saving model ...
Epoch: 11 cost time: 0.4376652240753174
Epoch: 11, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.593 Vali Acc: 0.681 Test Loss: 1.593 Test Acc: 0.681
Validation loss decreased (-0.640724 --> -0.681466).  Saving model ...
Epoch: 12 cost time: 0.44940948486328125
Epoch: 12, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.549 Vali Acc: 0.733 Test Loss: 1.549 Test Acc: 0.733
Validation loss decreased (-0.681466 --> -0.733318).  Saving model ...
Epoch: 13 cost time: 0.5622174739837646
Epoch: 13, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.501 Vali Acc: 0.763 Test Loss: 1.501 Test Acc: 0.763
Validation loss decreased (-0.733318 --> -0.762948).  Saving model ...
Epoch: 14 cost time: 0.4250364303588867
Epoch: 14, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.448 Vali Acc: 0.774 Test Loss: 1.448 Test Acc: 0.774
Validation loss decreased (-0.762948 --> -0.774060).  Saving model ...
Epoch: 15 cost time: 0.47185587882995605
Epoch: 15, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.392 Vali Acc: 0.793 Test Loss: 1.392 Test Acc: 0.793
Validation loss decreased (-0.774060 --> -0.792579).  Saving model ...
Epoch: 16 cost time: 0.43259549140930176
Epoch: 16, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.332 Vali Acc: 0.819 Test Loss: 1.332 Test Acc: 0.819
Validation loss decreased (-0.792579 --> -0.818505).  Saving model ...
Epoch: 17 cost time: 0.41332030296325684
Epoch: 17, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.270 Vali Acc: 0.859 Test Loss: 1.270 Test Acc: 0.859
Validation loss decreased (-0.818505 --> -0.859247).  Saving model ...
Epoch: 18 cost time: 0.4046332836151123
Epoch: 18, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.206 Vali Acc: 0.878 Test Loss: 1.206 Test Acc: 0.878
Validation loss decreased (-0.859247 --> -0.877766).  Saving model ...
Epoch: 19 cost time: 0.5129711627960205
Epoch: 19, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.141 Vali Acc: 0.881 Test Loss: 1.141 Test Acc: 0.881
Validation loss decreased (-0.877766 --> -0.881470).  Saving model ...
Epoch: 20 cost time: 0.45418524742126465
Epoch: 20, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.075 Vali Acc: 0.881 Test Loss: 1.075 Test Acc: 0.881
Validation loss decreased (-0.881470 --> -0.881471).  Saving model ...
Epoch: 21 cost time: 0.5122792720794678
Epoch: 21, Steps: 2 | Train Loss: 0.761 Vali Loss: 1.009 Vali Acc: 0.889 Test Loss: 1.009 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888879).  Saving model ...
Epoch: 22 cost time: 0.5233466625213623
Epoch: 22, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.945 Vali Acc: 0.896 Test Loss: 0.945 Test Acc: 0.896
Validation loss decreased (-0.888879 --> -0.896287).  Saving model ...
Epoch: 23 cost time: 0.49442124366760254
Epoch: 23, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.882 Vali Acc: 0.896 Test Loss: 0.882 Test Acc: 0.896
Validation loss decreased (-0.896287 --> -0.896287).  Saving model ...
Epoch: 24 cost time: 0.4004554748535156
Epoch: 24, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.823 Vali Acc: 0.907 Test Loss: 0.823 Test Acc: 0.907
Validation loss decreased (-0.896287 --> -0.907399).  Saving model ...
Epoch: 25 cost time: 0.49468493461608887
Epoch: 25, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.767 Vali Acc: 0.926 Test Loss: 0.767 Test Acc: 0.926
Validation loss decreased (-0.907399 --> -0.925918).  Saving model ...
Epoch: 26 cost time: 0.4775526523590088
Epoch: 26, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.714 Vali Acc: 0.930 Test Loss: 0.714 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 27 cost time: 0.42343807220458984
Epoch: 27, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.666 Vali Acc: 0.933 Test Loss: 0.666 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933327).  Saving model ...
Epoch: 28 cost time: 0.4244406223297119
Epoch: 28, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.621 Vali Acc: 0.933 Test Loss: 0.621 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 29 cost time: 0.5028541088104248
Epoch: 29, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.579 Vali Acc: 0.937 Test Loss: 0.579 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 30 cost time: 0.4785304069519043
Epoch: 30, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.543 Vali Acc: 0.944 Test Loss: 0.543 Test Acc: 0.944
Validation loss decreased (-0.937031 --> -0.944439).  Saving model ...
Epoch: 31 cost time: 0.5139169692993164
Epoch: 31, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.509 Vali Acc: 0.948 Test Loss: 0.509 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 32 cost time: 0.4349508285522461
Epoch: 32, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.480 Vali Acc: 0.948 Test Loss: 0.480 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 33 cost time: 0.5183074474334717
Epoch: 33, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.453 Vali Acc: 0.948 Test Loss: 0.453 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 34 cost time: 0.45525026321411133
Epoch: 34, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.429 Vali Acc: 0.948 Test Loss: 0.429 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 35 cost time: 0.4051976203918457
Epoch: 35, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.408 Vali Acc: 0.948 Test Loss: 0.408 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 36 cost time: 0.4246344566345215
Epoch: 36, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.388 Vali Acc: 0.948 Test Loss: 0.388 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 37 cost time: 0.5332329273223877
Epoch: 37, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.371 Vali Acc: 0.948 Test Loss: 0.371 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 38 cost time: 0.5001058578491211
Epoch: 38, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.355 Vali Acc: 0.948 Test Loss: 0.355 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 39 cost time: 0.4930698871612549
Epoch: 39, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.341 Vali Acc: 0.948 Test Loss: 0.341 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 40 cost time: 0.4846508502960205
Epoch: 40, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.328 Vali Acc: 0.948 Test Loss: 0.328 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 41 cost time: 0.43775177001953125
Epoch: 41, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.316 Vali Acc: 0.948 Test Loss: 0.316 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 42 cost time: 0.45049047470092773
Epoch: 42, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.306 Vali Acc: 0.956 Test Loss: 0.306 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955552).  Saving model ...
Epoch: 43 cost time: 0.4461796283721924
Epoch: 43, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.296 Vali Acc: 0.956 Test Loss: 0.296 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.4695408344268799
Epoch: 44, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.288 Vali Acc: 0.959 Test Loss: 0.288 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959256).  Saving model ...
Epoch: 45 cost time: 0.44075822830200195
Epoch: 45, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.279 Vali Acc: 0.959 Test Loss: 0.279 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 46 cost time: 0.5503885746002197
Epoch: 46, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.271 Vali Acc: 0.959 Test Loss: 0.271 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.44263505935668945
Epoch: 47, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.265 Vali Acc: 0.959 Test Loss: 0.265 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.4460158348083496
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.259 Vali Acc: 0.959 Test Loss: 0.259 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.453524112701416
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.253 Vali Acc: 0.959 Test Loss: 0.253 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.4339470863342285
Epoch: 50, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.959 Test Loss: 0.248 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 775910
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7543418407440186
Epoch: 1, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.778 Vali Acc: 0.211 Test Loss: 1.778 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.4819767475128174
Epoch: 2, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.772 Vali Acc: 0.252 Test Loss: 1.772 Test Acc: 0.252
Validation loss decreased (-0.211093 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.3909485340118408
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.765 Vali Acc: 0.270 Test Loss: 1.765 Test Acc: 0.270
Validation loss decreased (-0.251834 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 0.47394394874572754
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.756 Vali Acc: 0.304 Test Loss: 1.756 Test Acc: 0.304
Validation loss decreased (-0.270353 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.40968799591064453
Epoch: 5, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.744 Vali Acc: 0.344 Test Loss: 1.744 Test Acc: 0.344
Validation loss decreased (-0.303686 --> -0.344427).  Saving model ...
Epoch: 6 cost time: 0.5230934619903564
Epoch: 6, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.729 Vali Acc: 0.411 Test Loss: 1.729 Test Acc: 0.411
Validation loss decreased (-0.344427 --> -0.411094).  Saving model ...
Epoch: 7 cost time: 0.44943666458129883
Epoch: 7, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.709 Vali Acc: 0.481 Test Loss: 1.709 Test Acc: 0.481
Validation loss decreased (-0.411094 --> -0.481464).  Saving model ...
Epoch: 8 cost time: 0.468794584274292
Epoch: 8, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.686 Vali Acc: 0.556 Test Loss: 1.686 Test Acc: 0.556
Validation loss decreased (-0.481464 --> -0.555539).  Saving model ...
Epoch: 9 cost time: 0.3928835391998291
Epoch: 9, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.659 Vali Acc: 0.611 Test Loss: 1.659 Test Acc: 0.611
Validation loss decreased (-0.555539 --> -0.611095).  Saving model ...
Epoch: 10 cost time: 0.4358639717102051
Epoch: 10, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.628 Vali Acc: 0.644 Test Loss: 1.628 Test Acc: 0.644
Validation loss decreased (-0.611095 --> -0.644428).  Saving model ...
Epoch: 11 cost time: 0.3909142017364502
Epoch: 11, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.594 Vali Acc: 0.667 Test Loss: 1.594 Test Acc: 0.667
Validation loss decreased (-0.644428 --> -0.666651).  Saving model ...
Epoch: 12 cost time: 0.45856380462646484
Epoch: 12, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.556 Vali Acc: 0.689 Test Loss: 1.556 Test Acc: 0.689
Validation loss decreased (-0.666651 --> -0.688873).  Saving model ...
Epoch: 13 cost time: 0.40071940422058105
Epoch: 13, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.514 Vali Acc: 0.711 Test Loss: 1.514 Test Acc: 0.711
Validation loss decreased (-0.688873 --> -0.711096).  Saving model ...
Epoch: 14 cost time: 0.44332432746887207
Epoch: 14, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.470 Vali Acc: 0.744 Test Loss: 1.470 Test Acc: 0.744
Validation loss decreased (-0.711096 --> -0.744430).  Saving model ...
Epoch: 15 cost time: 0.5851767063140869
Epoch: 15, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.422 Vali Acc: 0.770 Test Loss: 1.422 Test Acc: 0.770
Validation loss decreased (-0.744430 --> -0.770356).  Saving model ...
Epoch: 16 cost time: 0.4606170654296875
Epoch: 16, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.372 Vali Acc: 0.811 Test Loss: 1.372 Test Acc: 0.811
Validation loss decreased (-0.770356 --> -0.811097).  Saving model ...
Epoch: 17 cost time: 0.4255397319793701
Epoch: 17, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.320 Vali Acc: 0.822 Test Loss: 1.320 Test Acc: 0.822
Validation loss decreased (-0.811097 --> -0.822209).  Saving model ...
Epoch: 18 cost time: 0.43796467781066895
Epoch: 18, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.266 Vali Acc: 0.826 Test Loss: 1.266 Test Acc: 0.826
Validation loss decreased (-0.822209 --> -0.825913).  Saving model ...
Epoch: 19 cost time: 0.39739060401916504
Epoch: 19, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.212 Vali Acc: 0.841 Test Loss: 1.212 Test Acc: 0.841
Validation loss decreased (-0.825913 --> -0.840729).  Saving model ...
Epoch: 20 cost time: 0.4095745086669922
Epoch: 20, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.158 Vali Acc: 0.863 Test Loss: 1.158 Test Acc: 0.863
Validation loss decreased (-0.840729 --> -0.862951).  Saving model ...
Epoch: 21 cost time: 0.4609968662261963
Epoch: 21, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.103 Vali Acc: 0.885 Test Loss: 1.103 Test Acc: 0.885
Validation loss decreased (-0.862951 --> -0.885174).  Saving model ...
Epoch: 22 cost time: 0.49042606353759766
Epoch: 22, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.048 Vali Acc: 0.881 Test Loss: 1.048 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.42928457260131836
Epoch: 23, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.995 Vali Acc: 0.889 Test Loss: 0.995 Test Acc: 0.889
Validation loss decreased (-0.885174 --> -0.888879).  Saving model ...
Epoch: 24 cost time: 0.44315457344055176
Epoch: 24, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.942 Vali Acc: 0.893 Test Loss: 0.942 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892583).  Saving model ...
Epoch: 25 cost time: 0.45957088470458984
Epoch: 25, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.892 Vali Acc: 0.900 Test Loss: 0.892 Test Acc: 0.900
Validation loss decreased (-0.892583 --> -0.899991).  Saving model ...
Epoch: 26 cost time: 0.6629981994628906
Epoch: 26, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.842 Vali Acc: 0.907 Test Loss: 0.842 Test Acc: 0.907
Validation loss decreased (-0.899991 --> -0.907399).  Saving model ...
Epoch: 27 cost time: 0.4062469005584717
Epoch: 27, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.796 Vali Acc: 0.911 Test Loss: 0.796 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 28 cost time: 0.45062804222106934
Epoch: 28, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.752 Vali Acc: 0.911 Test Loss: 0.752 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911104).  Saving model ...
Epoch: 29 cost time: 0.49626755714416504
Epoch: 29, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.711 Vali Acc: 0.922 Test Loss: 0.711 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922215).  Saving model ...
Epoch: 30 cost time: 0.4534132480621338
Epoch: 30, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.673 Vali Acc: 0.922 Test Loss: 0.673 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922215).  Saving model ...
Epoch: 31 cost time: 0.4945974349975586
Epoch: 31, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.637 Vali Acc: 0.922 Test Loss: 0.637 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 32 cost time: 0.5823900699615479
Epoch: 32, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.603 Vali Acc: 0.926 Test Loss: 0.603 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 33 cost time: 0.5002343654632568
Epoch: 33, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.573 Vali Acc: 0.926 Test Loss: 0.573 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 34 cost time: 0.43633580207824707
Epoch: 34, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.545 Vali Acc: 0.922 Test Loss: 0.545 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.43741416931152344
Epoch: 35, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.518 Vali Acc: 0.933 Test Loss: 0.518 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 36 cost time: 0.5823462009429932
Epoch: 36, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.494 Vali Acc: 0.933 Test Loss: 0.494 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 37 cost time: 0.5493912696838379
Epoch: 37, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.471 Vali Acc: 0.933 Test Loss: 0.471 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.4804365634918213
Epoch: 38, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.450 Vali Acc: 0.933 Test Loss: 0.450 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.45380187034606934
Epoch: 39, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.431 Vali Acc: 0.933 Test Loss: 0.431 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.47284555435180664
Epoch: 40, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.414 Vali Acc: 0.933 Test Loss: 0.414 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 0.4524979591369629
Epoch: 41, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.398 Vali Acc: 0.941 Test Loss: 0.398 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.47813963890075684
Epoch: 42, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.383 Vali Acc: 0.941 Test Loss: 0.383 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.45215487480163574
Epoch: 43, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.370 Vali Acc: 0.941 Test Loss: 0.370 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 44 cost time: 0.4728574752807617
Epoch: 44, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.45087671279907227
Epoch: 45, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.346 Vali Acc: 0.941 Test Loss: 0.346 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 46 cost time: 0.418013334274292
Epoch: 46, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.335 Vali Acc: 0.944 Test Loss: 0.335 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 47 cost time: 0.47440671920776367
Epoch: 47, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 48 cost time: 0.5020577907562256
Epoch: 48, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.317 Vali Acc: 0.944 Test Loss: 0.317 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 49 cost time: 0.5320003032684326
Epoch: 49, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.309 Vali Acc: 0.948 Test Loss: 0.309 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 50 cost time: 0.45754504203796387
Epoch: 50, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.302 Vali Acc: 0.948 Test Loss: 0.302 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 772934
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8594765663146973
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.808 Vali Acc: 0.059 Test Loss: 1.808 Test Acc: 0.059
Validation loss decreased (inf --> -0.059241).  Saving model ...
Epoch: 2 cost time: 0.44297027587890625
Epoch: 2, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.805 Vali Acc: 0.059 Test Loss: 1.805 Test Acc: 0.059
Validation loss decreased (-0.059241 --> -0.059241).  Saving model ...
Epoch: 3 cost time: 0.4454526901245117
Epoch: 3, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.802 Vali Acc: 0.070 Test Loss: 1.802 Test Acc: 0.070
Validation loss decreased (-0.059241 --> -0.070352).  Saving model ...
Epoch: 4 cost time: 0.6270501613616943
Epoch: 4, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.798 Vali Acc: 0.081 Test Loss: 1.798 Test Acc: 0.081
Validation loss decreased (-0.070352 --> -0.081464).  Saving model ...
Epoch: 5 cost time: 0.4436836242675781
Epoch: 5, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.791 Vali Acc: 0.093 Test Loss: 1.791 Test Acc: 0.093
Validation loss decreased (-0.081464 --> -0.092575).  Saving model ...
Epoch: 6 cost time: 0.4595203399658203
Epoch: 6, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.781 Vali Acc: 0.137 Test Loss: 1.781 Test Acc: 0.137
Validation loss decreased (-0.092575 --> -0.137019).  Saving model ...
Epoch: 7 cost time: 0.47861170768737793
Epoch: 7, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.767 Vali Acc: 0.193 Test Loss: 1.767 Test Acc: 0.193
Validation loss decreased (-0.137019 --> -0.192575).  Saving model ...
Epoch: 8 cost time: 0.4511895179748535
Epoch: 8, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.751 Vali Acc: 0.263 Test Loss: 1.751 Test Acc: 0.263
Validation loss decreased (-0.192575 --> -0.262945).  Saving model ...
Epoch: 9 cost time: 0.43977856636047363
Epoch: 9, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.730 Vali Acc: 0.348 Test Loss: 1.730 Test Acc: 0.348
Validation loss decreased (-0.262945 --> -0.348131).  Saving model ...
Epoch: 10 cost time: 0.48845529556274414
Epoch: 10, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.707 Vali Acc: 0.400 Test Loss: 1.707 Test Acc: 0.400
Validation loss decreased (-0.348131 --> -0.399983).  Saving model ...
Epoch: 11 cost time: 0.43843674659729004
Epoch: 11, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.679 Vali Acc: 0.474 Test Loss: 1.679 Test Acc: 0.474
Validation loss decreased (-0.399983 --> -0.474057).  Saving model ...
Epoch: 12 cost time: 0.44211602210998535
Epoch: 12, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.648 Vali Acc: 0.515 Test Loss: 1.648 Test Acc: 0.515
Validation loss decreased (-0.474057 --> -0.514798).  Saving model ...
Epoch: 13 cost time: 0.4302349090576172
Epoch: 13, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.614 Vali Acc: 0.533 Test Loss: 1.614 Test Acc: 0.533
Validation loss decreased (-0.514798 --> -0.533317).  Saving model ...
Epoch: 14 cost time: 0.4589405059814453
Epoch: 14, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.578 Vali Acc: 0.563 Test Loss: 1.578 Test Acc: 0.563
Validation loss decreased (-0.533317 --> -0.562947).  Saving model ...
Epoch: 15 cost time: 0.41622495651245117
Epoch: 15, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.538 Vali Acc: 0.607 Test Loss: 1.538 Test Acc: 0.607
Validation loss decreased (-0.562947 --> -0.607392).  Saving model ...
Epoch: 16 cost time: 0.4250621795654297
Epoch: 16, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.497 Vali Acc: 0.637 Test Loss: 1.497 Test Acc: 0.637
Validation loss decreased (-0.607392 --> -0.637022).  Saving model ...
Epoch: 17 cost time: 0.44178032875061035
Epoch: 17, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.453 Vali Acc: 0.681 Test Loss: 1.453 Test Acc: 0.681
Validation loss decreased (-0.637022 --> -0.681467).  Saving model ...
Epoch: 18 cost time: 0.5283548831939697
Epoch: 18, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.408 Vali Acc: 0.715 Test Loss: 1.408 Test Acc: 0.715
Validation loss decreased (-0.681467 --> -0.714801).  Saving model ...
Epoch: 19 cost time: 0.4546222686767578
Epoch: 19, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.361 Vali Acc: 0.748 Test Loss: 1.361 Test Acc: 0.748
Validation loss decreased (-0.714801 --> -0.748135).  Saving model ...
Epoch: 20 cost time: 0.43527793884277344
Epoch: 20, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.314 Vali Acc: 0.770 Test Loss: 1.314 Test Acc: 0.770
Validation loss decreased (-0.748135 --> -0.770357).  Saving model ...
Epoch: 21 cost time: 0.48789048194885254
Epoch: 21, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.266 Vali Acc: 0.793 Test Loss: 1.266 Test Acc: 0.793
Validation loss decreased (-0.770357 --> -0.792580).  Saving model ...
Epoch: 22 cost time: 0.4654867649078369
Epoch: 22, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.218 Vali Acc: 0.819 Test Loss: 1.218 Test Acc: 0.819
Validation loss decreased (-0.792580 --> -0.818506).  Saving model ...
Epoch: 23 cost time: 0.44673705101013184
Epoch: 23, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.170 Vali Acc: 0.830 Test Loss: 1.170 Test Acc: 0.830
Validation loss decreased (-0.818506 --> -0.829618).  Saving model ...
Epoch: 24 cost time: 0.5028078556060791
Epoch: 24, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.122 Vali Acc: 0.844 Test Loss: 1.122 Test Acc: 0.844
Validation loss decreased (-0.829618 --> -0.844433).  Saving model ...
Epoch: 25 cost time: 0.4203531742095947
Epoch: 25, Steps: 2 | Train Loss: 0.816 Vali Loss: 1.075 Vali Acc: 0.852 Test Loss: 1.075 Test Acc: 0.852
Validation loss decreased (-0.844433 --> -0.851841).  Saving model ...
Epoch: 26 cost time: 0.45569920539855957
Epoch: 26, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.029 Vali Acc: 0.863 Test Loss: 1.029 Test Acc: 0.863
Validation loss decreased (-0.851841 --> -0.862953).  Saving model ...
Epoch: 27 cost time: 0.4983253479003906
Epoch: 27, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.984 Vali Acc: 0.867 Test Loss: 0.984 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 28 cost time: 0.49373459815979004
Epoch: 28, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.939 Vali Acc: 0.874 Test Loss: 0.939 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 29 cost time: 0.4387392997741699
Epoch: 29, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.896 Vali Acc: 0.889 Test Loss: 0.896 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888880).  Saving model ...
Epoch: 30 cost time: 0.4278678894042969
Epoch: 30, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.854 Vali Acc: 0.896 Test Loss: 0.854 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 31 cost time: 0.5885567665100098
Epoch: 31, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.814 Vali Acc: 0.900 Test Loss: 0.814 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899992).  Saving model ...
Epoch: 32 cost time: 0.42559337615966797
Epoch: 32, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.776 Vali Acc: 0.904 Test Loss: 0.776 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 33 cost time: 0.4199962615966797
Epoch: 33, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.739 Vali Acc: 0.904 Test Loss: 0.739 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 34 cost time: 0.45083165168762207
Epoch: 34, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.705 Vali Acc: 0.904 Test Loss: 0.705 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 35 cost time: 0.43758058547973633
Epoch: 35, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.672 Vali Acc: 0.907 Test Loss: 0.672 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 36 cost time: 0.4661376476287842
Epoch: 36, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.642 Vali Acc: 0.907 Test Loss: 0.642 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 37 cost time: 0.727588415145874
Epoch: 37, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.613 Vali Acc: 0.911 Test Loss: 0.613 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 38 cost time: 0.4645872116088867
Epoch: 38, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.586 Vali Acc: 0.911 Test Loss: 0.586 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 39 cost time: 0.4359712600708008
Epoch: 39, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.560 Vali Acc: 0.911 Test Loss: 0.560 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 40 cost time: 0.48159074783325195
Epoch: 40, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.537 Vali Acc: 0.915 Test Loss: 0.537 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914809).  Saving model ...
Epoch: 41 cost time: 0.43615102767944336
Epoch: 41, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.514 Vali Acc: 0.915 Test Loss: 0.514 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 42 cost time: 0.44190502166748047
Epoch: 42, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 43 cost time: 0.4936201572418213
Epoch: 43, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.474 Vali Acc: 0.915 Test Loss: 0.474 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 44 cost time: 0.4532463550567627
Epoch: 44, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 45 cost time: 0.4315347671508789
Epoch: 45, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.441 Vali Acc: 0.915 Test Loss: 0.441 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4003019332885742
Epoch: 46, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.426 Vali Acc: 0.919 Test Loss: 0.426 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 47 cost time: 0.4112832546234131
Epoch: 47, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.413 Vali Acc: 0.919 Test Loss: 0.413 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 48 cost time: 0.4432027339935303
Epoch: 48, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.400 Vali Acc: 0.919 Test Loss: 0.400 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 49 cost time: 0.4465351104736328
Epoch: 49, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.389 Vali Acc: 0.919 Test Loss: 0.389 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 50 cost time: 0.49432826042175293
Epoch: 50, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 769990
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6864185333251953
Epoch: 1, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.801 Vali Acc: 0.119 Test Loss: 1.801 Test Acc: 0.119
Validation loss decreased (inf --> -0.118501).  Saving model ...
Epoch: 2 cost time: 0.4747610092163086
Epoch: 2, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.747 Vali Acc: 0.159 Test Loss: 1.747 Test Acc: 0.159
Validation loss decreased (-0.118501 --> -0.159242).  Saving model ...
Epoch: 3 cost time: 0.4914054870605469
Epoch: 3, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.662 Vali Acc: 0.426 Test Loss: 1.662 Test Acc: 0.426
Validation loss decreased (-0.159242 --> -0.425909).  Saving model ...
Epoch: 4 cost time: 0.49377894401550293
Epoch: 4, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.511 Vali Acc: 0.648 Test Loss: 1.511 Test Acc: 0.648
Validation loss decreased (-0.425909 --> -0.648133).  Saving model ...
Epoch: 5 cost time: 0.5034010410308838
Epoch: 5, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.321 Vali Acc: 0.826 Test Loss: 1.321 Test Acc: 0.826
Validation loss decreased (-0.648133 --> -0.825913).  Saving model ...
Epoch: 6 cost time: 0.602414608001709
Epoch: 6, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.113 Vali Acc: 0.881 Test Loss: 1.113 Test Acc: 0.881
Validation loss decreased (-0.825913 --> -0.881470).  Saving model ...
Epoch: 7 cost time: 0.5191943645477295
Epoch: 7, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.906 Vali Acc: 0.885 Test Loss: 0.906 Test Acc: 0.885
Validation loss decreased (-0.881470 --> -0.885176).  Saving model ...
Epoch: 8 cost time: 0.5677990913391113
Epoch: 8, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.713 Vali Acc: 0.904 Test Loss: 0.713 Test Acc: 0.904
Validation loss decreased (-0.885176 --> -0.903697).  Saving model ...
Epoch: 9 cost time: 0.49978041648864746
Epoch: 9, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 10 cost time: 0.5109145641326904
Epoch: 10, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.424 Vali Acc: 0.933 Test Loss: 0.424 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933329).  Saving model ...
Epoch: 11 cost time: 0.5595519542694092
Epoch: 11, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 12 cost time: 0.46602606773376465
Epoch: 12, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 13 cost time: 0.5253374576568604
Epoch: 13, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.5993969440460205
Epoch: 14, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5009176731109619
Epoch: 15, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.4636082649230957
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 17 cost time: 0.46852970123291016
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.5278897285461426
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.5315735340118408
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.5467402935028076
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.5397586822509766
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5187203884124756
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.46262097358703613
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4878084659576416
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.565537691116333
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6110458374023438
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5522713661193848
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.5000123977661133
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5239427089691162
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4855318069458008
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4887111186981201
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.48291802406311035
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.49762678146362305
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5460567474365234
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4785428047180176
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5778052806854248
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5469686985015869
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2989958
model size : 11.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7746360301971436
Epoch: 1, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.759 Vali Acc: 0.174 Test Loss: 1.759 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.5387415885925293
Epoch: 2, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.716 Vali Acc: 0.189 Test Loss: 1.716 Test Acc: 0.189
Validation loss decreased (-0.174056 --> -0.188872).  Saving model ...
Epoch: 3 cost time: 0.495868444442749
Epoch: 3, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.661 Vali Acc: 0.274 Test Loss: 1.661 Test Acc: 0.274
Validation loss decreased (-0.188872 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.5167338848114014
Epoch: 4, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.571 Vali Acc: 0.567 Test Loss: 1.571 Test Acc: 0.567
Validation loss decreased (-0.274057 --> -0.566651).  Saving model ...
Epoch: 5 cost time: 0.4338393211364746
Epoch: 5, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.453 Vali Acc: 0.700 Test Loss: 1.453 Test Acc: 0.700
Validation loss decreased (-0.566651 --> -0.699985).  Saving model ...
Epoch: 6 cost time: 0.4714972972869873
Epoch: 6, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.317 Vali Acc: 0.778 Test Loss: 1.317 Test Acc: 0.778
Validation loss decreased (-0.699985 --> -0.777765).  Saving model ...
Epoch: 7 cost time: 0.49274253845214844
Epoch: 7, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.167 Vali Acc: 0.841 Test Loss: 1.167 Test Acc: 0.841
Validation loss decreased (-0.777765 --> -0.840729).  Saving model ...
Epoch: 8 cost time: 0.4832496643066406
Epoch: 8, Steps: 2 | Train Loss: 0.741 Vali Loss: 1.013 Vali Acc: 0.870 Test Loss: 1.013 Test Acc: 0.870
Validation loss decreased (-0.840729 --> -0.870360).  Saving model ...
Epoch: 9 cost time: 0.5244219303131104
Epoch: 9, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.864 Vali Acc: 0.889 Test Loss: 0.864 Test Acc: 0.889
Validation loss decreased (-0.870360 --> -0.888880).  Saving model ...
Epoch: 10 cost time: 0.4957425594329834
Epoch: 10, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.728 Vali Acc: 0.900 Test Loss: 0.728 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.4380764961242676
Epoch: 11, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.606 Vali Acc: 0.907 Test Loss: 0.606 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 12 cost time: 0.4787423610687256
Epoch: 12, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.500 Vali Acc: 0.915 Test Loss: 0.500 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914810).  Saving model ...
Epoch: 13 cost time: 0.4408693313598633
Epoch: 13, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.413 Vali Acc: 0.922 Test Loss: 0.413 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 14 cost time: 0.5516200065612793
Epoch: 14, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 15 cost time: 0.4918055534362793
Epoch: 15, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.4991300106048584
Epoch: 16, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 0.4867136478424072
Epoch: 17, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.5026724338531494
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.4673624038696289
Epoch: 19, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.5024032592773438
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.4780900478363037
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.6477270126342773
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.4742155075073242
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.5015296936035156
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.45889782905578613
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.4486808776855469
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.5338099002838135
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.5249688625335693
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5441503524780273
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.49126696586608887
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4318974018096924
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.572857141494751
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.48496055603027344
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5286929607391357
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5233705043792725
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.49808335304260254
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.49577760696411133
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.48259568214416504
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5141332149505615
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5622348785400391
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5312488079071045
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2885766
model size : 11.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7022020816802979
Epoch: 1, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.771 Vali Acc: 0.267 Test Loss: 1.771 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.46161937713623047
Epoch: 2, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.741 Vali Acc: 0.337 Test Loss: 1.741 Test Acc: 0.337
Validation loss decreased (-0.266649 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.46869325637817383
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.702 Vali Acc: 0.426 Test Loss: 1.702 Test Acc: 0.426
Validation loss decreased (-0.337020 --> -0.425909).  Saving model ...
Epoch: 4 cost time: 0.44504737854003906
Epoch: 4, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.637 Vali Acc: 0.589 Test Loss: 1.637 Test Acc: 0.589
Validation loss decreased (-0.425909 --> -0.588873).  Saving model ...
Epoch: 5 cost time: 0.47464704513549805
Epoch: 5, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.551 Vali Acc: 0.715 Test Loss: 1.551 Test Acc: 0.715
Validation loss decreased (-0.588873 --> -0.714799).  Saving model ...
Epoch: 6 cost time: 0.5084233283996582
Epoch: 6, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.447 Vali Acc: 0.811 Test Loss: 1.447 Test Acc: 0.811
Validation loss decreased (-0.714799 --> -0.811097).  Saving model ...
Epoch: 7 cost time: 0.4849531650543213
Epoch: 7, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.331 Vali Acc: 0.852 Test Loss: 1.331 Test Acc: 0.852
Validation loss decreased (-0.811097 --> -0.851839).  Saving model ...
Epoch: 8 cost time: 0.5336220264434814
Epoch: 8, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.203 Vali Acc: 0.881 Test Loss: 1.203 Test Acc: 0.881
Validation loss decreased (-0.851839 --> -0.881469).  Saving model ...
Epoch: 9 cost time: 0.5233516693115234
Epoch: 9, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.070 Vali Acc: 0.893 Test Loss: 1.070 Test Acc: 0.893
Validation loss decreased (-0.881469 --> -0.892582).  Saving model ...
Epoch: 10 cost time: 0.4768495559692383
Epoch: 10, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.936 Vali Acc: 0.896 Test Loss: 0.936 Test Acc: 0.896
Validation loss decreased (-0.892582 --> -0.896287).  Saving model ...
Epoch: 11 cost time: 0.45972585678100586
Epoch: 11, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.805 Vali Acc: 0.911 Test Loss: 0.805 Test Acc: 0.911
Validation loss decreased (-0.896287 --> -0.911103).  Saving model ...
Epoch: 12 cost time: 0.5190248489379883
Epoch: 12, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.684 Vali Acc: 0.919 Test Loss: 0.684 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918512).  Saving model ...
Epoch: 13 cost time: 0.5025134086608887
Epoch: 13, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.578 Vali Acc: 0.919 Test Loss: 0.578 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.5013713836669922
Epoch: 14, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.485 Vali Acc: 0.922 Test Loss: 0.485 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.5493991374969482
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.410 Vali Acc: 0.926 Test Loss: 0.410 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 16 cost time: 0.48105859756469727
Epoch: 16, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.4876594543457031
Epoch: 17, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.5176949501037598
Epoch: 18, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.4733247756958008
Epoch: 19, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.5761032104492188
Epoch: 20, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.503713846206665
Epoch: 21, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.6305732727050781
Epoch: 22, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.4897031784057617
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.5420088768005371
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4492192268371582
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.4283103942871094
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.4255540370941162
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.43730592727661133
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.4864475727081299
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.5292387008666992
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.45586538314819336
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.4823918342590332
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.4958198070526123
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.46094775199890137
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.5123162269592285
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.49196481704711914
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.555748701095581
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.4654996395111084
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.55013108253479
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5263848304748535
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4239997863769531
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4556620121002197
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4309535026550293
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.44370198249816895
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4514639377593994
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5683941841125488
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5791730880737305
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 2855174
model size : 10.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.79789400100708
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.776 Vali Acc: 0.193 Test Loss: 1.776 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.4741027355194092
Epoch: 2, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.751 Vali Acc: 0.281 Test Loss: 1.751 Test Acc: 0.281
Validation loss decreased (-0.192575 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.4553031921386719
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.719 Vali Acc: 0.370 Test Loss: 1.719 Test Acc: 0.370
Validation loss decreased (-0.281464 --> -0.370353).  Saving model ...
Epoch: 4 cost time: 0.45296239852905273
Epoch: 4, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.667 Vali Acc: 0.500 Test Loss: 1.667 Test Acc: 0.500
Validation loss decreased (-0.370353 --> -0.499983).  Saving model ...
Epoch: 5 cost time: 0.4324359893798828
Epoch: 5, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.599 Vali Acc: 0.585 Test Loss: 1.599 Test Acc: 0.585
Validation loss decreased (-0.499983 --> -0.585169).  Saving model ...
Epoch: 6 cost time: 0.46778011322021484
Epoch: 6, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.517 Vali Acc: 0.704 Test Loss: 1.517 Test Acc: 0.704
Validation loss decreased (-0.585169 --> -0.703689).  Saving model ...
Epoch: 7 cost time: 0.4885828495025635
Epoch: 7, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.422 Vali Acc: 0.785 Test Loss: 1.422 Test Acc: 0.785
Validation loss decreased (-0.703689 --> -0.785171).  Saving model ...
Epoch: 8 cost time: 0.5317437648773193
Epoch: 8, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.317 Vali Acc: 0.848 Test Loss: 1.317 Test Acc: 0.848
Validation loss decreased (-0.785171 --> -0.848135).  Saving model ...
Epoch: 9 cost time: 0.5956594944000244
Epoch: 9, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.206 Vali Acc: 0.859 Test Loss: 1.206 Test Acc: 0.859
Validation loss decreased (-0.848135 --> -0.859247).  Saving model ...
Epoch: 10 cost time: 0.5419225692749023
Epoch: 10, Steps: 2 | Train Loss: 0.857 Vali Loss: 1.087 Vali Acc: 0.896 Test Loss: 1.087 Test Acc: 0.896
Validation loss decreased (-0.859247 --> -0.896285).  Saving model ...
Epoch: 11 cost time: 0.4902043342590332
Epoch: 11, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.967 Vali Acc: 0.926 Test Loss: 0.967 Test Acc: 0.926
Validation loss decreased (-0.896285 --> -0.925916).  Saving model ...
Epoch: 12 cost time: 0.4850142002105713
Epoch: 12, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.849 Vali Acc: 0.926 Test Loss: 0.849 Test Acc: 0.926
Validation loss decreased (-0.925916 --> -0.925917).  Saving model ...
Epoch: 13 cost time: 0.532069206237793
Epoch: 13, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.737 Vali Acc: 0.933 Test Loss: 0.737 Test Acc: 0.933
Validation loss decreased (-0.925917 --> -0.933326).  Saving model ...
Epoch: 14 cost time: 0.5473365783691406
Epoch: 14, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.633 Vali Acc: 0.941 Test Loss: 0.633 Test Acc: 0.941
Validation loss decreased (-0.933326 --> -0.940734).  Saving model ...
Epoch: 15 cost time: 0.48729634284973145
Epoch: 15, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.542 Vali Acc: 0.941 Test Loss: 0.542 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 16 cost time: 0.5072271823883057
Epoch: 16, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.465 Vali Acc: 0.937 Test Loss: 0.465 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.48285388946533203
Epoch: 17, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.402 Vali Acc: 0.941 Test Loss: 0.402 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940737).  Saving model ...
Epoch: 18 cost time: 0.4727973937988281
Epoch: 18, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.351 Vali Acc: 0.944 Test Loss: 0.351 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.4538712501525879
Epoch: 19, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.311 Vali Acc: 0.952 Test Loss: 0.311 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951849).  Saving model ...
Epoch: 20 cost time: 0.5614397525787354
Epoch: 20, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.280 Vali Acc: 0.956 Test Loss: 0.280 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 21 cost time: 0.48402857780456543
Epoch: 21, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 22 cost time: 0.46163034439086914
Epoch: 22, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.237 Vali Acc: 0.956 Test Loss: 0.237 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 23 cost time: 0.6901044845581055
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 24 cost time: 0.4387781620025635
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4812338352203369
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6280875205993652
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.598963737487793
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.49759387969970703
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.49751710891723633
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4925088882446289
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.49167799949645996
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5586748123168945
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.4872622489929199
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2836998
model size : 10.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.916480302810669
Epoch: 1, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.785 Vali Acc: 0.259 Test Loss: 1.785 Test Acc: 0.259
Validation loss decreased (inf --> -0.259241).  Saving model ...
Epoch: 2 cost time: 0.4639463424682617
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.761 Vali Acc: 0.285 Test Loss: 1.761 Test Acc: 0.285
Validation loss decreased (-0.259241 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.5057308673858643
Epoch: 3, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.732 Vali Acc: 0.330 Test Loss: 1.732 Test Acc: 0.330
Validation loss decreased (-0.285168 --> -0.329612).  Saving model ...
Epoch: 4 cost time: 0.5573751926422119
Epoch: 4, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.687 Vali Acc: 0.400 Test Loss: 1.687 Test Acc: 0.400
Validation loss decreased (-0.329612 --> -0.399983).  Saving model ...
Epoch: 5 cost time: 0.47323012351989746
Epoch: 5, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.626 Vali Acc: 0.530 Test Loss: 1.626 Test Acc: 0.530
Validation loss decreased (-0.399983 --> -0.529613).  Saving model ...
Epoch: 6 cost time: 0.45824766159057617
Epoch: 6, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.551 Vali Acc: 0.596 Test Loss: 1.551 Test Acc: 0.596
Validation loss decreased (-0.529613 --> -0.596281).  Saving model ...
Epoch: 7 cost time: 0.4328646659851074
Epoch: 7, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.464 Vali Acc: 0.715 Test Loss: 1.464 Test Acc: 0.715
Validation loss decreased (-0.596281 --> -0.714800).  Saving model ...
Epoch: 8 cost time: 0.4974172115325928
Epoch: 8, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.365 Vali Acc: 0.781 Test Loss: 1.365 Test Acc: 0.781
Validation loss decreased (-0.714800 --> -0.781468).  Saving model ...
Epoch: 9 cost time: 0.6033132076263428
Epoch: 9, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.258 Vali Acc: 0.844 Test Loss: 1.258 Test Acc: 0.844
Validation loss decreased (-0.781468 --> -0.844432).  Saving model ...
Epoch: 10 cost time: 0.5225584506988525
Epoch: 10, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.144 Vali Acc: 0.881 Test Loss: 1.144 Test Acc: 0.881
Validation loss decreased (-0.844432 --> -0.881470).  Saving model ...
Epoch: 11 cost time: 0.5679357051849365
Epoch: 11, Steps: 2 | Train Loss: 0.792 Vali Loss: 1.026 Vali Acc: 0.900 Test Loss: 1.026 Test Acc: 0.900
Validation loss decreased (-0.881470 --> -0.899990).  Saving model ...
Epoch: 12 cost time: 0.560028076171875
Epoch: 12, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.907 Vali Acc: 0.915 Test Loss: 0.907 Test Acc: 0.915
Validation loss decreased (-0.899990 --> -0.914806).  Saving model ...
Epoch: 13 cost time: 0.5227150917053223
Epoch: 13, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.791 Vali Acc: 0.919 Test Loss: 0.791 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918511).  Saving model ...
Epoch: 14 cost time: 0.4758110046386719
Epoch: 14, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.683 Vali Acc: 0.937 Test Loss: 0.683 Test Acc: 0.937
Validation loss decreased (-0.918511 --> -0.937030).  Saving model ...
Epoch: 15 cost time: 0.5676240921020508
Epoch: 15, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.586 Vali Acc: 0.941 Test Loss: 0.586 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940735).  Saving model ...
Epoch: 16 cost time: 0.5021562576293945
Epoch: 16, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.503 Vali Acc: 0.944 Test Loss: 0.503 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 17 cost time: 0.4639565944671631
Epoch: 17, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.434 Vali Acc: 0.944 Test Loss: 0.434 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 18 cost time: 0.5878686904907227
Epoch: 18, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.379 Vali Acc: 0.948 Test Loss: 0.379 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 19 cost time: 0.4884912967681885
Epoch: 19, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 20 cost time: 0.49368929862976074
Epoch: 20, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.300 Vali Acc: 0.948 Test Loss: 0.300 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 21 cost time: 0.46683216094970703
Epoch: 21, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.5623574256896973
Epoch: 22, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 23 cost time: 0.4644660949707031
Epoch: 23, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 24 cost time: 0.5233988761901855
Epoch: 24, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.48265862464904785
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.5465884208679199
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.5981345176696777
Epoch: 27, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.5087723731994629
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.47432684898376465
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.48078370094299316
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.4755733013153076
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.5893216133117676
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 33 cost time: 0.47991061210632324
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 34 cost time: 0.4544534683227539
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.5597002506256104
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959258).  Saving model ...
Epoch: 36 cost time: 0.5079412460327148
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 37 cost time: 0.48178672790527344
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 38 cost time: 0.4582023620605469
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 39 cost time: 0.43897080421447754
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 40 cost time: 0.5042190551757812
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 41 cost time: 0.4932091236114502
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 42 cost time: 0.48926472663879395
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 43 cost time: 0.4883568286895752
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 44 cost time: 0.4708874225616455
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 45 cost time: 0.4668419361114502
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.45634913444519043
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4475669860839844
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.522280216217041
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.46687865257263184
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.48906850814819336
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 2831238
model size : 10.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8308470249176025
Epoch: 1, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.772 Vali Acc: 0.200 Test Loss: 1.772 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.4413182735443115
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.754 Vali Acc: 0.259 Test Loss: 1.754 Test Acc: 0.259
Validation loss decreased (-0.199982 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.4858696460723877
Epoch: 3, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.733 Vali Acc: 0.333 Test Loss: 1.733 Test Acc: 0.333
Validation loss decreased (-0.259242 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.5331342220306396
Epoch: 4, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.700 Vali Acc: 0.452 Test Loss: 1.700 Test Acc: 0.452
Validation loss decreased (-0.333316 --> -0.451835).  Saving model ...
Epoch: 5 cost time: 0.47191286087036133
Epoch: 5, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.653 Vali Acc: 0.563 Test Loss: 1.653 Test Acc: 0.563
Validation loss decreased (-0.451835 --> -0.562946).  Saving model ...
Epoch: 6 cost time: 0.4574260711669922
Epoch: 6, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.596 Vali Acc: 0.630 Test Loss: 1.596 Test Acc: 0.630
Validation loss decreased (-0.562946 --> -0.629614).  Saving model ...
Epoch: 7 cost time: 0.4833979606628418
Epoch: 7, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.527 Vali Acc: 0.667 Test Loss: 1.527 Test Acc: 0.667
Validation loss decreased (-0.629614 --> -0.666651).  Saving model ...
Epoch: 8 cost time: 0.5027680397033691
Epoch: 8, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.449 Vali Acc: 0.722 Test Loss: 1.449 Test Acc: 0.722
Validation loss decreased (-0.666651 --> -0.722208).  Saving model ...
Epoch: 9 cost time: 0.5331151485443115
Epoch: 9, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.362 Vali Acc: 0.767 Test Loss: 1.362 Test Acc: 0.767
Validation loss decreased (-0.722208 --> -0.766653).  Saving model ...
Epoch: 10 cost time: 0.4639260768890381
Epoch: 10, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.267 Vali Acc: 0.793 Test Loss: 1.267 Test Acc: 0.793
Validation loss decreased (-0.766653 --> -0.792580).  Saving model ...
Epoch: 11 cost time: 0.45031237602233887
Epoch: 11, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.170 Vali Acc: 0.826 Test Loss: 1.170 Test Acc: 0.826
Validation loss decreased (-0.792580 --> -0.825914).  Saving model ...
Epoch: 12 cost time: 0.5098073482513428
Epoch: 12, Steps: 2 | Train Loss: 0.819 Vali Loss: 1.071 Vali Acc: 0.878 Test Loss: 1.071 Test Acc: 0.878
Validation loss decreased (-0.825914 --> -0.877767).  Saving model ...
Epoch: 13 cost time: 0.43071937561035156
Epoch: 13, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.971 Vali Acc: 0.889 Test Loss: 0.971 Test Acc: 0.889
Validation loss decreased (-0.877767 --> -0.888879).  Saving model ...
Epoch: 14 cost time: 0.43946123123168945
Epoch: 14, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.873 Vali Acc: 0.904 Test Loss: 0.873 Test Acc: 0.904
Validation loss decreased (-0.888879 --> -0.903695).  Saving model ...
Epoch: 15 cost time: 0.41863059997558594
Epoch: 15, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.781 Vali Acc: 0.911 Test Loss: 0.781 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911103).  Saving model ...
Epoch: 16 cost time: 0.46088123321533203
Epoch: 16, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.696 Vali Acc: 0.922 Test Loss: 0.696 Test Acc: 0.922
Validation loss decreased (-0.911103 --> -0.922215).  Saving model ...
Epoch: 17 cost time: 0.46735548973083496
Epoch: 17, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.618 Vali Acc: 0.930 Test Loss: 0.618 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929623).  Saving model ...
Epoch: 18 cost time: 0.43352675437927246
Epoch: 18, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.550 Vali Acc: 0.937 Test Loss: 0.550 Test Acc: 0.937
Validation loss decreased (-0.929623 --> -0.937032).  Saving model ...
Epoch: 19 cost time: 0.4586968421936035
Epoch: 19, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.491 Vali Acc: 0.937 Test Loss: 0.491 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 20 cost time: 0.456498384475708
Epoch: 20, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.441 Vali Acc: 0.941 Test Loss: 0.441 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 21 cost time: 0.43721938133239746
Epoch: 21, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.400 Vali Acc: 0.941 Test Loss: 0.400 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 22 cost time: 0.4253346920013428
Epoch: 22, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.366 Vali Acc: 0.944 Test Loss: 0.366 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.4751851558685303
Epoch: 23, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.338 Vali Acc: 0.944 Test Loss: 0.338 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.5009174346923828
Epoch: 24, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.314 Vali Acc: 0.948 Test Loss: 0.314 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 25 cost time: 0.5275654792785645
Epoch: 25, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.294 Vali Acc: 0.948 Test Loss: 0.294 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 26 cost time: 0.5196068286895752
Epoch: 26, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.43102121353149414
Epoch: 27, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.4936215877532959
Epoch: 28, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.4206855297088623
Epoch: 29, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.4703640937805176
Epoch: 30, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.48901844024658203
Epoch: 31, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.40903306007385254
Epoch: 32, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.42397093772888184
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.46288323402404785
Epoch: 34, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.4744701385498047
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.458280086517334
Epoch: 36, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.4559140205383301
Epoch: 37, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.4800698757171631
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.45976781845092773
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.541954517364502
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.49190258979797363
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.45435428619384766
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.44513726234436035
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.5703749656677246
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.5424983501434326
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.47165942192077637
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.4595515727996826
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.5213596820831299
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.45551276206970215
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.533560037612915
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2819334
model size : 10.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8636183738708496
Epoch: 1, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.774 Vali Acc: 0.285 Test Loss: 1.774 Test Acc: 0.285
Validation loss decreased (inf --> -0.285167).  Saving model ...
Epoch: 2 cost time: 0.43600964546203613
Epoch: 2, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.758 Vali Acc: 0.307 Test Loss: 1.758 Test Acc: 0.307
Validation loss decreased (-0.285167 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.4069657325744629
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.739 Vali Acc: 0.341 Test Loss: 1.739 Test Acc: 0.341
Validation loss decreased (-0.307390 --> -0.340723).  Saving model ...
Epoch: 4 cost time: 0.49910950660705566
Epoch: 4, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.708 Vali Acc: 0.422 Test Loss: 1.708 Test Acc: 0.422
Validation loss decreased (-0.340723 --> -0.422205).  Saving model ...
Epoch: 5 cost time: 0.4239816665649414
Epoch: 5, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.665 Vali Acc: 0.519 Test Loss: 1.665 Test Acc: 0.519
Validation loss decreased (-0.422205 --> -0.518502).  Saving model ...
Epoch: 6 cost time: 0.5025546550750732
Epoch: 6, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.611 Vali Acc: 0.700 Test Loss: 1.611 Test Acc: 0.700
Validation loss decreased (-0.518502 --> -0.699984).  Saving model ...
Epoch: 7 cost time: 0.41388368606567383
Epoch: 7, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.547 Vali Acc: 0.748 Test Loss: 1.547 Test Acc: 0.748
Validation loss decreased (-0.699984 --> -0.748133).  Saving model ...
Epoch: 8 cost time: 0.47566771507263184
Epoch: 8, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.473 Vali Acc: 0.815 Test Loss: 1.473 Test Acc: 0.815
Validation loss decreased (-0.748133 --> -0.814800).  Saving model ...
Epoch: 9 cost time: 0.43328094482421875
Epoch: 9, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.391 Vali Acc: 0.844 Test Loss: 1.391 Test Acc: 0.844
Validation loss decreased (-0.814800 --> -0.844431).  Saving model ...
Epoch: 10 cost time: 0.4785153865814209
Epoch: 10, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.303 Vali Acc: 0.859 Test Loss: 1.303 Test Acc: 0.859
Validation loss decreased (-0.844431 --> -0.859246).  Saving model ...
Epoch: 11 cost time: 0.4289071559906006
Epoch: 11, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.210 Vali Acc: 0.881 Test Loss: 1.210 Test Acc: 0.881
Validation loss decreased (-0.859246 --> -0.881469).  Saving model ...
Epoch: 12 cost time: 0.4567127227783203
Epoch: 12, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.113 Vali Acc: 0.896 Test Loss: 1.113 Test Acc: 0.896
Validation loss decreased (-0.881469 --> -0.896285).  Saving model ...
Epoch: 13 cost time: 0.4409911632537842
Epoch: 13, Steps: 2 | Train Loss: 0.747 Vali Loss: 1.013 Vali Acc: 0.907 Test Loss: 1.013 Test Acc: 0.907
Validation loss decreased (-0.896285 --> -0.907397).  Saving model ...
Epoch: 14 cost time: 0.4513111114501953
Epoch: 14, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.915 Vali Acc: 0.915 Test Loss: 0.915 Test Acc: 0.915
Validation loss decreased (-0.907397 --> -0.914806).  Saving model ...
Epoch: 15 cost time: 0.5270092487335205
Epoch: 15, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.822 Vali Acc: 0.915 Test Loss: 0.822 Test Acc: 0.915
Validation loss decreased (-0.914806 --> -0.914807).  Saving model ...
Epoch: 16 cost time: 0.4759976863861084
Epoch: 16, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.733 Vali Acc: 0.919 Test Loss: 0.733 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 17 cost time: 0.4566073417663574
Epoch: 17, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.654 Vali Acc: 0.930 Test Loss: 0.654 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929623).  Saving model ...
Epoch: 18 cost time: 0.4367251396179199
Epoch: 18, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.583 Vali Acc: 0.933 Test Loss: 0.583 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933328).  Saving model ...
Epoch: 19 cost time: 0.4296743869781494
Epoch: 19, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.522 Vali Acc: 0.933 Test Loss: 0.522 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 20 cost time: 0.4617917537689209
Epoch: 20, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.470 Vali Acc: 0.933 Test Loss: 0.470 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 21 cost time: 0.456923246383667
Epoch: 21, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.426 Vali Acc: 0.941 Test Loss: 0.426 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940736).  Saving model ...
Epoch: 22 cost time: 0.46550822257995605
Epoch: 22, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.389 Vali Acc: 0.941 Test Loss: 0.389 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.4592757225036621
Epoch: 23, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.44004011154174805
Epoch: 24, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.332 Vali Acc: 0.944 Test Loss: 0.332 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 0.43747401237487793
Epoch: 25, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 0.41698598861694336
Epoch: 26, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.5387516021728516
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.274 Vali Acc: 0.956 Test Loss: 0.274 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.4633333683013916
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.260 Vali Acc: 0.959 Test Loss: 0.260 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.5101757049560547
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.249 Vali Acc: 0.959 Test Loss: 0.249 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.489849328994751
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.4490838050842285
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5100409984588623
Epoch: 32, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4961123466491699
Epoch: 33, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5020856857299805
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4662175178527832
Epoch: 35, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4479048252105713
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4594879150390625
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.4998025894165039
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.612307071685791
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.42658209800720215
Epoch: 40, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 2813702
model size : 10.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6920106410980225
Epoch: 1, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.781 Vali Acc: 0.263 Test Loss: 1.781 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.42808032035827637
Epoch: 2, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.741 Vali Acc: 0.333 Test Loss: 1.741 Test Acc: 0.333
Validation loss decreased (-0.262945 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.43419718742370605
Epoch: 3, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.692 Vali Acc: 0.411 Test Loss: 1.692 Test Acc: 0.411
Validation loss decreased (-0.333316 --> -0.411094).  Saving model ...
Epoch: 4 cost time: 0.433025598526001
Epoch: 4, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.610 Vali Acc: 0.537 Test Loss: 1.610 Test Acc: 0.537
Validation loss decreased (-0.411094 --> -0.537021).  Saving model ...
Epoch: 5 cost time: 0.4404582977294922
Epoch: 5, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.503 Vali Acc: 0.667 Test Loss: 1.503 Test Acc: 0.667
Validation loss decreased (-0.537021 --> -0.666652).  Saving model ...
Epoch: 6 cost time: 0.3991234302520752
Epoch: 6, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.378 Vali Acc: 0.785 Test Loss: 1.378 Test Acc: 0.785
Validation loss decreased (-0.666652 --> -0.785171).  Saving model ...
Epoch: 7 cost time: 0.3968667984008789
Epoch: 7, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.239 Vali Acc: 0.852 Test Loss: 1.239 Test Acc: 0.852
Validation loss decreased (-0.785171 --> -0.851839).  Saving model ...
Epoch: 8 cost time: 0.46898865699768066
Epoch: 8, Steps: 2 | Train Loss: 0.908 Vali Loss: 1.095 Vali Acc: 0.893 Test Loss: 1.095 Test Acc: 0.893
Validation loss decreased (-0.851839 --> -0.892582).  Saving model ...
Epoch: 9 cost time: 0.4062061309814453
Epoch: 9, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.952 Vali Acc: 0.907 Test Loss: 0.952 Test Acc: 0.907
Validation loss decreased (-0.892582 --> -0.907398).  Saving model ...
Epoch: 10 cost time: 0.3907160758972168
Epoch: 10, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.814 Vali Acc: 0.922 Test Loss: 0.814 Test Acc: 0.922
Validation loss decreased (-0.907398 --> -0.922214).  Saving model ...
Epoch: 11 cost time: 0.388979434967041
Epoch: 11, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.689 Vali Acc: 0.907 Test Loss: 0.689 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.42864060401916504
Epoch: 12, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.576 Vali Acc: 0.915 Test Loss: 0.576 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.37810683250427246
Epoch: 13, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.480 Vali Acc: 0.922 Test Loss: 0.480 Test Acc: 0.922
Validation loss decreased (-0.922214 --> -0.922217).  Saving model ...
Epoch: 14 cost time: 0.3401942253112793
Epoch: 14, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.399 Vali Acc: 0.922 Test Loss: 0.399 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 15 cost time: 0.3388528823852539
Epoch: 15, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 16 cost time: 0.3753540515899658
Epoch: 16, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.39772605895996094
Epoch: 17, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.386124849319458
Epoch: 18, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.31826186180114746
Epoch: 19, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 20 cost time: 0.41866183280944824
Epoch: 20, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.929628 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.42557644844055176
Epoch: 21, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.4621315002441406
Epoch: 22, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 23 cost time: 0.4063847064971924
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 24 cost time: 0.4280517101287842
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 0.4543008804321289
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 0.4282207489013672
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.154 Vali Acc: 0.952 Test Loss: 0.154 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.42162013053894043
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4536008834838867
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4513387680053711
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.420032262802124
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.952 Test Loss: 0.151 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4955596923828125
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.952 Test Loss: 0.151 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.47311854362487793
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.952 Test Loss: 0.151 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4303607940673828
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.952 Test Loss: 0.151 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4271101951599121
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4016299247741699
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.952 Test Loss: 0.152 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 823238
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.583160638809204
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.778 Vali Acc: 0.244 Test Loss: 1.778 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.40541696548461914
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.750 Vali Acc: 0.322 Test Loss: 1.750 Test Acc: 0.322
Validation loss decreased (-0.244427 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 0.4470653533935547
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.720 Vali Acc: 0.374 Test Loss: 1.720 Test Acc: 0.374
Validation loss decreased (-0.322205 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.4176309108734131
Epoch: 4, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.676 Vali Acc: 0.437 Test Loss: 1.676 Test Acc: 0.437
Validation loss decreased (-0.374057 --> -0.437020).  Saving model ...
Epoch: 5 cost time: 0.40895962715148926
Epoch: 5, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.618 Vali Acc: 0.578 Test Loss: 1.618 Test Acc: 0.578
Validation loss decreased (-0.437020 --> -0.577762).  Saving model ...
Epoch: 6 cost time: 0.42165207862854004
Epoch: 6, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.547 Vali Acc: 0.681 Test Loss: 1.547 Test Acc: 0.681
Validation loss decreased (-0.577762 --> -0.681466).  Saving model ...
Epoch: 7 cost time: 0.4060966968536377
Epoch: 7, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.465 Vali Acc: 0.726 Test Loss: 1.465 Test Acc: 0.726
Validation loss decreased (-0.681466 --> -0.725911).  Saving model ...
Epoch: 8 cost time: 0.4974520206451416
Epoch: 8, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.371 Vali Acc: 0.756 Test Loss: 1.371 Test Acc: 0.756
Validation loss decreased (-0.725911 --> -0.755542).  Saving model ...
Epoch: 9 cost time: 0.3905162811279297
Epoch: 9, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.271 Vali Acc: 0.793 Test Loss: 1.271 Test Acc: 0.793
Validation loss decreased (-0.755542 --> -0.792580).  Saving model ...
Epoch: 10 cost time: 0.38726019859313965
Epoch: 10, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.164 Vali Acc: 0.863 Test Loss: 1.164 Test Acc: 0.863
Validation loss decreased (-0.792580 --> -0.862951).  Saving model ...
Epoch: 11 cost time: 0.36853981018066406
Epoch: 11, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.055 Vali Acc: 0.889 Test Loss: 1.055 Test Acc: 0.889
Validation loss decreased (-0.862951 --> -0.888878).  Saving model ...
Epoch: 12 cost time: 0.36048221588134766
Epoch: 12, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.947 Vali Acc: 0.915 Test Loss: 0.947 Test Acc: 0.915
Validation loss decreased (-0.888878 --> -0.914805).  Saving model ...
Epoch: 13 cost time: 0.39087748527526855
Epoch: 13, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.843 Vali Acc: 0.930 Test Loss: 0.843 Test Acc: 0.930
Validation loss decreased (-0.914805 --> -0.929621).  Saving model ...
Epoch: 14 cost time: 0.4146132469177246
Epoch: 14, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.745 Vali Acc: 0.926 Test Loss: 0.745 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3871283531188965
Epoch: 15, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.655 Vali Acc: 0.922 Test Loss: 0.655 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.42969179153442383
Epoch: 16, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.575 Vali Acc: 0.930 Test Loss: 0.575 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929624).  Saving model ...
Epoch: 17 cost time: 0.3817441463470459
Epoch: 17, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.504 Vali Acc: 0.930 Test Loss: 0.504 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 0.388232946395874
Epoch: 18, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.446 Vali Acc: 0.933 Test Loss: 0.446 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 19 cost time: 0.39597606658935547
Epoch: 19, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.397 Vali Acc: 0.933 Test Loss: 0.397 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 20 cost time: 0.4217183589935303
Epoch: 20, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.358 Vali Acc: 0.933 Test Loss: 0.358 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 0.3614234924316406
Epoch: 21, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.40299296379089355
Epoch: 22, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 0.40515828132629395
Epoch: 23, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.422046422958374
Epoch: 24, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.37071824073791504
Epoch: 25, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.4912986755371094
Epoch: 26, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.417804479598999
Epoch: 27, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.44992566108703613
Epoch: 28, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.4293041229248047
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.38114261627197266
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.39699530601501465
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.40030360221862793
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.4404897689819336
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.41854071617126465
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.4650559425354004
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.43570375442504883
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.40963196754455566
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.43689513206481934
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 39 cost time: 0.4464442729949951
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.40311455726623535
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.43497729301452637
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.4163839817047119
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.39775729179382324
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.42804503440856934
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.41125941276550293
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.5080289840698242
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.4250202178955078
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.41452765464782715
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.4162924289703369
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.4397461414337158
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 771142
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5275166034698486
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.811 Vali Acc: 0.026 Test Loss: 1.811 Test Acc: 0.026
Validation loss decreased (inf --> -0.025908).  Saving model ...
Epoch: 2 cost time: 0.40650010108947754
Epoch: 2, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.787 Vali Acc: 0.085 Test Loss: 1.787 Test Acc: 0.085
Validation loss decreased (-0.025908 --> -0.085167).  Saving model ...
Epoch: 3 cost time: 0.4076108932495117
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.763 Vali Acc: 0.133 Test Loss: 1.763 Test Acc: 0.133
Validation loss decreased (-0.085167 --> -0.133316).  Saving model ...
Epoch: 4 cost time: 0.3749885559082031
Epoch: 4, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.730 Vali Acc: 0.274 Test Loss: 1.730 Test Acc: 0.274
Validation loss decreased (-0.133316 --> -0.274057).  Saving model ...
Epoch: 5 cost time: 0.39939332008361816
Epoch: 5, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.685 Vali Acc: 0.411 Test Loss: 1.685 Test Acc: 0.411
Validation loss decreased (-0.274057 --> -0.411094).  Saving model ...
Epoch: 6 cost time: 0.4739532470703125
Epoch: 6, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.630 Vali Acc: 0.493 Test Loss: 1.630 Test Acc: 0.493
Validation loss decreased (-0.411094 --> -0.492576).  Saving model ...
Epoch: 7 cost time: 0.46404337882995605
Epoch: 7, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.567 Vali Acc: 0.559 Test Loss: 1.567 Test Acc: 0.559
Validation loss decreased (-0.492576 --> -0.559244).  Saving model ...
Epoch: 8 cost time: 0.41385459899902344
Epoch: 8, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.496 Vali Acc: 0.652 Test Loss: 1.496 Test Acc: 0.652
Validation loss decreased (-0.559244 --> -0.651837).  Saving model ...
Epoch: 9 cost time: 0.44968509674072266
Epoch: 9, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.419 Vali Acc: 0.722 Test Loss: 1.419 Test Acc: 0.722
Validation loss decreased (-0.651837 --> -0.722208).  Saving model ...
Epoch: 10 cost time: 0.43253278732299805
Epoch: 10, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.336 Vali Acc: 0.767 Test Loss: 1.336 Test Acc: 0.767
Validation loss decreased (-0.722208 --> -0.766653).  Saving model ...
Epoch: 11 cost time: 0.40403008460998535
Epoch: 11, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.247 Vali Acc: 0.822 Test Loss: 1.247 Test Acc: 0.822
Validation loss decreased (-0.766653 --> -0.822210).  Saving model ...
Epoch: 12 cost time: 0.3960683345794678
Epoch: 12, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.154 Vali Acc: 0.837 Test Loss: 1.154 Test Acc: 0.837
Validation loss decreased (-0.822210 --> -0.837025).  Saving model ...
Epoch: 13 cost time: 0.37946557998657227
Epoch: 13, Steps: 2 | Train Loss: 0.847 Vali Loss: 1.059 Vali Acc: 0.863 Test Loss: 1.059 Test Acc: 0.863
Validation loss decreased (-0.837025 --> -0.862952).  Saving model ...
Epoch: 14 cost time: 0.4114418029785156
Epoch: 14, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.964 Vali Acc: 0.900 Test Loss: 0.964 Test Acc: 0.900
Validation loss decreased (-0.862952 --> -0.899990).  Saving model ...
Epoch: 15 cost time: 0.48954081535339355
Epoch: 15, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.871 Vali Acc: 0.911 Test Loss: 0.871 Test Acc: 0.911
Validation loss decreased (-0.899990 --> -0.911102).  Saving model ...
Epoch: 16 cost time: 0.42406702041625977
Epoch: 16, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.782 Vali Acc: 0.919 Test Loss: 0.782 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918511).  Saving model ...
Epoch: 17 cost time: 0.4259471893310547
Epoch: 17, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.697 Vali Acc: 0.926 Test Loss: 0.697 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 18 cost time: 0.5214099884033203
Epoch: 18, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.620 Vali Acc: 0.922 Test Loss: 0.620 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.46761655807495117
Epoch: 19, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.550 Vali Acc: 0.926 Test Loss: 0.550 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925920).  Saving model ...
Epoch: 20 cost time: 0.40546679496765137
Epoch: 20, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.489 Vali Acc: 0.926 Test Loss: 0.489 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 21 cost time: 0.48988890647888184
Epoch: 21, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.437 Vali Acc: 0.930 Test Loss: 0.437 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 22 cost time: 0.4246208667755127
Epoch: 22, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.929625 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.4101569652557373
Epoch: 23, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.355 Vali Acc: 0.941 Test Loss: 0.355 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 24 cost time: 0.52347731590271
Epoch: 24, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 0.4435431957244873
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 0.4474642276763916
Epoch: 26, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.5181882381439209
Epoch: 27, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4880640506744385
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.4468576908111572
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.4825587272644043
Epoch: 30, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.46149420738220215
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.47901439666748047
Epoch: 32, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.43154215812683105
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.4242076873779297
Epoch: 34, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.5056097507476807
Epoch: 35, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4338953495025635
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4071922302246094
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.437237024307251
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.40467166900634766
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4061920642852783
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.3855736255645752
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5097532272338867
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.49793052673339844
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.41596198081970215
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 755846
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7715165615081787
Epoch: 1, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.766 Vali Acc: 0.296 Test Loss: 1.766 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.43300724029541016
Epoch: 2, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.749 Vali Acc: 0.344 Test Loss: 1.749 Test Acc: 0.344
Validation loss decreased (-0.296279 --> -0.344427).  Saving model ...
Epoch: 3 cost time: 0.4081711769104004
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.731 Vali Acc: 0.378 Test Loss: 1.731 Test Acc: 0.378
Validation loss decreased (-0.344427 --> -0.377760).  Saving model ...
Epoch: 4 cost time: 0.3980600833892822
Epoch: 4, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.707 Vali Acc: 0.452 Test Loss: 1.707 Test Acc: 0.452
Validation loss decreased (-0.377760 --> -0.451835).  Saving model ...
Epoch: 5 cost time: 0.4456768035888672
Epoch: 5, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.676 Vali Acc: 0.496 Test Loss: 1.676 Test Acc: 0.496
Validation loss decreased (-0.451835 --> -0.496280).  Saving model ...
Epoch: 6 cost time: 0.42512083053588867
Epoch: 6, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.637 Vali Acc: 0.552 Test Loss: 1.637 Test Acc: 0.552
Validation loss decreased (-0.496280 --> -0.551835).  Saving model ...
Epoch: 7 cost time: 0.4450092315673828
Epoch: 7, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.590 Vali Acc: 0.596 Test Loss: 1.590 Test Acc: 0.596
Validation loss decreased (-0.551835 --> -0.596280).  Saving model ...
Epoch: 8 cost time: 0.42888855934143066
Epoch: 8, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.536 Vali Acc: 0.663 Test Loss: 1.536 Test Acc: 0.663
Validation loss decreased (-0.596280 --> -0.662948).  Saving model ...
Epoch: 9 cost time: 0.4248480796813965
Epoch: 9, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.475 Vali Acc: 0.722 Test Loss: 1.475 Test Acc: 0.722
Validation loss decreased (-0.662948 --> -0.722207).  Saving model ...
Epoch: 10 cost time: 0.4032104015350342
Epoch: 10, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.408 Vali Acc: 0.785 Test Loss: 1.408 Test Acc: 0.785
Validation loss decreased (-0.722207 --> -0.785171).  Saving model ...
Epoch: 11 cost time: 0.42695164680480957
Epoch: 11, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.336 Vali Acc: 0.819 Test Loss: 1.336 Test Acc: 0.819
Validation loss decreased (-0.785171 --> -0.818505).  Saving model ...
Epoch: 12 cost time: 0.43544840812683105
Epoch: 12, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.258 Vali Acc: 0.841 Test Loss: 1.258 Test Acc: 0.841
Validation loss decreased (-0.818505 --> -0.840728).  Saving model ...
Epoch: 13 cost time: 0.42735719680786133
Epoch: 13, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.176 Vali Acc: 0.852 Test Loss: 1.176 Test Acc: 0.852
Validation loss decreased (-0.840728 --> -0.851840).  Saving model ...
Epoch: 14 cost time: 0.4345877170562744
Epoch: 14, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.092 Vali Acc: 0.874 Test Loss: 1.092 Test Acc: 0.874
Validation loss decreased (-0.851840 --> -0.874063).  Saving model ...
Epoch: 15 cost time: 0.4276144504547119
Epoch: 15, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.007 Vali Acc: 0.896 Test Loss: 1.007 Test Acc: 0.896
Validation loss decreased (-0.874063 --> -0.896286).  Saving model ...
Epoch: 16 cost time: 0.39653897285461426
Epoch: 16, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.923 Vali Acc: 0.930 Test Loss: 0.923 Test Acc: 0.930
Validation loss decreased (-0.896286 --> -0.929620).  Saving model ...
Epoch: 17 cost time: 0.4488108158111572
Epoch: 17, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.840 Vali Acc: 0.926 Test Loss: 0.840 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4260377883911133
Epoch: 18, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.761 Vali Acc: 0.926 Test Loss: 0.761 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.44632673263549805
Epoch: 19, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.687 Vali Acc: 0.930 Test Loss: 0.687 Test Acc: 0.930
Validation loss decreased (-0.929620 --> -0.929623).  Saving model ...
Epoch: 20 cost time: 0.4162170886993408
Epoch: 20, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.619 Vali Acc: 0.930 Test Loss: 0.619 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 21 cost time: 0.4257957935333252
Epoch: 21, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.558 Vali Acc: 0.941 Test Loss: 0.558 Test Acc: 0.941
Validation loss decreased (-0.929623 --> -0.940735).  Saving model ...
Epoch: 22 cost time: 0.5399067401885986
Epoch: 22, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.504 Vali Acc: 0.941 Test Loss: 0.504 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 23 cost time: 0.4284818172454834
Epoch: 23, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.458 Vali Acc: 0.937 Test Loss: 0.458 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4642143249511719
Epoch: 24, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.418 Vali Acc: 0.941 Test Loss: 0.418 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 25 cost time: 0.41060352325439453
Epoch: 25, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.383 Vali Acc: 0.948 Test Loss: 0.383 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948144).  Saving model ...
Epoch: 26 cost time: 0.3932993412017822
Epoch: 26, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.354 Vali Acc: 0.948 Test Loss: 0.354 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.3892970085144043
Epoch: 27, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.330 Vali Acc: 0.948 Test Loss: 0.330 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.3998146057128906
Epoch: 28, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.309 Vali Acc: 0.948 Test Loss: 0.309 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 29 cost time: 0.3978433609008789
Epoch: 29, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.292 Vali Acc: 0.948 Test Loss: 0.292 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 30 cost time: 0.5469794273376465
Epoch: 30, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 31 cost time: 0.4529860019683838
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.44301581382751465
Epoch: 32, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.4264190196990967
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.43483471870422363
Epoch: 34, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.43584203720092773
Epoch: 35, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.4120829105377197
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.41083693504333496
Epoch: 37, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.4677581787109375
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.606156587600708
Epoch: 39, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.5734643936157227
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.6478118896484375
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.510251522064209
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.5453493595123291
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.4989030361175537
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.5898780822753906
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.5536048412322998
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.5210781097412109
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.5909249782562256
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.54899001121521
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.5465676784515381
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 746758
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7548871040344238
Epoch: 1, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.698 Vali Acc: 0.548 Test Loss: 1.698 Test Acc: 0.548
Validation loss decreased (inf --> -0.548131).  Saving model ...
Epoch: 2 cost time: 0.3904852867126465
Epoch: 2, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.680 Vali Acc: 0.574 Test Loss: 1.680 Test Acc: 0.574
Validation loss decreased (-0.548131 --> -0.574057).  Saving model ...
Epoch: 3 cost time: 0.40613698959350586
Epoch: 3, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.662 Vali Acc: 0.596 Test Loss: 1.662 Test Acc: 0.596
Validation loss decreased (-0.574057 --> -0.596280).  Saving model ...
Epoch: 4 cost time: 0.400221586227417
Epoch: 4, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.640 Vali Acc: 0.615 Test Loss: 1.640 Test Acc: 0.615
Validation loss decreased (-0.596280 --> -0.614798).  Saving model ...
Epoch: 5 cost time: 0.4180152416229248
Epoch: 5, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.611 Vali Acc: 0.637 Test Loss: 1.611 Test Acc: 0.637
Validation loss decreased (-0.614798 --> -0.637021).  Saving model ...
Epoch: 6 cost time: 0.39970898628234863
Epoch: 6, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.575 Vali Acc: 0.659 Test Loss: 1.575 Test Acc: 0.659
Validation loss decreased (-0.637021 --> -0.659244).  Saving model ...
Epoch: 7 cost time: 0.44428467750549316
Epoch: 7, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.533 Vali Acc: 0.681 Test Loss: 1.533 Test Acc: 0.681
Validation loss decreased (-0.659244 --> -0.681466).  Saving model ...
Epoch: 8 cost time: 0.3927323818206787
Epoch: 8, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.486 Vali Acc: 0.711 Test Loss: 1.486 Test Acc: 0.711
Validation loss decreased (-0.681466 --> -0.711096).  Saving model ...
Epoch: 9 cost time: 0.38601136207580566
Epoch: 9, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.433 Vali Acc: 0.752 Test Loss: 1.433 Test Acc: 0.752
Validation loss decreased (-0.711096 --> -0.751838).  Saving model ...
Epoch: 10 cost time: 0.41737866401672363
Epoch: 10, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.375 Vali Acc: 0.763 Test Loss: 1.375 Test Acc: 0.763
Validation loss decreased (-0.751838 --> -0.762949).  Saving model ...
Epoch: 11 cost time: 0.39600133895874023
Epoch: 11, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.312 Vali Acc: 0.785 Test Loss: 1.312 Test Acc: 0.785
Validation loss decreased (-0.762949 --> -0.785172).  Saving model ...
Epoch: 12 cost time: 0.4667534828186035
Epoch: 12, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.244 Vali Acc: 0.815 Test Loss: 1.244 Test Acc: 0.815
Validation loss decreased (-0.785172 --> -0.814802).  Saving model ...
Epoch: 13 cost time: 0.42490339279174805
Epoch: 13, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.174 Vali Acc: 0.833 Test Loss: 1.174 Test Acc: 0.833
Validation loss decreased (-0.814802 --> -0.833322).  Saving model ...
Epoch: 14 cost time: 0.45501017570495605
Epoch: 14, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.101 Vali Acc: 0.859 Test Loss: 1.101 Test Acc: 0.859
Validation loss decreased (-0.833322 --> -0.859248).  Saving model ...
Epoch: 15 cost time: 0.39356541633605957
Epoch: 15, Steps: 2 | Train Loss: 0.848 Vali Loss: 1.026 Vali Acc: 0.870 Test Loss: 1.026 Test Acc: 0.870
Validation loss decreased (-0.859248 --> -0.870360).  Saving model ...
Epoch: 16 cost time: 0.3953094482421875
Epoch: 16, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.951 Vali Acc: 0.889 Test Loss: 0.951 Test Acc: 0.889
Validation loss decreased (-0.870360 --> -0.888879).  Saving model ...
Epoch: 17 cost time: 0.40042877197265625
Epoch: 17, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.877 Vali Acc: 0.904 Test Loss: 0.877 Test Acc: 0.904
Validation loss decreased (-0.888879 --> -0.903695).  Saving model ...
Epoch: 18 cost time: 0.39077186584472656
Epoch: 18, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.805 Vali Acc: 0.904 Test Loss: 0.805 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903696).  Saving model ...
Epoch: 19 cost time: 0.40256285667419434
Epoch: 19, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.736 Vali Acc: 0.911 Test Loss: 0.736 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 20 cost time: 0.40527796745300293
Epoch: 20, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.672 Vali Acc: 0.915 Test Loss: 0.672 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 21 cost time: 0.4193544387817383
Epoch: 21, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.614 Vali Acc: 0.919 Test Loss: 0.614 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 22 cost time: 0.39310479164123535
Epoch: 22, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 23 cost time: 0.39823126792907715
Epoch: 23, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.515 Vali Acc: 0.933 Test Loss: 0.515 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933328).  Saving model ...
Epoch: 24 cost time: 0.38538670539855957
Epoch: 24, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
Validation loss decreased (-0.933328 --> -0.944440).  Saving model ...
Epoch: 25 cost time: 0.36801934242248535
Epoch: 25, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.437 Vali Acc: 0.941 Test Loss: 0.437 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.36696505546569824
Epoch: 26, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.405 Vali Acc: 0.941 Test Loss: 0.405 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.375119686126709
Epoch: 27, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.37381768226623535
Epoch: 28, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.40972375869750977
Epoch: 29, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4091618061065674
Epoch: 30, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 31 cost time: 0.3946051597595215
Epoch: 31, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.4850897789001465
Epoch: 32, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.281 Vali Acc: 0.948 Test Loss: 0.281 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.41722536087036133
Epoch: 33, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 34 cost time: 0.41330528259277344
Epoch: 34, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.43045473098754883
Epoch: 35, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.248 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.42171406745910645
Epoch: 36, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.43732261657714844
Epoch: 37, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.518373966217041
Epoch: 38, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.40593481063842773
Epoch: 39, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.47403740882873535
Epoch: 40, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.952 Test Loss: 0.215 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.4208860397338867
Epoch: 41, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.42876720428466797
Epoch: 42, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.49416446685791016
Epoch: 43, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.4283716678619385
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.46188926696777344
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.3970777988433838
Epoch: 46, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.4746994972229004
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.46234679222106934
Epoch: 48, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.43129444122314453
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.44301819801330566
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 743878
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6901397705078125
Epoch: 1, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.785 Vali Acc: 0.170 Test Loss: 1.785 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.4079132080078125
Epoch: 2, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.767 Vali Acc: 0.207 Test Loss: 1.767 Test Acc: 0.207
Validation loss decreased (-0.170353 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.41112375259399414
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.750 Vali Acc: 0.219 Test Loss: 1.750 Test Acc: 0.219
Validation loss decreased (-0.207390 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.417222261428833
Epoch: 4, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.730 Vali Acc: 0.259 Test Loss: 1.730 Test Acc: 0.259
Validation loss decreased (-0.218501 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.4198036193847656
Epoch: 5, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.704 Vali Acc: 0.337 Test Loss: 1.704 Test Acc: 0.337
Validation loss decreased (-0.259242 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.4921565055847168
Epoch: 6, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.672 Vali Acc: 0.433 Test Loss: 1.672 Test Acc: 0.433
Validation loss decreased (-0.337020 --> -0.433317).  Saving model ...
Epoch: 7 cost time: 0.3879125118255615
Epoch: 7, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.635 Vali Acc: 0.556 Test Loss: 1.635 Test Acc: 0.556
Validation loss decreased (-0.433317 --> -0.555539).  Saving model ...
Epoch: 8 cost time: 0.44556379318237305
Epoch: 8, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.593 Vali Acc: 0.637 Test Loss: 1.593 Test Acc: 0.637
Validation loss decreased (-0.555539 --> -0.637021).  Saving model ...
Epoch: 9 cost time: 0.44887590408325195
Epoch: 9, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.547 Vali Acc: 0.696 Test Loss: 1.547 Test Acc: 0.696
Validation loss decreased (-0.637021 --> -0.696281).  Saving model ...
Epoch: 10 cost time: 0.3971576690673828
Epoch: 10, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.496 Vali Acc: 0.737 Test Loss: 1.496 Test Acc: 0.737
Validation loss decreased (-0.696281 --> -0.737022).  Saving model ...
Epoch: 11 cost time: 0.4082517623901367
Epoch: 11, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.441 Vali Acc: 0.778 Test Loss: 1.441 Test Acc: 0.778
Validation loss decreased (-0.737022 --> -0.777763).  Saving model ...
Epoch: 12 cost time: 0.42085766792297363
Epoch: 12, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.382 Vali Acc: 0.800 Test Loss: 1.382 Test Acc: 0.800
Validation loss decreased (-0.777763 --> -0.799986).  Saving model ...
Epoch: 13 cost time: 0.4135706424713135
Epoch: 13, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.319 Vali Acc: 0.833 Test Loss: 1.319 Test Acc: 0.833
Validation loss decreased (-0.799986 --> -0.833320).  Saving model ...
Epoch: 14 cost time: 0.43567490577697754
Epoch: 14, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.253 Vali Acc: 0.867 Test Loss: 1.253 Test Acc: 0.867
Validation loss decreased (-0.833320 --> -0.866654).  Saving model ...
Epoch: 15 cost time: 0.4225597381591797
Epoch: 15, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.185 Vali Acc: 0.878 Test Loss: 1.185 Test Acc: 0.878
Validation loss decreased (-0.866654 --> -0.877766).  Saving model ...
Epoch: 16 cost time: 0.4379551410675049
Epoch: 16, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.116 Vali Acc: 0.885 Test Loss: 1.116 Test Acc: 0.885
Validation loss decreased (-0.877766 --> -0.885174).  Saving model ...
Epoch: 17 cost time: 0.4558601379394531
Epoch: 17, Steps: 2 | Train Loss: 0.836 Vali Loss: 1.045 Vali Acc: 0.893 Test Loss: 1.045 Test Acc: 0.893
Validation loss decreased (-0.885174 --> -0.892582).  Saving model ...
Epoch: 18 cost time: 0.5007791519165039
Epoch: 18, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.975 Vali Acc: 0.900 Test Loss: 0.975 Test Acc: 0.900
Validation loss decreased (-0.892582 --> -0.899990).  Saving model ...
Epoch: 19 cost time: 0.4206876754760742
Epoch: 19, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.906 Vali Acc: 0.904 Test Loss: 0.906 Test Acc: 0.904
Validation loss decreased (-0.899990 --> -0.903695).  Saving model ...
Epoch: 20 cost time: 0.43537020683288574
Epoch: 20, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.841 Vali Acc: 0.911 Test Loss: 0.841 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911103).  Saving model ...
Epoch: 21 cost time: 0.42341017723083496
Epoch: 21, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.778 Vali Acc: 0.919 Test Loss: 0.778 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918511).  Saving model ...
Epoch: 22 cost time: 0.46970486640930176
Epoch: 22, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.720 Vali Acc: 0.919 Test Loss: 0.720 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 23 cost time: 0.4331073760986328
Epoch: 23, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.666 Vali Acc: 0.919 Test Loss: 0.666 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918512).  Saving model ...
Epoch: 24 cost time: 0.4404311180114746
Epoch: 24, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.617 Vali Acc: 0.919 Test Loss: 0.617 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 25 cost time: 0.5652763843536377
Epoch: 25, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.573 Vali Acc: 0.922 Test Loss: 0.573 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 26 cost time: 0.4193155765533447
Epoch: 26, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.534 Vali Acc: 0.933 Test Loss: 0.534 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 27 cost time: 0.5656018257141113
Epoch: 27, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.499 Vali Acc: 0.933 Test Loss: 0.499 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 28 cost time: 0.4559786319732666
Epoch: 28, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.467 Vali Acc: 0.933 Test Loss: 0.467 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 29 cost time: 0.4025864601135254
Epoch: 29, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.440 Vali Acc: 0.933 Test Loss: 0.440 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 0.4380824565887451
Epoch: 30, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.415 Vali Acc: 0.937 Test Loss: 0.415 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 31 cost time: 0.5173187255859375
Epoch: 31, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 32 cost time: 0.41597795486450195
Epoch: 32, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.375 Vali Acc: 0.937 Test Loss: 0.375 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 33 cost time: 0.44026732444763184
Epoch: 33, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.359 Vali Acc: 0.937 Test Loss: 0.359 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 34 cost time: 0.4412250518798828
Epoch: 34, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.4450643062591553
Epoch: 35, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.330 Vali Acc: 0.941 Test Loss: 0.330 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.4217846393585205
Epoch: 36, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.42102909088134766
Epoch: 37, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.307 Vali Acc: 0.948 Test Loss: 0.307 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.4825327396392822
Epoch: 38, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.297 Vali Acc: 0.948 Test Loss: 0.297 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 39 cost time: 0.46884965896606445
Epoch: 39, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 40 cost time: 0.44370484352111816
Epoch: 40, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 41 cost time: 0.445706844329834
Epoch: 41, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 42 cost time: 0.4034261703491211
Epoch: 42, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 43 cost time: 0.5340452194213867
Epoch: 43, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.4366888999938965
Epoch: 44, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.4139857292175293
Epoch: 45, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.43064188957214355
Epoch: 46, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.540175199508667
Epoch: 47, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.43931150436401367
Epoch: 48, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.45024752616882324
Epoch: 49, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.42386531829833984
Epoch: 50, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 737926
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7891857624053955
Epoch: 1, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.781 Vali Acc: 0.100 Test Loss: 1.781 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 0.48878979682922363
Epoch: 2, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.766 Vali Acc: 0.119 Test Loss: 1.766 Test Acc: 0.119
Validation loss decreased (-0.099982 --> -0.118501).  Saving model ...
Epoch: 3 cost time: 0.4519500732421875
Epoch: 3, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.752 Vali Acc: 0.144 Test Loss: 1.752 Test Acc: 0.144
Validation loss decreased (-0.118501 --> -0.144427).  Saving model ...
Epoch: 4 cost time: 0.4536440372467041
Epoch: 4, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.735 Vali Acc: 0.185 Test Loss: 1.735 Test Acc: 0.185
Validation loss decreased (-0.144427 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.48099422454833984
Epoch: 5, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.713 Vali Acc: 0.259 Test Loss: 1.713 Test Acc: 0.259
Validation loss decreased (-0.185168 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.42983436584472656
Epoch: 6, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.685 Vali Acc: 0.367 Test Loss: 1.685 Test Acc: 0.367
Validation loss decreased (-0.259242 --> -0.366650).  Saving model ...
Epoch: 7 cost time: 0.4380910396575928
Epoch: 7, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.653 Vali Acc: 0.463 Test Loss: 1.653 Test Acc: 0.463
Validation loss decreased (-0.366650 --> -0.462946).  Saving model ...
Epoch: 8 cost time: 0.4654250144958496
Epoch: 8, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.615 Vali Acc: 0.515 Test Loss: 1.615 Test Acc: 0.515
Validation loss decreased (-0.462946 --> -0.514799).  Saving model ...
Epoch: 9 cost time: 0.44559168815612793
Epoch: 9, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.572 Vali Acc: 0.585 Test Loss: 1.572 Test Acc: 0.585
Validation loss decreased (-0.514799 --> -0.585169).  Saving model ...
Epoch: 10 cost time: 0.516873836517334
Epoch: 10, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.526 Vali Acc: 0.641 Test Loss: 1.526 Test Acc: 0.641
Validation loss decreased (-0.585169 --> -0.640725).  Saving model ...
Epoch: 11 cost time: 0.4929661750793457
Epoch: 11, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.476 Vali Acc: 0.696 Test Loss: 1.476 Test Acc: 0.696
Validation loss decreased (-0.640725 --> -0.696282).  Saving model ...
Epoch: 12 cost time: 0.4033477306365967
Epoch: 12, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.422 Vali Acc: 0.741 Test Loss: 1.422 Test Acc: 0.741
Validation loss decreased (-0.696282 --> -0.740727).  Saving model ...
Epoch: 13 cost time: 0.4909706115722656
Epoch: 13, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.366 Vali Acc: 0.767 Test Loss: 1.366 Test Acc: 0.767
Validation loss decreased (-0.740727 --> -0.766653).  Saving model ...
Epoch: 14 cost time: 0.5559334754943848
Epoch: 14, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.307 Vali Acc: 0.819 Test Loss: 1.307 Test Acc: 0.819
Validation loss decreased (-0.766653 --> -0.818505).  Saving model ...
Epoch: 15 cost time: 0.4831962585449219
Epoch: 15, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.246 Vali Acc: 0.852 Test Loss: 1.246 Test Acc: 0.852
Validation loss decreased (-0.818505 --> -0.851839).  Saving model ...
Epoch: 16 cost time: 0.5060536861419678
Epoch: 16, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.183 Vali Acc: 0.874 Test Loss: 1.183 Test Acc: 0.874
Validation loss decreased (-0.851839 --> -0.874062).  Saving model ...
Epoch: 17 cost time: 0.4084494113922119
Epoch: 17, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.118 Vali Acc: 0.904 Test Loss: 1.118 Test Acc: 0.904
Validation loss decreased (-0.874062 --> -0.903693).  Saving model ...
Epoch: 18 cost time: 0.4503450393676758
Epoch: 18, Steps: 2 | Train Loss: 0.867 Vali Loss: 1.054 Vali Acc: 0.911 Test Loss: 1.054 Test Acc: 0.911
Validation loss decreased (-0.903693 --> -0.911101).  Saving model ...
Epoch: 19 cost time: 0.48750758171081543
Epoch: 19, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.990 Vali Acc: 0.915 Test Loss: 0.990 Test Acc: 0.915
Validation loss decreased (-0.911101 --> -0.914805).  Saving model ...
Epoch: 20 cost time: 0.47313404083251953
Epoch: 20, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.927 Vali Acc: 0.922 Test Loss: 0.927 Test Acc: 0.922
Validation loss decreased (-0.914805 --> -0.922213).  Saving model ...
Epoch: 21 cost time: 0.45199108123779297
Epoch: 21, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.867 Vali Acc: 0.933 Test Loss: 0.867 Test Acc: 0.933
Validation loss decreased (-0.922213 --> -0.933325).  Saving model ...
Epoch: 22 cost time: 0.4209249019622803
Epoch: 22, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.810 Vali Acc: 0.933 Test Loss: 0.810 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933325).  Saving model ...
Epoch: 23 cost time: 0.42160892486572266
Epoch: 23, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.756 Vali Acc: 0.933 Test Loss: 0.756 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933326).  Saving model ...
Epoch: 24 cost time: 0.4160444736480713
Epoch: 24, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.705 Vali Acc: 0.933 Test Loss: 0.705 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933326).  Saving model ...
Epoch: 25 cost time: 0.4237329959869385
Epoch: 25, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.659 Vali Acc: 0.933 Test Loss: 0.659 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933327).  Saving model ...
Epoch: 26 cost time: 0.4482901096343994
Epoch: 26, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.616 Vali Acc: 0.933 Test Loss: 0.616 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 27 cost time: 0.4602539539337158
Epoch: 27, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.576 Vali Acc: 0.937 Test Loss: 0.576 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 28 cost time: 0.4545586109161377
Epoch: 28, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.540 Vali Acc: 0.944 Test Loss: 0.540 Test Acc: 0.944
Validation loss decreased (-0.937031 --> -0.944439).  Saving model ...
Epoch: 29 cost time: 0.47481560707092285
Epoch: 29, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.508 Vali Acc: 0.937 Test Loss: 0.508 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.39380669593811035
Epoch: 30, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.478 Vali Acc: 0.944 Test Loss: 0.478 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 31 cost time: 0.42631006240844727
Epoch: 31, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.452 Vali Acc: 0.941 Test Loss: 0.452 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4628567695617676
Epoch: 32, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.427 Vali Acc: 0.944 Test Loss: 0.427 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 33 cost time: 0.463456392288208
Epoch: 33, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.406 Vali Acc: 0.944 Test Loss: 0.406 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 34 cost time: 0.42808008193969727
Epoch: 34, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.385 Vali Acc: 0.948 Test Loss: 0.385 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 35 cost time: 0.4362947940826416
Epoch: 35, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.367 Vali Acc: 0.948 Test Loss: 0.367 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 36 cost time: 0.4421095848083496
Epoch: 36, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 37 cost time: 0.4701504707336426
Epoch: 37, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.336 Vali Acc: 0.948 Test Loss: 0.336 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.4212179183959961
Epoch: 38, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.322 Vali Acc: 0.952 Test Loss: 0.322 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.4324839115142822
Epoch: 39, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.4899139404296875
Epoch: 40, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.299 Vali Acc: 0.956 Test Loss: 0.299 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.5250475406646729
Epoch: 41, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.290 Vali Acc: 0.956 Test Loss: 0.290 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.41596555709838867
Epoch: 42, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.4137566089630127
Epoch: 43, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.274 Vali Acc: 0.959 Test Loss: 0.274 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.44359421730041504
Epoch: 44, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.267 Vali Acc: 0.959 Test Loss: 0.267 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.4576451778411865
Epoch: 45, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.260 Vali Acc: 0.963 Test Loss: 0.260 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962960).  Saving model ...
Epoch: 46 cost time: 0.48670530319213867
Epoch: 46, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.254 Vali Acc: 0.963 Test Loss: 0.254 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 47 cost time: 0.4724271297454834
Epoch: 47, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.249 Vali Acc: 0.963 Test Loss: 0.249 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 48 cost time: 0.45565080642700195
Epoch: 48, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.244 Vali Acc: 0.963 Test Loss: 0.244 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962961).  Saving model ...
Epoch: 49 cost time: 0.42889904975891113
Epoch: 49, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.963 Test Loss: 0.240 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 50 cost time: 0.42147350311279297
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.963 Test Loss: 0.235 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 735110
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5475878715515137
Epoch: 1, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.736 Vali Acc: 0.367 Test Loss: 1.736 Test Acc: 0.367
Validation loss decreased (inf --> -0.366649).  Saving model ...
Epoch: 2 cost time: 0.40663719177246094
Epoch: 2, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.705 Vali Acc: 0.407 Test Loss: 1.705 Test Acc: 0.407
Validation loss decreased (-0.366649 --> -0.407390).  Saving model ...
Epoch: 3 cost time: 0.39000487327575684
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.674 Vali Acc: 0.485 Test Loss: 1.674 Test Acc: 0.485
Validation loss decreased (-0.407390 --> -0.485168).  Saving model ...
Epoch: 4 cost time: 0.42855000495910645
Epoch: 4, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.632 Vali Acc: 0.563 Test Loss: 1.632 Test Acc: 0.563
Validation loss decreased (-0.485168 --> -0.562947).  Saving model ...
Epoch: 5 cost time: 0.5141592025756836
Epoch: 5, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.576 Vali Acc: 0.652 Test Loss: 1.576 Test Acc: 0.652
Validation loss decreased (-0.562947 --> -0.651836).  Saving model ...
Epoch: 6 cost time: 0.39351558685302734
Epoch: 6, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.510 Vali Acc: 0.770 Test Loss: 1.510 Test Acc: 0.770
Validation loss decreased (-0.651836 --> -0.770355).  Saving model ...
Epoch: 7 cost time: 0.40456581115722656
Epoch: 7, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.436 Vali Acc: 0.848 Test Loss: 1.436 Test Acc: 0.848
Validation loss decreased (-0.770355 --> -0.848134).  Saving model ...
Epoch: 8 cost time: 0.3851008415222168
Epoch: 8, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.354 Vali Acc: 0.874 Test Loss: 1.354 Test Acc: 0.874
Validation loss decreased (-0.848134 --> -0.874061).  Saving model ...
Epoch: 9 cost time: 0.45270204544067383
Epoch: 9, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.266 Vali Acc: 0.885 Test Loss: 1.266 Test Acc: 0.885
Validation loss decreased (-0.874061 --> -0.885173).  Saving model ...
Epoch: 10 cost time: 0.42142724990844727
Epoch: 10, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.172 Vali Acc: 0.900 Test Loss: 1.172 Test Acc: 0.900
Validation loss decreased (-0.885173 --> -0.899988).  Saving model ...
Epoch: 11 cost time: 0.49500393867492676
Epoch: 11, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.075 Vali Acc: 0.919 Test Loss: 1.075 Test Acc: 0.919
Validation loss decreased (-0.899988 --> -0.918508).  Saving model ...
Epoch: 12 cost time: 0.46448373794555664
Epoch: 12, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.977 Vali Acc: 0.922 Test Loss: 0.977 Test Acc: 0.922
Validation loss decreased (-0.918508 --> -0.922212).  Saving model ...
Epoch: 13 cost time: 0.37215518951416016
Epoch: 13, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.881 Vali Acc: 0.926 Test Loss: 0.881 Test Acc: 0.926
Validation loss decreased (-0.922212 --> -0.925917).  Saving model ...
Epoch: 14 cost time: 0.43490171432495117
Epoch: 14, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.788 Vali Acc: 0.933 Test Loss: 0.788 Test Acc: 0.933
Validation loss decreased (-0.925917 --> -0.933325).  Saving model ...
Epoch: 15 cost time: 0.5042510032653809
Epoch: 15, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.701 Vali Acc: 0.937 Test Loss: 0.701 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937030).  Saving model ...
Epoch: 16 cost time: 0.4164893627166748
Epoch: 16, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.621 Vali Acc: 0.933 Test Loss: 0.621 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4096040725708008
Epoch: 17, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.549 Vali Acc: 0.944 Test Loss: 0.549 Test Acc: 0.944
Validation loss decreased (-0.937030 --> -0.944439).  Saving model ...
Epoch: 18 cost time: 0.37403059005737305
Epoch: 18, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.485 Vali Acc: 0.948 Test Loss: 0.485 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 19 cost time: 0.36925697326660156
Epoch: 19, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.430 Vali Acc: 0.948 Test Loss: 0.430 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 20 cost time: 0.3996407985687256
Epoch: 20, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.383 Vali Acc: 0.948 Test Loss: 0.383 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 21 cost time: 0.4094266891479492
Epoch: 21, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4545300006866455
Epoch: 22, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.311 Vali Acc: 0.948 Test Loss: 0.311 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 23 cost time: 0.434370756149292
Epoch: 23, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.4052295684814453
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.4583470821380615
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.47440648078918457
Epoch: 26, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.402677059173584
Epoch: 27, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.4432704448699951
Epoch: 28, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.43907737731933594
Epoch: 29, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.4462618827819824
Epoch: 30, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.44289064407348633
Epoch: 31, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.3915708065032959
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.48654747009277344
Epoch: 33, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.4151947498321533
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.41762208938598633
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 36 cost time: 0.3992302417755127
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 37 cost time: 0.40561652183532715
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 38 cost time: 0.42093443870544434
Epoch: 38, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 39 cost time: 0.38436031341552734
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 40 cost time: 0.42754101753234863
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959258).  Saving model ...
Epoch: 41 cost time: 0.4358479976654053
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 42 cost time: 0.4307258129119873
Epoch: 42, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 43 cost time: 0.424299955368042
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 44 cost time: 0.4214022159576416
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 45 cost time: 0.5088319778442383
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 46 cost time: 0.4204287528991699
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 47 cost time: 0.42901086807250977
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 48 cost time: 0.38787150382995605
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 49 cost time: 0.47133421897888184
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 50 cost time: 0.43496131896972656
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 243686
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8149209022521973
Epoch: 1, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.816 Vali Acc: 0.152 Test Loss: 1.816 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 0.46028947830200195
Epoch: 2, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.793 Vali Acc: 0.204 Test Loss: 1.793 Test Acc: 0.204
Validation loss decreased (-0.151834 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.49895143508911133
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.771 Vali Acc: 0.267 Test Loss: 1.771 Test Acc: 0.267
Validation loss decreased (-0.203686 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.43079686164855957
Epoch: 4, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.746 Vali Acc: 0.307 Test Loss: 1.746 Test Acc: 0.307
Validation loss decreased (-0.266649 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.4221832752227783
Epoch: 5, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.713 Vali Acc: 0.359 Test Loss: 1.713 Test Acc: 0.359
Validation loss decreased (-0.307390 --> -0.359242).  Saving model ...
Epoch: 6 cost time: 0.42005181312561035
Epoch: 6, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.673 Vali Acc: 0.448 Test Loss: 1.673 Test Acc: 0.448
Validation loss decreased (-0.359242 --> -0.448131).  Saving model ...
Epoch: 7 cost time: 0.4498422145843506
Epoch: 7, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.627 Vali Acc: 0.556 Test Loss: 1.627 Test Acc: 0.556
Validation loss decreased (-0.448131 --> -0.555539).  Saving model ...
Epoch: 8 cost time: 0.47667551040649414
Epoch: 8, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.574 Vali Acc: 0.637 Test Loss: 1.574 Test Acc: 0.637
Validation loss decreased (-0.555539 --> -0.637021).  Saving model ...
Epoch: 9 cost time: 0.3936913013458252
Epoch: 9, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.516 Vali Acc: 0.685 Test Loss: 1.516 Test Acc: 0.685
Validation loss decreased (-0.637021 --> -0.685170).  Saving model ...
Epoch: 10 cost time: 0.4335634708404541
Epoch: 10, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.453 Vali Acc: 0.744 Test Loss: 1.453 Test Acc: 0.744
Validation loss decreased (-0.685170 --> -0.744430).  Saving model ...
Epoch: 11 cost time: 0.4963865280151367
Epoch: 11, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.385 Vali Acc: 0.774 Test Loss: 1.385 Test Acc: 0.774
Validation loss decreased (-0.744430 --> -0.774060).  Saving model ...
Epoch: 12 cost time: 0.45554494857788086
Epoch: 12, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.313 Vali Acc: 0.804 Test Loss: 1.313 Test Acc: 0.804
Validation loss decreased (-0.774060 --> -0.803691).  Saving model ...
Epoch: 13 cost time: 0.4066283702850342
Epoch: 13, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.239 Vali Acc: 0.833 Test Loss: 1.239 Test Acc: 0.833
Validation loss decreased (-0.803691 --> -0.833321).  Saving model ...
Epoch: 14 cost time: 0.49077939987182617
Epoch: 14, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.163 Vali Acc: 0.852 Test Loss: 1.163 Test Acc: 0.852
Validation loss decreased (-0.833321 --> -0.851840).  Saving model ...
Epoch: 15 cost time: 0.5595669746398926
Epoch: 15, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.085 Vali Acc: 0.874 Test Loss: 1.085 Test Acc: 0.874
Validation loss decreased (-0.851840 --> -0.874063).  Saving model ...
Epoch: 16 cost time: 0.5455489158630371
Epoch: 16, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.006 Vali Acc: 0.881 Test Loss: 1.006 Test Acc: 0.881
Validation loss decreased (-0.874063 --> -0.881471).  Saving model ...
Epoch: 17 cost time: 0.5159037113189697
Epoch: 17, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.929 Vali Acc: 0.893 Test Loss: 0.929 Test Acc: 0.893
Validation loss decreased (-0.881471 --> -0.892583).  Saving model ...
Epoch: 18 cost time: 0.5394730567932129
Epoch: 18, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.855 Vali Acc: 0.900 Test Loss: 0.855 Test Acc: 0.900
Validation loss decreased (-0.892583 --> -0.899991).  Saving model ...
Epoch: 19 cost time: 0.5586669445037842
Epoch: 19, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.783 Vali Acc: 0.904 Test Loss: 0.783 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903696).  Saving model ...
Epoch: 20 cost time: 0.4931771755218506
Epoch: 20, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.716 Vali Acc: 0.900 Test Loss: 0.716 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5179557800292969
Epoch: 21, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.654 Vali Acc: 0.904 Test Loss: 0.654 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 22 cost time: 0.5312144756317139
Epoch: 22, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.597 Vali Acc: 0.911 Test Loss: 0.597 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.482250452041626
Epoch: 23, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.546 Vali Acc: 0.915 Test Loss: 0.546 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 24 cost time: 0.44233274459838867
Epoch: 24, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.502 Vali Acc: 0.919 Test Loss: 0.502 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.49692296981811523
Epoch: 25, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.463 Vali Acc: 0.919 Test Loss: 0.463 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 26 cost time: 0.4762692451477051
Epoch: 26, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 27 cost time: 0.48391103744506836
Epoch: 27, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.401 Vali Acc: 0.919 Test Loss: 0.401 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 28 cost time: 0.5194511413574219
Epoch: 28, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.376 Vali Acc: 0.922 Test Loss: 0.376 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 0.47704124450683594
Epoch: 29, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.49155426025390625
Epoch: 30, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.4982314109802246
Epoch: 31, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.4878098964691162
Epoch: 32, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.4973726272583008
Epoch: 33, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.5137600898742676
Epoch: 34, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.4685814380645752
Epoch: 35, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.5494329929351807
Epoch: 36, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5370626449584961
Epoch: 37, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.5586833953857422
Epoch: 38, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.46903443336486816
Epoch: 39, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.48597168922424316
Epoch: 40, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.46326422691345215
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.4543123245239258
Epoch: 42, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.550889253616333
Epoch: 43, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.5114428997039795
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.5194432735443115
Epoch: 45, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.49002981185913086
Epoch: 46, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.4755222797393799
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.46171021461486816
Epoch: 48, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 0.5057172775268555
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.5144960880279541
Epoch: 50, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 217638
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7631158828735352
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.799 Vali Acc: 0.152 Test Loss: 1.799 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 0.40029263496398926
Epoch: 2, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.782 Vali Acc: 0.178 Test Loss: 1.782 Test Acc: 0.178
Validation loss decreased (-0.151834 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.4949789047241211
Epoch: 3, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.768 Vali Acc: 0.189 Test Loss: 1.768 Test Acc: 0.189
Validation loss decreased (-0.177760 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 0.4733462333679199
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.752 Vali Acc: 0.200 Test Loss: 1.752 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 0.4106285572052002
Epoch: 5, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.731 Vali Acc: 0.222 Test Loss: 1.731 Test Acc: 0.222
Validation loss decreased (-0.199982 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 0.41691040992736816
Epoch: 6, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.705 Vali Acc: 0.259 Test Loss: 1.705 Test Acc: 0.259
Validation loss decreased (-0.222205 --> -0.259242).  Saving model ...
Epoch: 7 cost time: 0.4805114269256592
Epoch: 7, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.674 Vali Acc: 0.341 Test Loss: 1.674 Test Acc: 0.341
Validation loss decreased (-0.259242 --> -0.340724).  Saving model ...
Epoch: 8 cost time: 0.393390417098999
Epoch: 8, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.638 Vali Acc: 0.411 Test Loss: 1.638 Test Acc: 0.411
Validation loss decreased (-0.340724 --> -0.411095).  Saving model ...
Epoch: 9 cost time: 0.40007519721984863
Epoch: 9, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.598 Vali Acc: 0.552 Test Loss: 1.598 Test Acc: 0.552
Validation loss decreased (-0.411095 --> -0.551836).  Saving model ...
Epoch: 10 cost time: 0.3760843276977539
Epoch: 10, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.554 Vali Acc: 0.633 Test Loss: 1.554 Test Acc: 0.633
Validation loss decreased (-0.551836 --> -0.633318).  Saving model ...
Epoch: 11 cost time: 0.41611266136169434
Epoch: 11, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.505 Vali Acc: 0.674 Test Loss: 1.505 Test Acc: 0.674
Validation loss decreased (-0.633318 --> -0.674059).  Saving model ...
Epoch: 12 cost time: 0.4054279327392578
Epoch: 12, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.453 Vali Acc: 0.711 Test Loss: 1.453 Test Acc: 0.711
Validation loss decreased (-0.674059 --> -0.711097).  Saving model ...
Epoch: 13 cost time: 0.4059619903564453
Epoch: 13, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.398 Vali Acc: 0.759 Test Loss: 1.398 Test Acc: 0.759
Validation loss decreased (-0.711097 --> -0.759245).  Saving model ...
Epoch: 14 cost time: 0.38626956939697266
Epoch: 14, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.339 Vali Acc: 0.796 Test Loss: 1.339 Test Acc: 0.796
Validation loss decreased (-0.759245 --> -0.796283).  Saving model ...
Epoch: 15 cost time: 0.4389655590057373
Epoch: 15, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.277 Vali Acc: 0.830 Test Loss: 1.277 Test Acc: 0.830
Validation loss decreased (-0.796283 --> -0.829617).  Saving model ...
Epoch: 16 cost time: 0.4259941577911377
Epoch: 16, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.214 Vali Acc: 0.848 Test Loss: 1.214 Test Acc: 0.848
Validation loss decreased (-0.829617 --> -0.848136).  Saving model ...
Epoch: 17 cost time: 0.45270848274230957
Epoch: 17, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.150 Vali Acc: 0.863 Test Loss: 1.150 Test Acc: 0.863
Validation loss decreased (-0.848136 --> -0.862951).  Saving model ...
Epoch: 18 cost time: 0.41370177268981934
Epoch: 18, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.086 Vali Acc: 0.878 Test Loss: 1.086 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877767).  Saving model ...
Epoch: 19 cost time: 0.37601399421691895
Epoch: 19, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.022 Vali Acc: 0.881 Test Loss: 1.022 Test Acc: 0.881
Validation loss decreased (-0.877767 --> -0.881471).  Saving model ...
Epoch: 20 cost time: 0.38686060905456543
Epoch: 20, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.959 Vali Acc: 0.885 Test Loss: 0.959 Test Acc: 0.885
Validation loss decreased (-0.881471 --> -0.885176).  Saving model ...
Epoch: 21 cost time: 0.419189453125
Epoch: 21, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.897 Vali Acc: 0.889 Test Loss: 0.897 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 22 cost time: 0.36694979667663574
Epoch: 22, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.836 Vali Acc: 0.896 Test Loss: 0.836 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 23 cost time: 0.3982858657836914
Epoch: 23, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.779 Vali Acc: 0.900 Test Loss: 0.779 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899992).  Saving model ...
Epoch: 24 cost time: 0.3901975154876709
Epoch: 24, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.724 Vali Acc: 0.904 Test Loss: 0.724 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 25 cost time: 0.36246776580810547
Epoch: 25, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.673 Vali Acc: 0.915 Test Loss: 0.673 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 26 cost time: 0.43334317207336426
Epoch: 26, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.626 Vali Acc: 0.926 Test Loss: 0.626 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 27 cost time: 0.3727588653564453
Epoch: 27, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.583 Vali Acc: 0.926 Test Loss: 0.583 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 28 cost time: 0.3904116153717041
Epoch: 28, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.544 Vali Acc: 0.926 Test Loss: 0.544 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 29 cost time: 0.46594667434692383
Epoch: 29, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.508 Vali Acc: 0.930 Test Loss: 0.508 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929625).  Saving model ...
Epoch: 30 cost time: 0.42171144485473633
Epoch: 30, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.476 Vali Acc: 0.933 Test Loss: 0.476 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 31 cost time: 0.38333749771118164
Epoch: 31, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.447 Vali Acc: 0.937 Test Loss: 0.447 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 32 cost time: 0.40159058570861816
Epoch: 32, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.421 Vali Acc: 0.941 Test Loss: 0.421 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 33 cost time: 0.4261291027069092
Epoch: 33, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.398 Vali Acc: 0.941 Test Loss: 0.398 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 34 cost time: 0.4503295421600342
Epoch: 34, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.38671135902404785
Epoch: 35, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.46870875358581543
Epoch: 36, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.341 Vali Acc: 0.944 Test Loss: 0.341 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.41249704360961914
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.4359464645385742
Epoch: 38, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.39787793159484863
Epoch: 39, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.40868616104125977
Epoch: 40, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4565412998199463
Epoch: 41, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.437572717666626
Epoch: 42, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 43 cost time: 0.48279905319213867
Epoch: 43, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 44 cost time: 0.4015493392944336
Epoch: 44, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.4462320804595947
Epoch: 45, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.4386301040649414
Epoch: 46, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.38500165939331055
Epoch: 47, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.40877532958984375
Epoch: 48, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.3890395164489746
Epoch: 49, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.406876802444458
Epoch: 50, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 209990
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.703601360321045
Epoch: 1, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.763 Vali Acc: 0.226 Test Loss: 1.763 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.39598894119262695
Epoch: 2, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.748 Vali Acc: 0.263 Test Loss: 1.748 Test Acc: 0.263
Validation loss decreased (-0.225908 --> -0.262945).  Saving model ...
Epoch: 3 cost time: 0.37499570846557617
Epoch: 3, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.736 Vali Acc: 0.304 Test Loss: 1.736 Test Acc: 0.304
Validation loss decreased (-0.262945 --> -0.303686).  Saving model ...
Epoch: 4 cost time: 0.4229543209075928
Epoch: 4, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.722 Vali Acc: 0.330 Test Loss: 1.722 Test Acc: 0.330
Validation loss decreased (-0.303686 --> -0.329612).  Saving model ...
Epoch: 5 cost time: 0.39733219146728516
Epoch: 5, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.705 Vali Acc: 0.385 Test Loss: 1.705 Test Acc: 0.385
Validation loss decreased (-0.329612 --> -0.385168).  Saving model ...
Epoch: 6 cost time: 0.38393616676330566
Epoch: 6, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.683 Vali Acc: 0.437 Test Loss: 1.683 Test Acc: 0.437
Validation loss decreased (-0.385168 --> -0.437020).  Saving model ...
Epoch: 7 cost time: 0.3653378486633301
Epoch: 7, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.657 Vali Acc: 0.474 Test Loss: 1.657 Test Acc: 0.474
Validation loss decreased (-0.437020 --> -0.474058).  Saving model ...
Epoch: 8 cost time: 0.37462520599365234
Epoch: 8, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.627 Vali Acc: 0.500 Test Loss: 1.627 Test Acc: 0.500
Validation loss decreased (-0.474058 --> -0.499984).  Saving model ...
Epoch: 9 cost time: 0.37943077087402344
Epoch: 9, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.594 Vali Acc: 0.544 Test Loss: 1.594 Test Acc: 0.544
Validation loss decreased (-0.499984 --> -0.544429).  Saving model ...
Epoch: 10 cost time: 0.40897560119628906
Epoch: 10, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.558 Vali Acc: 0.567 Test Loss: 1.558 Test Acc: 0.567
Validation loss decreased (-0.544429 --> -0.566651).  Saving model ...
Epoch: 11 cost time: 0.4293344020843506
Epoch: 11, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.519 Vali Acc: 0.581 Test Loss: 1.519 Test Acc: 0.581
Validation loss decreased (-0.566651 --> -0.581466).  Saving model ...
Epoch: 12 cost time: 0.405719518661499
Epoch: 12, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.477 Vali Acc: 0.622 Test Loss: 1.477 Test Acc: 0.622
Validation loss decreased (-0.581466 --> -0.622207).  Saving model ...
Epoch: 13 cost time: 0.38814496994018555
Epoch: 13, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.431 Vali Acc: 0.652 Test Loss: 1.431 Test Acc: 0.652
Validation loss decreased (-0.622207 --> -0.651838).  Saving model ...
Epoch: 14 cost time: 0.39425015449523926
Epoch: 14, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.383 Vali Acc: 0.681 Test Loss: 1.383 Test Acc: 0.681
Validation loss decreased (-0.651838 --> -0.681468).  Saving model ...
Epoch: 15 cost time: 0.37563347816467285
Epoch: 15, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.333 Vali Acc: 0.726 Test Loss: 1.333 Test Acc: 0.726
Validation loss decreased (-0.681468 --> -0.725913).  Saving model ...
Epoch: 16 cost time: 0.4053456783294678
Epoch: 16, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.281 Vali Acc: 0.756 Test Loss: 1.281 Test Acc: 0.756
Validation loss decreased (-0.725913 --> -0.755543).  Saving model ...
Epoch: 17 cost time: 0.3478128910064697
Epoch: 17, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.228 Vali Acc: 0.789 Test Loss: 1.228 Test Acc: 0.789
Validation loss decreased (-0.755543 --> -0.788877).  Saving model ...
Epoch: 18 cost time: 0.4471104145050049
Epoch: 18, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.175 Vali Acc: 0.807 Test Loss: 1.175 Test Acc: 0.807
Validation loss decreased (-0.788877 --> -0.807396).  Saving model ...
Epoch: 19 cost time: 0.38559651374816895
Epoch: 19, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.121 Vali Acc: 0.822 Test Loss: 1.121 Test Acc: 0.822
Validation loss decreased (-0.807396 --> -0.822211).  Saving model ...
Epoch: 20 cost time: 0.39534950256347656
Epoch: 20, Steps: 2 | Train Loss: 0.888 Vali Loss: 1.067 Vali Acc: 0.837 Test Loss: 1.067 Test Acc: 0.837
Validation loss decreased (-0.822211 --> -0.837026).  Saving model ...
Epoch: 21 cost time: 0.38687634468078613
Epoch: 21, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.012 Vali Acc: 0.852 Test Loss: 1.012 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851842).  Saving model ...
Epoch: 22 cost time: 0.4071369171142578
Epoch: 22, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.959 Vali Acc: 0.863 Test Loss: 0.959 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 23 cost time: 0.39048075675964355
Epoch: 23, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.908 Vali Acc: 0.870 Test Loss: 0.908 Test Acc: 0.870
Validation loss decreased (-0.862953 --> -0.870361).  Saving model ...
Epoch: 24 cost time: 0.37755560874938965
Epoch: 24, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.859 Vali Acc: 0.878 Test Loss: 0.859 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 25 cost time: 0.3643355369567871
Epoch: 25, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.811 Vali Acc: 0.878 Test Loss: 0.811 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 26 cost time: 0.3841376304626465
Epoch: 26, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.765 Vali Acc: 0.893 Test Loss: 0.765 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892585).  Saving model ...
Epoch: 27 cost time: 0.37070322036743164
Epoch: 27, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.722 Vali Acc: 0.904 Test Loss: 0.722 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903696).  Saving model ...
Epoch: 28 cost time: 0.38437938690185547
Epoch: 28, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.682 Vali Acc: 0.911 Test Loss: 0.682 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 29 cost time: 0.3771023750305176
Epoch: 29, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.643 Vali Acc: 0.919 Test Loss: 0.643 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 30 cost time: 0.3827993869781494
Epoch: 30, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.608 Vali Acc: 0.922 Test Loss: 0.608 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 31 cost time: 0.37415003776550293
Epoch: 31, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.575 Vali Acc: 0.922 Test Loss: 0.575 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 32 cost time: 0.35333704948425293
Epoch: 32, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.545 Vali Acc: 0.922 Test Loss: 0.545 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 33 cost time: 0.37376856803894043
Epoch: 33, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.517 Vali Acc: 0.922 Test Loss: 0.517 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 34 cost time: 0.3969757556915283
Epoch: 34, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.492 Vali Acc: 0.922 Test Loss: 0.492 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 35 cost time: 0.4041783809661865
Epoch: 35, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.469 Vali Acc: 0.930 Test Loss: 0.469 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 36 cost time: 0.3810296058654785
Epoch: 36, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.448 Vali Acc: 0.937 Test Loss: 0.448 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.3834953308105469
Epoch: 37, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.428 Vali Acc: 0.937 Test Loss: 0.428 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.37045931816101074
Epoch: 38, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.411 Vali Acc: 0.933 Test Loss: 0.411 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.399200439453125
Epoch: 39, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.43021655082702637
Epoch: 40, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.380 Vali Acc: 0.933 Test Loss: 0.380 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.37746095657348633
Epoch: 41, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.4482274055480957
Epoch: 42, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.3712756633758545
Epoch: 43, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.344 Vali Acc: 0.937 Test Loss: 0.344 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.3287045955657959
Epoch: 44, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.333 Vali Acc: 0.933 Test Loss: 0.333 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.3675801753997803
Epoch: 45, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.3722987174987793
Epoch: 46, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.3699476718902588
Epoch: 47, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.37143611907958984
Epoch: 48, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.369281530380249
Epoch: 49, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.401763916015625
Epoch: 50, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 205446
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7264747619628906
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.819 Vali Acc: 0.085 Test Loss: 1.819 Test Acc: 0.085
Validation loss decreased (inf --> -0.085167).  Saving model ...
Epoch: 2 cost time: 0.4204685688018799
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.807 Vali Acc: 0.100 Test Loss: 1.807 Test Acc: 0.100
Validation loss decreased (-0.085167 --> -0.099982).  Saving model ...
Epoch: 3 cost time: 0.4153470993041992
Epoch: 3, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.796 Vali Acc: 0.133 Test Loss: 1.796 Test Acc: 0.133
Validation loss decreased (-0.099982 --> -0.133315).  Saving model ...
Epoch: 4 cost time: 0.3648660182952881
Epoch: 4, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.785 Vali Acc: 0.196 Test Loss: 1.785 Test Acc: 0.196
Validation loss decreased (-0.133315 --> -0.196278).  Saving model ...
Epoch: 5 cost time: 0.43486952781677246
Epoch: 5, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.771 Vali Acc: 0.252 Test Loss: 1.771 Test Acc: 0.252
Validation loss decreased (-0.196278 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 0.38912248611450195
Epoch: 6, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.754 Vali Acc: 0.311 Test Loss: 1.754 Test Acc: 0.311
Validation loss decreased (-0.251834 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 0.3687744140625
Epoch: 7, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.733 Vali Acc: 0.374 Test Loss: 1.733 Test Acc: 0.374
Validation loss decreased (-0.311094 --> -0.374057).  Saving model ...
Epoch: 8 cost time: 0.3931620121002197
Epoch: 8, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.710 Vali Acc: 0.415 Test Loss: 1.710 Test Acc: 0.415
Validation loss decreased (-0.374057 --> -0.414798).  Saving model ...
Epoch: 9 cost time: 0.45638394355773926
Epoch: 9, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.684 Vali Acc: 0.474 Test Loss: 1.684 Test Acc: 0.474
Validation loss decreased (-0.414798 --> -0.474057).  Saving model ...
Epoch: 10 cost time: 0.3786494731903076
Epoch: 10, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.656 Vali Acc: 0.530 Test Loss: 1.656 Test Acc: 0.530
Validation loss decreased (-0.474057 --> -0.529613).  Saving model ...
Epoch: 11 cost time: 0.3766615390777588
Epoch: 11, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.625 Vali Acc: 0.574 Test Loss: 1.625 Test Acc: 0.574
Validation loss decreased (-0.529613 --> -0.574058).  Saving model ...
Epoch: 12 cost time: 0.3813648223876953
Epoch: 12, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.592 Vali Acc: 0.630 Test Loss: 1.592 Test Acc: 0.630
Validation loss decreased (-0.574058 --> -0.629614).  Saving model ...
Epoch: 13 cost time: 0.46317076683044434
Epoch: 13, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.557 Vali Acc: 0.685 Test Loss: 1.557 Test Acc: 0.685
Validation loss decreased (-0.629614 --> -0.685170).  Saving model ...
Epoch: 14 cost time: 0.38577818870544434
Epoch: 14, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.519 Vali Acc: 0.711 Test Loss: 1.519 Test Acc: 0.711
Validation loss decreased (-0.685170 --> -0.711096).  Saving model ...
Epoch: 15 cost time: 0.3481259346008301
Epoch: 15, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.480 Vali Acc: 0.756 Test Loss: 1.480 Test Acc: 0.756
Validation loss decreased (-0.711096 --> -0.755541).  Saving model ...
Epoch: 16 cost time: 0.3502335548400879
Epoch: 16, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.439 Vali Acc: 0.793 Test Loss: 1.439 Test Acc: 0.793
Validation loss decreased (-0.755541 --> -0.792578).  Saving model ...
Epoch: 17 cost time: 0.43453073501586914
Epoch: 17, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.396 Vali Acc: 0.807 Test Loss: 1.396 Test Acc: 0.807
Validation loss decreased (-0.792578 --> -0.807393).  Saving model ...
Epoch: 18 cost time: 0.38416481018066406
Epoch: 18, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.352 Vali Acc: 0.815 Test Loss: 1.352 Test Acc: 0.815
Validation loss decreased (-0.807393 --> -0.814801).  Saving model ...
Epoch: 19 cost time: 0.41487979888916016
Epoch: 19, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.306 Vali Acc: 0.848 Test Loss: 1.306 Test Acc: 0.848
Validation loss decreased (-0.814801 --> -0.848135).  Saving model ...
Epoch: 20 cost time: 0.4672870635986328
Epoch: 20, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.258 Vali Acc: 0.863 Test Loss: 1.258 Test Acc: 0.863
Validation loss decreased (-0.848135 --> -0.862950).  Saving model ...
Epoch: 21 cost time: 0.388350248336792
Epoch: 21, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.210 Vali Acc: 0.870 Test Loss: 1.210 Test Acc: 0.870
Validation loss decreased (-0.862950 --> -0.870358).  Saving model ...
Epoch: 22 cost time: 0.39118456840515137
Epoch: 22, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.161 Vali Acc: 0.881 Test Loss: 1.161 Test Acc: 0.881
Validation loss decreased (-0.870358 --> -0.881470).  Saving model ...
Epoch: 23 cost time: 0.3772237300872803
Epoch: 23, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.112 Vali Acc: 0.896 Test Loss: 1.112 Test Acc: 0.896
Validation loss decreased (-0.881470 --> -0.896285).  Saving model ...
Epoch: 24 cost time: 0.37941622734069824
Epoch: 24, Steps: 2 | Train Loss: 0.924 Vali Loss: 1.063 Vali Acc: 0.900 Test Loss: 1.063 Test Acc: 0.900
Validation loss decreased (-0.896285 --> -0.899989).  Saving model ...
Epoch: 25 cost time: 0.4125857353210449
Epoch: 25, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.014 Vali Acc: 0.907 Test Loss: 1.014 Test Acc: 0.907
Validation loss decreased (-0.899989 --> -0.907397).  Saving model ...
Epoch: 26 cost time: 0.3666830062866211
Epoch: 26, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.966 Vali Acc: 0.915 Test Loss: 0.966 Test Acc: 0.915
Validation loss decreased (-0.907397 --> -0.914805).  Saving model ...
Epoch: 27 cost time: 0.3706791400909424
Epoch: 27, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.918 Vali Acc: 0.919 Test Loss: 0.918 Test Acc: 0.919
Validation loss decreased (-0.914805 --> -0.918509).  Saving model ...
Epoch: 28 cost time: 0.45551085472106934
Epoch: 28, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.872 Vali Acc: 0.930 Test Loss: 0.872 Test Acc: 0.930
Validation loss decreased (-0.918509 --> -0.929621).  Saving model ...
Epoch: 29 cost time: 0.3982522487640381
Epoch: 29, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.827 Vali Acc: 0.933 Test Loss: 0.827 Test Acc: 0.933
Validation loss decreased (-0.929621 --> -0.933325).  Saving model ...
Epoch: 30 cost time: 0.4117856025695801
Epoch: 30, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.783 Vali Acc: 0.930 Test Loss: 0.783 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.3811194896697998
Epoch: 31, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.742 Vali Acc: 0.941 Test Loss: 0.742 Test Acc: 0.941
Validation loss decreased (-0.933325 --> -0.940733).  Saving model ...
Epoch: 32 cost time: 0.42209601402282715
Epoch: 32, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.701 Vali Acc: 0.944 Test Loss: 0.701 Test Acc: 0.944
Validation loss decreased (-0.940733 --> -0.944437).  Saving model ...
Epoch: 33 cost time: 0.3852849006652832
Epoch: 33, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.663 Vali Acc: 0.944 Test Loss: 0.663 Test Acc: 0.944
Validation loss decreased (-0.944437 --> -0.944438).  Saving model ...
Epoch: 34 cost time: 0.39196205139160156
Epoch: 34, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.627 Vali Acc: 0.948 Test Loss: 0.627 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948142).  Saving model ...
Epoch: 35 cost time: 0.38942575454711914
Epoch: 35, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.593 Vali Acc: 0.952 Test Loss: 0.593 Test Acc: 0.952
Validation loss decreased (-0.948142 --> -0.951846).  Saving model ...
Epoch: 36 cost time: 0.4229569435119629
Epoch: 36, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.561 Vali Acc: 0.952 Test Loss: 0.561 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951846).  Saving model ...
Epoch: 37 cost time: 0.41028308868408203
Epoch: 37, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.532 Vali Acc: 0.952 Test Loss: 0.532 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951847).  Saving model ...
Epoch: 38 cost time: 0.40982842445373535
Epoch: 38, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.504 Vali Acc: 0.959 Test Loss: 0.504 Test Acc: 0.959
Validation loss decreased (-0.951847 --> -0.959254).  Saving model ...
Epoch: 39 cost time: 0.41229987144470215
Epoch: 39, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.479 Vali Acc: 0.959 Test Loss: 0.479 Test Acc: 0.959
Validation loss decreased (-0.959254 --> -0.959254).  Saving model ...
Epoch: 40 cost time: 0.3743467330932617
Epoch: 40, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.455 Vali Acc: 0.963 Test Loss: 0.455 Test Acc: 0.963
Validation loss decreased (-0.959254 --> -0.962958).  Saving model ...
Epoch: 41 cost time: 0.4072897434234619
Epoch: 41, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.434 Vali Acc: 0.963 Test Loss: 0.434 Test Acc: 0.963
Validation loss decreased (-0.962958 --> -0.962959).  Saving model ...
Epoch: 42 cost time: 0.4086027145385742
Epoch: 42, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.414 Vali Acc: 0.963 Test Loss: 0.414 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962959).  Saving model ...
Epoch: 43 cost time: 0.3894350528717041
Epoch: 43, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.396 Vali Acc: 0.963 Test Loss: 0.396 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962959).  Saving model ...
Epoch: 44 cost time: 0.3973417282104492
Epoch: 44, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.379 Vali Acc: 0.967 Test Loss: 0.379 Test Acc: 0.967
Validation loss decreased (-0.962959 --> -0.966663).  Saving model ...
Epoch: 45 cost time: 0.4673178195953369
Epoch: 45, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.364 Vali Acc: 0.970 Test Loss: 0.364 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.970367).  Saving model ...
Epoch: 46 cost time: 0.4214026927947998
Epoch: 46, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.350 Vali Acc: 0.970 Test Loss: 0.350 Test Acc: 0.970
Validation loss decreased (-0.970367 --> -0.970367).  Saving model ...
Epoch: 47 cost time: 0.41953110694885254
Epoch: 47, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.337 Vali Acc: 0.974 Test Loss: 0.337 Test Acc: 0.974
Validation loss decreased (-0.970367 --> -0.974071).  Saving model ...
Epoch: 48 cost time: 0.45581889152526855
Epoch: 48, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.324 Vali Acc: 0.974 Test Loss: 0.324 Test Acc: 0.974
Validation loss decreased (-0.974071 --> -0.974071).  Saving model ...
Epoch: 49 cost time: 0.43930506706237793
Epoch: 49, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.314 Vali Acc: 0.974 Test Loss: 0.314 Test Acc: 0.974
Validation loss decreased (-0.974071 --> -0.974071).  Saving model ...
Epoch: 50 cost time: 0.48720884323120117
Epoch: 50, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.304 Vali Acc: 0.974 Test Loss: 0.304 Test Acc: 0.974
Validation loss decreased (-0.974071 --> -0.974071).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9740740740740741
model parameter : 204006
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7205698490142822
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.826 Vali Acc: 0.152 Test Loss: 1.826 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 0.41093015670776367
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.814 Vali Acc: 0.167 Test Loss: 1.814 Test Acc: 0.167
Validation loss decreased (-0.151834 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.375821590423584
Epoch: 3, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.804 Vali Acc: 0.185 Test Loss: 1.804 Test Acc: 0.185
Validation loss decreased (-0.166649 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.35570693016052246
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.794 Vali Acc: 0.211 Test Loss: 1.794 Test Acc: 0.211
Validation loss decreased (-0.185167 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 0.3800380229949951
Epoch: 5, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.782 Vali Acc: 0.267 Test Loss: 1.782 Test Acc: 0.267
Validation loss decreased (-0.211093 --> -0.266649).  Saving model ...
Epoch: 6 cost time: 0.4415156841278076
Epoch: 6, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.767 Vali Acc: 0.307 Test Loss: 1.767 Test Acc: 0.307
Validation loss decreased (-0.266649 --> -0.307390).  Saving model ...
Epoch: 7 cost time: 0.4375333786010742
Epoch: 7, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.750 Vali Acc: 0.333 Test Loss: 1.750 Test Acc: 0.333
Validation loss decreased (-0.307390 --> -0.333316).  Saving model ...
Epoch: 8 cost time: 0.42032480239868164
Epoch: 8, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.730 Vali Acc: 0.400 Test Loss: 1.730 Test Acc: 0.400
Validation loss decreased (-0.333316 --> -0.399983).  Saving model ...
Epoch: 9 cost time: 0.44186925888061523
Epoch: 9, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.708 Vali Acc: 0.459 Test Loss: 1.708 Test Acc: 0.459
Validation loss decreased (-0.399983 --> -0.459242).  Saving model ...
Epoch: 10 cost time: 0.4144902229309082
Epoch: 10, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.684 Vali Acc: 0.541 Test Loss: 1.684 Test Acc: 0.541
Validation loss decreased (-0.459242 --> -0.540724).  Saving model ...
Epoch: 11 cost time: 0.44621920585632324
Epoch: 11, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.657 Vali Acc: 0.589 Test Loss: 1.657 Test Acc: 0.589
Validation loss decreased (-0.540724 --> -0.588872).  Saving model ...
Epoch: 12 cost time: 0.4236788749694824
Epoch: 12, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.628 Vali Acc: 0.641 Test Loss: 1.628 Test Acc: 0.641
Validation loss decreased (-0.588872 --> -0.640724).  Saving model ...
Epoch: 13 cost time: 0.4560129642486572
Epoch: 13, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.597 Vali Acc: 0.659 Test Loss: 1.597 Test Acc: 0.659
Validation loss decreased (-0.640724 --> -0.659243).  Saving model ...
Epoch: 14 cost time: 0.4030113220214844
Epoch: 14, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.564 Vali Acc: 0.681 Test Loss: 1.564 Test Acc: 0.681
Validation loss decreased (-0.659243 --> -0.681466).  Saving model ...
Epoch: 15 cost time: 0.3964259624481201
Epoch: 15, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.530 Vali Acc: 0.693 Test Loss: 1.530 Test Acc: 0.693
Validation loss decreased (-0.681466 --> -0.692577).  Saving model ...
Epoch: 16 cost time: 0.3983902931213379
Epoch: 16, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.494 Vali Acc: 0.722 Test Loss: 1.494 Test Acc: 0.722
Validation loss decreased (-0.692577 --> -0.722207).  Saving model ...
Epoch: 17 cost time: 0.4097409248352051
Epoch: 17, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.456 Vali Acc: 0.744 Test Loss: 1.456 Test Acc: 0.744
Validation loss decreased (-0.722207 --> -0.744430).  Saving model ...
Epoch: 18 cost time: 0.35256433486938477
Epoch: 18, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.417 Vali Acc: 0.759 Test Loss: 1.417 Test Acc: 0.759
Validation loss decreased (-0.744430 --> -0.759245).  Saving model ...
Epoch: 19 cost time: 0.3782830238342285
Epoch: 19, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.376 Vali Acc: 0.770 Test Loss: 1.376 Test Acc: 0.770
Validation loss decreased (-0.759245 --> -0.770357).  Saving model ...
Epoch: 20 cost time: 0.38761091232299805
Epoch: 20, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.335 Vali Acc: 0.778 Test Loss: 1.335 Test Acc: 0.778
Validation loss decreased (-0.770357 --> -0.777764).  Saving model ...
Epoch: 21 cost time: 0.41771483421325684
Epoch: 21, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.292 Vali Acc: 0.800 Test Loss: 1.292 Test Acc: 0.800
Validation loss decreased (-0.777764 --> -0.799987).  Saving model ...
Epoch: 22 cost time: 0.4031383991241455
Epoch: 22, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.248 Vali Acc: 0.826 Test Loss: 1.248 Test Acc: 0.826
Validation loss decreased (-0.799987 --> -0.825913).  Saving model ...
Epoch: 23 cost time: 0.41480183601379395
Epoch: 23, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.204 Vali Acc: 0.837 Test Loss: 1.204 Test Acc: 0.837
Validation loss decreased (-0.825913 --> -0.837025).  Saving model ...
Epoch: 24 cost time: 0.42613983154296875
Epoch: 24, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.160 Vali Acc: 0.848 Test Loss: 1.160 Test Acc: 0.848
Validation loss decreased (-0.837025 --> -0.848137).  Saving model ...
Epoch: 25 cost time: 0.5247526168823242
Epoch: 25, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.115 Vali Acc: 0.848 Test Loss: 1.115 Test Acc: 0.848
Validation loss decreased (-0.848137 --> -0.848137).  Saving model ...
Epoch: 26 cost time: 0.4079427719116211
Epoch: 26, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.071 Vali Acc: 0.863 Test Loss: 1.071 Test Acc: 0.863
Validation loss decreased (-0.848137 --> -0.862952).  Saving model ...
Epoch: 27 cost time: 0.39545512199401855
Epoch: 27, Steps: 2 | Train Loss: 0.857 Vali Loss: 1.026 Vali Acc: 0.870 Test Loss: 1.026 Test Acc: 0.870
Validation loss decreased (-0.862952 --> -0.870360).  Saving model ...
Epoch: 28 cost time: 0.40498948097229004
Epoch: 28, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.983 Vali Acc: 0.885 Test Loss: 0.983 Test Acc: 0.885
Validation loss decreased (-0.870360 --> -0.885175).  Saving model ...
Epoch: 29 cost time: 0.4694855213165283
Epoch: 29, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.940 Vali Acc: 0.885 Test Loss: 0.940 Test Acc: 0.885
Validation loss decreased (-0.885175 --> -0.885176).  Saving model ...
Epoch: 30 cost time: 0.41835904121398926
Epoch: 30, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.898 Vali Acc: 0.900 Test Loss: 0.898 Test Acc: 0.900
Validation loss decreased (-0.885176 --> -0.899991).  Saving model ...
Epoch: 31 cost time: 0.4376537799835205
Epoch: 31, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.857 Vali Acc: 0.907 Test Loss: 0.857 Test Acc: 0.907
Validation loss decreased (-0.899991 --> -0.907399).  Saving model ...
Epoch: 32 cost time: 0.45970773696899414
Epoch: 32, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.817 Vali Acc: 0.911 Test Loss: 0.817 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 33 cost time: 0.4034848213195801
Epoch: 33, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.779 Vali Acc: 0.915 Test Loss: 0.779 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 34 cost time: 0.38097071647644043
Epoch: 34, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.743 Vali Acc: 0.930 Test Loss: 0.743 Test Acc: 0.930
Validation loss decreased (-0.914807 --> -0.929622).  Saving model ...
Epoch: 35 cost time: 0.43223118782043457
Epoch: 35, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.709 Vali Acc: 0.930 Test Loss: 0.709 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929623).  Saving model ...
Epoch: 36 cost time: 0.3906736373901367
Epoch: 36, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.676 Vali Acc: 0.930 Test Loss: 0.676 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 37 cost time: 0.389815092086792
Epoch: 37, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.646 Vali Acc: 0.933 Test Loss: 0.646 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 38 cost time: 0.37645626068115234
Epoch: 38, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.617 Vali Acc: 0.937 Test Loss: 0.617 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 39 cost time: 0.49509429931640625
Epoch: 39, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.589 Vali Acc: 0.937 Test Loss: 0.589 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 40 cost time: 0.4107675552368164
Epoch: 40, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.563 Vali Acc: 0.941 Test Loss: 0.563 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 41 cost time: 0.39794301986694336
Epoch: 41, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.539 Vali Acc: 0.944 Test Loss: 0.539 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 42 cost time: 0.39716029167175293
Epoch: 42, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.516 Vali Acc: 0.944 Test Loss: 0.516 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 43 cost time: 0.40168237686157227
Epoch: 43, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.495 Vali Acc: 0.948 Test Loss: 0.495 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 44 cost time: 0.40915513038635254
Epoch: 44, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.476 Vali Acc: 0.944 Test Loss: 0.476 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4371664524078369
Epoch: 45, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.458 Vali Acc: 0.944 Test Loss: 0.458 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4163212776184082
Epoch: 46, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.441 Vali Acc: 0.944 Test Loss: 0.441 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.45679640769958496
Epoch: 47, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.426 Vali Acc: 0.948 Test Loss: 0.426 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 48 cost time: 0.4164397716522217
Epoch: 48, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.411 Vali Acc: 0.948 Test Loss: 0.411 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 49 cost time: 0.41260337829589844
Epoch: 49, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.398 Vali Acc: 0.948 Test Loss: 0.398 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 50 cost time: 0.4123702049255371
Epoch: 50, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.386 Vali Acc: 0.948 Test Loss: 0.386 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 201030
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6118788719177246
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.789 Vali Acc: 0.281 Test Loss: 1.789 Test Acc: 0.281
Validation loss decreased (inf --> -0.281464).  Saving model ...
Epoch: 2 cost time: 0.4116227626800537
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.783 Vali Acc: 0.281 Test Loss: 1.783 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.4805874824523926
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.778 Vali Acc: 0.281 Test Loss: 1.778 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.43497371673583984
Epoch: 4, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.773 Vali Acc: 0.289 Test Loss: 1.773 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288871).  Saving model ...
Epoch: 5 cost time: 0.3930511474609375
Epoch: 5, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.766 Vali Acc: 0.304 Test Loss: 1.766 Test Acc: 0.304
Validation loss decreased (-0.288871 --> -0.303686).  Saving model ...
Epoch: 6 cost time: 0.41257596015930176
Epoch: 6, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.757 Vali Acc: 0.307 Test Loss: 1.757 Test Acc: 0.307
Validation loss decreased (-0.303686 --> -0.307390).  Saving model ...
Epoch: 7 cost time: 0.3970520496368408
Epoch: 7, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.746 Vali Acc: 0.333 Test Loss: 1.746 Test Acc: 0.333
Validation loss decreased (-0.307390 --> -0.333316).  Saving model ...
Epoch: 8 cost time: 0.445537805557251
Epoch: 8, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.732 Vali Acc: 0.352 Test Loss: 1.732 Test Acc: 0.352
Validation loss decreased (-0.333316 --> -0.351835).  Saving model ...
Epoch: 9 cost time: 0.4503486156463623
Epoch: 9, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.717 Vali Acc: 0.367 Test Loss: 1.717 Test Acc: 0.367
Validation loss decreased (-0.351835 --> -0.366649).  Saving model ...
Epoch: 10 cost time: 0.41805553436279297
Epoch: 10, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.699 Vali Acc: 0.385 Test Loss: 1.699 Test Acc: 0.385
Validation loss decreased (-0.366649 --> -0.385168).  Saving model ...
Epoch: 11 cost time: 0.4334831237792969
Epoch: 11, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.680 Vali Acc: 0.430 Test Loss: 1.680 Test Acc: 0.430
Validation loss decreased (-0.385168 --> -0.429613).  Saving model ...
Epoch: 12 cost time: 0.43002748489379883
Epoch: 12, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.658 Vali Acc: 0.448 Test Loss: 1.658 Test Acc: 0.448
Validation loss decreased (-0.429613 --> -0.448132).  Saving model ...
Epoch: 13 cost time: 0.39295220375061035
Epoch: 13, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.635 Vali Acc: 0.489 Test Loss: 1.635 Test Acc: 0.489
Validation loss decreased (-0.448132 --> -0.488873).  Saving model ...
Epoch: 14 cost time: 0.4886150360107422
Epoch: 14, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.611 Vali Acc: 0.526 Test Loss: 1.611 Test Acc: 0.526
Validation loss decreased (-0.488873 --> -0.525910).  Saving model ...
Epoch: 15 cost time: 0.41998982429504395
Epoch: 15, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.584 Vali Acc: 0.559 Test Loss: 1.584 Test Acc: 0.559
Validation loss decreased (-0.525910 --> -0.559243).  Saving model ...
Epoch: 16 cost time: 0.4642353057861328
Epoch: 16, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.557 Vali Acc: 0.604 Test Loss: 1.557 Test Acc: 0.604
Validation loss decreased (-0.559243 --> -0.603688).  Saving model ...
Epoch: 17 cost time: 0.5193514823913574
Epoch: 17, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.528 Vali Acc: 0.637 Test Loss: 1.528 Test Acc: 0.637
Validation loss decreased (-0.603688 --> -0.637022).  Saving model ...
Epoch: 18 cost time: 0.4437370300292969
Epoch: 18, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.497 Vali Acc: 0.663 Test Loss: 1.497 Test Acc: 0.663
Validation loss decreased (-0.637022 --> -0.662948).  Saving model ...
Epoch: 19 cost time: 0.39351963996887207
Epoch: 19, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.465 Vali Acc: 0.700 Test Loss: 1.465 Test Acc: 0.700
Validation loss decreased (-0.662948 --> -0.699985).  Saving model ...
Epoch: 20 cost time: 0.4252321720123291
Epoch: 20, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.433 Vali Acc: 0.730 Test Loss: 1.433 Test Acc: 0.730
Validation loss decreased (-0.699985 --> -0.729615).  Saving model ...
Epoch: 21 cost time: 0.4937114715576172
Epoch: 21, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.399 Vali Acc: 0.737 Test Loss: 1.399 Test Acc: 0.737
Validation loss decreased (-0.729615 --> -0.737023).  Saving model ...
Epoch: 22 cost time: 0.4615466594696045
Epoch: 22, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.364 Vali Acc: 0.748 Test Loss: 1.364 Test Acc: 0.748
Validation loss decreased (-0.737023 --> -0.748135).  Saving model ...
Epoch: 23 cost time: 0.4121429920196533
Epoch: 23, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.329 Vali Acc: 0.767 Test Loss: 1.329 Test Acc: 0.767
Validation loss decreased (-0.748135 --> -0.766653).  Saving model ...
Epoch: 24 cost time: 0.487257719039917
Epoch: 24, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.293 Vali Acc: 0.781 Test Loss: 1.293 Test Acc: 0.781
Validation loss decreased (-0.766653 --> -0.781469).  Saving model ...
Epoch: 25 cost time: 0.4501500129699707
Epoch: 25, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.256 Vali Acc: 0.789 Test Loss: 1.256 Test Acc: 0.789
Validation loss decreased (-0.781469 --> -0.788876).  Saving model ...
Epoch: 26 cost time: 0.386044979095459
Epoch: 26, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.219 Vali Acc: 0.796 Test Loss: 1.219 Test Acc: 0.796
Validation loss decreased (-0.788876 --> -0.796284).  Saving model ...
Epoch: 27 cost time: 0.4320852756500244
Epoch: 27, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.182 Vali Acc: 0.807 Test Loss: 1.182 Test Acc: 0.807
Validation loss decreased (-0.796284 --> -0.807396).  Saving model ...
Epoch: 28 cost time: 0.4213864803314209
Epoch: 28, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.145 Vali Acc: 0.822 Test Loss: 1.145 Test Acc: 0.822
Validation loss decreased (-0.807396 --> -0.822211).  Saving model ...
Epoch: 29 cost time: 0.40337491035461426
Epoch: 29, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.107 Vali Acc: 0.844 Test Loss: 1.107 Test Acc: 0.844
Validation loss decreased (-0.822211 --> -0.844433).  Saving model ...
Epoch: 30 cost time: 0.4512813091278076
Epoch: 30, Steps: 2 | Train Loss: 0.892 Vali Loss: 1.068 Vali Acc: 0.856 Test Loss: 1.068 Test Acc: 0.856
Validation loss decreased (-0.844433 --> -0.855545).  Saving model ...
Epoch: 31 cost time: 0.40918660163879395
Epoch: 31, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.031 Vali Acc: 0.859 Test Loss: 1.031 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859249).  Saving model ...
Epoch: 32 cost time: 0.5510420799255371
Epoch: 32, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.993 Vali Acc: 0.874 Test Loss: 0.993 Test Acc: 0.874
Validation loss decreased (-0.859249 --> -0.874064).  Saving model ...
Epoch: 33 cost time: 0.5001749992370605
Epoch: 33, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.956 Vali Acc: 0.893 Test Loss: 0.956 Test Acc: 0.893
Validation loss decreased (-0.874064 --> -0.892583).  Saving model ...
Epoch: 34 cost time: 0.42484283447265625
Epoch: 34, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.919 Vali Acc: 0.893 Test Loss: 0.919 Test Acc: 0.893
Validation loss decreased (-0.892583 --> -0.892583).  Saving model ...
Epoch: 35 cost time: 0.4070737361907959
Epoch: 35, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.883 Vali Acc: 0.896 Test Loss: 0.883 Test Acc: 0.896
Validation loss decreased (-0.892583 --> -0.896287).  Saving model ...
Epoch: 36 cost time: 0.4379689693450928
Epoch: 36, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.848 Vali Acc: 0.904 Test Loss: 0.848 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
Epoch: 37 cost time: 0.42011332511901855
Epoch: 37, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.814 Vali Acc: 0.907 Test Loss: 0.814 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 38 cost time: 0.4446272850036621
Epoch: 38, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.781 Vali Acc: 0.911 Test Loss: 0.781 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 39 cost time: 0.4048476219177246
Epoch: 39, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.748 Vali Acc: 0.915 Test Loss: 0.748 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 40 cost time: 0.3837416172027588
Epoch: 40, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.718 Vali Acc: 0.915 Test Loss: 0.718 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 41 cost time: 0.41658806800842285
Epoch: 41, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.688 Vali Acc: 0.926 Test Loss: 0.688 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925919).  Saving model ...
Epoch: 42 cost time: 0.4150979518890381
Epoch: 42, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.660 Vali Acc: 0.926 Test Loss: 0.660 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925919).  Saving model ...
Epoch: 43 cost time: 0.3888990879058838
Epoch: 43, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.633 Vali Acc: 0.926 Test Loss: 0.633 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925920).  Saving model ...
Epoch: 44 cost time: 0.4024028778076172
Epoch: 44, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.607 Vali Acc: 0.937 Test Loss: 0.607 Test Acc: 0.937
Validation loss decreased (-0.925920 --> -0.937031).  Saving model ...
Epoch: 45 cost time: 0.40414905548095703
Epoch: 45, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.583 Vali Acc: 0.941 Test Loss: 0.583 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 46 cost time: 0.42635583877563477
Epoch: 46, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.561 Vali Acc: 0.944 Test Loss: 0.561 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 47 cost time: 0.450084924697876
Epoch: 47, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.540 Vali Acc: 0.948 Test Loss: 0.540 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 48 cost time: 0.4609684944152832
Epoch: 48, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.519 Vali Acc: 0.944 Test Loss: 0.519 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4823131561279297
Epoch: 49, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.501 Vali Acc: 0.944 Test Loss: 0.501 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4150099754333496
Epoch: 50, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.484 Vali Acc: 0.944 Test Loss: 0.484 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 199622
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7522151470184326
Epoch: 1, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.726 Vali Acc: 0.278 Test Loss: 1.726 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 0.519888162612915
Epoch: 2, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.672 Vali Acc: 0.426 Test Loss: 1.672 Test Acc: 0.426
Validation loss decreased (-0.277761 --> -0.425909).  Saving model ...
Epoch: 3 cost time: 0.5053074359893799
Epoch: 3, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.588 Vali Acc: 0.674 Test Loss: 1.588 Test Acc: 0.674
Validation loss decreased (-0.425909 --> -0.674058).  Saving model ...
Epoch: 4 cost time: 0.48972487449645996
Epoch: 4, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.437 Vali Acc: 0.793 Test Loss: 1.437 Test Acc: 0.793
Validation loss decreased (-0.674058 --> -0.792578).  Saving model ...
Epoch: 5 cost time: 0.5055217742919922
Epoch: 5, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.250 Vali Acc: 0.852 Test Loss: 1.250 Test Acc: 0.852
Validation loss decreased (-0.792578 --> -0.851839).  Saving model ...
Epoch: 6 cost time: 0.5457859039306641
Epoch: 6, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.051 Vali Acc: 0.870 Test Loss: 1.051 Test Acc: 0.870
Validation loss decreased (-0.851839 --> -0.870360).  Saving model ...
Epoch: 7 cost time: 0.4899919033050537
Epoch: 7, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.853 Vali Acc: 0.926 Test Loss: 0.853 Test Acc: 0.926
Validation loss decreased (-0.870360 --> -0.925917).  Saving model ...
Epoch: 8 cost time: 0.5525498390197754
Epoch: 8, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.673 Vali Acc: 0.937 Test Loss: 0.673 Test Acc: 0.937
Validation loss decreased (-0.925917 --> -0.937030).  Saving model ...
Epoch: 9 cost time: 0.5134251117706299
Epoch: 9, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.526 Vali Acc: 0.944 Test Loss: 0.526 Test Acc: 0.944
Validation loss decreased (-0.937030 --> -0.944439).  Saving model ...
Epoch: 10 cost time: 0.5199406147003174
Epoch: 10, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.408 Vali Acc: 0.937 Test Loss: 0.408 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5143628120422363
Epoch: 11, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.632573127746582
Epoch: 12, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.503901481628418
Epoch: 13, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5696430206298828
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5276439189910889
Epoch: 15, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.519127607345581
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.5571000576019287
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.5093867778778076
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 19 cost time: 0.5102767944335938
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.5131914615631104
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.5482616424560547
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.48201632499694824
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5096302032470703
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5211207866668701
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5581088066101074
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4628164768218994
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4856722354888916
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.474855899810791
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5126776695251465
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5996057987213135
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.47731828689575195
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2983814
model size : 11.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8094351291656494
Epoch: 1, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.776 Vali Acc: 0.296 Test Loss: 1.776 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.475475549697876
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.737 Vali Acc: 0.337 Test Loss: 1.737 Test Acc: 0.337
Validation loss decreased (-0.296279 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.5433034896850586
Epoch: 3, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.684 Vali Acc: 0.415 Test Loss: 1.684 Test Acc: 0.415
Validation loss decreased (-0.337020 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.5171501636505127
Epoch: 4, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.593 Vali Acc: 0.619 Test Loss: 1.593 Test Acc: 0.619
Validation loss decreased (-0.414798 --> -0.618503).  Saving model ...
Epoch: 5 cost time: 0.5643460750579834
Epoch: 5, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.473 Vali Acc: 0.678 Test Loss: 1.473 Test Acc: 0.678
Validation loss decreased (-0.618503 --> -0.677763).  Saving model ...
Epoch: 6 cost time: 0.5616617202758789
Epoch: 6, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.336 Vali Acc: 0.770 Test Loss: 1.336 Test Acc: 0.770
Validation loss decreased (-0.677763 --> -0.770357).  Saving model ...
Epoch: 7 cost time: 0.44858384132385254
Epoch: 7, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.186 Vali Acc: 0.830 Test Loss: 1.186 Test Acc: 0.830
Validation loss decreased (-0.770357 --> -0.829618).  Saving model ...
Epoch: 8 cost time: 0.4874708652496338
Epoch: 8, Steps: 2 | Train Loss: 0.790 Vali Loss: 1.032 Vali Acc: 0.859 Test Loss: 1.032 Test Acc: 0.859
Validation loss decreased (-0.829618 --> -0.859249).  Saving model ...
Epoch: 9 cost time: 0.46431541442871094
Epoch: 9, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.879 Vali Acc: 0.874 Test Loss: 0.879 Test Acc: 0.874
Validation loss decreased (-0.859249 --> -0.874065).  Saving model ...
Epoch: 10 cost time: 0.4806644916534424
Epoch: 10, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.735 Vali Acc: 0.885 Test Loss: 0.735 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885178).  Saving model ...
Epoch: 11 cost time: 0.5092995166778564
Epoch: 11, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.615 Vali Acc: 0.893 Test Loss: 0.615 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 12 cost time: 0.5181539058685303
Epoch: 12, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 0.4895346164703369
Epoch: 13, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.423 Vali Acc: 0.915 Test Loss: 0.423 Test Acc: 0.915
Validation loss decreased (-0.899995 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.47725605964660645
Epoch: 14, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.355 Vali Acc: 0.922 Test Loss: 0.355 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 0.479717493057251
Epoch: 15, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.5588521957397461
Epoch: 16, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 17 cost time: 0.44655537605285645
Epoch: 17, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.4492647647857666
Epoch: 18, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.5353529453277588
Epoch: 19, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.4677772521972656
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.48191022872924805
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.4286613464355469
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.46773457527160645
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.5310096740722656
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.5422573089599609
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.5313928127288818
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.46214962005615234
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.49788928031921387
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.48075199127197266
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.4825119972229004
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.47180604934692383
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.47208571434020996
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.4769322872161865
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.4641280174255371
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.5010161399841309
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.48969435691833496
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.4543755054473877
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.46534228324890137
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 39 cost time: 0.566117525100708
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 40 cost time: 0.5012543201446533
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.459151029586792
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5689196586608887
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4576423168182373
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4953601360321045
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5348923206329346
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.47902703285217285
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5404977798461914
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5670115947723389
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4530329704284668
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2879622
model size : 11.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.859879493713379
Epoch: 1, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.804 Vali Acc: 0.193 Test Loss: 1.804 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.44156360626220703
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.771 Vali Acc: 0.226 Test Loss: 1.771 Test Acc: 0.226
Validation loss decreased (-0.192575 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.510549783706665
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.729 Vali Acc: 0.326 Test Loss: 1.729 Test Acc: 0.326
Validation loss decreased (-0.225908 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.4603593349456787
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.663 Vali Acc: 0.507 Test Loss: 1.663 Test Acc: 0.507
Validation loss decreased (-0.325909 --> -0.507391).  Saving model ...
Epoch: 5 cost time: 0.4568765163421631
Epoch: 5, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.575 Vali Acc: 0.659 Test Loss: 1.575 Test Acc: 0.659
Validation loss decreased (-0.507391 --> -0.659244).  Saving model ...
Epoch: 6 cost time: 0.46439027786254883
Epoch: 6, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.471 Vali Acc: 0.744 Test Loss: 1.471 Test Acc: 0.744
Validation loss decreased (-0.659244 --> -0.744430).  Saving model ...
Epoch: 7 cost time: 0.43730974197387695
Epoch: 7, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.353 Vali Acc: 0.815 Test Loss: 1.353 Test Acc: 0.815
Validation loss decreased (-0.744430 --> -0.814801).  Saving model ...
Epoch: 8 cost time: 0.4777677059173584
Epoch: 8, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.227 Vali Acc: 0.844 Test Loss: 1.227 Test Acc: 0.844
Validation loss decreased (-0.814801 --> -0.844432).  Saving model ...
Epoch: 9 cost time: 0.5290632247924805
Epoch: 9, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.097 Vali Acc: 0.874 Test Loss: 1.097 Test Acc: 0.874
Validation loss decreased (-0.844432 --> -0.874063).  Saving model ...
Epoch: 10 cost time: 0.5131089687347412
Epoch: 10, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.966 Vali Acc: 0.896 Test Loss: 0.966 Test Acc: 0.896
Validation loss decreased (-0.874063 --> -0.896287).  Saving model ...
Epoch: 11 cost time: 0.4610574245452881
Epoch: 11, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.838 Vali Acc: 0.915 Test Loss: 0.838 Test Acc: 0.915
Validation loss decreased (-0.896287 --> -0.914806).  Saving model ...
Epoch: 12 cost time: 0.47415733337402344
Epoch: 12, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.717 Vali Acc: 0.926 Test Loss: 0.717 Test Acc: 0.926
Validation loss decreased (-0.914806 --> -0.925919).  Saving model ...
Epoch: 13 cost time: 0.5020248889923096
Epoch: 13, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.610 Vali Acc: 0.922 Test Loss: 0.610 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5008900165557861
Epoch: 14, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.516 Vali Acc: 0.922 Test Loss: 0.516 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.438525915145874
Epoch: 15, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.436 Vali Acc: 0.926 Test Loss: 0.436 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925922).  Saving model ...
Epoch: 16 cost time: 0.48949122428894043
Epoch: 16, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.371 Vali Acc: 0.933 Test Loss: 0.371 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.46587657928466797
Epoch: 17, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.5492923259735107
Epoch: 18, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.5066187381744385
Epoch: 19, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.48624300956726074
Epoch: 20, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.46396541595458984
Epoch: 21, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.5462813377380371
Epoch: 22, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4448373317718506
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5438113212585449
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.49488019943237305
Epoch: 25, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5072450637817383
Epoch: 26, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5003049373626709
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4363975524902344
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4612905979156494
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.4740123748779297
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4722144603729248
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2849030
model size : 10.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.805032730102539
Epoch: 1, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.817 Vali Acc: 0.022 Test Loss: 1.817 Test Acc: 0.022
Validation loss decreased (inf --> -0.022204).  Saving model ...
Epoch: 2 cost time: 0.4386115074157715
Epoch: 2, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.787 Vali Acc: 0.093 Test Loss: 1.787 Test Acc: 0.093
Validation loss decreased (-0.022204 --> -0.092575).  Saving model ...
Epoch: 3 cost time: 0.5417478084564209
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.752 Vali Acc: 0.293 Test Loss: 1.752 Test Acc: 0.293
Validation loss decreased (-0.092575 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.4923834800720215
Epoch: 4, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.698 Vali Acc: 0.485 Test Loss: 1.698 Test Acc: 0.485
Validation loss decreased (-0.292575 --> -0.485168).  Saving model ...
Epoch: 5 cost time: 0.4607353210449219
Epoch: 5, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.628 Vali Acc: 0.644 Test Loss: 1.628 Test Acc: 0.644
Validation loss decreased (-0.485168 --> -0.644428).  Saving model ...
Epoch: 6 cost time: 0.4897575378417969
Epoch: 6, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.542 Vali Acc: 0.756 Test Loss: 1.542 Test Acc: 0.756
Validation loss decreased (-0.644428 --> -0.755540).  Saving model ...
Epoch: 7 cost time: 0.4765775203704834
Epoch: 7, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.443 Vali Acc: 0.856 Test Loss: 1.443 Test Acc: 0.856
Validation loss decreased (-0.755540 --> -0.855541).  Saving model ...
Epoch: 8 cost time: 0.4938654899597168
Epoch: 8, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.335 Vali Acc: 0.878 Test Loss: 1.335 Test Acc: 0.878
Validation loss decreased (-0.855541 --> -0.877764).  Saving model ...
Epoch: 9 cost time: 0.4923882484436035
Epoch: 9, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.218 Vali Acc: 0.911 Test Loss: 1.218 Test Acc: 0.911
Validation loss decreased (-0.877764 --> -0.911099).  Saving model ...
Epoch: 10 cost time: 0.5145747661590576
Epoch: 10, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.096 Vali Acc: 0.926 Test Loss: 1.096 Test Acc: 0.926
Validation loss decreased (-0.911099 --> -0.925915).  Saving model ...
Epoch: 11 cost time: 0.5185465812683105
Epoch: 11, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.973 Vali Acc: 0.926 Test Loss: 0.973 Test Acc: 0.926
Validation loss decreased (-0.925915 --> -0.925916).  Saving model ...
Epoch: 12 cost time: 0.5324640274047852
Epoch: 12, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.852 Vali Acc: 0.930 Test Loss: 0.852 Test Acc: 0.930
Validation loss decreased (-0.925916 --> -0.929621).  Saving model ...
Epoch: 13 cost time: 0.5266232490539551
Epoch: 13, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.737 Vali Acc: 0.933 Test Loss: 0.737 Test Acc: 0.933
Validation loss decreased (-0.929621 --> -0.933326).  Saving model ...
Epoch: 14 cost time: 0.5109438896179199
Epoch: 14, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.631 Vali Acc: 0.937 Test Loss: 0.631 Test Acc: 0.937
Validation loss decreased (-0.933326 --> -0.937031).  Saving model ...
Epoch: 15 cost time: 0.4946932792663574
Epoch: 15, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.539 Vali Acc: 0.944 Test Loss: 0.539 Test Acc: 0.944
Validation loss decreased (-0.937031 --> -0.944439).  Saving model ...
Epoch: 16 cost time: 0.4656331539154053
Epoch: 16, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.459 Vali Acc: 0.944 Test Loss: 0.459 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 17 cost time: 0.5013487339019775
Epoch: 17, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.395 Vali Acc: 0.944 Test Loss: 0.395 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 18 cost time: 0.4566214084625244
Epoch: 18, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.344 Vali Acc: 0.948 Test Loss: 0.344 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948145).  Saving model ...
Epoch: 19 cost time: 0.5107834339141846
Epoch: 19, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 20 cost time: 0.5981667041778564
Epoch: 20, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.272 Vali Acc: 0.952 Test Loss: 0.272 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 21 cost time: 0.49511265754699707
Epoch: 21, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.952 Test Loss: 0.247 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 22 cost time: 0.49178194999694824
Epoch: 22, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.49486327171325684
Epoch: 23, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.46271204948425293
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.46958279609680176
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.47579240798950195
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5014102458953857
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.4888298511505127
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.5057086944580078
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.5289924144744873
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.4937100410461426
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.5479943752288818
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.5254404544830322
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.4360029697418213
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.5537338256835938
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.4713170528411865
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.55682373046875
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.524181604385376
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.5084927082061768
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.48488640785217285
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.5078287124633789
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.4983177185058594
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.45226621627807617
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.44378113746643066
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.49512219429016113
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.4833066463470459
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.539940595626831
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.45171046257019043
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.45531606674194336
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.4937419891357422
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2830854
model size : 10.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8411133289337158
Epoch: 1, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.770 Vali Acc: 0.207 Test Loss: 1.770 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.4770362377166748
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.746 Vali Acc: 0.259 Test Loss: 1.746 Test Acc: 0.259
Validation loss decreased (-0.207390 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.46804094314575195
Epoch: 3, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.716 Vali Acc: 0.330 Test Loss: 1.716 Test Acc: 0.330
Validation loss decreased (-0.259242 --> -0.329612).  Saving model ...
Epoch: 4 cost time: 0.5172386169433594
Epoch: 4, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.670 Vali Acc: 0.452 Test Loss: 1.670 Test Acc: 0.452
Validation loss decreased (-0.329612 --> -0.451835).  Saving model ...
Epoch: 5 cost time: 0.4590892791748047
Epoch: 5, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.608 Vali Acc: 0.578 Test Loss: 1.608 Test Acc: 0.578
Validation loss decreased (-0.451835 --> -0.577762).  Saving model ...
Epoch: 6 cost time: 0.47510600090026855
Epoch: 6, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.531 Vali Acc: 0.667 Test Loss: 1.531 Test Acc: 0.667
Validation loss decreased (-0.577762 --> -0.666651).  Saving model ...
Epoch: 7 cost time: 0.529076337814331
Epoch: 7, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.441 Vali Acc: 0.811 Test Loss: 1.441 Test Acc: 0.811
Validation loss decreased (-0.666651 --> -0.811097).  Saving model ...
Epoch: 8 cost time: 0.5672261714935303
Epoch: 8, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.341 Vali Acc: 0.889 Test Loss: 1.341 Test Acc: 0.889
Validation loss decreased (-0.811097 --> -0.888875).  Saving model ...
Epoch: 9 cost time: 0.5116114616394043
Epoch: 9, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.231 Vali Acc: 0.915 Test Loss: 1.231 Test Acc: 0.915
Validation loss decreased (-0.888875 --> -0.914803).  Saving model ...
Epoch: 10 cost time: 0.5043115615844727
Epoch: 10, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.114 Vali Acc: 0.926 Test Loss: 1.114 Test Acc: 0.926
Validation loss decreased (-0.914803 --> -0.925915).  Saving model ...
Epoch: 11 cost time: 0.4722583293914795
Epoch: 11, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.994 Vali Acc: 0.933 Test Loss: 0.994 Test Acc: 0.933
Validation loss decreased (-0.925915 --> -0.933323).  Saving model ...
Epoch: 12 cost time: 0.47422051429748535
Epoch: 12, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.875 Vali Acc: 0.941 Test Loss: 0.875 Test Acc: 0.941
Validation loss decreased (-0.933323 --> -0.940732).  Saving model ...
Epoch: 13 cost time: 0.4778249263763428
Epoch: 13, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.761 Vali Acc: 0.944 Test Loss: 0.761 Test Acc: 0.944
Validation loss decreased (-0.940732 --> -0.944437).  Saving model ...
Epoch: 14 cost time: 0.46761417388916016
Epoch: 14, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.656 Vali Acc: 0.944 Test Loss: 0.656 Test Acc: 0.944
Validation loss decreased (-0.944437 --> -0.944438).  Saving model ...
Epoch: 15 cost time: 0.4571361541748047
Epoch: 15, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.565 Vali Acc: 0.948 Test Loss: 0.565 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948143).  Saving model ...
Epoch: 16 cost time: 0.5902259349822998
Epoch: 16, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.487 Vali Acc: 0.944 Test Loss: 0.487 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.47918272018432617
Epoch: 17, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.422 Vali Acc: 0.948 Test Loss: 0.422 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 18 cost time: 0.5142250061035156
Epoch: 18, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.368 Vali Acc: 0.944 Test Loss: 0.368 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5060138702392578
Epoch: 19, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5410037040710449
Epoch: 20, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.293 Vali Acc: 0.948 Test Loss: 0.293 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 21 cost time: 0.528249979019165
Epoch: 21, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.5672471523284912
Epoch: 22, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.247 Vali Acc: 0.952 Test Loss: 0.247 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 23 cost time: 0.4712066650390625
Epoch: 23, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.230 Vali Acc: 0.956 Test Loss: 0.230 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 24 cost time: 0.44826245307922363
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.46501684188842773
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.4916813373565674
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.5127325057983398
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.4876518249511719
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.4619128704071045
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.5240695476531982
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.47696685791015625
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.47167134284973145
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.44710826873779297
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.46855735778808594
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.4582197666168213
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.5081613063812256
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.4629671573638916
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.47307491302490234
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.4393320083618164
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.465609073638916
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 41 cost time: 0.4846663475036621
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 42 cost time: 0.4719874858856201
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 43 cost time: 0.46848249435424805
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 44 cost time: 0.515531063079834
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4918220043182373
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4192953109741211
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4561185836791992
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4701237678527832
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4699366092681885
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5160524845123291
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 2825094
model size : 10.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8004233837127686
Epoch: 1, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.721 Vali Acc: 0.333 Test Loss: 1.721 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 0.5280828475952148
Epoch: 2, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.697 Vali Acc: 0.411 Test Loss: 1.697 Test Acc: 0.411
Validation loss decreased (-0.333316 --> -0.411094).  Saving model ...
Epoch: 3 cost time: 0.5022761821746826
Epoch: 3, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.670 Vali Acc: 0.485 Test Loss: 1.670 Test Acc: 0.485
Validation loss decreased (-0.411094 --> -0.485168).  Saving model ...
Epoch: 4 cost time: 0.6083245277404785
Epoch: 4, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.631 Vali Acc: 0.544 Test Loss: 1.631 Test Acc: 0.544
Validation loss decreased (-0.485168 --> -0.544428).  Saving model ...
Epoch: 5 cost time: 0.4768331050872803
Epoch: 5, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.580 Vali Acc: 0.626 Test Loss: 1.580 Test Acc: 0.626
Validation loss decreased (-0.544428 --> -0.625910).  Saving model ...
Epoch: 6 cost time: 0.5020914077758789
Epoch: 6, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.516 Vali Acc: 0.689 Test Loss: 1.516 Test Acc: 0.689
Validation loss decreased (-0.625910 --> -0.688874).  Saving model ...
Epoch: 7 cost time: 0.567556619644165
Epoch: 7, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.443 Vali Acc: 0.748 Test Loss: 1.443 Test Acc: 0.748
Validation loss decreased (-0.688874 --> -0.748134).  Saving model ...
Epoch: 8 cost time: 0.5241336822509766
Epoch: 8, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.360 Vali Acc: 0.778 Test Loss: 1.360 Test Acc: 0.778
Validation loss decreased (-0.748134 --> -0.777764).  Saving model ...
Epoch: 9 cost time: 0.47308945655822754
Epoch: 9, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.269 Vali Acc: 0.807 Test Loss: 1.269 Test Acc: 0.807
Validation loss decreased (-0.777764 --> -0.807395).  Saving model ...
Epoch: 10 cost time: 0.5036435127258301
Epoch: 10, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.173 Vali Acc: 0.863 Test Loss: 1.173 Test Acc: 0.863
Validation loss decreased (-0.807395 --> -0.862951).  Saving model ...
Epoch: 11 cost time: 0.4682583808898926
Epoch: 11, Steps: 2 | Train Loss: 0.834 Vali Loss: 1.072 Vali Acc: 0.878 Test Loss: 1.072 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877767).  Saving model ...
Epoch: 12 cost time: 0.5643925666809082
Epoch: 12, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.971 Vali Acc: 0.896 Test Loss: 0.971 Test Acc: 0.896
Validation loss decreased (-0.877767 --> -0.896287).  Saving model ...
Epoch: 13 cost time: 0.501000165939331
Epoch: 13, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.871 Vali Acc: 0.911 Test Loss: 0.871 Test Acc: 0.911
Validation loss decreased (-0.896287 --> -0.911102).  Saving model ...
Epoch: 14 cost time: 0.46799397468566895
Epoch: 14, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.775 Vali Acc: 0.922 Test Loss: 0.775 Test Acc: 0.922
Validation loss decreased (-0.911102 --> -0.922214).  Saving model ...
Epoch: 15 cost time: 0.46489596366882324
Epoch: 15, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.686 Vali Acc: 0.937 Test Loss: 0.686 Test Acc: 0.937
Validation loss decreased (-0.922214 --> -0.937030).  Saving model ...
Epoch: 16 cost time: 0.5196149349212646
Epoch: 16, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.607 Vali Acc: 0.941 Test Loss: 0.607 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940735).  Saving model ...
Epoch: 17 cost time: 0.556969165802002
Epoch: 17, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.538 Vali Acc: 0.944 Test Loss: 0.538 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 18 cost time: 0.5495493412017822
Epoch: 18, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.477 Vali Acc: 0.959 Test Loss: 0.477 Test Acc: 0.959
Validation loss decreased (-0.944439 --> -0.959254).  Saving model ...
Epoch: 19 cost time: 0.5141270160675049
Epoch: 19, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.426 Vali Acc: 0.959 Test Loss: 0.426 Test Acc: 0.959
Validation loss decreased (-0.959254 --> -0.959255).  Saving model ...
Epoch: 20 cost time: 0.47170400619506836
Epoch: 20, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.384 Vali Acc: 0.959 Test Loss: 0.384 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959255).  Saving model ...
Epoch: 21 cost time: 0.5079283714294434
Epoch: 21, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.348 Vali Acc: 0.959 Test Loss: 0.348 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959256).  Saving model ...
Epoch: 22 cost time: 0.4898519515991211
Epoch: 22, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.318 Vali Acc: 0.959 Test Loss: 0.318 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 23 cost time: 0.4845898151397705
Epoch: 23, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.294 Vali Acc: 0.959 Test Loss: 0.294 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 24 cost time: 0.5247681140899658
Epoch: 24, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.275 Vali Acc: 0.959 Test Loss: 0.275 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 25 cost time: 0.5594871044158936
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.258 Vali Acc: 0.959 Test Loss: 0.258 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 26 cost time: 0.4923117160797119
Epoch: 26, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.245 Vali Acc: 0.959 Test Loss: 0.245 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.4638509750366211
Epoch: 27, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 28 cost time: 0.47438526153564453
Epoch: 28, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.463062047958374
Epoch: 29, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.4832000732421875
Epoch: 30, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.4632833003997803
Epoch: 31, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.4871194362640381
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.5747280120849609
Epoch: 33, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 34 cost time: 0.47574925422668457
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 35 cost time: 0.4610919952392578
Epoch: 35, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 36 cost time: 0.6349427700042725
Epoch: 36, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 37 cost time: 0.4606809616088867
Epoch: 37, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 38 cost time: 0.4559509754180908
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 39 cost time: 0.4817683696746826
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 40 cost time: 0.46349549293518066
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 41 cost time: 0.4522416591644287
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 42 cost time: 0.46954894065856934
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 43 cost time: 0.5017876625061035
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 44 cost time: 0.5929317474365234
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 45 cost time: 0.5250523090362549
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 46 cost time: 0.5211939811706543
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 47 cost time: 0.5293288230895996
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 48 cost time: 0.5304675102233887
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 49 cost time: 0.6203973293304443
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 50 cost time: 0.5323944091796875
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 2813190
model size : 10.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8090934753417969
Epoch: 1, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.747 Vali Acc: 0.211 Test Loss: 1.747 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.42591261863708496
Epoch: 2, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.727 Vali Acc: 0.270 Test Loss: 1.727 Test Acc: 0.270
Validation loss decreased (-0.211094 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.4359245300292969
Epoch: 3, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.703 Vali Acc: 0.315 Test Loss: 1.703 Test Acc: 0.315
Validation loss decreased (-0.270353 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.46643877029418945
Epoch: 4, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.668 Vali Acc: 0.411 Test Loss: 1.668 Test Acc: 0.411
Validation loss decreased (-0.314798 --> -0.411094).  Saving model ...
Epoch: 5 cost time: 0.4414553642272949
Epoch: 5, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.621 Vali Acc: 0.611 Test Loss: 1.621 Test Acc: 0.611
Validation loss decreased (-0.411094 --> -0.611095).  Saving model ...
Epoch: 6 cost time: 0.43557143211364746
Epoch: 6, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.563 Vali Acc: 0.763 Test Loss: 1.563 Test Acc: 0.763
Validation loss decreased (-0.611095 --> -0.762947).  Saving model ...
Epoch: 7 cost time: 0.4439103603363037
Epoch: 7, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.496 Vali Acc: 0.819 Test Loss: 1.496 Test Acc: 0.819
Validation loss decreased (-0.762947 --> -0.818504).  Saving model ...
Epoch: 8 cost time: 0.44803595542907715
Epoch: 8, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.419 Vali Acc: 0.874 Test Loss: 1.419 Test Acc: 0.874
Validation loss decreased (-0.818504 --> -0.874060).  Saving model ...
Epoch: 9 cost time: 0.4640355110168457
Epoch: 9, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.337 Vali Acc: 0.904 Test Loss: 1.337 Test Acc: 0.904
Validation loss decreased (-0.874060 --> -0.903690).  Saving model ...
Epoch: 10 cost time: 0.49364614486694336
Epoch: 10, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.248 Vali Acc: 0.915 Test Loss: 1.248 Test Acc: 0.915
Validation loss decreased (-0.903690 --> -0.914802).  Saving model ...
Epoch: 11 cost time: 0.5205719470977783
Epoch: 11, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.154 Vali Acc: 0.922 Test Loss: 1.154 Test Acc: 0.922
Validation loss decreased (-0.914802 --> -0.922211).  Saving model ...
Epoch: 12 cost time: 0.4595832824707031
Epoch: 12, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.057 Vali Acc: 0.930 Test Loss: 1.057 Test Acc: 0.930
Validation loss decreased (-0.922211 --> -0.929619).  Saving model ...
Epoch: 13 cost time: 0.4754190444946289
Epoch: 13, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.959 Vali Acc: 0.933 Test Loss: 0.959 Test Acc: 0.933
Validation loss decreased (-0.929619 --> -0.933324).  Saving model ...
Epoch: 14 cost time: 0.4698495864868164
Epoch: 14, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.863 Vali Acc: 0.941 Test Loss: 0.863 Test Acc: 0.941
Validation loss decreased (-0.933324 --> -0.940732).  Saving model ...
Epoch: 15 cost time: 0.4446225166320801
Epoch: 15, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.772 Vali Acc: 0.941 Test Loss: 0.772 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940733).  Saving model ...
Epoch: 16 cost time: 0.4325268268585205
Epoch: 16, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.689 Vali Acc: 0.937 Test Loss: 0.689 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.43176937103271484
Epoch: 17, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.614 Vali Acc: 0.941 Test Loss: 0.614 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940735).  Saving model ...
Epoch: 18 cost time: 0.42701220512390137
Epoch: 18, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.547 Vali Acc: 0.941 Test Loss: 0.547 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 19 cost time: 0.4338834285736084
Epoch: 19, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.490 Vali Acc: 0.944 Test Loss: 0.490 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944440).  Saving model ...
Epoch: 20 cost time: 0.38824963569641113
Epoch: 20, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.442 Vali Acc: 0.948 Test Loss: 0.442 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 21 cost time: 0.46335744857788086
Epoch: 21, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.400 Vali Acc: 0.952 Test Loss: 0.400 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 22 cost time: 0.4683854579925537
Epoch: 22, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.366 Vali Acc: 0.952 Test Loss: 0.366 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 23 cost time: 0.39970850944519043
Epoch: 23, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.338 Vali Acc: 0.952 Test Loss: 0.338 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 24 cost time: 0.4412078857421875
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.314 Vali Acc: 0.956 Test Loss: 0.314 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 25 cost time: 0.5263814926147461
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.293 Vali Acc: 0.959 Test Loss: 0.293 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 26 cost time: 0.42339396476745605
Epoch: 26, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.276 Vali Acc: 0.959 Test Loss: 0.276 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 27 cost time: 0.4388599395751953
Epoch: 27, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.262 Vali Acc: 0.959 Test Loss: 0.262 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 28 cost time: 0.40557169914245605
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.959 Test Loss: 0.250 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.4619865417480469
Epoch: 29, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.239 Vali Acc: 0.959 Test Loss: 0.239 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.4466848373413086
Epoch: 30, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.959 Test Loss: 0.231 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.4478614330291748
Epoch: 31, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.44852399826049805
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 33 cost time: 0.4595303535461426
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 34 cost time: 0.4391210079193115
Epoch: 34, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.47806811332702637
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 36 cost time: 0.47624826431274414
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 37 cost time: 0.48574137687683105
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 38 cost time: 0.5133605003356934
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 39 cost time: 0.4508504867553711
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 40 cost time: 0.5096499919891357
Epoch: 40, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.4866945743560791
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.4794325828552246
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 43 cost time: 0.4693562984466553
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.47147035598754883
Epoch: 44, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.43847084045410156
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 46 cost time: 0.5091845989227295
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.4785161018371582
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.4747653007507324
Epoch: 48, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.49268102645874023
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.45191240310668945
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 2807558
model size : 10.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6920099258422852
Epoch: 1, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.788 Vali Acc: 0.178 Test Loss: 1.788 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.4565610885620117
Epoch: 2, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.748 Vali Acc: 0.215 Test Loss: 1.748 Test Acc: 0.215
Validation loss decreased (-0.177760 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.3929171562194824
Epoch: 3, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.700 Vali Acc: 0.259 Test Loss: 1.700 Test Acc: 0.259
Validation loss decreased (-0.214797 --> -0.259242).  Saving model ...
Epoch: 4 cost time: 0.457385778427124
Epoch: 4, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.621 Vali Acc: 0.363 Test Loss: 1.621 Test Acc: 0.363
Validation loss decreased (-0.259242 --> -0.362947).  Saving model ...
Epoch: 5 cost time: 0.43059706687927246
Epoch: 5, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.518 Vali Acc: 0.552 Test Loss: 1.518 Test Acc: 0.552
Validation loss decreased (-0.362947 --> -0.551837).  Saving model ...
Epoch: 6 cost time: 0.40296387672424316
Epoch: 6, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.397 Vali Acc: 0.733 Test Loss: 1.397 Test Acc: 0.733
Validation loss decreased (-0.551837 --> -0.733319).  Saving model ...
Epoch: 7 cost time: 0.4446570873260498
Epoch: 7, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.263 Vali Acc: 0.830 Test Loss: 1.263 Test Acc: 0.830
Validation loss decreased (-0.733319 --> -0.829617).  Saving model ...
Epoch: 8 cost time: 0.39318013191223145
Epoch: 8, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.122 Vali Acc: 0.848 Test Loss: 1.122 Test Acc: 0.848
Validation loss decreased (-0.829617 --> -0.848137).  Saving model ...
Epoch: 9 cost time: 0.3836548328399658
Epoch: 9, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.980 Vali Acc: 0.893 Test Loss: 0.980 Test Acc: 0.893
Validation loss decreased (-0.848137 --> -0.892583).  Saving model ...
Epoch: 10 cost time: 0.4498019218444824
Epoch: 10, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.845 Vali Acc: 0.907 Test Loss: 0.845 Test Acc: 0.907
Validation loss decreased (-0.892583 --> -0.907399).  Saving model ...
Epoch: 11 cost time: 0.41613292694091797
Epoch: 11, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.718 Vali Acc: 0.915 Test Loss: 0.718 Test Acc: 0.915
Validation loss decreased (-0.907399 --> -0.914808).  Saving model ...
Epoch: 12 cost time: 0.4646921157836914
Epoch: 12, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.605 Vali Acc: 0.922 Test Loss: 0.605 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 13 cost time: 0.41211533546447754
Epoch: 13, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.506 Vali Acc: 0.933 Test Loss: 0.506 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 14 cost time: 0.3937387466430664
Epoch: 14, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.426 Vali Acc: 0.937 Test Loss: 0.426 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 15 cost time: 0.4594388008117676
Epoch: 15, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.358 Vali Acc: 0.944 Test Loss: 0.358 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.42952990531921387
Epoch: 16, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.4292936325073242
Epoch: 17, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4345512390136719
Epoch: 18, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.43183445930480957
Epoch: 19, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.43723225593566895
Epoch: 20, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.45568132400512695
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.43936920166015625
Epoch: 22, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 23 cost time: 0.43413352966308594
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 24 cost time: 0.4217095375061035
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 0.46535420417785645
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 0.47299790382385254
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.4443483352661133
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.43802547454833984
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.420391321182251
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.5399327278137207
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.42755651473999023
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.42958855628967285
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.4987068176269531
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.4536092281341553
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.43915414810180664
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4373300075531006
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.42230892181396484
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.441927433013916
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 39 cost time: 0.47794246673583984
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.959258 --> -0.962961).  Saving model ...
Epoch: 40 cost time: 0.5020449161529541
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5025715827941895
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4220399856567383
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4366433620452881
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4336240291595459
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 45 cost time: 0.44600367546081543
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 46 cost time: 0.4185924530029297
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.49583005905151367
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 48 cost time: 0.4355754852294922
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4260220527648926
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4404728412628174
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 820166
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7899105548858643
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.755 Vali Acc: 0.233 Test Loss: 1.755 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.3947877883911133
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.728 Vali Acc: 0.259 Test Loss: 1.728 Test Acc: 0.259
Validation loss decreased (-0.233316 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.4666428565979004
Epoch: 3, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.699 Vali Acc: 0.300 Test Loss: 1.699 Test Acc: 0.300
Validation loss decreased (-0.259242 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.4208102226257324
Epoch: 4, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.658 Vali Acc: 0.430 Test Loss: 1.658 Test Acc: 0.430
Validation loss decreased (-0.299983 --> -0.429613).  Saving model ...
Epoch: 5 cost time: 0.40868306159973145
Epoch: 5, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.604 Vali Acc: 0.585 Test Loss: 1.604 Test Acc: 0.585
Validation loss decreased (-0.429613 --> -0.585169).  Saving model ...
Epoch: 6 cost time: 0.3864443302154541
Epoch: 6, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.537 Vali Acc: 0.715 Test Loss: 1.537 Test Acc: 0.715
Validation loss decreased (-0.585169 --> -0.714799).  Saving model ...
Epoch: 7 cost time: 0.43416929244995117
Epoch: 7, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.459 Vali Acc: 0.767 Test Loss: 1.459 Test Acc: 0.767
Validation loss decreased (-0.714799 --> -0.766652).  Saving model ...
Epoch: 8 cost time: 0.38161659240722656
Epoch: 8, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.372 Vali Acc: 0.796 Test Loss: 1.372 Test Acc: 0.796
Validation loss decreased (-0.766652 --> -0.796283).  Saving model ...
Epoch: 9 cost time: 0.4824104309082031
Epoch: 9, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.278 Vali Acc: 0.833 Test Loss: 1.278 Test Acc: 0.833
Validation loss decreased (-0.796283 --> -0.833321).  Saving model ...
Epoch: 10 cost time: 0.38837575912475586
Epoch: 10, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.178 Vali Acc: 0.867 Test Loss: 1.178 Test Acc: 0.867
Validation loss decreased (-0.833321 --> -0.866655).  Saving model ...
Epoch: 11 cost time: 0.4228947162628174
Epoch: 11, Steps: 2 | Train Loss: 0.872 Vali Loss: 1.073 Vali Acc: 0.889 Test Loss: 1.073 Test Acc: 0.889
Validation loss decreased (-0.866655 --> -0.888878).  Saving model ...
Epoch: 12 cost time: 0.3777811527252197
Epoch: 12, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.967 Vali Acc: 0.896 Test Loss: 0.967 Test Acc: 0.896
Validation loss decreased (-0.888878 --> -0.896287).  Saving model ...
Epoch: 13 cost time: 0.3984088897705078
Epoch: 13, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.864 Vali Acc: 0.907 Test Loss: 0.864 Test Acc: 0.907
Validation loss decreased (-0.896287 --> -0.907399).  Saving model ...
Epoch: 14 cost time: 0.4174647331237793
Epoch: 14, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.768 Vali Acc: 0.907 Test Loss: 0.768 Test Acc: 0.907
Validation loss decreased (-0.907399 --> -0.907400).  Saving model ...
Epoch: 15 cost time: 0.5861001014709473
Epoch: 15, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.677 Vali Acc: 0.907 Test Loss: 0.677 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 16 cost time: 0.40102243423461914
Epoch: 16, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.594 Vali Acc: 0.919 Test Loss: 0.594 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 17 cost time: 0.4382014274597168
Epoch: 17, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.522 Vali Acc: 0.915 Test Loss: 0.522 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.39360618591308594
Epoch: 18, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.459 Vali Acc: 0.915 Test Loss: 0.459 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.42778658866882324
Epoch: 19, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.407 Vali Acc: 0.915 Test Loss: 0.407 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.388671875
Epoch: 20, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.4423689842224121
Epoch: 21, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.332 Vali Acc: 0.919 Test Loss: 0.332 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42822265625
Epoch: 22, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.4090538024902344
Epoch: 23, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 0.40204334259033203
Epoch: 24, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.4153563976287842
Epoch: 25, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 0.40375661849975586
Epoch: 26, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.4424312114715576
Epoch: 27, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4372751712799072
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.39896607398986816
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.4144587516784668
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.43413257598876953
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.44110560417175293
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.4217352867126465
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.40930676460266113
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.45624780654907227
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.3740241527557373
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.4156801700592041
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.4051930904388428
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.391979455947876
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.42238616943359375
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4362223148345947
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.47423815727233887
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.46186280250549316
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.46512722969055176
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.44167542457580566
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.43204760551452637
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4125251770019531
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.41546010971069336
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5220088958740234
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4201083183288574
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 768070
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8903582096099854
Epoch: 1, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.776 Vali Acc: 0.141 Test Loss: 1.776 Test Acc: 0.141
Validation loss decreased (inf --> -0.140723).  Saving model ...
Epoch: 2 cost time: 0.45350050926208496
Epoch: 2, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.750 Vali Acc: 0.167 Test Loss: 1.750 Test Acc: 0.167
Validation loss decreased (-0.140723 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.4282660484313965
Epoch: 3, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.725 Vali Acc: 0.226 Test Loss: 1.725 Test Acc: 0.226
Validation loss decreased (-0.166649 --> -0.225909).  Saving model ...
Epoch: 4 cost time: 0.42434191703796387
Epoch: 4, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.692 Vali Acc: 0.326 Test Loss: 1.692 Test Acc: 0.326
Validation loss decreased (-0.225909 --> -0.325909).  Saving model ...
Epoch: 5 cost time: 0.4373443126678467
Epoch: 5, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.647 Vali Acc: 0.496 Test Loss: 1.647 Test Acc: 0.496
Validation loss decreased (-0.325909 --> -0.496280).  Saving model ...
Epoch: 6 cost time: 0.3978269100189209
Epoch: 6, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.594 Vali Acc: 0.630 Test Loss: 1.594 Test Acc: 0.630
Validation loss decreased (-0.496280 --> -0.629614).  Saving model ...
Epoch: 7 cost time: 0.39134669303894043
Epoch: 7, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.531 Vali Acc: 0.719 Test Loss: 1.531 Test Acc: 0.719
Validation loss decreased (-0.629614 --> -0.718503).  Saving model ...
Epoch: 8 cost time: 0.45104408264160156
Epoch: 8, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.460 Vali Acc: 0.774 Test Loss: 1.460 Test Acc: 0.774
Validation loss decreased (-0.718503 --> -0.774059).  Saving model ...
Epoch: 9 cost time: 0.4085979461669922
Epoch: 9, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.381 Vali Acc: 0.800 Test Loss: 1.381 Test Acc: 0.800
Validation loss decreased (-0.774059 --> -0.799986).  Saving model ...
Epoch: 10 cost time: 0.40409159660339355
Epoch: 10, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.296 Vali Acc: 0.815 Test Loss: 1.296 Test Acc: 0.815
Validation loss decreased (-0.799986 --> -0.814802).  Saving model ...
Epoch: 11 cost time: 0.40241122245788574
Epoch: 11, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.206 Vali Acc: 0.826 Test Loss: 1.206 Test Acc: 0.826
Validation loss decreased (-0.814802 --> -0.825914).  Saving model ...
Epoch: 12 cost time: 0.38646554946899414
Epoch: 12, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.114 Vali Acc: 0.856 Test Loss: 1.114 Test Acc: 0.856
Validation loss decreased (-0.825914 --> -0.855544).  Saving model ...
Epoch: 13 cost time: 0.5014848709106445
Epoch: 13, Steps: 2 | Train Loss: 0.805 Vali Loss: 1.020 Vali Acc: 0.878 Test Loss: 1.020 Test Acc: 0.878
Validation loss decreased (-0.855544 --> -0.877768).  Saving model ...
Epoch: 14 cost time: 0.40894079208374023
Epoch: 14, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.925 Vali Acc: 0.878 Test Loss: 0.925 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877769).  Saving model ...
Epoch: 15 cost time: 0.4075148105621338
Epoch: 15, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.832 Vali Acc: 0.893 Test Loss: 0.832 Test Acc: 0.893
Validation loss decreased (-0.877769 --> -0.892584).  Saving model ...
Epoch: 16 cost time: 0.4398765563964844
Epoch: 16, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.743 Vali Acc: 0.889 Test Loss: 0.743 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.42606019973754883
Epoch: 17, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.660 Vali Acc: 0.900 Test Loss: 0.660 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.4514482021331787
Epoch: 18, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.585 Vali Acc: 0.922 Test Loss: 0.585 Test Acc: 0.922
Validation loss decreased (-0.899993 --> -0.922216).  Saving model ...
Epoch: 19 cost time: 0.41571521759033203
Epoch: 19, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.519 Vali Acc: 0.919 Test Loss: 0.519 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4109466075897217
Epoch: 20, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.462 Vali Acc: 0.922 Test Loss: 0.462 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.42696666717529297
Epoch: 21, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.412 Vali Acc: 0.930 Test Loss: 0.412 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 22 cost time: 0.40026354789733887
Epoch: 22, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 23 cost time: 0.40436863899230957
Epoch: 23, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940737).  Saving model ...
Epoch: 24 cost time: 0.42465662956237793
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 0.3993861675262451
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4189300537109375
Epoch: 26, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4565715789794922
Epoch: 27, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4141654968261719
Epoch: 28, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.3818166255950928
Epoch: 29, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.45679402351379395
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.42433834075927734
Epoch: 31, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4205019474029541
Epoch: 32, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4267144203186035
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.39002013206481934
Epoch: 34, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.44290733337402344
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.3877742290496826
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 752774
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.679893970489502
Epoch: 1, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.768 Vali Acc: 0.185 Test Loss: 1.768 Test Acc: 0.185
Validation loss decreased (inf --> -0.185168).  Saving model ...
Epoch: 2 cost time: 0.3769690990447998
Epoch: 2, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.749 Vali Acc: 0.285 Test Loss: 1.749 Test Acc: 0.285
Validation loss decreased (-0.185168 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.4077785015106201
Epoch: 3, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.730 Vali Acc: 0.367 Test Loss: 1.730 Test Acc: 0.367
Validation loss decreased (-0.285168 --> -0.366649).  Saving model ...
Epoch: 4 cost time: 0.4504539966583252
Epoch: 4, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.706 Vali Acc: 0.481 Test Loss: 1.706 Test Acc: 0.481
Validation loss decreased (-0.366649 --> -0.481464).  Saving model ...
Epoch: 5 cost time: 0.41387271881103516
Epoch: 5, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.673 Vali Acc: 0.600 Test Loss: 1.673 Test Acc: 0.600
Validation loss decreased (-0.481464 --> -0.599983).  Saving model ...
Epoch: 6 cost time: 0.42171454429626465
Epoch: 6, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.633 Vali Acc: 0.670 Test Loss: 1.633 Test Acc: 0.670
Validation loss decreased (-0.599983 --> -0.670354).  Saving model ...
Epoch: 7 cost time: 0.40459108352661133
Epoch: 7, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.586 Vali Acc: 0.756 Test Loss: 1.586 Test Acc: 0.756
Validation loss decreased (-0.670354 --> -0.755540).  Saving model ...
Epoch: 8 cost time: 0.44284749031066895
Epoch: 8, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.532 Vali Acc: 0.804 Test Loss: 1.532 Test Acc: 0.804
Validation loss decreased (-0.755540 --> -0.803688).  Saving model ...
Epoch: 9 cost time: 0.41092419624328613
Epoch: 9, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.472 Vali Acc: 0.833 Test Loss: 1.472 Test Acc: 0.833
Validation loss decreased (-0.803688 --> -0.833319).  Saving model ...
Epoch: 10 cost time: 0.3941688537597656
Epoch: 10, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.406 Vali Acc: 0.848 Test Loss: 1.406 Test Acc: 0.848
Validation loss decreased (-0.833319 --> -0.848134).  Saving model ...
Epoch: 11 cost time: 0.3765866756439209
Epoch: 11, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.334 Vali Acc: 0.870 Test Loss: 1.334 Test Acc: 0.870
Validation loss decreased (-0.848134 --> -0.870357).  Saving model ...
Epoch: 12 cost time: 0.4167599678039551
Epoch: 12, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.257 Vali Acc: 0.889 Test Loss: 1.257 Test Acc: 0.889
Validation loss decreased (-0.870357 --> -0.888876).  Saving model ...
Epoch: 13 cost time: 0.4279322624206543
Epoch: 13, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.176 Vali Acc: 0.900 Test Loss: 1.176 Test Acc: 0.900
Validation loss decreased (-0.888876 --> -0.899988).  Saving model ...
Epoch: 14 cost time: 0.42609524726867676
Epoch: 14, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.093 Vali Acc: 0.911 Test Loss: 1.093 Test Acc: 0.911
Validation loss decreased (-0.899988 --> -0.911100).  Saving model ...
Epoch: 15 cost time: 0.4063749313354492
Epoch: 15, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.009 Vali Acc: 0.919 Test Loss: 1.009 Test Acc: 0.919
Validation loss decreased (-0.911100 --> -0.918508).  Saving model ...
Epoch: 16 cost time: 0.4511845111846924
Epoch: 16, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.926 Vali Acc: 0.926 Test Loss: 0.926 Test Acc: 0.926
Validation loss decreased (-0.918508 --> -0.925917).  Saving model ...
Epoch: 17 cost time: 0.3982095718383789
Epoch: 17, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.845 Vali Acc: 0.926 Test Loss: 0.845 Test Acc: 0.926
Validation loss decreased (-0.925917 --> -0.925917).  Saving model ...
Epoch: 18 cost time: 0.424407958984375
Epoch: 18, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.766 Vali Acc: 0.930 Test Loss: 0.766 Test Acc: 0.930
Validation loss decreased (-0.925917 --> -0.929622).  Saving model ...
Epoch: 19 cost time: 0.4063737392425537
Epoch: 19, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.693 Vali Acc: 0.933 Test Loss: 0.693 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933326).  Saving model ...
Epoch: 20 cost time: 0.4604306221008301
Epoch: 20, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.627 Vali Acc: 0.933 Test Loss: 0.627 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933327).  Saving model ...
Epoch: 21 cost time: 0.4412693977355957
Epoch: 21, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.567 Vali Acc: 0.941 Test Loss: 0.567 Test Acc: 0.941
Validation loss decreased (-0.933327 --> -0.940735).  Saving model ...
Epoch: 22 cost time: 0.4191932678222656
Epoch: 22, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.513 Vali Acc: 0.944 Test Loss: 0.513 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 23 cost time: 0.4952266216278076
Epoch: 23, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.467 Vali Acc: 0.948 Test Loss: 0.467 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 24 cost time: 0.4043426513671875
Epoch: 24, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.427 Vali Acc: 0.944 Test Loss: 0.427 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4435408115386963
Epoch: 25, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.392 Vali Acc: 0.952 Test Loss: 0.392 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951848).  Saving model ...
Epoch: 26 cost time: 0.43310999870300293
Epoch: 26, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.361 Vali Acc: 0.952 Test Loss: 0.361 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 27 cost time: 0.4345877170562744
Epoch: 27, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.336 Vali Acc: 0.952 Test Loss: 0.336 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 28 cost time: 0.4716167449951172
Epoch: 28, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.314 Vali Acc: 0.959 Test Loss: 0.314 Test Acc: 0.959
Validation loss decreased (-0.951848 --> -0.959256).  Saving model ...
Epoch: 29 cost time: 0.3916025161743164
Epoch: 29, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.295 Vali Acc: 0.963 Test Loss: 0.295 Test Acc: 0.963
Validation loss decreased (-0.959256 --> -0.962960).  Saving model ...
Epoch: 30 cost time: 0.531745433807373
Epoch: 30, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.279 Vali Acc: 0.959 Test Loss: 0.279 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.39702582359313965
Epoch: 31, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.266 Vali Acc: 0.959 Test Loss: 0.266 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.42069506645202637
Epoch: 32, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.38983941078186035
Epoch: 33, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.245 Vali Acc: 0.959 Test Loss: 0.245 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.45313477516174316
Epoch: 34, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.237 Vali Acc: 0.959 Test Loss: 0.237 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4162619113922119
Epoch: 35, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4258139133453369
Epoch: 36, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.40193819999694824
Epoch: 37, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4277520179748535
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.39510512351989746
Epoch: 39, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 743686
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8128621578216553
Epoch: 1, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.774 Vali Acc: 0.230 Test Loss: 1.774 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.38648009300231934
Epoch: 2, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.755 Vali Acc: 0.278 Test Loss: 1.755 Test Acc: 0.278
Validation loss decreased (-0.229612 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.39324402809143066
Epoch: 3, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.735 Vali Acc: 0.333 Test Loss: 1.735 Test Acc: 0.333
Validation loss decreased (-0.277760 --> -0.333316).  Saving model ...
Epoch: 4 cost time: 0.4132394790649414
Epoch: 4, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.710 Vali Acc: 0.389 Test Loss: 1.710 Test Acc: 0.389
Validation loss decreased (-0.333316 --> -0.388872).  Saving model ...
Epoch: 5 cost time: 0.42975401878356934
Epoch: 5, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.678 Vali Acc: 0.467 Test Loss: 1.678 Test Acc: 0.467
Validation loss decreased (-0.388872 --> -0.466650).  Saving model ...
Epoch: 6 cost time: 0.3855907917022705
Epoch: 6, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.639 Vali Acc: 0.537 Test Loss: 1.639 Test Acc: 0.537
Validation loss decreased (-0.466650 --> -0.537021).  Saving model ...
Epoch: 7 cost time: 0.4123685359954834
Epoch: 7, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.594 Vali Acc: 0.685 Test Loss: 1.594 Test Acc: 0.685
Validation loss decreased (-0.537021 --> -0.685169).  Saving model ...
Epoch: 8 cost time: 0.3830280303955078
Epoch: 8, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.542 Vali Acc: 0.767 Test Loss: 1.542 Test Acc: 0.767
Validation loss decreased (-0.685169 --> -0.766651).  Saving model ...
Epoch: 9 cost time: 0.3759589195251465
Epoch: 9, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.484 Vali Acc: 0.804 Test Loss: 1.484 Test Acc: 0.804
Validation loss decreased (-0.766651 --> -0.803689).  Saving model ...
Epoch: 10 cost time: 0.4253201484680176
Epoch: 10, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.421 Vali Acc: 0.837 Test Loss: 1.421 Test Acc: 0.837
Validation loss decreased (-0.803689 --> -0.837023).  Saving model ...
Epoch: 11 cost time: 0.40458035469055176
Epoch: 11, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.353 Vali Acc: 0.859 Test Loss: 1.353 Test Acc: 0.859
Validation loss decreased (-0.837023 --> -0.859246).  Saving model ...
Epoch: 12 cost time: 0.40754222869873047
Epoch: 12, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.282 Vali Acc: 0.867 Test Loss: 1.282 Test Acc: 0.867
Validation loss decreased (-0.859246 --> -0.866654).  Saving model ...
Epoch: 13 cost time: 0.4145011901855469
Epoch: 13, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.208 Vali Acc: 0.878 Test Loss: 1.208 Test Acc: 0.878
Validation loss decreased (-0.866654 --> -0.877766).  Saving model ...
Epoch: 14 cost time: 0.38678455352783203
Epoch: 14, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.132 Vali Acc: 0.885 Test Loss: 1.132 Test Acc: 0.885
Validation loss decreased (-0.877766 --> -0.885174).  Saving model ...
Epoch: 15 cost time: 0.3844640254974365
Epoch: 15, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.054 Vali Acc: 0.896 Test Loss: 1.054 Test Acc: 0.896
Validation loss decreased (-0.885174 --> -0.896286).  Saving model ...
Epoch: 16 cost time: 0.370105504989624
Epoch: 16, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.976 Vali Acc: 0.904 Test Loss: 0.976 Test Acc: 0.904
Validation loss decreased (-0.896286 --> -0.903694).  Saving model ...
Epoch: 17 cost time: 0.41747546195983887
Epoch: 17, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.900 Vali Acc: 0.915 Test Loss: 0.900 Test Acc: 0.915
Validation loss decreased (-0.903694 --> -0.914806).  Saving model ...
Epoch: 18 cost time: 0.41241931915283203
Epoch: 18, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.826 Vali Acc: 0.919 Test Loss: 0.826 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918510).  Saving model ...
Epoch: 19 cost time: 0.3940572738647461
Epoch: 19, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.754 Vali Acc: 0.922 Test Loss: 0.754 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922215).  Saving model ...
Epoch: 20 cost time: 0.4047074317932129
Epoch: 20, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.688 Vali Acc: 0.926 Test Loss: 0.688 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 21 cost time: 0.44539666175842285
Epoch: 21, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.628 Vali Acc: 0.937 Test Loss: 0.628 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937031).  Saving model ...
Epoch: 22 cost time: 0.4203360080718994
Epoch: 22, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.574 Vali Acc: 0.937 Test Loss: 0.574 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 23 cost time: 0.4294257164001465
Epoch: 23, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.525 Vali Acc: 0.941 Test Loss: 0.525 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 24 cost time: 0.4160947799682617
Epoch: 24, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.481 Vali Acc: 0.941 Test Loss: 0.481 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 25 cost time: 0.38900041580200195
Epoch: 25, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.443 Vali Acc: 0.944 Test Loss: 0.443 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 26 cost time: 0.424424409866333
Epoch: 26, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.410 Vali Acc: 0.944 Test Loss: 0.410 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 27 cost time: 0.3808481693267822
Epoch: 27, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.381 Vali Acc: 0.948 Test Loss: 0.381 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 28 cost time: 0.4073190689086914
Epoch: 28, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.356 Vali Acc: 0.948 Test Loss: 0.356 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 29 cost time: 0.4252023696899414
Epoch: 29, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 30 cost time: 0.3975708484649658
Epoch: 30, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 31 cost time: 0.37935829162597656
Epoch: 31, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.299 Vali Acc: 0.948 Test Loss: 0.299 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.38875770568847656
Epoch: 32, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.42421865463256836
Epoch: 33, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 34 cost time: 0.40361571311950684
Epoch: 34, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.262 Vali Acc: 0.948 Test Loss: 0.262 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.4012136459350586
Epoch: 35, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.41098594665527344
Epoch: 36, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.4377107620239258
Epoch: 37, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.42490196228027344
Epoch: 38, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.4165341854095459
Epoch: 39, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.39661312103271484
Epoch: 40, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.222 Vali Acc: 0.959 Test Loss: 0.222 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.3722240924835205
Epoch: 41, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.4149665832519531
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 43 cost time: 0.4108419418334961
Epoch: 43, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.40123939514160156
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.39876604080200195
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 46 cost time: 0.3933446407318115
Epoch: 46, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 47 cost time: 0.3856775760650635
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 48 cost time: 0.38120555877685547
Epoch: 48, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 49 cost time: 0.41850805282592773
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 50 cost time: 0.3975546360015869
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 740806
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6209568977355957
Epoch: 1, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.764 Vali Acc: 0.304 Test Loss: 1.764 Test Acc: 0.304
Validation loss decreased (inf --> -0.303686).  Saving model ...
Epoch: 2 cost time: 0.38578152656555176
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.753 Vali Acc: 0.322 Test Loss: 1.753 Test Acc: 0.322
Validation loss decreased (-0.303686 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 0.4186561107635498
Epoch: 3, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.742 Vali Acc: 0.341 Test Loss: 1.742 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340723).  Saving model ...
Epoch: 4 cost time: 0.4512009620666504
Epoch: 4, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.728 Vali Acc: 0.363 Test Loss: 1.728 Test Acc: 0.363
Validation loss decreased (-0.340723 --> -0.362946).  Saving model ...
Epoch: 5 cost time: 0.4053325653076172
Epoch: 5, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.707 Vali Acc: 0.381 Test Loss: 1.707 Test Acc: 0.381
Validation loss decreased (-0.362946 --> -0.381464).  Saving model ...
Epoch: 6 cost time: 0.41498231887817383
Epoch: 6, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.681 Vali Acc: 0.415 Test Loss: 1.681 Test Acc: 0.415
Validation loss decreased (-0.381464 --> -0.414798).  Saving model ...
Epoch: 7 cost time: 0.43786120414733887
Epoch: 7, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.648 Vali Acc: 0.448 Test Loss: 1.648 Test Acc: 0.448
Validation loss decreased (-0.414798 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 0.4488058090209961
Epoch: 8, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.610 Vali Acc: 0.481 Test Loss: 1.610 Test Acc: 0.481
Validation loss decreased (-0.448132 --> -0.481465).  Saving model ...
Epoch: 9 cost time: 0.45771193504333496
Epoch: 9, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.566 Vali Acc: 0.533 Test Loss: 1.566 Test Acc: 0.533
Validation loss decreased (-0.481465 --> -0.533318).  Saving model ...
Epoch: 10 cost time: 0.3828456401824951
Epoch: 10, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.518 Vali Acc: 0.585 Test Loss: 1.518 Test Acc: 0.585
Validation loss decreased (-0.533318 --> -0.585170).  Saving model ...
Epoch: 11 cost time: 0.5176732540130615
Epoch: 11, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.466 Vali Acc: 0.663 Test Loss: 1.466 Test Acc: 0.663
Validation loss decreased (-0.585170 --> -0.662948).  Saving model ...
Epoch: 12 cost time: 0.4514129161834717
Epoch: 12, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.411 Vali Acc: 0.704 Test Loss: 1.411 Test Acc: 0.704
Validation loss decreased (-0.662948 --> -0.703690).  Saving model ...
Epoch: 13 cost time: 0.4045982360839844
Epoch: 13, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.351 Vali Acc: 0.737 Test Loss: 1.351 Test Acc: 0.737
Validation loss decreased (-0.703690 --> -0.737024).  Saving model ...
Epoch: 14 cost time: 0.42304444313049316
Epoch: 14, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.288 Vali Acc: 0.789 Test Loss: 1.288 Test Acc: 0.789
Validation loss decreased (-0.737024 --> -0.788876).  Saving model ...
Epoch: 15 cost time: 0.4056892395019531
Epoch: 15, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.223 Vali Acc: 0.833 Test Loss: 1.223 Test Acc: 0.833
Validation loss decreased (-0.788876 --> -0.833321).  Saving model ...
Epoch: 16 cost time: 0.41146230697631836
Epoch: 16, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.157 Vali Acc: 0.844 Test Loss: 1.157 Test Acc: 0.844
Validation loss decreased (-0.833321 --> -0.844433).  Saving model ...
Epoch: 17 cost time: 0.40736865997314453
Epoch: 17, Steps: 2 | Train Loss: 0.888 Vali Loss: 1.089 Vali Acc: 0.867 Test Loss: 1.089 Test Acc: 0.867
Validation loss decreased (-0.844433 --> -0.866656).  Saving model ...
Epoch: 18 cost time: 0.3832266330718994
Epoch: 18, Steps: 2 | Train Loss: 0.811 Vali Loss: 1.021 Vali Acc: 0.889 Test Loss: 1.021 Test Acc: 0.889
Validation loss decreased (-0.866656 --> -0.888879).  Saving model ...
Epoch: 19 cost time: 0.40912604331970215
Epoch: 19, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.954 Vali Acc: 0.889 Test Loss: 0.954 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 20 cost time: 0.4243505001068115
Epoch: 20, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.890 Vali Acc: 0.893 Test Loss: 0.890 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892584).  Saving model ...
Epoch: 21 cost time: 0.415590763092041
Epoch: 21, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.828 Vali Acc: 0.911 Test Loss: 0.828 Test Acc: 0.911
Validation loss decreased (-0.892584 --> -0.911103).  Saving model ...
Epoch: 22 cost time: 0.4163951873779297
Epoch: 22, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.770 Vali Acc: 0.919 Test Loss: 0.770 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918511).  Saving model ...
Epoch: 23 cost time: 0.4184732437133789
Epoch: 23, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.716 Vali Acc: 0.930 Test Loss: 0.716 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929622).  Saving model ...
Epoch: 24 cost time: 0.4426546096801758
Epoch: 24, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.666 Vali Acc: 0.933 Test Loss: 0.666 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933327).  Saving model ...
Epoch: 25 cost time: 0.43053126335144043
Epoch: 25, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.620 Vali Acc: 0.930 Test Loss: 0.620 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.46338891983032227
Epoch: 26, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.578 Vali Acc: 0.930 Test Loss: 0.578 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4042048454284668
Epoch: 27, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.541 Vali Acc: 0.933 Test Loss: 0.541 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 28 cost time: 0.38006138801574707
Epoch: 28, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.507 Vali Acc: 0.937 Test Loss: 0.507 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 29 cost time: 0.42162370681762695
Epoch: 29, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.475 Vali Acc: 0.937 Test Loss: 0.475 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 30 cost time: 0.40791964530944824
Epoch: 30, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.448 Vali Acc: 0.941 Test Loss: 0.448 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 31 cost time: 0.3775334358215332
Epoch: 31, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.422 Vali Acc: 0.941 Test Loss: 0.422 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 32 cost time: 0.39708542823791504
Epoch: 32, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.400 Vali Acc: 0.952 Test Loss: 0.400 Test Acc: 0.952
Validation loss decreased (-0.940737 --> -0.951848).  Saving model ...
Epoch: 33 cost time: 0.42619872093200684
Epoch: 33, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.381 Vali Acc: 0.956 Test Loss: 0.381 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 34 cost time: 0.39768528938293457
Epoch: 34, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.364 Vali Acc: 0.956 Test Loss: 0.364 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 35 cost time: 0.40521788597106934
Epoch: 35, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.348 Vali Acc: 0.956 Test Loss: 0.348 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 36 cost time: 0.4188356399536133
Epoch: 36, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.334 Vali Acc: 0.952 Test Loss: 0.334 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.47495555877685547
Epoch: 37, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.321 Vali Acc: 0.956 Test Loss: 0.321 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 38 cost time: 0.44838857650756836
Epoch: 38, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.403883695602417
Epoch: 39, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.299 Vali Acc: 0.952 Test Loss: 0.299 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.41089463233947754
Epoch: 40, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.290 Vali Acc: 0.952 Test Loss: 0.290 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4536597728729248
Epoch: 41, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.38935160636901855
Epoch: 42, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.273 Vali Acc: 0.956 Test Loss: 0.273 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.3883218765258789
Epoch: 43, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.266 Vali Acc: 0.956 Test Loss: 0.266 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.3832895755767822
Epoch: 44, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.259 Vali Acc: 0.959 Test Loss: 0.259 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.3839111328125
Epoch: 45, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 46 cost time: 0.4485001564025879
Epoch: 46, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.248 Vali Acc: 0.959 Test Loss: 0.248 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.45314931869506836
Epoch: 47, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.243 Vali Acc: 0.963 Test Loss: 0.243 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 48 cost time: 0.4152414798736572
Epoch: 48, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.239 Vali Acc: 0.963 Test Loss: 0.239 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 49 cost time: 0.4742865562438965
Epoch: 49, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.963 Test Loss: 0.235 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 50 cost time: 0.40657877922058105
Epoch: 50, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966664).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 734854
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7309248447418213
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.771 Vali Acc: 0.219 Test Loss: 1.771 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.46701645851135254
Epoch: 2, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.756 Vali Acc: 0.226 Test Loss: 1.756 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.36634206771850586
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.742 Vali Acc: 0.237 Test Loss: 1.742 Test Acc: 0.237
Validation loss decreased (-0.225908 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.3935225009918213
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.725 Vali Acc: 0.263 Test Loss: 1.725 Test Acc: 0.263
Validation loss decreased (-0.237020 --> -0.262946).  Saving model ...
Epoch: 5 cost time: 0.3889596462249756
Epoch: 5, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.704 Vali Acc: 0.289 Test Loss: 1.704 Test Acc: 0.289
Validation loss decreased (-0.262946 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.380648136138916
Epoch: 6, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.677 Vali Acc: 0.359 Test Loss: 1.677 Test Acc: 0.359
Validation loss decreased (-0.288872 --> -0.359242).  Saving model ...
Epoch: 7 cost time: 0.3803727626800537
Epoch: 7, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.646 Vali Acc: 0.459 Test Loss: 1.646 Test Acc: 0.459
Validation loss decreased (-0.359242 --> -0.459243).  Saving model ...
Epoch: 8 cost time: 0.4725818634033203
Epoch: 8, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.610 Vali Acc: 0.515 Test Loss: 1.610 Test Acc: 0.515
Validation loss decreased (-0.459243 --> -0.514799).  Saving model ...
Epoch: 9 cost time: 0.4294612407684326
Epoch: 9, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.571 Vali Acc: 0.570 Test Loss: 1.571 Test Acc: 0.570
Validation loss decreased (-0.514799 --> -0.570355).  Saving model ...
Epoch: 10 cost time: 0.41084742546081543
Epoch: 10, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.528 Vali Acc: 0.641 Test Loss: 1.528 Test Acc: 0.641
Validation loss decreased (-0.570355 --> -0.640725).  Saving model ...
Epoch: 11 cost time: 0.4039452075958252
Epoch: 11, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.481 Vali Acc: 0.700 Test Loss: 1.481 Test Acc: 0.700
Validation loss decreased (-0.640725 --> -0.699985).  Saving model ...
Epoch: 12 cost time: 0.409684419631958
Epoch: 12, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.431 Vali Acc: 0.748 Test Loss: 1.431 Test Acc: 0.748
Validation loss decreased (-0.699985 --> -0.748134).  Saving model ...
Epoch: 13 cost time: 0.41249871253967285
Epoch: 13, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.379 Vali Acc: 0.778 Test Loss: 1.379 Test Acc: 0.778
Validation loss decreased (-0.748134 --> -0.777764).  Saving model ...
Epoch: 14 cost time: 0.3974180221557617
Epoch: 14, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.323 Vali Acc: 0.815 Test Loss: 1.323 Test Acc: 0.815
Validation loss decreased (-0.777764 --> -0.814802).  Saving model ...
Epoch: 15 cost time: 0.43230319023132324
Epoch: 15, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.266 Vali Acc: 0.852 Test Loss: 1.266 Test Acc: 0.852
Validation loss decreased (-0.814802 --> -0.851839).  Saving model ...
Epoch: 16 cost time: 0.4315614700317383
Epoch: 16, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.207 Vali Acc: 0.874 Test Loss: 1.207 Test Acc: 0.874
Validation loss decreased (-0.851839 --> -0.874062).  Saving model ...
Epoch: 17 cost time: 0.42911291122436523
Epoch: 17, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.147 Vali Acc: 0.893 Test Loss: 1.147 Test Acc: 0.893
Validation loss decreased (-0.874062 --> -0.892581).  Saving model ...
Epoch: 18 cost time: 0.44078683853149414
Epoch: 18, Steps: 2 | Train Loss: 0.924 Vali Loss: 1.086 Vali Acc: 0.915 Test Loss: 1.086 Test Acc: 0.915
Validation loss decreased (-0.892581 --> -0.914804).  Saving model ...
Epoch: 19 cost time: 0.4670712947845459
Epoch: 19, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.026 Vali Acc: 0.922 Test Loss: 1.026 Test Acc: 0.922
Validation loss decreased (-0.914804 --> -0.922212).  Saving model ...
Epoch: 20 cost time: 0.4517385959625244
Epoch: 20, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.966 Vali Acc: 0.933 Test Loss: 0.966 Test Acc: 0.933
Validation loss decreased (-0.922212 --> -0.933324).  Saving model ...
Epoch: 21 cost time: 0.4302840232849121
Epoch: 21, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.908 Vali Acc: 0.941 Test Loss: 0.908 Test Acc: 0.941
Validation loss decreased (-0.933324 --> -0.940732).  Saving model ...
Epoch: 22 cost time: 0.4059915542602539
Epoch: 22, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.852 Vali Acc: 0.941 Test Loss: 0.852 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940732).  Saving model ...
Epoch: 23 cost time: 0.42424607276916504
Epoch: 23, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.798 Vali Acc: 0.941 Test Loss: 0.798 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940733).  Saving model ...
Epoch: 24 cost time: 0.42525744438171387
Epoch: 24, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.747 Vali Acc: 0.944 Test Loss: 0.747 Test Acc: 0.944
Validation loss decreased (-0.940733 --> -0.944437).  Saving model ...
Epoch: 25 cost time: 0.4503152370452881
Epoch: 25, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.699 Vali Acc: 0.944 Test Loss: 0.699 Test Acc: 0.944
Validation loss decreased (-0.944437 --> -0.944437).  Saving model ...
Epoch: 26 cost time: 0.45122694969177246
Epoch: 26, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.654 Vali Acc: 0.941 Test Loss: 0.654 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4472229480743408
Epoch: 27, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.613 Vali Acc: 0.937 Test Loss: 0.613 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4348459243774414
Epoch: 28, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.575 Vali Acc: 0.937 Test Loss: 0.575 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5055704116821289
Epoch: 29, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.540 Vali Acc: 0.937 Test Loss: 0.540 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.40267086029052734
Epoch: 30, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.508 Vali Acc: 0.937 Test Loss: 0.508 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.42590975761413574
Epoch: 31, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.479 Vali Acc: 0.933 Test Loss: 0.479 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.41598057746887207
Epoch: 32, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.453 Vali Acc: 0.933 Test Loss: 0.453 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4289522171020508
Epoch: 33, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.428 Vali Acc: 0.937 Test Loss: 0.428 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.40582752227783203
Epoch: 34, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.406 Vali Acc: 0.937 Test Loss: 0.406 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.4258241653442383
Epoch: 35, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.386 Vali Acc: 0.941 Test Loss: 0.386 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 732038
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.728987693786621
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.785 Vali Acc: 0.296 Test Loss: 1.785 Test Acc: 0.296
Validation loss decreased (inf --> -0.296278).  Saving model ...
Epoch: 2 cost time: 0.382521390914917
Epoch: 2, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.756 Vali Acc: 0.367 Test Loss: 1.756 Test Acc: 0.367
Validation loss decreased (-0.296278 --> -0.366649).  Saving model ...
Epoch: 3 cost time: 0.4582803249359131
Epoch: 3, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.726 Vali Acc: 0.404 Test Loss: 1.726 Test Acc: 0.404
Validation loss decreased (-0.366649 --> -0.403686).  Saving model ...
Epoch: 4 cost time: 0.4036533832550049
Epoch: 4, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.686 Vali Acc: 0.478 Test Loss: 1.686 Test Acc: 0.478
Validation loss decreased (-0.403686 --> -0.477761).  Saving model ...
Epoch: 5 cost time: 0.41658902168273926
Epoch: 5, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.633 Vali Acc: 0.519 Test Loss: 1.633 Test Acc: 0.519
Validation loss decreased (-0.477761 --> -0.518502).  Saving model ...
Epoch: 6 cost time: 0.4353013038635254
Epoch: 6, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.569 Vali Acc: 0.574 Test Loss: 1.569 Test Acc: 0.574
Validation loss decreased (-0.518502 --> -0.574058).  Saving model ...
Epoch: 7 cost time: 0.38780665397644043
Epoch: 7, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.496 Vali Acc: 0.652 Test Loss: 1.496 Test Acc: 0.652
Validation loss decreased (-0.574058 --> -0.651837).  Saving model ...
Epoch: 8 cost time: 0.39394068717956543
Epoch: 8, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.415 Vali Acc: 0.681 Test Loss: 1.415 Test Acc: 0.681
Validation loss decreased (-0.651837 --> -0.681467).  Saving model ...
Epoch: 9 cost time: 0.40326642990112305
Epoch: 9, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.327 Vali Acc: 0.741 Test Loss: 1.327 Test Acc: 0.741
Validation loss decreased (-0.681467 --> -0.740727).  Saving model ...
Epoch: 10 cost time: 0.44447827339172363
Epoch: 10, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.233 Vali Acc: 0.770 Test Loss: 1.233 Test Acc: 0.770
Validation loss decreased (-0.740727 --> -0.770358).  Saving model ...
Epoch: 11 cost time: 0.3759775161743164
Epoch: 11, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.136 Vali Acc: 0.807 Test Loss: 1.136 Test Acc: 0.807
Validation loss decreased (-0.770358 --> -0.807396).  Saving model ...
Epoch: 12 cost time: 0.3856055736541748
Epoch: 12, Steps: 2 | Train Loss: 0.804 Vali Loss: 1.039 Vali Acc: 0.837 Test Loss: 1.039 Test Acc: 0.837
Validation loss decreased (-0.807396 --> -0.837027).  Saving model ...
Epoch: 13 cost time: 0.38526439666748047
Epoch: 13, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.943 Vali Acc: 0.863 Test Loss: 0.943 Test Acc: 0.863
Validation loss decreased (-0.837027 --> -0.862954).  Saving model ...
Epoch: 14 cost time: 0.3727996349334717
Epoch: 14, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.850 Vali Acc: 0.889 Test Loss: 0.850 Test Acc: 0.889
Validation loss decreased (-0.862954 --> -0.888880).  Saving model ...
Epoch: 15 cost time: 0.3887357711791992
Epoch: 15, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.761 Vali Acc: 0.896 Test Loss: 0.761 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896289).  Saving model ...
Epoch: 16 cost time: 0.4324605464935303
Epoch: 16, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.676 Vali Acc: 0.907 Test Loss: 0.676 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 17 cost time: 0.37305641174316406
Epoch: 17, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.600 Vali Acc: 0.922 Test Loss: 0.600 Test Acc: 0.922
Validation loss decreased (-0.907401 --> -0.922216).  Saving model ...
Epoch: 18 cost time: 0.40445804595947266
Epoch: 18, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.530 Vali Acc: 0.933 Test Loss: 0.530 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 19 cost time: 0.37206149101257324
Epoch: 19, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.469 Vali Acc: 0.933 Test Loss: 0.469 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 20 cost time: 0.37124180793762207
Epoch: 20, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.420 Vali Acc: 0.930 Test Loss: 0.420 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4314601421356201
Epoch: 21, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.34794116020202637
Epoch: 22, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 23 cost time: 0.37477731704711914
Epoch: 23, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 0.4548451900482178
Epoch: 24, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.38767123222351074
Epoch: 25, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.37741589546203613
Epoch: 26, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4006648063659668
Epoch: 27, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4193098545074463
Epoch: 28, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.39706897735595703
Epoch: 29, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.3934013843536377
Epoch: 30, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4713714122772217
Epoch: 31, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.37252044677734375
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.3875010013580322
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.4132106304168701
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.3928852081298828
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.41509342193603516
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.4349782466888428
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.392437219619751
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.4422783851623535
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.43125081062316895
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.40657949447631836
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.390216588973999
Epoch: 42, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.3900487422943115
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.3950166702270508
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.4279501438140869
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.3980555534362793
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.4571654796600342
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.38431787490844727
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.41214966773986816
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.3808116912841797
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 242150
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6701221466064453
Epoch: 1, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.778 Vali Acc: 0.193 Test Loss: 1.778 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.4187459945678711
Epoch: 2, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.756 Vali Acc: 0.204 Test Loss: 1.756 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.369143009185791
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.736 Vali Acc: 0.222 Test Loss: 1.736 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 0.42818617820739746
Epoch: 4, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.711 Vali Acc: 0.322 Test Loss: 1.711 Test Acc: 0.322
Validation loss decreased (-0.222205 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.3830380439758301
Epoch: 5, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.679 Vali Acc: 0.404 Test Loss: 1.679 Test Acc: 0.404
Validation loss decreased (-0.322205 --> -0.403687).  Saving model ...
Epoch: 6 cost time: 0.36860036849975586
Epoch: 6, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.640 Vali Acc: 0.459 Test Loss: 1.640 Test Acc: 0.459
Validation loss decreased (-0.403687 --> -0.459243).  Saving model ...
Epoch: 7 cost time: 0.3776679039001465
Epoch: 7, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.594 Vali Acc: 0.511 Test Loss: 1.594 Test Acc: 0.511
Validation loss decreased (-0.459243 --> -0.511095).  Saving model ...
Epoch: 8 cost time: 0.39221882820129395
Epoch: 8, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.543 Vali Acc: 0.578 Test Loss: 1.543 Test Acc: 0.578
Validation loss decreased (-0.511095 --> -0.577762).  Saving model ...
Epoch: 9 cost time: 0.38979482650756836
Epoch: 9, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.486 Vali Acc: 0.626 Test Loss: 1.486 Test Acc: 0.626
Validation loss decreased (-0.577762 --> -0.625911).  Saving model ...
Epoch: 10 cost time: 0.3886590003967285
Epoch: 10, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.424 Vali Acc: 0.689 Test Loss: 1.424 Test Acc: 0.689
Validation loss decreased (-0.625911 --> -0.688875).  Saving model ...
Epoch: 11 cost time: 0.38164710998535156
Epoch: 11, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.358 Vali Acc: 0.774 Test Loss: 1.358 Test Acc: 0.774
Validation loss decreased (-0.688875 --> -0.774060).  Saving model ...
Epoch: 12 cost time: 0.39896464347839355
Epoch: 12, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.290 Vali Acc: 0.811 Test Loss: 1.290 Test Acc: 0.811
Validation loss decreased (-0.774060 --> -0.811098).  Saving model ...
Epoch: 13 cost time: 0.4184246063232422
Epoch: 13, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.219 Vali Acc: 0.841 Test Loss: 1.219 Test Acc: 0.841
Validation loss decreased (-0.811098 --> -0.840729).  Saving model ...
Epoch: 14 cost time: 0.38121962547302246
Epoch: 14, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.146 Vali Acc: 0.848 Test Loss: 1.146 Test Acc: 0.848
Validation loss decreased (-0.840729 --> -0.848137).  Saving model ...
Epoch: 15 cost time: 0.39716482162475586
Epoch: 15, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.071 Vali Acc: 0.867 Test Loss: 1.071 Test Acc: 0.867
Validation loss decreased (-0.848137 --> -0.866656).  Saving model ...
Epoch: 16 cost time: 0.43988609313964844
Epoch: 16, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.997 Vali Acc: 0.881 Test Loss: 0.997 Test Acc: 0.881
Validation loss decreased (-0.866656 --> -0.881472).  Saving model ...
Epoch: 17 cost time: 0.38752031326293945
Epoch: 17, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.925 Vali Acc: 0.881 Test Loss: 0.925 Test Acc: 0.881
Validation loss decreased (-0.881472 --> -0.881472).  Saving model ...
Epoch: 18 cost time: 0.37767815589904785
Epoch: 18, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.856 Vali Acc: 0.896 Test Loss: 0.856 Test Acc: 0.896
Validation loss decreased (-0.881472 --> -0.896288).  Saving model ...
Epoch: 19 cost time: 0.39988279342651367
Epoch: 19, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.789 Vali Acc: 0.904 Test Loss: 0.789 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903696).  Saving model ...
Epoch: 20 cost time: 0.4553408622741699
Epoch: 20, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.725 Vali Acc: 0.907 Test Loss: 0.725 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 21 cost time: 0.4206416606903076
Epoch: 21, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.665 Vali Acc: 0.915 Test Loss: 0.665 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 22 cost time: 0.4754948616027832
Epoch: 22, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.610 Vali Acc: 0.919 Test Loss: 0.610 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 23 cost time: 0.37544703483581543
Epoch: 23, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.561 Vali Acc: 0.922 Test Loss: 0.561 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.4031529426574707
Epoch: 24, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.516 Vali Acc: 0.922 Test Loss: 0.516 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.41960787773132324
Epoch: 25, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.476 Vali Acc: 0.926 Test Loss: 0.476 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.38923072814941406
Epoch: 26, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.440 Vali Acc: 0.930 Test Loss: 0.440 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.5034382343292236
Epoch: 27, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.409 Vali Acc: 0.930 Test Loss: 0.409 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 28 cost time: 0.4201192855834961
Epoch: 28, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 29 cost time: 0.39119434356689453
Epoch: 29, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.358 Vali Acc: 0.937 Test Loss: 0.358 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.3781311511993408
Epoch: 30, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.337 Vali Acc: 0.937 Test Loss: 0.337 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.42800116539001465
Epoch: 31, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.4596407413482666
Epoch: 32, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.47103404998779297
Epoch: 33, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.43915462493896484
Epoch: 34, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.408221960067749
Epoch: 35, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.4182748794555664
Epoch: 36, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.378603458404541
Epoch: 37, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4336061477661133
Epoch: 38, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.39368152618408203
Epoch: 39, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.42631983757019043
Epoch: 40, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.41405296325683594
Epoch: 41, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4929366111755371
Epoch: 42, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.3727726936340332
Epoch: 43, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5591068267822266
Epoch: 44, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.43909358978271484
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.41068601608276367
Epoch: 46, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.3876652717590332
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.3933753967285156
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4307260513305664
Epoch: 49, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.3744680881500244
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 216102
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5935454368591309
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.803 Vali Acc: 0.348 Test Loss: 1.803 Test Acc: 0.348
Validation loss decreased (inf --> -0.348130).  Saving model ...
Epoch: 2 cost time: 0.4206850528717041
Epoch: 2, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.786 Vali Acc: 0.381 Test Loss: 1.786 Test Acc: 0.381
Validation loss decreased (-0.348130 --> -0.381464).  Saving model ...
Epoch: 3 cost time: 0.38549137115478516
Epoch: 3, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.771 Vali Acc: 0.404 Test Loss: 1.771 Test Acc: 0.404
Validation loss decreased (-0.381464 --> -0.403686).  Saving model ...
Epoch: 4 cost time: 0.38280487060546875
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.755 Vali Acc: 0.430 Test Loss: 1.755 Test Acc: 0.430
Validation loss decreased (-0.403686 --> -0.429612).  Saving model ...
Epoch: 5 cost time: 0.4894113540649414
Epoch: 5, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.732 Vali Acc: 0.448 Test Loss: 1.732 Test Acc: 0.448
Validation loss decreased (-0.429612 --> -0.448131).  Saving model ...
Epoch: 6 cost time: 0.3889589309692383
Epoch: 6, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.704 Vali Acc: 0.456 Test Loss: 1.704 Test Acc: 0.456
Validation loss decreased (-0.448131 --> -0.455539).  Saving model ...
Epoch: 7 cost time: 0.3702700138092041
Epoch: 7, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.671 Vali Acc: 0.496 Test Loss: 1.671 Test Acc: 0.496
Validation loss decreased (-0.455539 --> -0.496280).  Saving model ...
Epoch: 8 cost time: 0.4350466728210449
Epoch: 8, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.633 Vali Acc: 0.541 Test Loss: 1.633 Test Acc: 0.541
Validation loss decreased (-0.496280 --> -0.540724).  Saving model ...
Epoch: 9 cost time: 0.39603090286254883
Epoch: 9, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.592 Vali Acc: 0.574 Test Loss: 1.592 Test Acc: 0.574
Validation loss decreased (-0.540724 --> -0.574058).  Saving model ...
Epoch: 10 cost time: 0.4062511920928955
Epoch: 10, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.546 Vali Acc: 0.615 Test Loss: 1.546 Test Acc: 0.615
Validation loss decreased (-0.574058 --> -0.614799).  Saving model ...
Epoch: 11 cost time: 0.4115176200866699
Epoch: 11, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.497 Vali Acc: 0.659 Test Loss: 1.497 Test Acc: 0.659
Validation loss decreased (-0.614799 --> -0.659244).  Saving model ...
Epoch: 12 cost time: 0.3803856372833252
Epoch: 12, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.445 Vali Acc: 0.711 Test Loss: 1.445 Test Acc: 0.711
Validation loss decreased (-0.659244 --> -0.711097).  Saving model ...
Epoch: 13 cost time: 0.36680173873901367
Epoch: 13, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.390 Vali Acc: 0.744 Test Loss: 1.390 Test Acc: 0.744
Validation loss decreased (-0.711097 --> -0.744431).  Saving model ...
Epoch: 14 cost time: 0.3787405490875244
Epoch: 14, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.333 Vali Acc: 0.767 Test Loss: 1.333 Test Acc: 0.767
Validation loss decreased (-0.744431 --> -0.766653).  Saving model ...
Epoch: 15 cost time: 0.38708019256591797
Epoch: 15, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.273 Vali Acc: 0.804 Test Loss: 1.273 Test Acc: 0.804
Validation loss decreased (-0.766653 --> -0.803691).  Saving model ...
Epoch: 16 cost time: 0.40401124954223633
Epoch: 16, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.212 Vali Acc: 0.830 Test Loss: 1.212 Test Acc: 0.830
Validation loss decreased (-0.803691 --> -0.829618).  Saving model ...
Epoch: 17 cost time: 0.5391082763671875
Epoch: 17, Steps: 2 | Train Loss: 0.970 Vali Loss: 1.151 Vali Acc: 0.841 Test Loss: 1.151 Test Acc: 0.841
Validation loss decreased (-0.829618 --> -0.840729).  Saving model ...
Epoch: 18 cost time: 0.4229245185852051
Epoch: 18, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.090 Vali Acc: 0.848 Test Loss: 1.090 Test Acc: 0.848
Validation loss decreased (-0.840729 --> -0.848137).  Saving model ...
Epoch: 19 cost time: 0.3854067325592041
Epoch: 19, Steps: 2 | Train Loss: 0.824 Vali Loss: 1.028 Vali Acc: 0.870 Test Loss: 1.028 Test Acc: 0.870
Validation loss decreased (-0.848137 --> -0.870360).  Saving model ...
Epoch: 20 cost time: 0.47103404998779297
Epoch: 20, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.968 Vali Acc: 0.885 Test Loss: 0.968 Test Acc: 0.885
Validation loss decreased (-0.870360 --> -0.885176).  Saving model ...
Epoch: 21 cost time: 0.4909477233886719
Epoch: 21, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.908 Vali Acc: 0.896 Test Loss: 0.908 Test Acc: 0.896
Validation loss decreased (-0.885176 --> -0.896287).  Saving model ...
Epoch: 22 cost time: 0.35892295837402344
Epoch: 22, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.850 Vali Acc: 0.904 Test Loss: 0.850 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
Epoch: 23 cost time: 0.36603713035583496
Epoch: 23, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.794 Vali Acc: 0.904 Test Loss: 0.794 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903696).  Saving model ...
Epoch: 24 cost time: 0.34906554222106934
Epoch: 24, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.741 Vali Acc: 0.911 Test Loss: 0.741 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 25 cost time: 0.5031161308288574
Epoch: 25, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.691 Vali Acc: 0.919 Test Loss: 0.691 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 26 cost time: 0.37424445152282715
Epoch: 26, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.644 Vali Acc: 0.922 Test Loss: 0.644 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 27 cost time: 0.3554856777191162
Epoch: 27, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.600 Vali Acc: 0.926 Test Loss: 0.600 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 28 cost time: 0.3954155445098877
Epoch: 28, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.560 Vali Acc: 0.930 Test Loss: 0.560 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 29 cost time: 0.3742184638977051
Epoch: 29, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.523 Vali Acc: 0.930 Test Loss: 0.523 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 30 cost time: 0.4098327159881592
Epoch: 30, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.490 Vali Acc: 0.933 Test Loss: 0.490 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 31 cost time: 0.3901658058166504
Epoch: 31, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.460 Vali Acc: 0.937 Test Loss: 0.460 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 32 cost time: 0.3775506019592285
Epoch: 32, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.433 Vali Acc: 0.941 Test Loss: 0.433 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 33 cost time: 0.43178749084472656
Epoch: 33, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.409 Vali Acc: 0.944 Test Loss: 0.409 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 34 cost time: 0.45438504219055176
Epoch: 34, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.388 Vali Acc: 0.948 Test Loss: 0.388 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 35 cost time: 0.43491053581237793
Epoch: 35, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.369 Vali Acc: 0.948 Test Loss: 0.369 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 36 cost time: 0.4416038990020752
Epoch: 36, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.353 Vali Acc: 0.948 Test Loss: 0.353 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 37 cost time: 0.42104363441467285
Epoch: 37, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.338 Vali Acc: 0.948 Test Loss: 0.338 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.4171788692474365
Epoch: 38, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.325 Vali Acc: 0.948 Test Loss: 0.325 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 39 cost time: 0.4055180549621582
Epoch: 39, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.45244932174682617
Epoch: 40, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.42222118377685547
Epoch: 41, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.37645578384399414
Epoch: 42, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.39711976051330566
Epoch: 43, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.41200900077819824
Epoch: 44, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.270 Vali Acc: 0.948 Test Loss: 0.270 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 45 cost time: 0.43375325202941895
Epoch: 45, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.39121007919311523
Epoch: 46, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.4273035526275635
Epoch: 47, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.3929295539855957
Epoch: 48, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.40122222900390625
Epoch: 49, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.40963315963745117
Epoch: 50, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 208454
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6869242191314697
Epoch: 1, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.750 Vali Acc: 0.241 Test Loss: 1.750 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.3969755172729492
Epoch: 2, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.735 Vali Acc: 0.289 Test Loss: 1.735 Test Acc: 0.289
Validation loss decreased (-0.240723 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 0.3739604949951172
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.722 Vali Acc: 0.319 Test Loss: 1.722 Test Acc: 0.319
Validation loss decreased (-0.288872 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.41513872146606445
Epoch: 4, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.709 Vali Acc: 0.400 Test Loss: 1.709 Test Acc: 0.400
Validation loss decreased (-0.318501 --> -0.399983).  Saving model ...
Epoch: 5 cost time: 0.4184260368347168
Epoch: 5, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.692 Vali Acc: 0.456 Test Loss: 1.692 Test Acc: 0.456
Validation loss decreased (-0.399983 --> -0.455539).  Saving model ...
Epoch: 6 cost time: 0.43170905113220215
Epoch: 6, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.670 Vali Acc: 0.515 Test Loss: 1.670 Test Acc: 0.515
Validation loss decreased (-0.455539 --> -0.514798).  Saving model ...
Epoch: 7 cost time: 0.40006327629089355
Epoch: 7, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.645 Vali Acc: 0.533 Test Loss: 1.645 Test Acc: 0.533
Validation loss decreased (-0.514798 --> -0.533317).  Saving model ...
Epoch: 8 cost time: 0.3830525875091553
Epoch: 8, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.617 Vali Acc: 0.570 Test Loss: 1.617 Test Acc: 0.570
Validation loss decreased (-0.533317 --> -0.570354).  Saving model ...
Epoch: 9 cost time: 0.39208197593688965
Epoch: 9, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.584 Vali Acc: 0.578 Test Loss: 1.584 Test Acc: 0.578
Validation loss decreased (-0.570354 --> -0.577762).  Saving model ...
Epoch: 10 cost time: 0.4079313278198242
Epoch: 10, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.549 Vali Acc: 0.593 Test Loss: 1.549 Test Acc: 0.593
Validation loss decreased (-0.577762 --> -0.592577).  Saving model ...
Epoch: 11 cost time: 0.41545987129211426
Epoch: 11, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.510 Vali Acc: 0.637 Test Loss: 1.510 Test Acc: 0.637
Validation loss decreased (-0.592577 --> -0.637022).  Saving model ...
Epoch: 12 cost time: 0.38571834564208984
Epoch: 12, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.468 Vali Acc: 0.674 Test Loss: 1.468 Test Acc: 0.674
Validation loss decreased (-0.637022 --> -0.674059).  Saving model ...
Epoch: 13 cost time: 0.4216578006744385
Epoch: 13, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.424 Vali Acc: 0.711 Test Loss: 1.424 Test Acc: 0.711
Validation loss decreased (-0.674059 --> -0.711097).  Saving model ...
Epoch: 14 cost time: 0.44796156883239746
Epoch: 14, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.378 Vali Acc: 0.726 Test Loss: 1.378 Test Acc: 0.726
Validation loss decreased (-0.711097 --> -0.725912).  Saving model ...
Epoch: 15 cost time: 0.38162875175476074
Epoch: 15, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.330 Vali Acc: 0.767 Test Loss: 1.330 Test Acc: 0.767
Validation loss decreased (-0.725912 --> -0.766653).  Saving model ...
Epoch: 16 cost time: 0.3600010871887207
Epoch: 16, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.280 Vali Acc: 0.793 Test Loss: 1.280 Test Acc: 0.793
Validation loss decreased (-0.766653 --> -0.792580).  Saving model ...
Epoch: 17 cost time: 0.4051358699798584
Epoch: 17, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.228 Vali Acc: 0.826 Test Loss: 1.228 Test Acc: 0.826
Validation loss decreased (-0.792580 --> -0.825914).  Saving model ...
Epoch: 18 cost time: 0.48272132873535156
Epoch: 18, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.174 Vali Acc: 0.826 Test Loss: 1.174 Test Acc: 0.826
Validation loss decreased (-0.825914 --> -0.825914).  Saving model ...
Epoch: 19 cost time: 0.3894188404083252
Epoch: 19, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.120 Vali Acc: 0.848 Test Loss: 1.120 Test Acc: 0.848
Validation loss decreased (-0.825914 --> -0.848137).  Saving model ...
Epoch: 20 cost time: 0.4010779857635498
Epoch: 20, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.066 Vali Acc: 0.867 Test Loss: 1.066 Test Acc: 0.867
Validation loss decreased (-0.848137 --> -0.866656).  Saving model ...
Epoch: 21 cost time: 0.3924562931060791
Epoch: 21, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.011 Vali Acc: 0.867 Test Loss: 1.011 Test Acc: 0.867
Validation loss decreased (-0.866656 --> -0.866657).  Saving model ...
Epoch: 22 cost time: 0.38190221786499023
Epoch: 22, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.958 Vali Acc: 0.881 Test Loss: 0.958 Test Acc: 0.881
Validation loss decreased (-0.866657 --> -0.881472).  Saving model ...
Epoch: 23 cost time: 0.3835468292236328
Epoch: 23, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.905 Vali Acc: 0.896 Test Loss: 0.905 Test Acc: 0.896
Validation loss decreased (-0.881472 --> -0.896287).  Saving model ...
Epoch: 24 cost time: 0.42325639724731445
Epoch: 24, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.855 Vali Acc: 0.904 Test Loss: 0.855 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
Epoch: 25 cost time: 0.4489023685455322
Epoch: 25, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.806 Vali Acc: 0.900 Test Loss: 0.806 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.49340128898620605
Epoch: 26, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.759 Vali Acc: 0.911 Test Loss: 0.759 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911104).  Saving model ...
Epoch: 27 cost time: 0.4410266876220703
Epoch: 27, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.715 Vali Acc: 0.919 Test Loss: 0.715 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918511).  Saving model ...
Epoch: 28 cost time: 0.39681005477905273
Epoch: 28, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.674 Vali Acc: 0.919 Test Loss: 0.674 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918512).  Saving model ...
Epoch: 29 cost time: 0.43910980224609375
Epoch: 29, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.635 Vali Acc: 0.926 Test Loss: 0.635 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 30 cost time: 0.4741806983947754
Epoch: 30, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.599 Vali Acc: 0.930 Test Loss: 0.599 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 31 cost time: 0.39908480644226074
Epoch: 31, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.565 Vali Acc: 0.933 Test Loss: 0.565 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 32 cost time: 0.4350743293762207
Epoch: 32, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.534 Vali Acc: 0.937 Test Loss: 0.534 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 33 cost time: 0.42524170875549316
Epoch: 33, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.505 Vali Acc: 0.937 Test Loss: 0.505 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 34 cost time: 0.4068753719329834
Epoch: 34, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.479 Vali Acc: 0.937 Test Loss: 0.479 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 35 cost time: 0.3926675319671631
Epoch: 35, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.455 Vali Acc: 0.937 Test Loss: 0.455 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 36 cost time: 0.39608216285705566
Epoch: 36, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.433 Vali Acc: 0.937 Test Loss: 0.433 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.4366872310638428
Epoch: 37, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.413 Vali Acc: 0.937 Test Loss: 0.413 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.4556772708892822
Epoch: 38, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.395 Vali Acc: 0.937 Test Loss: 0.395 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 39 cost time: 0.40971803665161133
Epoch: 39, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.379 Vali Acc: 0.937 Test Loss: 0.379 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 40 cost time: 0.4540884494781494
Epoch: 40, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 41 cost time: 0.40873193740844727
Epoch: 41, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.451108455657959
Epoch: 42, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.4376406669616699
Epoch: 43, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 44 cost time: 0.42757439613342285
Epoch: 44, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.4273264408111572
Epoch: 45, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.4812502861022949
Epoch: 46, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.40543627738952637
Epoch: 47, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4040493965148926
Epoch: 48, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4514627456665039
Epoch: 49, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.4345836639404297
Epoch: 50, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 203910
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7479450702667236
Epoch: 1, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.784 Vali Acc: 0.196 Test Loss: 1.784 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.42054104804992676
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.772 Vali Acc: 0.222 Test Loss: 1.772 Test Acc: 0.222
Validation loss decreased (-0.196278 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.4879934787750244
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.762 Vali Acc: 0.244 Test Loss: 1.762 Test Acc: 0.244
Validation loss decreased (-0.222204 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.3546462059020996
Epoch: 4, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.751 Vali Acc: 0.267 Test Loss: 1.751 Test Acc: 0.267
Validation loss decreased (-0.244427 --> -0.266649).  Saving model ...
Epoch: 5 cost time: 0.41321420669555664
Epoch: 5, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.736 Vali Acc: 0.285 Test Loss: 1.736 Test Acc: 0.285
Validation loss decreased (-0.266649 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 0.3919527530670166
Epoch: 6, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.719 Vali Acc: 0.293 Test Loss: 1.719 Test Acc: 0.293
Validation loss decreased (-0.285168 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 0.3770298957824707
Epoch: 7, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.699 Vali Acc: 0.333 Test Loss: 1.699 Test Acc: 0.333
Validation loss decreased (-0.292575 --> -0.333316).  Saving model ...
Epoch: 8 cost time: 0.41468048095703125
Epoch: 8, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.675 Vali Acc: 0.411 Test Loss: 1.675 Test Acc: 0.411
Validation loss decreased (-0.333316 --> -0.411094).  Saving model ...
Epoch: 9 cost time: 0.4425332546234131
Epoch: 9, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.649 Vali Acc: 0.463 Test Loss: 1.649 Test Acc: 0.463
Validation loss decreased (-0.411094 --> -0.462946).  Saving model ...
Epoch: 10 cost time: 0.42571282386779785
Epoch: 10, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.619 Vali Acc: 0.533 Test Loss: 1.619 Test Acc: 0.533
Validation loss decreased (-0.462946 --> -0.533317).  Saving model ...
Epoch: 11 cost time: 0.4001638889312744
Epoch: 11, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.588 Vali Acc: 0.630 Test Loss: 1.588 Test Acc: 0.630
Validation loss decreased (-0.533317 --> -0.629614).  Saving model ...
Epoch: 12 cost time: 0.5953259468078613
Epoch: 12, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.554 Vali Acc: 0.711 Test Loss: 1.554 Test Acc: 0.711
Validation loss decreased (-0.629614 --> -0.711096).  Saving model ...
Epoch: 13 cost time: 0.5318670272827148
Epoch: 13, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.518 Vali Acc: 0.741 Test Loss: 1.518 Test Acc: 0.741
Validation loss decreased (-0.711096 --> -0.740726).  Saving model ...
Epoch: 14 cost time: 0.3928263187408447
Epoch: 14, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.479 Vali Acc: 0.759 Test Loss: 1.479 Test Acc: 0.759
Validation loss decreased (-0.740726 --> -0.759244).  Saving model ...
Epoch: 15 cost time: 0.44458699226379395
Epoch: 15, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.438 Vali Acc: 0.800 Test Loss: 1.438 Test Acc: 0.800
Validation loss decreased (-0.759244 --> -0.799986).  Saving model ...
Epoch: 16 cost time: 0.4245896339416504
Epoch: 16, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.396 Vali Acc: 0.822 Test Loss: 1.396 Test Acc: 0.822
Validation loss decreased (-0.799986 --> -0.822208).  Saving model ...
Epoch: 17 cost time: 0.44222593307495117
Epoch: 17, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.353 Vali Acc: 0.852 Test Loss: 1.353 Test Acc: 0.852
Validation loss decreased (-0.822208 --> -0.851838).  Saving model ...
Epoch: 18 cost time: 0.4321715831756592
Epoch: 18, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.308 Vali Acc: 0.867 Test Loss: 1.308 Test Acc: 0.867
Validation loss decreased (-0.851838 --> -0.866654).  Saving model ...
Epoch: 19 cost time: 0.5319352149963379
Epoch: 19, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.262 Vali Acc: 0.870 Test Loss: 1.262 Test Acc: 0.870
Validation loss decreased (-0.866654 --> -0.870358).  Saving model ...
Epoch: 20 cost time: 0.39203429222106934
Epoch: 20, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.214 Vali Acc: 0.878 Test Loss: 1.214 Test Acc: 0.878
Validation loss decreased (-0.870358 --> -0.877766).  Saving model ...
Epoch: 21 cost time: 0.3706955909729004
Epoch: 21, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.166 Vali Acc: 0.889 Test Loss: 1.166 Test Acc: 0.889
Validation loss decreased (-0.877766 --> -0.888877).  Saving model ...
Epoch: 22 cost time: 0.3733077049255371
Epoch: 22, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.117 Vali Acc: 0.900 Test Loss: 1.117 Test Acc: 0.900
Validation loss decreased (-0.888877 --> -0.899989).  Saving model ...
Epoch: 23 cost time: 0.4041917324066162
Epoch: 23, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.068 Vali Acc: 0.911 Test Loss: 1.068 Test Acc: 0.911
Validation loss decreased (-0.899989 --> -0.911100).  Saving model ...
Epoch: 24 cost time: 0.4310460090637207
Epoch: 24, Steps: 2 | Train Loss: 0.831 Vali Loss: 1.019 Vali Acc: 0.926 Test Loss: 1.019 Test Acc: 0.926
Validation loss decreased (-0.911100 --> -0.925916).  Saving model ...
Epoch: 25 cost time: 0.4170544147491455
Epoch: 25, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.970 Vali Acc: 0.926 Test Loss: 0.970 Test Acc: 0.926
Validation loss decreased (-0.925916 --> -0.925916).  Saving model ...
Epoch: 26 cost time: 0.42549991607666016
Epoch: 26, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.922 Vali Acc: 0.933 Test Loss: 0.922 Test Acc: 0.933
Validation loss decreased (-0.925916 --> -0.933324).  Saving model ...
Epoch: 27 cost time: 0.39617919921875
Epoch: 27, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.875 Vali Acc: 0.933 Test Loss: 0.875 Test Acc: 0.933
Validation loss decreased (-0.933324 --> -0.933325).  Saving model ...
Epoch: 28 cost time: 0.3797636032104492
Epoch: 28, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.829 Vali Acc: 0.933 Test Loss: 0.829 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933325).  Saving model ...
Epoch: 29 cost time: 0.4125819206237793
Epoch: 29, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.785 Vali Acc: 0.937 Test Loss: 0.785 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937029).  Saving model ...
Epoch: 30 cost time: 0.4242539405822754
Epoch: 30, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.743 Vali Acc: 0.941 Test Loss: 0.743 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940733).  Saving model ...
Epoch: 31 cost time: 0.4524843692779541
Epoch: 31, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.703 Vali Acc: 0.941 Test Loss: 0.703 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940734).  Saving model ...
Epoch: 32 cost time: 0.42200517654418945
Epoch: 32, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.665 Vali Acc: 0.941 Test Loss: 0.665 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940734).  Saving model ...
Epoch: 33 cost time: 0.40044498443603516
Epoch: 33, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.630 Vali Acc: 0.941 Test Loss: 0.630 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940734).  Saving model ...
Epoch: 34 cost time: 0.488086462020874
Epoch: 34, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.597 Vali Acc: 0.941 Test Loss: 0.597 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 35 cost time: 0.546558141708374
Epoch: 35, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.566 Vali Acc: 0.941 Test Loss: 0.566 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 36 cost time: 0.41408729553222656
Epoch: 36, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.538 Vali Acc: 0.944 Test Loss: 0.538 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 37 cost time: 0.45944643020629883
Epoch: 37, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.511 Vali Acc: 0.948 Test Loss: 0.511 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 38 cost time: 0.5090186595916748
Epoch: 38, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.487 Vali Acc: 0.948 Test Loss: 0.487 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 39 cost time: 0.46127820014953613
Epoch: 39, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.465 Vali Acc: 0.952 Test Loss: 0.465 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 40 cost time: 0.4310429096221924
Epoch: 40, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.444 Vali Acc: 0.952 Test Loss: 0.444 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
Epoch: 41 cost time: 0.4631998538970947
Epoch: 41, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.425 Vali Acc: 0.952 Test Loss: 0.425 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 42 cost time: 0.4464569091796875
Epoch: 42, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.407 Vali Acc: 0.952 Test Loss: 0.407 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 43 cost time: 0.44008970260620117
Epoch: 43, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.391 Vali Acc: 0.952 Test Loss: 0.391 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 44 cost time: 0.44946789741516113
Epoch: 44, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.376 Vali Acc: 0.956 Test Loss: 0.376 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 45 cost time: 0.40946030616760254
Epoch: 45, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.362 Vali Acc: 0.956 Test Loss: 0.362 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 46 cost time: 0.3921818733215332
Epoch: 46, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.350 Vali Acc: 0.956 Test Loss: 0.350 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 47 cost time: 0.4879872798919678
Epoch: 47, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.338 Vali Acc: 0.956 Test Loss: 0.338 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 48 cost time: 0.47363924980163574
Epoch: 48, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.327 Vali Acc: 0.956 Test Loss: 0.327 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 49 cost time: 0.5185372829437256
Epoch: 49, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.317 Vali Acc: 0.956 Test Loss: 0.317 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 50 cost time: 0.4631202220916748
Epoch: 50, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.308 Vali Acc: 0.956 Test Loss: 0.308 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 202470
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.546189308166504
Epoch: 1, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.780 Vali Acc: 0.115 Test Loss: 1.780 Test Acc: 0.115
Validation loss decreased (inf --> -0.114797).  Saving model ...
Epoch: 2 cost time: 0.4305574893951416
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.773 Vali Acc: 0.119 Test Loss: 1.773 Test Acc: 0.119
Validation loss decreased (-0.114797 --> -0.118501).  Saving model ...
Epoch: 3 cost time: 0.44893550872802734
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.767 Vali Acc: 0.130 Test Loss: 1.767 Test Acc: 0.130
Validation loss decreased (-0.118501 --> -0.129612).  Saving model ...
Epoch: 4 cost time: 0.3778712749481201
Epoch: 4, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.761 Vali Acc: 0.141 Test Loss: 1.761 Test Acc: 0.141
Validation loss decreased (-0.129612 --> -0.140723).  Saving model ...
Epoch: 5 cost time: 0.4029707908630371
Epoch: 5, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.752 Vali Acc: 0.152 Test Loss: 1.752 Test Acc: 0.152
Validation loss decreased (-0.140723 --> -0.151834).  Saving model ...
Epoch: 6 cost time: 0.39521217346191406
Epoch: 6, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.741 Vali Acc: 0.193 Test Loss: 1.741 Test Acc: 0.193
Validation loss decreased (-0.151834 --> -0.192575).  Saving model ...
Epoch: 7 cost time: 0.44080519676208496
Epoch: 7, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.727 Vali Acc: 0.248 Test Loss: 1.727 Test Acc: 0.248
Validation loss decreased (-0.192575 --> -0.248131).  Saving model ...
Epoch: 8 cost time: 0.4051930904388428
Epoch: 8, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.711 Vali Acc: 0.322 Test Loss: 1.711 Test Acc: 0.322
Validation loss decreased (-0.248131 --> -0.322205).  Saving model ...
Epoch: 9 cost time: 0.4277510643005371
Epoch: 9, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.692 Vali Acc: 0.378 Test Loss: 1.692 Test Acc: 0.378
Validation loss decreased (-0.322205 --> -0.377761).  Saving model ...
Epoch: 10 cost time: 0.4689321517944336
Epoch: 10, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.671 Vali Acc: 0.411 Test Loss: 1.671 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411094).  Saving model ...
Epoch: 11 cost time: 0.464397668838501
Epoch: 11, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.647 Vali Acc: 0.452 Test Loss: 1.647 Test Acc: 0.452
Validation loss decreased (-0.411094 --> -0.451835).  Saving model ...
Epoch: 12 cost time: 0.33783912658691406
Epoch: 12, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.622 Vali Acc: 0.511 Test Loss: 1.622 Test Acc: 0.511
Validation loss decreased (-0.451835 --> -0.511095).  Saving model ...
Epoch: 13 cost time: 0.36751627922058105
Epoch: 13, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.594 Vali Acc: 0.570 Test Loss: 1.594 Test Acc: 0.570
Validation loss decreased (-0.511095 --> -0.570354).  Saving model ...
Epoch: 14 cost time: 0.3823268413543701
Epoch: 14, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.565 Vali Acc: 0.637 Test Loss: 1.565 Test Acc: 0.637
Validation loss decreased (-0.570354 --> -0.637021).  Saving model ...
Epoch: 15 cost time: 0.4478740692138672
Epoch: 15, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.533 Vali Acc: 0.670 Test Loss: 1.533 Test Acc: 0.670
Validation loss decreased (-0.637021 --> -0.670355).  Saving model ...
Epoch: 16 cost time: 0.4132535457611084
Epoch: 16, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.500 Vali Acc: 0.700 Test Loss: 1.500 Test Acc: 0.700
Validation loss decreased (-0.670355 --> -0.699985).  Saving model ...
Epoch: 17 cost time: 0.33603763580322266
Epoch: 17, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.466 Vali Acc: 0.733 Test Loss: 1.466 Test Acc: 0.733
Validation loss decreased (-0.699985 --> -0.733319).  Saving model ...
Epoch: 18 cost time: 0.411008358001709
Epoch: 18, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.430 Vali Acc: 0.759 Test Loss: 1.430 Test Acc: 0.759
Validation loss decreased (-0.733319 --> -0.759245).  Saving model ...
Epoch: 19 cost time: 0.38407444953918457
Epoch: 19, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.392 Vali Acc: 0.781 Test Loss: 1.392 Test Acc: 0.781
Validation loss decreased (-0.759245 --> -0.781468).  Saving model ...
Epoch: 20 cost time: 0.3927483558654785
Epoch: 20, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.354 Vali Acc: 0.815 Test Loss: 1.354 Test Acc: 0.815
Validation loss decreased (-0.781468 --> -0.814801).  Saving model ...
Epoch: 21 cost time: 0.3731212615966797
Epoch: 21, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.315 Vali Acc: 0.833 Test Loss: 1.315 Test Acc: 0.833
Validation loss decreased (-0.814801 --> -0.833320).  Saving model ...
Epoch: 22 cost time: 0.41795825958251953
Epoch: 22, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.275 Vali Acc: 0.859 Test Loss: 1.275 Test Acc: 0.859
Validation loss decreased (-0.833320 --> -0.859247).  Saving model ...
Epoch: 23 cost time: 0.34290289878845215
Epoch: 23, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.234 Vali Acc: 0.874 Test Loss: 1.234 Test Acc: 0.874
Validation loss decreased (-0.859247 --> -0.874062).  Saving model ...
Epoch: 24 cost time: 0.3591005802154541
Epoch: 24, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.192 Vali Acc: 0.885 Test Loss: 1.192 Test Acc: 0.885
Validation loss decreased (-0.874062 --> -0.885173).  Saving model ...
Epoch: 25 cost time: 0.42623114585876465
Epoch: 25, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.150 Vali Acc: 0.896 Test Loss: 1.150 Test Acc: 0.896
Validation loss decreased (-0.885173 --> -0.896285).  Saving model ...
Epoch: 26 cost time: 0.43560218811035156
Epoch: 26, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.108 Vali Acc: 0.900 Test Loss: 1.108 Test Acc: 0.900
Validation loss decreased (-0.896285 --> -0.899989).  Saving model ...
Epoch: 27 cost time: 0.3897683620452881
Epoch: 27, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.066 Vali Acc: 0.900 Test Loss: 1.066 Test Acc: 0.900
Validation loss decreased (-0.899989 --> -0.899989).  Saving model ...
Epoch: 28 cost time: 0.4008057117462158
Epoch: 28, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.023 Vali Acc: 0.904 Test Loss: 1.023 Test Acc: 0.904
Validation loss decreased (-0.899989 --> -0.903693).  Saving model ...
Epoch: 29 cost time: 0.4451179504394531
Epoch: 29, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.982 Vali Acc: 0.915 Test Loss: 0.982 Test Acc: 0.915
Validation loss decreased (-0.903693 --> -0.914805).  Saving model ...
Epoch: 30 cost time: 0.4062223434448242
Epoch: 30, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.940 Vali Acc: 0.919 Test Loss: 0.940 Test Acc: 0.919
Validation loss decreased (-0.914805 --> -0.918509).  Saving model ...
Epoch: 31 cost time: 0.43042469024658203
Epoch: 31, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.900 Vali Acc: 0.926 Test Loss: 0.900 Test Acc: 0.926
Validation loss decreased (-0.918509 --> -0.925917).  Saving model ...
Epoch: 32 cost time: 0.40788793563842773
Epoch: 32, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.861 Vali Acc: 0.930 Test Loss: 0.861 Test Acc: 0.930
Validation loss decreased (-0.925917 --> -0.929621).  Saving model ...
Epoch: 33 cost time: 0.39206600189208984
Epoch: 33, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.823 Vali Acc: 0.933 Test Loss: 0.823 Test Acc: 0.933
Validation loss decreased (-0.929621 --> -0.933325).  Saving model ...
Epoch: 34 cost time: 0.3834352493286133
Epoch: 34, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.787 Vali Acc: 0.930 Test Loss: 0.787 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4096407890319824
Epoch: 35, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.752 Vali Acc: 0.930 Test Loss: 0.752 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.3817915916442871
Epoch: 36, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.718 Vali Acc: 0.930 Test Loss: 0.718 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.41070079803466797
Epoch: 37, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.686 Vali Acc: 0.930 Test Loss: 0.686 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.37586069107055664
Epoch: 38, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.656 Vali Acc: 0.930 Test Loss: 0.656 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.3968055248260498
Epoch: 39, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.628 Vali Acc: 0.930 Test Loss: 0.628 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.43040943145751953
Epoch: 40, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.601 Vali Acc: 0.933 Test Loss: 0.601 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933327).  Saving model ...
Epoch: 41 cost time: 0.4349358081817627
Epoch: 41, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.575 Vali Acc: 0.933 Test Loss: 0.575 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 42 cost time: 0.47358131408691406
Epoch: 42, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.552 Vali Acc: 0.933 Test Loss: 0.552 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 43 cost time: 0.36821746826171875
Epoch: 43, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.530 Vali Acc: 0.933 Test Loss: 0.530 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 44 cost time: 0.3942689895629883
Epoch: 44, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.509 Vali Acc: 0.933 Test Loss: 0.509 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 45 cost time: 0.42995357513427734
Epoch: 45, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.490 Vali Acc: 0.933 Test Loss: 0.490 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 46 cost time: 0.47393155097961426
Epoch: 46, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.472 Vali Acc: 0.937 Test Loss: 0.472 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 47 cost time: 0.3824648857116699
Epoch: 47, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.455 Vali Acc: 0.937 Test Loss: 0.455 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 48 cost time: 0.5011515617370605
Epoch: 48, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.440 Vali Acc: 0.933 Test Loss: 0.440 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.39835429191589355
Epoch: 49, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4027698040008545
Epoch: 50, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.411 Vali Acc: 0.937 Test Loss: 0.411 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 199494
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8052031993865967
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.778 Vali Acc: 0.219 Test Loss: 1.778 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.3907027244567871
Epoch: 2, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.769 Vali Acc: 0.241 Test Loss: 1.769 Test Acc: 0.241
Validation loss decreased (-0.218501 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.38501620292663574
Epoch: 3, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.761 Vali Acc: 0.263 Test Loss: 1.761 Test Acc: 0.263
Validation loss decreased (-0.240723 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 0.41033935546875
Epoch: 4, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.754 Vali Acc: 0.270 Test Loss: 1.754 Test Acc: 0.270
Validation loss decreased (-0.262945 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.3966410160064697
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.744 Vali Acc: 0.293 Test Loss: 1.744 Test Acc: 0.293
Validation loss decreased (-0.270353 --> -0.292575).  Saving model ...
Epoch: 6 cost time: 0.5086767673492432
Epoch: 6, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.732 Vali Acc: 0.333 Test Loss: 1.732 Test Acc: 0.333
Validation loss decreased (-0.292575 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.4071309566497803
Epoch: 7, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.717 Vali Acc: 0.378 Test Loss: 1.717 Test Acc: 0.378
Validation loss decreased (-0.333316 --> -0.377761).  Saving model ...
Epoch: 8 cost time: 0.3946082592010498
Epoch: 8, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.701 Vali Acc: 0.448 Test Loss: 1.701 Test Acc: 0.448
Validation loss decreased (-0.377761 --> -0.448131).  Saving model ...
Epoch: 9 cost time: 0.4010767936706543
Epoch: 9, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.682 Vali Acc: 0.515 Test Loss: 1.682 Test Acc: 0.515
Validation loss decreased (-0.448131 --> -0.514798).  Saving model ...
Epoch: 10 cost time: 0.462627649307251
Epoch: 10, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.662 Vali Acc: 0.544 Test Loss: 1.662 Test Acc: 0.544
Validation loss decreased (-0.514798 --> -0.544428).  Saving model ...
Epoch: 11 cost time: 0.38352322578430176
Epoch: 11, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.639 Vali Acc: 0.604 Test Loss: 1.639 Test Acc: 0.604
Validation loss decreased (-0.544428 --> -0.603687).  Saving model ...
Epoch: 12 cost time: 0.41945433616638184
Epoch: 12, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.616 Vali Acc: 0.648 Test Loss: 1.616 Test Acc: 0.648
Validation loss decreased (-0.603687 --> -0.648132).  Saving model ...
Epoch: 13 cost time: 0.4587852954864502
Epoch: 13, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.590 Vali Acc: 0.689 Test Loss: 1.590 Test Acc: 0.689
Validation loss decreased (-0.648132 --> -0.688873).  Saving model ...
Epoch: 14 cost time: 0.38506007194519043
Epoch: 14, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.563 Vali Acc: 0.704 Test Loss: 1.563 Test Acc: 0.704
Validation loss decreased (-0.688873 --> -0.703688).  Saving model ...
Epoch: 15 cost time: 0.4000587463378906
Epoch: 15, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.534 Vali Acc: 0.711 Test Loss: 1.534 Test Acc: 0.711
Validation loss decreased (-0.703688 --> -0.711096).  Saving model ...
Epoch: 16 cost time: 0.40700721740722656
Epoch: 16, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.504 Vali Acc: 0.748 Test Loss: 1.504 Test Acc: 0.748
Validation loss decreased (-0.711096 --> -0.748133).  Saving model ...
Epoch: 17 cost time: 0.4118976593017578
Epoch: 17, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.472 Vali Acc: 0.781 Test Loss: 1.472 Test Acc: 0.781
Validation loss decreased (-0.748133 --> -0.781467).  Saving model ...
Epoch: 18 cost time: 0.41538047790527344
Epoch: 18, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.440 Vali Acc: 0.796 Test Loss: 1.440 Test Acc: 0.796
Validation loss decreased (-0.781467 --> -0.796282).  Saving model ...
Epoch: 19 cost time: 0.4642937183380127
Epoch: 19, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.407 Vali Acc: 0.807 Test Loss: 1.407 Test Acc: 0.807
Validation loss decreased (-0.796282 --> -0.807393).  Saving model ...
Epoch: 20 cost time: 0.43685364723205566
Epoch: 20, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.373 Vali Acc: 0.815 Test Loss: 1.373 Test Acc: 0.815
Validation loss decreased (-0.807393 --> -0.814801).  Saving model ...
Epoch: 21 cost time: 0.4751551151275635
Epoch: 21, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.339 Vali Acc: 0.819 Test Loss: 1.339 Test Acc: 0.819
Validation loss decreased (-0.814801 --> -0.818505).  Saving model ...
Epoch: 22 cost time: 0.410581111907959
Epoch: 22, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.304 Vali Acc: 0.841 Test Loss: 1.304 Test Acc: 0.841
Validation loss decreased (-0.818505 --> -0.840728).  Saving model ...
Epoch: 23 cost time: 0.509230375289917
Epoch: 23, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.268 Vali Acc: 0.848 Test Loss: 1.268 Test Acc: 0.848
Validation loss decreased (-0.840728 --> -0.848135).  Saving model ...
Epoch: 24 cost time: 0.3966209888458252
Epoch: 24, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.232 Vali Acc: 0.856 Test Loss: 1.232 Test Acc: 0.856
Validation loss decreased (-0.848135 --> -0.855543).  Saving model ...
Epoch: 25 cost time: 0.4383656978607178
Epoch: 25, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.195 Vali Acc: 0.856 Test Loss: 1.195 Test Acc: 0.856
Validation loss decreased (-0.855543 --> -0.855544).  Saving model ...
Epoch: 26 cost time: 0.48735976219177246
Epoch: 26, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.159 Vali Acc: 0.859 Test Loss: 1.159 Test Acc: 0.859
Validation loss decreased (-0.855544 --> -0.859248).  Saving model ...
Epoch: 27 cost time: 0.41588377952575684
Epoch: 27, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.122 Vali Acc: 0.867 Test Loss: 1.122 Test Acc: 0.867
Validation loss decreased (-0.859248 --> -0.866655).  Saving model ...
Epoch: 28 cost time: 0.42723846435546875
Epoch: 28, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.084 Vali Acc: 0.881 Test Loss: 1.084 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881471).  Saving model ...
Epoch: 29 cost time: 0.48464179039001465
Epoch: 29, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.047 Vali Acc: 0.889 Test Loss: 1.047 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888878).  Saving model ...
Epoch: 30 cost time: 0.42084407806396484
Epoch: 30, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.010 Vali Acc: 0.900 Test Loss: 1.010 Test Acc: 0.900
Validation loss decreased (-0.888878 --> -0.899990).  Saving model ...
Epoch: 31 cost time: 0.5070562362670898
Epoch: 31, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.973 Vali Acc: 0.904 Test Loss: 0.973 Test Acc: 0.904
Validation loss decreased (-0.899990 --> -0.903694).  Saving model ...
Epoch: 32 cost time: 0.5112791061401367
Epoch: 32, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.937 Vali Acc: 0.904 Test Loss: 0.937 Test Acc: 0.904
Validation loss decreased (-0.903694 --> -0.903694).  Saving model ...
Epoch: 33 cost time: 0.49376749992370605
Epoch: 33, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.901 Vali Acc: 0.907 Test Loss: 0.901 Test Acc: 0.907
Validation loss decreased (-0.903694 --> -0.907398).  Saving model ...
Epoch: 34 cost time: 0.46097826957702637
Epoch: 34, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.866 Vali Acc: 0.911 Test Loss: 0.866 Test Acc: 0.911
Validation loss decreased (-0.907398 --> -0.911102).  Saving model ...
Epoch: 35 cost time: 0.45606279373168945
Epoch: 35, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.832 Vali Acc: 0.911 Test Loss: 0.832 Test Acc: 0.911
Validation loss decreased (-0.911102 --> -0.911103).  Saving model ...
Epoch: 36 cost time: 0.41554999351501465
Epoch: 36, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.798 Vali Acc: 0.915 Test Loss: 0.798 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 37 cost time: 0.39234137535095215
Epoch: 37, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.766 Vali Acc: 0.922 Test Loss: 0.766 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 38 cost time: 0.4397563934326172
Epoch: 38, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.735 Vali Acc: 0.926 Test Loss: 0.735 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 39 cost time: 0.41355466842651367
Epoch: 39, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.705 Vali Acc: 0.930 Test Loss: 0.705 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 40 cost time: 0.3966710567474365
Epoch: 40, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.677 Vali Acc: 0.930 Test Loss: 0.677 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 41 cost time: 0.4075963497161865
Epoch: 41, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.650 Vali Acc: 0.933 Test Loss: 0.650 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 42 cost time: 0.4268012046813965
Epoch: 42, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.623 Vali Acc: 0.933 Test Loss: 0.623 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 43 cost time: 0.4584493637084961
Epoch: 43, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.598 Vali Acc: 0.933 Test Loss: 0.598 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 44 cost time: 0.43346095085144043
Epoch: 44, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.575 Vali Acc: 0.933 Test Loss: 0.575 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 45 cost time: 0.4747605323791504
Epoch: 45, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.552 Vali Acc: 0.937 Test Loss: 0.552 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 46 cost time: 0.5268869400024414
Epoch: 46, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.531 Vali Acc: 0.944 Test Loss: 0.531 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944439).  Saving model ...
Epoch: 47 cost time: 0.4827299118041992
Epoch: 47, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.512 Vali Acc: 0.948 Test Loss: 0.512 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 48 cost time: 0.463306188583374
Epoch: 48, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.493 Vali Acc: 0.948 Test Loss: 0.493 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 49 cost time: 0.4675099849700928
Epoch: 49, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.476 Vali Acc: 0.948 Test Loss: 0.476 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 50 cost time: 0.5208480358123779
Epoch: 50, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.459 Vali Acc: 0.948 Test Loss: 0.459 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 198086
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7916021347045898
Epoch: 1, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.770 Vali Acc: 0.189 Test Loss: 1.770 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.4413328170776367
Epoch: 2, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.632 Vali Acc: 0.496 Test Loss: 1.632 Test Acc: 0.496
Validation loss decreased (-0.188871 --> -0.496280).  Saving model ...
Epoch: 3 cost time: 0.4112889766693115
Epoch: 3, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.360 Vali Acc: 0.637 Test Loss: 1.360 Test Acc: 0.637
Validation loss decreased (-0.496280 --> -0.637023).  Saving model ...
Epoch: 4 cost time: 0.4904134273529053
Epoch: 4, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.928 Vali Acc: 0.833 Test Loss: 0.928 Test Acc: 0.833
Validation loss decreased (-0.637023 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 0.42046594619750977
Epoch: 5, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.603 Vali Acc: 0.919 Test Loss: 0.603 Test Acc: 0.919
Validation loss decreased (-0.833324 --> -0.918512).  Saving model ...
Epoch: 6 cost time: 0.4520115852355957
Epoch: 6, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.404 Vali Acc: 0.926 Test Loss: 0.404 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925922).  Saving model ...
Epoch: 7 cost time: 0.5076346397399902
Epoch: 7, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.307 Vali Acc: 0.915 Test Loss: 0.307 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.43617820739746094
Epoch: 8, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.44332432746887207
Epoch: 9, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.45315027236938477
Epoch: 10, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.925922 --> -0.940739).  Saving model ...
Epoch: 11 cost time: 0.428908109664917
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 12 cost time: 0.4496893882751465
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 13 cost time: 0.464580774307251
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 14 cost time: 0.4264674186706543
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4249610900878906
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47934865951538086
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4634706974029541
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 0.4386789798736572
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5006732940673828
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.44603562355041504
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4478321075439453
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.45282578468322754
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5100069046020508
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4508376121520996
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.49421119689941406
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4405059814453125
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4877750873565674
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2563846
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6531968116760254
Epoch: 1, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.660 Vali Acc: 0.459 Test Loss: 1.660 Test Acc: 0.459
Validation loss decreased (inf --> -0.459243).  Saving model ...
Epoch: 2 cost time: 0.4489097595214844
Epoch: 2, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.578 Vali Acc: 0.544 Test Loss: 1.578 Test Acc: 0.544
Validation loss decreased (-0.459243 --> -0.544429).  Saving model ...
Epoch: 3 cost time: 0.4336819648742676
Epoch: 3, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.442 Vali Acc: 0.611 Test Loss: 1.442 Test Acc: 0.611
Validation loss decreased (-0.544429 --> -0.611097).  Saving model ...
Epoch: 4 cost time: 0.4764137268066406
Epoch: 4, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.204 Vali Acc: 0.763 Test Loss: 1.204 Test Acc: 0.763
Validation loss decreased (-0.611097 --> -0.762951).  Saving model ...
Epoch: 5 cost time: 0.4097766876220703
Epoch: 5, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.952 Vali Acc: 0.819 Test Loss: 0.952 Test Acc: 0.819
Validation loss decreased (-0.762951 --> -0.818509).  Saving model ...
Epoch: 6 cost time: 0.4467191696166992
Epoch: 6, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.736 Vali Acc: 0.867 Test Loss: 0.736 Test Acc: 0.867
Validation loss decreased (-0.818509 --> -0.866659).  Saving model ...
Epoch: 7 cost time: 0.4694066047668457
Epoch: 7, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.565 Vali Acc: 0.907 Test Loss: 0.565 Test Acc: 0.907
Validation loss decreased (-0.866659 --> -0.907402).  Saving model ...
Epoch: 8 cost time: 0.40659403800964355
Epoch: 8, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.432 Vali Acc: 0.930 Test Loss: 0.432 Test Acc: 0.930
Validation loss decreased (-0.907402 --> -0.929625).  Saving model ...
Epoch: 9 cost time: 0.42740488052368164
Epoch: 9, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 10 cost time: 0.4284203052520752
Epoch: 10, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940738).  Saving model ...
Epoch: 11 cost time: 0.4320406913757324
Epoch: 11, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 12 cost time: 0.4872105121612549
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 13 cost time: 0.4194934368133545
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.44320249557495117
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 15 cost time: 0.42196011543273926
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 16 cost time: 0.4160921573638916
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.39555788040161133
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.4255499839782715
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.48802614212036133
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4857041835784912
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.45876383781433105
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.44029998779296875
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4631946086883545
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4005007743835449
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4245717525482178
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4208686351776123
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.48880696296691895
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4774024486541748
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2361606
model size : 9.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5663073062896729
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.709 Vali Acc: 0.293 Test Loss: 1.709 Test Acc: 0.293
Validation loss decreased (inf --> -0.292575).  Saving model ...
Epoch: 2 cost time: 0.3942553997039795
Epoch: 2, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.644 Vali Acc: 0.344 Test Loss: 1.644 Test Acc: 0.344
Validation loss decreased (-0.292575 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.541217565536499
Epoch: 3, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.543 Vali Acc: 0.456 Test Loss: 1.543 Test Acc: 0.456
Validation loss decreased (-0.344428 --> -0.455540).  Saving model ...
Epoch: 4 cost time: 0.4090547561645508
Epoch: 4, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.362 Vali Acc: 0.800 Test Loss: 1.362 Test Acc: 0.800
Validation loss decreased (-0.455540 --> -0.799986).  Saving model ...
Epoch: 5 cost time: 0.4188687801361084
Epoch: 5, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.148 Vali Acc: 0.870 Test Loss: 1.148 Test Acc: 0.870
Validation loss decreased (-0.799986 --> -0.870359).  Saving model ...
Epoch: 6 cost time: 0.4204123020172119
Epoch: 6, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.938 Vali Acc: 0.904 Test Loss: 0.938 Test Acc: 0.904
Validation loss decreased (-0.870359 --> -0.903694).  Saving model ...
Epoch: 7 cost time: 0.45418429374694824
Epoch: 7, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.757 Vali Acc: 0.930 Test Loss: 0.757 Test Acc: 0.930
Validation loss decreased (-0.903694 --> -0.929622).  Saving model ...
Epoch: 8 cost time: 0.4570789337158203
Epoch: 8, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.609 Vali Acc: 0.937 Test Loss: 0.609 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937031).  Saving model ...
Epoch: 9 cost time: 0.449970006942749
Epoch: 9, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.490 Vali Acc: 0.926 Test Loss: 0.490 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47397589683532715
Epoch: 10, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.406 Vali Acc: 0.933 Test Loss: 0.406 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4255411624908447
Epoch: 11, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.429443359375
Epoch: 12, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.41992902755737305
Epoch: 13, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.43759703636169434
Epoch: 14, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4401693344116211
Epoch: 15, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.48123788833618164
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.5078740119934082
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.42747974395751953
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.4900193214416504
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.420058012008667
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.42010998725891113
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.4460623264312744
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.4984140396118164
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.5343105792999268
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.46283388137817383
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4378829002380371
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5069746971130371
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4431304931640625
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4703547954559326
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5319128036499023
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4821195602416992
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.44651269912719727
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4506409168243408
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.4367547035217285
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2294278
model size : 8.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6305773258209229
Epoch: 1, Steps: 2 | Train Loss: 2.128 Vali Loss: 1.844 Vali Acc: 0.089 Test Loss: 1.844 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 0.5209734439849854
Epoch: 2, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.782 Vali Acc: 0.167 Test Loss: 1.782 Test Acc: 0.167
Validation loss decreased (-0.088870 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.4456474781036377
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.697 Vali Acc: 0.396 Test Loss: 1.697 Test Acc: 0.396
Validation loss decreased (-0.166649 --> -0.396279).  Saving model ...
Epoch: 4 cost time: 0.46311235427856445
Epoch: 4, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.552 Vali Acc: 0.589 Test Loss: 1.552 Test Acc: 0.589
Validation loss decreased (-0.396279 --> -0.588873).  Saving model ...
Epoch: 5 cost time: 0.4547395706176758
Epoch: 5, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.369 Vali Acc: 0.730 Test Loss: 1.369 Test Acc: 0.730
Validation loss decreased (-0.588873 --> -0.729616).  Saving model ...
Epoch: 6 cost time: 0.450244665145874
Epoch: 6, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.168 Vali Acc: 0.830 Test Loss: 1.168 Test Acc: 0.830
Validation loss decreased (-0.729616 --> -0.829618).  Saving model ...
Epoch: 7 cost time: 0.5569033622741699
Epoch: 7, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.969 Vali Acc: 0.896 Test Loss: 0.969 Test Acc: 0.896
Validation loss decreased (-0.829618 --> -0.896287).  Saving model ...
Epoch: 8 cost time: 0.5588507652282715
Epoch: 8, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.787 Vali Acc: 0.919 Test Loss: 0.787 Test Acc: 0.919
Validation loss decreased (-0.896287 --> -0.918511).  Saving model ...
Epoch: 9 cost time: 0.4993155002593994
Epoch: 9, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.635 Vali Acc: 0.930 Test Loss: 0.635 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929623).  Saving model ...
Epoch: 10 cost time: 0.5516774654388428
Epoch: 10, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.515 Vali Acc: 0.933 Test Loss: 0.515 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933328).  Saving model ...
Epoch: 11 cost time: 0.5434904098510742
Epoch: 11, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.418 Vali Acc: 0.937 Test Loss: 0.418 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 12 cost time: 0.5730922222137451
Epoch: 12, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.5626235008239746
Epoch: 13, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.289 Vali Acc: 0.948 Test Loss: 0.289 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 14 cost time: 0.5565481185913086
Epoch: 14, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 15 cost time: 0.5901603698730469
Epoch: 15, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 16 cost time: 0.6465330123901367
Epoch: 16, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 17 cost time: 0.543621301651001
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 0.5732495784759521
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 19 cost time: 0.5559775829315186
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 20 cost time: 0.6219000816345215
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.508514404296875
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6940245628356934
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6202466487884521
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6792759895324707
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5566296577453613
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6266369819641113
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6546804904937744
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6051182746887207
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5507926940917969
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2264070
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.675703525543213
Epoch: 1, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.730 Vali Acc: 0.300 Test Loss: 1.730 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.414703369140625
Epoch: 2, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.673 Vali Acc: 0.452 Test Loss: 1.673 Test Acc: 0.452
Validation loss decreased (-0.299983 --> -0.451835).  Saving model ...
Epoch: 3 cost time: 0.45157408714294434
Epoch: 3, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.599 Vali Acc: 0.567 Test Loss: 1.599 Test Acc: 0.567
Validation loss decreased (-0.451835 --> -0.566651).  Saving model ...
Epoch: 4 cost time: 0.4238283634185791
Epoch: 4, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.474 Vali Acc: 0.674 Test Loss: 1.474 Test Acc: 0.674
Validation loss decreased (-0.566651 --> -0.674059).  Saving model ...
Epoch: 5 cost time: 0.42600083351135254
Epoch: 5, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.317 Vali Acc: 0.759 Test Loss: 1.317 Test Acc: 0.759
Validation loss decreased (-0.674059 --> -0.759246).  Saving model ...
Epoch: 6 cost time: 0.4794750213623047
Epoch: 6, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.145 Vali Acc: 0.826 Test Loss: 1.145 Test Acc: 0.826
Validation loss decreased (-0.759246 --> -0.825914).  Saving model ...
Epoch: 7 cost time: 0.4395756721496582
Epoch: 7, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.975 Vali Acc: 0.907 Test Loss: 0.975 Test Acc: 0.907
Validation loss decreased (-0.825914 --> -0.907398).  Saving model ...
Epoch: 8 cost time: 0.3990664482116699
Epoch: 8, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.820 Vali Acc: 0.915 Test Loss: 0.820 Test Acc: 0.915
Validation loss decreased (-0.907398 --> -0.914807).  Saving model ...
Epoch: 9 cost time: 0.4178640842437744
Epoch: 9, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.684 Vali Acc: 0.930 Test Loss: 0.684 Test Acc: 0.930
Validation loss decreased (-0.914807 --> -0.929623).  Saving model ...
Epoch: 10 cost time: 0.390857458114624
Epoch: 10, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.566 Vali Acc: 0.941 Test Loss: 0.566 Test Acc: 0.941
Validation loss decreased (-0.929623 --> -0.940735).  Saving model ...
Epoch: 11 cost time: 0.4742445945739746
Epoch: 11, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.473 Vali Acc: 0.937 Test Loss: 0.473 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4227280616760254
Epoch: 12, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.397 Vali Acc: 0.937 Test Loss: 0.397 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.44889140129089355
Epoch: 13, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 0.4855196475982666
Epoch: 14, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.4175987243652344
Epoch: 15, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.40725088119506836
Epoch: 16, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.4333608150482178
Epoch: 17, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.4388744831085205
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.4490177631378174
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.4447197914123535
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.38240814208984375
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.4269545078277588
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.4108467102050781
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.4106879234313965
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.4489865303039551
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.47235894203186035
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.394742488861084
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.41135716438293457
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.4294290542602539
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.43379902839660645
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.40615153312683105
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4334847927093506
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.44814085960388184
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.361544132232666
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.3976552486419678
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 36 cost time: 0.39903688430786133
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 37 cost time: 0.4402775764465332
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 38 cost time: 0.4020216464996338
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 39 cost time: 0.42372918128967285
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 40 cost time: 0.40465354919433594
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 41 cost time: 0.40950441360473633
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 42 cost time: 0.42992067337036133
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 43 cost time: 0.437183141708374
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 44 cost time: 0.46941113471984863
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 45 cost time: 0.39797234535217285
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 46 cost time: 0.4285311698913574
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 47 cost time: 0.38811254501342773
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 48 cost time: 0.4189929962158203
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 49 cost time: 0.38025879859924316
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.40238261222839355
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 2246406
model size : 8.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5638456344604492
Epoch: 1, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.692 Vali Acc: 0.356 Test Loss: 1.692 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 0.39605116844177246
Epoch: 2, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.640 Vali Acc: 0.489 Test Loss: 1.640 Test Acc: 0.489
Validation loss decreased (-0.355539 --> -0.488872).  Saving model ...
Epoch: 3 cost time: 0.3823058605194092
Epoch: 3, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.579 Vali Acc: 0.622 Test Loss: 1.579 Test Acc: 0.622
Validation loss decreased (-0.488872 --> -0.622206).  Saving model ...
Epoch: 4 cost time: 0.3934347629547119
Epoch: 4, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.487 Vali Acc: 0.704 Test Loss: 1.487 Test Acc: 0.704
Validation loss decreased (-0.622206 --> -0.703689).  Saving model ...
Epoch: 5 cost time: 0.418670654296875
Epoch: 5, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.370 Vali Acc: 0.770 Test Loss: 1.370 Test Acc: 0.770
Validation loss decreased (-0.703689 --> -0.770357).  Saving model ...
Epoch: 6 cost time: 0.37662816047668457
Epoch: 6, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.236 Vali Acc: 0.837 Test Loss: 1.236 Test Acc: 0.837
Validation loss decreased (-0.770357 --> -0.837025).  Saving model ...
Epoch: 7 cost time: 0.4847705364227295
Epoch: 7, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.091 Vali Acc: 0.889 Test Loss: 1.091 Test Acc: 0.889
Validation loss decreased (-0.837025 --> -0.888878).  Saving model ...
Epoch: 8 cost time: 0.3766510486602783
Epoch: 8, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.948 Vali Acc: 0.911 Test Loss: 0.948 Test Acc: 0.911
Validation loss decreased (-0.888878 --> -0.911102).  Saving model ...
Epoch: 9 cost time: 0.3865373134613037
Epoch: 9, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.818 Vali Acc: 0.937 Test Loss: 0.818 Test Acc: 0.937
Validation loss decreased (-0.911102 --> -0.937029).  Saving model ...
Epoch: 10 cost time: 0.384580135345459
Epoch: 10, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.704 Vali Acc: 0.941 Test Loss: 0.704 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940734).  Saving model ...
Epoch: 11 cost time: 0.45037269592285156
Epoch: 11, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.606 Vali Acc: 0.937 Test Loss: 0.606 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.3721766471862793
Epoch: 12, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.522 Vali Acc: 0.937 Test Loss: 0.522 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3704960346221924
Epoch: 13, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.452 Vali Acc: 0.937 Test Loss: 0.452 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.41160058975219727
Epoch: 14, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.396 Vali Acc: 0.937 Test Loss: 0.396 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.44600844383239746
Epoch: 15, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.352 Vali Acc: 0.948 Test Loss: 0.352 Test Acc: 0.948
Validation loss decreased (-0.940734 --> -0.948145).  Saving model ...
Epoch: 16 cost time: 0.4760282039642334
Epoch: 16, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.318 Vali Acc: 0.948 Test Loss: 0.318 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 17 cost time: 0.39789295196533203
Epoch: 17, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.291 Vali Acc: 0.952 Test Loss: 0.291 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 18 cost time: 0.41462016105651855
Epoch: 18, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.270 Vali Acc: 0.956 Test Loss: 0.270 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 19 cost time: 0.3892185688018799
Epoch: 19, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.959 Test Loss: 0.253 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 20 cost time: 0.4318835735321045
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.239 Vali Acc: 0.959 Test Loss: 0.239 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 21 cost time: 0.4213125705718994
Epoch: 21, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.959 Test Loss: 0.228 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 22 cost time: 0.44307470321655273
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 23 cost time: 0.42499637603759766
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 24 cost time: 0.38408613204956055
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 25 cost time: 0.4298863410949707
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 26 cost time: 0.401195764541626
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 27 cost time: 0.39638376235961914
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 0.3921644687652588
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 0.3888411521911621
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 30 cost time: 0.4778313636779785
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 31 cost time: 0.38205599784851074
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 32 cost time: 0.3857452869415283
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 33 cost time: 0.38248634338378906
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 34 cost time: 0.4200735092163086
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.3873612880706787
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.376176118850708
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.3935866355895996
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.40679025650024414
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.39534878730773926
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.3758082389831543
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4330928325653076
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.41121387481689453
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4328174591064453
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 2222598
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7728924751281738
Epoch: 1, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.766 Vali Acc: 0.207 Test Loss: 1.766 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.4739844799041748
Epoch: 2, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.723 Vali Acc: 0.274 Test Loss: 1.723 Test Acc: 0.274
Validation loss decreased (-0.207390 --> -0.274057).  Saving model ...
Epoch: 3 cost time: 0.4292933940887451
Epoch: 3, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.674 Vali Acc: 0.367 Test Loss: 1.674 Test Acc: 0.367
Validation loss decreased (-0.274057 --> -0.366650).  Saving model ...
Epoch: 4 cost time: 0.4096205234527588
Epoch: 4, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.598 Vali Acc: 0.504 Test Loss: 1.598 Test Acc: 0.504
Validation loss decreased (-0.366650 --> -0.503688).  Saving model ...
Epoch: 5 cost time: 0.4040031433105469
Epoch: 5, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.500 Vali Acc: 0.652 Test Loss: 1.500 Test Acc: 0.652
Validation loss decreased (-0.503688 --> -0.651837).  Saving model ...
Epoch: 6 cost time: 0.47977256774902344
Epoch: 6, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.384 Vali Acc: 0.748 Test Loss: 1.384 Test Acc: 0.748
Validation loss decreased (-0.651837 --> -0.748134).  Saving model ...
Epoch: 7 cost time: 0.511023998260498
Epoch: 7, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.254 Vali Acc: 0.811 Test Loss: 1.254 Test Acc: 0.811
Validation loss decreased (-0.748134 --> -0.811099).  Saving model ...
Epoch: 8 cost time: 0.39661145210266113
Epoch: 8, Steps: 2 | Train Loss: 0.876 Vali Loss: 1.120 Vali Acc: 0.870 Test Loss: 1.120 Test Acc: 0.870
Validation loss decreased (-0.811099 --> -0.870359).  Saving model ...
Epoch: 9 cost time: 0.41541290283203125
Epoch: 9, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.988 Vali Acc: 0.900 Test Loss: 0.988 Test Acc: 0.900
Validation loss decreased (-0.870359 --> -0.899990).  Saving model ...
Epoch: 10 cost time: 0.4153618812561035
Epoch: 10, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.861 Vali Acc: 0.919 Test Loss: 0.861 Test Acc: 0.919
Validation loss decreased (-0.899990 --> -0.918510).  Saving model ...
Epoch: 11 cost time: 0.4284510612487793
Epoch: 11, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.746 Vali Acc: 0.937 Test Loss: 0.746 Test Acc: 0.937
Validation loss decreased (-0.918510 --> -0.937030).  Saving model ...
Epoch: 12 cost time: 0.39432191848754883
Epoch: 12, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.646 Vali Acc: 0.941 Test Loss: 0.646 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940734).  Saving model ...
Epoch: 13 cost time: 0.3854238986968994
Epoch: 13, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.561 Vali Acc: 0.941 Test Loss: 0.561 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 14 cost time: 0.38771557807922363
Epoch: 14, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.491 Vali Acc: 0.941 Test Loss: 0.491 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 15 cost time: 0.39871644973754883
Epoch: 15, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.433 Vali Acc: 0.941 Test Loss: 0.433 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 16 cost time: 0.4020860195159912
Epoch: 16, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.387 Vali Acc: 0.941 Test Loss: 0.387 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 17 cost time: 0.4823904037475586
Epoch: 17, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.349 Vali Acc: 0.941 Test Loss: 0.349 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 18 cost time: 0.4328882694244385
Epoch: 18, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.319 Vali Acc: 0.944 Test Loss: 0.319 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.4072141647338867
Epoch: 19, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.4233672618865967
Epoch: 20, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951849).  Saving model ...
Epoch: 21 cost time: 0.4280226230621338
Epoch: 21, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 22 cost time: 0.4609215259552002
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.952 Test Loss: 0.251 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 23 cost time: 0.4057431221008301
Epoch: 23, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.241 Vali Acc: 0.952 Test Loss: 0.241 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 24 cost time: 0.41202378273010254
Epoch: 24, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.4001781940460205
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.952 Test Loss: 0.227 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.39574527740478516
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.3936431407928467
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.4088134765625
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.4383738040924072
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.4182095527648926
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.44606447219848633
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.38308048248291016
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.4370303153991699
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.4477207660675049
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.45445799827575684
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.44933319091796875
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.452960729598999
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 38 cost time: 0.405012845993042
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 39 cost time: 0.41374683380126953
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 40 cost time: 0.4322495460510254
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 41 cost time: 0.48363590240478516
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 42 cost time: 0.5439910888671875
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.43312621116638184
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4747140407562256
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5047311782836914
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.42217588424682617
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.42130208015441895
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.44735264778137207
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.4834914207458496
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.39816808700561523
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 2211334
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.545341968536377
Epoch: 1, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.698 Vali Acc: 0.378 Test Loss: 1.698 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.39561915397644043
Epoch: 2, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.595 Vali Acc: 0.537 Test Loss: 1.595 Test Acc: 0.537
Validation loss decreased (-0.377761 --> -0.537021).  Saving model ...
Epoch: 3 cost time: 0.3713705539703369
Epoch: 3, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.431 Vali Acc: 0.733 Test Loss: 1.431 Test Acc: 0.733
Validation loss decreased (-0.537021 --> -0.733319).  Saving model ...
Epoch: 4 cost time: 0.4570291042327881
Epoch: 4, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.164 Vali Acc: 0.841 Test Loss: 1.164 Test Acc: 0.841
Validation loss decreased (-0.733319 --> -0.840729).  Saving model ...
Epoch: 5 cost time: 0.44282102584838867
Epoch: 5, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.899 Vali Acc: 0.878 Test Loss: 0.899 Test Acc: 0.878
Validation loss decreased (-0.840729 --> -0.877769).  Saving model ...
Epoch: 6 cost time: 0.4096662998199463
Epoch: 6, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.677 Vali Acc: 0.881 Test Loss: 0.677 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881475).  Saving model ...
Epoch: 7 cost time: 0.4419715404510498
Epoch: 7, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.511 Vali Acc: 0.911 Test Loss: 0.511 Test Acc: 0.911
Validation loss decreased (-0.881475 --> -0.911106).  Saving model ...
Epoch: 8 cost time: 0.44351816177368164
Epoch: 8, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.391 Vali Acc: 0.919 Test Loss: 0.391 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918515).  Saving model ...
Epoch: 9 cost time: 0.41667842864990234
Epoch: 9, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.317 Vali Acc: 0.926 Test Loss: 0.317 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 10 cost time: 0.43183350563049316
Epoch: 10, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 11 cost time: 0.4018547534942627
Epoch: 11, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.494565486907959
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 13 cost time: 0.3965175151824951
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.3938131332397461
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 15 cost time: 0.38587021827697754
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 16 cost time: 0.3909273147583008
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 17 cost time: 0.37457966804504395
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 0.38793182373046875
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 19 cost time: 0.4157450199127197
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 20 cost time: 0.37491798400878906
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 21 cost time: 0.4172532558441162
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.39996981620788574
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4380209445953369
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4547111988067627
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.42972874641418457
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3946554660797119
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3751645088195801
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.41332340240478516
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.41321659088134766
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4469327926635742
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 757638
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5393662452697754
Epoch: 1, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.764 Vali Acc: 0.156 Test Loss: 1.764 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.4040071964263916
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.696 Vali Acc: 0.270 Test Loss: 1.696 Test Acc: 0.270
Validation loss decreased (-0.155538 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.4492223262786865
Epoch: 3, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.604 Vali Acc: 0.415 Test Loss: 1.604 Test Acc: 0.415
Validation loss decreased (-0.270353 --> -0.414799).  Saving model ...
Epoch: 4 cost time: 0.3829193115234375
Epoch: 4, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.448 Vali Acc: 0.722 Test Loss: 1.448 Test Acc: 0.722
Validation loss decreased (-0.414799 --> -0.722208).  Saving model ...
Epoch: 5 cost time: 0.42650437355041504
Epoch: 5, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.258 Vali Acc: 0.844 Test Loss: 1.258 Test Acc: 0.844
Validation loss decreased (-0.722208 --> -0.844432).  Saving model ...
Epoch: 6 cost time: 0.4056060314178467
Epoch: 6, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.058 Vali Acc: 0.870 Test Loss: 1.058 Test Acc: 0.870
Validation loss decreased (-0.844432 --> -0.870360).  Saving model ...
Epoch: 7 cost time: 0.45360350608825684
Epoch: 7, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.875 Vali Acc: 0.900 Test Loss: 0.875 Test Acc: 0.900
Validation loss decreased (-0.870360 --> -0.899991).  Saving model ...
Epoch: 8 cost time: 0.403292179107666
Epoch: 8, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.715 Vali Acc: 0.919 Test Loss: 0.715 Test Acc: 0.919
Validation loss decreased (-0.899991 --> -0.918511).  Saving model ...
Epoch: 9 cost time: 0.37786865234375
Epoch: 9, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.583 Vali Acc: 0.930 Test Loss: 0.583 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929624).  Saving model ...
Epoch: 10 cost time: 0.379791259765625
Epoch: 10, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.474 Vali Acc: 0.944 Test Loss: 0.474 Test Acc: 0.944
Validation loss decreased (-0.929624 --> -0.944440).  Saving model ...
Epoch: 11 cost time: 0.4027233123779297
Epoch: 11, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.391 Vali Acc: 0.948 Test Loss: 0.391 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 12 cost time: 0.38240790367126465
Epoch: 12, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.330 Vali Acc: 0.944 Test Loss: 0.330 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3775179386138916
Epoch: 13, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.42688560485839844
Epoch: 14, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.45812153816223145
Epoch: 15, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.38835787773132324
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948146).  Saving model ...
Epoch: 17 cost time: 0.38756561279296875
Epoch: 17, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.3890833854675293
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.4439711570739746
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.3935537338256836
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.3894970417022705
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.38849306106567383
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.3934662342071533
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 24 cost time: 0.42385315895080566
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 0.3842942714691162
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 26 cost time: 0.4035308361053467
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.4434535503387451
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 28 cost time: 0.3558218479156494
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 29 cost time: 0.3796403408050537
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 30 cost time: 0.3891942501068115
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 31 cost time: 0.4219386577606201
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 32 cost time: 0.39005374908447266
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.39748644828796387
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.388075590133667
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4069843292236328
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.40188026428222656
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.3860011100769043
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.39982008934020996
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.3993186950683594
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.43938302993774414
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.41935062408447266
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 656518
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5791161060333252
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.828 Vali Acc: 0.163 Test Loss: 1.828 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.3941371440887451
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.775 Vali Acc: 0.233 Test Loss: 1.775 Test Acc: 0.233
Validation loss decreased (-0.162945 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 0.3535740375518799
Epoch: 3, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.711 Vali Acc: 0.341 Test Loss: 1.711 Test Acc: 0.341
Validation loss decreased (-0.233316 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.416210412979126
Epoch: 4, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.610 Vali Acc: 0.519 Test Loss: 1.610 Test Acc: 0.519
Validation loss decreased (-0.340724 --> -0.518502).  Saving model ...
Epoch: 5 cost time: 0.4366886615753174
Epoch: 5, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.479 Vali Acc: 0.637 Test Loss: 1.479 Test Acc: 0.637
Validation loss decreased (-0.518502 --> -0.637022).  Saving model ...
Epoch: 6 cost time: 0.4023306369781494
Epoch: 6, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.330 Vali Acc: 0.763 Test Loss: 1.330 Test Acc: 0.763
Validation loss decreased (-0.637022 --> -0.762950).  Saving model ...
Epoch: 7 cost time: 0.43210911750793457
Epoch: 7, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.174 Vali Acc: 0.807 Test Loss: 1.174 Test Acc: 0.807
Validation loss decreased (-0.762950 --> -0.807396).  Saving model ...
Epoch: 8 cost time: 0.46953773498535156
Epoch: 8, Steps: 2 | Train Loss: 0.735 Vali Loss: 1.022 Vali Acc: 0.841 Test Loss: 1.022 Test Acc: 0.841
Validation loss decreased (-0.807396 --> -0.840731).  Saving model ...
Epoch: 9 cost time: 0.4348413944244385
Epoch: 9, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.879 Vali Acc: 0.889 Test Loss: 0.879 Test Acc: 0.889
Validation loss decreased (-0.840731 --> -0.888880).  Saving model ...
Epoch: 10 cost time: 0.5047276020050049
Epoch: 10, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.752 Vali Acc: 0.900 Test Loss: 0.752 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.45360302925109863
Epoch: 11, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.642 Vali Acc: 0.922 Test Loss: 0.642 Test Acc: 0.922
Validation loss decreased (-0.899992 --> -0.922216).  Saving model ...
Epoch: 12 cost time: 0.4163076877593994
Epoch: 12, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.551 Vali Acc: 0.922 Test Loss: 0.551 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 13 cost time: 0.420454740524292
Epoch: 13, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.477 Vali Acc: 0.930 Test Loss: 0.477 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 14 cost time: 0.41362524032592773
Epoch: 14, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.416 Vali Acc: 0.930 Test Loss: 0.416 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 15 cost time: 0.513617992401123
Epoch: 15, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.366 Vali Acc: 0.930 Test Loss: 0.366 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 16 cost time: 0.4012906551361084
Epoch: 16, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 17 cost time: 0.49123549461364746
Epoch: 17, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.5260999202728271
Epoch: 18, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.47625112533569336
Epoch: 19, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.39921045303344727
Epoch: 20, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.45041465759277344
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.4362778663635254
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.4114513397216797
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.4102325439453125
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.41393542289733887
Epoch: 25, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.41352009773254395
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.41044139862060547
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.49829888343811035
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.4392201900482178
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.4752645492553711
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.4550442695617676
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.45507192611694336
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.40139245986938477
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.5371086597442627
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.4125051498413086
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.4740254878997803
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.4286201000213623
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.41432857513427734
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.42937707901000977
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.4181182384490967
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.4379446506500244
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.41521501541137695
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.4545445442199707
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.4516911506652832
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.4635756015777588
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.4442605972290039
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.4218306541442871
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.40290403366088867
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.44962024688720703
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.4720284938812256
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 622854
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6534664630889893
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.771 Vali Acc: 0.170 Test Loss: 1.771 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.3802938461303711
Epoch: 2, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.726 Vali Acc: 0.289 Test Loss: 1.726 Test Acc: 0.289
Validation loss decreased (-0.170353 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 0.38229942321777344
Epoch: 3, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.674 Vali Acc: 0.378 Test Loss: 1.674 Test Acc: 0.378
Validation loss decreased (-0.288872 --> -0.377761).  Saving model ...
Epoch: 4 cost time: 0.4300234317779541
Epoch: 4, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.594 Vali Acc: 0.489 Test Loss: 1.594 Test Acc: 0.489
Validation loss decreased (-0.377761 --> -0.488873).  Saving model ...
Epoch: 5 cost time: 0.36629605293273926
Epoch: 5, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.492 Vali Acc: 0.570 Test Loss: 1.492 Test Acc: 0.570
Validation loss decreased (-0.488873 --> -0.570355).  Saving model ...
Epoch: 6 cost time: 0.3752131462097168
Epoch: 6, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.372 Vali Acc: 0.641 Test Loss: 1.372 Test Acc: 0.641
Validation loss decreased (-0.570355 --> -0.640727).  Saving model ...
Epoch: 7 cost time: 0.3657498359680176
Epoch: 7, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.243 Vali Acc: 0.722 Test Loss: 1.243 Test Acc: 0.722
Validation loss decreased (-0.640727 --> -0.722210).  Saving model ...
Epoch: 8 cost time: 0.4466099739074707
Epoch: 8, Steps: 2 | Train Loss: 0.866 Vali Loss: 1.111 Vali Acc: 0.774 Test Loss: 1.111 Test Acc: 0.774
Validation loss decreased (-0.722210 --> -0.774063).  Saving model ...
Epoch: 9 cost time: 0.3989267349243164
Epoch: 9, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.984 Vali Acc: 0.819 Test Loss: 0.984 Test Acc: 0.819
Validation loss decreased (-0.774063 --> -0.818509).  Saving model ...
Epoch: 10 cost time: 0.37326598167419434
Epoch: 10, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.863 Vali Acc: 0.848 Test Loss: 0.863 Test Acc: 0.848
Validation loss decreased (-0.818509 --> -0.848140).  Saving model ...
Epoch: 11 cost time: 0.3855464458465576
Epoch: 11, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.755 Vali Acc: 0.878 Test Loss: 0.755 Test Acc: 0.878
Validation loss decreased (-0.848140 --> -0.877770).  Saving model ...
Epoch: 12 cost time: 0.3817458152770996
Epoch: 12, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.659 Vali Acc: 0.904 Test Loss: 0.659 Test Acc: 0.904
Validation loss decreased (-0.877770 --> -0.903697).  Saving model ...
Epoch: 13 cost time: 0.41710972785949707
Epoch: 13, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.576 Vali Acc: 0.911 Test Loss: 0.576 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 14 cost time: 0.37744617462158203
Epoch: 14, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.506 Vali Acc: 0.919 Test Loss: 0.506 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 15 cost time: 0.38081908226013184
Epoch: 15, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.446 Vali Acc: 0.933 Test Loss: 0.446 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933329).  Saving model ...
Epoch: 16 cost time: 0.38480043411254883
Epoch: 16, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.398 Vali Acc: 0.937 Test Loss: 0.398 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 17 cost time: 0.3819437026977539
Epoch: 17, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.36918020248413086
Epoch: 18, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.328 Vali Acc: 0.952 Test Loss: 0.328 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951849).  Saving model ...
Epoch: 19 cost time: 0.3765428066253662
Epoch: 19, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.302 Vali Acc: 0.956 Test Loss: 0.302 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 20 cost time: 0.3690965175628662
Epoch: 20, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 21 cost time: 0.39240336418151855
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.265 Vali Acc: 0.952 Test Loss: 0.265 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.37113380432128906
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 23 cost time: 0.4032266139984131
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.241 Vali Acc: 0.956 Test Loss: 0.241 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 24 cost time: 0.408627986907959
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.3951735496520996
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.227 Vali Acc: 0.959 Test Loss: 0.227 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 26 cost time: 0.3778109550476074
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.959 Test Loss: 0.222 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.370678186416626
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 28 cost time: 0.39284777641296387
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.959 Test Loss: 0.215 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.3965291976928711
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.37900400161743164
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.39184141159057617
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.3565654754638672
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 33 cost time: 0.43674588203430176
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 34 cost time: 0.37352705001831055
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.4115407466888428
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 36 cost time: 0.3633413314819336
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 37 cost time: 0.37792110443115234
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 38 cost time: 0.37656140327453613
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 39 cost time: 0.3879234790802002
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 40 cost time: 0.390655517578125
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.394744873046875
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.4406561851501465
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 43 cost time: 0.416790246963501
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.3933999538421631
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.3744645118713379
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 46 cost time: 0.41149473190307617
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.34588098526000977
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.41312313079833984
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.3784492015838623
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.45918941497802734
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 607750
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.684788465499878
Epoch: 1, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.838 Vali Acc: 0.256 Test Loss: 1.838 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 0.4718194007873535
Epoch: 2, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.796 Vali Acc: 0.270 Test Loss: 1.796 Test Acc: 0.270
Validation loss decreased (-0.255537 --> -0.270352).  Saving model ...
Epoch: 3 cost time: 0.41194796562194824
Epoch: 3, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.750 Vali Acc: 0.281 Test Loss: 1.750 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.40978026390075684
Epoch: 4, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.683 Vali Acc: 0.330 Test Loss: 1.683 Test Acc: 0.330
Validation loss decreased (-0.281464 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.39981579780578613
Epoch: 5, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.595 Vali Acc: 0.430 Test Loss: 1.595 Test Acc: 0.430
Validation loss decreased (-0.329613 --> -0.429614).  Saving model ...
Epoch: 6 cost time: 0.43485546112060547
Epoch: 6, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.489 Vali Acc: 0.537 Test Loss: 1.489 Test Acc: 0.537
Validation loss decreased (-0.429614 --> -0.537022).  Saving model ...
Epoch: 7 cost time: 0.38781142234802246
Epoch: 7, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.370 Vali Acc: 0.637 Test Loss: 1.370 Test Acc: 0.637
Validation loss decreased (-0.537022 --> -0.637023).  Saving model ...
Epoch: 8 cost time: 0.40962815284729004
Epoch: 8, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.242 Vali Acc: 0.752 Test Loss: 1.242 Test Acc: 0.752
Validation loss decreased (-0.637023 --> -0.751839).  Saving model ...
Epoch: 9 cost time: 0.4057962894439697
Epoch: 9, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.112 Vali Acc: 0.830 Test Loss: 1.112 Test Acc: 0.830
Validation loss decreased (-0.751839 --> -0.829619).  Saving model ...
Epoch: 10 cost time: 0.4026157855987549
Epoch: 10, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.985 Vali Acc: 0.881 Test Loss: 0.985 Test Acc: 0.881
Validation loss decreased (-0.829619 --> -0.881472).  Saving model ...
Epoch: 11 cost time: 0.40653538703918457
Epoch: 11, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.866 Vali Acc: 0.893 Test Loss: 0.866 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 12 cost time: 0.4077877998352051
Epoch: 12, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.757 Vali Acc: 0.911 Test Loss: 0.757 Test Acc: 0.911
Validation loss decreased (-0.892584 --> -0.911104).  Saving model ...
Epoch: 13 cost time: 0.3957359790802002
Epoch: 13, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.663 Vali Acc: 0.915 Test Loss: 0.663 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 14 cost time: 0.442460298538208
Epoch: 14, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.580 Vali Acc: 0.922 Test Loss: 0.580 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 15 cost time: 0.3735342025756836
Epoch: 15, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.510 Vali Acc: 0.926 Test Loss: 0.510 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.4256923198699951
Epoch: 16, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.451 Vali Acc: 0.926 Test Loss: 0.451 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 17 cost time: 0.3794364929199219
Epoch: 17, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.403 Vali Acc: 0.933 Test Loss: 0.403 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 18 cost time: 0.4295375347137451
Epoch: 18, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.364 Vali Acc: 0.944 Test Loss: 0.364 Test Acc: 0.944
Validation loss decreased (-0.933329 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.3914225101470947
Epoch: 19, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.3845248222351074
Epoch: 20, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.303 Vali Acc: 0.948 Test Loss: 0.303 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 21 cost time: 0.4225900173187256
Epoch: 21, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.38148999214172363
Epoch: 22, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.36240601539611816
Epoch: 23, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 24 cost time: 0.45560145378112793
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.239 Vali Acc: 0.956 Test Loss: 0.239 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.37491393089294434
Epoch: 25, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.39899373054504395
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.4536764621734619
Epoch: 27, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.3718276023864746
Epoch: 28, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.41762685775756836
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.37957143783569336
Epoch: 30, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 31 cost time: 0.3869810104370117
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.4314236640930176
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.49324655532836914
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.41525816917419434
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.44730496406555176
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.4534766674041748
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
Validation loss decreased (-0.955554 --> -0.962961).  Saving model ...
Epoch: 37 cost time: 0.4000697135925293
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 38 cost time: 0.4204216003417969
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 39 cost time: 0.4145643711090088
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4451007843017578
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.43492889404296875
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4753103256225586
Epoch: 42, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4677238464355469
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4628722667694092
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.46077513694763184
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.48288536071777344
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5401673316955566
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.405895471572876
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 598918
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5960876941680908
Epoch: 1, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.799 Vali Acc: 0.159 Test Loss: 1.799 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.3633415699005127
Epoch: 2, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.765 Vali Acc: 0.185 Test Loss: 1.765 Test Acc: 0.185
Validation loss decreased (-0.159241 --> -0.185168).  Saving model ...
Epoch: 3 cost time: 0.38572072982788086
Epoch: 3, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.730 Vali Acc: 0.230 Test Loss: 1.730 Test Acc: 0.230
Validation loss decreased (-0.185168 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.3803894519805908
Epoch: 4, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.683 Vali Acc: 0.263 Test Loss: 1.683 Test Acc: 0.263
Validation loss decreased (-0.229612 --> -0.262946).  Saving model ...
Epoch: 5 cost time: 0.4112517833709717
Epoch: 5, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.621 Vali Acc: 0.385 Test Loss: 1.621 Test Acc: 0.385
Validation loss decreased (-0.262946 --> -0.385169).  Saving model ...
Epoch: 6 cost time: 0.4533097743988037
Epoch: 6, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.546 Vali Acc: 0.533 Test Loss: 1.546 Test Acc: 0.533
Validation loss decreased (-0.385169 --> -0.533318).  Saving model ...
Epoch: 7 cost time: 0.4291069507598877
Epoch: 7, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.459 Vali Acc: 0.604 Test Loss: 1.459 Test Acc: 0.604
Validation loss decreased (-0.533318 --> -0.603689).  Saving model ...
Epoch: 8 cost time: 0.4220263957977295
Epoch: 8, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.364 Vali Acc: 0.648 Test Loss: 1.364 Test Acc: 0.648
Validation loss decreased (-0.603689 --> -0.648135).  Saving model ...
Epoch: 9 cost time: 0.44603562355041504
Epoch: 9, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.263 Vali Acc: 0.715 Test Loss: 1.263 Test Acc: 0.715
Validation loss decreased (-0.648135 --> -0.714802).  Saving model ...
Epoch: 10 cost time: 0.38347959518432617
Epoch: 10, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.160 Vali Acc: 0.763 Test Loss: 1.160 Test Acc: 0.763
Validation loss decreased (-0.714802 --> -0.762951).  Saving model ...
Epoch: 11 cost time: 0.41570115089416504
Epoch: 11, Steps: 2 | Train Loss: 0.856 Vali Loss: 1.055 Vali Acc: 0.819 Test Loss: 1.055 Test Acc: 0.819
Validation loss decreased (-0.762951 --> -0.818508).  Saving model ...
Epoch: 12 cost time: 0.4221341609954834
Epoch: 12, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.955 Vali Acc: 0.848 Test Loss: 0.955 Test Acc: 0.848
Validation loss decreased (-0.818508 --> -0.848139).  Saving model ...
Epoch: 13 cost time: 0.41770124435424805
Epoch: 13, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.861 Vali Acc: 0.859 Test Loss: 0.861 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 14 cost time: 0.42870593070983887
Epoch: 14, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.775 Vali Acc: 0.896 Test Loss: 0.775 Test Acc: 0.896
Validation loss decreased (-0.859251 --> -0.896289).  Saving model ...
Epoch: 15 cost time: 0.4323410987854004
Epoch: 15, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.697 Vali Acc: 0.907 Test Loss: 0.697 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907400).  Saving model ...
Epoch: 16 cost time: 0.42041754722595215
Epoch: 16, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.629 Vali Acc: 0.915 Test Loss: 0.629 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914809).  Saving model ...
Epoch: 17 cost time: 0.39733219146728516
Epoch: 17, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.568 Vali Acc: 0.922 Test Loss: 0.568 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 18 cost time: 0.46307921409606934
Epoch: 18, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.516 Vali Acc: 0.930 Test Loss: 0.516 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929624).  Saving model ...
Epoch: 19 cost time: 0.3847842216491699
Epoch: 19, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.471 Vali Acc: 0.933 Test Loss: 0.471 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933329).  Saving model ...
Epoch: 20 cost time: 0.4096083641052246
Epoch: 20, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.432 Vali Acc: 0.941 Test Loss: 0.432 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940736).  Saving model ...
Epoch: 21 cost time: 0.42285656929016113
Epoch: 21, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.398 Vali Acc: 0.944 Test Loss: 0.398 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 22 cost time: 0.43749451637268066
Epoch: 22, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.370 Vali Acc: 0.941 Test Loss: 0.370 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4325063228607178
Epoch: 23, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.346 Vali Acc: 0.941 Test Loss: 0.346 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.39609241485595703
Epoch: 24, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.326 Vali Acc: 0.944 Test Loss: 0.326 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 0.4312782287597656
Epoch: 25, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.309 Vali Acc: 0.948 Test Loss: 0.309 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 26 cost time: 0.3908519744873047
Epoch: 26, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.295 Vali Acc: 0.948 Test Loss: 0.295 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.3649015426635742
Epoch: 27, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.41224217414855957
Epoch: 28, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.274 Vali Acc: 0.952 Test Loss: 0.274 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 29 cost time: 0.40057373046875
Epoch: 29, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.952 Test Loss: 0.265 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.4287278652191162
Epoch: 30, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.258 Vali Acc: 0.952 Test Loss: 0.258 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.4222452640533447
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.40836119651794434
Epoch: 32, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.248 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.4170246124267578
Epoch: 33, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.243 Vali Acc: 0.952 Test Loss: 0.243 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.4451174736022949
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.39696335792541504
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.44525957107543945
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.4062483310699463
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.4155406951904297
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.4051332473754883
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.40265417098999023
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.40337514877319336
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.44605207443237305
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.39005160331726074
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.3781466484069824
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.4318408966064453
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.41083383560180664
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.415393590927124
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.3989863395690918
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.43578672409057617
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.40495991706848145
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 587014
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8169033527374268
Epoch: 1, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.770 Vali Acc: 0.170 Test Loss: 1.770 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.382704496383667
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.747 Vali Acc: 0.174 Test Loss: 1.747 Test Acc: 0.174
Validation loss decreased (-0.170353 --> -0.174057).  Saving model ...
Epoch: 3 cost time: 0.3816375732421875
Epoch: 3, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.723 Vali Acc: 0.219 Test Loss: 1.723 Test Acc: 0.219
Validation loss decreased (-0.174057 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.39861607551574707
Epoch: 4, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.691 Vali Acc: 0.289 Test Loss: 1.691 Test Acc: 0.289
Validation loss decreased (-0.218501 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.4702305793762207
Epoch: 5, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.647 Vali Acc: 0.389 Test Loss: 1.647 Test Acc: 0.389
Validation loss decreased (-0.288872 --> -0.388872).  Saving model ...
Epoch: 6 cost time: 0.42064571380615234
Epoch: 6, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.592 Vali Acc: 0.459 Test Loss: 1.592 Test Acc: 0.459
Validation loss decreased (-0.388872 --> -0.459243).  Saving model ...
Epoch: 7 cost time: 0.4077622890472412
Epoch: 7, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.525 Vali Acc: 0.544 Test Loss: 1.525 Test Acc: 0.544
Validation loss decreased (-0.459243 --> -0.544429).  Saving model ...
Epoch: 8 cost time: 0.3950209617614746
Epoch: 8, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.451 Vali Acc: 0.619 Test Loss: 1.451 Test Acc: 0.619
Validation loss decreased (-0.544429 --> -0.618504).  Saving model ...
Epoch: 9 cost time: 0.4181947708129883
Epoch: 9, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.369 Vali Acc: 0.667 Test Loss: 1.369 Test Acc: 0.667
Validation loss decreased (-0.618504 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 0.46613502502441406
Epoch: 10, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.283 Vali Acc: 0.711 Test Loss: 1.283 Test Acc: 0.711
Validation loss decreased (-0.666653 --> -0.711098).  Saving model ...
Epoch: 11 cost time: 0.4062352180480957
Epoch: 11, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.194 Vali Acc: 0.748 Test Loss: 1.194 Test Acc: 0.748
Validation loss decreased (-0.711098 --> -0.748136).  Saving model ...
Epoch: 12 cost time: 0.4002983570098877
Epoch: 12, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.106 Vali Acc: 0.781 Test Loss: 1.106 Test Acc: 0.781
Validation loss decreased (-0.748136 --> -0.781470).  Saving model ...
Epoch: 13 cost time: 0.45314836502075195
Epoch: 13, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.021 Vali Acc: 0.815 Test Loss: 1.021 Test Acc: 0.815
Validation loss decreased (-0.781470 --> -0.814805).  Saving model ...
Epoch: 14 cost time: 0.5211608409881592
Epoch: 14, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.939 Vali Acc: 0.841 Test Loss: 0.939 Test Acc: 0.841
Validation loss decreased (-0.814805 --> -0.840731).  Saving model ...
Epoch: 15 cost time: 0.38997840881347656
Epoch: 15, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.861 Vali Acc: 0.874 Test Loss: 0.861 Test Acc: 0.874
Validation loss decreased (-0.840731 --> -0.874065).  Saving model ...
Epoch: 16 cost time: 0.3945131301879883
Epoch: 16, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.788 Vali Acc: 0.889 Test Loss: 0.788 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888881).  Saving model ...
Epoch: 17 cost time: 0.4759705066680908
Epoch: 17, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.721 Vali Acc: 0.900 Test Loss: 0.721 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.40720057487487793
Epoch: 18, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.659 Vali Acc: 0.915 Test Loss: 0.659 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914808).  Saving model ...
Epoch: 19 cost time: 0.5080385208129883
Epoch: 19, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.604 Vali Acc: 0.926 Test Loss: 0.604 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 20 cost time: 0.5152528285980225
Epoch: 20, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.554 Vali Acc: 0.941 Test Loss: 0.554 Test Acc: 0.941
Validation loss decreased (-0.925920 --> -0.940735).  Saving model ...
Epoch: 21 cost time: 0.5228075981140137
Epoch: 21, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.510 Vali Acc: 0.944 Test Loss: 0.510 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 22 cost time: 0.49490928649902344
Epoch: 22, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.472 Vali Acc: 0.952 Test Loss: 0.472 Test Acc: 0.952
Validation loss decreased (-0.944439 --> -0.951847).  Saving model ...
Epoch: 23 cost time: 0.4120967388153076
Epoch: 23, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.440 Vali Acc: 0.952 Test Loss: 0.440 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
Epoch: 24 cost time: 0.49060750007629395
Epoch: 24, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.412 Vali Acc: 0.952 Test Loss: 0.412 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 25 cost time: 0.4926338195800781
Epoch: 25, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.388 Vali Acc: 0.952 Test Loss: 0.388 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 26 cost time: 0.49971675872802734
Epoch: 26, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.368 Vali Acc: 0.952 Test Loss: 0.368 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 27 cost time: 0.5068860054016113
Epoch: 27, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.350 Vali Acc: 0.952 Test Loss: 0.350 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 28 cost time: 0.4731435775756836
Epoch: 28, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.336 Vali Acc: 0.952 Test Loss: 0.336 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 29 cost time: 0.6050565242767334
Epoch: 29, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.323 Vali Acc: 0.952 Test Loss: 0.323 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.42012715339660645
Epoch: 30, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.312 Vali Acc: 0.952 Test Loss: 0.312 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.5180888175964355
Epoch: 31, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.4111294746398926
Epoch: 32, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.294 Vali Acc: 0.952 Test Loss: 0.294 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.49086976051330566
Epoch: 33, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.286 Vali Acc: 0.952 Test Loss: 0.286 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.4932563304901123
Epoch: 34, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.4722585678100586
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.5151503086090088
Epoch: 36, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.48929405212402344
Epoch: 37, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.4976496696472168
Epoch: 38, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.258 Vali Acc: 0.952 Test Loss: 0.258 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.5051584243774414
Epoch: 39, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.49472475051879883
Epoch: 40, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.4690091609954834
Epoch: 41, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.247 Vali Acc: 0.952 Test Loss: 0.247 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.42251133918762207
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.244 Vali Acc: 0.952 Test Loss: 0.244 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.49823737144470215
Epoch: 43, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.47860264778137207
Epoch: 44, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.47130632400512695
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5732293128967285
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 47 cost time: 0.5002181529998779
Epoch: 47, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4911620616912842
Epoch: 48, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.502161979675293
Epoch: 49, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.47806549072265625
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 581382
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5091190338134766
Epoch: 1, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.707 Vali Acc: 0.285 Test Loss: 1.707 Test Acc: 0.285
Validation loss decreased (inf --> -0.285168).  Saving model ...
Epoch: 2 cost time: 0.33150410652160645
Epoch: 2, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.634 Vali Acc: 0.444 Test Loss: 1.634 Test Acc: 0.444
Validation loss decreased (-0.285168 --> -0.444428).  Saving model ...
Epoch: 3 cost time: 0.3597743511199951
Epoch: 3, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.541 Vali Acc: 0.559 Test Loss: 1.541 Test Acc: 0.559
Validation loss decreased (-0.444428 --> -0.559244).  Saving model ...
Epoch: 4 cost time: 0.37837719917297363
Epoch: 4, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.393 Vali Acc: 0.659 Test Loss: 1.393 Test Acc: 0.659
Validation loss decreased (-0.559244 --> -0.659245).  Saving model ...
Epoch: 5 cost time: 0.4436359405517578
Epoch: 5, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.217 Vali Acc: 0.752 Test Loss: 1.217 Test Acc: 0.752
Validation loss decreased (-0.659245 --> -0.751840).  Saving model ...
Epoch: 6 cost time: 0.3558809757232666
Epoch: 6, Steps: 2 | Train Loss: 0.789 Vali Loss: 1.039 Vali Acc: 0.826 Test Loss: 1.039 Test Acc: 0.826
Validation loss decreased (-0.751840 --> -0.825916).  Saving model ...
Epoch: 7 cost time: 0.36774396896362305
Epoch: 7, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.873 Vali Acc: 0.881 Test Loss: 0.873 Test Acc: 0.881
Validation loss decreased (-0.825916 --> -0.881473).  Saving model ...
Epoch: 8 cost time: 0.4669530391693115
Epoch: 8, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.729 Vali Acc: 0.889 Test Loss: 0.729 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888882).  Saving model ...
Epoch: 9 cost time: 0.4310448169708252
Epoch: 9, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.605 Vali Acc: 0.904 Test Loss: 0.605 Test Acc: 0.904
Validation loss decreased (-0.888882 --> -0.903698).  Saving model ...
Epoch: 10 cost time: 0.34479856491088867
Epoch: 10, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.35590195655822754
Epoch: 11, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.420 Vali Acc: 0.944 Test Loss: 0.420 Test Acc: 0.944
Validation loss decreased (-0.903698 --> -0.944440).  Saving model ...
Epoch: 12 cost time: 0.3793816566467285
Epoch: 12, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 13 cost time: 0.37204933166503906
Epoch: 13, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.35323357582092285
Epoch: 14, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.35988306999206543
Epoch: 15, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 16 cost time: 0.547255277633667
Epoch: 16, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.956 Test Loss: 0.230 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955553).  Saving model ...
Epoch: 17 cost time: 0.41623425483703613
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 18 cost time: 0.3660762310028076
Epoch: 18, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 19 cost time: 0.354555606842041
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 20 cost time: 0.37239718437194824
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 21 cost time: 0.3568606376647949
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.37403273582458496
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 23 cost time: 0.38311076164245605
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 24 cost time: 0.3525557518005371
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 0.3816704750061035
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 0.3452630043029785
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.39548587799072266
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.3767964839935303
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.40964484214782715
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.42514610290527344
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.3747830390930176
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.35909271240234375
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.3763163089752197
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.3937957286834717
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.36850929260253906
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.35202670097351074
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4397437572479248
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.3702249526977539
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.36075305938720703
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4179208278656006
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.3829612731933594
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.3498659133911133
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.34171628952026367
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4053800106048584
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.37813735008239746
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.37398719787597656
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.4152674674987793
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.33750104904174805
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.37198591232299805
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.36852145195007324
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 247750
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6704118251800537
Epoch: 1, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.739 Vali Acc: 0.185 Test Loss: 1.739 Test Acc: 0.185
Validation loss decreased (inf --> -0.185168).  Saving model ...
Epoch: 2 cost time: 0.388045072555542
Epoch: 2, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.695 Vali Acc: 0.263 Test Loss: 1.695 Test Acc: 0.263
Validation loss decreased (-0.185168 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.3776834011077881
Epoch: 3, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.643 Vali Acc: 0.370 Test Loss: 1.643 Test Acc: 0.370
Validation loss decreased (-0.262946 --> -0.370354).  Saving model ...
Epoch: 4 cost time: 0.4099161624908447
Epoch: 4, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.565 Vali Acc: 0.485 Test Loss: 1.565 Test Acc: 0.485
Validation loss decreased (-0.370354 --> -0.485170).  Saving model ...
Epoch: 5 cost time: 0.37427616119384766
Epoch: 5, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.468 Vali Acc: 0.567 Test Loss: 1.468 Test Acc: 0.567
Validation loss decreased (-0.485170 --> -0.566652).  Saving model ...
Epoch: 6 cost time: 0.42722535133361816
Epoch: 6, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.353 Vali Acc: 0.656 Test Loss: 1.353 Test Acc: 0.656
Validation loss decreased (-0.566652 --> -0.655542).  Saving model ...
Epoch: 7 cost time: 0.45024991035461426
Epoch: 7, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.230 Vali Acc: 0.744 Test Loss: 1.230 Test Acc: 0.744
Validation loss decreased (-0.655542 --> -0.744432).  Saving model ...
Epoch: 8 cost time: 0.35329580307006836
Epoch: 8, Steps: 2 | Train Loss: 0.876 Vali Loss: 1.104 Vali Acc: 0.807 Test Loss: 1.104 Test Acc: 0.807
Validation loss decreased (-0.744432 --> -0.807396).  Saving model ...
Epoch: 9 cost time: 0.37811851501464844
Epoch: 9, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.980 Vali Acc: 0.848 Test Loss: 0.980 Test Acc: 0.848
Validation loss decreased (-0.807396 --> -0.848138).  Saving model ...
Epoch: 10 cost time: 0.482196569442749
Epoch: 10, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.863 Vali Acc: 0.867 Test Loss: 0.863 Test Acc: 0.867
Validation loss decreased (-0.848138 --> -0.866658).  Saving model ...
Epoch: 11 cost time: 0.4673173427581787
Epoch: 11, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.756 Vali Acc: 0.889 Test Loss: 0.756 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888881).  Saving model ...
Epoch: 12 cost time: 0.3911604881286621
Epoch: 12, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.660 Vali Acc: 0.896 Test Loss: 0.660 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896290).  Saving model ...
Epoch: 13 cost time: 0.40784192085266113
Epoch: 13, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.578 Vali Acc: 0.907 Test Loss: 0.578 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 14 cost time: 0.4751889705657959
Epoch: 14, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.508 Vali Acc: 0.911 Test Loss: 0.508 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 15 cost time: 0.38194727897644043
Epoch: 15, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.450 Vali Acc: 0.926 Test Loss: 0.450 Test Acc: 0.926
Validation loss decreased (-0.911106 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.38329505920410156
Epoch: 16, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.403 Vali Acc: 0.930 Test Loss: 0.403 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929626).  Saving model ...
Epoch: 17 cost time: 0.4112532138824463
Epoch: 17, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.366 Vali Acc: 0.937 Test Loss: 0.366 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.42974257469177246
Epoch: 18, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.337 Vali Acc: 0.937 Test Loss: 0.337 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 19 cost time: 0.41303396224975586
Epoch: 19, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.4072282314300537
Epoch: 20, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.43486475944519043
Epoch: 21, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.39723968505859375
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.37406063079833984
Epoch: 23, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.4301011562347412
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.36466550827026367
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.47200679779052734
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.3658866882324219
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.3758857250213623
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.4031550884246826
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.4048497676849365
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.4430732727050781
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.44016170501708984
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4055938720703125
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.40254998207092285
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4073827266693115
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.40307116508483887
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.3956472873687744
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.4438025951385498
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.48745036125183105
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.45818209648132324
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 197190
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7077853679656982
Epoch: 1, Steps: 2 | Train Loss: 2.020 Vali Loss: 1.836 Vali Acc: 0.056 Test Loss: 1.836 Test Acc: 0.056
Validation loss decreased (inf --> -0.055537).  Saving model ...
Epoch: 2 cost time: 0.35187864303588867
Epoch: 2, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.796 Vali Acc: 0.119 Test Loss: 1.796 Test Acc: 0.119
Validation loss decreased (-0.055537 --> -0.118501).  Saving model ...
Epoch: 3 cost time: 0.37897396087646484
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.756 Vali Acc: 0.163 Test Loss: 1.756 Test Acc: 0.163
Validation loss decreased (-0.118501 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.4669957160949707
Epoch: 4, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.701 Vali Acc: 0.256 Test Loss: 1.701 Test Acc: 0.256
Validation loss decreased (-0.162945 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 0.34310317039489746
Epoch: 5, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.628 Vali Acc: 0.315 Test Loss: 1.628 Test Acc: 0.315
Validation loss decreased (-0.255539 --> -0.314799).  Saving model ...
Epoch: 6 cost time: 0.3449900150299072
Epoch: 6, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.540 Vali Acc: 0.415 Test Loss: 1.540 Test Acc: 0.415
Validation loss decreased (-0.314799 --> -0.414799).  Saving model ...
Epoch: 7 cost time: 0.3715500831604004
Epoch: 7, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.442 Vali Acc: 0.556 Test Loss: 1.442 Test Acc: 0.556
Validation loss decreased (-0.414799 --> -0.555541).  Saving model ...
Epoch: 8 cost time: 0.44257020950317383
Epoch: 8, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.337 Vali Acc: 0.648 Test Loss: 1.337 Test Acc: 0.648
Validation loss decreased (-0.555541 --> -0.648135).  Saving model ...
Epoch: 9 cost time: 0.4256591796875
Epoch: 9, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.229 Vali Acc: 0.711 Test Loss: 1.229 Test Acc: 0.711
Validation loss decreased (-0.648135 --> -0.711099).  Saving model ...
Epoch: 10 cost time: 0.41849327087402344
Epoch: 10, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.118 Vali Acc: 0.785 Test Loss: 1.118 Test Acc: 0.785
Validation loss decreased (-0.711099 --> -0.785174).  Saving model ...
Epoch: 11 cost time: 0.4153451919555664
Epoch: 11, Steps: 2 | Train Loss: 0.799 Vali Loss: 1.011 Vali Acc: 0.830 Test Loss: 1.011 Test Acc: 0.830
Validation loss decreased (-0.785174 --> -0.829620).  Saving model ...
Epoch: 12 cost time: 0.5358066558837891
Epoch: 12, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.909 Vali Acc: 0.852 Test Loss: 0.909 Test Acc: 0.852
Validation loss decreased (-0.829620 --> -0.851843).  Saving model ...
Epoch: 13 cost time: 0.3781454563140869
Epoch: 13, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.814 Vali Acc: 0.874 Test Loss: 0.814 Test Acc: 0.874
Validation loss decreased (-0.851843 --> -0.874066).  Saving model ...
Epoch: 14 cost time: 0.40706682205200195
Epoch: 14, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.730 Vali Acc: 0.889 Test Loss: 0.730 Test Acc: 0.889
Validation loss decreased (-0.874066 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 0.3784036636352539
Epoch: 15, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.654 Vali Acc: 0.893 Test Loss: 0.654 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.4236135482788086
Epoch: 16, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.586 Vali Acc: 0.896 Test Loss: 0.586 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 17 cost time: 0.38532257080078125
Epoch: 17, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.525 Vali Acc: 0.900 Test Loss: 0.525 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.36778807640075684
Epoch: 18, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.473 Vali Acc: 0.911 Test Loss: 0.473 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 19 cost time: 0.3468451499938965
Epoch: 19, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 0.40347766876220703
Epoch: 20, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.393 Vali Acc: 0.930 Test Loss: 0.393 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 0.49568843841552734
Epoch: 21, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 22 cost time: 0.4755065441131592
Epoch: 22, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 0.37619543075561523
Epoch: 23, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.415804386138916
Epoch: 24, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.38344740867614746
Epoch: 25, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 0.4329509735107422
Epoch: 26, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.37761855125427246
Epoch: 27, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3600490093231201
Epoch: 28, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.37030458450317383
Epoch: 29, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.3763296604156494
Epoch: 30, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.3708364963531494
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.40255188941955566
Epoch: 32, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.383098840713501
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.39267945289611816
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.42625904083251953
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.42197203636169434
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.40457653999328613
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.4295828342437744
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.4726698398590088
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4608609676361084
Epoch: 40, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.3907942771911621
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.3905043601989746
Epoch: 42, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.39134883880615234
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4308328628540039
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4327511787414551
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.4804825782775879
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4514956474304199
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.39798641204833984
Epoch: 48, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 180358
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7428770065307617
Epoch: 1, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.730 Vali Acc: 0.304 Test Loss: 1.730 Test Acc: 0.304
Validation loss decreased (inf --> -0.303686).  Saving model ...
Epoch: 2 cost time: 0.40646839141845703
Epoch: 2, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.698 Vali Acc: 0.367 Test Loss: 1.698 Test Acc: 0.367
Validation loss decreased (-0.303686 --> -0.366650).  Saving model ...
Epoch: 3 cost time: 0.41852521896362305
Epoch: 3, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.665 Vali Acc: 0.415 Test Loss: 1.665 Test Acc: 0.415
Validation loss decreased (-0.366650 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.37708568572998047
Epoch: 4, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.622 Vali Acc: 0.448 Test Loss: 1.622 Test Acc: 0.448
Validation loss decreased (-0.414798 --> -0.448132).  Saving model ...
Epoch: 5 cost time: 0.3488631248474121
Epoch: 5, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.566 Vali Acc: 0.481 Test Loss: 1.566 Test Acc: 0.481
Validation loss decreased (-0.448132 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 0.42859768867492676
Epoch: 6, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.498 Vali Acc: 0.530 Test Loss: 1.498 Test Acc: 0.530
Validation loss decreased (-0.481466 --> -0.529615).  Saving model ...
Epoch: 7 cost time: 0.3929786682128906
Epoch: 7, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.421 Vali Acc: 0.596 Test Loss: 1.421 Test Acc: 0.596
Validation loss decreased (-0.529615 --> -0.596282).  Saving model ...
Epoch: 8 cost time: 0.3645603656768799
Epoch: 8, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.335 Vali Acc: 0.733 Test Loss: 1.335 Test Acc: 0.733
Validation loss decreased (-0.596282 --> -0.733320).  Saving model ...
Epoch: 9 cost time: 0.39216017723083496
Epoch: 9, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.243 Vali Acc: 0.774 Test Loss: 1.243 Test Acc: 0.774
Validation loss decreased (-0.733320 --> -0.774062).  Saving model ...
Epoch: 10 cost time: 0.3521559238433838
Epoch: 10, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.149 Vali Acc: 0.815 Test Loss: 1.149 Test Acc: 0.815
Validation loss decreased (-0.774062 --> -0.814803).  Saving model ...
Epoch: 11 cost time: 0.4340403079986572
Epoch: 11, Steps: 2 | Train Loss: 0.853 Vali Loss: 1.056 Vali Acc: 0.837 Test Loss: 1.056 Test Acc: 0.837
Validation loss decreased (-0.814803 --> -0.837026).  Saving model ...
Epoch: 12 cost time: 0.3718242645263672
Epoch: 12, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.964 Vali Acc: 0.863 Test Loss: 0.964 Test Acc: 0.863
Validation loss decreased (-0.837026 --> -0.862953).  Saving model ...
Epoch: 13 cost time: 0.3829934597015381
Epoch: 13, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.876 Vali Acc: 0.904 Test Loss: 0.876 Test Acc: 0.904
Validation loss decreased (-0.862953 --> -0.903695).  Saving model ...
Epoch: 14 cost time: 0.40430665016174316
Epoch: 14, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.796 Vali Acc: 0.907 Test Loss: 0.796 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 15 cost time: 0.38729262351989746
Epoch: 15, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.721 Vali Acc: 0.926 Test Loss: 0.721 Test Acc: 0.926
Validation loss decreased (-0.907399 --> -0.925919).  Saving model ...
Epoch: 16 cost time: 0.4033193588256836
Epoch: 16, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.653 Vali Acc: 0.937 Test Loss: 0.653 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937031).  Saving model ...
Epoch: 17 cost time: 0.37302708625793457
Epoch: 17, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.592 Vali Acc: 0.941 Test Loss: 0.592 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 18 cost time: 0.38043689727783203
Epoch: 18, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.539 Vali Acc: 0.944 Test Loss: 0.539 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 19 cost time: 0.37529635429382324
Epoch: 19, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.492 Vali Acc: 0.948 Test Loss: 0.492 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 20 cost time: 0.3712484836578369
Epoch: 20, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.451 Vali Acc: 0.952 Test Loss: 0.451 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 21 cost time: 0.3642416000366211
Epoch: 21, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.417 Vali Acc: 0.956 Test Loss: 0.417 Test Acc: 0.956
Validation loss decreased (-0.951847 --> -0.955551).  Saving model ...
Epoch: 22 cost time: 0.38479161262512207
Epoch: 22, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.388 Vali Acc: 0.959 Test Loss: 0.388 Test Acc: 0.959
Validation loss decreased (-0.955551 --> -0.959255).  Saving model ...
Epoch: 23 cost time: 0.347184419631958
Epoch: 23, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.364 Vali Acc: 0.963 Test Loss: 0.364 Test Acc: 0.963
Validation loss decreased (-0.959255 --> -0.962959).  Saving model ...
Epoch: 24 cost time: 0.3718996047973633
Epoch: 24, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.343 Vali Acc: 0.959 Test Loss: 0.343 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.388369083404541
Epoch: 25, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.327 Vali Acc: 0.959 Test Loss: 0.327 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.35292601585388184
Epoch: 26, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.312 Vali Acc: 0.956 Test Loss: 0.312 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.37390565872192383
Epoch: 27, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.3918142318725586
Epoch: 28, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.289 Vali Acc: 0.952 Test Loss: 0.289 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4243316650390625
Epoch: 29, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.42183637619018555
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.271 Vali Acc: 0.959 Test Loss: 0.271 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.3653426170349121
Epoch: 31, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.265 Vali Acc: 0.959 Test Loss: 0.265 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.40611720085144043
Epoch: 32, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.258 Vali Acc: 0.959 Test Loss: 0.258 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.3851184844970703
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.253 Vali Acc: 0.959 Test Loss: 0.253 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 172806
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.691608190536499
Epoch: 1, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.684 Vali Acc: 0.300 Test Loss: 1.684 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.40993642807006836
Epoch: 2, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.655 Vali Acc: 0.319 Test Loss: 1.655 Test Acc: 0.319
Validation loss decreased (-0.299983 --> -0.318502).  Saving model ...
Epoch: 3 cost time: 0.3794393539428711
Epoch: 3, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.627 Vali Acc: 0.348 Test Loss: 1.627 Test Acc: 0.348
Validation loss decreased (-0.318502 --> -0.348132).  Saving model ...
Epoch: 4 cost time: 0.39985203742980957
Epoch: 4, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.592 Vali Acc: 0.389 Test Loss: 1.592 Test Acc: 0.389
Validation loss decreased (-0.348132 --> -0.388873).  Saving model ...
Epoch: 5 cost time: 0.38189244270324707
Epoch: 5, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.545 Vali Acc: 0.448 Test Loss: 1.545 Test Acc: 0.448
Validation loss decreased (-0.388873 --> -0.448133).  Saving model ...
Epoch: 6 cost time: 0.3988649845123291
Epoch: 6, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
Validation loss decreased (-0.448133 --> -0.518504).  Saving model ...
Epoch: 7 cost time: 0.3635678291320801
Epoch: 7, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.422 Vali Acc: 0.581 Test Loss: 1.422 Test Acc: 0.581
Validation loss decreased (-0.518504 --> -0.581467).  Saving model ...
Epoch: 8 cost time: 0.47130250930786133
Epoch: 8, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.351 Vali Acc: 0.667 Test Loss: 1.351 Test Acc: 0.667
Validation loss decreased (-0.581467 --> -0.666653).  Saving model ...
Epoch: 9 cost time: 0.3527810573577881
Epoch: 9, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.274 Vali Acc: 0.726 Test Loss: 1.274 Test Acc: 0.726
Validation loss decreased (-0.666653 --> -0.725913).  Saving model ...
Epoch: 10 cost time: 0.4235522747039795
Epoch: 10, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.194 Vali Acc: 0.770 Test Loss: 1.194 Test Acc: 0.770
Validation loss decreased (-0.725913 --> -0.770358).  Saving model ...
Epoch: 11 cost time: 0.3809671401977539
Epoch: 11, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.113 Vali Acc: 0.811 Test Loss: 1.113 Test Acc: 0.811
Validation loss decreased (-0.770358 --> -0.811100).  Saving model ...
Epoch: 12 cost time: 0.4184579849243164
Epoch: 12, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.032 Vali Acc: 0.837 Test Loss: 1.032 Test Acc: 0.837
Validation loss decreased (-0.811100 --> -0.837027).  Saving model ...
Epoch: 13 cost time: 0.3690073490142822
Epoch: 13, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.954 Vali Acc: 0.848 Test Loss: 0.954 Test Acc: 0.848
Validation loss decreased (-0.837027 --> -0.848139).  Saving model ...
Epoch: 14 cost time: 0.4189732074737549
Epoch: 14, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.880 Vali Acc: 0.874 Test Loss: 0.880 Test Acc: 0.874
Validation loss decreased (-0.848139 --> -0.874065).  Saving model ...
Epoch: 15 cost time: 0.4174997806549072
Epoch: 15, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.811 Vali Acc: 0.881 Test Loss: 0.811 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 16 cost time: 0.3759281635284424
Epoch: 16, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.747 Vali Acc: 0.889 Test Loss: 0.747 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 17 cost time: 0.4040966033935547
Epoch: 17, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.686 Vali Acc: 0.904 Test Loss: 0.686 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903697).  Saving model ...
Epoch: 18 cost time: 0.39483213424682617
Epoch: 18, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.630 Vali Acc: 0.915 Test Loss: 0.630 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914809).  Saving model ...
Epoch: 19 cost time: 0.42052435874938965
Epoch: 19, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.579 Vali Acc: 0.919 Test Loss: 0.579 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 20 cost time: 0.3994317054748535
Epoch: 20, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.534 Vali Acc: 0.926 Test Loss: 0.534 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 21 cost time: 0.37270045280456543
Epoch: 21, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.495 Vali Acc: 0.930 Test Loss: 0.495 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 22 cost time: 0.37676405906677246
Epoch: 22, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.461 Vali Acc: 0.930 Test Loss: 0.461 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 23 cost time: 0.43724942207336426
Epoch: 23, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.431 Vali Acc: 0.933 Test Loss: 0.431 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 24 cost time: 0.36443114280700684
Epoch: 24, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.406 Vali Acc: 0.933 Test Loss: 0.406 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 25 cost time: 0.3552529811859131
Epoch: 25, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.383 Vali Acc: 0.933 Test Loss: 0.383 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 0.3910393714904785
Epoch: 26, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937033).  Saving model ...
Epoch: 27 cost time: 0.42394137382507324
Epoch: 27, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.347 Vali Acc: 0.937 Test Loss: 0.347 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.4467458724975586
Epoch: 28, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.334 Vali Acc: 0.937 Test Loss: 0.334 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 29 cost time: 0.3862185478210449
Epoch: 29, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.40584754943847656
Epoch: 30, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.310 Vali Acc: 0.948 Test Loss: 0.310 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 31 cost time: 0.3883950710296631
Epoch: 31, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.3742713928222656
Epoch: 32, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.292 Vali Acc: 0.952 Test Loss: 0.292 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.37442636489868164
Epoch: 33, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.285 Vali Acc: 0.952 Test Loss: 0.285 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.3711702823638916
Epoch: 34, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.401883602142334
Epoch: 35, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.40479493141174316
Epoch: 36, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.268 Vali Acc: 0.952 Test Loss: 0.268 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.36247730255126953
Epoch: 37, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.37137269973754883
Epoch: 38, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.259 Vali Acc: 0.952 Test Loss: 0.259 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.3753645420074463
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.255 Vali Acc: 0.952 Test Loss: 0.255 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.402177095413208
Epoch: 40, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.3624546527862549
Epoch: 41, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.248 Vali Acc: 0.956 Test Loss: 0.248 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.5018119812011719
Epoch: 42, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.245 Vali Acc: 0.956 Test Loss: 0.245 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.4196767807006836
Epoch: 43, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.242 Vali Acc: 0.956 Test Loss: 0.242 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.39787983894348145
Epoch: 44, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.37569594383239746
Epoch: 45, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.3790316581726074
Epoch: 46, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.36954832077026367
Epoch: 47, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.35622644424438477
Epoch: 48, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.34348225593566895
Epoch: 49, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.956 Test Loss: 0.230 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.3893165588378906
Epoch: 50, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 168390
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.703707218170166
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.794 Vali Acc: 0.144 Test Loss: 1.794 Test Acc: 0.144
Validation loss decreased (inf --> -0.144427).  Saving model ...
Epoch: 2 cost time: 0.34047627449035645
Epoch: 2, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.771 Vali Acc: 0.181 Test Loss: 1.771 Test Acc: 0.181
Validation loss decreased (-0.144427 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.3512611389160156
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.750 Vali Acc: 0.207 Test Loss: 1.750 Test Acc: 0.207
Validation loss decreased (-0.181464 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.3666677474975586
Epoch: 4, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.727 Vali Acc: 0.244 Test Loss: 1.727 Test Acc: 0.244
Validation loss decreased (-0.207390 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 0.39261698722839355
Epoch: 5, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.695 Vali Acc: 0.304 Test Loss: 1.695 Test Acc: 0.304
Validation loss decreased (-0.244427 --> -0.303687).  Saving model ...
Epoch: 6 cost time: 0.3454012870788574
Epoch: 6, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.656 Vali Acc: 0.381 Test Loss: 1.656 Test Acc: 0.381
Validation loss decreased (-0.303687 --> -0.381465).  Saving model ...
Epoch: 7 cost time: 0.4235987663269043
Epoch: 7, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.609 Vali Acc: 0.493 Test Loss: 1.609 Test Acc: 0.493
Validation loss decreased (-0.381465 --> -0.492577).  Saving model ...
Epoch: 8 cost time: 0.4086883068084717
Epoch: 8, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.555 Vali Acc: 0.563 Test Loss: 1.555 Test Acc: 0.563
Validation loss decreased (-0.492577 --> -0.562947).  Saving model ...
Epoch: 9 cost time: 0.4206881523132324
Epoch: 9, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.497 Vali Acc: 0.611 Test Loss: 1.497 Test Acc: 0.611
Validation loss decreased (-0.562947 --> -0.611096).  Saving model ...
Epoch: 10 cost time: 0.37194275856018066
Epoch: 10, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.434 Vali Acc: 0.644 Test Loss: 1.434 Test Acc: 0.644
Validation loss decreased (-0.611096 --> -0.644430).  Saving model ...
Epoch: 11 cost time: 0.46324706077575684
Epoch: 11, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.367 Vali Acc: 0.681 Test Loss: 1.367 Test Acc: 0.681
Validation loss decreased (-0.644430 --> -0.681468).  Saving model ...
Epoch: 12 cost time: 0.3881533145904541
Epoch: 12, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.299 Vali Acc: 0.719 Test Loss: 1.299 Test Acc: 0.719
Validation loss decreased (-0.681468 --> -0.718506).  Saving model ...
Epoch: 13 cost time: 0.6110754013061523
Epoch: 13, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.228 Vali Acc: 0.737 Test Loss: 1.228 Test Acc: 0.737
Validation loss decreased (-0.718506 --> -0.737025).  Saving model ...
Epoch: 14 cost time: 0.3982386589050293
Epoch: 14, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.157 Vali Acc: 0.763 Test Loss: 1.157 Test Acc: 0.763
Validation loss decreased (-0.737025 --> -0.762951).  Saving model ...
Epoch: 15 cost time: 0.36294054985046387
Epoch: 15, Steps: 2 | Train Loss: 0.868 Vali Loss: 1.088 Vali Acc: 0.774 Test Loss: 1.088 Test Acc: 0.774
Validation loss decreased (-0.762951 --> -0.774063).  Saving model ...
Epoch: 16 cost time: 0.3783299922943115
Epoch: 16, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.020 Vali Acc: 0.807 Test Loss: 1.020 Test Acc: 0.807
Validation loss decreased (-0.774063 --> -0.807397).  Saving model ...
Epoch: 17 cost time: 0.3667314052581787
Epoch: 17, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.955 Vali Acc: 0.837 Test Loss: 0.955 Test Acc: 0.837
Validation loss decreased (-0.807397 --> -0.837027).  Saving model ...
Epoch: 18 cost time: 0.38019299507141113
Epoch: 18, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.894 Vali Acc: 0.841 Test Loss: 0.894 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840732).  Saving model ...
Epoch: 19 cost time: 0.39442873001098633
Epoch: 19, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.837 Vali Acc: 0.844 Test Loss: 0.837 Test Acc: 0.844
Validation loss decreased (-0.840732 --> -0.844436).  Saving model ...
Epoch: 20 cost time: 0.39011359214782715
Epoch: 20, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.784 Vali Acc: 0.852 Test Loss: 0.784 Test Acc: 0.852
Validation loss decreased (-0.844436 --> -0.851844).  Saving model ...
Epoch: 21 cost time: 0.427532434463501
Epoch: 21, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.735 Vali Acc: 0.859 Test Loss: 0.735 Test Acc: 0.859
Validation loss decreased (-0.851844 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.3803999423980713
Epoch: 22, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.690 Vali Acc: 0.870 Test Loss: 0.690 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870363).  Saving model ...
Epoch: 23 cost time: 0.39034557342529297
Epoch: 23, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.647 Vali Acc: 0.878 Test Loss: 0.647 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 0.4069063663482666
Epoch: 24, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.610 Vali Acc: 0.881 Test Loss: 0.610 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 25 cost time: 0.37139081954956055
Epoch: 25, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.576 Vali Acc: 0.893 Test Loss: 0.576 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892587).  Saving model ...
Epoch: 26 cost time: 0.4214901924133301
Epoch: 26, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.37941527366638184
Epoch: 27, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.518 Vali Acc: 0.904 Test Loss: 0.518 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 28 cost time: 0.4195849895477295
Epoch: 28, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914810).  Saving model ...
Epoch: 29 cost time: 0.3960609436035156
Epoch: 29, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.471 Vali Acc: 0.926 Test Loss: 0.471 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925921).  Saving model ...
Epoch: 30 cost time: 0.34682297706604004
Epoch: 30, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.451 Vali Acc: 0.930 Test Loss: 0.451 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 31 cost time: 0.3649299144744873
Epoch: 31, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.435 Vali Acc: 0.933 Test Loss: 0.435 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.3883671760559082
Epoch: 32, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.420 Vali Acc: 0.933 Test Loss: 0.420 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 33 cost time: 0.4280729293823242
Epoch: 33, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.406 Vali Acc: 0.937 Test Loss: 0.406 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 34 cost time: 0.44020986557006836
Epoch: 34, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.4177098274230957
Epoch: 35, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.382 Vali Acc: 0.941 Test Loss: 0.382 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.36162757873535156
Epoch: 36, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.372 Vali Acc: 0.941 Test Loss: 0.372 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 37 cost time: 0.39124250411987305
Epoch: 37, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.3592565059661865
Epoch: 38, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.355 Vali Acc: 0.941 Test Loss: 0.355 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 39 cost time: 0.40587592124938965
Epoch: 39, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 40 cost time: 0.38982152938842773
Epoch: 40, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.341 Vali Acc: 0.944 Test Loss: 0.341 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 0.3809010982513428
Epoch: 41, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 42 cost time: 0.35994410514831543
Epoch: 42, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.327 Vali Acc: 0.952 Test Loss: 0.327 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.35527563095092773
Epoch: 43, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.321 Vali Acc: 0.952 Test Loss: 0.321 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.3600740432739258
Epoch: 44, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.316 Vali Acc: 0.952 Test Loss: 0.316 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 45 cost time: 0.3793599605560303
Epoch: 45, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.311 Vali Acc: 0.952 Test Loss: 0.311 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 46 cost time: 0.3619256019592285
Epoch: 46, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.306 Vali Acc: 0.952 Test Loss: 0.306 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 47 cost time: 0.39874696731567383
Epoch: 47, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 48 cost time: 0.4324944019317627
Epoch: 48, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.298 Vali Acc: 0.952 Test Loss: 0.298 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 49 cost time: 0.37197351455688477
Epoch: 49, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.294 Vali Acc: 0.952 Test Loss: 0.294 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 50 cost time: 0.3954811096191406
Epoch: 50, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.291 Vali Acc: 0.956 Test Loss: 0.291 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 162438
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6533832550048828
Epoch: 1, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.766 Vali Acc: 0.341 Test Loss: 1.766 Test Acc: 0.341
Validation loss decreased (inf --> -0.340723).  Saving model ...
Epoch: 2 cost time: 0.39488649368286133
Epoch: 2, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.745 Vali Acc: 0.407 Test Loss: 1.745 Test Acc: 0.407
Validation loss decreased (-0.340723 --> -0.407390).  Saving model ...
Epoch: 3 cost time: 0.35448741912841797
Epoch: 3, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.728 Vali Acc: 0.437 Test Loss: 1.728 Test Acc: 0.437
Validation loss decreased (-0.407390 --> -0.437020).  Saving model ...
Epoch: 4 cost time: 0.40924644470214844
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.709 Vali Acc: 0.456 Test Loss: 1.709 Test Acc: 0.456
Validation loss decreased (-0.437020 --> -0.455538).  Saving model ...
Epoch: 5 cost time: 0.42650699615478516
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.683 Vali Acc: 0.485 Test Loss: 1.683 Test Acc: 0.485
Validation loss decreased (-0.455538 --> -0.485168).  Saving model ...
Epoch: 6 cost time: 0.36702394485473633
Epoch: 6, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.651 Vali Acc: 0.519 Test Loss: 1.651 Test Acc: 0.519
Validation loss decreased (-0.485168 --> -0.518502).  Saving model ...
Epoch: 7 cost time: 0.35097575187683105
Epoch: 7, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.614 Vali Acc: 0.552 Test Loss: 1.614 Test Acc: 0.552
Validation loss decreased (-0.518502 --> -0.551836).  Saving model ...
Epoch: 8 cost time: 0.3940088748931885
Epoch: 8, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.571 Vali Acc: 0.563 Test Loss: 1.571 Test Acc: 0.563
Validation loss decreased (-0.551836 --> -0.562947).  Saving model ...
Epoch: 9 cost time: 0.3733494281768799
Epoch: 9, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.524 Vali Acc: 0.593 Test Loss: 1.524 Test Acc: 0.593
Validation loss decreased (-0.562947 --> -0.592577).  Saving model ...
Epoch: 10 cost time: 0.3606901168823242
Epoch: 10, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.472 Vali Acc: 0.619 Test Loss: 1.472 Test Acc: 0.619
Validation loss decreased (-0.592577 --> -0.618504).  Saving model ...
Epoch: 11 cost time: 0.3475053310394287
Epoch: 11, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.417 Vali Acc: 0.641 Test Loss: 1.417 Test Acc: 0.641
Validation loss decreased (-0.618504 --> -0.640727).  Saving model ...
Epoch: 12 cost time: 0.3624589443206787
Epoch: 12, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.360 Vali Acc: 0.667 Test Loss: 1.360 Test Acc: 0.667
Validation loss decreased (-0.640727 --> -0.666653).  Saving model ...
Epoch: 13 cost time: 0.37859320640563965
Epoch: 13, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.301 Vali Acc: 0.696 Test Loss: 1.301 Test Acc: 0.696
Validation loss decreased (-0.666653 --> -0.696283).  Saving model ...
Epoch: 14 cost time: 0.3712320327758789
Epoch: 14, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.241 Vali Acc: 0.715 Test Loss: 1.241 Test Acc: 0.715
Validation loss decreased (-0.696283 --> -0.714802).  Saving model ...
Epoch: 15 cost time: 0.3688669204711914
Epoch: 15, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.180 Vali Acc: 0.752 Test Loss: 1.180 Test Acc: 0.752
Validation loss decreased (-0.714802 --> -0.751840).  Saving model ...
Epoch: 16 cost time: 0.3749721050262451
Epoch: 16, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.120 Vali Acc: 0.778 Test Loss: 1.120 Test Acc: 0.778
Validation loss decreased (-0.751840 --> -0.777767).  Saving model ...
Epoch: 17 cost time: 0.4092555046081543
Epoch: 17, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.062 Vali Acc: 0.811 Test Loss: 1.062 Test Acc: 0.811
Validation loss decreased (-0.777767 --> -0.811100).  Saving model ...
Epoch: 18 cost time: 0.3686699867248535
Epoch: 18, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.006 Vali Acc: 0.830 Test Loss: 1.006 Test Acc: 0.830
Validation loss decreased (-0.811100 --> -0.829620).  Saving model ...
Epoch: 19 cost time: 0.4369065761566162
Epoch: 19, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.951 Vali Acc: 0.844 Test Loss: 0.951 Test Acc: 0.844
Validation loss decreased (-0.829620 --> -0.844435).  Saving model ...
Epoch: 20 cost time: 0.3484306335449219
Epoch: 20, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.898 Vali Acc: 0.867 Test Loss: 0.898 Test Acc: 0.867
Validation loss decreased (-0.844435 --> -0.866658).  Saving model ...
Epoch: 21 cost time: 0.3583862781524658
Epoch: 21, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.849 Vali Acc: 0.878 Test Loss: 0.849 Test Acc: 0.878
Validation loss decreased (-0.866658 --> -0.877769).  Saving model ...
Epoch: 22 cost time: 0.39458370208740234
Epoch: 22, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.801 Vali Acc: 0.881 Test Loss: 0.801 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881473).  Saving model ...
Epoch: 23 cost time: 0.4031956195831299
Epoch: 23, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.756 Vali Acc: 0.881 Test Loss: 0.756 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881474).  Saving model ...
Epoch: 24 cost time: 0.34317946434020996
Epoch: 24, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.715 Vali Acc: 0.907 Test Loss: 0.715 Test Acc: 0.907
Validation loss decreased (-0.881474 --> -0.907400).  Saving model ...
Epoch: 25 cost time: 0.38491177558898926
Epoch: 25, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.677 Vali Acc: 0.919 Test Loss: 0.677 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 26 cost time: 0.3385953903198242
Epoch: 26, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.642 Vali Acc: 0.922 Test Loss: 0.642 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 27 cost time: 0.35680198669433594
Epoch: 27, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.609 Vali Acc: 0.922 Test Loss: 0.609 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 28 cost time: 0.34519219398498535
Epoch: 28, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.580 Vali Acc: 0.922 Test Loss: 0.580 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 29 cost time: 0.3739175796508789
Epoch: 29, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.553 Vali Acc: 0.922 Test Loss: 0.553 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 30 cost time: 0.41442441940307617
Epoch: 30, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.529 Vali Acc: 0.922 Test Loss: 0.529 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 31 cost time: 0.3843386173248291
Epoch: 31, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.507 Vali Acc: 0.922 Test Loss: 0.507 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 32 cost time: 0.406264066696167
Epoch: 32, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.487 Vali Acc: 0.926 Test Loss: 0.487 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 33 cost time: 0.40193772315979004
Epoch: 33, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.468 Vali Acc: 0.933 Test Loss: 0.468 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.38867735862731934
Epoch: 34, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.452 Vali Acc: 0.933 Test Loss: 0.452 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.34864377975463867
Epoch: 35, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.437 Vali Acc: 0.933 Test Loss: 0.437 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 36 cost time: 0.34647607803344727
Epoch: 36, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.424 Vali Acc: 0.933 Test Loss: 0.424 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 0.3860187530517578
Epoch: 37, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.411 Vali Acc: 0.933 Test Loss: 0.411 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.3379547595977783
Epoch: 38, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.400 Vali Acc: 0.933 Test Loss: 0.400 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.3656904697418213
Epoch: 39, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.390 Vali Acc: 0.933 Test Loss: 0.390 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.3441808223724365
Epoch: 40, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.380 Vali Acc: 0.933 Test Loss: 0.380 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 41 cost time: 0.3630228042602539
Epoch: 41, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.371 Vali Acc: 0.933 Test Loss: 0.371 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 42 cost time: 0.34491777420043945
Epoch: 42, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 43 cost time: 0.39777255058288574
Epoch: 43, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 44 cost time: 0.4312140941619873
Epoch: 44, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.349 Vali Acc: 0.937 Test Loss: 0.349 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 45 cost time: 0.32114577293395996
Epoch: 45, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.342 Vali Acc: 0.941 Test Loss: 0.342 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 46 cost time: 0.3824501037597656
Epoch: 46, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 47 cost time: 0.3602738380432129
Epoch: 47, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.331 Vali Acc: 0.948 Test Loss: 0.331 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.36815428733825684
Epoch: 48, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.325 Vali Acc: 0.952 Test Loss: 0.325 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 49 cost time: 0.3795182704925537
Epoch: 49, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.320 Vali Acc: 0.952 Test Loss: 0.320 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 50 cost time: 0.4051513671875
Epoch: 50, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.315 Vali Acc: 0.952 Test Loss: 0.315 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 159622
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6042912006378174
Epoch: 1, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.825 Vali Acc: 0.156 Test Loss: 1.825 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.43333983421325684
Epoch: 2, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.777 Vali Acc: 0.170 Test Loss: 1.777 Test Acc: 0.170
Validation loss decreased (-0.155537 --> -0.170353).  Saving model ...
Epoch: 3 cost time: 0.33535003662109375
Epoch: 3, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.722 Vali Acc: 0.315 Test Loss: 1.722 Test Acc: 0.315
Validation loss decreased (-0.170353 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.35135364532470703
Epoch: 4, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.640 Vali Acc: 0.448 Test Loss: 1.640 Test Acc: 0.448
Validation loss decreased (-0.314798 --> -0.448132).  Saving model ...
Epoch: 5 cost time: 0.36183905601501465
Epoch: 5, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.534 Vali Acc: 0.574 Test Loss: 1.534 Test Acc: 0.574
Validation loss decreased (-0.448132 --> -0.574059).  Saving model ...
Epoch: 6 cost time: 0.3417813777923584
Epoch: 6, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.409 Vali Acc: 0.756 Test Loss: 1.409 Test Acc: 0.756
Validation loss decreased (-0.574059 --> -0.755541).  Saving model ...
Epoch: 7 cost time: 0.3527488708496094
Epoch: 7, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.275 Vali Acc: 0.830 Test Loss: 1.275 Test Acc: 0.830
Validation loss decreased (-0.755541 --> -0.829617).  Saving model ...
Epoch: 8 cost time: 0.34853148460388184
Epoch: 8, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.135 Vali Acc: 0.874 Test Loss: 1.135 Test Acc: 0.874
Validation loss decreased (-0.829617 --> -0.874063).  Saving model ...
Epoch: 9 cost time: 0.3560771942138672
Epoch: 9, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.997 Vali Acc: 0.915 Test Loss: 0.997 Test Acc: 0.915
Validation loss decreased (-0.874063 --> -0.914805).  Saving model ...
Epoch: 10 cost time: 0.3372206687927246
Epoch: 10, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.866 Vali Acc: 0.915 Test Loss: 0.866 Test Acc: 0.915
Validation loss decreased (-0.914805 --> -0.914806).  Saving model ...
Epoch: 11 cost time: 0.4260225296020508
Epoch: 11, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.749 Vali Acc: 0.919 Test Loss: 0.749 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918511).  Saving model ...
Epoch: 12 cost time: 0.3614635467529297
Epoch: 12, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.645 Vali Acc: 0.926 Test Loss: 0.645 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 13 cost time: 0.42604899406433105
Epoch: 13, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.554 Vali Acc: 0.941 Test Loss: 0.554 Test Acc: 0.941
Validation loss decreased (-0.925919 --> -0.940735).  Saving model ...
Epoch: 14 cost time: 0.37157320976257324
Epoch: 14, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.478 Vali Acc: 0.948 Test Loss: 0.478 Test Acc: 0.948
Validation loss decreased (-0.940735 --> -0.948143).  Saving model ...
Epoch: 15 cost time: 0.4067683219909668
Epoch: 15, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.415 Vali Acc: 0.948 Test Loss: 0.415 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 16 cost time: 0.49378156661987305
Epoch: 16, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.363 Vali Acc: 0.944 Test Loss: 0.363 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.37977123260498047
Epoch: 17, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.35797119140625
Epoch: 18, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 19 cost time: 0.40862607955932617
Epoch: 19, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.262 Vali Acc: 0.948 Test Loss: 0.262 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.3888282775878906
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.4010317325592041
Epoch: 21, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.38469481468200684
Epoch: 22, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.3466987609863281
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.3614680767059326
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.37194228172302246
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.34293389320373535
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.346588134765625
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.34926629066467285
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.36292505264282227
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.34303975105285645
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.36420702934265137
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4118473529815674
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.37261128425598145
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.40263891220092773
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.3879837989807129
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.39660096168518066
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.406085729598999
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.4075956344604492
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.37482476234436035
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.39337730407714844
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.41723155975341797
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.3643968105316162
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.37271928787231445
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.40677928924560547
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.3739662170410156
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.3596186637878418
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.3888726234436035
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.36098694801330566
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.4283163547515869
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.4159736633300781
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 91110
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.676802635192871
Epoch: 1, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.787 Vali Acc: 0.181 Test Loss: 1.787 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.4366273880004883
Epoch: 2, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.741 Vali Acc: 0.233 Test Loss: 1.741 Test Acc: 0.233
Validation loss decreased (-0.181464 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 0.39568471908569336
Epoch: 3, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.699 Vali Acc: 0.356 Test Loss: 1.699 Test Acc: 0.356
Validation loss decreased (-0.233316 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 0.35448169708251953
Epoch: 4, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.650 Vali Acc: 0.419 Test Loss: 1.650 Test Acc: 0.419
Validation loss decreased (-0.355539 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.3967273235321045
Epoch: 5, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.588 Vali Acc: 0.481 Test Loss: 1.588 Test Acc: 0.481
Validation loss decreased (-0.418502 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 0.39777565002441406
Epoch: 6, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.516 Vali Acc: 0.559 Test Loss: 1.516 Test Acc: 0.559
Validation loss decreased (-0.481466 --> -0.559244).  Saving model ...
Epoch: 7 cost time: 0.39743733406066895
Epoch: 7, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.436 Vali Acc: 0.589 Test Loss: 1.436 Test Acc: 0.589
Validation loss decreased (-0.559244 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 0.36321020126342773
Epoch: 8, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.351 Vali Acc: 0.663 Test Loss: 1.351 Test Acc: 0.663
Validation loss decreased (-0.588875 --> -0.662949).  Saving model ...
Epoch: 9 cost time: 0.35785651206970215
Epoch: 9, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.261 Vali Acc: 0.719 Test Loss: 1.261 Test Acc: 0.719
Validation loss decreased (-0.662949 --> -0.718506).  Saving model ...
Epoch: 10 cost time: 0.4383411407470703
Epoch: 10, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.170 Vali Acc: 0.770 Test Loss: 1.170 Test Acc: 0.770
Validation loss decreased (-0.718506 --> -0.770359).  Saving model ...
Epoch: 11 cost time: 0.42243194580078125
Epoch: 11, Steps: 2 | Train Loss: 0.846 Vali Loss: 1.080 Vali Acc: 0.815 Test Loss: 1.080 Test Acc: 0.815
Validation loss decreased (-0.770359 --> -0.814804).  Saving model ...
Epoch: 12 cost time: 0.3651885986328125
Epoch: 12, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.991 Vali Acc: 0.830 Test Loss: 0.991 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829620).  Saving model ...
Epoch: 13 cost time: 0.3515317440032959
Epoch: 13, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.907 Vali Acc: 0.859 Test Loss: 0.907 Test Acc: 0.859
Validation loss decreased (-0.829620 --> -0.859250).  Saving model ...
Epoch: 14 cost time: 0.3899996280670166
Epoch: 14, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.828 Vali Acc: 0.881 Test Loss: 0.828 Test Acc: 0.881
Validation loss decreased (-0.859250 --> -0.881473).  Saving model ...
Epoch: 15 cost time: 0.439089298248291
Epoch: 15, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.756 Vali Acc: 0.893 Test Loss: 0.756 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892585).  Saving model ...
Epoch: 16 cost time: 0.44108009338378906
Epoch: 16, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.689 Vali Acc: 0.900 Test Loss: 0.689 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.3691532611846924
Epoch: 17, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.628 Vali Acc: 0.904 Test Loss: 0.628 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 18 cost time: 0.4093942642211914
Epoch: 18, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.574 Vali Acc: 0.911 Test Loss: 0.574 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 19 cost time: 0.3971245288848877
Epoch: 19, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.528 Vali Acc: 0.915 Test Loss: 0.528 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 20 cost time: 0.3762979507446289
Epoch: 20, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.488 Vali Acc: 0.915 Test Loss: 0.488 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 21 cost time: 0.41379284858703613
Epoch: 21, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.454 Vali Acc: 0.922 Test Loss: 0.454 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 22 cost time: 0.41886258125305176
Epoch: 22, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.425 Vali Acc: 0.926 Test Loss: 0.425 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.36005687713623047
Epoch: 23, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.400 Vali Acc: 0.930 Test Loss: 0.400 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 24 cost time: 0.3257296085357666
Epoch: 24, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.378 Vali Acc: 0.930 Test Loss: 0.378 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 25 cost time: 0.319854736328125
Epoch: 25, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 0.33736228942871094
Epoch: 26, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.343 Vali Acc: 0.941 Test Loss: 0.343 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940737).  Saving model ...
Epoch: 27 cost time: 0.39545440673828125
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.329 Vali Acc: 0.944 Test Loss: 0.329 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 28 cost time: 0.31881070137023926
Epoch: 28, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.317 Vali Acc: 0.944 Test Loss: 0.317 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 29 cost time: 0.37268972396850586
Epoch: 29, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.4960646629333496
Epoch: 30, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 31 cost time: 0.4602954387664795
Epoch: 31, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.3759160041809082
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4074525833129883
Epoch: 33, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.3480343818664551
Epoch: 34, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4824693202972412
Epoch: 35, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.46214818954467773
Epoch: 36, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.3446788787841797
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.3651256561279297
Epoch: 38, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.49356842041015625
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.38455796241760254
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.37665820121765137
Epoch: 41, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.43467164039611816
Epoch: 42, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.4047508239746094
Epoch: 43, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.3797299861907959
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.3780956268310547
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.49703383445739746
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.36339855194091797
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.3368711471557617
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.3902599811553955
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.4452850818634033
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 65830
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5365498065948486
Epoch: 1, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.830 Vali Acc: 0.070 Test Loss: 1.830 Test Acc: 0.070
Validation loss decreased (inf --> -0.070352).  Saving model ...
Epoch: 2 cost time: 0.3450140953063965
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.800 Vali Acc: 0.107 Test Loss: 1.800 Test Acc: 0.107
Validation loss decreased (-0.070352 --> -0.107389).  Saving model ...
Epoch: 3 cost time: 0.3314528465270996
Epoch: 3, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.775 Vali Acc: 0.119 Test Loss: 1.775 Test Acc: 0.119
Validation loss decreased (-0.107389 --> -0.118501).  Saving model ...
Epoch: 4 cost time: 0.3408033847808838
Epoch: 4, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.746 Vali Acc: 0.148 Test Loss: 1.746 Test Acc: 0.148
Validation loss decreased (-0.118501 --> -0.148131).  Saving model ...
Epoch: 5 cost time: 0.32837963104248047
Epoch: 5, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.706 Vali Acc: 0.219 Test Loss: 1.706 Test Acc: 0.219
Validation loss decreased (-0.148131 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.3449521064758301
Epoch: 6, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.658 Vali Acc: 0.300 Test Loss: 1.658 Test Acc: 0.300
Validation loss decreased (-0.218501 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 0.3534688949584961
Epoch: 7, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.602 Vali Acc: 0.422 Test Loss: 1.602 Test Acc: 0.422
Validation loss decreased (-0.299983 --> -0.422206).  Saving model ...
Epoch: 8 cost time: 0.3703479766845703
Epoch: 8, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.539 Vali Acc: 0.519 Test Loss: 1.539 Test Acc: 0.519
Validation loss decreased (-0.422206 --> -0.518503).  Saving model ...
Epoch: 9 cost time: 0.4533724784851074
Epoch: 9, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.471 Vali Acc: 0.589 Test Loss: 1.471 Test Acc: 0.589
Validation loss decreased (-0.518503 --> -0.588874).  Saving model ...
Epoch: 10 cost time: 0.39905786514282227
Epoch: 10, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.398 Vali Acc: 0.659 Test Loss: 1.398 Test Acc: 0.659
Validation loss decreased (-0.588874 --> -0.659245).  Saving model ...
Epoch: 11 cost time: 0.3593728542327881
Epoch: 11, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.323 Vali Acc: 0.711 Test Loss: 1.323 Test Acc: 0.711
Validation loss decreased (-0.659245 --> -0.711098).  Saving model ...
Epoch: 12 cost time: 0.3410778045654297
Epoch: 12, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.247 Vali Acc: 0.744 Test Loss: 1.247 Test Acc: 0.744
Validation loss decreased (-0.711098 --> -0.744432).  Saving model ...
Epoch: 13 cost time: 0.3242650032043457
Epoch: 13, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.170 Vali Acc: 0.774 Test Loss: 1.170 Test Acc: 0.774
Validation loss decreased (-0.744432 --> -0.774062).  Saving model ...
Epoch: 14 cost time: 0.3371412754058838
Epoch: 14, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.095 Vali Acc: 0.796 Test Loss: 1.095 Test Acc: 0.796
Validation loss decreased (-0.774062 --> -0.796285).  Saving model ...
Epoch: 15 cost time: 0.3308582305908203
Epoch: 15, Steps: 2 | Train Loss: 0.816 Vali Loss: 1.021 Vali Acc: 0.826 Test Loss: 1.021 Test Acc: 0.826
Validation loss decreased (-0.796285 --> -0.825916).  Saving model ...
Epoch: 16 cost time: 0.3653883934020996
Epoch: 16, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.951 Vali Acc: 0.848 Test Loss: 0.951 Test Acc: 0.848
Validation loss decreased (-0.825916 --> -0.848139).  Saving model ...
Epoch: 17 cost time: 0.42116856575012207
Epoch: 17, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.886 Vali Acc: 0.863 Test Loss: 0.886 Test Acc: 0.863
Validation loss decreased (-0.848139 --> -0.862954).  Saving model ...
Epoch: 18 cost time: 0.3287327289581299
Epoch: 18, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.825 Vali Acc: 0.874 Test Loss: 0.825 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874066).  Saving model ...
Epoch: 19 cost time: 0.3688955307006836
Epoch: 19, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.768 Vali Acc: 0.885 Test Loss: 0.768 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885178).  Saving model ...
Epoch: 20 cost time: 0.35108137130737305
Epoch: 20, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.717 Vali Acc: 0.896 Test Loss: 0.717 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896289).  Saving model ...
Epoch: 21 cost time: 0.38713932037353516
Epoch: 21, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.669 Vali Acc: 0.907 Test Loss: 0.669 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 22 cost time: 0.3796563148498535
Epoch: 22, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.626 Vali Acc: 0.911 Test Loss: 0.626 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.3657417297363281
Epoch: 23, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.586 Vali Acc: 0.915 Test Loss: 0.586 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 24 cost time: 0.3560056686401367
Epoch: 24, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.32895851135253906
Epoch: 25, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.518 Vali Acc: 0.919 Test Loss: 0.518 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 26 cost time: 0.34824180603027344
Epoch: 26, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.489 Vali Acc: 0.926 Test Loss: 0.489 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 27 cost time: 0.352508544921875
Epoch: 27, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.464 Vali Acc: 0.926 Test Loss: 0.464 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 0.3941967487335205
Epoch: 28, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.441 Vali Acc: 0.930 Test Loss: 0.441 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 29 cost time: 0.32119178771972656
Epoch: 29, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.421 Vali Acc: 0.930 Test Loss: 0.421 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 30 cost time: 0.3341357707977295
Epoch: 30, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.403 Vali Acc: 0.930 Test Loss: 0.403 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.32712650299072266
Epoch: 31, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.387 Vali Acc: 0.930 Test Loss: 0.387 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.41406798362731934
Epoch: 32, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 33 cost time: 0.33682870864868164
Epoch: 33, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.374985933303833
Epoch: 34, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.34415245056152344
Epoch: 35, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.3462493419647217
Epoch: 36, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 37 cost time: 0.3361372947692871
Epoch: 37, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.323 Vali Acc: 0.944 Test Loss: 0.323 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.3731040954589844
Epoch: 38, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.316 Vali Acc: 0.944 Test Loss: 0.316 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.3609919548034668
Epoch: 39, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.3367893695831299
Epoch: 40, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.304 Vali Acc: 0.948 Test Loss: 0.304 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 41 cost time: 0.32729315757751465
Epoch: 41, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.298 Vali Acc: 0.948 Test Loss: 0.298 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 42 cost time: 0.3567018508911133
Epoch: 42, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.293 Vali Acc: 0.948 Test Loss: 0.293 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 43 cost time: 0.36483025550842285
Epoch: 43, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 44 cost time: 0.40708255767822266
Epoch: 44, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 45 cost time: 0.33901047706604004
Epoch: 45, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 46 cost time: 0.3846156597137451
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.276 Vali Acc: 0.948 Test Loss: 0.276 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 47 cost time: 0.31507301330566406
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.34226179122924805
Epoch: 48, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.948 Test Loss: 0.270 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 49 cost time: 0.3280646800994873
Epoch: 49, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 50 cost time: 0.36438965797424316
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 57414
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6854221820831299
Epoch: 1, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.729 Vali Acc: 0.296 Test Loss: 1.729 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.3442709445953369
Epoch: 2, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.704 Vali Acc: 0.344 Test Loss: 1.704 Test Acc: 0.344
Validation loss decreased (-0.296279 --> -0.344427).  Saving model ...
Epoch: 3 cost time: 0.36539220809936523
Epoch: 3, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.681 Vali Acc: 0.374 Test Loss: 1.681 Test Acc: 0.374
Validation loss decreased (-0.344427 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.4492318630218506
Epoch: 4, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.657 Vali Acc: 0.419 Test Loss: 1.657 Test Acc: 0.419
Validation loss decreased (-0.374057 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.3684372901916504
Epoch: 5, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.625 Vali Acc: 0.470 Test Loss: 1.625 Test Acc: 0.470
Validation loss decreased (-0.418502 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.3716597557067871
Epoch: 6, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.587 Vali Acc: 0.519 Test Loss: 1.587 Test Acc: 0.519
Validation loss decreased (-0.470354 --> -0.518503).  Saving model ...
Epoch: 7 cost time: 0.347226619720459
Epoch: 7, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.543 Vali Acc: 0.578 Test Loss: 1.543 Test Acc: 0.578
Validation loss decreased (-0.518503 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.3959355354309082
Epoch: 8, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.494 Vali Acc: 0.626 Test Loss: 1.494 Test Acc: 0.626
Validation loss decreased (-0.577762 --> -0.625911).  Saving model ...
Epoch: 9 cost time: 0.41523289680480957
Epoch: 9, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.440 Vali Acc: 0.711 Test Loss: 1.440 Test Acc: 0.711
Validation loss decreased (-0.625911 --> -0.711097).  Saving model ...
Epoch: 10 cost time: 0.35175466537475586
Epoch: 10, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.382 Vali Acc: 0.774 Test Loss: 1.382 Test Acc: 0.774
Validation loss decreased (-0.711097 --> -0.774060).  Saving model ...
Epoch: 11 cost time: 0.32537245750427246
Epoch: 11, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.322 Vali Acc: 0.811 Test Loss: 1.322 Test Acc: 0.811
Validation loss decreased (-0.774060 --> -0.811098).  Saving model ...
Epoch: 12 cost time: 0.3746318817138672
Epoch: 12, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.260 Vali Acc: 0.833 Test Loss: 1.260 Test Acc: 0.833
Validation loss decreased (-0.811098 --> -0.833321).  Saving model ...
Epoch: 13 cost time: 0.3921549320220947
Epoch: 13, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.197 Vali Acc: 0.852 Test Loss: 1.197 Test Acc: 0.852
Validation loss decreased (-0.833321 --> -0.851840).  Saving model ...
Epoch: 14 cost time: 0.4862658977508545
Epoch: 14, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.134 Vali Acc: 0.863 Test Loss: 1.134 Test Acc: 0.863
Validation loss decreased (-0.851840 --> -0.862952).  Saving model ...
Epoch: 15 cost time: 0.388958215713501
Epoch: 15, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.072 Vali Acc: 0.896 Test Loss: 1.072 Test Acc: 0.896
Validation loss decreased (-0.862952 --> -0.896286).  Saving model ...
Epoch: 16 cost time: 0.3555772304534912
Epoch: 16, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.011 Vali Acc: 0.919 Test Loss: 1.011 Test Acc: 0.919
Validation loss decreased (-0.896286 --> -0.918508).  Saving model ...
Epoch: 17 cost time: 0.3607809543609619
Epoch: 17, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.952 Vali Acc: 0.937 Test Loss: 0.952 Test Acc: 0.937
Validation loss decreased (-0.918508 --> -0.937028).  Saving model ...
Epoch: 18 cost time: 0.3706843852996826
Epoch: 18, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.895 Vali Acc: 0.944 Test Loss: 0.895 Test Acc: 0.944
Validation loss decreased (-0.937028 --> -0.944435).  Saving model ...
Epoch: 19 cost time: 0.3511652946472168
Epoch: 19, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.841 Vali Acc: 0.956 Test Loss: 0.841 Test Acc: 0.956
Validation loss decreased (-0.944435 --> -0.955547).  Saving model ...
Epoch: 20 cost time: 0.37276768684387207
Epoch: 20, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.791 Vali Acc: 0.963 Test Loss: 0.791 Test Acc: 0.963
Validation loss decreased (-0.955547 --> -0.962955).  Saving model ...
Epoch: 21 cost time: 0.43985629081726074
Epoch: 21, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.743 Vali Acc: 0.967 Test Loss: 0.743 Test Acc: 0.967
Validation loss decreased (-0.962955 --> -0.966659).  Saving model ...
Epoch: 22 cost time: 0.3723564147949219
Epoch: 22, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.699 Vali Acc: 0.967 Test Loss: 0.699 Test Acc: 0.967
Validation loss decreased (-0.966659 --> -0.966660).  Saving model ...
Epoch: 23 cost time: 0.40545153617858887
Epoch: 23, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.658 Vali Acc: 0.970 Test Loss: 0.658 Test Acc: 0.970
Validation loss decreased (-0.966660 --> -0.970364).  Saving model ...
Epoch: 24 cost time: 0.4233276844024658
Epoch: 24, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.619 Vali Acc: 0.974 Test Loss: 0.619 Test Acc: 0.974
Validation loss decreased (-0.970364 --> -0.974068).  Saving model ...
Epoch: 25 cost time: 0.4483962059020996
Epoch: 25, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.584 Vali Acc: 0.974 Test Loss: 0.584 Test Acc: 0.974
Validation loss decreased (-0.974068 --> -0.974068).  Saving model ...
Epoch: 26 cost time: 0.3679189682006836
Epoch: 26, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.552 Vali Acc: 0.970 Test Loss: 0.552 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3513829708099365
Epoch: 27, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.523 Vali Acc: 0.970 Test Loss: 0.523 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.3362722396850586
Epoch: 28, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.496 Vali Acc: 0.970 Test Loss: 0.496 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.3796415328979492
Epoch: 29, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.473 Vali Acc: 0.970 Test Loss: 0.473 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.4234340190887451
Epoch: 30, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.451 Vali Acc: 0.970 Test Loss: 0.451 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.3488881587982178
Epoch: 31, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.431 Vali Acc: 0.967 Test Loss: 0.431 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.40506434440612793
Epoch: 32, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.413 Vali Acc: 0.967 Test Loss: 0.413 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.40460205078125
Epoch: 33, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.397 Vali Acc: 0.967 Test Loss: 0.397 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4181640148162842
Epoch: 34, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.383 Vali Acc: 0.963 Test Loss: 0.383 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.44148969650268555
Epoch: 35, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.370 Vali Acc: 0.970 Test Loss: 0.370 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9740740740740741
model parameter : 53638
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6837482452392578
Epoch: 1, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.893 Vali Acc: 0.107 Test Loss: 1.893 Test Acc: 0.107
Validation loss decreased (inf --> -0.107388).  Saving model ...
Epoch: 2 cost time: 0.4618206024169922
Epoch: 2, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.878 Vali Acc: 0.122 Test Loss: 1.878 Test Acc: 0.122
Validation loss decreased (-0.107388 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.478588342666626
Epoch: 3, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.866 Vali Acc: 0.137 Test Loss: 1.866 Test Acc: 0.137
Validation loss decreased (-0.122203 --> -0.137018).  Saving model ...
Epoch: 4 cost time: 0.40537071228027344
Epoch: 4, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.853 Vali Acc: 0.163 Test Loss: 1.853 Test Acc: 0.163
Validation loss decreased (-0.137018 --> -0.162944).  Saving model ...
Epoch: 5 cost time: 0.4914743900299072
Epoch: 5, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.833 Vali Acc: 0.189 Test Loss: 1.833 Test Acc: 0.189
Validation loss decreased (-0.162944 --> -0.188871).  Saving model ...
Epoch: 6 cost time: 0.4124929904937744
Epoch: 6, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.807 Vali Acc: 0.222 Test Loss: 1.807 Test Acc: 0.222
Validation loss decreased (-0.188871 --> -0.222204).  Saving model ...
Epoch: 7 cost time: 0.46801114082336426
Epoch: 7, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.775 Vali Acc: 0.248 Test Loss: 1.775 Test Acc: 0.248
Validation loss decreased (-0.222204 --> -0.248130).  Saving model ...
Epoch: 8 cost time: 0.5819473266601562
Epoch: 8, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.738 Vali Acc: 0.300 Test Loss: 1.738 Test Acc: 0.300
Validation loss decreased (-0.248130 --> -0.299983).  Saving model ...
Epoch: 9 cost time: 0.41031312942504883
Epoch: 9, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.696 Vali Acc: 0.359 Test Loss: 1.696 Test Acc: 0.359
Validation loss decreased (-0.299983 --> -0.359242).  Saving model ...
Epoch: 10 cost time: 0.421720027923584
Epoch: 10, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.650 Vali Acc: 0.422 Test Loss: 1.650 Test Acc: 0.422
Validation loss decreased (-0.359242 --> -0.422206).  Saving model ...
Epoch: 11 cost time: 0.5077941417694092
Epoch: 11, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.600 Vali Acc: 0.485 Test Loss: 1.600 Test Acc: 0.485
Validation loss decreased (-0.422206 --> -0.485169).  Saving model ...
Epoch: 12 cost time: 0.4511220455169678
Epoch: 12, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.547 Vali Acc: 0.526 Test Loss: 1.547 Test Acc: 0.526
Validation loss decreased (-0.485169 --> -0.525910).  Saving model ...
Epoch: 13 cost time: 0.4253842830657959
Epoch: 13, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.491 Vali Acc: 0.563 Test Loss: 1.491 Test Acc: 0.563
Validation loss decreased (-0.525910 --> -0.562948).  Saving model ...
Epoch: 14 cost time: 0.46616506576538086
Epoch: 14, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.434 Vali Acc: 0.578 Test Loss: 1.434 Test Acc: 0.578
Validation loss decreased (-0.562948 --> -0.577763).  Saving model ...
Epoch: 15 cost time: 0.5804336071014404
Epoch: 15, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.375 Vali Acc: 0.593 Test Loss: 1.375 Test Acc: 0.593
Validation loss decreased (-0.577763 --> -0.592579).  Saving model ...
Epoch: 16 cost time: 0.4516613483428955
Epoch: 16, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.316 Vali Acc: 0.615 Test Loss: 1.316 Test Acc: 0.615
Validation loss decreased (-0.592579 --> -0.614802).  Saving model ...
Epoch: 17 cost time: 0.48948240280151367
Epoch: 17, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.257 Vali Acc: 0.652 Test Loss: 1.257 Test Acc: 0.652
Validation loss decreased (-0.614802 --> -0.651839).  Saving model ...
Epoch: 18 cost time: 0.47236084938049316
Epoch: 18, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.198 Vali Acc: 0.678 Test Loss: 1.198 Test Acc: 0.678
Validation loss decreased (-0.651839 --> -0.677766).  Saving model ...
Epoch: 19 cost time: 0.46224498748779297
Epoch: 19, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.140 Vali Acc: 0.700 Test Loss: 1.140 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 20 cost time: 0.44045090675354004
Epoch: 20, Steps: 2 | Train Loss: 0.847 Vali Loss: 1.083 Vali Acc: 0.741 Test Loss: 1.083 Test Acc: 0.741
Validation loss decreased (-0.699989 --> -0.740730).  Saving model ...
Epoch: 21 cost time: 0.4784376621246338
Epoch: 21, Steps: 2 | Train Loss: 0.817 Vali Loss: 1.029 Vali Acc: 0.793 Test Loss: 1.029 Test Acc: 0.793
Validation loss decreased (-0.740730 --> -0.792582).  Saving model ...
Epoch: 22 cost time: 0.4333615303039551
Epoch: 22, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.977 Vali Acc: 0.819 Test Loss: 0.977 Test Acc: 0.819
Validation loss decreased (-0.792582 --> -0.818509).  Saving model ...
Epoch: 23 cost time: 0.47940969467163086
Epoch: 23, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.926 Vali Acc: 0.826 Test Loss: 0.926 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825917).  Saving model ...
Epoch: 24 cost time: 0.44002795219421387
Epoch: 24, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.878 Vali Acc: 0.844 Test Loss: 0.878 Test Acc: 0.844
Validation loss decreased (-0.825917 --> -0.844436).  Saving model ...
Epoch: 25 cost time: 0.44693946838378906
Epoch: 25, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.832 Vali Acc: 0.859 Test Loss: 0.832 Test Acc: 0.859
Validation loss decreased (-0.844436 --> -0.859251).  Saving model ...
Epoch: 26 cost time: 0.516451358795166
Epoch: 26, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.789 Vali Acc: 0.870 Test Loss: 0.789 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870362).  Saving model ...
Epoch: 27 cost time: 0.38747262954711914
Epoch: 27, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.749 Vali Acc: 0.885 Test Loss: 0.749 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 28 cost time: 0.4190661907196045
Epoch: 28, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.711 Vali Acc: 0.900 Test Loss: 0.711 Test Acc: 0.900
Validation loss decreased (-0.885178 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.42945098876953125
Epoch: 29, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.677 Vali Acc: 0.907 Test Loss: 0.677 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 30 cost time: 0.5002651214599609
Epoch: 30, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.645 Vali Acc: 0.907 Test Loss: 0.645 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 31 cost time: 0.39634084701538086
Epoch: 31, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.616 Vali Acc: 0.915 Test Loss: 0.616 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 32 cost time: 0.4855949878692627
Epoch: 32, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.589 Vali Acc: 0.922 Test Loss: 0.589 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922216).  Saving model ...
Epoch: 33 cost time: 0.45465898513793945
Epoch: 33, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.565 Vali Acc: 0.922 Test Loss: 0.565 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 34 cost time: 0.5018527507781982
Epoch: 34, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.543 Vali Acc: 0.926 Test Loss: 0.543 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925920).  Saving model ...
Epoch: 35 cost time: 0.38467979431152344
Epoch: 35, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.523 Vali Acc: 0.930 Test Loss: 0.523 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 36 cost time: 0.39428210258483887
Epoch: 36, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.505 Vali Acc: 0.933 Test Loss: 0.505 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 37 cost time: 0.4079926013946533
Epoch: 37, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.488 Vali Acc: 0.933 Test Loss: 0.488 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 38 cost time: 0.44635534286499023
Epoch: 38, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.473 Vali Acc: 0.933 Test Loss: 0.473 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.38475513458251953
Epoch: 39, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.459 Vali Acc: 0.933 Test Loss: 0.459 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.38231372833251953
Epoch: 40, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.447 Vali Acc: 0.941 Test Loss: 0.447 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940736).  Saving model ...
Epoch: 41 cost time: 0.48160624504089355
Epoch: 41, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.436 Vali Acc: 0.941 Test Loss: 0.436 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 42 cost time: 0.4243309497833252
Epoch: 42, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.425 Vali Acc: 0.944 Test Loss: 0.425 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 43 cost time: 0.4429917335510254
Epoch: 43, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.416 Vali Acc: 0.944 Test Loss: 0.416 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 44 cost time: 0.39232873916625977
Epoch: 44, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.407 Vali Acc: 0.944 Test Loss: 0.407 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 45 cost time: 0.5251147747039795
Epoch: 45, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.399 Vali Acc: 0.944 Test Loss: 0.399 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 46 cost time: 0.5400509834289551
Epoch: 46, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.392 Vali Acc: 0.941 Test Loss: 0.392 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4566617012023926
Epoch: 47, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.39275455474853516
Epoch: 48, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.44933152198791504
Epoch: 49, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.372 Vali Acc: 0.941 Test Loss: 0.372 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.41204261779785156
Epoch: 50, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.366 Vali Acc: 0.944 Test Loss: 0.366 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 51430
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.695924997329712
Epoch: 1, Steps: 2 | Train Loss: 2.016 Vali Loss: 1.852 Vali Acc: 0.100 Test Loss: 1.852 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 0.3509659767150879
Epoch: 2, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.836 Vali Acc: 0.122 Test Loss: 1.836 Test Acc: 0.122
Validation loss decreased (-0.099981 --> -0.122204).  Saving model ...
Epoch: 3 cost time: 0.3554544448852539
Epoch: 3, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.825 Vali Acc: 0.130 Test Loss: 1.825 Test Acc: 0.130
Validation loss decreased (-0.122204 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 0.3688023090362549
Epoch: 4, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.814 Vali Acc: 0.152 Test Loss: 1.814 Test Acc: 0.152
Validation loss decreased (-0.129611 --> -0.151834).  Saving model ...
Epoch: 5 cost time: 0.3902750015258789
Epoch: 5, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.801 Vali Acc: 0.163 Test Loss: 1.801 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 6 cost time: 0.4113731384277344
Epoch: 6, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.784 Vali Acc: 0.200 Test Loss: 1.784 Test Acc: 0.200
Validation loss decreased (-0.162945 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 0.3490731716156006
Epoch: 7, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.763 Vali Acc: 0.226 Test Loss: 1.763 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225908).  Saving model ...
Epoch: 8 cost time: 0.3923795223236084
Epoch: 8, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.740 Vali Acc: 0.263 Test Loss: 1.740 Test Acc: 0.263
Validation loss decreased (-0.225908 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 0.44731616973876953
Epoch: 9, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.712 Vali Acc: 0.326 Test Loss: 1.712 Test Acc: 0.326
Validation loss decreased (-0.262946 --> -0.325909).  Saving model ...
Epoch: 10 cost time: 0.35065579414367676
Epoch: 10, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.682 Vali Acc: 0.370 Test Loss: 1.682 Test Acc: 0.370
Validation loss decreased (-0.325909 --> -0.370354).  Saving model ...
Epoch: 11 cost time: 0.3930776119232178
Epoch: 11, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.648 Vali Acc: 0.419 Test Loss: 1.648 Test Acc: 0.419
Validation loss decreased (-0.370354 --> -0.418502).  Saving model ...
Epoch: 12 cost time: 0.33206963539123535
Epoch: 12, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.612 Vali Acc: 0.433 Test Loss: 1.612 Test Acc: 0.433
Validation loss decreased (-0.418502 --> -0.433317).  Saving model ...
Epoch: 13 cost time: 0.3217589855194092
Epoch: 13, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.573 Vali Acc: 0.459 Test Loss: 1.573 Test Acc: 0.459
Validation loss decreased (-0.433317 --> -0.459244).  Saving model ...
Epoch: 14 cost time: 0.4663262367248535
Epoch: 14, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.531 Vali Acc: 0.493 Test Loss: 1.531 Test Acc: 0.493
Validation loss decreased (-0.459244 --> -0.492577).  Saving model ...
Epoch: 15 cost time: 0.4030911922454834
Epoch: 15, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.489 Vali Acc: 0.544 Test Loss: 1.489 Test Acc: 0.544
Validation loss decreased (-0.492577 --> -0.544430).  Saving model ...
Epoch: 16 cost time: 0.35976147651672363
Epoch: 16, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.446 Vali Acc: 0.581 Test Loss: 1.446 Test Acc: 0.581
Validation loss decreased (-0.544430 --> -0.581467).  Saving model ...
Epoch: 17 cost time: 0.34206318855285645
Epoch: 17, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.401 Vali Acc: 0.615 Test Loss: 1.401 Test Acc: 0.615
Validation loss decreased (-0.581467 --> -0.614801).  Saving model ...
Epoch: 18 cost time: 0.3700563907623291
Epoch: 18, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.356 Vali Acc: 0.648 Test Loss: 1.356 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648135).  Saving model ...
Epoch: 19 cost time: 0.3546905517578125
Epoch: 19, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.310 Vali Acc: 0.693 Test Loss: 1.310 Test Acc: 0.693
Validation loss decreased (-0.648135 --> -0.692579).  Saving model ...
Epoch: 20 cost time: 0.33797430992126465
Epoch: 20, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.264 Vali Acc: 0.722 Test Loss: 1.264 Test Acc: 0.722
Validation loss decreased (-0.692579 --> -0.722210).  Saving model ...
Epoch: 21 cost time: 0.3449585437774658
Epoch: 21, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.218 Vali Acc: 0.741 Test Loss: 1.218 Test Acc: 0.741
Validation loss decreased (-0.722210 --> -0.740729).  Saving model ...
Epoch: 22 cost time: 0.36617612838745117
Epoch: 22, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.172 Vali Acc: 0.752 Test Loss: 1.172 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751840).  Saving model ...
Epoch: 23 cost time: 0.34622788429260254
Epoch: 23, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.127 Vali Acc: 0.785 Test Loss: 1.127 Test Acc: 0.785
Validation loss decreased (-0.751840 --> -0.785174).  Saving model ...
Epoch: 24 cost time: 0.3449070453643799
Epoch: 24, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.082 Vali Acc: 0.811 Test Loss: 1.082 Test Acc: 0.811
Validation loss decreased (-0.785174 --> -0.811100).  Saving model ...
Epoch: 25 cost time: 0.41056370735168457
Epoch: 25, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.038 Vali Acc: 0.837 Test Loss: 1.038 Test Acc: 0.837
Validation loss decreased (-0.811100 --> -0.837027).  Saving model ...
Epoch: 26 cost time: 0.41028308868408203
Epoch: 26, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.996 Vali Acc: 0.848 Test Loss: 0.996 Test Acc: 0.848
Validation loss decreased (-0.837027 --> -0.848138).  Saving model ...
Epoch: 27 cost time: 0.39433789253234863
Epoch: 27, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.954 Vali Acc: 0.859 Test Loss: 0.954 Test Acc: 0.859
Validation loss decreased (-0.848138 --> -0.859250).  Saving model ...
Epoch: 28 cost time: 0.35016417503356934
Epoch: 28, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.914 Vali Acc: 0.881 Test Loss: 0.914 Test Acc: 0.881
Validation loss decreased (-0.859250 --> -0.881472).  Saving model ...
Epoch: 29 cost time: 0.409329891204834
Epoch: 29, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.876 Vali Acc: 0.885 Test Loss: 0.876 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 30 cost time: 0.3642454147338867
Epoch: 30, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.839 Vali Acc: 0.885 Test Loss: 0.839 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885177).  Saving model ...
Epoch: 31 cost time: 0.4064445495605469
Epoch: 31, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.804 Vali Acc: 0.889 Test Loss: 0.804 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 32 cost time: 0.4167966842651367
Epoch: 32, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.772 Vali Acc: 0.896 Test Loss: 0.772 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896289).  Saving model ...
Epoch: 33 cost time: 0.3946194648742676
Epoch: 33, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.741 Vali Acc: 0.893 Test Loss: 0.741 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.3945345878601074
Epoch: 34, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.712 Vali Acc: 0.900 Test Loss: 0.712 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 35 cost time: 0.37545204162597656
Epoch: 35, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.686 Vali Acc: 0.915 Test Loss: 0.686 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914808).  Saving model ...
Epoch: 36 cost time: 0.4365222454071045
Epoch: 36, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.661 Vali Acc: 0.915 Test Loss: 0.661 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 37 cost time: 0.3402113914489746
Epoch: 37, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.637 Vali Acc: 0.922 Test Loss: 0.637 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 38 cost time: 0.43425774574279785
Epoch: 38, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.616 Vali Acc: 0.926 Test Loss: 0.616 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 39 cost time: 0.37563133239746094
Epoch: 39, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.596 Vali Acc: 0.926 Test Loss: 0.596 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 40 cost time: 0.33943748474121094
Epoch: 40, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.577 Vali Acc: 0.926 Test Loss: 0.577 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 41 cost time: 0.3250908851623535
Epoch: 41, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.560 Vali Acc: 0.926 Test Loss: 0.560 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 42 cost time: 0.37947654724121094
Epoch: 42, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.544 Vali Acc: 0.933 Test Loss: 0.544 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 43 cost time: 0.39821434020996094
Epoch: 43, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.528 Vali Acc: 0.933 Test Loss: 0.528 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 44 cost time: 0.41651201248168945
Epoch: 44, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.514 Vali Acc: 0.933 Test Loss: 0.514 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 45 cost time: 0.35025835037231445
Epoch: 45, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.501 Vali Acc: 0.933 Test Loss: 0.501 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 46 cost time: 0.41249585151672363
Epoch: 46, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.488 Vali Acc: 0.930 Test Loss: 0.488 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4022541046142578
Epoch: 47, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.477 Vali Acc: 0.933 Test Loss: 0.477 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 48 cost time: 0.3267245292663574
Epoch: 48, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.466 Vali Acc: 0.933 Test Loss: 0.466 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 49 cost time: 0.4152653217315674
Epoch: 49, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.455 Vali Acc: 0.933 Test Loss: 0.455 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 50 cost time: 0.35523438453674316
Epoch: 50, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.446 Vali Acc: 0.933 Test Loss: 0.446 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 48454
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5959107875823975
Epoch: 1, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.855 Vali Acc: 0.122 Test Loss: 1.855 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.38901448249816895
Epoch: 2, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.839 Vali Acc: 0.144 Test Loss: 1.839 Test Acc: 0.144
Validation loss decreased (-0.122204 --> -0.144426).  Saving model ...
Epoch: 3 cost time: 0.420274019241333
Epoch: 3, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.827 Vali Acc: 0.159 Test Loss: 1.827 Test Acc: 0.159
Validation loss decreased (-0.144426 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.40151166915893555
Epoch: 4, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.817 Vali Acc: 0.167 Test Loss: 1.817 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 0.39633607864379883
Epoch: 5, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.804 Vali Acc: 0.193 Test Loss: 1.804 Test Acc: 0.193
Validation loss decreased (-0.166648 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.4435105323791504
Epoch: 6, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.789 Vali Acc: 0.204 Test Loss: 1.789 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 7 cost time: 0.35019779205322266
Epoch: 7, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.771 Vali Acc: 0.211 Test Loss: 1.771 Test Acc: 0.211
Validation loss decreased (-0.203686 --> -0.211093).  Saving model ...
Epoch: 8 cost time: 0.37214040756225586
Epoch: 8, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.751 Vali Acc: 0.222 Test Loss: 1.751 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222205).  Saving model ...
Epoch: 9 cost time: 0.36568117141723633
Epoch: 9, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.729 Vali Acc: 0.248 Test Loss: 1.729 Test Acc: 0.248
Validation loss decreased (-0.222205 --> -0.248131).  Saving model ...
Epoch: 10 cost time: 0.384965181350708
Epoch: 10, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.704 Vali Acc: 0.281 Test Loss: 1.704 Test Acc: 0.281
Validation loss decreased (-0.248131 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.3646206855773926
Epoch: 11, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.677 Vali Acc: 0.304 Test Loss: 1.677 Test Acc: 0.304
Validation loss decreased (-0.281464 --> -0.303687).  Saving model ...
Epoch: 12 cost time: 0.38489270210266113
Epoch: 12, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.648 Vali Acc: 0.337 Test Loss: 1.648 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337021).  Saving model ...
Epoch: 13 cost time: 0.4023468494415283
Epoch: 13, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.616 Vali Acc: 0.378 Test Loss: 1.616 Test Acc: 0.378
Validation loss decreased (-0.337021 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.3858213424682617
Epoch: 14, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.584 Vali Acc: 0.422 Test Loss: 1.584 Test Acc: 0.422
Validation loss decreased (-0.377762 --> -0.422206).  Saving model ...
Epoch: 15 cost time: 0.3766148090362549
Epoch: 15, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.550 Vali Acc: 0.444 Test Loss: 1.550 Test Acc: 0.444
Validation loss decreased (-0.422206 --> -0.444429).  Saving model ...
Epoch: 16 cost time: 0.40326452255249023
Epoch: 16, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.514 Vali Acc: 0.481 Test Loss: 1.514 Test Acc: 0.481
Validation loss decreased (-0.444429 --> -0.481466).  Saving model ...
Epoch: 17 cost time: 0.36812925338745117
Epoch: 17, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.477 Vali Acc: 0.496 Test Loss: 1.477 Test Acc: 0.496
Validation loss decreased (-0.481466 --> -0.496282).  Saving model ...
Epoch: 18 cost time: 0.36378908157348633
Epoch: 18, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.440 Vali Acc: 0.530 Test Loss: 1.440 Test Acc: 0.530
Validation loss decreased (-0.496282 --> -0.529615).  Saving model ...
Epoch: 19 cost time: 0.3563039302825928
Epoch: 19, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.401 Vali Acc: 0.570 Test Loss: 1.401 Test Acc: 0.570
Validation loss decreased (-0.529615 --> -0.570356).  Saving model ...
Epoch: 20 cost time: 0.4489154815673828
Epoch: 20, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.363 Vali Acc: 0.600 Test Loss: 1.363 Test Acc: 0.600
Validation loss decreased (-0.570356 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 0.3621711730957031
Epoch: 21, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.323 Vali Acc: 0.630 Test Loss: 1.323 Test Acc: 0.630
Validation loss decreased (-0.599986 --> -0.629616).  Saving model ...
Epoch: 22 cost time: 0.34847140312194824
Epoch: 22, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.284 Vali Acc: 0.670 Test Loss: 1.284 Test Acc: 0.670
Validation loss decreased (-0.629616 --> -0.670358).  Saving model ...
Epoch: 23 cost time: 0.41130661964416504
Epoch: 23, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.245 Vali Acc: 0.693 Test Loss: 1.245 Test Acc: 0.693
Validation loss decreased (-0.670358 --> -0.692580).  Saving model ...
Epoch: 24 cost time: 0.3707549571990967
Epoch: 24, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.205 Vali Acc: 0.722 Test Loss: 1.205 Test Acc: 0.722
Validation loss decreased (-0.692580 --> -0.722210).  Saving model ...
Epoch: 25 cost time: 0.4153308868408203
Epoch: 25, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.166 Vali Acc: 0.744 Test Loss: 1.166 Test Acc: 0.744
Validation loss decreased (-0.722210 --> -0.744433).  Saving model ...
Epoch: 26 cost time: 0.36334848403930664
Epoch: 26, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.128 Vali Acc: 0.763 Test Loss: 1.128 Test Acc: 0.763
Validation loss decreased (-0.744433 --> -0.762952).  Saving model ...
Epoch: 27 cost time: 0.35329437255859375
Epoch: 27, Steps: 2 | Train Loss: 0.867 Vali Loss: 1.091 Vali Acc: 0.785 Test Loss: 1.091 Test Acc: 0.785
Validation loss decreased (-0.762952 --> -0.785174).  Saving model ...
Epoch: 28 cost time: 0.36489152908325195
Epoch: 28, Steps: 2 | Train Loss: 0.853 Vali Loss: 1.055 Vali Acc: 0.804 Test Loss: 1.055 Test Acc: 0.804
Validation loss decreased (-0.785174 --> -0.803693).  Saving model ...
Epoch: 29 cost time: 0.399261474609375
Epoch: 29, Steps: 2 | Train Loss: 0.794 Vali Loss: 1.021 Vali Acc: 0.815 Test Loss: 1.021 Test Acc: 0.815
Validation loss decreased (-0.803693 --> -0.814805).  Saving model ...
Epoch: 30 cost time: 0.39934277534484863
Epoch: 30, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.987 Vali Acc: 0.815 Test Loss: 0.987 Test Acc: 0.815
Validation loss decreased (-0.814805 --> -0.814805).  Saving model ...
Epoch: 31 cost time: 0.38198161125183105
Epoch: 31, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.953 Vali Acc: 0.822 Test Loss: 0.953 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 32 cost time: 0.37015390396118164
Epoch: 32, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.921 Vali Acc: 0.841 Test Loss: 0.921 Test Acc: 0.841
Validation loss decreased (-0.822213 --> -0.840732).  Saving model ...
Epoch: 33 cost time: 0.4162116050720215
Epoch: 33, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.890 Vali Acc: 0.848 Test Loss: 0.890 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848139).  Saving model ...
Epoch: 34 cost time: 0.3865694999694824
Epoch: 34, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.861 Vali Acc: 0.852 Test Loss: 0.861 Test Acc: 0.852
Validation loss decreased (-0.848139 --> -0.851843).  Saving model ...
Epoch: 35 cost time: 0.3644900321960449
Epoch: 35, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.833 Vali Acc: 0.852 Test Loss: 0.833 Test Acc: 0.852
Validation loss decreased (-0.851843 --> -0.851844).  Saving model ...
Epoch: 36 cost time: 0.3746621608734131
Epoch: 36, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
Validation loss decreased (-0.851844 --> -0.855547).  Saving model ...
Epoch: 37 cost time: 0.4042322635650635
Epoch: 37, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.782 Vali Acc: 0.863 Test Loss: 0.782 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 38 cost time: 0.3687891960144043
Epoch: 38, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.758 Vali Acc: 0.878 Test Loss: 0.758 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 39 cost time: 0.39537930488586426
Epoch: 39, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.736 Vali Acc: 0.881 Test Loss: 0.736 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 40 cost time: 0.3893885612487793
Epoch: 40, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.715 Vali Acc: 0.881 Test Loss: 0.715 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
Epoch: 41 cost time: 0.3606715202331543
Epoch: 41, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.695 Vali Acc: 0.885 Test Loss: 0.695 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 42 cost time: 0.3607673645019531
Epoch: 42, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.676 Vali Acc: 0.885 Test Loss: 0.676 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 43 cost time: 0.35105133056640625
Epoch: 43, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.658 Vali Acc: 0.889 Test Loss: 0.658 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 44 cost time: 0.3842902183532715
Epoch: 44, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.641 Vali Acc: 0.889 Test Loss: 0.641 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 45 cost time: 0.40528154373168945
Epoch: 45, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.626 Vali Acc: 0.896 Test Loss: 0.626 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 46 cost time: 0.42702269554138184
Epoch: 46, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 47 cost time: 0.426849365234375
Epoch: 47, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.596 Vali Acc: 0.904 Test Loss: 0.596 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 48 cost time: 0.43280744552612305
Epoch: 48, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.582 Vali Acc: 0.904 Test Loss: 0.582 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 49 cost time: 0.40544724464416504
Epoch: 49, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.569 Vali Acc: 0.904 Test Loss: 0.569 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 50 cost time: 0.3824913501739502
Epoch: 50, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.558 Vali Acc: 0.904 Test Loss: 0.558 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 47046
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8781933784484863
Epoch: 1, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.774 Vali Acc: 0.126 Test Loss: 1.774 Test Acc: 0.126
Validation loss decreased (inf --> -0.125908).  Saving model ...
Epoch: 2 cost time: 0.43737268447875977
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.762 Vali Acc: 0.170 Test Loss: 1.762 Test Acc: 0.170
Validation loss decreased (-0.125908 --> -0.170353).  Saving model ...
Epoch: 3 cost time: 0.45923471450805664
Epoch: 3, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.748 Vali Acc: 0.319 Test Loss: 1.748 Test Acc: 0.319
Validation loss decreased (-0.170353 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.4090390205383301
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.723 Vali Acc: 0.426 Test Loss: 1.723 Test Acc: 0.426
Validation loss decreased (-0.318501 --> -0.425909).  Saving model ...
Epoch: 5 cost time: 0.4583778381347656
Epoch: 5, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.689 Vali Acc: 0.548 Test Loss: 1.689 Test Acc: 0.548
Validation loss decreased (-0.425909 --> -0.548131).  Saving model ...
Epoch: 6 cost time: 0.42961978912353516
Epoch: 6, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.642 Vali Acc: 0.641 Test Loss: 1.642 Test Acc: 0.641
Validation loss decreased (-0.548131 --> -0.640724).  Saving model ...
Epoch: 7 cost time: 0.4545121192932129
Epoch: 7, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.585 Vali Acc: 0.733 Test Loss: 1.585 Test Acc: 0.733
Validation loss decreased (-0.640724 --> -0.733317).  Saving model ...
Epoch: 8 cost time: 0.5158073902130127
Epoch: 8, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.515 Vali Acc: 0.793 Test Loss: 1.515 Test Acc: 0.793
Validation loss decreased (-0.733317 --> -0.792577).  Saving model ...
Epoch: 9 cost time: 0.5211551189422607
Epoch: 9, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.435 Vali Acc: 0.833 Test Loss: 1.435 Test Acc: 0.833
Validation loss decreased (-0.792577 --> -0.833319).  Saving model ...
Epoch: 10 cost time: 0.4227128028869629
Epoch: 10, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.344 Vali Acc: 0.859 Test Loss: 1.344 Test Acc: 0.859
Validation loss decreased (-0.833319 --> -0.859246).  Saving model ...
Epoch: 11 cost time: 0.4429640769958496
Epoch: 11, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.244 Vali Acc: 0.863 Test Loss: 1.244 Test Acc: 0.863
Validation loss decreased (-0.859246 --> -0.862951).  Saving model ...
Epoch: 12 cost time: 0.5150229930877686
Epoch: 12, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.138 Vali Acc: 0.878 Test Loss: 1.138 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877766).  Saving model ...
Epoch: 13 cost time: 0.4327201843261719
Epoch: 13, Steps: 2 | Train Loss: 0.753 Vali Loss: 1.029 Vali Acc: 0.893 Test Loss: 1.029 Test Acc: 0.893
Validation loss decreased (-0.877766 --> -0.892582).  Saving model ...
Epoch: 14 cost time: 0.46967530250549316
Epoch: 14, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.920 Vali Acc: 0.889 Test Loss: 0.920 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5311274528503418
Epoch: 15, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.816 Vali Acc: 0.900 Test Loss: 0.816 Test Acc: 0.900
Validation loss decreased (-0.892582 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.5114679336547852
Epoch: 16, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.716 Vali Acc: 0.919 Test Loss: 0.716 Test Acc: 0.919
Validation loss decreased (-0.899992 --> -0.918511).  Saving model ...
Epoch: 17 cost time: 0.4441962242126465
Epoch: 17, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.627 Vali Acc: 0.926 Test Loss: 0.627 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925920).  Saving model ...
Epoch: 18 cost time: 0.5510218143463135
Epoch: 18, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.549 Vali Acc: 0.930 Test Loss: 0.549 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 19 cost time: 0.450392484664917
Epoch: 19, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.481 Vali Acc: 0.937 Test Loss: 0.481 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 20 cost time: 0.49877405166625977
Epoch: 20, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.424 Vali Acc: 0.937 Test Loss: 0.424 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 21 cost time: 0.5723206996917725
Epoch: 21, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.379 Vali Acc: 0.937 Test Loss: 0.379 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.5709741115570068
Epoch: 22, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5349245071411133
Epoch: 23, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.551067590713501
Epoch: 24, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.57155442237854
Epoch: 25, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.5902838706970215
Epoch: 26, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.5824096202850342
Epoch: 27, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.6632339954376221
Epoch: 28, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5703353881835938
Epoch: 29, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.5507602691650391
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.5276119709014893
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.5687730312347412
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.4858815670013428
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.5426039695739746
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.682847261428833
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.5800378322601318
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5600059032440186
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4985630512237549
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.45833349227905273
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5307729244232178
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4562215805053711
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.49648261070251465
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.46123552322387695
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5384583473205566
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.43128013610839844
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 457190
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8504173755645752
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.788 Vali Acc: 0.093 Test Loss: 1.788 Test Acc: 0.093
Validation loss decreased (inf --> -0.092575).  Saving model ...
Epoch: 2 cost time: 0.4825403690338135
Epoch: 2, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.778 Vali Acc: 0.107 Test Loss: 1.778 Test Acc: 0.107
Validation loss decreased (-0.092575 --> -0.107390).  Saving model ...
Epoch: 3 cost time: 0.5221576690673828
Epoch: 3, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.768 Vali Acc: 0.144 Test Loss: 1.768 Test Acc: 0.144
Validation loss decreased (-0.107390 --> -0.144427).  Saving model ...
Epoch: 4 cost time: 0.4575166702270508
Epoch: 4, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.753 Vali Acc: 0.270 Test Loss: 1.753 Test Acc: 0.270
Validation loss decreased (-0.144427 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.48186206817626953
Epoch: 5, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.733 Vali Acc: 0.385 Test Loss: 1.733 Test Acc: 0.385
Validation loss decreased (-0.270353 --> -0.385168).  Saving model ...
Epoch: 6 cost time: 0.5010545253753662
Epoch: 6, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.707 Vali Acc: 0.489 Test Loss: 1.707 Test Acc: 0.489
Validation loss decreased (-0.385168 --> -0.488872).  Saving model ...
Epoch: 7 cost time: 0.49855470657348633
Epoch: 7, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.675 Vali Acc: 0.559 Test Loss: 1.675 Test Acc: 0.559
Validation loss decreased (-0.488872 --> -0.559243).  Saving model ...
Epoch: 8 cost time: 0.4350252151489258
Epoch: 8, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.636 Vali Acc: 0.641 Test Loss: 1.636 Test Acc: 0.641
Validation loss decreased (-0.559243 --> -0.640724).  Saving model ...
Epoch: 9 cost time: 0.4406909942626953
Epoch: 9, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.592 Vali Acc: 0.700 Test Loss: 1.592 Test Acc: 0.700
Validation loss decreased (-0.640724 --> -0.699984).  Saving model ...
Epoch: 10 cost time: 0.5265884399414062
Epoch: 10, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.541 Vali Acc: 0.737 Test Loss: 1.541 Test Acc: 0.737
Validation loss decreased (-0.699984 --> -0.737022).  Saving model ...
Epoch: 11 cost time: 0.40683960914611816
Epoch: 11, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.483 Vali Acc: 0.767 Test Loss: 1.483 Test Acc: 0.767
Validation loss decreased (-0.737022 --> -0.766652).  Saving model ...
Epoch: 12 cost time: 0.48461008071899414
Epoch: 12, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.420 Vali Acc: 0.807 Test Loss: 1.420 Test Acc: 0.807
Validation loss decreased (-0.766652 --> -0.807393).  Saving model ...
Epoch: 13 cost time: 0.5384747982025146
Epoch: 13, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.353 Vali Acc: 0.826 Test Loss: 1.353 Test Acc: 0.826
Validation loss decreased (-0.807393 --> -0.825912).  Saving model ...
Epoch: 14 cost time: 0.47299981117248535
Epoch: 14, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.282 Vali Acc: 0.859 Test Loss: 1.282 Test Acc: 0.859
Validation loss decreased (-0.825912 --> -0.859246).  Saving model ...
Epoch: 15 cost time: 0.45389485359191895
Epoch: 15, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.206 Vali Acc: 0.863 Test Loss: 1.206 Test Acc: 0.863
Validation loss decreased (-0.859246 --> -0.862951).  Saving model ...
Epoch: 16 cost time: 0.37832188606262207
Epoch: 16, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.125 Vali Acc: 0.881 Test Loss: 1.125 Test Acc: 0.881
Validation loss decreased (-0.862951 --> -0.881470).  Saving model ...
Epoch: 17 cost time: 0.4580802917480469
Epoch: 17, Steps: 2 | Train Loss: 0.806 Vali Loss: 1.042 Vali Acc: 0.889 Test Loss: 1.042 Test Acc: 0.889
Validation loss decreased (-0.881470 --> -0.888878).  Saving model ...
Epoch: 18 cost time: 0.4502575397491455
Epoch: 18, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.959 Vali Acc: 0.893 Test Loss: 0.959 Test Acc: 0.893
Validation loss decreased (-0.888878 --> -0.892583).  Saving model ...
Epoch: 19 cost time: 0.4786803722381592
Epoch: 19, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.877 Vali Acc: 0.893 Test Loss: 0.877 Test Acc: 0.893
Validation loss decreased (-0.892583 --> -0.892584).  Saving model ...
Epoch: 20 cost time: 0.5405745506286621
Epoch: 20, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.798 Vali Acc: 0.900 Test Loss: 0.798 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.4634983539581299
Epoch: 21, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.724 Vali Acc: 0.911 Test Loss: 0.724 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.43941354751586914
Epoch: 22, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.656 Vali Acc: 0.911 Test Loss: 0.656 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.48934125900268555
Epoch: 23, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.595 Vali Acc: 0.911 Test Loss: 0.595 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 24 cost time: 0.4194648265838623
Epoch: 24, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.541 Vali Acc: 0.915 Test Loss: 0.541 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 25 cost time: 0.44088006019592285
Epoch: 25, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.493 Vali Acc: 0.919 Test Loss: 0.493 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918514).  Saving model ...
Epoch: 26 cost time: 0.39992451667785645
Epoch: 26, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.452 Vali Acc: 0.922 Test Loss: 0.452 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 27 cost time: 0.40460729598999023
Epoch: 27, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.417 Vali Acc: 0.922 Test Loss: 0.417 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 28 cost time: 0.3876171112060547
Epoch: 28, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 29 cost time: 0.42935681343078613
Epoch: 29, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.361 Vali Acc: 0.933 Test Loss: 0.361 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.4513285160064697
Epoch: 30, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.339 Vali Acc: 0.937 Test Loss: 0.339 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.43321728706359863
Epoch: 31, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.4841489791870117
Epoch: 32, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.4249436855316162
Epoch: 33, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.4952824115753174
Epoch: 34, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.43935537338256836
Epoch: 35, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.4278678894042969
Epoch: 36, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.43532562255859375
Epoch: 37, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.46384429931640625
Epoch: 38, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.46188998222351074
Epoch: 39, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.4377100467681885
Epoch: 40, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.4937093257904053
Epoch: 41, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.4905245304107666
Epoch: 42, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.48165416717529297
Epoch: 43, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.47194552421569824
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.4129784107208252
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.4950721263885498
Epoch: 46, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4450981616973877
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.47507476806640625
Epoch: 48, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.45965147018432617
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4258739948272705
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 429606
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.737403154373169
Epoch: 1, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.822 Vali Acc: 0.215 Test Loss: 1.822 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.4980149269104004
Epoch: 2, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.811 Vali Acc: 0.219 Test Loss: 1.811 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218500).  Saving model ...
Epoch: 3 cost time: 0.40047764778137207
Epoch: 3, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.801 Vali Acc: 0.233 Test Loss: 1.801 Test Acc: 0.233
Validation loss decreased (-0.218500 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 0.47772955894470215
Epoch: 4, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.788 Vali Acc: 0.256 Test Loss: 1.788 Test Acc: 0.256
Validation loss decreased (-0.233315 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 0.416550874710083
Epoch: 5, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.770 Vali Acc: 0.278 Test Loss: 1.770 Test Acc: 0.278
Validation loss decreased (-0.255538 --> -0.277760).  Saving model ...
Epoch: 6 cost time: 0.4184989929199219
Epoch: 6, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.746 Vali Acc: 0.293 Test Loss: 1.746 Test Acc: 0.293
Validation loss decreased (-0.277760 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 0.4047529697418213
Epoch: 7, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.718 Vali Acc: 0.374 Test Loss: 1.718 Test Acc: 0.374
Validation loss decreased (-0.292575 --> -0.374057).  Saving model ...
Epoch: 8 cost time: 0.44727492332458496
Epoch: 8, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.684 Vali Acc: 0.515 Test Loss: 1.684 Test Acc: 0.515
Validation loss decreased (-0.374057 --> -0.514798).  Saving model ...
Epoch: 9 cost time: 0.40407872200012207
Epoch: 9, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.645 Vali Acc: 0.556 Test Loss: 1.645 Test Acc: 0.556
Validation loss decreased (-0.514798 --> -0.555539).  Saving model ...
Epoch: 10 cost time: 0.4084608554840088
Epoch: 10, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.601 Vali Acc: 0.611 Test Loss: 1.601 Test Acc: 0.611
Validation loss decreased (-0.555539 --> -0.611095).  Saving model ...
Epoch: 11 cost time: 0.4275803565979004
Epoch: 11, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.553 Vali Acc: 0.693 Test Loss: 1.553 Test Acc: 0.693
Validation loss decreased (-0.611095 --> -0.692577).  Saving model ...
Epoch: 12 cost time: 0.4878990650177002
Epoch: 12, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.499 Vali Acc: 0.733 Test Loss: 1.499 Test Acc: 0.733
Validation loss decreased (-0.692577 --> -0.733318).  Saving model ...
Epoch: 13 cost time: 0.3872959613800049
Epoch: 13, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.441 Vali Acc: 0.767 Test Loss: 1.441 Test Acc: 0.767
Validation loss decreased (-0.733318 --> -0.766652).  Saving model ...
Epoch: 14 cost time: 0.4690842628479004
Epoch: 14, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.378 Vali Acc: 0.807 Test Loss: 1.378 Test Acc: 0.807
Validation loss decreased (-0.766652 --> -0.807394).  Saving model ...
Epoch: 15 cost time: 0.4382350444793701
Epoch: 15, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.310 Vali Acc: 0.837 Test Loss: 1.310 Test Acc: 0.837
Validation loss decreased (-0.807394 --> -0.837024).  Saving model ...
Epoch: 16 cost time: 0.37618446350097656
Epoch: 16, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.239 Vali Acc: 0.863 Test Loss: 1.239 Test Acc: 0.863
Validation loss decreased (-0.837024 --> -0.862951).  Saving model ...
Epoch: 17 cost time: 0.3673527240753174
Epoch: 17, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.164 Vali Acc: 0.878 Test Loss: 1.164 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877766).  Saving model ...
Epoch: 18 cost time: 0.4105062484741211
Epoch: 18, Steps: 2 | Train Loss: 0.856 Vali Loss: 1.088 Vali Acc: 0.896 Test Loss: 1.088 Test Acc: 0.896
Validation loss decreased (-0.877766 --> -0.896285).  Saving model ...
Epoch: 19 cost time: 0.44200634956359863
Epoch: 19, Steps: 2 | Train Loss: 0.776 Vali Loss: 1.011 Vali Acc: 0.915 Test Loss: 1.011 Test Acc: 0.915
Validation loss decreased (-0.896285 --> -0.914805).  Saving model ...
Epoch: 20 cost time: 0.41454243659973145
Epoch: 20, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.935 Vali Acc: 0.926 Test Loss: 0.935 Test Acc: 0.926
Validation loss decreased (-0.914805 --> -0.925917).  Saving model ...
Epoch: 21 cost time: 0.38107776641845703
Epoch: 21, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.861 Vali Acc: 0.933 Test Loss: 0.861 Test Acc: 0.933
Validation loss decreased (-0.925917 --> -0.933325).  Saving model ...
Epoch: 22 cost time: 0.42656517028808594
Epoch: 22, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.790 Vali Acc: 0.930 Test Loss: 0.790 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5010731220245361
Epoch: 23, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.725 Vali Acc: 0.930 Test Loss: 0.725 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4172666072845459
Epoch: 24, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.664 Vali Acc: 0.933 Test Loss: 0.664 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933327).  Saving model ...
Epoch: 25 cost time: 0.4113624095916748
Epoch: 25, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.609 Vali Acc: 0.937 Test Loss: 0.609 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 26 cost time: 0.40488123893737793
Epoch: 26, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.559 Vali Acc: 0.937 Test Loss: 0.559 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 27 cost time: 0.3690803050994873
Epoch: 27, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.514 Vali Acc: 0.937 Test Loss: 0.514 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 28 cost time: 0.4415466785430908
Epoch: 28, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.475 Vali Acc: 0.937 Test Loss: 0.475 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 29 cost time: 0.3783910274505615
Epoch: 29, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.440 Vali Acc: 0.937 Test Loss: 0.440 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.38353872299194336
Epoch: 30, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.409 Vali Acc: 0.937 Test Loss: 0.409 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 31 cost time: 0.4148678779602051
Epoch: 31, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.382 Vali Acc: 0.944 Test Loss: 0.382 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.3909265995025635
Epoch: 32, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.358 Vali Acc: 0.948 Test Loss: 0.358 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.4694375991821289
Epoch: 33, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.338 Vali Acc: 0.948 Test Loss: 0.338 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 34 cost time: 0.4867122173309326
Epoch: 34, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 35 cost time: 0.5055437088012695
Epoch: 35, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.305 Vali Acc: 0.948 Test Loss: 0.305 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 36 cost time: 0.4719078540802002
Epoch: 36, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.292 Vali Acc: 0.948 Test Loss: 0.292 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 37 cost time: 0.46361207962036133
Epoch: 37, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.5121526718139648
Epoch: 38, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.952 Test Loss: 0.270 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.4249136447906494
Epoch: 39, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.262 Vali Acc: 0.952 Test Loss: 0.262 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.41220688819885254
Epoch: 40, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.3746659755706787
Epoch: 41, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.248 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4062325954437256
Epoch: 42, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.4383504390716553
Epoch: 43, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.4677748680114746
Epoch: 44, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.45601391792297363
Epoch: 45, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.4428689479827881
Epoch: 46, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.42079639434814453
Epoch: 47, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.3932931423187256
Epoch: 48, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.4220755100250244
Epoch: 49, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.41303229331970215
Epoch: 50, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 423494
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6127803325653076
Epoch: 1, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.798 Vali Acc: 0.170 Test Loss: 1.798 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.39814066886901855
Epoch: 2, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.792 Vali Acc: 0.174 Test Loss: 1.792 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.470172643661499
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.785 Vali Acc: 0.178 Test Loss: 1.785 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.4206364154815674
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.776 Vali Acc: 0.193 Test Loss: 1.776 Test Acc: 0.193
Validation loss decreased (-0.177760 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.4418673515319824
Epoch: 5, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.763 Vali Acc: 0.222 Test Loss: 1.763 Test Acc: 0.222
Validation loss decreased (-0.192575 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 0.38605165481567383
Epoch: 6, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.747 Vali Acc: 0.267 Test Loss: 1.747 Test Acc: 0.267
Validation loss decreased (-0.222205 --> -0.266649).  Saving model ...
Epoch: 7 cost time: 0.41921138763427734
Epoch: 7, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.726 Vali Acc: 0.311 Test Loss: 1.726 Test Acc: 0.311
Validation loss decreased (-0.266649 --> -0.311094).  Saving model ...
Epoch: 8 cost time: 0.411745548248291
Epoch: 8, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.701 Vali Acc: 0.433 Test Loss: 1.701 Test Acc: 0.433
Validation loss decreased (-0.311094 --> -0.433316).  Saving model ...
Epoch: 9 cost time: 0.4890151023864746
Epoch: 9, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.671 Vali Acc: 0.504 Test Loss: 1.671 Test Acc: 0.504
Validation loss decreased (-0.433316 --> -0.503687).  Saving model ...
Epoch: 10 cost time: 0.4197680950164795
Epoch: 10, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.637 Vali Acc: 0.578 Test Loss: 1.637 Test Acc: 0.578
Validation loss decreased (-0.503687 --> -0.577761).  Saving model ...
Epoch: 11 cost time: 0.3964114189147949
Epoch: 11, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.600 Vali Acc: 0.626 Test Loss: 1.600 Test Acc: 0.626
Validation loss decreased (-0.577761 --> -0.625910).  Saving model ...
Epoch: 12 cost time: 0.41280555725097656
Epoch: 12, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.558 Vali Acc: 0.674 Test Loss: 1.558 Test Acc: 0.674
Validation loss decreased (-0.625910 --> -0.674058).  Saving model ...
Epoch: 13 cost time: 0.4635491371154785
Epoch: 13, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.513 Vali Acc: 0.700 Test Loss: 1.513 Test Acc: 0.700
Validation loss decreased (-0.674058 --> -0.699985).  Saving model ...
Epoch: 14 cost time: 0.38875842094421387
Epoch: 14, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.464 Vali Acc: 0.733 Test Loss: 1.464 Test Acc: 0.733
Validation loss decreased (-0.699985 --> -0.733319).  Saving model ...
Epoch: 15 cost time: 0.3885061740875244
Epoch: 15, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.412 Vali Acc: 0.748 Test Loss: 1.412 Test Acc: 0.748
Validation loss decreased (-0.733319 --> -0.748134).  Saving model ...
Epoch: 16 cost time: 0.4335341453552246
Epoch: 16, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.357 Vali Acc: 0.770 Test Loss: 1.357 Test Acc: 0.770
Validation loss decreased (-0.748134 --> -0.770357).  Saving model ...
Epoch: 17 cost time: 0.4010801315307617
Epoch: 17, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.301 Vali Acc: 0.800 Test Loss: 1.301 Test Acc: 0.800
Validation loss decreased (-0.770357 --> -0.799987).  Saving model ...
Epoch: 18 cost time: 0.43834781646728516
Epoch: 18, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.242 Vali Acc: 0.826 Test Loss: 1.242 Test Acc: 0.826
Validation loss decreased (-0.799987 --> -0.825914).  Saving model ...
Epoch: 19 cost time: 0.39333510398864746
Epoch: 19, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.182 Vali Acc: 0.837 Test Loss: 1.182 Test Acc: 0.837
Validation loss decreased (-0.825914 --> -0.837025).  Saving model ...
Epoch: 20 cost time: 0.4171156883239746
Epoch: 20, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.121 Vali Acc: 0.856 Test Loss: 1.121 Test Acc: 0.856
Validation loss decreased (-0.837025 --> -0.855544).  Saving model ...
Epoch: 21 cost time: 0.4154815673828125
Epoch: 21, Steps: 2 | Train Loss: 0.839 Vali Loss: 1.061 Vali Acc: 0.863 Test Loss: 1.061 Test Acc: 0.863
Validation loss decreased (-0.855544 --> -0.862952).  Saving model ...
Epoch: 22 cost time: 0.44107842445373535
Epoch: 22, Steps: 2 | Train Loss: 0.803 Vali Loss: 1.001 Vali Acc: 0.881 Test Loss: 1.001 Test Acc: 0.881
Validation loss decreased (-0.862952 --> -0.881471).  Saving model ...
Epoch: 23 cost time: 0.40381622314453125
Epoch: 23, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.943 Vali Acc: 0.896 Test Loss: 0.943 Test Acc: 0.896
Validation loss decreased (-0.881471 --> -0.896287).  Saving model ...
Epoch: 24 cost time: 0.3918271064758301
Epoch: 24, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.887 Vali Acc: 0.904 Test Loss: 0.887 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
Epoch: 25 cost time: 0.4175901412963867
Epoch: 25, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.834 Vali Acc: 0.900 Test Loss: 0.834 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4360818862915039
Epoch: 26, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.783 Vali Acc: 0.904 Test Loss: 0.783 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903696).  Saving model ...
Epoch: 27 cost time: 0.39101529121398926
Epoch: 27, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.736 Vali Acc: 0.904 Test Loss: 0.736 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 28 cost time: 0.5247879028320312
Epoch: 28, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.693 Vali Acc: 0.915 Test Loss: 0.693 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 29 cost time: 0.44757676124572754
Epoch: 29, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.653 Vali Acc: 0.915 Test Loss: 0.653 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 30 cost time: 0.4391462802886963
Epoch: 30, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.616 Vali Acc: 0.919 Test Loss: 0.616 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 31 cost time: 0.48793816566467285
Epoch: 31, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.582 Vali Acc: 0.922 Test Loss: 0.582 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 32 cost time: 0.4092223644256592
Epoch: 32, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.551 Vali Acc: 0.933 Test Loss: 0.551 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 33 cost time: 0.41028475761413574
Epoch: 33, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.523 Vali Acc: 0.933 Test Loss: 0.523 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 34 cost time: 0.40496087074279785
Epoch: 34, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.497 Vali Acc: 0.933 Test Loss: 0.497 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 35 cost time: 0.46004748344421387
Epoch: 35, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.474 Vali Acc: 0.933 Test Loss: 0.474 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 36 cost time: 0.42267465591430664
Epoch: 36, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.453 Vali Acc: 0.933 Test Loss: 0.453 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 0.4328944683074951
Epoch: 37, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.434 Vali Acc: 0.933 Test Loss: 0.434 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.4375004768371582
Epoch: 38, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.417 Vali Acc: 0.941 Test Loss: 0.417 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 39 cost time: 0.40518832206726074
Epoch: 39, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.401 Vali Acc: 0.941 Test Loss: 0.401 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 40 cost time: 0.46892237663269043
Epoch: 40, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.388 Vali Acc: 0.941 Test Loss: 0.388 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.45099544525146484
Epoch: 41, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.375 Vali Acc: 0.941 Test Loss: 0.375 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.49854373931884766
Epoch: 42, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.4262664318084717
Epoch: 43, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.353 Vali Acc: 0.941 Test Loss: 0.353 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 44 cost time: 0.4325075149536133
Epoch: 44, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.4086265563964844
Epoch: 45, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 46 cost time: 0.41356778144836426
Epoch: 46, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.328 Vali Acc: 0.944 Test Loss: 0.328 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 47 cost time: 0.4032413959503174
Epoch: 47, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 48 cost time: 0.45068979263305664
Epoch: 48, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 49 cost time: 0.46709370613098145
Epoch: 49, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 50 cost time: 0.5391602516174316
Epoch: 50, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 417414
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.853029727935791
Epoch: 1, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.786 Vali Acc: 0.133 Test Loss: 1.786 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.40691423416137695
Epoch: 2, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.778 Vali Acc: 0.189 Test Loss: 1.778 Test Acc: 0.189
Validation loss decreased (-0.133315 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.3887968063354492
Epoch: 3, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.770 Vali Acc: 0.244 Test Loss: 1.770 Test Acc: 0.244
Validation loss decreased (-0.188871 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.46950340270996094
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.758 Vali Acc: 0.267 Test Loss: 1.758 Test Acc: 0.267
Validation loss decreased (-0.244427 --> -0.266649).  Saving model ...
Epoch: 5 cost time: 0.43146705627441406
Epoch: 5, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.743 Vali Acc: 0.289 Test Loss: 1.743 Test Acc: 0.289
Validation loss decreased (-0.266649 --> -0.288871).  Saving model ...
Epoch: 6 cost time: 0.3819448947906494
Epoch: 6, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.723 Vali Acc: 0.367 Test Loss: 1.723 Test Acc: 0.367
Validation loss decreased (-0.288871 --> -0.366649).  Saving model ...
Epoch: 7 cost time: 0.4360027313232422
Epoch: 7, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.699 Vali Acc: 0.444 Test Loss: 1.699 Test Acc: 0.444
Validation loss decreased (-0.366649 --> -0.444427).  Saving model ...
Epoch: 8 cost time: 0.40306758880615234
Epoch: 8, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.670 Vali Acc: 0.541 Test Loss: 1.670 Test Acc: 0.541
Validation loss decreased (-0.444427 --> -0.540724).  Saving model ...
Epoch: 9 cost time: 0.4187629222869873
Epoch: 9, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.638 Vali Acc: 0.670 Test Loss: 1.638 Test Acc: 0.670
Validation loss decreased (-0.540724 --> -0.670354).  Saving model ...
Epoch: 10 cost time: 0.5087885856628418
Epoch: 10, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.601 Vali Acc: 0.741 Test Loss: 1.601 Test Acc: 0.741
Validation loss decreased (-0.670354 --> -0.740725).  Saving model ...
Epoch: 11 cost time: 0.5437870025634766
Epoch: 11, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.560 Vali Acc: 0.767 Test Loss: 1.560 Test Acc: 0.767
Validation loss decreased (-0.740725 --> -0.766651).  Saving model ...
Epoch: 12 cost time: 0.3780643939971924
Epoch: 12, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.515 Vali Acc: 0.807 Test Loss: 1.515 Test Acc: 0.807
Validation loss decreased (-0.766651 --> -0.807392).  Saving model ...
Epoch: 13 cost time: 0.39725446701049805
Epoch: 13, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.466 Vali Acc: 0.822 Test Loss: 1.466 Test Acc: 0.822
Validation loss decreased (-0.807392 --> -0.822208).  Saving model ...
Epoch: 14 cost time: 0.44755005836486816
Epoch: 14, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.413 Vali Acc: 0.837 Test Loss: 1.413 Test Acc: 0.837
Validation loss decreased (-0.822208 --> -0.837023).  Saving model ...
Epoch: 15 cost time: 0.41849422454833984
Epoch: 15, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.358 Vali Acc: 0.859 Test Loss: 1.358 Test Acc: 0.859
Validation loss decreased (-0.837023 --> -0.859246).  Saving model ...
Epoch: 16 cost time: 0.40880799293518066
Epoch: 16, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.300 Vali Acc: 0.874 Test Loss: 1.300 Test Acc: 0.874
Validation loss decreased (-0.859246 --> -0.874061).  Saving model ...
Epoch: 17 cost time: 0.4546966552734375
Epoch: 17, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.241 Vali Acc: 0.881 Test Loss: 1.241 Test Acc: 0.881
Validation loss decreased (-0.874061 --> -0.881469).  Saving model ...
Epoch: 18 cost time: 0.4474141597747803
Epoch: 18, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.180 Vali Acc: 0.900 Test Loss: 1.180 Test Acc: 0.900
Validation loss decreased (-0.881469 --> -0.899988).  Saving model ...
Epoch: 19 cost time: 0.4056892395019531
Epoch: 19, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.117 Vali Acc: 0.915 Test Loss: 1.117 Test Acc: 0.915
Validation loss decreased (-0.899988 --> -0.914804).  Saving model ...
Epoch: 20 cost time: 0.44611382484436035
Epoch: 20, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.053 Vali Acc: 0.919 Test Loss: 1.053 Test Acc: 0.919
Validation loss decreased (-0.914804 --> -0.918508).  Saving model ...
Epoch: 21 cost time: 0.44263458251953125
Epoch: 21, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.990 Vali Acc: 0.919 Test Loss: 0.990 Test Acc: 0.919
Validation loss decreased (-0.918508 --> -0.918509).  Saving model ...
Epoch: 22 cost time: 0.44623899459838867
Epoch: 22, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.927 Vali Acc: 0.926 Test Loss: 0.927 Test Acc: 0.926
Validation loss decreased (-0.918509 --> -0.925917).  Saving model ...
Epoch: 23 cost time: 0.5020918846130371
Epoch: 23, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.866 Vali Acc: 0.937 Test Loss: 0.866 Test Acc: 0.937
Validation loss decreased (-0.925917 --> -0.937028).  Saving model ...
Epoch: 24 cost time: 0.574472188949585
Epoch: 24, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.808 Vali Acc: 0.944 Test Loss: 0.808 Test Acc: 0.944
Validation loss decreased (-0.937028 --> -0.944436).  Saving model ...
Epoch: 25 cost time: 0.3998234272003174
Epoch: 25, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.753 Vali Acc: 0.944 Test Loss: 0.753 Test Acc: 0.944
Validation loss decreased (-0.944436 --> -0.944437).  Saving model ...
Epoch: 26 cost time: 0.47304821014404297
Epoch: 26, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.701 Vali Acc: 0.952 Test Loss: 0.701 Test Acc: 0.952
Validation loss decreased (-0.944437 --> -0.951845).  Saving model ...
Epoch: 27 cost time: 0.3960261344909668
Epoch: 27, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.653 Vali Acc: 0.948 Test Loss: 0.653 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3951444625854492
Epoch: 28, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.609 Vali Acc: 0.952 Test Loss: 0.609 Test Acc: 0.952
Validation loss decreased (-0.951845 --> -0.951846).  Saving model ...
Epoch: 29 cost time: 0.42161011695861816
Epoch: 29, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.568 Vali Acc: 0.956 Test Loss: 0.568 Test Acc: 0.956
Validation loss decreased (-0.951846 --> -0.955550).  Saving model ...
Epoch: 30 cost time: 0.44425320625305176
Epoch: 30, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.531 Vali Acc: 0.956 Test Loss: 0.531 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955550).  Saving model ...
Epoch: 31 cost time: 0.4392554759979248
Epoch: 31, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.498 Vali Acc: 0.956 Test Loss: 0.498 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955551).  Saving model ...
Epoch: 32 cost time: 0.4225482940673828
Epoch: 32, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.467 Vali Acc: 0.956 Test Loss: 0.467 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 33 cost time: 0.4865734577178955
Epoch: 33, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.441 Vali Acc: 0.956 Test Loss: 0.441 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 34 cost time: 0.4223899841308594
Epoch: 34, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.417 Vali Acc: 0.956 Test Loss: 0.417 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 35 cost time: 0.3965644836425781
Epoch: 35, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.396 Vali Acc: 0.956 Test Loss: 0.396 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955552).  Saving model ...
Epoch: 36 cost time: 0.3913712501525879
Epoch: 36, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.376 Vali Acc: 0.956 Test Loss: 0.376 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 37 cost time: 0.5018982887268066
Epoch: 37, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.358 Vali Acc: 0.956 Test Loss: 0.358 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 38 cost time: 0.5065701007843018
Epoch: 38, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.342 Vali Acc: 0.959 Test Loss: 0.342 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 39 cost time: 0.4730193614959717
Epoch: 39, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.328 Vali Acc: 0.959 Test Loss: 0.328 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 40 cost time: 0.4417450428009033
Epoch: 40, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.314 Vali Acc: 0.967 Test Loss: 0.314 Test Acc: 0.967
Validation loss decreased (-0.959256 --> -0.966664).  Saving model ...
Epoch: 41 cost time: 0.4683806896209717
Epoch: 41, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.302 Vali Acc: 0.967 Test Loss: 0.302 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 42 cost time: 0.4007091522216797
Epoch: 42, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.292 Vali Acc: 0.970 Test Loss: 0.292 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.970367).  Saving model ...
Epoch: 43 cost time: 0.43318772315979004
Epoch: 43, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.282 Vali Acc: 0.970 Test Loss: 0.282 Test Acc: 0.970
Validation loss decreased (-0.970367 --> -0.970368).  Saving model ...
Epoch: 44 cost time: 0.4475221633911133
Epoch: 44, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.970 Test Loss: 0.273 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 45 cost time: 0.39125967025756836
Epoch: 45, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.970 Test Loss: 0.265 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 46 cost time: 0.41505956649780273
Epoch: 46, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.258 Vali Acc: 0.970 Test Loss: 0.258 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 47 cost time: 0.4282865524291992
Epoch: 47, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.251 Vali Acc: 0.970 Test Loss: 0.251 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 48 cost time: 0.41234326362609863
Epoch: 48, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.970 Test Loss: 0.246 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 49 cost time: 0.3986976146697998
Epoch: 49, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.240 Vali Acc: 0.970 Test Loss: 0.240 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 50 cost time: 0.5072760581970215
Epoch: 50, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.235 Vali Acc: 0.970 Test Loss: 0.235 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9703703703703703
model parameter : 417510
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5407352447509766
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.794 Vali Acc: 0.230 Test Loss: 1.794 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.41228628158569336
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.788 Vali Acc: 0.270 Test Loss: 1.788 Test Acc: 0.270
Validation loss decreased (-0.229612 --> -0.270352).  Saving model ...
Epoch: 3 cost time: 0.5222935676574707
Epoch: 3, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.782 Vali Acc: 0.281 Test Loss: 1.782 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.5239531993865967
Epoch: 4, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.774 Vali Acc: 0.322 Test Loss: 1.774 Test Acc: 0.322
Validation loss decreased (-0.281464 --> -0.322204).  Saving model ...
Epoch: 5 cost time: 0.41575002670288086
Epoch: 5, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.763 Vali Acc: 0.330 Test Loss: 1.763 Test Acc: 0.330
Validation loss decreased (-0.322204 --> -0.329612).  Saving model ...
Epoch: 6 cost time: 0.4128551483154297
Epoch: 6, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.748 Vali Acc: 0.344 Test Loss: 1.748 Test Acc: 0.344
Validation loss decreased (-0.329612 --> -0.344427).  Saving model ...
Epoch: 7 cost time: 0.43220043182373047
Epoch: 7, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.730 Vali Acc: 0.363 Test Loss: 1.730 Test Acc: 0.363
Validation loss decreased (-0.344427 --> -0.362946).  Saving model ...
Epoch: 8 cost time: 0.38520264625549316
Epoch: 8, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.709 Vali Acc: 0.400 Test Loss: 1.709 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399983).  Saving model ...
Epoch: 9 cost time: 0.4469428062438965
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.684 Vali Acc: 0.474 Test Loss: 1.684 Test Acc: 0.474
Validation loss decreased (-0.399983 --> -0.474057).  Saving model ...
Epoch: 10 cost time: 0.427126407623291
Epoch: 10, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.656 Vali Acc: 0.537 Test Loss: 1.656 Test Acc: 0.537
Validation loss decreased (-0.474057 --> -0.537020).  Saving model ...
Epoch: 11 cost time: 0.4336056709289551
Epoch: 11, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.625 Vali Acc: 0.585 Test Loss: 1.625 Test Acc: 0.585
Validation loss decreased (-0.537020 --> -0.585169).  Saving model ...
Epoch: 12 cost time: 0.4367842674255371
Epoch: 12, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.590 Vali Acc: 0.633 Test Loss: 1.590 Test Acc: 0.633
Validation loss decreased (-0.585169 --> -0.633317).  Saving model ...
Epoch: 13 cost time: 0.4835784435272217
Epoch: 13, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.553 Vali Acc: 0.685 Test Loss: 1.553 Test Acc: 0.685
Validation loss decreased (-0.633317 --> -0.685170).  Saving model ...
Epoch: 14 cost time: 0.4084475040435791
Epoch: 14, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.512 Vali Acc: 0.719 Test Loss: 1.512 Test Acc: 0.719
Validation loss decreased (-0.685170 --> -0.718503).  Saving model ...
Epoch: 15 cost time: 0.46262598037719727
Epoch: 15, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.469 Vali Acc: 0.752 Test Loss: 1.469 Test Acc: 0.752
Validation loss decreased (-0.718503 --> -0.751837).  Saving model ...
Epoch: 16 cost time: 0.4081919193267822
Epoch: 16, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.423 Vali Acc: 0.796 Test Loss: 1.423 Test Acc: 0.796
Validation loss decreased (-0.751837 --> -0.796282).  Saving model ...
Epoch: 17 cost time: 0.4382021427154541
Epoch: 17, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.376 Vali Acc: 0.807 Test Loss: 1.376 Test Acc: 0.807
Validation loss decreased (-0.796282 --> -0.807394).  Saving model ...
Epoch: 18 cost time: 0.4687168598175049
Epoch: 18, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.327 Vali Acc: 0.822 Test Loss: 1.327 Test Acc: 0.822
Validation loss decreased (-0.807394 --> -0.822209).  Saving model ...
Epoch: 19 cost time: 0.4477248191833496
Epoch: 19, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.276 Vali Acc: 0.833 Test Loss: 1.276 Test Acc: 0.833
Validation loss decreased (-0.822209 --> -0.833321).  Saving model ...
Epoch: 20 cost time: 0.5807023048400879
Epoch: 20, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.225 Vali Acc: 0.856 Test Loss: 1.225 Test Acc: 0.856
Validation loss decreased (-0.833321 --> -0.855543).  Saving model ...
Epoch: 21 cost time: 0.6101179122924805
Epoch: 21, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.173 Vali Acc: 0.867 Test Loss: 1.173 Test Acc: 0.867
Validation loss decreased (-0.855543 --> -0.866655).  Saving model ...
Epoch: 22 cost time: 0.44922900199890137
Epoch: 22, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.119 Vali Acc: 0.870 Test Loss: 1.119 Test Acc: 0.870
Validation loss decreased (-0.866655 --> -0.870359).  Saving model ...
Epoch: 23 cost time: 0.4140136241912842
Epoch: 23, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.067 Vali Acc: 0.874 Test Loss: 1.067 Test Acc: 0.874
Validation loss decreased (-0.870359 --> -0.874063).  Saving model ...
Epoch: 24 cost time: 0.5424857139587402
Epoch: 24, Steps: 2 | Train Loss: 0.841 Vali Loss: 1.013 Vali Acc: 0.885 Test Loss: 1.013 Test Acc: 0.885
Validation loss decreased (-0.874063 --> -0.885175).  Saving model ...
Epoch: 25 cost time: 0.4010038375854492
Epoch: 25, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.962 Vali Acc: 0.889 Test Loss: 0.962 Test Acc: 0.889
Validation loss decreased (-0.885175 --> -0.888879).  Saving model ...
Epoch: 26 cost time: 0.41080236434936523
Epoch: 26, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.911 Vali Acc: 0.896 Test Loss: 0.911 Test Acc: 0.896
Validation loss decreased (-0.888879 --> -0.896287).  Saving model ...
Epoch: 27 cost time: 0.4877893924713135
Epoch: 27, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.862 Vali Acc: 0.904 Test Loss: 0.862 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
Epoch: 28 cost time: 0.43660783767700195
Epoch: 28, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.815 Vali Acc: 0.907 Test Loss: 0.815 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 29 cost time: 0.46363306045532227
Epoch: 29, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.770 Vali Acc: 0.915 Test Loss: 0.770 Test Acc: 0.915
Validation loss decreased (-0.907399 --> -0.914807).  Saving model ...
Epoch: 30 cost time: 0.45769190788269043
Epoch: 30, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.728 Vali Acc: 0.915 Test Loss: 0.728 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 31 cost time: 0.49489712715148926
Epoch: 31, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.688 Vali Acc: 0.915 Test Loss: 0.688 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 32 cost time: 0.49501490592956543
Epoch: 32, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.652 Vali Acc: 0.919 Test Loss: 0.652 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 33 cost time: 0.4240860939025879
Epoch: 33, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.617 Vali Acc: 0.922 Test Loss: 0.617 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 34 cost time: 0.4389455318450928
Epoch: 34, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.585 Vali Acc: 0.922 Test Loss: 0.585 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 35 cost time: 0.4044935703277588
Epoch: 35, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.555 Vali Acc: 0.930 Test Loss: 0.555 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 36 cost time: 0.4030601978302002
Epoch: 36, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.527 Vali Acc: 0.933 Test Loss: 0.527 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 37 cost time: 0.4226837158203125
Epoch: 37, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.502 Vali Acc: 0.933 Test Loss: 0.502 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 38 cost time: 0.48680710792541504
Epoch: 38, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.479 Vali Acc: 0.933 Test Loss: 0.479 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.4626142978668213
Epoch: 39, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.457 Vali Acc: 0.933 Test Loss: 0.457 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.558661699295044
Epoch: 40, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.438 Vali Acc: 0.933 Test Loss: 0.438 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 0.5065178871154785
Epoch: 41, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.421 Vali Acc: 0.933 Test Loss: 0.421 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 42 cost time: 0.5869295597076416
Epoch: 42, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.405 Vali Acc: 0.933 Test Loss: 0.405 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 43 cost time: 0.48504209518432617
Epoch: 43, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.389 Vali Acc: 0.933 Test Loss: 0.389 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 44 cost time: 0.5199661254882812
Epoch: 44, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 45 cost time: 0.5960166454315186
Epoch: 45, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.362 Vali Acc: 0.933 Test Loss: 0.362 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 46 cost time: 0.617969274520874
Epoch: 46, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 47 cost time: 0.5716707706451416
Epoch: 47, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.340 Vali Acc: 0.937 Test Loss: 0.340 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 48 cost time: 0.6053836345672607
Epoch: 48, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.5414643287658691
Epoch: 49, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 50 cost time: 0.5648672580718994
Epoch: 50, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 414534
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6669044494628906
Epoch: 1, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.815 Vali Acc: 0.067 Test Loss: 1.815 Test Acc: 0.067
Validation loss decreased (inf --> -0.066649).  Saving model ...
Epoch: 2 cost time: 0.37276339530944824
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.811 Vali Acc: 0.078 Test Loss: 1.811 Test Acc: 0.078
Validation loss decreased (-0.066649 --> -0.077760).  Saving model ...
Epoch: 3 cost time: 0.3717203140258789
Epoch: 3, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.809 Vali Acc: 0.104 Test Loss: 1.809 Test Acc: 0.104
Validation loss decreased (-0.077760 --> -0.103686).  Saving model ...
Epoch: 4 cost time: 0.3839230537414551
Epoch: 4, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.804 Vali Acc: 0.111 Test Loss: 1.804 Test Acc: 0.111
Validation loss decreased (-0.103686 --> -0.111093).  Saving model ...
Epoch: 5 cost time: 0.39258646965026855
Epoch: 5, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.797 Vali Acc: 0.130 Test Loss: 1.797 Test Acc: 0.130
Validation loss decreased (-0.111093 --> -0.129612).  Saving model ...
Epoch: 6 cost time: 0.39196109771728516
Epoch: 6, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.788 Vali Acc: 0.152 Test Loss: 1.788 Test Acc: 0.152
Validation loss decreased (-0.129612 --> -0.151834).  Saving model ...
Epoch: 7 cost time: 0.39789581298828125
Epoch: 7, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.775 Vali Acc: 0.181 Test Loss: 1.775 Test Acc: 0.181
Validation loss decreased (-0.151834 --> -0.181464).  Saving model ...
Epoch: 8 cost time: 0.3984050750732422
Epoch: 8, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.759 Vali Acc: 0.233 Test Loss: 1.759 Test Acc: 0.233
Validation loss decreased (-0.181464 --> -0.233316).  Saving model ...
Epoch: 9 cost time: 0.36872386932373047
Epoch: 9, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.740 Vali Acc: 0.270 Test Loss: 1.740 Test Acc: 0.270
Validation loss decreased (-0.233316 --> -0.270353).  Saving model ...
Epoch: 10 cost time: 0.38858556747436523
Epoch: 10, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.718 Vali Acc: 0.341 Test Loss: 1.718 Test Acc: 0.341
Validation loss decreased (-0.270353 --> -0.340724).  Saving model ...
Epoch: 11 cost time: 0.4190807342529297
Epoch: 11, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.693 Vali Acc: 0.444 Test Loss: 1.693 Test Acc: 0.444
Validation loss decreased (-0.340724 --> -0.444428).  Saving model ...
Epoch: 12 cost time: 0.36162376403808594
Epoch: 12, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.665 Vali Acc: 0.504 Test Loss: 1.665 Test Acc: 0.504
Validation loss decreased (-0.444428 --> -0.503687).  Saving model ...
Epoch: 13 cost time: 0.37212276458740234
Epoch: 13, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.635 Vali Acc: 0.567 Test Loss: 1.635 Test Acc: 0.567
Validation loss decreased (-0.503687 --> -0.566650).  Saving model ...
Epoch: 14 cost time: 0.37650609016418457
Epoch: 14, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.603 Vali Acc: 0.600 Test Loss: 1.603 Test Acc: 0.600
Validation loss decreased (-0.566650 --> -0.599984).  Saving model ...
Epoch: 15 cost time: 0.45798730850219727
Epoch: 15, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.568 Vali Acc: 0.633 Test Loss: 1.568 Test Acc: 0.633
Validation loss decreased (-0.599984 --> -0.633318).  Saving model ...
Epoch: 16 cost time: 0.4748976230621338
Epoch: 16, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.532 Vali Acc: 0.663 Test Loss: 1.532 Test Acc: 0.663
Validation loss decreased (-0.633318 --> -0.662948).  Saving model ...
Epoch: 17 cost time: 0.48551058769226074
Epoch: 17, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.494 Vali Acc: 0.700 Test Loss: 1.494 Test Acc: 0.700
Validation loss decreased (-0.662948 --> -0.699985).  Saving model ...
Epoch: 18 cost time: 0.4124720096588135
Epoch: 18, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.454 Vali Acc: 0.719 Test Loss: 1.454 Test Acc: 0.719
Validation loss decreased (-0.699985 --> -0.718504).  Saving model ...
Epoch: 19 cost time: 0.41719627380371094
Epoch: 19, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.414 Vali Acc: 0.722 Test Loss: 1.414 Test Acc: 0.722
Validation loss decreased (-0.718504 --> -0.722208).  Saving model ...
Epoch: 20 cost time: 0.40668821334838867
Epoch: 20, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.373 Vali Acc: 0.759 Test Loss: 1.373 Test Acc: 0.759
Validation loss decreased (-0.722208 --> -0.759246).  Saving model ...
Epoch: 21 cost time: 0.40914082527160645
Epoch: 21, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.332 Vali Acc: 0.781 Test Loss: 1.332 Test Acc: 0.781
Validation loss decreased (-0.759246 --> -0.781468).  Saving model ...
Epoch: 22 cost time: 0.4030635356903076
Epoch: 22, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.290 Vali Acc: 0.811 Test Loss: 1.290 Test Acc: 0.811
Validation loss decreased (-0.781468 --> -0.811098).  Saving model ...
Epoch: 23 cost time: 0.5190298557281494
Epoch: 23, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.247 Vali Acc: 0.830 Test Loss: 1.247 Test Acc: 0.830
Validation loss decreased (-0.811098 --> -0.829617).  Saving model ...
Epoch: 24 cost time: 0.41904711723327637
Epoch: 24, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.204 Vali Acc: 0.844 Test Loss: 1.204 Test Acc: 0.844
Validation loss decreased (-0.829617 --> -0.844432).  Saving model ...
Epoch: 25 cost time: 0.42862415313720703
Epoch: 25, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.161 Vali Acc: 0.867 Test Loss: 1.161 Test Acc: 0.867
Validation loss decreased (-0.844432 --> -0.866655).  Saving model ...
Epoch: 26 cost time: 0.3967752456665039
Epoch: 26, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.119 Vali Acc: 0.874 Test Loss: 1.119 Test Acc: 0.874
Validation loss decreased (-0.866655 --> -0.874063).  Saving model ...
Epoch: 27 cost time: 0.4037744998931885
Epoch: 27, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.077 Vali Acc: 0.881 Test Loss: 1.077 Test Acc: 0.881
Validation loss decreased (-0.874063 --> -0.881471).  Saving model ...
Epoch: 28 cost time: 0.4111642837524414
Epoch: 28, Steps: 2 | Train Loss: 0.792 Vali Loss: 1.034 Vali Acc: 0.900 Test Loss: 1.034 Test Acc: 0.900
Validation loss decreased (-0.881471 --> -0.899990).  Saving model ...
Epoch: 29 cost time: 0.44176554679870605
Epoch: 29, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.993 Vali Acc: 0.900 Test Loss: 0.993 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899990).  Saving model ...
Epoch: 30 cost time: 0.4176175594329834
Epoch: 30, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.954 Vali Acc: 0.900 Test Loss: 0.954 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899990).  Saving model ...
Epoch: 31 cost time: 0.4040215015411377
Epoch: 31, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.915 Vali Acc: 0.904 Test Loss: 0.915 Test Acc: 0.904
Validation loss decreased (-0.899990 --> -0.903695).  Saving model ...
Epoch: 32 cost time: 0.41501927375793457
Epoch: 32, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.877 Vali Acc: 0.900 Test Loss: 0.877 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4029810428619385
Epoch: 33, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.840 Vali Acc: 0.900 Test Loss: 0.840 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.42191410064697266
Epoch: 34, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.805 Vali Acc: 0.900 Test Loss: 0.805 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.416140079498291
Epoch: 35, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.771 Vali Acc: 0.907 Test Loss: 0.771 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907400).  Saving model ...
Epoch: 36 cost time: 0.4036283493041992
Epoch: 36, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.738 Vali Acc: 0.907 Test Loss: 0.738 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 37 cost time: 0.4085228443145752
Epoch: 37, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.707 Vali Acc: 0.915 Test Loss: 0.707 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 38 cost time: 0.40547728538513184
Epoch: 38, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.677 Vali Acc: 0.915 Test Loss: 0.677 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 39 cost time: 0.3946850299835205
Epoch: 39, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.650 Vali Acc: 0.915 Test Loss: 0.650 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 40 cost time: 0.43892788887023926
Epoch: 40, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.623 Vali Acc: 0.915 Test Loss: 0.623 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 41 cost time: 0.4353008270263672
Epoch: 41, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.599 Vali Acc: 0.922 Test Loss: 0.599 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922216).  Saving model ...
Epoch: 42 cost time: 0.39714622497558594
Epoch: 42, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.576 Vali Acc: 0.922 Test Loss: 0.576 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 43 cost time: 0.4487183094024658
Epoch: 43, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.554 Vali Acc: 0.922 Test Loss: 0.554 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 44 cost time: 0.3888845443725586
Epoch: 44, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.534 Vali Acc: 0.926 Test Loss: 0.534 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 45 cost time: 0.4085829257965088
Epoch: 45, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.516 Vali Acc: 0.922 Test Loss: 0.516 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4425640106201172
Epoch: 46, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.499 Vali Acc: 0.926 Test Loss: 0.499 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 47 cost time: 0.48868489265441895
Epoch: 47, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.483 Vali Acc: 0.922 Test Loss: 0.483 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.39826250076293945
Epoch: 48, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.468 Vali Acc: 0.922 Test Loss: 0.468 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.38271093368530273
Epoch: 49, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.454 Vali Acc: 0.922 Test Loss: 0.454 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.3827090263366699
Epoch: 50, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.440 Vali Acc: 0.926 Test Loss: 0.440 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 411590
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6409342288970947
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.754 Vali Acc: 0.211 Test Loss: 1.754 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.39550185203552246
Epoch: 2, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.740 Vali Acc: 0.267 Test Loss: 1.740 Test Acc: 0.267
Validation loss decreased (-0.211094 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.41211891174316406
Epoch: 3, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.724 Vali Acc: 0.289 Test Loss: 1.724 Test Acc: 0.289
Validation loss decreased (-0.266649 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.3727388381958008
Epoch: 4, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.698 Vali Acc: 0.359 Test Loss: 1.698 Test Acc: 0.359
Validation loss decreased (-0.288872 --> -0.359242).  Saving model ...
Epoch: 5 cost time: 0.43355560302734375
Epoch: 5, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.661 Vali Acc: 0.459 Test Loss: 1.661 Test Acc: 0.459
Validation loss decreased (-0.359242 --> -0.459243).  Saving model ...
Epoch: 6 cost time: 0.4122655391693115
Epoch: 6, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.612 Vali Acc: 0.678 Test Loss: 1.612 Test Acc: 0.678
Validation loss decreased (-0.459243 --> -0.677762).  Saving model ...
Epoch: 7 cost time: 0.3866851329803467
Epoch: 7, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.553 Vali Acc: 0.815 Test Loss: 1.553 Test Acc: 0.815
Validation loss decreased (-0.677762 --> -0.814799).  Saving model ...
Epoch: 8 cost time: 0.4043576717376709
Epoch: 8, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.483 Vali Acc: 0.870 Test Loss: 1.483 Test Acc: 0.870
Validation loss decreased (-0.814799 --> -0.870356).  Saving model ...
Epoch: 9 cost time: 0.44148969650268555
Epoch: 9, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.404 Vali Acc: 0.889 Test Loss: 1.404 Test Acc: 0.889
Validation loss decreased (-0.870356 --> -0.888875).  Saving model ...
Epoch: 10 cost time: 0.43636560440063477
Epoch: 10, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.314 Vali Acc: 0.893 Test Loss: 1.314 Test Acc: 0.893
Validation loss decreased (-0.888875 --> -0.892579).  Saving model ...
Epoch: 11 cost time: 0.4060077667236328
Epoch: 11, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.216 Vali Acc: 0.922 Test Loss: 1.216 Test Acc: 0.922
Validation loss decreased (-0.892579 --> -0.922210).  Saving model ...
Epoch: 12 cost time: 0.4712991714477539
Epoch: 12, Steps: 2 | Train Loss: 0.866 Vali Loss: 1.112 Vali Acc: 0.944 Test Loss: 1.112 Test Acc: 0.944
Validation loss decreased (-0.922210 --> -0.944433).  Saving model ...
Epoch: 13 cost time: 0.4050018787384033
Epoch: 13, Steps: 2 | Train Loss: 0.770 Vali Loss: 1.003 Vali Acc: 0.948 Test Loss: 1.003 Test Acc: 0.948
Validation loss decreased (-0.944433 --> -0.948138).  Saving model ...
Epoch: 14 cost time: 0.4210069179534912
Epoch: 14, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.893 Vali Acc: 0.941 Test Loss: 0.893 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3896756172180176
Epoch: 15, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.787 Vali Acc: 0.937 Test Loss: 0.787 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3913586139678955
Epoch: 16, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.687 Vali Acc: 0.944 Test Loss: 0.687 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4145009517669678
Epoch: 17, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.596 Vali Acc: 0.944 Test Loss: 0.596 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.38437724113464355
Epoch: 18, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.515 Vali Acc: 0.944 Test Loss: 0.515 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3924849033355713
Epoch: 19, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.446 Vali Acc: 0.944 Test Loss: 0.446 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.41735029220581055
Epoch: 20, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.388 Vali Acc: 0.948 Test Loss: 0.388 Test Acc: 0.948
Validation loss decreased (-0.948138 --> -0.948144).  Saving model ...
Epoch: 21 cost time: 0.394305944442749
Epoch: 21, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.342 Vali Acc: 0.948 Test Loss: 0.342 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.5268118381500244
Epoch: 22, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.303 Vali Acc: 0.948 Test Loss: 0.303 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 23 cost time: 0.38400983810424805
Epoch: 23, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.4344301223754883
Epoch: 24, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.956 Test Loss: 0.248 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.41034364700317383
Epoch: 25, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.41734862327575684
Epoch: 26, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.4621546268463135
Epoch: 27, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.4453270435333252
Epoch: 28, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.41881775856018066
Epoch: 29, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.41428399085998535
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.4455301761627197
Epoch: 31, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.44086170196533203
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4081711769104004
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4220588207244873
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4295196533203125
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.39333438873291016
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.42624640464782715
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.41817402839660645
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.373441219329834
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.395876407623291
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 453606
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5692694187164307
Epoch: 1, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.802 Vali Acc: 0.167 Test Loss: 1.802 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.38870835304260254
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.793 Vali Acc: 0.193 Test Loss: 1.793 Test Acc: 0.193
Validation loss decreased (-0.166649 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.4376180171966553
Epoch: 3, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.782 Vali Acc: 0.248 Test Loss: 1.782 Test Acc: 0.248
Validation loss decreased (-0.192575 --> -0.248130).  Saving model ...
Epoch: 4 cost time: 0.41018104553222656
Epoch: 4, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.767 Vali Acc: 0.304 Test Loss: 1.767 Test Acc: 0.304
Validation loss decreased (-0.248130 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.41013121604919434
Epoch: 5, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.746 Vali Acc: 0.356 Test Loss: 1.746 Test Acc: 0.356
Validation loss decreased (-0.303686 --> -0.355538).  Saving model ...
Epoch: 6 cost time: 0.44229888916015625
Epoch: 6, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.719 Vali Acc: 0.459 Test Loss: 1.719 Test Acc: 0.459
Validation loss decreased (-0.355538 --> -0.459242).  Saving model ...
Epoch: 7 cost time: 0.43019914627075195
Epoch: 7, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.684 Vali Acc: 0.552 Test Loss: 1.684 Test Acc: 0.552
Validation loss decreased (-0.459242 --> -0.551835).  Saving model ...
Epoch: 8 cost time: 0.4381701946258545
Epoch: 8, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.643 Vali Acc: 0.637 Test Loss: 1.643 Test Acc: 0.637
Validation loss decreased (-0.551835 --> -0.637021).  Saving model ...
Epoch: 9 cost time: 0.4933328628540039
Epoch: 9, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.594 Vali Acc: 0.685 Test Loss: 1.594 Test Acc: 0.685
Validation loss decreased (-0.637021 --> -0.685169).  Saving model ...
Epoch: 10 cost time: 0.4006633758544922
Epoch: 10, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.538 Vali Acc: 0.733 Test Loss: 1.538 Test Acc: 0.733
Validation loss decreased (-0.685169 --> -0.733318).  Saving model ...
Epoch: 11 cost time: 0.394803524017334
Epoch: 11, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.476 Vali Acc: 0.759 Test Loss: 1.476 Test Acc: 0.759
Validation loss decreased (-0.733318 --> -0.759245).  Saving model ...
Epoch: 12 cost time: 0.4509897232055664
Epoch: 12, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.406 Vali Acc: 0.796 Test Loss: 1.406 Test Acc: 0.796
Validation loss decreased (-0.759245 --> -0.796282).  Saving model ...
Epoch: 13 cost time: 0.3893857002258301
Epoch: 13, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.331 Vali Acc: 0.822 Test Loss: 1.331 Test Acc: 0.822
Validation loss decreased (-0.796282 --> -0.822209).  Saving model ...
Epoch: 14 cost time: 0.3864576816558838
Epoch: 14, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.250 Vali Acc: 0.852 Test Loss: 1.250 Test Acc: 0.852
Validation loss decreased (-0.822209 --> -0.851839).  Saving model ...
Epoch: 15 cost time: 0.4302029609680176
Epoch: 15, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.165 Vali Acc: 0.874 Test Loss: 1.165 Test Acc: 0.874
Validation loss decreased (-0.851839 --> -0.874062).  Saving model ...
Epoch: 16 cost time: 0.434572696685791
Epoch: 16, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.078 Vali Acc: 0.881 Test Loss: 1.078 Test Acc: 0.881
Validation loss decreased (-0.874062 --> -0.881471).  Saving model ...
Epoch: 17 cost time: 0.40853142738342285
Epoch: 17, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.990 Vali Acc: 0.885 Test Loss: 0.990 Test Acc: 0.885
Validation loss decreased (-0.881471 --> -0.885175).  Saving model ...
Epoch: 18 cost time: 0.4481053352355957
Epoch: 18, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.905 Vali Acc: 0.889 Test Loss: 0.905 Test Acc: 0.889
Validation loss decreased (-0.885175 --> -0.888880).  Saving model ...
Epoch: 19 cost time: 0.5255937576293945
Epoch: 19, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.823 Vali Acc: 0.896 Test Loss: 0.823 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 20 cost time: 0.47481417655944824
Epoch: 20, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.747 Vali Acc: 0.907 Test Loss: 0.747 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 21 cost time: 0.44177913665771484
Epoch: 21, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.676 Vali Acc: 0.919 Test Loss: 0.676 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 22 cost time: 0.4152843952178955
Epoch: 22, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.613 Vali Acc: 0.919 Test Loss: 0.613 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 23 cost time: 0.4219706058502197
Epoch: 23, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.559 Vali Acc: 0.919 Test Loss: 0.559 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.3911170959472656
Epoch: 24, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.510 Vali Acc: 0.919 Test Loss: 0.510 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.4232172966003418
Epoch: 25, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.466 Vali Acc: 0.915 Test Loss: 0.466 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.45609188079833984
Epoch: 26, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.431 Vali Acc: 0.915 Test Loss: 0.431 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4162170886993408
Epoch: 27, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.399 Vali Acc: 0.915 Test Loss: 0.399 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.3877675533294678
Epoch: 28, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 0.39401936531066895
Epoch: 29, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.350 Vali Acc: 0.926 Test Loss: 0.350 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.4546935558319092
Epoch: 30, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.331 Vali Acc: 0.926 Test Loss: 0.331 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 31 cost time: 0.42354369163513184
Epoch: 31, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.4173128604888916
Epoch: 32, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.4370274543762207
Epoch: 33, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.42318081855773926
Epoch: 34, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.39780688285827637
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.44070005416870117
Epoch: 36, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.42310476303100586
Epoch: 37, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.41550660133361816
Epoch: 38, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.4130887985229492
Epoch: 39, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.4203794002532959
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.4786825180053711
Epoch: 41, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.4152867794036865
Epoch: 42, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4290947914123535
Epoch: 43, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.3912675380706787
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.42770862579345703
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.46395230293273926
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.4404597282409668
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.47093749046325684
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.4505641460418701
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.3988339900970459
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 426022
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7794451713562012
Epoch: 1, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.751 Vali Acc: 0.359 Test Loss: 1.751 Test Acc: 0.359
Validation loss decreased (inf --> -0.359242).  Saving model ...
Epoch: 2 cost time: 0.44316816329956055
Epoch: 2, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.740 Vali Acc: 0.411 Test Loss: 1.740 Test Acc: 0.411
Validation loss decreased (-0.359242 --> -0.411094).  Saving model ...
Epoch: 3 cost time: 0.44883084297180176
Epoch: 3, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.729 Vali Acc: 0.444 Test Loss: 1.729 Test Acc: 0.444
Validation loss decreased (-0.411094 --> -0.444427).  Saving model ...
Epoch: 4 cost time: 0.49112963676452637
Epoch: 4, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.715 Vali Acc: 0.441 Test Loss: 1.715 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3840160369873047
Epoch: 5, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.695 Vali Acc: 0.467 Test Loss: 1.695 Test Acc: 0.467
Validation loss decreased (-0.444427 --> -0.466650).  Saving model ...
Epoch: 6 cost time: 0.39980006217956543
Epoch: 6, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.669 Vali Acc: 0.481 Test Loss: 1.669 Test Acc: 0.481
Validation loss decreased (-0.466650 --> -0.481465).  Saving model ...
Epoch: 7 cost time: 0.44820261001586914
Epoch: 7, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.639 Vali Acc: 0.522 Test Loss: 1.639 Test Acc: 0.522
Validation loss decreased (-0.481465 --> -0.522206).  Saving model ...
Epoch: 8 cost time: 0.4664170742034912
Epoch: 8, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.603 Vali Acc: 0.581 Test Loss: 1.603 Test Acc: 0.581
Validation loss decreased (-0.522206 --> -0.581465).  Saving model ...
Epoch: 9 cost time: 0.4639565944671631
Epoch: 9, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.562 Vali Acc: 0.633 Test Loss: 1.562 Test Acc: 0.633
Validation loss decreased (-0.581465 --> -0.633318).  Saving model ...
Epoch: 10 cost time: 0.42415666580200195
Epoch: 10, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.516 Vali Acc: 0.678 Test Loss: 1.516 Test Acc: 0.678
Validation loss decreased (-0.633318 --> -0.677763).  Saving model ...
Epoch: 11 cost time: 0.45319342613220215
Epoch: 11, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.465 Vali Acc: 0.715 Test Loss: 1.465 Test Acc: 0.715
Validation loss decreased (-0.677763 --> -0.714800).  Saving model ...
Epoch: 12 cost time: 0.41800618171691895
Epoch: 12, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.409 Vali Acc: 0.759 Test Loss: 1.409 Test Acc: 0.759
Validation loss decreased (-0.714800 --> -0.759245).  Saving model ...
Epoch: 13 cost time: 0.39040708541870117
Epoch: 13, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.348 Vali Acc: 0.796 Test Loss: 1.348 Test Acc: 0.796
Validation loss decreased (-0.759245 --> -0.796283).  Saving model ...
Epoch: 14 cost time: 0.43459129333496094
Epoch: 14, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.283 Vali Acc: 0.830 Test Loss: 1.283 Test Acc: 0.830
Validation loss decreased (-0.796283 --> -0.829617).  Saving model ...
Epoch: 15 cost time: 0.4351043701171875
Epoch: 15, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.214 Vali Acc: 0.863 Test Loss: 1.214 Test Acc: 0.863
Validation loss decreased (-0.829617 --> -0.862951).  Saving model ...
Epoch: 16 cost time: 0.40283894538879395
Epoch: 16, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.144 Vali Acc: 0.878 Test Loss: 1.144 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877766).  Saving model ...
Epoch: 17 cost time: 0.411571741104126
Epoch: 17, Steps: 2 | Train Loss: 0.888 Vali Loss: 1.072 Vali Acc: 0.889 Test Loss: 1.072 Test Acc: 0.889
Validation loss decreased (-0.877766 --> -0.888878).  Saving model ...
Epoch: 18 cost time: 0.3995215892791748
Epoch: 18, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.000 Vali Acc: 0.896 Test Loss: 1.000 Test Acc: 0.896
Validation loss decreased (-0.888878 --> -0.896286).  Saving model ...
Epoch: 19 cost time: 0.4221982955932617
Epoch: 19, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.928 Vali Acc: 0.907 Test Loss: 0.928 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907398).  Saving model ...
Epoch: 20 cost time: 0.41748619079589844
Epoch: 20, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.857 Vali Acc: 0.919 Test Loss: 0.857 Test Acc: 0.919
Validation loss decreased (-0.907398 --> -0.918510).  Saving model ...
Epoch: 21 cost time: 0.438568115234375
Epoch: 21, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.789 Vali Acc: 0.926 Test Loss: 0.789 Test Acc: 0.926
Validation loss decreased (-0.918510 --> -0.925918).  Saving model ...
Epoch: 22 cost time: 0.4286916255950928
Epoch: 22, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.726 Vali Acc: 0.933 Test Loss: 0.726 Test Acc: 0.933
Validation loss decreased (-0.925918 --> -0.933326).  Saving model ...
Epoch: 23 cost time: 0.42241644859313965
Epoch: 23, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.668 Vali Acc: 0.933 Test Loss: 0.668 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933327).  Saving model ...
Epoch: 24 cost time: 0.44975972175598145
Epoch: 24, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.615 Vali Acc: 0.937 Test Loss: 0.615 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 25 cost time: 0.41979193687438965
Epoch: 25, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.566 Vali Acc: 0.937 Test Loss: 0.566 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 26 cost time: 0.42157435417175293
Epoch: 26, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.523 Vali Acc: 0.937 Test Loss: 0.523 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 27 cost time: 0.43473172187805176
Epoch: 27, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.485 Vali Acc: 0.937 Test Loss: 0.485 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 28 cost time: 0.40639543533325195
Epoch: 28, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.450 Vali Acc: 0.944 Test Loss: 0.450 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 29 cost time: 0.4576878547668457
Epoch: 29, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.420 Vali Acc: 0.944 Test Loss: 0.420 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 30 cost time: 0.44667625427246094
Epoch: 30, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.393 Vali Acc: 0.948 Test Loss: 0.393 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 31 cost time: 0.5057814121246338
Epoch: 31, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.369 Vali Acc: 0.948 Test Loss: 0.369 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 32 cost time: 0.4318668842315674
Epoch: 32, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.348 Vali Acc: 0.952 Test Loss: 0.348 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 33 cost time: 0.43100690841674805
Epoch: 33, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.330 Vali Acc: 0.956 Test Loss: 0.330 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 34 cost time: 0.42232346534729004
Epoch: 34, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.314 Vali Acc: 0.956 Test Loss: 0.314 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 35 cost time: 0.41006946563720703
Epoch: 35, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.956 Test Loss: 0.300 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.4802834987640381
Epoch: 36, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.287 Vali Acc: 0.956 Test Loss: 0.287 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.4351015090942383
Epoch: 37, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.276 Vali Acc: 0.956 Test Loss: 0.276 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.44171929359436035
Epoch: 38, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.267 Vali Acc: 0.956 Test Loss: 0.267 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.4548196792602539
Epoch: 39, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.258 Vali Acc: 0.956 Test Loss: 0.258 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.4537999629974365
Epoch: 40, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.5121803283691406
Epoch: 41, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.4100759029388428
Epoch: 42, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.238 Vali Acc: 0.956 Test Loss: 0.238 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.4220435619354248
Epoch: 43, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.43036890029907227
Epoch: 44, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.39515233039855957
Epoch: 45, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.5465588569641113
Epoch: 46, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.4137403964996338
Epoch: 47, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.959 Test Loss: 0.216 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.3847846984863281
Epoch: 48, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.213 Vali Acc: 0.959 Test Loss: 0.213 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.4207286834716797
Epoch: 49, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.5060853958129883
Epoch: 50, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 419910
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8012666702270508
Epoch: 1, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.801 Vali Acc: 0.107 Test Loss: 1.801 Test Acc: 0.107
Validation loss decreased (inf --> -0.107389).  Saving model ...
Epoch: 2 cost time: 0.4449503421783447
Epoch: 2, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.794 Vali Acc: 0.122 Test Loss: 1.794 Test Acc: 0.122
Validation loss decreased (-0.107389 --> -0.122204).  Saving model ...
Epoch: 3 cost time: 0.47864723205566406
Epoch: 3, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.787 Vali Acc: 0.137 Test Loss: 1.787 Test Acc: 0.137
Validation loss decreased (-0.122204 --> -0.137019).  Saving model ...
Epoch: 4 cost time: 0.4211242198944092
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.778 Vali Acc: 0.170 Test Loss: 1.778 Test Acc: 0.170
Validation loss decreased (-0.137019 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.39266371726989746
Epoch: 5, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.765 Vali Acc: 0.226 Test Loss: 1.765 Test Acc: 0.226
Validation loss decreased (-0.170353 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 0.42037224769592285
Epoch: 6, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.749 Vali Acc: 0.300 Test Loss: 1.749 Test Acc: 0.300
Validation loss decreased (-0.225908 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 0.41976237297058105
Epoch: 7, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.729 Vali Acc: 0.322 Test Loss: 1.729 Test Acc: 0.322
Validation loss decreased (-0.299983 --> -0.322205).  Saving model ...
Epoch: 8 cost time: 0.4672122001647949
Epoch: 8, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.705 Vali Acc: 0.374 Test Loss: 1.705 Test Acc: 0.374
Validation loss decreased (-0.322205 --> -0.374057).  Saving model ...
Epoch: 9 cost time: 0.3975241184234619
Epoch: 9, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.677 Vali Acc: 0.411 Test Loss: 1.677 Test Acc: 0.411
Validation loss decreased (-0.374057 --> -0.411094).  Saving model ...
Epoch: 10 cost time: 0.4366159439086914
Epoch: 10, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.645 Vali Acc: 0.456 Test Loss: 1.645 Test Acc: 0.456
Validation loss decreased (-0.411094 --> -0.455539).  Saving model ...
Epoch: 11 cost time: 0.4005298614501953
Epoch: 11, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.609 Vali Acc: 0.489 Test Loss: 1.609 Test Acc: 0.489
Validation loss decreased (-0.455539 --> -0.488873).  Saving model ...
Epoch: 12 cost time: 0.4180283546447754
Epoch: 12, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.569 Vali Acc: 0.537 Test Loss: 1.569 Test Acc: 0.537
Validation loss decreased (-0.488873 --> -0.537021).  Saving model ...
Epoch: 13 cost time: 0.4250049591064453
Epoch: 13, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.526 Vali Acc: 0.593 Test Loss: 1.526 Test Acc: 0.593
Validation loss decreased (-0.537021 --> -0.592577).  Saving model ...
Epoch: 14 cost time: 0.4325587749481201
Epoch: 14, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.479 Vali Acc: 0.644 Test Loss: 1.479 Test Acc: 0.644
Validation loss decreased (-0.592577 --> -0.644430).  Saving model ...
Epoch: 15 cost time: 0.3519449234008789
Epoch: 15, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.429 Vali Acc: 0.659 Test Loss: 1.429 Test Acc: 0.659
Validation loss decreased (-0.644430 --> -0.659245).  Saving model ...
Epoch: 16 cost time: 0.3911118507385254
Epoch: 16, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.377 Vali Acc: 0.707 Test Loss: 1.377 Test Acc: 0.707
Validation loss decreased (-0.659245 --> -0.707394).  Saving model ...
Epoch: 17 cost time: 0.37998080253601074
Epoch: 17, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.321 Vali Acc: 0.744 Test Loss: 1.321 Test Acc: 0.744
Validation loss decreased (-0.707394 --> -0.744431).  Saving model ...
Epoch: 18 cost time: 0.4151632785797119
Epoch: 18, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.264 Vali Acc: 0.778 Test Loss: 1.264 Test Acc: 0.778
Validation loss decreased (-0.744431 --> -0.777765).  Saving model ...
Epoch: 19 cost time: 0.43146729469299316
Epoch: 19, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.205 Vali Acc: 0.807 Test Loss: 1.205 Test Acc: 0.807
Validation loss decreased (-0.777765 --> -0.807395).  Saving model ...
Epoch: 20 cost time: 0.4892144203186035
Epoch: 20, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.146 Vali Acc: 0.826 Test Loss: 1.146 Test Acc: 0.826
Validation loss decreased (-0.807395 --> -0.825914).  Saving model ...
Epoch: 21 cost time: 0.40902066230773926
Epoch: 21, Steps: 2 | Train Loss: 0.839 Vali Loss: 1.087 Vali Acc: 0.833 Test Loss: 1.087 Test Acc: 0.833
Validation loss decreased (-0.825914 --> -0.833322).  Saving model ...
Epoch: 22 cost time: 0.3908882141113281
Epoch: 22, Steps: 2 | Train Loss: 0.777 Vali Loss: 1.028 Vali Acc: 0.841 Test Loss: 1.028 Test Acc: 0.841
Validation loss decreased (-0.833322 --> -0.840730).  Saving model ...
Epoch: 23 cost time: 0.40535855293273926
Epoch: 23, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.971 Vali Acc: 0.848 Test Loss: 0.971 Test Acc: 0.848
Validation loss decreased (-0.840730 --> -0.848138).  Saving model ...
Epoch: 24 cost time: 0.5498907566070557
Epoch: 24, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.915 Vali Acc: 0.859 Test Loss: 0.915 Test Acc: 0.859
Validation loss decreased (-0.848138 --> -0.859250).  Saving model ...
Epoch: 25 cost time: 0.3970918655395508
Epoch: 25, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.862 Vali Acc: 0.859 Test Loss: 0.862 Test Acc: 0.859
Validation loss decreased (-0.859250 --> -0.859251).  Saving model ...
Epoch: 26 cost time: 0.4210801124572754
Epoch: 26, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.811 Vali Acc: 0.878 Test Loss: 0.811 Test Acc: 0.878
Validation loss decreased (-0.859251 --> -0.877770).  Saving model ...
Epoch: 27 cost time: 0.3711521625518799
Epoch: 27, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.763 Vali Acc: 0.881 Test Loss: 0.763 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 28 cost time: 0.49866747856140137
Epoch: 28, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.719 Vali Acc: 0.889 Test Loss: 0.719 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 29 cost time: 0.386765718460083
Epoch: 29, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.677 Vali Acc: 0.893 Test Loss: 0.677 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 30 cost time: 0.4931907653808594
Epoch: 30, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 0.4926638603210449
Epoch: 31, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.604 Vali Acc: 0.904 Test Loss: 0.604 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 32 cost time: 0.41002988815307617
Epoch: 32, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.572 Vali Acc: 0.907 Test Loss: 0.572 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 33 cost time: 0.4052736759185791
Epoch: 33, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.543 Vali Acc: 0.907 Test Loss: 0.543 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 34 cost time: 0.413283109664917
Epoch: 34, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.517 Vali Acc: 0.915 Test Loss: 0.517 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 35 cost time: 0.4298222064971924
Epoch: 35, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.493 Vali Acc: 0.922 Test Loss: 0.493 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922217).  Saving model ...
Epoch: 36 cost time: 0.4380505084991455
Epoch: 36, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.471 Vali Acc: 0.922 Test Loss: 0.471 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 37 cost time: 0.4236111640930176
Epoch: 37, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.451 Vali Acc: 0.926 Test Loss: 0.451 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925921).  Saving model ...
Epoch: 38 cost time: 0.3995213508605957
Epoch: 38, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.433 Vali Acc: 0.926 Test Loss: 0.433 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 39 cost time: 0.36836671829223633
Epoch: 39, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.417 Vali Acc: 0.926 Test Loss: 0.417 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 40 cost time: 0.48323655128479004
Epoch: 40, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.402 Vali Acc: 0.937 Test Loss: 0.402 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937033).  Saving model ...
Epoch: 41 cost time: 0.4281935691833496
Epoch: 41, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.389 Vali Acc: 0.937 Test Loss: 0.389 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 42 cost time: 0.4348435401916504
Epoch: 42, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.3579401969909668
Epoch: 43, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.367 Vali Acc: 0.937 Test Loss: 0.367 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 44 cost time: 0.36350536346435547
Epoch: 44, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.38576412200927734
Epoch: 45, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 46 cost time: 0.37955427169799805
Epoch: 46, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 47 cost time: 0.39399003982543945
Epoch: 47, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 48 cost time: 0.3897223472595215
Epoch: 48, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 49 cost time: 0.48822951316833496
Epoch: 49, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.4450807571411133
Epoch: 50, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 413830
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.731644630432129
Epoch: 1, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.829 Vali Acc: 0.022 Test Loss: 1.829 Test Acc: 0.022
Validation loss decreased (inf --> -0.022204).  Saving model ...
Epoch: 2 cost time: 0.4280233383178711
Epoch: 2, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.824 Vali Acc: 0.030 Test Loss: 1.824 Test Acc: 0.030
Validation loss decreased (-0.022204 --> -0.029611).  Saving model ...
Epoch: 3 cost time: 0.4239058494567871
Epoch: 3, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.820 Vali Acc: 0.052 Test Loss: 1.820 Test Acc: 0.052
Validation loss decreased (-0.029611 --> -0.051834).  Saving model ...
Epoch: 4 cost time: 0.3810896873474121
Epoch: 4, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.812 Vali Acc: 0.067 Test Loss: 1.812 Test Acc: 0.067
Validation loss decreased (-0.051834 --> -0.066649).  Saving model ...
Epoch: 5 cost time: 0.4498882293701172
Epoch: 5, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.801 Vali Acc: 0.104 Test Loss: 1.801 Test Acc: 0.104
Validation loss decreased (-0.066649 --> -0.103686).  Saving model ...
Epoch: 6 cost time: 0.42858266830444336
Epoch: 6, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.785 Vali Acc: 0.159 Test Loss: 1.785 Test Acc: 0.159
Validation loss decreased (-0.103686 --> -0.159241).  Saving model ...
Epoch: 7 cost time: 0.48476433753967285
Epoch: 7, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.764 Vali Acc: 0.230 Test Loss: 1.764 Test Acc: 0.230
Validation loss decreased (-0.159241 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 0.4330742359161377
Epoch: 8, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.739 Vali Acc: 0.333 Test Loss: 1.739 Test Acc: 0.333
Validation loss decreased (-0.229612 --> -0.333316).  Saving model ...
Epoch: 9 cost time: 0.42801499366760254
Epoch: 9, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.709 Vali Acc: 0.456 Test Loss: 1.709 Test Acc: 0.456
Validation loss decreased (-0.333316 --> -0.455538).  Saving model ...
Epoch: 10 cost time: 0.4237825870513916
Epoch: 10, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.675 Vali Acc: 0.559 Test Loss: 1.675 Test Acc: 0.559
Validation loss decreased (-0.455538 --> -0.559243).  Saving model ...
Epoch: 11 cost time: 0.4255990982055664
Epoch: 11, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.637 Vali Acc: 0.644 Test Loss: 1.637 Test Acc: 0.644
Validation loss decreased (-0.559243 --> -0.644428).  Saving model ...
Epoch: 12 cost time: 0.53424072265625
Epoch: 12, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.596 Vali Acc: 0.719 Test Loss: 1.596 Test Acc: 0.719
Validation loss decreased (-0.644428 --> -0.718503).  Saving model ...
Epoch: 13 cost time: 0.47585511207580566
Epoch: 13, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.550 Vali Acc: 0.774 Test Loss: 1.550 Test Acc: 0.774
Validation loss decreased (-0.718503 --> -0.774059).  Saving model ...
Epoch: 14 cost time: 0.4092421531677246
Epoch: 14, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.502 Vali Acc: 0.804 Test Loss: 1.502 Test Acc: 0.804
Validation loss decreased (-0.774059 --> -0.803689).  Saving model ...
Epoch: 15 cost time: 0.42084765434265137
Epoch: 15, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.450 Vali Acc: 0.852 Test Loss: 1.450 Test Acc: 0.852
Validation loss decreased (-0.803689 --> -0.851837).  Saving model ...
Epoch: 16 cost time: 0.43698740005493164
Epoch: 16, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.397 Vali Acc: 0.867 Test Loss: 1.397 Test Acc: 0.867
Validation loss decreased (-0.851837 --> -0.866653).  Saving model ...
Epoch: 17 cost time: 0.4640007019042969
Epoch: 17, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.341 Vali Acc: 0.874 Test Loss: 1.341 Test Acc: 0.874
Validation loss decreased (-0.866653 --> -0.874061).  Saving model ...
Epoch: 18 cost time: 0.5885260105133057
Epoch: 18, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.284 Vali Acc: 0.885 Test Loss: 1.284 Test Acc: 0.885
Validation loss decreased (-0.874061 --> -0.885172).  Saving model ...
Epoch: 19 cost time: 0.5178096294403076
Epoch: 19, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.225 Vali Acc: 0.904 Test Loss: 1.225 Test Acc: 0.904
Validation loss decreased (-0.885172 --> -0.903691).  Saving model ...
Epoch: 20 cost time: 0.4233086109161377
Epoch: 20, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.165 Vali Acc: 0.911 Test Loss: 1.165 Test Acc: 0.911
Validation loss decreased (-0.903691 --> -0.911099).  Saving model ...
Epoch: 21 cost time: 0.4392573833465576
Epoch: 21, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.105 Vali Acc: 0.930 Test Loss: 1.105 Test Acc: 0.930
Validation loss decreased (-0.911099 --> -0.929619).  Saving model ...
Epoch: 22 cost time: 0.4151887893676758
Epoch: 22, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.044 Vali Acc: 0.926 Test Loss: 1.044 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.47146177291870117
Epoch: 23, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.984 Vali Acc: 0.933 Test Loss: 0.984 Test Acc: 0.933
Validation loss decreased (-0.929619 --> -0.933323).  Saving model ...
Epoch: 24 cost time: 0.4224379062652588
Epoch: 24, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.925 Vali Acc: 0.937 Test Loss: 0.925 Test Acc: 0.937
Validation loss decreased (-0.933323 --> -0.937028).  Saving model ...
Epoch: 25 cost time: 0.46730470657348633
Epoch: 25, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.868 Vali Acc: 0.933 Test Loss: 0.868 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4295477867126465
Epoch: 26, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.813 Vali Acc: 0.930 Test Loss: 0.813 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4654715061187744
Epoch: 27, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.761 Vali Acc: 0.937 Test Loss: 0.761 Test Acc: 0.937
Validation loss decreased (-0.937028 --> -0.937029).  Saving model ...
Epoch: 28 cost time: 0.41168665885925293
Epoch: 28, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.712 Vali Acc: 0.941 Test Loss: 0.712 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940734).  Saving model ...
Epoch: 29 cost time: 0.44875192642211914
Epoch: 29, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.666 Vali Acc: 0.944 Test Loss: 0.666 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 30 cost time: 0.45078110694885254
Epoch: 30, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.623 Vali Acc: 0.948 Test Loss: 0.623 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948142).  Saving model ...
Epoch: 31 cost time: 0.4865145683288574
Epoch: 31, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.583 Vali Acc: 0.948 Test Loss: 0.583 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948142).  Saving model ...
Epoch: 32 cost time: 0.46742820739746094
Epoch: 32, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.547 Vali Acc: 0.948 Test Loss: 0.547 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948143).  Saving model ...
Epoch: 33 cost time: 0.46611714363098145
Epoch: 33, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.513 Vali Acc: 0.948 Test Loss: 0.513 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 34 cost time: 0.45526981353759766
Epoch: 34, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.482 Vali Acc: 0.948 Test Loss: 0.482 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 35 cost time: 0.4014613628387451
Epoch: 35, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.454 Vali Acc: 0.952 Test Loss: 0.454 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 36 cost time: 0.4997725486755371
Epoch: 36, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.429 Vali Acc: 0.952 Test Loss: 0.429 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 37 cost time: 0.5128140449523926
Epoch: 37, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.406 Vali Acc: 0.956 Test Loss: 0.406 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955551).  Saving model ...
Epoch: 38 cost time: 0.40527772903442383
Epoch: 38, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.386 Vali Acc: 0.952 Test Loss: 0.386 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4333682060241699
Epoch: 39, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.367 Vali Acc: 0.952 Test Loss: 0.367 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.41683149337768555
Epoch: 40, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.351 Vali Acc: 0.956 Test Loss: 0.351 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955552).  Saving model ...
Epoch: 41 cost time: 0.45810985565185547
Epoch: 41, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.336 Vali Acc: 0.956 Test Loss: 0.336 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 42 cost time: 0.4542250633239746
Epoch: 42, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.323 Vali Acc: 0.956 Test Loss: 0.323 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 43 cost time: 0.5168440341949463
Epoch: 43, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.311 Vali Acc: 0.956 Test Loss: 0.311 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 44 cost time: 0.4341144561767578
Epoch: 44, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.300 Vali Acc: 0.959 Test Loss: 0.300 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 45 cost time: 0.4499216079711914
Epoch: 45, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.290 Vali Acc: 0.959 Test Loss: 0.290 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 46 cost time: 0.47385525703430176
Epoch: 46, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.281 Vali Acc: 0.959 Test Loss: 0.281 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 47 cost time: 0.45439791679382324
Epoch: 47, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.273 Vali Acc: 0.959 Test Loss: 0.273 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.4478280544281006
Epoch: 48, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.959 Test Loss: 0.265 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.4553871154785156
Epoch: 49, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.258 Vali Acc: 0.959 Test Loss: 0.258 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.43323349952697754
Epoch: 50, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.251 Vali Acc: 0.959 Test Loss: 0.251 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 413926
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6453759670257568
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.771 Vali Acc: 0.185 Test Loss: 1.771 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.4195399284362793
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.766 Vali Acc: 0.233 Test Loss: 1.766 Test Acc: 0.233
Validation loss decreased (-0.185167 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 0.394578218460083
Epoch: 3, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.760 Vali Acc: 0.278 Test Loss: 1.760 Test Acc: 0.278
Validation loss decreased (-0.233316 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.3935880661010742
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.753 Vali Acc: 0.296 Test Loss: 1.753 Test Acc: 0.296
Validation loss decreased (-0.277760 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.4245021343231201
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.744 Vali Acc: 0.344 Test Loss: 1.744 Test Acc: 0.344
Validation loss decreased (-0.296279 --> -0.344427).  Saving model ...
Epoch: 6 cost time: 0.5018460750579834
Epoch: 6, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.730 Vali Acc: 0.381 Test Loss: 1.730 Test Acc: 0.381
Validation loss decreased (-0.344427 --> -0.381464).  Saving model ...
Epoch: 7 cost time: 0.38768982887268066
Epoch: 7, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.714 Vali Acc: 0.452 Test Loss: 1.714 Test Acc: 0.452
Validation loss decreased (-0.381464 --> -0.451835).  Saving model ...
Epoch: 8 cost time: 0.4111664295196533
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.694 Vali Acc: 0.504 Test Loss: 1.694 Test Acc: 0.504
Validation loss decreased (-0.451835 --> -0.503687).  Saving model ...
Epoch: 9 cost time: 0.4021151065826416
Epoch: 9, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.670 Vali Acc: 0.552 Test Loss: 1.670 Test Acc: 0.552
Validation loss decreased (-0.503687 --> -0.551835).  Saving model ...
Epoch: 10 cost time: 0.43610286712646484
Epoch: 10, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.643 Vali Acc: 0.611 Test Loss: 1.643 Test Acc: 0.611
Validation loss decreased (-0.551835 --> -0.611095).  Saving model ...
Epoch: 11 cost time: 0.43491196632385254
Epoch: 11, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.612 Vali Acc: 0.641 Test Loss: 1.612 Test Acc: 0.641
Validation loss decreased (-0.611095 --> -0.640725).  Saving model ...
Epoch: 12 cost time: 0.42470717430114746
Epoch: 12, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.578 Vali Acc: 0.689 Test Loss: 1.578 Test Acc: 0.689
Validation loss decreased (-0.640725 --> -0.688873).  Saving model ...
Epoch: 13 cost time: 0.5552480220794678
Epoch: 13, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.541 Vali Acc: 0.719 Test Loss: 1.541 Test Acc: 0.719
Validation loss decreased (-0.688873 --> -0.718503).  Saving model ...
Epoch: 14 cost time: 0.4204995632171631
Epoch: 14, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.501 Vali Acc: 0.744 Test Loss: 1.501 Test Acc: 0.744
Validation loss decreased (-0.718503 --> -0.744429).  Saving model ...
Epoch: 15 cost time: 0.4286689758300781
Epoch: 15, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.459 Vali Acc: 0.781 Test Loss: 1.459 Test Acc: 0.781
Validation loss decreased (-0.744429 --> -0.781467).  Saving model ...
Epoch: 16 cost time: 0.3962256908416748
Epoch: 16, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.414 Vali Acc: 0.796 Test Loss: 1.414 Test Acc: 0.796
Validation loss decreased (-0.781467 --> -0.796282).  Saving model ...
Epoch: 17 cost time: 0.41719722747802734
Epoch: 17, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.368 Vali Acc: 0.819 Test Loss: 1.368 Test Acc: 0.819
Validation loss decreased (-0.796282 --> -0.818505).  Saving model ...
Epoch: 18 cost time: 0.4653451442718506
Epoch: 18, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.319 Vali Acc: 0.844 Test Loss: 1.319 Test Acc: 0.844
Validation loss decreased (-0.818505 --> -0.844431).  Saving model ...
Epoch: 19 cost time: 0.3952522277832031
Epoch: 19, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.270 Vali Acc: 0.859 Test Loss: 1.270 Test Acc: 0.859
Validation loss decreased (-0.844431 --> -0.859247).  Saving model ...
Epoch: 20 cost time: 0.42524242401123047
Epoch: 20, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.220 Vali Acc: 0.863 Test Loss: 1.220 Test Acc: 0.863
Validation loss decreased (-0.859247 --> -0.862951).  Saving model ...
Epoch: 21 cost time: 0.4500589370727539
Epoch: 21, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.170 Vali Acc: 0.878 Test Loss: 1.170 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877766).  Saving model ...
Epoch: 22 cost time: 0.45151233673095703
Epoch: 22, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.119 Vali Acc: 0.896 Test Loss: 1.119 Test Acc: 0.896
Validation loss decreased (-0.877766 --> -0.896285).  Saving model ...
Epoch: 23 cost time: 0.478656530380249
Epoch: 23, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.068 Vali Acc: 0.904 Test Loss: 1.068 Test Acc: 0.904
Validation loss decreased (-0.896285 --> -0.903693).  Saving model ...
Epoch: 24 cost time: 0.4128842353820801
Epoch: 24, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.019 Vali Acc: 0.900 Test Loss: 1.019 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.431671142578125
Epoch: 25, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.970 Vali Acc: 0.904 Test Loss: 0.970 Test Acc: 0.904
Validation loss decreased (-0.903693 --> -0.903694).  Saving model ...
Epoch: 26 cost time: 0.38592100143432617
Epoch: 26, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.922 Vali Acc: 0.915 Test Loss: 0.922 Test Acc: 0.915
Validation loss decreased (-0.903694 --> -0.914806).  Saving model ...
Epoch: 27 cost time: 0.4219849109649658
Epoch: 27, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.875 Vali Acc: 0.915 Test Loss: 0.875 Test Acc: 0.915
Validation loss decreased (-0.914806 --> -0.914806).  Saving model ...
Epoch: 28 cost time: 0.4004843235015869
Epoch: 28, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.829 Vali Acc: 0.919 Test Loss: 0.829 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918510).  Saving model ...
Epoch: 29 cost time: 0.41532206535339355
Epoch: 29, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.786 Vali Acc: 0.922 Test Loss: 0.786 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922214).  Saving model ...
Epoch: 30 cost time: 0.42655301094055176
Epoch: 30, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.745 Vali Acc: 0.926 Test Loss: 0.745 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925918).  Saving model ...
Epoch: 31 cost time: 0.40937113761901855
Epoch: 31, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.706 Vali Acc: 0.930 Test Loss: 0.706 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929623).  Saving model ...
Epoch: 32 cost time: 0.3865351676940918
Epoch: 32, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.669 Vali Acc: 0.930 Test Loss: 0.669 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 33 cost time: 0.41402602195739746
Epoch: 33, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.634 Vali Acc: 0.933 Test Loss: 0.634 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 34 cost time: 0.4060220718383789
Epoch: 34, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.601 Vali Acc: 0.937 Test Loss: 0.601 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 35 cost time: 0.44565582275390625
Epoch: 35, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.572 Vali Acc: 0.933 Test Loss: 0.572 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4572770595550537
Epoch: 36, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.544 Vali Acc: 0.937 Test Loss: 0.544 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 37 cost time: 0.4364326000213623
Epoch: 37, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.519 Vali Acc: 0.937 Test Loss: 0.519 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 38 cost time: 0.4146866798400879
Epoch: 38, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.495 Vali Acc: 0.937 Test Loss: 0.495 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 39 cost time: 0.4085671901702881
Epoch: 39, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.472 Vali Acc: 0.937 Test Loss: 0.472 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 40 cost time: 0.44641780853271484
Epoch: 40, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.452 Vali Acc: 0.944 Test Loss: 0.452 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 41 cost time: 0.5112812519073486
Epoch: 41, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.433 Vali Acc: 0.948 Test Loss: 0.433 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 42 cost time: 0.44263172149658203
Epoch: 42, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.416 Vali Acc: 0.948 Test Loss: 0.416 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 43 cost time: 0.47420310974121094
Epoch: 43, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.400 Vali Acc: 0.952 Test Loss: 0.400 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 44 cost time: 0.4151268005371094
Epoch: 44, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.385 Vali Acc: 0.952 Test Loss: 0.385 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 45 cost time: 0.4122180938720703
Epoch: 45, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.371 Vali Acc: 0.952 Test Loss: 0.371 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 46 cost time: 0.47312426567077637
Epoch: 46, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.358 Vali Acc: 0.956 Test Loss: 0.358 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 47 cost time: 0.43297672271728516
Epoch: 47, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.347 Vali Acc: 0.956 Test Loss: 0.347 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 48 cost time: 0.4012885093688965
Epoch: 48, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.336 Vali Acc: 0.956 Test Loss: 0.336 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 49 cost time: 0.48076629638671875
Epoch: 49, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.326 Vali Acc: 0.956 Test Loss: 0.326 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 50 cost time: 0.44302821159362793
Epoch: 50, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.317 Vali Acc: 0.956 Test Loss: 0.317 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 410950
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6307649612426758
Epoch: 1, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.762 Vali Acc: 0.359 Test Loss: 1.762 Test Acc: 0.359
Validation loss decreased (inf --> -0.359242).  Saving model ...
Epoch: 2 cost time: 0.4485785961151123
Epoch: 2, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.756 Vali Acc: 0.359 Test Loss: 1.756 Test Acc: 0.359
Validation loss decreased (-0.359242 --> -0.359242).  Saving model ...
Epoch: 3 cost time: 0.41523218154907227
Epoch: 3, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.750 Vali Acc: 0.374 Test Loss: 1.750 Test Acc: 0.374
Validation loss decreased (-0.359242 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.4638237953186035
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.742 Vali Acc: 0.385 Test Loss: 1.742 Test Acc: 0.385
Validation loss decreased (-0.374057 --> -0.385168).  Saving model ...
Epoch: 5 cost time: 0.4720783233642578
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.731 Vali Acc: 0.400 Test Loss: 1.731 Test Acc: 0.400
Validation loss decreased (-0.385168 --> -0.399983).  Saving model ...
Epoch: 6 cost time: 0.44786953926086426
Epoch: 6, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.717 Vali Acc: 0.407 Test Loss: 1.717 Test Acc: 0.407
Validation loss decreased (-0.399983 --> -0.407390).  Saving model ...
Epoch: 7 cost time: 0.41570115089416504
Epoch: 7, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.701 Vali Acc: 0.411 Test Loss: 1.701 Test Acc: 0.411
Validation loss decreased (-0.407390 --> -0.411094).  Saving model ...
Epoch: 8 cost time: 0.44899797439575195
Epoch: 8, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.682 Vali Acc: 0.430 Test Loss: 1.682 Test Acc: 0.430
Validation loss decreased (-0.411094 --> -0.429613).  Saving model ...
Epoch: 9 cost time: 0.41521525382995605
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.660 Vali Acc: 0.452 Test Loss: 1.660 Test Acc: 0.452
Validation loss decreased (-0.429613 --> -0.451835).  Saving model ...
Epoch: 10 cost time: 0.4191141128540039
Epoch: 10, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.635 Vali Acc: 0.478 Test Loss: 1.635 Test Acc: 0.478
Validation loss decreased (-0.451835 --> -0.477761).  Saving model ...
Epoch: 11 cost time: 0.44638562202453613
Epoch: 11, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.607 Vali Acc: 0.493 Test Loss: 1.607 Test Acc: 0.493
Validation loss decreased (-0.477761 --> -0.492577).  Saving model ...
Epoch: 12 cost time: 0.4165472984313965
Epoch: 12, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.577 Vali Acc: 0.511 Test Loss: 1.577 Test Acc: 0.511
Validation loss decreased (-0.492577 --> -0.511095).  Saving model ...
Epoch: 13 cost time: 0.44236207008361816
Epoch: 13, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.543 Vali Acc: 0.548 Test Loss: 1.543 Test Acc: 0.548
Validation loss decreased (-0.511095 --> -0.548133).  Saving model ...
Epoch: 14 cost time: 0.43864893913269043
Epoch: 14, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.509 Vali Acc: 0.600 Test Loss: 1.509 Test Acc: 0.600
Validation loss decreased (-0.548133 --> -0.599985).  Saving model ...
Epoch: 15 cost time: 0.483351469039917
Epoch: 15, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.471 Vali Acc: 0.630 Test Loss: 1.471 Test Acc: 0.630
Validation loss decreased (-0.599985 --> -0.629615).  Saving model ...
Epoch: 16 cost time: 0.4792201519012451
Epoch: 16, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.433 Vali Acc: 0.648 Test Loss: 1.433 Test Acc: 0.648
Validation loss decreased (-0.629615 --> -0.648134).  Saving model ...
Epoch: 17 cost time: 0.41443419456481934
Epoch: 17, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.393 Vali Acc: 0.685 Test Loss: 1.393 Test Acc: 0.685
Validation loss decreased (-0.648134 --> -0.685171).  Saving model ...
Epoch: 18 cost time: 0.4472346305847168
Epoch: 18, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.352 Vali Acc: 0.700 Test Loss: 1.352 Test Acc: 0.700
Validation loss decreased (-0.685171 --> -0.699986).  Saving model ...
Epoch: 19 cost time: 0.46282458305358887
Epoch: 19, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.311 Vali Acc: 0.726 Test Loss: 1.311 Test Acc: 0.726
Validation loss decreased (-0.699986 --> -0.725913).  Saving model ...
Epoch: 20 cost time: 0.41536569595336914
Epoch: 20, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.268 Vali Acc: 0.756 Test Loss: 1.268 Test Acc: 0.756
Validation loss decreased (-0.725913 --> -0.755543).  Saving model ...
Epoch: 21 cost time: 0.44349217414855957
Epoch: 21, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.226 Vali Acc: 0.789 Test Loss: 1.226 Test Acc: 0.789
Validation loss decreased (-0.755543 --> -0.788877).  Saving model ...
Epoch: 22 cost time: 0.413632869720459
Epoch: 22, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.183 Vali Acc: 0.833 Test Loss: 1.183 Test Acc: 0.833
Validation loss decreased (-0.788877 --> -0.833322).  Saving model ...
Epoch: 23 cost time: 0.4605734348297119
Epoch: 23, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.141 Vali Acc: 0.841 Test Loss: 1.141 Test Acc: 0.841
Validation loss decreased (-0.833322 --> -0.840729).  Saving model ...
Epoch: 24 cost time: 0.4224264621734619
Epoch: 24, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.099 Vali Acc: 0.848 Test Loss: 1.099 Test Acc: 0.848
Validation loss decreased (-0.840729 --> -0.848137).  Saving model ...
Epoch: 25 cost time: 0.4257845878601074
Epoch: 25, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.058 Vali Acc: 0.856 Test Loss: 1.058 Test Acc: 0.856
Validation loss decreased (-0.848137 --> -0.855545).  Saving model ...
Epoch: 26 cost time: 0.3978385925292969
Epoch: 26, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.018 Vali Acc: 0.852 Test Loss: 1.018 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4602327346801758
Epoch: 27, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.978 Vali Acc: 0.870 Test Loss: 0.978 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 28 cost time: 0.5242488384246826
Epoch: 28, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.939 Vali Acc: 0.881 Test Loss: 0.939 Test Acc: 0.881
Validation loss decreased (-0.870361 --> -0.881472).  Saving model ...
Epoch: 29 cost time: 0.4157238006591797
Epoch: 29, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.901 Vali Acc: 0.885 Test Loss: 0.901 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 30 cost time: 0.4738600254058838
Epoch: 30, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.865 Vali Acc: 0.893 Test Loss: 0.865 Test Acc: 0.893
Validation loss decreased (-0.885176 --> -0.892584).  Saving model ...
Epoch: 31 cost time: 0.43205904960632324
Epoch: 31, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.829 Vali Acc: 0.896 Test Loss: 0.829 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896288).  Saving model ...
Epoch: 32 cost time: 0.4002492427825928
Epoch: 32, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.795 Vali Acc: 0.900 Test Loss: 0.795 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899992).  Saving model ...
Epoch: 33 cost time: 0.45212864875793457
Epoch: 33, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.764 Vali Acc: 0.904 Test Loss: 0.764 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 34 cost time: 0.46615099906921387
Epoch: 34, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.733 Vali Acc: 0.915 Test Loss: 0.733 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914807).  Saving model ...
Epoch: 35 cost time: 0.45086073875427246
Epoch: 35, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.704 Vali Acc: 0.915 Test Loss: 0.704 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 36 cost time: 0.5972485542297363
Epoch: 36, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.676 Vali Acc: 0.919 Test Loss: 0.676 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 37 cost time: 0.532865047454834
Epoch: 37, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.650 Vali Acc: 0.922 Test Loss: 0.650 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 38 cost time: 0.49291253089904785
Epoch: 38, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.625 Vali Acc: 0.930 Test Loss: 0.625 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929623).  Saving model ...
Epoch: 39 cost time: 0.42552804946899414
Epoch: 39, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.602 Vali Acc: 0.933 Test Loss: 0.602 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 40 cost time: 0.41230344772338867
Epoch: 40, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.580 Vali Acc: 0.933 Test Loss: 0.580 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 41 cost time: 0.40999484062194824
Epoch: 41, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.560 Vali Acc: 0.933 Test Loss: 0.560 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 42 cost time: 0.4639923572540283
Epoch: 42, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.541 Vali Acc: 0.933 Test Loss: 0.541 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 43 cost time: 0.47815632820129395
Epoch: 43, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.522 Vali Acc: 0.933 Test Loss: 0.522 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 44 cost time: 0.5069034099578857
Epoch: 44, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.505 Vali Acc: 0.930 Test Loss: 0.505 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.44617319107055664
Epoch: 45, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.489 Vali Acc: 0.930 Test Loss: 0.489 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.46824026107788086
Epoch: 46, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.474 Vali Acc: 0.930 Test Loss: 0.474 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.46779918670654297
Epoch: 47, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.460 Vali Acc: 0.930 Test Loss: 0.460 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4287428855895996
Epoch: 48, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.447 Vali Acc: 0.930 Test Loss: 0.447 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4267547130584717
Epoch: 49, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.435 Vali Acc: 0.930 Test Loss: 0.435 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.4907093048095703
Epoch: 50, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.424 Vali Acc: 0.930 Test Loss: 0.424 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 408006
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7496609687805176
Epoch: 1, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.725 Vali Acc: 0.474 Test Loss: 1.725 Test Acc: 0.474
Validation loss decreased (inf --> -0.474057).  Saving model ...
Epoch: 2 cost time: 0.4633042812347412
Epoch: 2, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.668 Vali Acc: 0.589 Test Loss: 1.668 Test Acc: 0.589
Validation loss decreased (-0.474057 --> -0.588872).  Saving model ...
Epoch: 3 cost time: 0.4292469024658203
Epoch: 3, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.585 Vali Acc: 0.667 Test Loss: 1.585 Test Acc: 0.667
Validation loss decreased (-0.588872 --> -0.666651).  Saving model ...
Epoch: 4 cost time: 0.44248414039611816
Epoch: 4, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.437 Vali Acc: 0.789 Test Loss: 1.437 Test Acc: 0.789
Validation loss decreased (-0.666651 --> -0.788875).  Saving model ...
Epoch: 5 cost time: 0.43070411682128906
Epoch: 5, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.254 Vali Acc: 0.904 Test Loss: 1.254 Test Acc: 0.904
Validation loss decreased (-0.788875 --> -0.903691).  Saving model ...
Epoch: 6 cost time: 0.4302980899810791
Epoch: 6, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.058 Vali Acc: 0.919 Test Loss: 1.058 Test Acc: 0.919
Validation loss decreased (-0.903691 --> -0.918508).  Saving model ...
Epoch: 7 cost time: 0.4538404941558838
Epoch: 7, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.863 Vali Acc: 0.933 Test Loss: 0.863 Test Acc: 0.933
Validation loss decreased (-0.918508 --> -0.933325).  Saving model ...
Epoch: 8 cost time: 0.4252176284790039
Epoch: 8, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.686 Vali Acc: 0.930 Test Loss: 0.686 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4388766288757324
Epoch: 9, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.536 Vali Acc: 0.933 Test Loss: 0.536 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933328).  Saving model ...
Epoch: 10 cost time: 0.44883060455322266
Epoch: 10, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.417 Vali Acc: 0.941 Test Loss: 0.417 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940737).  Saving model ...
Epoch: 11 cost time: 0.5168097019195557
Epoch: 11, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.329 Vali Acc: 0.941 Test Loss: 0.329 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 12 cost time: 0.44339847564697266
Epoch: 12, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 13 cost time: 0.5266323089599609
Epoch: 13, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.48654961585998535
Epoch: 14, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 15 cost time: 0.46308302879333496
Epoch: 15, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 16 cost time: 0.4136795997619629
Epoch: 16, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 17 cost time: 0.4821662902832031
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 18 cost time: 0.41640806198120117
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.4722931385040283
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.44110822677612305
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.4902048110961914
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4044990539550781
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.423755407333374
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.501551628112793
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.43780970573425293
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.43489956855773926
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4447298049926758
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4787638187408447
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.46440911293029785
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4532127380371094
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.4849100112915039
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.45697975158691406
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4336388111114502
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.42713212966918945
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.49149417877197266
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.48665404319763184
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4535965919494629
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.45168375968933105
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4879748821258545
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5358567237854004
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1648518
model size : 6.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.730905532836914
Epoch: 1, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.778 Vali Acc: 0.326 Test Loss: 1.778 Test Acc: 0.326
Validation loss decreased (inf --> -0.325908).  Saving model ...
Epoch: 2 cost time: 0.4441218376159668
Epoch: 2, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.731 Vali Acc: 0.426 Test Loss: 1.731 Test Acc: 0.426
Validation loss decreased (-0.325908 --> -0.425909).  Saving model ...
Epoch: 3 cost time: 0.4478132724761963
Epoch: 3, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.674 Vali Acc: 0.459 Test Loss: 1.674 Test Acc: 0.459
Validation loss decreased (-0.425909 --> -0.459243).  Saving model ...
Epoch: 4 cost time: 0.4423084259033203
Epoch: 4, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.582 Vali Acc: 0.507 Test Loss: 1.582 Test Acc: 0.507
Validation loss decreased (-0.459243 --> -0.507392).  Saving model ...
Epoch: 5 cost time: 0.49167346954345703
Epoch: 5, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.464 Vali Acc: 0.626 Test Loss: 1.464 Test Acc: 0.626
Validation loss decreased (-0.507392 --> -0.625911).  Saving model ...
Epoch: 6 cost time: 0.41323280334472656
Epoch: 6, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.327 Vali Acc: 0.744 Test Loss: 1.327 Test Acc: 0.744
Validation loss decreased (-0.625911 --> -0.744431).  Saving model ...
Epoch: 7 cost time: 0.4635794162750244
Epoch: 7, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.175 Vali Acc: 0.804 Test Loss: 1.175 Test Acc: 0.804
Validation loss decreased (-0.744431 --> -0.803692).  Saving model ...
Epoch: 8 cost time: 0.46076250076293945
Epoch: 8, Steps: 2 | Train Loss: 0.826 Vali Loss: 1.022 Vali Acc: 0.852 Test Loss: 1.022 Test Acc: 0.852
Validation loss decreased (-0.803692 --> -0.851842).  Saving model ...
Epoch: 9 cost time: 0.4095313549041748
Epoch: 9, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.872 Vali Acc: 0.867 Test Loss: 0.872 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866658).  Saving model ...
Epoch: 10 cost time: 0.4204723834991455
Epoch: 10, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.732 Vali Acc: 0.889 Test Loss: 0.732 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888882).  Saving model ...
Epoch: 11 cost time: 0.40802574157714844
Epoch: 11, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.606 Vali Acc: 0.904 Test Loss: 0.606 Test Acc: 0.904
Validation loss decreased (-0.888882 --> -0.903698).  Saving model ...
Epoch: 12 cost time: 0.4624307155609131
Epoch: 12, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.502 Vali Acc: 0.896 Test Loss: 0.502 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.42391443252563477
Epoch: 13, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.418 Vali Acc: 0.907 Test Loss: 0.418 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907403).  Saving model ...
Epoch: 14 cost time: 0.4541664123535156
Epoch: 14, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.350 Vali Acc: 0.915 Test Loss: 0.350 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 15 cost time: 0.42058396339416504
Epoch: 15, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918516).  Saving model ...
Epoch: 16 cost time: 0.4374263286590576
Epoch: 16, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 0.43270373344421387
Epoch: 17, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.4351229667663574
Epoch: 18, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 0.4495506286621094
Epoch: 19, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.925924 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.4192392826080322
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.44300150871276855
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.4608883857727051
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.4868772029876709
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.4390146732330322
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.46437954902648926
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.45636844635009766
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.4375312328338623
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.4299638271331787
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.41433119773864746
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5339787006378174
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4208409786224365
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.48802971839904785
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.43898749351501465
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.43438172340393066
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4584169387817383
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.44954419136047363
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4869406223297119
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1544326
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7241413593292236
Epoch: 1, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.803 Vali Acc: 0.130 Test Loss: 1.803 Test Acc: 0.130
Validation loss decreased (inf --> -0.129612).  Saving model ...
Epoch: 2 cost time: 0.42603135108947754
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.770 Vali Acc: 0.207 Test Loss: 1.770 Test Acc: 0.207
Validation loss decreased (-0.129612 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.4519236087799072
Epoch: 3, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.729 Vali Acc: 0.337 Test Loss: 1.729 Test Acc: 0.337
Validation loss decreased (-0.207390 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 0.43295717239379883
Epoch: 4, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.664 Vali Acc: 0.504 Test Loss: 1.664 Test Acc: 0.504
Validation loss decreased (-0.337020 --> -0.503687).  Saving model ...
Epoch: 5 cost time: 0.42943644523620605
Epoch: 5, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.578 Vali Acc: 0.641 Test Loss: 1.578 Test Acc: 0.641
Validation loss decreased (-0.503687 --> -0.640725).  Saving model ...
Epoch: 6 cost time: 0.45221519470214844
Epoch: 6, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.476 Vali Acc: 0.767 Test Loss: 1.476 Test Acc: 0.767
Validation loss decreased (-0.640725 --> -0.766652).  Saving model ...
Epoch: 7 cost time: 0.43259763717651367
Epoch: 7, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.360 Vali Acc: 0.878 Test Loss: 1.360 Test Acc: 0.878
Validation loss decreased (-0.766652 --> -0.877764).  Saving model ...
Epoch: 8 cost time: 0.41417479515075684
Epoch: 8, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.233 Vali Acc: 0.907 Test Loss: 1.233 Test Acc: 0.907
Validation loss decreased (-0.877764 --> -0.907395).  Saving model ...
Epoch: 9 cost time: 0.4598665237426758
Epoch: 9, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.100 Vali Acc: 0.926 Test Loss: 1.100 Test Acc: 0.926
Validation loss decreased (-0.907395 --> -0.925915).  Saving model ...
Epoch: 10 cost time: 0.47485971450805664
Epoch: 10, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.967 Vali Acc: 0.930 Test Loss: 0.967 Test Acc: 0.930
Validation loss decreased (-0.925915 --> -0.929620).  Saving model ...
Epoch: 11 cost time: 0.4573221206665039
Epoch: 11, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.837 Vali Acc: 0.941 Test Loss: 0.837 Test Acc: 0.941
Validation loss decreased (-0.929620 --> -0.940732).  Saving model ...
Epoch: 12 cost time: 0.4419586658477783
Epoch: 12, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.714 Vali Acc: 0.937 Test Loss: 0.714 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4277937412261963
Epoch: 13, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.603 Vali Acc: 0.941 Test Loss: 0.603 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940735).  Saving model ...
Epoch: 14 cost time: 0.4211246967315674
Epoch: 14, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.509 Vali Acc: 0.944 Test Loss: 0.509 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 15 cost time: 0.42860960960388184
Epoch: 15, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.431 Vali Acc: 0.941 Test Loss: 0.431 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4089665412902832
Epoch: 16, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.367 Vali Acc: 0.948 Test Loss: 0.367 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948144).  Saving model ...
Epoch: 17 cost time: 0.41359615325927734
Epoch: 17, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.316 Vali Acc: 0.959 Test Loss: 0.316 Test Acc: 0.959
Validation loss decreased (-0.948144 --> -0.959256).  Saving model ...
Epoch: 18 cost time: 0.4316136837005615
Epoch: 18, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 19 cost time: 0.3986344337463379
Epoch: 19, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
Validation loss decreased (-0.959256 --> -0.966664).  Saving model ...
Epoch: 20 cost time: 0.39757418632507324
Epoch: 20, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.963 Test Loss: 0.224 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4526479244232178
Epoch: 21, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.440615177154541
Epoch: 22, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.44351625442504883
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4193892478942871
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.38251566886901855
Epoch: 25, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 26 cost time: 0.4214792251586914
Epoch: 26, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 27 cost time: 0.4239792823791504
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 0.42806458473205566
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 0.48195481300354004
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 30 cost time: 0.4524085521697998
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5251021385192871
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.41218113899230957
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.44931459426879883
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.45205187797546387
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.49844956398010254
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.48510169982910156
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.4286916255950928
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.421252965927124
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4376702308654785
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 1513734
model size : 5.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7198762893676758
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.826 Vali Acc: 0.189 Test Loss: 1.826 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.42861080169677734
Epoch: 2, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.798 Vali Acc: 0.215 Test Loss: 1.798 Test Acc: 0.215
Validation loss decreased (-0.188871 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.5005676746368408
Epoch: 3, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.765 Vali Acc: 0.252 Test Loss: 1.765 Test Acc: 0.252
Validation loss decreased (-0.214797 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 0.490161657333374
Epoch: 4, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.714 Vali Acc: 0.344 Test Loss: 1.714 Test Acc: 0.344
Validation loss decreased (-0.251834 --> -0.344427).  Saving model ...
Epoch: 5 cost time: 0.48943018913269043
Epoch: 5, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.647 Vali Acc: 0.541 Test Loss: 1.647 Test Acc: 0.541
Validation loss decreased (-0.344427 --> -0.540724).  Saving model ...
Epoch: 6 cost time: 0.4427955150604248
Epoch: 6, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.566 Vali Acc: 0.685 Test Loss: 1.566 Test Acc: 0.685
Validation loss decreased (-0.540724 --> -0.685170).  Saving model ...
Epoch: 7 cost time: 0.47286438941955566
Epoch: 7, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.472 Vali Acc: 0.730 Test Loss: 1.472 Test Acc: 0.730
Validation loss decreased (-0.685170 --> -0.729615).  Saving model ...
Epoch: 8 cost time: 0.5285172462463379
Epoch: 8, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.368 Vali Acc: 0.793 Test Loss: 1.368 Test Acc: 0.793
Validation loss decreased (-0.729615 --> -0.792579).  Saving model ...
Epoch: 9 cost time: 0.3989698886871338
Epoch: 9, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.255 Vali Acc: 0.837 Test Loss: 1.255 Test Acc: 0.837
Validation loss decreased (-0.792579 --> -0.837024).  Saving model ...
Epoch: 10 cost time: 0.5062780380249023
Epoch: 10, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.137 Vali Acc: 0.878 Test Loss: 1.137 Test Acc: 0.878
Validation loss decreased (-0.837024 --> -0.877766).  Saving model ...
Epoch: 11 cost time: 0.46692681312561035
Epoch: 11, Steps: 2 | Train Loss: 0.731 Vali Loss: 1.018 Vali Acc: 0.885 Test Loss: 1.018 Test Acc: 0.885
Validation loss decreased (-0.877766 --> -0.885175).  Saving model ...
Epoch: 12 cost time: 0.5564789772033691
Epoch: 12, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.900 Vali Acc: 0.889 Test Loss: 0.900 Test Acc: 0.889
Validation loss decreased (-0.885175 --> -0.888880).  Saving model ...
Epoch: 13 cost time: 0.45769500732421875
Epoch: 13, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.786 Vali Acc: 0.893 Test Loss: 0.786 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892585).  Saving model ...
Epoch: 14 cost time: 0.47586703300476074
Epoch: 14, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.682 Vali Acc: 0.900 Test Loss: 0.682 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.4378323554992676
Epoch: 15, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.587 Vali Acc: 0.915 Test Loss: 0.587 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914809).  Saving model ...
Epoch: 16 cost time: 0.5619077682495117
Epoch: 16, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.505 Vali Acc: 0.933 Test Loss: 0.505 Test Acc: 0.933
Validation loss decreased (-0.914809 --> -0.933328).  Saving model ...
Epoch: 17 cost time: 0.48087477684020996
Epoch: 17, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.436 Vali Acc: 0.937 Test Loss: 0.436 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.4643537998199463
Epoch: 18, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.380 Vali Acc: 0.944 Test Loss: 0.380 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.5277917385101318
Epoch: 19, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.336 Vali Acc: 0.952 Test Loss: 0.336 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 20 cost time: 0.4985694885253906
Epoch: 20, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.301 Vali Acc: 0.952 Test Loss: 0.301 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 21 cost time: 0.4466261863708496
Epoch: 21, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.274 Vali Acc: 0.952 Test Loss: 0.274 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 22 cost time: 0.4929208755493164
Epoch: 22, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 23 cost time: 0.4930119514465332
Epoch: 23, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 24 cost time: 0.4662184715270996
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.5745344161987305
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.4392049312591553
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.45410656929016113
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.46110081672668457
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.45459961891174316
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5187008380889893
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.48923254013061523
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.489548921585083
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.41837000846862793
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.43635106086730957
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.4134335517883301
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.4489102363586426
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5111904144287109
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4933152198791504
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1495558
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6138250827789307
Epoch: 1, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.724 Vali Acc: 0.330 Test Loss: 1.724 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.4312448501586914
Epoch: 2, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.702 Vali Acc: 0.430 Test Loss: 1.702 Test Acc: 0.430
Validation loss decreased (-0.329612 --> -0.429613).  Saving model ...
Epoch: 3 cost time: 0.5102989673614502
Epoch: 3, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.675 Vali Acc: 0.522 Test Loss: 1.675 Test Acc: 0.522
Validation loss decreased (-0.429613 --> -0.522205).  Saving model ...
Epoch: 4 cost time: 0.4572334289550781
Epoch: 4, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.634 Vali Acc: 0.581 Test Loss: 1.634 Test Acc: 0.581
Validation loss decreased (-0.522205 --> -0.581465).  Saving model ...
Epoch: 5 cost time: 0.4946296215057373
Epoch: 5, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.578 Vali Acc: 0.659 Test Loss: 1.578 Test Acc: 0.659
Validation loss decreased (-0.581465 --> -0.659243).  Saving model ...
Epoch: 6 cost time: 0.4741513729095459
Epoch: 6, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.509 Vali Acc: 0.722 Test Loss: 1.509 Test Acc: 0.722
Validation loss decreased (-0.659243 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.46133875846862793
Epoch: 7, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.429 Vali Acc: 0.793 Test Loss: 1.429 Test Acc: 0.793
Validation loss decreased (-0.722207 --> -0.792578).  Saving model ...
Epoch: 8 cost time: 0.38067150115966797
Epoch: 8, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.339 Vali Acc: 0.833 Test Loss: 1.339 Test Acc: 0.833
Validation loss decreased (-0.792578 --> -0.833320).  Saving model ...
Epoch: 9 cost time: 0.41124844551086426
Epoch: 9, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.241 Vali Acc: 0.878 Test Loss: 1.241 Test Acc: 0.878
Validation loss decreased (-0.833320 --> -0.877765).  Saving model ...
Epoch: 10 cost time: 0.42159080505371094
Epoch: 10, Steps: 2 | Train Loss: 0.922 Vali Loss: 1.136 Vali Acc: 0.881 Test Loss: 1.136 Test Acc: 0.881
Validation loss decreased (-0.877765 --> -0.881470).  Saving model ...
Epoch: 11 cost time: 0.48119449615478516
Epoch: 11, Steps: 2 | Train Loss: 0.782 Vali Loss: 1.029 Vali Acc: 0.896 Test Loss: 1.029 Test Acc: 0.896
Validation loss decreased (-0.881470 --> -0.896286).  Saving model ...
Epoch: 12 cost time: 0.41023731231689453
Epoch: 12, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.919 Vali Acc: 0.915 Test Loss: 0.919 Test Acc: 0.915
Validation loss decreased (-0.896286 --> -0.914806).  Saving model ...
Epoch: 13 cost time: 0.4108245372772217
Epoch: 13, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.813 Vali Acc: 0.930 Test Loss: 0.813 Test Acc: 0.930
Validation loss decreased (-0.914806 --> -0.929622).  Saving model ...
Epoch: 14 cost time: 0.4359257221221924
Epoch: 14, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.711 Vali Acc: 0.930 Test Loss: 0.711 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929623).  Saving model ...
Epoch: 15 cost time: 0.4494185447692871
Epoch: 15, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.617 Vali Acc: 0.933 Test Loss: 0.617 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 16 cost time: 0.43882012367248535
Epoch: 16, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.535 Vali Acc: 0.937 Test Loss: 0.535 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937032).  Saving model ...
Epoch: 17 cost time: 0.4210329055786133
Epoch: 17, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.466 Vali Acc: 0.933 Test Loss: 0.466 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4184896945953369
Epoch: 18, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.410 Vali Acc: 0.944 Test Loss: 0.410 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 19 cost time: 0.43352794647216797
Epoch: 19, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.365 Vali Acc: 0.937 Test Loss: 0.365 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.46729493141174316
Epoch: 20, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.328 Vali Acc: 0.937 Test Loss: 0.328 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.46474575996398926
Epoch: 21, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5279500484466553
Epoch: 22, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4248230457305908
Epoch: 23, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.42236995697021484
Epoch: 24, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4328460693359375
Epoch: 25, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4376702308654785
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4543800354003906
Epoch: 27, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4671902656555176
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.42705416679382324
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.435443639755249
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.4356222152709961
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.4731435775756836
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.46278929710388184
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.4402730464935303
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.4298832416534424
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.43329858779907227
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.46238136291503906
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.4351198673248291
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.4357290267944336
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.4980316162109375
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4633498191833496
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4515047073364258
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4055924415588379
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.41401052474975586
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.38426661491394043
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.43822574615478516
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.43559861183166504
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.42532849311828613
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4555943012237549
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1489798
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9709031581878662
Epoch: 1, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.794 Vali Acc: 0.178 Test Loss: 1.794 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.49030113220214844
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.773 Vali Acc: 0.200 Test Loss: 1.773 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.45439934730529785
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.750 Vali Acc: 0.289 Test Loss: 1.750 Test Acc: 0.289
Validation loss decreased (-0.199982 --> -0.288871).  Saving model ...
Epoch: 4 cost time: 0.5208640098571777
Epoch: 4, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.716 Vali Acc: 0.352 Test Loss: 1.716 Test Acc: 0.352
Validation loss decreased (-0.288871 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 0.4864211082458496
Epoch: 5, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.670 Vali Acc: 0.496 Test Loss: 1.670 Test Acc: 0.496
Validation loss decreased (-0.351835 --> -0.496280).  Saving model ...
Epoch: 6 cost time: 0.5298011302947998
Epoch: 6, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.614 Vali Acc: 0.600 Test Loss: 1.614 Test Acc: 0.600
Validation loss decreased (-0.496280 --> -0.599984).  Saving model ...
Epoch: 7 cost time: 0.41916775703430176
Epoch: 7, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.547 Vali Acc: 0.696 Test Loss: 1.547 Test Acc: 0.696
Validation loss decreased (-0.599984 --> -0.696281).  Saving model ...
Epoch: 8 cost time: 0.42760229110717773
Epoch: 8, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.471 Vali Acc: 0.748 Test Loss: 1.471 Test Acc: 0.748
Validation loss decreased (-0.696281 --> -0.748133).  Saving model ...
Epoch: 9 cost time: 0.4786667823791504
Epoch: 9, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.386 Vali Acc: 0.789 Test Loss: 1.386 Test Acc: 0.789
Validation loss decreased (-0.748133 --> -0.788875).  Saving model ...
Epoch: 10 cost time: 0.45556044578552246
Epoch: 10, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.296 Vali Acc: 0.848 Test Loss: 1.296 Test Acc: 0.848
Validation loss decreased (-0.788875 --> -0.848135).  Saving model ...
Epoch: 11 cost time: 0.463787317276001
Epoch: 11, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.201 Vali Acc: 0.878 Test Loss: 1.201 Test Acc: 0.878
Validation loss decreased (-0.848135 --> -0.877766).  Saving model ...
Epoch: 12 cost time: 0.4521658420562744
Epoch: 12, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.102 Vali Acc: 0.896 Test Loss: 1.102 Test Acc: 0.896
Validation loss decreased (-0.877766 --> -0.896285).  Saving model ...
Epoch: 13 cost time: 0.44226527214050293
Epoch: 13, Steps: 2 | Train Loss: 0.766 Vali Loss: 1.004 Vali Acc: 0.922 Test Loss: 1.004 Test Acc: 0.922
Validation loss decreased (-0.896285 --> -0.922212).  Saving model ...
Epoch: 14 cost time: 0.44773244857788086
Epoch: 14, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.905 Vali Acc: 0.933 Test Loss: 0.905 Test Acc: 0.933
Validation loss decreased (-0.922212 --> -0.933324).  Saving model ...
Epoch: 15 cost time: 0.47727036476135254
Epoch: 15, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.808 Vali Acc: 0.933 Test Loss: 0.808 Test Acc: 0.933
Validation loss decreased (-0.933324 --> -0.933325).  Saving model ...
Epoch: 16 cost time: 0.4803638458251953
Epoch: 16, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.719 Vali Acc: 0.937 Test Loss: 0.719 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937030).  Saving model ...
Epoch: 17 cost time: 0.43556761741638184
Epoch: 17, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.639 Vali Acc: 0.937 Test Loss: 0.639 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 18 cost time: 0.4311034679412842
Epoch: 18, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.567 Vali Acc: 0.941 Test Loss: 0.567 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 19 cost time: 0.4829225540161133
Epoch: 19, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.505 Vali Acc: 0.944 Test Loss: 0.505 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 20 cost time: 0.5211305618286133
Epoch: 20, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.452 Vali Acc: 0.937 Test Loss: 0.452 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5263845920562744
Epoch: 21, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.408 Vali Acc: 0.937 Test Loss: 0.408 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5053420066833496
Epoch: 22, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.372 Vali Acc: 0.937 Test Loss: 0.372 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4728052616119385
Epoch: 23, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4407968521118164
Epoch: 24, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4617650508880615
Epoch: 25, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4331662654876709
Epoch: 26, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.276 Vali Acc: 0.948 Test Loss: 0.276 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.5727486610412598
Epoch: 27, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.261 Vali Acc: 0.956 Test Loss: 0.261 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.4578399658203125
Epoch: 28, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.4898560047149658
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.236 Vali Acc: 0.956 Test Loss: 0.236 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.585517406463623
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.959 Test Loss: 0.227 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.5115435123443604
Epoch: 31, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.4988570213317871
Epoch: 32, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.213 Vali Acc: 0.959 Test Loss: 0.213 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 33 cost time: 0.4966883659362793
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 34 cost time: 0.46854734420776367
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 35 cost time: 0.5037214756011963
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 36 cost time: 0.49535179138183594
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 37 cost time: 0.49248838424682617
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 38 cost time: 0.5051209926605225
Epoch: 38, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 39 cost time: 0.4780006408691406
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 40 cost time: 0.522688627243042
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 41 cost time: 0.5681619644165039
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6109042167663574
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.44669389724731445
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 44 cost time: 0.47817540168762207
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 45 cost time: 0.5018880367279053
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 46 cost time: 0.44902610778808594
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 47 cost time: 0.4562673568725586
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 48 cost time: 0.5486299991607666
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 49 cost time: 0.4654707908630371
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 50 cost time: 0.49755430221557617
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 1477894
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6607537269592285
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.763 Vali Acc: 0.196 Test Loss: 1.763 Test Acc: 0.196
Validation loss decreased (inf --> -0.196279).  Saving model ...
Epoch: 2 cost time: 0.4645721912384033
Epoch: 2, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.744 Vali Acc: 0.252 Test Loss: 1.744 Test Acc: 0.252
Validation loss decreased (-0.196279 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.4151456356048584
Epoch: 3, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.723 Vali Acc: 0.293 Test Loss: 1.723 Test Acc: 0.293
Validation loss decreased (-0.251834 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.4345057010650635
Epoch: 4, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.693 Vali Acc: 0.415 Test Loss: 1.693 Test Acc: 0.415
Validation loss decreased (-0.292575 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.41144871711730957
Epoch: 5, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.652 Vali Acc: 0.522 Test Loss: 1.652 Test Acc: 0.522
Validation loss decreased (-0.414798 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 0.4613673686981201
Epoch: 6, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.601 Vali Acc: 0.630 Test Loss: 1.601 Test Acc: 0.630
Validation loss decreased (-0.522206 --> -0.629614).  Saving model ...
Epoch: 7 cost time: 0.4525034427642822
Epoch: 7, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.541 Vali Acc: 0.715 Test Loss: 1.541 Test Acc: 0.715
Validation loss decreased (-0.629614 --> -0.714799).  Saving model ...
Epoch: 8 cost time: 0.45958662033081055
Epoch: 8, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.473 Vali Acc: 0.804 Test Loss: 1.473 Test Acc: 0.804
Validation loss decreased (-0.714799 --> -0.803689).  Saving model ...
Epoch: 9 cost time: 0.4709465503692627
Epoch: 9, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.397 Vali Acc: 0.841 Test Loss: 1.397 Test Acc: 0.841
Validation loss decreased (-0.803689 --> -0.840727).  Saving model ...
Epoch: 10 cost time: 0.4653739929199219
Epoch: 10, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.314 Vali Acc: 0.859 Test Loss: 1.314 Test Acc: 0.859
Validation loss decreased (-0.840727 --> -0.859246).  Saving model ...
Epoch: 11 cost time: 0.4715919494628906
Epoch: 11, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.226 Vali Acc: 0.881 Test Loss: 1.226 Test Acc: 0.881
Validation loss decreased (-0.859246 --> -0.881469).  Saving model ...
Epoch: 12 cost time: 0.5254361629486084
Epoch: 12, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.134 Vali Acc: 0.889 Test Loss: 1.134 Test Acc: 0.889
Validation loss decreased (-0.881469 --> -0.888878).  Saving model ...
Epoch: 13 cost time: 0.44495368003845215
Epoch: 13, Steps: 2 | Train Loss: 0.812 Vali Loss: 1.040 Vali Acc: 0.907 Test Loss: 1.040 Test Acc: 0.907
Validation loss decreased (-0.888878 --> -0.907397).  Saving model ...
Epoch: 14 cost time: 0.44318723678588867
Epoch: 14, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.946 Vali Acc: 0.915 Test Loss: 0.946 Test Acc: 0.915
Validation loss decreased (-0.907397 --> -0.914805).  Saving model ...
Epoch: 15 cost time: 0.5270211696624756
Epoch: 15, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.854 Vali Acc: 0.926 Test Loss: 0.854 Test Acc: 0.926
Validation loss decreased (-0.914805 --> -0.925917).  Saving model ...
Epoch: 16 cost time: 0.4920036792755127
Epoch: 16, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.767 Vali Acc: 0.930 Test Loss: 0.767 Test Acc: 0.930
Validation loss decreased (-0.925917 --> -0.929622).  Saving model ...
Epoch: 17 cost time: 0.5261995792388916
Epoch: 17, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.686 Vali Acc: 0.933 Test Loss: 0.686 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933326).  Saving model ...
Epoch: 18 cost time: 0.47600317001342773
Epoch: 18, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.615 Vali Acc: 0.941 Test Loss: 0.615 Test Acc: 0.941
Validation loss decreased (-0.933326 --> -0.940735).  Saving model ...
Epoch: 19 cost time: 0.4807007312774658
Epoch: 19, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.551 Vali Acc: 0.941 Test Loss: 0.551 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 20 cost time: 0.4454624652862549
Epoch: 20, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.496 Vali Acc: 0.941 Test Loss: 0.496 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 21 cost time: 0.4319620132446289
Epoch: 21, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.449 Vali Acc: 0.941 Test Loss: 0.449 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 22 cost time: 0.4721522331237793
Epoch: 22, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.409 Vali Acc: 0.941 Test Loss: 0.409 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.4561004638671875
Epoch: 23, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.375 Vali Acc: 0.944 Test Loss: 0.375 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.4301435947418213
Epoch: 24, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.346 Vali Acc: 0.952 Test Loss: 0.346 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 25 cost time: 0.45105719566345215
Epoch: 25, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.321 Vali Acc: 0.952 Test Loss: 0.321 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.46648335456848145
Epoch: 26, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 27 cost time: 0.5117166042327881
Epoch: 27, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.283 Vali Acc: 0.956 Test Loss: 0.283 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.49651217460632324
Epoch: 28, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.269 Vali Acc: 0.956 Test Loss: 0.269 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.4960951805114746
Epoch: 29, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.256 Vali Acc: 0.956 Test Loss: 0.256 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.48369884490966797
Epoch: 30, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.246 Vali Acc: 0.956 Test Loss: 0.246 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 31 cost time: 0.4896829128265381
Epoch: 31, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.237 Vali Acc: 0.956 Test Loss: 0.237 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 32 cost time: 0.5039188861846924
Epoch: 32, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 33 cost time: 0.5179452896118164
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 34 cost time: 0.48322272300720215
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 35 cost time: 0.4400355815887451
Epoch: 35, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.4790005683898926
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.4849703311920166
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.46936607360839844
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.4566168785095215
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.567681074142456
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.5307178497314453
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.5187468528747559
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 43 cost time: 0.44362831115722656
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 44 cost time: 0.508866548538208
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.5051960945129395
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.4942612648010254
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 47 cost time: 0.6158831119537354
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.4895505905151367
Epoch: 48, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.4650239944458008
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.5273194313049316
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1472262
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5524516105651855
Epoch: 1, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.800 Vali Acc: 0.122 Test Loss: 1.800 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.356156587600708
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.755 Vali Acc: 0.285 Test Loss: 1.755 Test Acc: 0.285
Validation loss decreased (-0.122204 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.4147341251373291
Epoch: 3, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.702 Vali Acc: 0.467 Test Loss: 1.702 Test Acc: 0.467
Validation loss decreased (-0.285168 --> -0.466650).  Saving model ...
Epoch: 4 cost time: 0.40198445320129395
Epoch: 4, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.619 Vali Acc: 0.644 Test Loss: 1.619 Test Acc: 0.644
Validation loss decreased (-0.466650 --> -0.644428).  Saving model ...
Epoch: 5 cost time: 0.38896918296813965
Epoch: 5, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.514 Vali Acc: 0.744 Test Loss: 1.514 Test Acc: 0.744
Validation loss decreased (-0.644428 --> -0.744429).  Saving model ...
Epoch: 6 cost time: 0.3906722068786621
Epoch: 6, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.393 Vali Acc: 0.785 Test Loss: 1.393 Test Acc: 0.785
Validation loss decreased (-0.744429 --> -0.785171).  Saving model ...
Epoch: 7 cost time: 0.3734767436981201
Epoch: 7, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.260 Vali Acc: 0.800 Test Loss: 1.260 Test Acc: 0.800
Validation loss decreased (-0.785171 --> -0.799987).  Saving model ...
Epoch: 8 cost time: 0.36002635955810547
Epoch: 8, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.120 Vali Acc: 0.804 Test Loss: 1.120 Test Acc: 0.804
Validation loss decreased (-0.799987 --> -0.803693).  Saving model ...
Epoch: 9 cost time: 0.3779282569885254
Epoch: 9, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.980 Vali Acc: 0.826 Test Loss: 0.980 Test Acc: 0.826
Validation loss decreased (-0.803693 --> -0.825916).  Saving model ...
Epoch: 10 cost time: 0.3564732074737549
Epoch: 10, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.844 Vali Acc: 0.874 Test Loss: 0.844 Test Acc: 0.874
Validation loss decreased (-0.825916 --> -0.874066).  Saving model ...
Epoch: 11 cost time: 0.4190654754638672
Epoch: 11, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.718 Vali Acc: 0.907 Test Loss: 0.718 Test Acc: 0.907
Validation loss decreased (-0.874066 --> -0.907400).  Saving model ...
Epoch: 12 cost time: 0.39173364639282227
Epoch: 12, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.604 Vali Acc: 0.930 Test Loss: 0.604 Test Acc: 0.930
Validation loss decreased (-0.907400 --> -0.929624).  Saving model ...
Epoch: 13 cost time: 0.3740346431732178
Epoch: 13, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.506 Vali Acc: 0.941 Test Loss: 0.506 Test Acc: 0.941
Validation loss decreased (-0.929624 --> -0.940736).  Saving model ...
Epoch: 14 cost time: 0.3526430130004883
Epoch: 14, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.424 Vali Acc: 0.944 Test Loss: 0.424 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 15 cost time: 0.41205382347106934
Epoch: 15, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.358 Vali Acc: 0.944 Test Loss: 0.358 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 16 cost time: 0.3961355686187744
Epoch: 16, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.5583024024963379
Epoch: 17, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 18 cost time: 0.3477904796600342
Epoch: 18, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.4246971607208252
Epoch: 19, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.3884155750274658
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.40553951263427734
Epoch: 21, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.39083290100097656
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.4173712730407715
Epoch: 23, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.3694334030151367
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.3703956604003906
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.45774316787719727
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.4145314693450928
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 28 cost time: 0.40206170082092285
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 29 cost time: 0.39729905128479004
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 30 cost time: 0.3814702033996582
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 31 cost time: 0.4503214359283447
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.948147 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.3858935832977295
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.4549601078033447
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.44548869132995605
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.3807337284088135
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.39570093154907227
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.38267087936401367
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.3696143627166748
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.4713709354400635
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.41950368881225586
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.3850834369659424
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.38966894149780273
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.3874225616455078
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.39554405212402344
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.3868999481201172
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.3672492504119873
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.44939279556274414
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.4024486541748047
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.39873266220092773
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.412977933883667
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 480198
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7911460399627686
Epoch: 1, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.767 Vali Acc: 0.311 Test Loss: 1.767 Test Acc: 0.311
Validation loss decreased (inf --> -0.311093).  Saving model ...
Epoch: 2 cost time: 0.4361386299133301
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.743 Vali Acc: 0.363 Test Loss: 1.743 Test Acc: 0.363
Validation loss decreased (-0.311093 --> -0.362946).  Saving model ...
Epoch: 3 cost time: 0.3923048973083496
Epoch: 3, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.717 Vali Acc: 0.400 Test Loss: 1.717 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399983).  Saving model ...
Epoch: 4 cost time: 0.3672935962677002
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.677 Vali Acc: 0.470 Test Loss: 1.677 Test Acc: 0.470
Validation loss decreased (-0.399983 --> -0.470354).  Saving model ...
Epoch: 5 cost time: 0.40955090522766113
Epoch: 5, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.623 Vali Acc: 0.567 Test Loss: 1.623 Test Acc: 0.567
Validation loss decreased (-0.470354 --> -0.566650).  Saving model ...
Epoch: 6 cost time: 0.3931610584259033
Epoch: 6, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.556 Vali Acc: 0.704 Test Loss: 1.556 Test Acc: 0.704
Validation loss decreased (-0.566650 --> -0.703688).  Saving model ...
Epoch: 7 cost time: 0.4285452365875244
Epoch: 7, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.479 Vali Acc: 0.774 Test Loss: 1.479 Test Acc: 0.774
Validation loss decreased (-0.703688 --> -0.774059).  Saving model ...
Epoch: 8 cost time: 0.4352247714996338
Epoch: 8, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.391 Vali Acc: 0.841 Test Loss: 1.391 Test Acc: 0.841
Validation loss decreased (-0.774059 --> -0.840727).  Saving model ...
Epoch: 9 cost time: 0.46668434143066406
Epoch: 9, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.296 Vali Acc: 0.878 Test Loss: 1.296 Test Acc: 0.878
Validation loss decreased (-0.840727 --> -0.877765).  Saving model ...
Epoch: 10 cost time: 0.47452378273010254
Epoch: 10, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.197 Vali Acc: 0.885 Test Loss: 1.197 Test Acc: 0.885
Validation loss decreased (-0.877765 --> -0.885173).  Saving model ...
Epoch: 11 cost time: 0.39879560470581055
Epoch: 11, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.093 Vali Acc: 0.904 Test Loss: 1.093 Test Acc: 0.904
Validation loss decreased (-0.885173 --> -0.903693).  Saving model ...
Epoch: 12 cost time: 0.41445136070251465
Epoch: 12, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.989 Vali Acc: 0.907 Test Loss: 0.989 Test Acc: 0.907
Validation loss decreased (-0.903693 --> -0.907398).  Saving model ...
Epoch: 13 cost time: 0.40173912048339844
Epoch: 13, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.887 Vali Acc: 0.911 Test Loss: 0.887 Test Acc: 0.911
Validation loss decreased (-0.907398 --> -0.911102).  Saving model ...
Epoch: 14 cost time: 0.4269382953643799
Epoch: 14, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.791 Vali Acc: 0.911 Test Loss: 0.791 Test Acc: 0.911
Validation loss decreased (-0.911102 --> -0.911103).  Saving model ...
Epoch: 15 cost time: 0.48889994621276855
Epoch: 15, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.701 Vali Acc: 0.904 Test Loss: 0.701 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4723532199859619
Epoch: 16, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.619 Vali Acc: 0.911 Test Loss: 0.619 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911105).  Saving model ...
Epoch: 17 cost time: 0.4393270015716553
Epoch: 17, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.545 Vali Acc: 0.907 Test Loss: 0.545 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4733452796936035
Epoch: 18, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.480 Vali Acc: 0.915 Test Loss: 0.480 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 19 cost time: 0.3988773822784424
Epoch: 19, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.428 Vali Acc: 0.915 Test Loss: 0.428 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.39586615562438965
Epoch: 20, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.382 Vali Acc: 0.915 Test Loss: 0.382 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 21 cost time: 0.46308016777038574
Epoch: 21, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 22 cost time: 0.41475820541381836
Epoch: 22, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 23 cost time: 0.4733874797821045
Epoch: 23, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 24 cost time: 0.454270601272583
Epoch: 24, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.4317028522491455
Epoch: 25, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 26 cost time: 0.37255430221557617
Epoch: 26, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.4045395851135254
Epoch: 27, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.4187474250793457
Epoch: 28, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.41237354278564453
Epoch: 29, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.45702552795410156
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.45030975341796875
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.45664215087890625
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5397298336029053
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.4464080333709717
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.44168996810913086
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.4213130474090576
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.3960866928100586
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.4199202060699463
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.42691922187805176
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.4532930850982666
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.40793490409851074
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.4254789352416992
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.5093686580657959
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.46236371994018555
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.4667665958404541
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.40319275856018066
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.439746618270874
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.4182407855987549
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.4888877868652344
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.4532322883605957
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 428102
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7499816417694092
Epoch: 1, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.715 Vali Acc: 0.248 Test Loss: 1.715 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 0.40534210205078125
Epoch: 2, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.691 Vali Acc: 0.333 Test Loss: 1.691 Test Acc: 0.333
Validation loss decreased (-0.248131 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.49841952323913574
Epoch: 3, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.667 Vali Acc: 0.374 Test Loss: 1.667 Test Acc: 0.374
Validation loss decreased (-0.333316 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.39794039726257324
Epoch: 4, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.635 Vali Acc: 0.400 Test Loss: 1.635 Test Acc: 0.400
Validation loss decreased (-0.374057 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 0.43854212760925293
Epoch: 5, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.592 Vali Acc: 0.463 Test Loss: 1.592 Test Acc: 0.463
Validation loss decreased (-0.399984 --> -0.462947).  Saving model ...
Epoch: 6 cost time: 0.38056087493896484
Epoch: 6, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.540 Vali Acc: 0.530 Test Loss: 1.540 Test Acc: 0.530
Validation loss decreased (-0.462947 --> -0.529614).  Saving model ...
Epoch: 7 cost time: 0.4082062244415283
Epoch: 7, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.479 Vali Acc: 0.604 Test Loss: 1.479 Test Acc: 0.604
Validation loss decreased (-0.529614 --> -0.603689).  Saving model ...
Epoch: 8 cost time: 0.44387197494506836
Epoch: 8, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.410 Vali Acc: 0.670 Test Loss: 1.410 Test Acc: 0.670
Validation loss decreased (-0.603689 --> -0.670356).  Saving model ...
Epoch: 9 cost time: 0.4445536136627197
Epoch: 9, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.335 Vali Acc: 0.726 Test Loss: 1.335 Test Acc: 0.726
Validation loss decreased (-0.670356 --> -0.725913).  Saving model ...
Epoch: 10 cost time: 0.48705315589904785
Epoch: 10, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.254 Vali Acc: 0.789 Test Loss: 1.254 Test Acc: 0.789
Validation loss decreased (-0.725913 --> -0.788876).  Saving model ...
Epoch: 11 cost time: 0.4097113609313965
Epoch: 11, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.169 Vali Acc: 0.804 Test Loss: 1.169 Test Acc: 0.804
Validation loss decreased (-0.788876 --> -0.803692).  Saving model ...
Epoch: 12 cost time: 0.38153600692749023
Epoch: 12, Steps: 2 | Train Loss: 0.879 Vali Loss: 1.083 Vali Acc: 0.822 Test Loss: 1.083 Test Acc: 0.822
Validation loss decreased (-0.803692 --> -0.822211).  Saving model ...
Epoch: 13 cost time: 0.3990316390991211
Epoch: 13, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.997 Vali Acc: 0.830 Test Loss: 0.997 Test Acc: 0.830
Validation loss decreased (-0.822211 --> -0.829620).  Saving model ...
Epoch: 14 cost time: 0.40421628952026367
Epoch: 14, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.910 Vali Acc: 0.867 Test Loss: 0.910 Test Acc: 0.867
Validation loss decreased (-0.829620 --> -0.866658).  Saving model ...
Epoch: 15 cost time: 0.434070348739624
Epoch: 15, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.827 Vali Acc: 0.889 Test Loss: 0.827 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888881).  Saving model ...
Epoch: 16 cost time: 0.42537808418273926
Epoch: 16, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.747 Vali Acc: 0.900 Test Loss: 0.747 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.4296145439147949
Epoch: 17, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.670 Vali Acc: 0.904 Test Loss: 0.670 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 18 cost time: 0.4724996089935303
Epoch: 18, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.600 Vali Acc: 0.907 Test Loss: 0.600 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 19 cost time: 0.4350614547729492
Epoch: 19, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.538 Vali Acc: 0.911 Test Loss: 0.538 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911106).  Saving model ...
Epoch: 20 cost time: 0.49013638496398926
Epoch: 20, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.484 Vali Acc: 0.915 Test Loss: 0.484 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 21 cost time: 0.446225643157959
Epoch: 21, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 22 cost time: 0.43314218521118164
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.395 Vali Acc: 0.922 Test Loss: 0.395 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 23 cost time: 0.39838075637817383
Epoch: 23, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 0.48412108421325684
Epoch: 24, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 25 cost time: 0.4865858554840088
Epoch: 25, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 0.4386179447174072
Epoch: 26, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 27 cost time: 0.421034574508667
Epoch: 27, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.42667675018310547
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.3859214782714844
Epoch: 29, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.3928341865539551
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.5053279399871826
Epoch: 31, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.476682186126709
Epoch: 32, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.4967920780181885
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.44469785690307617
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.4317600727081299
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.4174830913543701
Epoch: 36, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4589214324951172
Epoch: 37, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.42238402366638184
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.46054935455322266
Epoch: 39, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.5137267112731934
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.4771571159362793
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.4260849952697754
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.497666597366333
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.3963346481323242
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.47360920906066895
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.462144136428833
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.4539217948913574
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.5294530391693115
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.4434828758239746
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.47502779960632324
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 412806
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7300889492034912
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.843 Vali Acc: 0.122 Test Loss: 1.843 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.4301574230194092
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.827 Vali Acc: 0.170 Test Loss: 1.827 Test Acc: 0.170
Validation loss decreased (-0.122204 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 0.38835597038269043
Epoch: 3, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.811 Vali Acc: 0.200 Test Loss: 1.811 Test Acc: 0.200
Validation loss decreased (-0.170352 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.3952486515045166
Epoch: 4, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.789 Vali Acc: 0.248 Test Loss: 1.789 Test Acc: 0.248
Validation loss decreased (-0.199982 --> -0.248130).  Saving model ...
Epoch: 5 cost time: 0.49181246757507324
Epoch: 5, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.760 Vali Acc: 0.311 Test Loss: 1.760 Test Acc: 0.311
Validation loss decreased (-0.248130 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 0.4720289707183838
Epoch: 6, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.723 Vali Acc: 0.381 Test Loss: 1.723 Test Acc: 0.381
Validation loss decreased (-0.311094 --> -0.381464).  Saving model ...
Epoch: 7 cost time: 0.47237420082092285
Epoch: 7, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.679 Vali Acc: 0.396 Test Loss: 1.679 Test Acc: 0.396
Validation loss decreased (-0.381464 --> -0.396280).  Saving model ...
Epoch: 8 cost time: 0.44280099868774414
Epoch: 8, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.627 Vali Acc: 0.441 Test Loss: 1.627 Test Acc: 0.441
Validation loss decreased (-0.396280 --> -0.440724).  Saving model ...
Epoch: 9 cost time: 0.4314463138580322
Epoch: 9, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.570 Vali Acc: 0.478 Test Loss: 1.570 Test Acc: 0.478
Validation loss decreased (-0.440724 --> -0.477762).  Saving model ...
Epoch: 10 cost time: 0.39369988441467285
Epoch: 10, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.506 Vali Acc: 0.533 Test Loss: 1.506 Test Acc: 0.533
Validation loss decreased (-0.477762 --> -0.533318).  Saving model ...
Epoch: 11 cost time: 0.4396355152130127
Epoch: 11, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.437 Vali Acc: 0.604 Test Loss: 1.437 Test Acc: 0.604
Validation loss decreased (-0.533318 --> -0.603689).  Saving model ...
Epoch: 12 cost time: 0.421588659286499
Epoch: 12, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.363 Vali Acc: 0.711 Test Loss: 1.363 Test Acc: 0.711
Validation loss decreased (-0.603689 --> -0.711097).  Saving model ...
Epoch: 13 cost time: 0.4514033794403076
Epoch: 13, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.284 Vali Acc: 0.763 Test Loss: 1.284 Test Acc: 0.763
Validation loss decreased (-0.711097 --> -0.762950).  Saving model ...
Epoch: 14 cost time: 0.41634464263916016
Epoch: 14, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.203 Vali Acc: 0.807 Test Loss: 1.203 Test Acc: 0.807
Validation loss decreased (-0.762950 --> -0.807395).  Saving model ...
Epoch: 15 cost time: 0.3946387767791748
Epoch: 15, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.118 Vali Acc: 0.852 Test Loss: 1.118 Test Acc: 0.852
Validation loss decreased (-0.807395 --> -0.851841).  Saving model ...
Epoch: 16 cost time: 0.40868377685546875
Epoch: 16, Steps: 2 | Train Loss: 0.793 Vali Loss: 1.035 Vali Acc: 0.856 Test Loss: 1.035 Test Acc: 0.856
Validation loss decreased (-0.851841 --> -0.855545).  Saving model ...
Epoch: 17 cost time: 0.4522862434387207
Epoch: 17, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.952 Vali Acc: 0.867 Test Loss: 0.952 Test Acc: 0.867
Validation loss decreased (-0.855545 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 0.391129732131958
Epoch: 18, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.869 Vali Acc: 0.867 Test Loss: 0.869 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866658).  Saving model ...
Epoch: 19 cost time: 0.4106137752532959
Epoch: 19, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.791 Vali Acc: 0.881 Test Loss: 0.791 Test Acc: 0.881
Validation loss decreased (-0.866658 --> -0.881474).  Saving model ...
Epoch: 20 cost time: 0.42514824867248535
Epoch: 20, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.718 Vali Acc: 0.889 Test Loss: 0.718 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 21 cost time: 0.49189066886901855
Epoch: 21, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.651 Vali Acc: 0.896 Test Loss: 0.651 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 22 cost time: 0.4356422424316406
Epoch: 22, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.590 Vali Acc: 0.904 Test Loss: 0.590 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 23 cost time: 0.4334373474121094
Epoch: 23, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.536 Vali Acc: 0.919 Test Loss: 0.536 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.40785741806030273
Epoch: 24, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.488 Vali Acc: 0.922 Test Loss: 0.488 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.3974611759185791
Epoch: 25, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.446 Vali Acc: 0.937 Test Loss: 0.446 Test Acc: 0.937
Validation loss decreased (-0.922217 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.4088883399963379
Epoch: 26, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.411 Vali Acc: 0.941 Test Loss: 0.411 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 27 cost time: 0.45888376235961914
Epoch: 27, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.380 Vali Acc: 0.948 Test Loss: 0.380 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948144).  Saving model ...
Epoch: 28 cost time: 0.4905741214752197
Epoch: 28, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.354 Vali Acc: 0.952 Test Loss: 0.354 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 29 cost time: 0.45547938346862793
Epoch: 29, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.332 Vali Acc: 0.952 Test Loss: 0.332 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.4583168029785156
Epoch: 30, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.313 Vali Acc: 0.952 Test Loss: 0.313 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.49967026710510254
Epoch: 31, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.297 Vali Acc: 0.952 Test Loss: 0.297 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.45325469970703125
Epoch: 32, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.284 Vali Acc: 0.952 Test Loss: 0.284 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.44732117652893066
Epoch: 33, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.43872809410095215
Epoch: 34, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.4000866413116455
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.952 Test Loss: 0.255 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.4224257469177246
Epoch: 36, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.248 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.5635147094726562
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.4559352397918701
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.45021748542785645
Epoch: 39, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.49986886978149414
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.952 Test Loss: 0.227 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.5132865905761719
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.952 Test Loss: 0.224 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.45624494552612305
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.4809842109680176
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.46362900733947754
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.4418220520019531
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.952 Test Loss: 0.213 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.43913912773132324
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.44870829582214355
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.47767186164855957
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.45121073722839355
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.4173548221588135
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 403718
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6252973079681396
Epoch: 1, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.809 Vali Acc: 0.078 Test Loss: 1.809 Test Acc: 0.078
Validation loss decreased (inf --> -0.077760).  Saving model ...
Epoch: 2 cost time: 0.43971800804138184
Epoch: 2, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.793 Vali Acc: 0.089 Test Loss: 1.793 Test Acc: 0.089
Validation loss decreased (-0.077760 --> -0.088871).  Saving model ...
Epoch: 3 cost time: 0.40543174743652344
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.777 Vali Acc: 0.133 Test Loss: 1.777 Test Acc: 0.133
Validation loss decreased (-0.088871 --> -0.133316).  Saving model ...
Epoch: 4 cost time: 0.3940558433532715
Epoch: 4, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.756 Vali Acc: 0.241 Test Loss: 1.756 Test Acc: 0.241
Validation loss decreased (-0.133316 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.4824237823486328
Epoch: 5, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.728 Vali Acc: 0.285 Test Loss: 1.728 Test Acc: 0.285
Validation loss decreased (-0.240723 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 0.48043036460876465
Epoch: 6, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.694 Vali Acc: 0.356 Test Loss: 1.694 Test Acc: 0.356
Validation loss decreased (-0.285168 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.42700934410095215
Epoch: 7, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.653 Vali Acc: 0.400 Test Loss: 1.653 Test Acc: 0.400
Validation loss decreased (-0.355539 --> -0.399983).  Saving model ...
Epoch: 8 cost time: 0.4203336238861084
Epoch: 8, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.607 Vali Acc: 0.456 Test Loss: 1.607 Test Acc: 0.456
Validation loss decreased (-0.399983 --> -0.455539).  Saving model ...
Epoch: 9 cost time: 0.49090099334716797
Epoch: 9, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.556 Vali Acc: 0.526 Test Loss: 1.556 Test Acc: 0.526
Validation loss decreased (-0.455539 --> -0.525910).  Saving model ...
Epoch: 10 cost time: 0.532928466796875
Epoch: 10, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.499 Vali Acc: 0.596 Test Loss: 1.499 Test Acc: 0.596
Validation loss decreased (-0.525910 --> -0.596281).  Saving model ...
Epoch: 11 cost time: 0.5004608631134033
Epoch: 11, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.438 Vali Acc: 0.693 Test Loss: 1.438 Test Acc: 0.693
Validation loss decreased (-0.596281 --> -0.692578).  Saving model ...
Epoch: 12 cost time: 0.4548470973968506
Epoch: 12, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.372 Vali Acc: 0.748 Test Loss: 1.372 Test Acc: 0.748
Validation loss decreased (-0.692578 --> -0.748134).  Saving model ...
Epoch: 13 cost time: 0.43821024894714355
Epoch: 13, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.303 Vali Acc: 0.815 Test Loss: 1.303 Test Acc: 0.815
Validation loss decreased (-0.748134 --> -0.814802).  Saving model ...
Epoch: 14 cost time: 0.5270388126373291
Epoch: 14, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.231 Vali Acc: 0.837 Test Loss: 1.231 Test Acc: 0.837
Validation loss decreased (-0.814802 --> -0.837025).  Saving model ...
Epoch: 15 cost time: 0.4870436191558838
Epoch: 15, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.156 Vali Acc: 0.870 Test Loss: 1.156 Test Acc: 0.870
Validation loss decreased (-0.837025 --> -0.870359).  Saving model ...
Epoch: 16 cost time: 0.5248863697052002
Epoch: 16, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.080 Vali Acc: 0.878 Test Loss: 1.080 Test Acc: 0.878
Validation loss decreased (-0.870359 --> -0.877767).  Saving model ...
Epoch: 17 cost time: 0.5962989330291748
Epoch: 17, Steps: 2 | Train Loss: 0.834 Vali Loss: 1.003 Vali Acc: 0.889 Test Loss: 1.003 Test Acc: 0.889
Validation loss decreased (-0.877767 --> -0.888879).  Saving model ...
Epoch: 18 cost time: 0.4773714542388916
Epoch: 18, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.927 Vali Acc: 0.900 Test Loss: 0.927 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899991).  Saving model ...
Epoch: 19 cost time: 0.46724605560302734
Epoch: 19, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.852 Vali Acc: 0.922 Test Loss: 0.852 Test Acc: 0.922
Validation loss decreased (-0.899991 --> -0.922214).  Saving model ...
Epoch: 20 cost time: 0.4971139430999756
Epoch: 20, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.780 Vali Acc: 0.930 Test Loss: 0.780 Test Acc: 0.930
Validation loss decreased (-0.922214 --> -0.929622).  Saving model ...
Epoch: 21 cost time: 0.553617000579834
Epoch: 21, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.712 Vali Acc: 0.933 Test Loss: 0.712 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933326).  Saving model ...
Epoch: 22 cost time: 0.5045125484466553
Epoch: 22, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.650 Vali Acc: 0.933 Test Loss: 0.650 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933327).  Saving model ...
Epoch: 23 cost time: 0.4613163471221924
Epoch: 23, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.593 Vali Acc: 0.933 Test Loss: 0.593 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 24 cost time: 0.506129264831543
Epoch: 24, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.541 Vali Acc: 0.933 Test Loss: 0.541 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 25 cost time: 0.5151686668395996
Epoch: 25, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.495 Vali Acc: 0.933 Test Loss: 0.495 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 26 cost time: 0.45034313201904297
Epoch: 26, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.455 Vali Acc: 0.941 Test Loss: 0.455 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 27 cost time: 0.5432000160217285
Epoch: 27, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.419 Vali Acc: 0.941 Test Loss: 0.419 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.5034136772155762
Epoch: 28, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.388 Vali Acc: 0.952 Test Loss: 0.388 Test Acc: 0.952
Validation loss decreased (-0.940737 --> -0.951848).  Saving model ...
Epoch: 29 cost time: 0.5180399417877197
Epoch: 29, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.361 Vali Acc: 0.952 Test Loss: 0.361 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 30 cost time: 0.5292792320251465
Epoch: 30, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.339 Vali Acc: 0.952 Test Loss: 0.339 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 31 cost time: 0.505352258682251
Epoch: 31, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.319 Vali Acc: 0.952 Test Loss: 0.319 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.49222874641418457
Epoch: 32, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.4559140205383301
Epoch: 33, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.288 Vali Acc: 0.956 Test Loss: 0.288 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 34 cost time: 0.494551420211792
Epoch: 34, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.275 Vali Acc: 0.956 Test Loss: 0.275 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 35 cost time: 0.46067309379577637
Epoch: 35, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.264 Vali Acc: 0.956 Test Loss: 0.264 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.5238046646118164
Epoch: 36, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.548757791519165
Epoch: 37, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.4917421340942383
Epoch: 38, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.239 Vali Acc: 0.956 Test Loss: 0.239 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.48396849632263184
Epoch: 39, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.5099363327026367
Epoch: 40, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.4281580448150635
Epoch: 41, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.5180227756500244
Epoch: 42, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.43227124214172363
Epoch: 43, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.5264291763305664
Epoch: 44, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.5508077144622803
Epoch: 45, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.4553203582763672
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.5126168727874756
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5215628147125244
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5547301769256592
Epoch: 49, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.5250453948974609
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 400838
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8286569118499756
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.777 Vali Acc: 0.263 Test Loss: 1.777 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.4420936107635498
Epoch: 2, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.762 Vali Acc: 0.293 Test Loss: 1.762 Test Acc: 0.293
Validation loss decreased (-0.262945 --> -0.292575).  Saving model ...
Epoch: 3 cost time: 0.3847532272338867
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.748 Vali Acc: 0.311 Test Loss: 1.748 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 4 cost time: 0.43770480155944824
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.732 Vali Acc: 0.315 Test Loss: 1.732 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314797).  Saving model ...
Epoch: 5 cost time: 0.3784966468811035
Epoch: 5, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.710 Vali Acc: 0.352 Test Loss: 1.710 Test Acc: 0.352
Validation loss decreased (-0.314797 --> -0.351835).  Saving model ...
Epoch: 6 cost time: 0.37127113342285156
Epoch: 6, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.682 Vali Acc: 0.389 Test Loss: 1.682 Test Acc: 0.389
Validation loss decreased (-0.351835 --> -0.388872).  Saving model ...
Epoch: 7 cost time: 0.4243488311767578
Epoch: 7, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.648 Vali Acc: 0.430 Test Loss: 1.648 Test Acc: 0.430
Validation loss decreased (-0.388872 --> -0.429613).  Saving model ...
Epoch: 8 cost time: 0.4963088035583496
Epoch: 8, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.610 Vali Acc: 0.489 Test Loss: 1.610 Test Acc: 0.489
Validation loss decreased (-0.429613 --> -0.488873).  Saving model ...
Epoch: 9 cost time: 0.5049059391021729
Epoch: 9, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.566 Vali Acc: 0.578 Test Loss: 1.566 Test Acc: 0.578
Validation loss decreased (-0.488873 --> -0.577762).  Saving model ...
Epoch: 10 cost time: 0.3934905529022217
Epoch: 10, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.519 Vali Acc: 0.622 Test Loss: 1.519 Test Acc: 0.622
Validation loss decreased (-0.577762 --> -0.622207).  Saving model ...
Epoch: 11 cost time: 0.46805596351623535
Epoch: 11, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.468 Vali Acc: 0.674 Test Loss: 1.468 Test Acc: 0.674
Validation loss decreased (-0.622207 --> -0.674059).  Saving model ...
Epoch: 12 cost time: 0.4240128993988037
Epoch: 12, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.414 Vali Acc: 0.704 Test Loss: 1.414 Test Acc: 0.704
Validation loss decreased (-0.674059 --> -0.703690).  Saving model ...
Epoch: 13 cost time: 0.5769319534301758
Epoch: 13, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.356 Vali Acc: 0.733 Test Loss: 1.356 Test Acc: 0.733
Validation loss decreased (-0.703690 --> -0.733320).  Saving model ...
Epoch: 14 cost time: 0.3906409740447998
Epoch: 14, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.297 Vali Acc: 0.748 Test Loss: 1.297 Test Acc: 0.748
Validation loss decreased (-0.733320 --> -0.748135).  Saving model ...
Epoch: 15 cost time: 0.4596085548400879
Epoch: 15, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.236 Vali Acc: 0.778 Test Loss: 1.236 Test Acc: 0.778
Validation loss decreased (-0.748135 --> -0.777765).  Saving model ...
Epoch: 16 cost time: 0.36588311195373535
Epoch: 16, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.175 Vali Acc: 0.785 Test Loss: 1.175 Test Acc: 0.785
Validation loss decreased (-0.777765 --> -0.785173).  Saving model ...
Epoch: 17 cost time: 0.3621077537536621
Epoch: 17, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.113 Vali Acc: 0.819 Test Loss: 1.113 Test Acc: 0.819
Validation loss decreased (-0.785173 --> -0.818507).  Saving model ...
Epoch: 18 cost time: 0.3923530578613281
Epoch: 18, Steps: 2 | Train Loss: 0.857 Vali Loss: 1.050 Vali Acc: 0.852 Test Loss: 1.050 Test Acc: 0.852
Validation loss decreased (-0.818507 --> -0.851841).  Saving model ...
Epoch: 19 cost time: 0.4325447082519531
Epoch: 19, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.988 Vali Acc: 0.874 Test Loss: 0.988 Test Acc: 0.874
Validation loss decreased (-0.851841 --> -0.874064).  Saving model ...
Epoch: 20 cost time: 0.38066649436950684
Epoch: 20, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.926 Vali Acc: 0.885 Test Loss: 0.926 Test Acc: 0.885
Validation loss decreased (-0.874064 --> -0.885176).  Saving model ...
Epoch: 21 cost time: 0.38874053955078125
Epoch: 21, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.866 Vali Acc: 0.893 Test Loss: 0.866 Test Acc: 0.893
Validation loss decreased (-0.885176 --> -0.892584).  Saving model ...
Epoch: 22 cost time: 0.37174558639526367
Epoch: 22, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.808 Vali Acc: 0.900 Test Loss: 0.808 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 23 cost time: 0.3620591163635254
Epoch: 23, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.755 Vali Acc: 0.904 Test Loss: 0.755 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 24 cost time: 0.39543819427490234
Epoch: 24, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.704 Vali Acc: 0.904 Test Loss: 0.704 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 25 cost time: 0.4618983268737793
Epoch: 25, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.658 Vali Acc: 0.915 Test Loss: 0.658 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914808).  Saving model ...
Epoch: 26 cost time: 0.4194302558898926
Epoch: 26, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.615 Vali Acc: 0.915 Test Loss: 0.615 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 27 cost time: 0.4590182304382324
Epoch: 27, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.576 Vali Acc: 0.919 Test Loss: 0.576 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 28 cost time: 0.4010806083679199
Epoch: 28, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.541 Vali Acc: 0.922 Test Loss: 0.541 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 29 cost time: 0.3742363452911377
Epoch: 29, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.509 Vali Acc: 0.926 Test Loss: 0.509 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 30 cost time: 0.36976027488708496
Epoch: 30, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.479 Vali Acc: 0.926 Test Loss: 0.479 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 31 cost time: 0.4108011722564697
Epoch: 31, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.453 Vali Acc: 0.926 Test Loss: 0.453 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 32 cost time: 0.39354825019836426
Epoch: 32, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.430 Vali Acc: 0.930 Test Loss: 0.430 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 33 cost time: 0.4751904010772705
Epoch: 33, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.409 Vali Acc: 0.930 Test Loss: 0.409 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.4012026786804199
Epoch: 34, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.390 Vali Acc: 0.933 Test Loss: 0.390 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.366779088973999
Epoch: 35, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.372 Vali Acc: 0.937 Test Loss: 0.372 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 36 cost time: 0.37152528762817383
Epoch: 36, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 37 cost time: 0.39513707160949707
Epoch: 37, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.342 Vali Acc: 0.941 Test Loss: 0.342 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 38 cost time: 0.3787522315979004
Epoch: 38, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 39 cost time: 0.4027833938598633
Epoch: 39, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.3829464912414551
Epoch: 40, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.38596606254577637
Epoch: 41, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 42 cost time: 0.3771529197692871
Epoch: 42, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 43 cost time: 0.4110245704650879
Epoch: 43, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.278 Vali Acc: 0.952 Test Loss: 0.278 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.4009280204772949
Epoch: 44, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.270 Vali Acc: 0.952 Test Loss: 0.270 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 45 cost time: 0.4828038215637207
Epoch: 45, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.264 Vali Acc: 0.952 Test Loss: 0.264 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 46 cost time: 0.38483643531799316
Epoch: 46, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.257 Vali Acc: 0.959 Test Loss: 0.257 Test Acc: 0.959
Validation loss decreased (-0.951849 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.40007448196411133
Epoch: 47, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.252 Vali Acc: 0.959 Test Loss: 0.252 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.38631391525268555
Epoch: 48, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.247 Vali Acc: 0.959 Test Loss: 0.247 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.3961031436920166
Epoch: 49, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.3907458782196045
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.959 Test Loss: 0.238 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 394886
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8318796157836914
Epoch: 1, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.769 Vali Acc: 0.174 Test Loss: 1.769 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.45314478874206543
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.754 Vali Acc: 0.181 Test Loss: 1.754 Test Acc: 0.181
Validation loss decreased (-0.174056 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.43584394454956055
Epoch: 3, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.741 Vali Acc: 0.204 Test Loss: 1.741 Test Acc: 0.204
Validation loss decreased (-0.181464 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.5076797008514404
Epoch: 4, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.725 Vali Acc: 0.219 Test Loss: 1.725 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 0.4768557548522949
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.704 Vali Acc: 0.278 Test Loss: 1.704 Test Acc: 0.278
Validation loss decreased (-0.218501 --> -0.277761).  Saving model ...
Epoch: 6 cost time: 0.5801448822021484
Epoch: 6, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.678 Vali Acc: 0.356 Test Loss: 1.678 Test Acc: 0.356
Validation loss decreased (-0.277761 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.540276288986206
Epoch: 7, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.647 Vali Acc: 0.437 Test Loss: 1.647 Test Acc: 0.437
Validation loss decreased (-0.355539 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 0.4666564464569092
Epoch: 8, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.612 Vali Acc: 0.511 Test Loss: 1.612 Test Acc: 0.511
Validation loss decreased (-0.437021 --> -0.511095).  Saving model ...
Epoch: 9 cost time: 0.5311233997344971
Epoch: 9, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.573 Vali Acc: 0.581 Test Loss: 1.573 Test Acc: 0.581
Validation loss decreased (-0.511095 --> -0.581466).  Saving model ...
Epoch: 10 cost time: 0.5120365619659424
Epoch: 10, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.529 Vali Acc: 0.641 Test Loss: 1.529 Test Acc: 0.641
Validation loss decreased (-0.581466 --> -0.640725).  Saving model ...
Epoch: 11 cost time: 0.5178682804107666
Epoch: 11, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.481 Vali Acc: 0.707 Test Loss: 1.481 Test Acc: 0.707
Validation loss decreased (-0.640725 --> -0.707393).  Saving model ...
Epoch: 12 cost time: 0.45752954483032227
Epoch: 12, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.430 Vali Acc: 0.744 Test Loss: 1.430 Test Acc: 0.744
Validation loss decreased (-0.707393 --> -0.744430).  Saving model ...
Epoch: 13 cost time: 0.48807215690612793
Epoch: 13, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.375 Vali Acc: 0.752 Test Loss: 1.375 Test Acc: 0.752
Validation loss decreased (-0.744430 --> -0.751838).  Saving model ...
Epoch: 14 cost time: 0.49104881286621094
Epoch: 14, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.318 Vali Acc: 0.767 Test Loss: 1.318 Test Acc: 0.767
Validation loss decreased (-0.751838 --> -0.766653).  Saving model ...
Epoch: 15 cost time: 0.43955087661743164
Epoch: 15, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.260 Vali Acc: 0.789 Test Loss: 1.260 Test Acc: 0.789
Validation loss decreased (-0.766653 --> -0.788876).  Saving model ...
Epoch: 16 cost time: 0.47387242317199707
Epoch: 16, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.200 Vali Acc: 0.804 Test Loss: 1.200 Test Acc: 0.804
Validation loss decreased (-0.788876 --> -0.803692).  Saving model ...
Epoch: 17 cost time: 0.4859015941619873
Epoch: 17, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.139 Vali Acc: 0.844 Test Loss: 1.139 Test Acc: 0.844
Validation loss decreased (-0.803692 --> -0.844433).  Saving model ...
Epoch: 18 cost time: 0.46094846725463867
Epoch: 18, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.078 Vali Acc: 0.859 Test Loss: 1.078 Test Acc: 0.859
Validation loss decreased (-0.844433 --> -0.859248).  Saving model ...
Epoch: 19 cost time: 0.5030534267425537
Epoch: 19, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.017 Vali Acc: 0.863 Test Loss: 1.017 Test Acc: 0.863
Validation loss decreased (-0.859248 --> -0.862953).  Saving model ...
Epoch: 20 cost time: 0.48592066764831543
Epoch: 20, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.957 Vali Acc: 0.881 Test Loss: 0.957 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881472).  Saving model ...
Epoch: 21 cost time: 0.5769650936126709
Epoch: 21, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.899 Vali Acc: 0.893 Test Loss: 0.899 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 22 cost time: 0.48041629791259766
Epoch: 22, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.842 Vali Acc: 0.896 Test Loss: 0.842 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896288).  Saving model ...
Epoch: 23 cost time: 0.43327951431274414
Epoch: 23, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.788 Vali Acc: 0.907 Test Loss: 0.788 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 24 cost time: 0.44139671325683594
Epoch: 24, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.738 Vali Acc: 0.915 Test Loss: 0.738 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914807).  Saving model ...
Epoch: 25 cost time: 0.44811058044433594
Epoch: 25, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.690 Vali Acc: 0.919 Test Loss: 0.690 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918512).  Saving model ...
Epoch: 26 cost time: 0.46399807929992676
Epoch: 26, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.646 Vali Acc: 0.919 Test Loss: 0.646 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 27 cost time: 0.4499523639678955
Epoch: 27, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.605 Vali Acc: 0.919 Test Loss: 0.605 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 28 cost time: 0.49896860122680664
Epoch: 28, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.568 Vali Acc: 0.926 Test Loss: 0.568 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 29 cost time: 0.4772157669067383
Epoch: 29, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.534 Vali Acc: 0.926 Test Loss: 0.534 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 30 cost time: 0.5603225231170654
Epoch: 30, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.502 Vali Acc: 0.930 Test Loss: 0.502 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 31 cost time: 0.4753282070159912
Epoch: 31, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.474 Vali Acc: 0.933 Test Loss: 0.474 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.4871687889099121
Epoch: 32, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.448 Vali Acc: 0.937 Test Loss: 0.448 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 33 cost time: 0.46978187561035156
Epoch: 33, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.425 Vali Acc: 0.937 Test Loss: 0.425 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 34 cost time: 0.5254342555999756
Epoch: 34, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.404 Vali Acc: 0.941 Test Loss: 0.404 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.46613335609436035
Epoch: 35, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.43517017364501953
Epoch: 36, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 37 cost time: 0.52427077293396
Epoch: 37, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.352 Vali Acc: 0.944 Test Loss: 0.352 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.46099853515625
Epoch: 38, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.502448558807373
Epoch: 39, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.325 Vali Acc: 0.948 Test Loss: 0.325 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 40 cost time: 0.4926631450653076
Epoch: 40, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5269656181335449
Epoch: 41, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5152623653411865
Epoch: 42, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5087602138519287
Epoch: 43, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4681718349456787
Epoch: 44, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.43570423126220703
Epoch: 45, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 46 cost time: 0.4820396900177002
Epoch: 46, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.4629385471343994
Epoch: 47, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.4511878490447998
Epoch: 48, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.5055630207061768
Epoch: 49, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.4585151672363281
Epoch: 50, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.241 Vali Acc: 0.952 Test Loss: 0.241 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 392070
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.574904203414917
Epoch: 1, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.760 Vali Acc: 0.248 Test Loss: 1.760 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 0.3704235553741455
Epoch: 2, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.726 Vali Acc: 0.378 Test Loss: 1.726 Test Acc: 0.378
Validation loss decreased (-0.248131 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 0.39980101585388184
Epoch: 3, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.692 Vali Acc: 0.493 Test Loss: 1.692 Test Acc: 0.493
Validation loss decreased (-0.377761 --> -0.492576).  Saving model ...
Epoch: 4 cost time: 0.4199666976928711
Epoch: 4, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.648 Vali Acc: 0.537 Test Loss: 1.648 Test Acc: 0.537
Validation loss decreased (-0.492576 --> -0.537021).  Saving model ...
Epoch: 5 cost time: 0.4236030578613281
Epoch: 5, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.591 Vali Acc: 0.593 Test Loss: 1.591 Test Acc: 0.593
Validation loss decreased (-0.537021 --> -0.592577).  Saving model ...
Epoch: 6 cost time: 0.4430854320526123
Epoch: 6, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.524 Vali Acc: 0.622 Test Loss: 1.524 Test Acc: 0.622
Validation loss decreased (-0.592577 --> -0.622207).  Saving model ...
Epoch: 7 cost time: 0.421769380569458
Epoch: 7, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.450 Vali Acc: 0.659 Test Loss: 1.450 Test Acc: 0.659
Validation loss decreased (-0.622207 --> -0.659245).  Saving model ...
Epoch: 8 cost time: 0.4683802127838135
Epoch: 8, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.367 Vali Acc: 0.719 Test Loss: 1.367 Test Acc: 0.719
Validation loss decreased (-0.659245 --> -0.718505).  Saving model ...
Epoch: 9 cost time: 0.41500115394592285
Epoch: 9, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.279 Vali Acc: 0.800 Test Loss: 1.279 Test Acc: 0.800
Validation loss decreased (-0.718505 --> -0.799987).  Saving model ...
Epoch: 10 cost time: 0.39757513999938965
Epoch: 10, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.188 Vali Acc: 0.837 Test Loss: 1.188 Test Acc: 0.837
Validation loss decreased (-0.799987 --> -0.837025).  Saving model ...
Epoch: 11 cost time: 0.4257216453552246
Epoch: 11, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.094 Vali Acc: 0.848 Test Loss: 1.094 Test Acc: 0.848
Validation loss decreased (-0.837025 --> -0.848137).  Saving model ...
Epoch: 12 cost time: 0.4154515266418457
Epoch: 12, Steps: 2 | Train Loss: 0.799 Vali Loss: 1.000 Vali Acc: 0.859 Test Loss: 1.000 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859249).  Saving model ...
Epoch: 13 cost time: 0.40918850898742676
Epoch: 13, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.907 Vali Acc: 0.874 Test Loss: 0.907 Test Acc: 0.874
Validation loss decreased (-0.859249 --> -0.874065).  Saving model ...
Epoch: 14 cost time: 0.40554022789001465
Epoch: 14, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.816 Vali Acc: 0.889 Test Loss: 0.816 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888881).  Saving model ...
Epoch: 15 cost time: 0.40036702156066895
Epoch: 15, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.730 Vali Acc: 0.904 Test Loss: 0.730 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903696).  Saving model ...
Epoch: 16 cost time: 0.4591042995452881
Epoch: 16, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.651 Vali Acc: 0.919 Test Loss: 0.651 Test Acc: 0.919
Validation loss decreased (-0.903696 --> -0.918512).  Saving model ...
Epoch: 17 cost time: 0.40602946281433105
Epoch: 17, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.578 Vali Acc: 0.919 Test Loss: 0.578 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 18 cost time: 0.4429891109466553
Epoch: 18, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.513 Vali Acc: 0.919 Test Loss: 0.513 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 19 cost time: 0.4672999382019043
Epoch: 19, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.456 Vali Acc: 0.926 Test Loss: 0.456 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 20 cost time: 0.4670145511627197
Epoch: 20, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.407 Vali Acc: 0.933 Test Loss: 0.407 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 21 cost time: 0.4215126037597656
Epoch: 21, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.366 Vali Acc: 0.937 Test Loss: 0.366 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.36028218269348145
Epoch: 22, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.40429139137268066
Epoch: 23, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.38835620880126953
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.37235093116760254
Epoch: 25, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.37662625312805176
Epoch: 26, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3607363700866699
Epoch: 27, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.3982384204864502
Epoch: 28, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4213552474975586
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5334603786468506
Epoch: 30, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4101095199584961
Epoch: 31, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.4535820484161377
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.42890191078186035
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.40906405448913574
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.41881728172302246
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.4103732109069824
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.42663049697875977
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.526787281036377
Epoch: 38, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.40295934677124023
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.41265201568603516
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.39901185035705566
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4105560779571533
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4574737548828125
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.43216681480407715
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.4044523239135742
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.4563894271850586
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 154086
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7288532257080078
Epoch: 1, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.788 Vali Acc: 0.200 Test Loss: 1.788 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.3994441032409668
Epoch: 2, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.766 Vali Acc: 0.207 Test Loss: 1.766 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.38840436935424805
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.745 Vali Acc: 0.233 Test Loss: 1.745 Test Acc: 0.233
Validation loss decreased (-0.207390 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.4054746627807617
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.721 Vali Acc: 0.267 Test Loss: 1.721 Test Acc: 0.267
Validation loss decreased (-0.233316 --> -0.266649).  Saving model ...
Epoch: 5 cost time: 0.39872002601623535
Epoch: 5, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.687 Vali Acc: 0.344 Test Loss: 1.687 Test Acc: 0.344
Validation loss decreased (-0.266649 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 0.47809767723083496
Epoch: 6, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.647 Vali Acc: 0.444 Test Loss: 1.647 Test Acc: 0.444
Validation loss decreased (-0.344428 --> -0.444428).  Saving model ...
Epoch: 7 cost time: 0.424116849899292
Epoch: 7, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.600 Vali Acc: 0.522 Test Loss: 1.600 Test Acc: 0.522
Validation loss decreased (-0.444428 --> -0.522206).  Saving model ...
Epoch: 8 cost time: 0.4602062702178955
Epoch: 8, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.547 Vali Acc: 0.581 Test Loss: 1.547 Test Acc: 0.581
Validation loss decreased (-0.522206 --> -0.581466).  Saving model ...
Epoch: 9 cost time: 0.4430508613586426
Epoch: 9, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.488 Vali Acc: 0.659 Test Loss: 1.488 Test Acc: 0.659
Validation loss decreased (-0.581466 --> -0.659244).  Saving model ...
Epoch: 10 cost time: 0.3788108825683594
Epoch: 10, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.425 Vali Acc: 0.715 Test Loss: 1.425 Test Acc: 0.715
Validation loss decreased (-0.659244 --> -0.714801).  Saving model ...
Epoch: 11 cost time: 0.37275052070617676
Epoch: 11, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.358 Vali Acc: 0.733 Test Loss: 1.358 Test Acc: 0.733
Validation loss decreased (-0.714801 --> -0.733320).  Saving model ...
Epoch: 12 cost time: 0.4592714309692383
Epoch: 12, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.289 Vali Acc: 0.770 Test Loss: 1.289 Test Acc: 0.770
Validation loss decreased (-0.733320 --> -0.770357).  Saving model ...
Epoch: 13 cost time: 0.39531683921813965
Epoch: 13, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.217 Vali Acc: 0.819 Test Loss: 1.217 Test Acc: 0.819
Validation loss decreased (-0.770357 --> -0.818506).  Saving model ...
Epoch: 14 cost time: 0.47727060317993164
Epoch: 14, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.144 Vali Acc: 0.830 Test Loss: 1.144 Test Acc: 0.830
Validation loss decreased (-0.818506 --> -0.829618).  Saving model ...
Epoch: 15 cost time: 0.5325894355773926
Epoch: 15, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.070 Vali Acc: 0.870 Test Loss: 1.070 Test Acc: 0.870
Validation loss decreased (-0.829618 --> -0.870360).  Saving model ...
Epoch: 16 cost time: 0.4210383892059326
Epoch: 16, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.996 Vali Acc: 0.874 Test Loss: 0.996 Test Acc: 0.874
Validation loss decreased (-0.870360 --> -0.874064).  Saving model ...
Epoch: 17 cost time: 0.4491884708404541
Epoch: 17, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.924 Vali Acc: 0.881 Test Loss: 0.924 Test Acc: 0.881
Validation loss decreased (-0.874064 --> -0.881472).  Saving model ...
Epoch: 18 cost time: 0.3681337833404541
Epoch: 18, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.854 Vali Acc: 0.889 Test Loss: 0.854 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888880).  Saving model ...
Epoch: 19 cost time: 0.41817569732666016
Epoch: 19, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.789 Vali Acc: 0.896 Test Loss: 0.789 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 20 cost time: 0.43582725524902344
Epoch: 20, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.727 Vali Acc: 0.907 Test Loss: 0.727 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 21 cost time: 0.43895912170410156
Epoch: 21, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.668 Vali Acc: 0.904 Test Loss: 0.668 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.41417503356933594
Epoch: 22, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.614 Vali Acc: 0.915 Test Loss: 0.614 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914809).  Saving model ...
Epoch: 23 cost time: 0.45061612129211426
Epoch: 23, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.565 Vali Acc: 0.922 Test Loss: 0.565 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.48097777366638184
Epoch: 24, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.520 Vali Acc: 0.922 Test Loss: 0.520 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.4763782024383545
Epoch: 25, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.481 Vali Acc: 0.926 Test Loss: 0.481 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.4113314151763916
Epoch: 26, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.446 Vali Acc: 0.926 Test Loss: 0.446 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 27 cost time: 0.40074920654296875
Epoch: 27, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.415 Vali Acc: 0.926 Test Loss: 0.415 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.4125981330871582
Epoch: 28, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.388 Vali Acc: 0.930 Test Loss: 0.388 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 29 cost time: 0.44356608390808105
Epoch: 29, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.365 Vali Acc: 0.930 Test Loss: 0.365 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.4096851348876953
Epoch: 30, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.4140195846557617
Epoch: 31, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.4596550464630127
Epoch: 32, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.43773341178894043
Epoch: 33, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.4135317802429199
Epoch: 34, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.505671501159668
Epoch: 35, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.4266655445098877
Epoch: 36, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.557182788848877
Epoch: 37, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.450329065322876
Epoch: 38, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.44298386573791504
Epoch: 39, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.47087860107421875
Epoch: 40, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.40539121627807617
Epoch: 41, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.449312686920166
Epoch: 42, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.4101130962371826
Epoch: 43, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5176098346710205
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.46781158447265625
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.46373558044433594
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.4488563537597656
Epoch: 47, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.4349019527435303
Epoch: 48, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.44541501998901367
Epoch: 49, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.41245603561401367
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 128038
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7874338626861572
Epoch: 1, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.771 Vali Acc: 0.230 Test Loss: 1.771 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.45194458961486816
Epoch: 2, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.754 Vali Acc: 0.263 Test Loss: 1.754 Test Acc: 0.263
Validation loss decreased (-0.229612 --> -0.262945).  Saving model ...
Epoch: 3 cost time: 0.4452638626098633
Epoch: 3, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.740 Vali Acc: 0.289 Test Loss: 1.740 Test Acc: 0.289
Validation loss decreased (-0.262945 --> -0.288871).  Saving model ...
Epoch: 4 cost time: 0.4900989532470703
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.725 Vali Acc: 0.304 Test Loss: 1.725 Test Acc: 0.304
Validation loss decreased (-0.288871 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.45154714584350586
Epoch: 5, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.704 Vali Acc: 0.319 Test Loss: 1.704 Test Acc: 0.319
Validation loss decreased (-0.303686 --> -0.318501).  Saving model ...
Epoch: 6 cost time: 0.46358680725097656
Epoch: 6, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.678 Vali Acc: 0.381 Test Loss: 1.678 Test Acc: 0.381
Validation loss decreased (-0.318501 --> -0.381465).  Saving model ...
Epoch: 7 cost time: 0.4490048885345459
Epoch: 7, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.648 Vali Acc: 0.444 Test Loss: 1.648 Test Acc: 0.444
Validation loss decreased (-0.381465 --> -0.444428).  Saving model ...
Epoch: 8 cost time: 0.4069375991821289
Epoch: 8, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.612 Vali Acc: 0.515 Test Loss: 1.612 Test Acc: 0.515
Validation loss decreased (-0.444428 --> -0.514799).  Saving model ...
Epoch: 9 cost time: 0.4892134666442871
Epoch: 9, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.573 Vali Acc: 0.578 Test Loss: 1.573 Test Acc: 0.578
Validation loss decreased (-0.514799 --> -0.577762).  Saving model ...
Epoch: 10 cost time: 0.5298714637756348
Epoch: 10, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.529 Vali Acc: 0.622 Test Loss: 1.529 Test Acc: 0.622
Validation loss decreased (-0.577762 --> -0.622207).  Saving model ...
Epoch: 11 cost time: 0.44576025009155273
Epoch: 11, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.482 Vali Acc: 0.656 Test Loss: 1.482 Test Acc: 0.656
Validation loss decreased (-0.622207 --> -0.655541).  Saving model ...
Epoch: 12 cost time: 0.42653465270996094
Epoch: 12, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.432 Vali Acc: 0.674 Test Loss: 1.432 Test Acc: 0.674
Validation loss decreased (-0.655541 --> -0.674060).  Saving model ...
Epoch: 13 cost time: 0.43334031105041504
Epoch: 13, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.379 Vali Acc: 0.733 Test Loss: 1.379 Test Acc: 0.733
Validation loss decreased (-0.674060 --> -0.733320).  Saving model ...
Epoch: 14 cost time: 0.4536292552947998
Epoch: 14, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.325 Vali Acc: 0.767 Test Loss: 1.325 Test Acc: 0.767
Validation loss decreased (-0.733320 --> -0.766653).  Saving model ...
Epoch: 15 cost time: 0.4485898017883301
Epoch: 15, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.268 Vali Acc: 0.793 Test Loss: 1.268 Test Acc: 0.793
Validation loss decreased (-0.766653 --> -0.792580).  Saving model ...
Epoch: 16 cost time: 0.451845645904541
Epoch: 16, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.209 Vali Acc: 0.819 Test Loss: 1.209 Test Acc: 0.819
Validation loss decreased (-0.792580 --> -0.818506).  Saving model ...
Epoch: 17 cost time: 0.45794057846069336
Epoch: 17, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.150 Vali Acc: 0.837 Test Loss: 1.150 Test Acc: 0.837
Validation loss decreased (-0.818506 --> -0.837026).  Saving model ...
Epoch: 18 cost time: 0.49526000022888184
Epoch: 18, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.089 Vali Acc: 0.852 Test Loss: 1.089 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851841).  Saving model ...
Epoch: 19 cost time: 0.4515225887298584
Epoch: 19, Steps: 2 | Train Loss: 0.829 Vali Loss: 1.028 Vali Acc: 0.859 Test Loss: 1.028 Test Acc: 0.859
Validation loss decreased (-0.851841 --> -0.859249).  Saving model ...
Epoch: 20 cost time: 0.4252612590789795
Epoch: 20, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.967 Vali Acc: 0.867 Test Loss: 0.967 Test Acc: 0.867
Validation loss decreased (-0.859249 --> -0.866657).  Saving model ...
Epoch: 21 cost time: 0.45919299125671387
Epoch: 21, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.907 Vali Acc: 0.896 Test Loss: 0.907 Test Acc: 0.896
Validation loss decreased (-0.866657 --> -0.896287).  Saving model ...
Epoch: 22 cost time: 0.483919620513916
Epoch: 22, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.848 Vali Acc: 0.896 Test Loss: 0.848 Test Acc: 0.896
Validation loss decreased (-0.896287 --> -0.896288).  Saving model ...
Epoch: 23 cost time: 0.44891786575317383
Epoch: 23, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.793 Vali Acc: 0.907 Test Loss: 0.793 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907399).  Saving model ...
Epoch: 24 cost time: 0.46386027336120605
Epoch: 24, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.740 Vali Acc: 0.907 Test Loss: 0.740 Test Acc: 0.907
Validation loss decreased (-0.907399 --> -0.907400).  Saving model ...
Epoch: 25 cost time: 0.42865991592407227
Epoch: 25, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.690 Vali Acc: 0.911 Test Loss: 0.690 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911104).  Saving model ...
Epoch: 26 cost time: 0.48711323738098145
Epoch: 26, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.644 Vali Acc: 0.919 Test Loss: 0.644 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 27 cost time: 0.471250057220459
Epoch: 27, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.600 Vali Acc: 0.926 Test Loss: 0.600 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 28 cost time: 0.4654240608215332
Epoch: 28, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.561 Vali Acc: 0.926 Test Loss: 0.561 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 29 cost time: 0.4912681579589844
Epoch: 29, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.525 Vali Acc: 0.930 Test Loss: 0.525 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 30 cost time: 0.46529388427734375
Epoch: 30, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.492 Vali Acc: 0.930 Test Loss: 0.492 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 31 cost time: 0.3934061527252197
Epoch: 31, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.462 Vali Acc: 0.933 Test Loss: 0.462 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.46497154235839844
Epoch: 32, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.435 Vali Acc: 0.930 Test Loss: 0.435 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4413297176361084
Epoch: 33, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.411 Vali Acc: 0.930 Test Loss: 0.411 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4524660110473633
Epoch: 34, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.389 Vali Acc: 0.933 Test Loss: 0.389 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.45630455017089844
Epoch: 35, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.369 Vali Acc: 0.933 Test Loss: 0.369 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.5220179557800293
Epoch: 36, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5428800582885742
Epoch: 37, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.43492627143859863
Epoch: 38, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4260857105255127
Epoch: 39, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 0.43314075469970703
Epoch: 40, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 41 cost time: 0.430509090423584
Epoch: 41, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 42 cost time: 0.4328329563140869
Epoch: 42, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.5103468894958496
Epoch: 43, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.4387645721435547
Epoch: 44, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 45 cost time: 0.4687931537628174
Epoch: 45, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.43195629119873047
Epoch: 46, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.4412670135498047
Epoch: 47, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.4475240707397461
Epoch: 48, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.406296968460083
Epoch: 49, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5294337272644043
Epoch: 50, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 120390
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7780649662017822
Epoch: 1, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.807 Vali Acc: 0.104 Test Loss: 1.807 Test Acc: 0.104
Validation loss decreased (inf --> -0.103686).  Saving model ...
Epoch: 2 cost time: 0.46894216537475586
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.795 Vali Acc: 0.148 Test Loss: 1.795 Test Acc: 0.148
Validation loss decreased (-0.103686 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.41332578659057617
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.784 Vali Acc: 0.196 Test Loss: 1.784 Test Acc: 0.196
Validation loss decreased (-0.148130 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.38653039932250977
Epoch: 4, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.773 Vali Acc: 0.244 Test Loss: 1.773 Test Acc: 0.244
Validation loss decreased (-0.196278 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 0.3991568088531494
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.758 Vali Acc: 0.293 Test Loss: 1.758 Test Acc: 0.293
Validation loss decreased (-0.244427 --> -0.292575).  Saving model ...
Epoch: 6 cost time: 0.39794063568115234
Epoch: 6, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.738 Vali Acc: 0.333 Test Loss: 1.738 Test Acc: 0.333
Validation loss decreased (-0.292575 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.41233253479003906
Epoch: 7, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.714 Vali Acc: 0.374 Test Loss: 1.714 Test Acc: 0.374
Validation loss decreased (-0.333316 --> -0.374057).  Saving model ...
Epoch: 8 cost time: 0.37729501724243164
Epoch: 8, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.686 Vali Acc: 0.419 Test Loss: 1.686 Test Acc: 0.419
Validation loss decreased (-0.374057 --> -0.418502).  Saving model ...
Epoch: 9 cost time: 0.38170361518859863
Epoch: 9, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.655 Vali Acc: 0.478 Test Loss: 1.655 Test Acc: 0.478
Validation loss decreased (-0.418502 --> -0.477761).  Saving model ...
Epoch: 10 cost time: 0.39287304878234863
Epoch: 10, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.620 Vali Acc: 0.507 Test Loss: 1.620 Test Acc: 0.507
Validation loss decreased (-0.477761 --> -0.507391).  Saving model ...
Epoch: 11 cost time: 0.3635420799255371
Epoch: 11, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.582 Vali Acc: 0.537 Test Loss: 1.582 Test Acc: 0.537
Validation loss decreased (-0.507391 --> -0.537021).  Saving model ...
Epoch: 12 cost time: 0.38639211654663086
Epoch: 12, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.541 Vali Acc: 0.578 Test Loss: 1.541 Test Acc: 0.578
Validation loss decreased (-0.537021 --> -0.577762).  Saving model ...
Epoch: 13 cost time: 0.4375455379486084
Epoch: 13, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.497 Vali Acc: 0.615 Test Loss: 1.497 Test Acc: 0.615
Validation loss decreased (-0.577762 --> -0.614800).  Saving model ...
Epoch: 14 cost time: 0.4412209987640381
Epoch: 14, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.452 Vali Acc: 0.670 Test Loss: 1.452 Test Acc: 0.670
Validation loss decreased (-0.614800 --> -0.670356).  Saving model ...
Epoch: 15 cost time: 0.346710205078125
Epoch: 15, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.404 Vali Acc: 0.744 Test Loss: 1.404 Test Acc: 0.744
Validation loss decreased (-0.670356 --> -0.744430).  Saving model ...
Epoch: 16 cost time: 0.377485990524292
Epoch: 16, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.354 Vali Acc: 0.759 Test Loss: 1.354 Test Acc: 0.759
Validation loss decreased (-0.744430 --> -0.759246).  Saving model ...
Epoch: 17 cost time: 0.3892545700073242
Epoch: 17, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.303 Vali Acc: 0.778 Test Loss: 1.303 Test Acc: 0.778
Validation loss decreased (-0.759246 --> -0.777765).  Saving model ...
Epoch: 18 cost time: 0.48875951766967773
Epoch: 18, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.250 Vali Acc: 0.807 Test Loss: 1.250 Test Acc: 0.807
Validation loss decreased (-0.777765 --> -0.807395).  Saving model ...
Epoch: 19 cost time: 0.44133687019348145
Epoch: 19, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.196 Vali Acc: 0.833 Test Loss: 1.196 Test Acc: 0.833
Validation loss decreased (-0.807395 --> -0.833321).  Saving model ...
Epoch: 20 cost time: 0.3742403984069824
Epoch: 20, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.141 Vali Acc: 0.863 Test Loss: 1.141 Test Acc: 0.863
Validation loss decreased (-0.833321 --> -0.862952).  Saving model ...
Epoch: 21 cost time: 0.399219274520874
Epoch: 21, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.085 Vali Acc: 0.878 Test Loss: 1.085 Test Acc: 0.878
Validation loss decreased (-0.862952 --> -0.877767).  Saving model ...
Epoch: 22 cost time: 0.40266847610473633
Epoch: 22, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.030 Vali Acc: 0.893 Test Loss: 1.030 Test Acc: 0.893
Validation loss decreased (-0.877767 --> -0.892582).  Saving model ...
Epoch: 23 cost time: 0.35474133491516113
Epoch: 23, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.975 Vali Acc: 0.904 Test Loss: 0.975 Test Acc: 0.904
Validation loss decreased (-0.892582 --> -0.903694).  Saving model ...
Epoch: 24 cost time: 0.3736846446990967
Epoch: 24, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.921 Vali Acc: 0.911 Test Loss: 0.921 Test Acc: 0.911
Validation loss decreased (-0.903694 --> -0.911102).  Saving model ...
Epoch: 25 cost time: 0.3519296646118164
Epoch: 25, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.869 Vali Acc: 0.919 Test Loss: 0.869 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918510).  Saving model ...
Epoch: 26 cost time: 0.36765360832214355
Epoch: 26, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.818 Vali Acc: 0.922 Test Loss: 0.818 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922214).  Saving model ...
Epoch: 27 cost time: 0.4481978416442871
Epoch: 27, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.770 Vali Acc: 0.915 Test Loss: 0.770 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4744267463684082
Epoch: 28, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.725 Vali Acc: 0.926 Test Loss: 0.725 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925919).  Saving model ...
Epoch: 29 cost time: 0.41068196296691895
Epoch: 29, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.682 Vali Acc: 0.930 Test Loss: 0.682 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 30 cost time: 0.3800792694091797
Epoch: 30, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.643 Vali Acc: 0.933 Test Loss: 0.643 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 31 cost time: 0.4345710277557373
Epoch: 31, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.606 Vali Acc: 0.933 Test Loss: 0.606 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 32 cost time: 0.35872673988342285
Epoch: 32, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.572 Vali Acc: 0.937 Test Loss: 0.572 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 33 cost time: 0.44452548027038574
Epoch: 33, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.541 Vali Acc: 0.937 Test Loss: 0.541 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 34 cost time: 0.38042449951171875
Epoch: 34, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.512 Vali Acc: 0.937 Test Loss: 0.512 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 35 cost time: 0.4229919910430908
Epoch: 35, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.485 Vali Acc: 0.937 Test Loss: 0.485 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 36 cost time: 0.43944597244262695
Epoch: 36, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.461 Vali Acc: 0.937 Test Loss: 0.461 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 37 cost time: 0.38827085494995117
Epoch: 37, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.439 Vali Acc: 0.937 Test Loss: 0.439 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.40035271644592285
Epoch: 38, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.419 Vali Acc: 0.937 Test Loss: 0.419 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 39 cost time: 0.3590359687805176
Epoch: 39, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.401 Vali Acc: 0.937 Test Loss: 0.401 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 40 cost time: 0.3429534435272217
Epoch: 40, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.44385457038879395
Epoch: 41, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.370 Vali Acc: 0.941 Test Loss: 0.370 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.3925209045410156
Epoch: 42, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.356 Vali Acc: 0.941 Test Loss: 0.356 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.3956632614135742
Epoch: 43, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 44 cost time: 0.41008734703063965
Epoch: 44, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.3847835063934326
Epoch: 45, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.42249488830566406
Epoch: 46, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.3834991455078125
Epoch: 47, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.3792095184326172
Epoch: 48, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.39572620391845703
Epoch: 49, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.396834135055542
Epoch: 50, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 115846
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7641124725341797
Epoch: 1, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.738 Vali Acc: 0.333 Test Loss: 1.738 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 0.5500819683074951
Epoch: 2, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.726 Vali Acc: 0.389 Test Loss: 1.726 Test Acc: 0.389
Validation loss decreased (-0.333316 --> -0.388872).  Saving model ...
Epoch: 3 cost time: 0.40358543395996094
Epoch: 3, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.715 Vali Acc: 0.433 Test Loss: 1.715 Test Acc: 0.433
Validation loss decreased (-0.388872 --> -0.433316).  Saving model ...
Epoch: 4 cost time: 0.4386579990386963
Epoch: 4, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.703 Vali Acc: 0.444 Test Loss: 1.703 Test Acc: 0.444
Validation loss decreased (-0.433316 --> -0.444427).  Saving model ...
Epoch: 5 cost time: 0.4097254276275635
Epoch: 5, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.689 Vali Acc: 0.459 Test Loss: 1.689 Test Acc: 0.459
Validation loss decreased (-0.444427 --> -0.459242).  Saving model ...
Epoch: 6 cost time: 0.45949268341064453
Epoch: 6, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.672 Vali Acc: 0.496 Test Loss: 1.672 Test Acc: 0.496
Validation loss decreased (-0.459242 --> -0.496280).  Saving model ...
Epoch: 7 cost time: 0.3571739196777344
Epoch: 7, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.653 Vali Acc: 0.533 Test Loss: 1.653 Test Acc: 0.533
Validation loss decreased (-0.496280 --> -0.533317).  Saving model ...
Epoch: 8 cost time: 0.43080902099609375
Epoch: 8, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.630 Vali Acc: 0.581 Test Loss: 1.630 Test Acc: 0.581
Validation loss decreased (-0.533317 --> -0.581465).  Saving model ...
Epoch: 9 cost time: 0.4021937847137451
Epoch: 9, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.605 Vali Acc: 0.611 Test Loss: 1.605 Test Acc: 0.611
Validation loss decreased (-0.581465 --> -0.611095).  Saving model ...
Epoch: 10 cost time: 0.4997861385345459
Epoch: 10, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.578 Vali Acc: 0.641 Test Loss: 1.578 Test Acc: 0.641
Validation loss decreased (-0.611095 --> -0.640725).  Saving model ...
Epoch: 11 cost time: 0.4755439758300781
Epoch: 11, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.548 Vali Acc: 0.693 Test Loss: 1.548 Test Acc: 0.693
Validation loss decreased (-0.640725 --> -0.692577).  Saving model ...
Epoch: 12 cost time: 0.4338998794555664
Epoch: 12, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.517 Vali Acc: 0.741 Test Loss: 1.517 Test Acc: 0.741
Validation loss decreased (-0.692577 --> -0.740726).  Saving model ...
Epoch: 13 cost time: 0.3911714553833008
Epoch: 13, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.483 Vali Acc: 0.785 Test Loss: 1.483 Test Acc: 0.785
Validation loss decreased (-0.740726 --> -0.785170).  Saving model ...
Epoch: 14 cost time: 0.39748597145080566
Epoch: 14, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.448 Vali Acc: 0.796 Test Loss: 1.448 Test Acc: 0.796
Validation loss decreased (-0.785170 --> -0.796282).  Saving model ...
Epoch: 15 cost time: 0.4036827087402344
Epoch: 15, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.411 Vali Acc: 0.852 Test Loss: 1.411 Test Acc: 0.852
Validation loss decreased (-0.796282 --> -0.851838).  Saving model ...
Epoch: 16 cost time: 0.4438350200653076
Epoch: 16, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.372 Vali Acc: 0.870 Test Loss: 1.372 Test Acc: 0.870
Validation loss decreased (-0.851838 --> -0.870357).  Saving model ...
Epoch: 17 cost time: 0.3907599449157715
Epoch: 17, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.332 Vali Acc: 0.889 Test Loss: 1.332 Test Acc: 0.889
Validation loss decreased (-0.870357 --> -0.888876).  Saving model ...
Epoch: 18 cost time: 0.4247288703918457
Epoch: 18, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.290 Vali Acc: 0.889 Test Loss: 1.290 Test Acc: 0.889
Validation loss decreased (-0.888876 --> -0.888876).  Saving model ...
Epoch: 19 cost time: 0.4265143871307373
Epoch: 19, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.248 Vali Acc: 0.896 Test Loss: 1.248 Test Acc: 0.896
Validation loss decreased (-0.888876 --> -0.896284).  Saving model ...
Epoch: 20 cost time: 0.42685365676879883
Epoch: 20, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.204 Vali Acc: 0.904 Test Loss: 1.204 Test Acc: 0.904
Validation loss decreased (-0.896284 --> -0.903692).  Saving model ...
Epoch: 21 cost time: 0.5243773460388184
Epoch: 21, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.160 Vali Acc: 0.915 Test Loss: 1.160 Test Acc: 0.915
Validation loss decreased (-0.903692 --> -0.914803).  Saving model ...
Epoch: 22 cost time: 0.48340487480163574
Epoch: 22, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.116 Vali Acc: 0.915 Test Loss: 1.116 Test Acc: 0.915
Validation loss decreased (-0.914803 --> -0.914804).  Saving model ...
Epoch: 23 cost time: 0.38233351707458496
Epoch: 23, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.071 Vali Acc: 0.926 Test Loss: 1.071 Test Acc: 0.926
Validation loss decreased (-0.914804 --> -0.925915).  Saving model ...
Epoch: 24 cost time: 0.3682432174682617
Epoch: 24, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.026 Vali Acc: 0.930 Test Loss: 1.026 Test Acc: 0.930
Validation loss decreased (-0.925915 --> -0.929619).  Saving model ...
Epoch: 25 cost time: 0.3969879150390625
Epoch: 25, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.981 Vali Acc: 0.933 Test Loss: 0.981 Test Acc: 0.933
Validation loss decreased (-0.929619 --> -0.933324).  Saving model ...
Epoch: 26 cost time: 0.40720605850219727
Epoch: 26, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.937 Vali Acc: 0.933 Test Loss: 0.937 Test Acc: 0.933
Validation loss decreased (-0.933324 --> -0.933324).  Saving model ...
Epoch: 27 cost time: 0.4088301658630371
Epoch: 27, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.893 Vali Acc: 0.941 Test Loss: 0.893 Test Acc: 0.941
Validation loss decreased (-0.933324 --> -0.940732).  Saving model ...
Epoch: 28 cost time: 0.40406203269958496
Epoch: 28, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.851 Vali Acc: 0.941 Test Loss: 0.851 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940732).  Saving model ...
Epoch: 29 cost time: 0.45847582817077637
Epoch: 29, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.809 Vali Acc: 0.941 Test Loss: 0.809 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940733).  Saving model ...
Epoch: 30 cost time: 0.4582047462463379
Epoch: 30, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.769 Vali Acc: 0.944 Test Loss: 0.769 Test Acc: 0.944
Validation loss decreased (-0.940733 --> -0.944437).  Saving model ...
Epoch: 31 cost time: 0.5090172290802002
Epoch: 31, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.731 Vali Acc: 0.944 Test Loss: 0.731 Test Acc: 0.944
Validation loss decreased (-0.944437 --> -0.944437).  Saving model ...
Epoch: 32 cost time: 0.46161508560180664
Epoch: 32, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.694 Vali Acc: 0.944 Test Loss: 0.694 Test Acc: 0.944
Validation loss decreased (-0.944437 --> -0.944438).  Saving model ...
Epoch: 33 cost time: 0.390566349029541
Epoch: 33, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.658 Vali Acc: 0.944 Test Loss: 0.658 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944438).  Saving model ...
Epoch: 34 cost time: 0.4551692008972168
Epoch: 34, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.625 Vali Acc: 0.948 Test Loss: 0.625 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948142).  Saving model ...
Epoch: 35 cost time: 0.5323288440704346
Epoch: 35, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.593 Vali Acc: 0.952 Test Loss: 0.593 Test Acc: 0.952
Validation loss decreased (-0.948142 --> -0.951846).  Saving model ...
Epoch: 36 cost time: 0.4295482635498047
Epoch: 36, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.563 Vali Acc: 0.952 Test Loss: 0.563 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951846).  Saving model ...
Epoch: 37 cost time: 0.4704403877258301
Epoch: 37, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.535 Vali Acc: 0.956 Test Loss: 0.535 Test Acc: 0.956
Validation loss decreased (-0.951846 --> -0.955550).  Saving model ...
Epoch: 38 cost time: 0.3739447593688965
Epoch: 38, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.509 Vali Acc: 0.956 Test Loss: 0.509 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955550).  Saving model ...
Epoch: 39 cost time: 0.4081425666809082
Epoch: 39, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.484 Vali Acc: 0.956 Test Loss: 0.484 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955551).  Saving model ...
Epoch: 40 cost time: 0.47589635848999023
Epoch: 40, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.462 Vali Acc: 0.956 Test Loss: 0.462 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 41 cost time: 0.4088923931121826
Epoch: 41, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.441 Vali Acc: 0.956 Test Loss: 0.441 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 42 cost time: 0.43776702880859375
Epoch: 42, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.422 Vali Acc: 0.956 Test Loss: 0.422 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 43 cost time: 0.44562482833862305
Epoch: 43, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.404 Vali Acc: 0.956 Test Loss: 0.404 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955552).  Saving model ...
Epoch: 44 cost time: 0.47879528999328613
Epoch: 44, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.388 Vali Acc: 0.956 Test Loss: 0.388 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 45 cost time: 0.4021332263946533
Epoch: 45, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.372 Vali Acc: 0.956 Test Loss: 0.372 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 46 cost time: 0.5072286128997803
Epoch: 46, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.357 Vali Acc: 0.956 Test Loss: 0.357 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 47 cost time: 0.461500883102417
Epoch: 47, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.345 Vali Acc: 0.956 Test Loss: 0.345 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 48 cost time: 0.41446375846862793
Epoch: 48, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.332 Vali Acc: 0.956 Test Loss: 0.332 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 49 cost time: 0.4594993591308594
Epoch: 49, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.322 Vali Acc: 0.959 Test Loss: 0.322 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 50 cost time: 0.4799461364746094
Epoch: 50, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.311 Vali Acc: 0.959 Test Loss: 0.311 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 114406
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7114992141723633
Epoch: 1, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.737 Vali Acc: 0.322 Test Loss: 1.737 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.38993144035339355
Epoch: 2, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.727 Vali Acc: 0.333 Test Loss: 1.727 Test Acc: 0.333
Validation loss decreased (-0.322205 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.4158766269683838
Epoch: 3, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.718 Vali Acc: 0.348 Test Loss: 1.718 Test Acc: 0.348
Validation loss decreased (-0.333316 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.44478344917297363
Epoch: 4, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.710 Vali Acc: 0.367 Test Loss: 1.710 Test Acc: 0.367
Validation loss decreased (-0.348131 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.4293806552886963
Epoch: 5, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.700 Vali Acc: 0.407 Test Loss: 1.700 Test Acc: 0.407
Validation loss decreased (-0.366650 --> -0.407390).  Saving model ...
Epoch: 6 cost time: 0.516265869140625
Epoch: 6, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.687 Vali Acc: 0.422 Test Loss: 1.687 Test Acc: 0.422
Validation loss decreased (-0.407390 --> -0.422205).  Saving model ...
Epoch: 7 cost time: 0.4377875328063965
Epoch: 7, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.672 Vali Acc: 0.459 Test Loss: 1.672 Test Acc: 0.459
Validation loss decreased (-0.422205 --> -0.459243).  Saving model ...
Epoch: 8 cost time: 0.3892545700073242
Epoch: 8, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.655 Vali Acc: 0.470 Test Loss: 1.655 Test Acc: 0.470
Validation loss decreased (-0.459243 --> -0.470354).  Saving model ...
Epoch: 9 cost time: 0.43358516693115234
Epoch: 9, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.635 Vali Acc: 0.493 Test Loss: 1.635 Test Acc: 0.493
Validation loss decreased (-0.470354 --> -0.492576).  Saving model ...
Epoch: 10 cost time: 0.40778613090515137
Epoch: 10, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.614 Vali Acc: 0.541 Test Loss: 1.614 Test Acc: 0.541
Validation loss decreased (-0.492576 --> -0.540725).  Saving model ...
Epoch: 11 cost time: 0.3935236930847168
Epoch: 11, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.590 Vali Acc: 0.548 Test Loss: 1.590 Test Acc: 0.548
Validation loss decreased (-0.540725 --> -0.548132).  Saving model ...
Epoch: 12 cost time: 0.44533801078796387
Epoch: 12, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.564 Vali Acc: 0.581 Test Loss: 1.564 Test Acc: 0.581
Validation loss decreased (-0.548132 --> -0.581466).  Saving model ...
Epoch: 13 cost time: 0.5124728679656982
Epoch: 13, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.536 Vali Acc: 0.626 Test Loss: 1.536 Test Acc: 0.626
Validation loss decreased (-0.581466 --> -0.625911).  Saving model ...
Epoch: 14 cost time: 0.6209306716918945
Epoch: 14, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.507 Vali Acc: 0.656 Test Loss: 1.507 Test Acc: 0.656
Validation loss decreased (-0.625911 --> -0.655540).  Saving model ...
Epoch: 15 cost time: 0.43511104583740234
Epoch: 15, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.476 Vali Acc: 0.693 Test Loss: 1.476 Test Acc: 0.693
Validation loss decreased (-0.655540 --> -0.692578).  Saving model ...
Epoch: 16 cost time: 0.5230865478515625
Epoch: 16, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.443 Vali Acc: 0.726 Test Loss: 1.443 Test Acc: 0.726
Validation loss decreased (-0.692578 --> -0.725911).  Saving model ...
Epoch: 17 cost time: 0.3776214122772217
Epoch: 17, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.409 Vali Acc: 0.752 Test Loss: 1.409 Test Acc: 0.752
Validation loss decreased (-0.725911 --> -0.751838).  Saving model ...
Epoch: 18 cost time: 0.4373478889465332
Epoch: 18, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.374 Vali Acc: 0.778 Test Loss: 1.374 Test Acc: 0.778
Validation loss decreased (-0.751838 --> -0.777764).  Saving model ...
Epoch: 19 cost time: 0.46204185485839844
Epoch: 19, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.337 Vali Acc: 0.796 Test Loss: 1.337 Test Acc: 0.796
Validation loss decreased (-0.777764 --> -0.796283).  Saving model ...
Epoch: 20 cost time: 0.4418787956237793
Epoch: 20, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.300 Vali Acc: 0.815 Test Loss: 1.300 Test Acc: 0.815
Validation loss decreased (-0.796283 --> -0.814802).  Saving model ...
Epoch: 21 cost time: 0.42310500144958496
Epoch: 21, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.262 Vali Acc: 0.844 Test Loss: 1.262 Test Acc: 0.844
Validation loss decreased (-0.814802 --> -0.844432).  Saving model ...
Epoch: 22 cost time: 0.4300215244293213
Epoch: 22, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.223 Vali Acc: 0.856 Test Loss: 1.223 Test Acc: 0.856
Validation loss decreased (-0.844432 --> -0.855543).  Saving model ...
Epoch: 23 cost time: 0.5055458545684814
Epoch: 23, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.183 Vali Acc: 0.878 Test Loss: 1.183 Test Acc: 0.878
Validation loss decreased (-0.855543 --> -0.877766).  Saving model ...
Epoch: 24 cost time: 0.42918920516967773
Epoch: 24, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.143 Vali Acc: 0.889 Test Loss: 1.143 Test Acc: 0.889
Validation loss decreased (-0.877766 --> -0.888877).  Saving model ...
Epoch: 25 cost time: 0.5265302658081055
Epoch: 25, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.103 Vali Acc: 0.904 Test Loss: 1.103 Test Acc: 0.904
Validation loss decreased (-0.888877 --> -0.903693).  Saving model ...
Epoch: 26 cost time: 0.48311734199523926
Epoch: 26, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.063 Vali Acc: 0.919 Test Loss: 1.063 Test Acc: 0.919
Validation loss decreased (-0.903693 --> -0.918508).  Saving model ...
Epoch: 27 cost time: 0.4465148448944092
Epoch: 27, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.022 Vali Acc: 0.919 Test Loss: 1.022 Test Acc: 0.919
Validation loss decreased (-0.918508 --> -0.918508).  Saving model ...
Epoch: 28 cost time: 0.38951873779296875
Epoch: 28, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.982 Vali Acc: 0.926 Test Loss: 0.982 Test Acc: 0.926
Validation loss decreased (-0.918508 --> -0.925916).  Saving model ...
Epoch: 29 cost time: 0.3883321285247803
Epoch: 29, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.943 Vali Acc: 0.930 Test Loss: 0.943 Test Acc: 0.930
Validation loss decreased (-0.925916 --> -0.929620).  Saving model ...
Epoch: 30 cost time: 0.4596288204193115
Epoch: 30, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.904 Vali Acc: 0.937 Test Loss: 0.904 Test Acc: 0.937
Validation loss decreased (-0.929620 --> -0.937028).  Saving model ...
Epoch: 31 cost time: 0.4556612968444824
Epoch: 31, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.866 Vali Acc: 0.941 Test Loss: 0.866 Test Acc: 0.941
Validation loss decreased (-0.937028 --> -0.940732).  Saving model ...
Epoch: 32 cost time: 0.49304699897766113
Epoch: 32, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.829 Vali Acc: 0.941 Test Loss: 0.829 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940732).  Saving model ...
Epoch: 33 cost time: 0.44743967056274414
Epoch: 33, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.794 Vali Acc: 0.937 Test Loss: 0.794 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5211668014526367
Epoch: 34, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.759 Vali Acc: 0.937 Test Loss: 0.759 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.40639162063598633
Epoch: 35, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.726 Vali Acc: 0.937 Test Loss: 0.726 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.44930243492126465
Epoch: 36, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.694 Vali Acc: 0.937 Test Loss: 0.694 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4255363941192627
Epoch: 37, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.664 Vali Acc: 0.933 Test Loss: 0.664 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4546947479248047
Epoch: 38, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.634 Vali Acc: 0.930 Test Loss: 0.634 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4518594741821289
Epoch: 39, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.607 Vali Acc: 0.930 Test Loss: 0.607 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.45450401306152344
Epoch: 40, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.582 Vali Acc: 0.930 Test Loss: 0.582 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5123794078826904
Epoch: 41, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.558 Vali Acc: 0.930 Test Loss: 0.558 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.411945104598999
Epoch: 42, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.535 Vali Acc: 0.937 Test Loss: 0.535 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 111430
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7448551654815674
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.797 Vali Acc: 0.193 Test Loss: 1.797 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.3984832763671875
Epoch: 2, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.790 Vali Acc: 0.196 Test Loss: 1.790 Test Acc: 0.196
Validation loss decreased (-0.192575 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.39806580543518066
Epoch: 3, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.784 Vali Acc: 0.215 Test Loss: 1.784 Test Acc: 0.215
Validation loss decreased (-0.196278 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.43058228492736816
Epoch: 4, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.779 Vali Acc: 0.222 Test Loss: 1.779 Test Acc: 0.222
Validation loss decreased (-0.214797 --> -0.222204).  Saving model ...
Epoch: 5 cost time: 0.44788575172424316
Epoch: 5, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.771 Vali Acc: 0.226 Test Loss: 1.771 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 0.49250245094299316
Epoch: 6, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.761 Vali Acc: 0.241 Test Loss: 1.761 Test Acc: 0.241
Validation loss decreased (-0.225908 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.4131748676300049
Epoch: 7, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.750 Vali Acc: 0.256 Test Loss: 1.750 Test Acc: 0.256
Validation loss decreased (-0.240723 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.46313929557800293
Epoch: 8, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.736 Vali Acc: 0.285 Test Loss: 1.736 Test Acc: 0.285
Validation loss decreased (-0.255538 --> -0.285168).  Saving model ...
Epoch: 9 cost time: 0.40656161308288574
Epoch: 9, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.720 Vali Acc: 0.311 Test Loss: 1.720 Test Acc: 0.311
Validation loss decreased (-0.285168 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.40644383430480957
Epoch: 10, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.702 Vali Acc: 0.367 Test Loss: 1.702 Test Acc: 0.367
Validation loss decreased (-0.311094 --> -0.366650).  Saving model ...
Epoch: 11 cost time: 0.4325103759765625
Epoch: 11, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.683 Vali Acc: 0.396 Test Loss: 1.683 Test Acc: 0.396
Validation loss decreased (-0.366650 --> -0.396279).  Saving model ...
Epoch: 12 cost time: 0.3988504409790039
Epoch: 12, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.662 Vali Acc: 0.437 Test Loss: 1.662 Test Acc: 0.437
Validation loss decreased (-0.396279 --> -0.437020).  Saving model ...
Epoch: 13 cost time: 0.4203658103942871
Epoch: 13, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.639 Vali Acc: 0.485 Test Loss: 1.639 Test Acc: 0.485
Validation loss decreased (-0.437020 --> -0.485169).  Saving model ...
Epoch: 14 cost time: 0.387340784072876
Epoch: 14, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.615 Vali Acc: 0.537 Test Loss: 1.615 Test Acc: 0.537
Validation loss decreased (-0.485169 --> -0.537021).  Saving model ...
Epoch: 15 cost time: 0.4580531120300293
Epoch: 15, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.589 Vali Acc: 0.596 Test Loss: 1.589 Test Acc: 0.596
Validation loss decreased (-0.537021 --> -0.596280).  Saving model ...
Epoch: 16 cost time: 0.40131187438964844
Epoch: 16, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.562 Vali Acc: 0.652 Test Loss: 1.562 Test Acc: 0.652
Validation loss decreased (-0.596280 --> -0.651836).  Saving model ...
Epoch: 17 cost time: 0.4604332447052002
Epoch: 17, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.534 Vali Acc: 0.704 Test Loss: 1.534 Test Acc: 0.704
Validation loss decreased (-0.651836 --> -0.703688).  Saving model ...
Epoch: 18 cost time: 0.41973423957824707
Epoch: 18, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.504 Vali Acc: 0.748 Test Loss: 1.504 Test Acc: 0.748
Validation loss decreased (-0.703688 --> -0.748133).  Saving model ...
Epoch: 19 cost time: 0.46569204330444336
Epoch: 19, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.474 Vali Acc: 0.781 Test Loss: 1.474 Test Acc: 0.781
Validation loss decreased (-0.748133 --> -0.781467).  Saving model ...
Epoch: 20 cost time: 0.43304991722106934
Epoch: 20, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.442 Vali Acc: 0.793 Test Loss: 1.442 Test Acc: 0.793
Validation loss decreased (-0.781467 --> -0.792578).  Saving model ...
Epoch: 21 cost time: 0.46550774574279785
Epoch: 21, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.410 Vali Acc: 0.833 Test Loss: 1.410 Test Acc: 0.833
Validation loss decreased (-0.792578 --> -0.833319).  Saving model ...
Epoch: 22 cost time: 0.4268631935119629
Epoch: 22, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.376 Vali Acc: 0.852 Test Loss: 1.376 Test Acc: 0.852
Validation loss decreased (-0.833319 --> -0.851838).  Saving model ...
Epoch: 23 cost time: 0.4704165458679199
Epoch: 23, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.343 Vali Acc: 0.852 Test Loss: 1.343 Test Acc: 0.852
Validation loss decreased (-0.851838 --> -0.851838).  Saving model ...
Epoch: 24 cost time: 0.4698965549468994
Epoch: 24, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.308 Vali Acc: 0.867 Test Loss: 1.308 Test Acc: 0.867
Validation loss decreased (-0.851838 --> -0.866654).  Saving model ...
Epoch: 25 cost time: 0.38817667961120605
Epoch: 25, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.273 Vali Acc: 0.881 Test Loss: 1.273 Test Acc: 0.881
Validation loss decreased (-0.866654 --> -0.881469).  Saving model ...
Epoch: 26 cost time: 0.4938786029815674
Epoch: 26, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.237 Vali Acc: 0.907 Test Loss: 1.237 Test Acc: 0.907
Validation loss decreased (-0.881469 --> -0.907395).  Saving model ...
Epoch: 27 cost time: 0.47759294509887695
Epoch: 27, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.200 Vali Acc: 0.919 Test Loss: 1.200 Test Acc: 0.919
Validation loss decreased (-0.907395 --> -0.918507).  Saving model ...
Epoch: 28 cost time: 0.41263580322265625
Epoch: 28, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.164 Vali Acc: 0.919 Test Loss: 1.164 Test Acc: 0.919
Validation loss decreased (-0.918507 --> -0.918507).  Saving model ...
Epoch: 29 cost time: 0.46544790267944336
Epoch: 29, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.126 Vali Acc: 0.919 Test Loss: 1.126 Test Acc: 0.919
Validation loss decreased (-0.918507 --> -0.918507).  Saving model ...
Epoch: 30 cost time: 0.46630406379699707
Epoch: 30, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.089 Vali Acc: 0.922 Test Loss: 1.089 Test Acc: 0.922
Validation loss decreased (-0.918507 --> -0.922211).  Saving model ...
Epoch: 31 cost time: 0.4348447322845459
Epoch: 31, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.052 Vali Acc: 0.926 Test Loss: 1.052 Test Acc: 0.926
Validation loss decreased (-0.922211 --> -0.925915).  Saving model ...
Epoch: 32 cost time: 0.40019869804382324
Epoch: 32, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.015 Vali Acc: 0.926 Test Loss: 1.015 Test Acc: 0.926
Validation loss decreased (-0.925915 --> -0.925916).  Saving model ...
Epoch: 33 cost time: 0.48519039154052734
Epoch: 33, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.979 Vali Acc: 0.930 Test Loss: 0.979 Test Acc: 0.930
Validation loss decreased (-0.925916 --> -0.929620).  Saving model ...
Epoch: 34 cost time: 0.49672722816467285
Epoch: 34, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.942 Vali Acc: 0.930 Test Loss: 0.942 Test Acc: 0.930
Validation loss decreased (-0.929620 --> -0.929620).  Saving model ...
Epoch: 35 cost time: 0.4261820316314697
Epoch: 35, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.907 Vali Acc: 0.926 Test Loss: 0.907 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.43390870094299316
Epoch: 36, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.872 Vali Acc: 0.926 Test Loss: 0.872 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5332918167114258
Epoch: 37, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.838 Vali Acc: 0.930 Test Loss: 0.838 Test Acc: 0.930
Validation loss decreased (-0.929620 --> -0.929621).  Saving model ...
Epoch: 38 cost time: 0.40888190269470215
Epoch: 38, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.805 Vali Acc: 0.926 Test Loss: 0.805 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.39158201217651367
Epoch: 39, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.773 Vali Acc: 0.926 Test Loss: 0.773 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.4135262966156006
Epoch: 40, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.743 Vali Acc: 0.930 Test Loss: 0.743 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929622).  Saving model ...
Epoch: 41 cost time: 0.4131131172180176
Epoch: 41, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.713 Vali Acc: 0.926 Test Loss: 0.713 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.47724366188049316
Epoch: 42, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.685 Vali Acc: 0.926 Test Loss: 0.685 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4601457118988037
Epoch: 43, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.658 Vali Acc: 0.926 Test Loss: 0.658 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.40783143043518066
Epoch: 44, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.632 Vali Acc: 0.930 Test Loss: 0.632 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929623).  Saving model ...
Epoch: 45 cost time: 0.4478309154510498
Epoch: 45, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.608 Vali Acc: 0.930 Test Loss: 0.608 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 46 cost time: 0.4748508930206299
Epoch: 46, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.585 Vali Acc: 0.933 Test Loss: 0.585 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933327).  Saving model ...
Epoch: 47 cost time: 0.38876962661743164
Epoch: 47, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.563 Vali Acc: 0.933 Test Loss: 0.563 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 48 cost time: 0.42563962936401367
Epoch: 48, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.543 Vali Acc: 0.933 Test Loss: 0.543 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 49 cost time: 0.35250067710876465
Epoch: 49, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.524 Vali Acc: 0.930 Test Loss: 0.524 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.40380239486694336
Epoch: 50, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.505 Vali Acc: 0.933 Test Loss: 0.505 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 110022
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6346979141235352
Epoch: 1, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.751 Vali Acc: 0.237 Test Loss: 1.751 Test Acc: 0.237
Validation loss decreased (inf --> -0.237020).  Saving model ...
Epoch: 2 cost time: 0.51003098487854
Epoch: 2, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.692 Vali Acc: 0.326 Test Loss: 1.692 Test Acc: 0.326
Validation loss decreased (-0.237020 --> -0.325909).  Saving model ...
Epoch: 3 cost time: 0.4222843647003174
Epoch: 3, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.608 Vali Acc: 0.604 Test Loss: 1.608 Test Acc: 0.604
Validation loss decreased (-0.325909 --> -0.603688).  Saving model ...
Epoch: 4 cost time: 0.44281578063964844
Epoch: 4, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.457 Vali Acc: 0.767 Test Loss: 1.457 Test Acc: 0.767
Validation loss decreased (-0.603688 --> -0.766652).  Saving model ...
Epoch: 5 cost time: 0.44169068336486816
Epoch: 5, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.274 Vali Acc: 0.815 Test Loss: 1.274 Test Acc: 0.815
Validation loss decreased (-0.766652 --> -0.814802).  Saving model ...
Epoch: 6 cost time: 0.6006679534912109
Epoch: 6, Steps: 2 | Train Loss: 0.883 Vali Loss: 1.080 Vali Acc: 0.881 Test Loss: 1.080 Test Acc: 0.881
Validation loss decreased (-0.814802 --> -0.881471).  Saving model ...
Epoch: 7 cost time: 0.4476749897003174
Epoch: 7, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.892 Vali Acc: 0.896 Test Loss: 0.892 Test Acc: 0.896
Validation loss decreased (-0.881471 --> -0.896287).  Saving model ...
Epoch: 8 cost time: 0.47014403343200684
Epoch: 8, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.720 Vali Acc: 0.930 Test Loss: 0.720 Test Acc: 0.930
Validation loss decreased (-0.896287 --> -0.929622).  Saving model ...
Epoch: 9 cost time: 0.5119891166687012
Epoch: 9, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.569 Vali Acc: 0.930 Test Loss: 0.569 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929624).  Saving model ...
Epoch: 10 cost time: 0.541285514831543
Epoch: 10, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.449 Vali Acc: 0.922 Test Loss: 0.449 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46472835540771484
Epoch: 11, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.360 Vali Acc: 0.930 Test Loss: 0.360 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929626).  Saving model ...
Epoch: 12 cost time: 0.5102429389953613
Epoch: 12, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.48114585876464844
Epoch: 13, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.4668705463409424
Epoch: 14, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 15 cost time: 0.4881768226623535
Epoch: 15, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.4641733169555664
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 17 cost time: 0.48792362213134766
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.44454169273376465
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 19 cost time: 0.4656956195831299
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 20 cost time: 0.48285603523254395
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 21 cost time: 0.5778067111968994
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.516411304473877
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5598320960998535
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4738943576812744
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.4413716793060303
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4494502544403076
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5541045665740967
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5111699104309082
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5108704566955566
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.48444104194641113
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4526188373565674
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.44866132736206055
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4894890785217285
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5032954216003418
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1642374
model size : 6.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.737936019897461
Epoch: 1, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.742 Vali Acc: 0.230 Test Loss: 1.742 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.45569729804992676
Epoch: 2, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.700 Vali Acc: 0.374 Test Loss: 1.700 Test Acc: 0.374
Validation loss decreased (-0.229612 --> -0.374057).  Saving model ...
Epoch: 3 cost time: 0.5173158645629883
Epoch: 3, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.646 Vali Acc: 0.537 Test Loss: 1.646 Test Acc: 0.537
Validation loss decreased (-0.374057 --> -0.537021).  Saving model ...
Epoch: 4 cost time: 0.4733700752258301
Epoch: 4, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.558 Vali Acc: 0.648 Test Loss: 1.558 Test Acc: 0.648
Validation loss decreased (-0.537021 --> -0.648133).  Saving model ...
Epoch: 5 cost time: 0.44638872146606445
Epoch: 5, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.443 Vali Acc: 0.767 Test Loss: 1.443 Test Acc: 0.767
Validation loss decreased (-0.648133 --> -0.766652).  Saving model ...
Epoch: 6 cost time: 0.49282073974609375
Epoch: 6, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.311 Vali Acc: 0.852 Test Loss: 1.311 Test Acc: 0.852
Validation loss decreased (-0.766652 --> -0.851839).  Saving model ...
Epoch: 7 cost time: 0.5027594566345215
Epoch: 7, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.165 Vali Acc: 0.885 Test Loss: 1.165 Test Acc: 0.885
Validation loss decreased (-0.851839 --> -0.885174).  Saving model ...
Epoch: 8 cost time: 0.4795973300933838
Epoch: 8, Steps: 2 | Train Loss: 0.798 Vali Loss: 1.011 Vali Acc: 0.911 Test Loss: 1.011 Test Acc: 0.911
Validation loss decreased (-0.885174 --> -0.911101).  Saving model ...
Epoch: 9 cost time: 0.4640693664550781
Epoch: 9, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.864 Vali Acc: 0.911 Test Loss: 0.864 Test Acc: 0.911
Validation loss decreased (-0.911101 --> -0.911102).  Saving model ...
Epoch: 10 cost time: 0.4601776599884033
Epoch: 10, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.724 Vali Acc: 0.926 Test Loss: 0.724 Test Acc: 0.926
Validation loss decreased (-0.911102 --> -0.925919).  Saving model ...
Epoch: 11 cost time: 0.42146921157836914
Epoch: 11, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.600 Vali Acc: 0.933 Test Loss: 0.600 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 12 cost time: 0.4432523250579834
Epoch: 12, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.493 Vali Acc: 0.933 Test Loss: 0.493 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 13 cost time: 0.4157283306121826
Epoch: 13, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.407 Vali Acc: 0.941 Test Loss: 0.407 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 0.4406602382659912
Epoch: 14, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 15 cost time: 0.47251081466674805
Epoch: 15, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.289 Vali Acc: 0.948 Test Loss: 0.289 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 16 cost time: 0.4912755489349365
Epoch: 16, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 17 cost time: 0.49993252754211426
Epoch: 17, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5398590564727783
Epoch: 18, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.952 Test Loss: 0.213 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.4770221710205078
Epoch: 19, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4601173400878906
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.49929213523864746
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5274972915649414
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.48296022415161133
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5290699005126953
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.40918803215026855
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5493710041046143
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4569737911224365
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5096557140350342
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1538182
model size : 5.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8920609951019287
Epoch: 1, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.768 Vali Acc: 0.211 Test Loss: 1.768 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.47959280014038086
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.737 Vali Acc: 0.237 Test Loss: 1.737 Test Acc: 0.237
Validation loss decreased (-0.211093 --> -0.237020).  Saving model ...
Epoch: 3 cost time: 0.46778178215026855
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.698 Vali Acc: 0.322 Test Loss: 1.698 Test Acc: 0.322
Validation loss decreased (-0.237020 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.4315924644470215
Epoch: 4, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.635 Vali Acc: 0.537 Test Loss: 1.635 Test Acc: 0.537
Validation loss decreased (-0.322205 --> -0.537021).  Saving model ...
Epoch: 5 cost time: 0.42941904067993164
Epoch: 5, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.552 Vali Acc: 0.781 Test Loss: 1.552 Test Acc: 0.781
Validation loss decreased (-0.537021 --> -0.781466).  Saving model ...
Epoch: 6 cost time: 0.4398789405822754
Epoch: 6, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.453 Vali Acc: 0.852 Test Loss: 1.453 Test Acc: 0.852
Validation loss decreased (-0.781466 --> -0.851837).  Saving model ...
Epoch: 7 cost time: 0.4966411590576172
Epoch: 7, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.339 Vali Acc: 0.900 Test Loss: 1.339 Test Acc: 0.900
Validation loss decreased (-0.851837 --> -0.899987).  Saving model ...
Epoch: 8 cost time: 0.5632150173187256
Epoch: 8, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.215 Vali Acc: 0.915 Test Loss: 1.215 Test Acc: 0.915
Validation loss decreased (-0.899987 --> -0.914803).  Saving model ...
Epoch: 9 cost time: 0.48067259788513184
Epoch: 9, Steps: 2 | Train Loss: 0.897 Vali Loss: 1.086 Vali Acc: 0.926 Test Loss: 1.086 Test Acc: 0.926
Validation loss decreased (-0.914803 --> -0.925915).  Saving model ...
Epoch: 10 cost time: 0.4623708724975586
Epoch: 10, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.957 Vali Acc: 0.922 Test Loss: 0.957 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4326651096343994
Epoch: 11, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.831 Vali Acc: 0.922 Test Loss: 0.831 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.43073415756225586
Epoch: 12, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.714 Vali Acc: 0.922 Test Loss: 0.714 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5229146480560303
Epoch: 13, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.609 Vali Acc: 0.930 Test Loss: 0.609 Test Acc: 0.930
Validation loss decreased (-0.925915 --> -0.929624).  Saving model ...
Epoch: 14 cost time: 0.45904541015625
Epoch: 14, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.515 Vali Acc: 0.933 Test Loss: 0.515 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 15 cost time: 0.45937371253967285
Epoch: 15, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.436 Vali Acc: 0.944 Test Loss: 0.436 Test Acc: 0.944
Validation loss decreased (-0.933328 --> -0.944440).  Saving model ...
Epoch: 16 cost time: 0.4807851314544678
Epoch: 16, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 17 cost time: 0.43730688095092773
Epoch: 17, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.49720025062561035
Epoch: 18, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.45333385467529297
Epoch: 19, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.255 Vali Acc: 0.948 Test Loss: 0.255 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.49339842796325684
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.43996310234069824
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.4716970920562744
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.5017366409301758
Epoch: 23, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.4747347831726074
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.4356651306152344
Epoch: 25, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.47830724716186523
Epoch: 26, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.45234251022338867
Epoch: 27, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.4363057613372803
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.45091938972473145
Epoch: 29, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.4714775085449219
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.48314785957336426
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.5261006355285645
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.4927821159362793
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.444652795791626
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.48197221755981445
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.44172024726867676
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.48541736602783203
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.48070549964904785
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.492063045501709
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.4524502754211426
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.4830760955810547
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.42362117767333984
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.44988298416137695
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.44396400451660156
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.47953367233276367
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5820417404174805
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5350673198699951
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4898808002471924
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.45060181617736816
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.4672119617462158
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1507590
model size : 5.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7984063625335693
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.798 Vali Acc: 0.078 Test Loss: 1.798 Test Acc: 0.078
Validation loss decreased (inf --> -0.077760).  Saving model ...
Epoch: 2 cost time: 0.43915486335754395
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.773 Vali Acc: 0.137 Test Loss: 1.773 Test Acc: 0.137
Validation loss decreased (-0.077760 --> -0.137019).  Saving model ...
Epoch: 3 cost time: 0.44983625411987305
Epoch: 3, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.743 Vali Acc: 0.204 Test Loss: 1.743 Test Acc: 0.204
Validation loss decreased (-0.137019 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.467041015625
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.695 Vali Acc: 0.370 Test Loss: 1.695 Test Acc: 0.370
Validation loss decreased (-0.203686 --> -0.370353).  Saving model ...
Epoch: 5 cost time: 0.5484023094177246
Epoch: 5, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.631 Vali Acc: 0.507 Test Loss: 1.631 Test Acc: 0.507
Validation loss decreased (-0.370353 --> -0.507391).  Saving model ...
Epoch: 6 cost time: 0.4853389263153076
Epoch: 6, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.553 Vali Acc: 0.604 Test Loss: 1.553 Test Acc: 0.604
Validation loss decreased (-0.507391 --> -0.603688).  Saving model ...
Epoch: 7 cost time: 0.4612691402435303
Epoch: 7, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.462 Vali Acc: 0.704 Test Loss: 1.462 Test Acc: 0.704
Validation loss decreased (-0.603688 --> -0.703689).  Saving model ...
Epoch: 8 cost time: 0.48305559158325195
Epoch: 8, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.362 Vali Acc: 0.774 Test Loss: 1.362 Test Acc: 0.774
Validation loss decreased (-0.703689 --> -0.774060).  Saving model ...
Epoch: 9 cost time: 0.45842599868774414
Epoch: 9, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.255 Vali Acc: 0.841 Test Loss: 1.255 Test Acc: 0.841
Validation loss decreased (-0.774060 --> -0.840728).  Saving model ...
Epoch: 10 cost time: 0.47307896614074707
Epoch: 10, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.143 Vali Acc: 0.885 Test Loss: 1.143 Test Acc: 0.885
Validation loss decreased (-0.840728 --> -0.885174).  Saving model ...
Epoch: 11 cost time: 0.49856090545654297
Epoch: 11, Steps: 2 | Train Loss: 0.778 Vali Loss: 1.028 Vali Acc: 0.900 Test Loss: 1.028 Test Acc: 0.900
Validation loss decreased (-0.885174 --> -0.899990).  Saving model ...
Epoch: 12 cost time: 0.5757081508636475
Epoch: 12, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.913 Vali Acc: 0.907 Test Loss: 0.913 Test Acc: 0.907
Validation loss decreased (-0.899990 --> -0.907398).  Saving model ...
Epoch: 13 cost time: 0.46066784858703613
Epoch: 13, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.802 Vali Acc: 0.911 Test Loss: 0.802 Test Acc: 0.911
Validation loss decreased (-0.907398 --> -0.911103).  Saving model ...
Epoch: 14 cost time: 0.5097060203552246
Epoch: 14, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.699 Vali Acc: 0.915 Test Loss: 0.699 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914808).  Saving model ...
Epoch: 15 cost time: 0.4530489444732666
Epoch: 15, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.605 Vali Acc: 0.919 Test Loss: 0.605 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 16 cost time: 0.4642760753631592
Epoch: 16, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.522 Vali Acc: 0.915 Test Loss: 0.522 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4372694492340088
Epoch: 17, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.450 Vali Acc: 0.926 Test Loss: 0.450 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925921).  Saving model ...
Epoch: 18 cost time: 0.43877434730529785
Epoch: 18, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.392 Vali Acc: 0.941 Test Loss: 0.392 Test Acc: 0.941
Validation loss decreased (-0.925921 --> -0.940737).  Saving model ...
Epoch: 19 cost time: 0.49648165702819824
Epoch: 19, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.4891519546508789
Epoch: 20, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.46115660667419434
Epoch: 21, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.278 Vali Acc: 0.944 Test Loss: 0.278 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.48962950706481934
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.255 Vali Acc: 0.948 Test Loss: 0.255 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.46338367462158203
Epoch: 23, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.4468963146209717
Epoch: 24, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.5091028213500977
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.5072121620178223
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.4701857566833496
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.5339329242706299
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.4993875026702881
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.4590919017791748
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.4554615020751953
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.43102431297302246
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.44449877738952637
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.4408273696899414
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.5175273418426514
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.4386763572692871
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.4662437438964844
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.4524240493774414
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.4598686695098877
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.42971181869506836
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.448333740234375
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.426973819732666
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.49208593368530273
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.4604957103729248
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.42046403884887695
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.4156472682952881
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.4927670955657959
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.379711389541626
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.41866469383239746
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.4235358238220215
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1489414
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.702012300491333
Epoch: 1, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.815 Vali Acc: 0.048 Test Loss: 1.815 Test Acc: 0.048
Validation loss decreased (inf --> -0.048130).  Saving model ...
Epoch: 2 cost time: 0.5264296531677246
Epoch: 2, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.793 Vali Acc: 0.096 Test Loss: 1.793 Test Acc: 0.096
Validation loss decreased (-0.048130 --> -0.096278).  Saving model ...
Epoch: 3 cost time: 0.4604041576385498
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.765 Vali Acc: 0.196 Test Loss: 1.765 Test Acc: 0.196
Validation loss decreased (-0.096278 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.6014635562896729
Epoch: 4, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.722 Vali Acc: 0.367 Test Loss: 1.722 Test Acc: 0.367
Validation loss decreased (-0.196279 --> -0.366649).  Saving model ...
Epoch: 5 cost time: 0.4748561382293701
Epoch: 5, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.662 Vali Acc: 0.578 Test Loss: 1.662 Test Acc: 0.578
Validation loss decreased (-0.366649 --> -0.577761).  Saving model ...
Epoch: 6 cost time: 0.5429046154022217
Epoch: 6, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.588 Vali Acc: 0.711 Test Loss: 1.588 Test Acc: 0.711
Validation loss decreased (-0.577761 --> -0.711095).  Saving model ...
Epoch: 7 cost time: 0.4789280891418457
Epoch: 7, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.501 Vali Acc: 0.796 Test Loss: 1.501 Test Acc: 0.796
Validation loss decreased (-0.711095 --> -0.796281).  Saving model ...
Epoch: 8 cost time: 0.4794449806213379
Epoch: 8, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.403 Vali Acc: 0.826 Test Loss: 1.403 Test Acc: 0.826
Validation loss decreased (-0.796281 --> -0.825912).  Saving model ...
Epoch: 9 cost time: 0.4572722911834717
Epoch: 9, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.295 Vali Acc: 0.863 Test Loss: 1.295 Test Acc: 0.863
Validation loss decreased (-0.825912 --> -0.862950).  Saving model ...
Epoch: 10 cost time: 0.49426865577697754
Epoch: 10, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.178 Vali Acc: 0.885 Test Loss: 1.178 Test Acc: 0.885
Validation loss decreased (-0.862950 --> -0.885173).  Saving model ...
Epoch: 11 cost time: 0.5046348571777344
Epoch: 11, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.056 Vali Acc: 0.907 Test Loss: 1.056 Test Acc: 0.907
Validation loss decreased (-0.885173 --> -0.907397).  Saving model ...
Epoch: 12 cost time: 0.5474996566772461
Epoch: 12, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.934 Vali Acc: 0.919 Test Loss: 0.934 Test Acc: 0.919
Validation loss decreased (-0.907397 --> -0.918509).  Saving model ...
Epoch: 13 cost time: 0.5468509197235107
Epoch: 13, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.816 Vali Acc: 0.919 Test Loss: 0.816 Test Acc: 0.919
Validation loss decreased (-0.918509 --> -0.918510).  Saving model ...
Epoch: 14 cost time: 0.4613330364227295
Epoch: 14, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.705 Vali Acc: 0.933 Test Loss: 0.705 Test Acc: 0.933
Validation loss decreased (-0.918510 --> -0.933326).  Saving model ...
Epoch: 15 cost time: 0.4845848083496094
Epoch: 15, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.606 Vali Acc: 0.944 Test Loss: 0.606 Test Acc: 0.944
Validation loss decreased (-0.933326 --> -0.944438).  Saving model ...
Epoch: 16 cost time: 0.4863452911376953
Epoch: 16, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.520 Vali Acc: 0.948 Test Loss: 0.520 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948143).  Saving model ...
Epoch: 17 cost time: 0.4536302089691162
Epoch: 17, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.449 Vali Acc: 0.948 Test Loss: 0.449 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 18 cost time: 0.46584439277648926
Epoch: 18, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.391 Vali Acc: 0.948 Test Loss: 0.391 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 19 cost time: 0.5015566349029541
Epoch: 19, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5559782981872559
Epoch: 20, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4322688579559326
Epoch: 21, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5755095481872559
Epoch: 22, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.5475752353668213
Epoch: 23, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 24 cost time: 0.4989759922027588
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.956 Test Loss: 0.223 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.4910125732421875
Epoch: 25, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.4822213649749756
Epoch: 26, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5669305324554443
Epoch: 27, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5520262718200684
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4806022644042969
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.4586811065673828
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.5902795791625977
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.5439653396606445
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959258).  Saving model ...
Epoch: 33 cost time: 0.4665071964263916
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 34 cost time: 0.5225794315338135
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 35 cost time: 0.5912106037139893
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 36 cost time: 0.4974074363708496
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
Validation loss decreased (-0.959258 --> -0.962961).  Saving model ...
Epoch: 37 cost time: 0.5451509952545166
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 38 cost time: 0.525022029876709
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 39 cost time: 0.4694826602935791
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 40 cost time: 0.4346177577972412
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 41 cost time: 0.5192558765411377
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 42 cost time: 0.5300226211547852
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 43 cost time: 0.48020458221435547
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 44 cost time: 0.5302484035491943
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 45 cost time: 0.5796947479248047
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 46 cost time: 0.4683551788330078
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 47 cost time: 0.5152413845062256
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 48 cost time: 0.46077704429626465
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 49 cost time: 0.5261325836181641
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 50 cost time: 0.4691276550292969
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 1483654
model size : 5.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6786861419677734
Epoch: 1, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.829 Vali Acc: 0.189 Test Loss: 1.829 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.4839308261871338
Epoch: 2, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.811 Vali Acc: 0.226 Test Loss: 1.811 Test Acc: 0.226
Validation loss decreased (-0.188871 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.4696164131164551
Epoch: 3, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.790 Vali Acc: 0.233 Test Loss: 1.790 Test Acc: 0.233
Validation loss decreased (-0.225908 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 0.47359561920166016
Epoch: 4, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.757 Vali Acc: 0.285 Test Loss: 1.757 Test Acc: 0.285
Validation loss decreased (-0.233315 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.5061419010162354
Epoch: 5, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.711 Vali Acc: 0.333 Test Loss: 1.711 Test Acc: 0.333
Validation loss decreased (-0.285168 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.5600419044494629
Epoch: 6, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.654 Vali Acc: 0.444 Test Loss: 1.654 Test Acc: 0.444
Validation loss decreased (-0.333316 --> -0.444428).  Saving model ...
Epoch: 7 cost time: 0.4962151050567627
Epoch: 7, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.586 Vali Acc: 0.559 Test Loss: 1.586 Test Acc: 0.559
Validation loss decreased (-0.444428 --> -0.559243).  Saving model ...
Epoch: 8 cost time: 0.5175001621246338
Epoch: 8, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.509 Vali Acc: 0.619 Test Loss: 1.509 Test Acc: 0.619
Validation loss decreased (-0.559243 --> -0.618503).  Saving model ...
Epoch: 9 cost time: 0.4391505718231201
Epoch: 9, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.424 Vali Acc: 0.663 Test Loss: 1.424 Test Acc: 0.663
Validation loss decreased (-0.618503 --> -0.662949).  Saving model ...
Epoch: 10 cost time: 0.5289466381072998
Epoch: 10, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.333 Vali Acc: 0.744 Test Loss: 1.333 Test Acc: 0.744
Validation loss decreased (-0.662949 --> -0.744431).  Saving model ...
Epoch: 11 cost time: 0.5763278007507324
Epoch: 11, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.237 Vali Acc: 0.819 Test Loss: 1.237 Test Acc: 0.819
Validation loss decreased (-0.744431 --> -0.818506).  Saving model ...
Epoch: 12 cost time: 0.4504396915435791
Epoch: 12, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.137 Vali Acc: 0.867 Test Loss: 1.137 Test Acc: 0.867
Validation loss decreased (-0.818506 --> -0.866655).  Saving model ...
Epoch: 13 cost time: 0.42165279388427734
Epoch: 13, Steps: 2 | Train Loss: 0.845 Vali Loss: 1.037 Vali Acc: 0.893 Test Loss: 1.037 Test Acc: 0.893
Validation loss decreased (-0.866655 --> -0.892582).  Saving model ...
Epoch: 14 cost time: 0.5170729160308838
Epoch: 14, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.937 Vali Acc: 0.911 Test Loss: 0.937 Test Acc: 0.911
Validation loss decreased (-0.892582 --> -0.911102).  Saving model ...
Epoch: 15 cost time: 0.4638502597808838
Epoch: 15, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.840 Vali Acc: 0.919 Test Loss: 0.840 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918510).  Saving model ...
Epoch: 16 cost time: 0.437969446182251
Epoch: 16, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.750 Vali Acc: 0.926 Test Loss: 0.750 Test Acc: 0.926
Validation loss decreased (-0.918510 --> -0.925918).  Saving model ...
Epoch: 17 cost time: 0.45044851303100586
Epoch: 17, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.667 Vali Acc: 0.926 Test Loss: 0.667 Test Acc: 0.926
Validation loss decreased (-0.925918 --> -0.925919).  Saving model ...
Epoch: 18 cost time: 0.452805757522583
Epoch: 18, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.592 Vali Acc: 0.922 Test Loss: 0.592 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4374692440032959
Epoch: 19, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.526 Vali Acc: 0.933 Test Loss: 0.526 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933328).  Saving model ...
Epoch: 20 cost time: 0.4950065612792969
Epoch: 20, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 21 cost time: 0.4797394275665283
Epoch: 21, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.421 Vali Acc: 0.941 Test Loss: 0.421 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940737).  Saving model ...
Epoch: 22 cost time: 0.45763659477233887
Epoch: 22, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.382 Vali Acc: 0.941 Test Loss: 0.382 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 23 cost time: 0.4846489429473877
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.5221896171569824
Epoch: 24, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.319 Vali Acc: 0.948 Test Loss: 0.319 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 25 cost time: 0.43312668800354004
Epoch: 25, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.5048391819000244
Epoch: 26, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.276 Vali Acc: 0.952 Test Loss: 0.276 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 27 cost time: 0.4716954231262207
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.260 Vali Acc: 0.952 Test Loss: 0.260 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 28 cost time: 0.46331310272216797
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.246 Vali Acc: 0.952 Test Loss: 0.246 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 29 cost time: 0.4649848937988281
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.4713103771209717
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 31 cost time: 0.4718172550201416
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.46764659881591797
Epoch: 32, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.963 Test Loss: 0.211 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.4456787109375
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 34 cost time: 0.48106908798217773
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 35 cost time: 0.4816408157348633
Epoch: 35, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 36 cost time: 0.5450363159179688
Epoch: 36, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 37 cost time: 0.4788787364959717
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 38 cost time: 0.48082661628723145
Epoch: 38, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 39 cost time: 0.5390515327453613
Epoch: 39, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 40 cost time: 0.46143126487731934
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 41 cost time: 0.43973207473754883
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 42 cost time: 0.4439542293548584
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.45884156227111816
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.4726686477661133
Epoch: 44, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.5212380886077881
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.5504779815673828
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 47 cost time: 0.43811488151550293
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 48 cost time: 0.43236827850341797
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 49 cost time: 0.4766356945037842
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 50 cost time: 0.4654848575592041
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 1471750
model size : 5.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7702994346618652
Epoch: 1, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.732 Vali Acc: 0.322 Test Loss: 1.732 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.5140068531036377
Epoch: 2, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.713 Vali Acc: 0.400 Test Loss: 1.713 Test Acc: 0.400
Validation loss decreased (-0.322205 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 0.4750559329986572
Epoch: 3, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.692 Vali Acc: 0.493 Test Loss: 1.692 Test Acc: 0.493
Validation loss decreased (-0.399983 --> -0.492576).  Saving model ...
Epoch: 4 cost time: 0.534553050994873
Epoch: 4, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.660 Vali Acc: 0.596 Test Loss: 1.660 Test Acc: 0.596
Validation loss decreased (-0.492576 --> -0.596280).  Saving model ...
Epoch: 5 cost time: 0.4824674129486084
Epoch: 5, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.617 Vali Acc: 0.667 Test Loss: 1.617 Test Acc: 0.667
Validation loss decreased (-0.596280 --> -0.666650).  Saving model ...
Epoch: 6 cost time: 0.5208215713500977
Epoch: 6, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.564 Vali Acc: 0.726 Test Loss: 1.564 Test Acc: 0.726
Validation loss decreased (-0.666650 --> -0.725910).  Saving model ...
Epoch: 7 cost time: 0.4692225456237793
Epoch: 7, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.501 Vali Acc: 0.785 Test Loss: 1.501 Test Acc: 0.785
Validation loss decreased (-0.725910 --> -0.785170).  Saving model ...
Epoch: 8 cost time: 0.4659452438354492
Epoch: 8, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.430 Vali Acc: 0.826 Test Loss: 1.430 Test Acc: 0.826
Validation loss decreased (-0.785170 --> -0.825912).  Saving model ...
Epoch: 9 cost time: 0.5173702239990234
Epoch: 9, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.352 Vali Acc: 0.859 Test Loss: 1.352 Test Acc: 0.859
Validation loss decreased (-0.825912 --> -0.859246).  Saving model ...
Epoch: 10 cost time: 0.5149469375610352
Epoch: 10, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.269 Vali Acc: 0.885 Test Loss: 1.269 Test Acc: 0.885
Validation loss decreased (-0.859246 --> -0.885172).  Saving model ...
Epoch: 11 cost time: 0.48813319206237793
Epoch: 11, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.182 Vali Acc: 0.885 Test Loss: 1.182 Test Acc: 0.885
Validation loss decreased (-0.885172 --> -0.885173).  Saving model ...
Epoch: 12 cost time: 0.4724299907684326
Epoch: 12, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.092 Vali Acc: 0.904 Test Loss: 1.092 Test Acc: 0.904
Validation loss decreased (-0.885173 --> -0.903693).  Saving model ...
Epoch: 13 cost time: 0.5749027729034424
Epoch: 13, Steps: 2 | Train Loss: 0.761 Vali Loss: 1.002 Vali Acc: 0.900 Test Loss: 1.002 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4742915630340576
Epoch: 14, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.912 Vali Acc: 0.911 Test Loss: 0.912 Test Acc: 0.911
Validation loss decreased (-0.903693 --> -0.911102).  Saving model ...
Epoch: 15 cost time: 0.5496792793273926
Epoch: 15, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.826 Vali Acc: 0.933 Test Loss: 0.826 Test Acc: 0.933
Validation loss decreased (-0.911102 --> -0.933325).  Saving model ...
Epoch: 16 cost time: 0.46080446243286133
Epoch: 16, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.746 Vali Acc: 0.937 Test Loss: 0.746 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937030).  Saving model ...
Epoch: 17 cost time: 0.44513583183288574
Epoch: 17, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.672 Vali Acc: 0.941 Test Loss: 0.672 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940734).  Saving model ...
Epoch: 18 cost time: 0.41884398460388184
Epoch: 18, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.605 Vali Acc: 0.933 Test Loss: 0.605 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4656217098236084
Epoch: 19, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.546 Vali Acc: 0.941 Test Loss: 0.546 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 20 cost time: 0.5037708282470703
Epoch: 20, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.493 Vali Acc: 0.941 Test Loss: 0.493 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 21 cost time: 0.5510075092315674
Epoch: 21, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.447 Vali Acc: 0.941 Test Loss: 0.447 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 22 cost time: 0.5508992671966553
Epoch: 22, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.408 Vali Acc: 0.944 Test Loss: 0.408 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 23 cost time: 0.5149388313293457
Epoch: 23, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.374 Vali Acc: 0.944 Test Loss: 0.374 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 24 cost time: 0.4655299186706543
Epoch: 24, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 0.4397461414337158
Epoch: 25, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 0.41481733322143555
Epoch: 26, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 0.43566441535949707
Epoch: 27, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.5228095054626465
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.269 Vali Acc: 0.956 Test Loss: 0.269 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.4333822727203369
Epoch: 29, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.258 Vali Acc: 0.963 Test Loss: 0.258 Test Acc: 0.963
Validation loss decreased (-0.955553 --> -0.962960).  Saving model ...
Epoch: 30 cost time: 0.5429863929748535
Epoch: 30, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.963 Test Loss: 0.248 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 31 cost time: 0.43872761726379395
Epoch: 31, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.240 Vali Acc: 0.963 Test Loss: 0.240 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962961).  Saving model ...
Epoch: 32 cost time: 0.5064687728881836
Epoch: 32, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.4222526550292969
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 34 cost time: 0.5112793445587158
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.48032069206237793
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5565910339355469
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5263361930847168
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5217914581298828
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4664132595062256
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4678151607513428
Epoch: 40, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.44727087020874023
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 42 cost time: 0.4588286876678467
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 43 cost time: 0.48235511779785156
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 44 cost time: 0.4803152084350586
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.4782435894012451
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.47958946228027344
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 47 cost time: 0.5165436267852783
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 48 cost time: 0.46623897552490234
Epoch: 48, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 49 cost time: 0.4701192378997803
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 50 cost time: 0.4848601818084717
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 1466118
model size : 5.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6105279922485352
Epoch: 1, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.759 Vali Acc: 0.319 Test Loss: 1.759 Test Acc: 0.319
Validation loss decreased (inf --> -0.318501).  Saving model ...
Epoch: 2 cost time: 0.4148387908935547
Epoch: 2, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.721 Vali Acc: 0.481 Test Loss: 1.721 Test Acc: 0.481
Validation loss decreased (-0.318501 --> -0.481464).  Saving model ...
Epoch: 3 cost time: 0.41389894485473633
Epoch: 3, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.670 Vali Acc: 0.559 Test Loss: 1.670 Test Acc: 0.559
Validation loss decreased (-0.481464 --> -0.559243).  Saving model ...
Epoch: 4 cost time: 0.43941545486450195
Epoch: 4, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.589 Vali Acc: 0.619 Test Loss: 1.589 Test Acc: 0.619
Validation loss decreased (-0.559243 --> -0.618503).  Saving model ...
Epoch: 5 cost time: 0.4645662307739258
Epoch: 5, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.485 Vali Acc: 0.652 Test Loss: 1.485 Test Acc: 0.652
Validation loss decreased (-0.618503 --> -0.651837).  Saving model ...
Epoch: 6 cost time: 0.38931798934936523
Epoch: 6, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.366 Vali Acc: 0.752 Test Loss: 1.366 Test Acc: 0.752
Validation loss decreased (-0.651837 --> -0.751838).  Saving model ...
Epoch: 7 cost time: 0.38669633865356445
Epoch: 7, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.235 Vali Acc: 0.807 Test Loss: 1.235 Test Acc: 0.807
Validation loss decreased (-0.751838 --> -0.807395).  Saving model ...
Epoch: 8 cost time: 0.41178393363952637
Epoch: 8, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.098 Vali Acc: 0.848 Test Loss: 1.098 Test Acc: 0.848
Validation loss decreased (-0.807395 --> -0.848137).  Saving model ...
Epoch: 9 cost time: 0.41468334197998047
Epoch: 9, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.962 Vali Acc: 0.867 Test Loss: 0.962 Test Acc: 0.867
Validation loss decreased (-0.848137 --> -0.866657).  Saving model ...
Epoch: 10 cost time: 0.36626672744750977
Epoch: 10, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.830 Vali Acc: 0.893 Test Loss: 0.830 Test Acc: 0.893
Validation loss decreased (-0.866657 --> -0.892584).  Saving model ...
Epoch: 11 cost time: 0.3894038200378418
Epoch: 11, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.708 Vali Acc: 0.911 Test Loss: 0.708 Test Acc: 0.911
Validation loss decreased (-0.892584 --> -0.911104).  Saving model ...
Epoch: 12 cost time: 0.378765344619751
Epoch: 12, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.598 Vali Acc: 0.926 Test Loss: 0.598 Test Acc: 0.926
Validation loss decreased (-0.911104 --> -0.925920).  Saving model ...
Epoch: 13 cost time: 0.4250304698944092
Epoch: 13, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.500 Vali Acc: 0.941 Test Loss: 0.500 Test Acc: 0.941
Validation loss decreased (-0.925920 --> -0.940736).  Saving model ...
Epoch: 14 cost time: 0.424990177154541
Epoch: 14, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.418 Vali Acc: 0.948 Test Loss: 0.418 Test Acc: 0.948
Validation loss decreased (-0.940736 --> -0.948144).  Saving model ...
Epoch: 15 cost time: 0.4477272033691406
Epoch: 15, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.352 Vali Acc: 0.948 Test Loss: 0.352 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 16 cost time: 0.42238855361938477
Epoch: 16, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.301 Vali Acc: 0.948 Test Loss: 0.301 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 17 cost time: 0.39542698860168457
Epoch: 17, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.35845518112182617
Epoch: 18, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.36655569076538086
Epoch: 19, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.38724637031555176
Epoch: 20, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4519829750061035
Epoch: 21, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.3974764347076416
Epoch: 22, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.45038747787475586
Epoch: 23, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4354386329650879
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.40591883659362793
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.3719751834869385
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 477126
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.678750991821289
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.820 Vali Acc: 0.144 Test Loss: 1.820 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.46457839012145996
Epoch: 2, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.797 Vali Acc: 0.193 Test Loss: 1.797 Test Acc: 0.193
Validation loss decreased (-0.144426 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.4107537269592285
Epoch: 3, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.770 Vali Acc: 0.259 Test Loss: 1.770 Test Acc: 0.259
Validation loss decreased (-0.192575 --> -0.259242).  Saving model ...
Epoch: 4 cost time: 0.4544045925140381
Epoch: 4, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.730 Vali Acc: 0.352 Test Loss: 1.730 Test Acc: 0.352
Validation loss decreased (-0.259242 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 0.43854427337646484
Epoch: 5, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.675 Vali Acc: 0.463 Test Loss: 1.675 Test Acc: 0.463
Validation loss decreased (-0.351835 --> -0.462946).  Saving model ...
Epoch: 6 cost time: 0.4341564178466797
Epoch: 6, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.606 Vali Acc: 0.544 Test Loss: 1.606 Test Acc: 0.544
Validation loss decreased (-0.462946 --> -0.544428).  Saving model ...
Epoch: 7 cost time: 0.4400351047515869
Epoch: 7, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.527 Vali Acc: 0.611 Test Loss: 1.527 Test Acc: 0.611
Validation loss decreased (-0.544428 --> -0.611096).  Saving model ...
Epoch: 8 cost time: 0.4124472141265869
Epoch: 8, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.437 Vali Acc: 0.711 Test Loss: 1.437 Test Acc: 0.711
Validation loss decreased (-0.611096 --> -0.711097).  Saving model ...
Epoch: 9 cost time: 0.3660550117492676
Epoch: 9, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.338 Vali Acc: 0.774 Test Loss: 1.338 Test Acc: 0.774
Validation loss decreased (-0.711097 --> -0.774061).  Saving model ...
Epoch: 10 cost time: 0.41341638565063477
Epoch: 10, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.232 Vali Acc: 0.807 Test Loss: 1.232 Test Acc: 0.807
Validation loss decreased (-0.774061 --> -0.807395).  Saving model ...
Epoch: 11 cost time: 0.43914055824279785
Epoch: 11, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.121 Vali Acc: 0.848 Test Loss: 1.121 Test Acc: 0.848
Validation loss decreased (-0.807395 --> -0.848137).  Saving model ...
Epoch: 12 cost time: 0.4263303279876709
Epoch: 12, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.009 Vali Acc: 0.856 Test Loss: 1.009 Test Acc: 0.856
Validation loss decreased (-0.848137 --> -0.855545).  Saving model ...
Epoch: 13 cost time: 0.405519962310791
Epoch: 13, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.901 Vali Acc: 0.870 Test Loss: 0.901 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 14 cost time: 0.4436945915222168
Epoch: 14, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.799 Vali Acc: 0.893 Test Loss: 0.799 Test Acc: 0.893
Validation loss decreased (-0.870361 --> -0.892585).  Saving model ...
Epoch: 15 cost time: 0.40008068084716797
Epoch: 15, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.705 Vali Acc: 0.900 Test Loss: 0.705 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.4186828136444092
Epoch: 16, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.38861846923828125
Epoch: 17, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.39277219772338867
Epoch: 18, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.417844295501709
Epoch: 19, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.429 Vali Acc: 0.904 Test Loss: 0.429 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 20 cost time: 0.4495232105255127
Epoch: 20, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 0.4025428295135498
Epoch: 21, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.351 Vali Acc: 0.915 Test Loss: 0.351 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 0.49755072593688965
Epoch: 22, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 23 cost time: 0.4541468620300293
Epoch: 23, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.302 Vali Acc: 0.915 Test Loss: 0.302 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 24 cost time: 0.4306807518005371
Epoch: 24, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 0.3859126567840576
Epoch: 25, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.3798220157623291
Epoch: 26, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 0.42387819290161133
Epoch: 27, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.45868444442749023
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.4165358543395996
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.4592275619506836
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.4335286617279053
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.3814527988433838
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.3631927967071533
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.3806886672973633
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.4078848361968994
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.4165682792663574
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.39058589935302734
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.41134047508239746
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.4180901050567627
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.4062948226928711
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.39895081520080566
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.37018823623657227
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.3734934329986572
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.40276432037353516
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.43376994132995605
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.40092897415161133
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.399158239364624
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.4152510166168213
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.40464210510253906
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.4202752113342285
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 425030
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.611685037612915
Epoch: 1, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.752 Vali Acc: 0.148 Test Loss: 1.752 Test Acc: 0.148
Validation loss decreased (inf --> -0.148131).  Saving model ...
Epoch: 2 cost time: 0.45137786865234375
Epoch: 2, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.723 Vali Acc: 0.215 Test Loss: 1.723 Test Acc: 0.215
Validation loss decreased (-0.148131 --> -0.214798).  Saving model ...
Epoch: 3 cost time: 0.44231152534484863
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.697 Vali Acc: 0.289 Test Loss: 1.697 Test Acc: 0.289
Validation loss decreased (-0.214798 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.46820640563964844
Epoch: 4, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.664 Vali Acc: 0.393 Test Loss: 1.664 Test Acc: 0.393
Validation loss decreased (-0.288872 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.4429316520690918
Epoch: 5, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.621 Vali Acc: 0.493 Test Loss: 1.621 Test Acc: 0.493
Validation loss decreased (-0.392576 --> -0.492576).  Saving model ...
Epoch: 6 cost time: 0.3826150894165039
Epoch: 6, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.568 Vali Acc: 0.581 Test Loss: 1.568 Test Acc: 0.581
Validation loss decreased (-0.492576 --> -0.581466).  Saving model ...
Epoch: 7 cost time: 0.413313627243042
Epoch: 7, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.508 Vali Acc: 0.622 Test Loss: 1.508 Test Acc: 0.622
Validation loss decreased (-0.581466 --> -0.622207).  Saving model ...
Epoch: 8 cost time: 0.39748692512512207
Epoch: 8, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.441 Vali Acc: 0.685 Test Loss: 1.441 Test Acc: 0.685
Validation loss decreased (-0.622207 --> -0.685171).  Saving model ...
Epoch: 9 cost time: 0.38637614250183105
Epoch: 9, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.367 Vali Acc: 0.730 Test Loss: 1.367 Test Acc: 0.730
Validation loss decreased (-0.685171 --> -0.729616).  Saving model ...
Epoch: 10 cost time: 0.437319278717041
Epoch: 10, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.286 Vali Acc: 0.767 Test Loss: 1.286 Test Acc: 0.767
Validation loss decreased (-0.729616 --> -0.766654).  Saving model ...
Epoch: 11 cost time: 0.40533947944641113
Epoch: 11, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.203 Vali Acc: 0.804 Test Loss: 1.203 Test Acc: 0.804
Validation loss decreased (-0.766654 --> -0.803692).  Saving model ...
Epoch: 12 cost time: 0.4616587162017822
Epoch: 12, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.115 Vali Acc: 0.830 Test Loss: 1.115 Test Acc: 0.830
Validation loss decreased (-0.803692 --> -0.829618).  Saving model ...
Epoch: 13 cost time: 0.4267396926879883
Epoch: 13, Steps: 2 | Train Loss: 0.827 Vali Loss: 1.026 Vali Acc: 0.852 Test Loss: 1.026 Test Acc: 0.852
Validation loss decreased (-0.829618 --> -0.851842).  Saving model ...
Epoch: 14 cost time: 0.4010918140411377
Epoch: 14, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.936 Vali Acc: 0.870 Test Loss: 0.936 Test Acc: 0.870
Validation loss decreased (-0.851842 --> -0.870361).  Saving model ...
Epoch: 15 cost time: 0.3807828426361084
Epoch: 15, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.847 Vali Acc: 0.874 Test Loss: 0.847 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874066).  Saving model ...
Epoch: 16 cost time: 0.37657999992370605
Epoch: 16, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.762 Vali Acc: 0.896 Test Loss: 0.762 Test Acc: 0.896
Validation loss decreased (-0.874066 --> -0.896289).  Saving model ...
Epoch: 17 cost time: 0.406597375869751
Epoch: 17, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.682 Vali Acc: 0.904 Test Loss: 0.682 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903697).  Saving model ...
Epoch: 18 cost time: 0.4293670654296875
Epoch: 18, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.609 Vali Acc: 0.911 Test Loss: 0.609 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 19 cost time: 0.43027663230895996
Epoch: 19, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.542 Vali Acc: 0.915 Test Loss: 0.542 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 20 cost time: 0.3968193531036377
Epoch: 20, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.486 Vali Acc: 0.919 Test Loss: 0.486 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918514).  Saving model ...
Epoch: 21 cost time: 0.38991284370422363
Epoch: 21, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.436 Vali Acc: 0.926 Test Loss: 0.436 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.4631471633911133
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933329).  Saving model ...
Epoch: 23 cost time: 0.37566614151000977
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.358 Vali Acc: 0.933 Test Loss: 0.358 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.34320759773254395
Epoch: 24, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 0.3833897113800049
Epoch: 25, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.39071178436279297
Epoch: 26, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 27 cost time: 0.4107844829559326
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.3954784870147705
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.4184911251068115
Epoch: 29, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.39296674728393555
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.40785789489746094
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 32 cost time: 0.42409181594848633
Epoch: 32, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.3799281120300293
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.4450345039367676
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.42407894134521484
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.4385957717895508
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.40181779861450195
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.43409109115600586
Epoch: 38, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.38530707359313965
Epoch: 39, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.3906855583190918
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.41139888763427734
Epoch: 41, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.4060640335083008
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.40782713890075684
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.4214968681335449
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.3864622116088867
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.4700927734375
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.39653968811035156
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.415679931640625
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.3774576187133789
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.4075136184692383
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 409734
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7137787342071533
Epoch: 1, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.769 Vali Acc: 0.189 Test Loss: 1.769 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.4486081600189209
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.751 Vali Acc: 0.259 Test Loss: 1.751 Test Acc: 0.259
Validation loss decreased (-0.188871 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.40819311141967773
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.734 Vali Acc: 0.300 Test Loss: 1.734 Test Acc: 0.300
Validation loss decreased (-0.259242 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.39627647399902344
Epoch: 4, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.711 Vali Acc: 0.341 Test Loss: 1.711 Test Acc: 0.341
Validation loss decreased (-0.299983 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.4056055545806885
Epoch: 5, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.681 Vali Acc: 0.374 Test Loss: 1.681 Test Acc: 0.374
Validation loss decreased (-0.340724 --> -0.374057).  Saving model ...
Epoch: 6 cost time: 0.4224975109100342
Epoch: 6, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.644 Vali Acc: 0.433 Test Loss: 1.644 Test Acc: 0.433
Validation loss decreased (-0.374057 --> -0.433317).  Saving model ...
Epoch: 7 cost time: 0.413646936416626
Epoch: 7, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.600 Vali Acc: 0.485 Test Loss: 1.600 Test Acc: 0.485
Validation loss decreased (-0.433317 --> -0.485169).  Saving model ...
Epoch: 8 cost time: 0.43305325508117676
Epoch: 8, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.550 Vali Acc: 0.537 Test Loss: 1.550 Test Acc: 0.537
Validation loss decreased (-0.485169 --> -0.537022).  Saving model ...
Epoch: 9 cost time: 0.538977861404419
Epoch: 9, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.493 Vali Acc: 0.596 Test Loss: 1.493 Test Acc: 0.596
Validation loss decreased (-0.537022 --> -0.596281).  Saving model ...
Epoch: 10 cost time: 0.5391225814819336
Epoch: 10, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.432 Vali Acc: 0.656 Test Loss: 1.432 Test Acc: 0.656
Validation loss decreased (-0.596281 --> -0.655541).  Saving model ...
Epoch: 11 cost time: 0.4516868591308594
Epoch: 11, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.365 Vali Acc: 0.715 Test Loss: 1.365 Test Acc: 0.715
Validation loss decreased (-0.655541 --> -0.714801).  Saving model ...
Epoch: 12 cost time: 0.40168333053588867
Epoch: 12, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.294 Vali Acc: 0.774 Test Loss: 1.294 Test Acc: 0.774
Validation loss decreased (-0.714801 --> -0.774061).  Saving model ...
Epoch: 13 cost time: 0.38433241844177246
Epoch: 13, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.219 Vali Acc: 0.807 Test Loss: 1.219 Test Acc: 0.807
Validation loss decreased (-0.774061 --> -0.807395).  Saving model ...
Epoch: 14 cost time: 0.4402432441711426
Epoch: 14, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.142 Vali Acc: 0.856 Test Loss: 1.142 Test Acc: 0.856
Validation loss decreased (-0.807395 --> -0.855544).  Saving model ...
Epoch: 15 cost time: 0.41561102867126465
Epoch: 15, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.063 Vali Acc: 0.870 Test Loss: 1.063 Test Acc: 0.870
Validation loss decreased (-0.855544 --> -0.870360).  Saving model ...
Epoch: 16 cost time: 0.4246833324432373
Epoch: 16, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.984 Vali Acc: 0.874 Test Loss: 0.984 Test Acc: 0.874
Validation loss decreased (-0.870360 --> -0.874064).  Saving model ...
Epoch: 17 cost time: 0.39702463150024414
Epoch: 17, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.904 Vali Acc: 0.900 Test Loss: 0.904 Test Acc: 0.900
Validation loss decreased (-0.874064 --> -0.899991).  Saving model ...
Epoch: 18 cost time: 0.5199577808380127
Epoch: 18, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.826 Vali Acc: 0.915 Test Loss: 0.826 Test Acc: 0.915
Validation loss decreased (-0.899991 --> -0.914807).  Saving model ...
Epoch: 19 cost time: 0.4663846492767334
Epoch: 19, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.752 Vali Acc: 0.919 Test Loss: 0.752 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 20 cost time: 0.4611349105834961
Epoch: 20, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.683 Vali Acc: 0.922 Test Loss: 0.683 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.4353489875793457
Epoch: 21, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.619 Vali Acc: 0.922 Test Loss: 0.619 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 22 cost time: 0.4074091911315918
Epoch: 22, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.562 Vali Acc: 0.930 Test Loss: 0.562 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 23 cost time: 0.42551612854003906
Epoch: 23, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.511 Vali Acc: 0.926 Test Loss: 0.511 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.44950127601623535
Epoch: 24, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.466 Vali Acc: 0.926 Test Loss: 0.466 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4122200012207031
Epoch: 25, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.426 Vali Acc: 0.937 Test Loss: 0.426 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.49092578887939453
Epoch: 26, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.393 Vali Acc: 0.937 Test Loss: 0.393 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 27 cost time: 0.398723840713501
Epoch: 27, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.46291518211364746
Epoch: 28, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 29 cost time: 0.40840792655944824
Epoch: 29, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.43317079544067383
Epoch: 30, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.42726850509643555
Epoch: 31, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.44885683059692383
Epoch: 32, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.4240872859954834
Epoch: 33, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.41954851150512695
Epoch: 34, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.4433276653289795
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.40908265113830566
Epoch: 36, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.4460723400115967
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.46616268157958984
Epoch: 38, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.45665931701660156
Epoch: 39, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.40958333015441895
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.454845666885376
Epoch: 41, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.4065096378326416
Epoch: 42, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.44194531440734863
Epoch: 43, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.42246580123901367
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4199213981628418
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4574112892150879
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4440319538116455
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4839968681335449
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.3959987163543701
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.431835412979126
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 400646
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.638932704925537
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.770 Vali Acc: 0.215 Test Loss: 1.770 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.44069385528564453
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.752 Vali Acc: 0.267 Test Loss: 1.752 Test Acc: 0.267
Validation loss decreased (-0.214797 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.41143345832824707
Epoch: 3, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.734 Vali Acc: 0.326 Test Loss: 1.734 Test Acc: 0.326
Validation loss decreased (-0.266649 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.43114447593688965
Epoch: 4, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.713 Vali Acc: 0.356 Test Loss: 1.713 Test Acc: 0.356
Validation loss decreased (-0.325909 --> -0.355538).  Saving model ...
Epoch: 5 cost time: 0.4357564449310303
Epoch: 5, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.684 Vali Acc: 0.456 Test Loss: 1.684 Test Acc: 0.456
Validation loss decreased (-0.355538 --> -0.455539).  Saving model ...
Epoch: 6 cost time: 0.474653959274292
Epoch: 6, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.649 Vali Acc: 0.570 Test Loss: 1.649 Test Acc: 0.570
Validation loss decreased (-0.455539 --> -0.570354).  Saving model ...
Epoch: 7 cost time: 0.41071176528930664
Epoch: 7, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.608 Vali Acc: 0.648 Test Loss: 1.608 Test Acc: 0.648
Validation loss decreased (-0.570354 --> -0.648132).  Saving model ...
Epoch: 8 cost time: 0.47418737411499023
Epoch: 8, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.561 Vali Acc: 0.715 Test Loss: 1.561 Test Acc: 0.715
Validation loss decreased (-0.648132 --> -0.714799).  Saving model ...
Epoch: 9 cost time: 0.41733479499816895
Epoch: 9, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.509 Vali Acc: 0.759 Test Loss: 1.509 Test Acc: 0.759
Validation loss decreased (-0.714799 --> -0.759244).  Saving model ...
Epoch: 10 cost time: 0.5455906391143799
Epoch: 10, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.452 Vali Acc: 0.793 Test Loss: 1.452 Test Acc: 0.793
Validation loss decreased (-0.759244 --> -0.792578).  Saving model ...
Epoch: 11 cost time: 0.5402193069458008
Epoch: 11, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.390 Vali Acc: 0.811 Test Loss: 1.390 Test Acc: 0.811
Validation loss decreased (-0.792578 --> -0.811097).  Saving model ...
Epoch: 12 cost time: 0.46982312202453613
Epoch: 12, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.324 Vali Acc: 0.826 Test Loss: 1.324 Test Acc: 0.826
Validation loss decreased (-0.811097 --> -0.825913).  Saving model ...
Epoch: 13 cost time: 0.4187295436859131
Epoch: 13, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.254 Vali Acc: 0.844 Test Loss: 1.254 Test Acc: 0.844
Validation loss decreased (-0.825913 --> -0.844432).  Saving model ...
Epoch: 14 cost time: 0.4294009208679199
Epoch: 14, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.182 Vali Acc: 0.870 Test Loss: 1.182 Test Acc: 0.870
Validation loss decreased (-0.844432 --> -0.870359).  Saving model ...
Epoch: 15 cost time: 0.43675947189331055
Epoch: 15, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.108 Vali Acc: 0.893 Test Loss: 1.108 Test Acc: 0.893
Validation loss decreased (-0.870359 --> -0.892582).  Saving model ...
Epoch: 16 cost time: 0.40222835540771484
Epoch: 16, Steps: 2 | Train Loss: 0.890 Vali Loss: 1.035 Vali Acc: 0.915 Test Loss: 1.035 Test Acc: 0.915
Validation loss decreased (-0.892582 --> -0.914804).  Saving model ...
Epoch: 17 cost time: 0.3924717903137207
Epoch: 17, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.961 Vali Acc: 0.937 Test Loss: 0.961 Test Acc: 0.937
Validation loss decreased (-0.914804 --> -0.937027).  Saving model ...
Epoch: 18 cost time: 0.4245328903198242
Epoch: 18, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.887 Vali Acc: 0.941 Test Loss: 0.887 Test Acc: 0.941
Validation loss decreased (-0.937027 --> -0.940732).  Saving model ...
Epoch: 19 cost time: 0.4309113025665283
Epoch: 19, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.815 Vali Acc: 0.941 Test Loss: 0.815 Test Acc: 0.941
Validation loss decreased (-0.940732 --> -0.940733).  Saving model ...
Epoch: 20 cost time: 0.4604051113128662
Epoch: 20, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.746 Vali Acc: 0.941 Test Loss: 0.746 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940733).  Saving model ...
Epoch: 21 cost time: 0.5087366104125977
Epoch: 21, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.681 Vali Acc: 0.944 Test Loss: 0.681 Test Acc: 0.944
Validation loss decreased (-0.940733 --> -0.944438).  Saving model ...
Epoch: 22 cost time: 0.48296666145324707
Epoch: 22, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.621 Vali Acc: 0.948 Test Loss: 0.621 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948142).  Saving model ...
Epoch: 23 cost time: 0.43309664726257324
Epoch: 23, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.566 Vali Acc: 0.948 Test Loss: 0.566 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948142).  Saving model ...
Epoch: 24 cost time: 0.46054959297180176
Epoch: 24, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.517 Vali Acc: 0.956 Test Loss: 0.517 Test Acc: 0.956
Validation loss decreased (-0.948142 --> -0.955550).  Saving model ...
Epoch: 25 cost time: 0.425830602645874
Epoch: 25, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.473 Vali Acc: 0.956 Test Loss: 0.473 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955551).  Saving model ...
Epoch: 26 cost time: 0.4192352294921875
Epoch: 26, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.434 Vali Acc: 0.956 Test Loss: 0.434 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 27 cost time: 0.4558994770050049
Epoch: 27, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.400 Vali Acc: 0.959 Test Loss: 0.400 Test Acc: 0.959
Validation loss decreased (-0.955551 --> -0.959255).  Saving model ...
Epoch: 28 cost time: 0.4582855701446533
Epoch: 28, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.371 Vali Acc: 0.959 Test Loss: 0.371 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959256).  Saving model ...
Epoch: 29 cost time: 0.5228734016418457
Epoch: 29, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.345 Vali Acc: 0.959 Test Loss: 0.345 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 30 cost time: 0.42346692085266113
Epoch: 30, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.324 Vali Acc: 0.959 Test Loss: 0.324 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 31 cost time: 0.4918861389160156
Epoch: 31, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.305 Vali Acc: 0.959 Test Loss: 0.305 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 32 cost time: 0.43478989601135254
Epoch: 32, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.288 Vali Acc: 0.959 Test Loss: 0.288 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 33 cost time: 0.4087040424346924
Epoch: 33, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.959 Test Loss: 0.273 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 34 cost time: 0.4013822078704834
Epoch: 34, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.261 Vali Acc: 0.959 Test Loss: 0.261 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.4137401580810547
Epoch: 35, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.250 Vali Acc: 0.959 Test Loss: 0.250 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 36 cost time: 0.5323705673217773
Epoch: 36, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 37 cost time: 0.4723634719848633
Epoch: 37, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 38 cost time: 0.4467344284057617
Epoch: 38, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.225 Vali Acc: 0.967 Test Loss: 0.225 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966664).  Saving model ...
Epoch: 39 cost time: 0.445781946182251
Epoch: 39, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.219 Vali Acc: 0.967 Test Loss: 0.219 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 40 cost time: 0.4096648693084717
Epoch: 40, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 41 cost time: 0.4124140739440918
Epoch: 41, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 42 cost time: 0.42258644104003906
Epoch: 42, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.45479321479797363
Epoch: 43, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.4400606155395508
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.5024256706237793
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.4213135242462158
Epoch: 46, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 47 cost time: 0.5322811603546143
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 48 cost time: 0.415285587310791
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 49 cost time: 0.4947347640991211
Epoch: 49, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 50 cost time: 0.4377586841583252
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 397766
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5036747455596924
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.773 Vali Acc: 0.167 Test Loss: 1.773 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.49425816535949707
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.758 Vali Acc: 0.204 Test Loss: 1.758 Test Acc: 0.204
Validation loss decreased (-0.166649 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.4246034622192383
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.744 Vali Acc: 0.222 Test Loss: 1.744 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 0.462033748626709
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.727 Vali Acc: 0.252 Test Loss: 1.727 Test Acc: 0.252
Validation loss decreased (-0.222205 --> -0.251835).  Saving model ...
Epoch: 5 cost time: 0.4247593879699707
Epoch: 5, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.704 Vali Acc: 0.319 Test Loss: 1.704 Test Acc: 0.319
Validation loss decreased (-0.251835 --> -0.318501).  Saving model ...
Epoch: 6 cost time: 0.4201693534851074
Epoch: 6, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.676 Vali Acc: 0.363 Test Loss: 1.676 Test Acc: 0.363
Validation loss decreased (-0.318501 --> -0.362946).  Saving model ...
Epoch: 7 cost time: 0.38001346588134766
Epoch: 7, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.642 Vali Acc: 0.459 Test Loss: 1.642 Test Acc: 0.459
Validation loss decreased (-0.362946 --> -0.459243).  Saving model ...
Epoch: 8 cost time: 0.4120919704437256
Epoch: 8, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.604 Vali Acc: 0.556 Test Loss: 1.604 Test Acc: 0.556
Validation loss decreased (-0.459243 --> -0.555540).  Saving model ...
Epoch: 9 cost time: 0.45732665061950684
Epoch: 9, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.561 Vali Acc: 0.619 Test Loss: 1.561 Test Acc: 0.619
Validation loss decreased (-0.555540 --> -0.618503).  Saving model ...
Epoch: 10 cost time: 0.4463019371032715
Epoch: 10, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.515 Vali Acc: 0.667 Test Loss: 1.515 Test Acc: 0.667
Validation loss decreased (-0.618503 --> -0.666652).  Saving model ...
Epoch: 11 cost time: 0.4171760082244873
Epoch: 11, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.464 Vali Acc: 0.715 Test Loss: 1.464 Test Acc: 0.715
Validation loss decreased (-0.666652 --> -0.714800).  Saving model ...
Epoch: 12 cost time: 0.4810152053833008
Epoch: 12, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.411 Vali Acc: 0.763 Test Loss: 1.411 Test Acc: 0.763
Validation loss decreased (-0.714800 --> -0.762949).  Saving model ...
Epoch: 13 cost time: 0.40157532691955566
Epoch: 13, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.354 Vali Acc: 0.796 Test Loss: 1.354 Test Acc: 0.796
Validation loss decreased (-0.762949 --> -0.796283).  Saving model ...
Epoch: 14 cost time: 0.4138672351837158
Epoch: 14, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.295 Vali Acc: 0.811 Test Loss: 1.295 Test Acc: 0.811
Validation loss decreased (-0.796283 --> -0.811098).  Saving model ...
Epoch: 15 cost time: 0.4043242931365967
Epoch: 15, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.233 Vali Acc: 0.837 Test Loss: 1.233 Test Acc: 0.837
Validation loss decreased (-0.811098 --> -0.837025).  Saving model ...
Epoch: 16 cost time: 0.4181807041168213
Epoch: 16, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.169 Vali Acc: 0.852 Test Loss: 1.169 Test Acc: 0.852
Validation loss decreased (-0.837025 --> -0.851840).  Saving model ...
Epoch: 17 cost time: 0.43220067024230957
Epoch: 17, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.104 Vali Acc: 0.874 Test Loss: 1.104 Test Acc: 0.874
Validation loss decreased (-0.851840 --> -0.874063).  Saving model ...
Epoch: 18 cost time: 0.4110867977142334
Epoch: 18, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.039 Vali Acc: 0.889 Test Loss: 1.039 Test Acc: 0.889
Validation loss decreased (-0.874063 --> -0.888879).  Saving model ...
Epoch: 19 cost time: 0.45972490310668945
Epoch: 19, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.974 Vali Acc: 0.900 Test Loss: 0.974 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899990).  Saving model ...
Epoch: 20 cost time: 0.4127943515777588
Epoch: 20, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.910 Vali Acc: 0.904 Test Loss: 0.910 Test Acc: 0.904
Validation loss decreased (-0.899990 --> -0.903695).  Saving model ...
Epoch: 21 cost time: 0.3881499767303467
Epoch: 21, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.848 Vali Acc: 0.915 Test Loss: 0.848 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914806).  Saving model ...
Epoch: 22 cost time: 0.3908877372741699
Epoch: 22, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.789 Vali Acc: 0.922 Test Loss: 0.789 Test Acc: 0.922
Validation loss decreased (-0.914806 --> -0.922214).  Saving model ...
Epoch: 23 cost time: 0.3720858097076416
Epoch: 23, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.733 Vali Acc: 0.926 Test Loss: 0.733 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925919).  Saving model ...
Epoch: 24 cost time: 0.35005640983581543
Epoch: 24, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.680 Vali Acc: 0.926 Test Loss: 0.680 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925919).  Saving model ...
Epoch: 25 cost time: 0.4479851722717285
Epoch: 25, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.631 Vali Acc: 0.926 Test Loss: 0.631 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925920).  Saving model ...
Epoch: 26 cost time: 0.44612574577331543
Epoch: 26, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.588 Vali Acc: 0.926 Test Loss: 0.588 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 27 cost time: 0.4222135543823242
Epoch: 27, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.548 Vali Acc: 0.926 Test Loss: 0.548 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 28 cost time: 0.4534263610839844
Epoch: 28, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.511 Vali Acc: 0.930 Test Loss: 0.511 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929625).  Saving model ...
Epoch: 29 cost time: 0.38935089111328125
Epoch: 29, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.479 Vali Acc: 0.933 Test Loss: 0.479 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 0.4068186283111572
Epoch: 30, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.450 Vali Acc: 0.933 Test Loss: 0.450 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 31 cost time: 0.39231061935424805
Epoch: 31, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.424 Vali Acc: 0.937 Test Loss: 0.424 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 32 cost time: 0.4246211051940918
Epoch: 32, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.401 Vali Acc: 0.941 Test Loss: 0.401 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 33 cost time: 0.4099149703979492
Epoch: 33, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.380 Vali Acc: 0.941 Test Loss: 0.380 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 34 cost time: 0.46083760261535645
Epoch: 34, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.361 Vali Acc: 0.941 Test Loss: 0.361 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.39821290969848633
Epoch: 35, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.38779354095458984
Epoch: 36, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.329 Vali Acc: 0.944 Test Loss: 0.329 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.40485191345214844
Epoch: 37, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.316 Vali Acc: 0.944 Test Loss: 0.316 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.4020214080810547
Epoch: 38, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.3942124843597412
Epoch: 39, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.4179201126098633
Epoch: 40, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4165623188018799
Epoch: 41, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.3900744915008545
Epoch: 42, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.3791215419769287
Epoch: 43, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.38182592391967773
Epoch: 44, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.41452622413635254
Epoch: 45, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.39400529861450195
Epoch: 46, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.3997337818145752
Epoch: 47, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.38704848289489746
Epoch: 48, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.39324259757995605
Epoch: 49, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.4169197082519531
Epoch: 50, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 391814
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6368894577026367
Epoch: 1, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.835 Vali Acc: 0.156 Test Loss: 1.835 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.4430723190307617
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.822 Vali Acc: 0.215 Test Loss: 1.822 Test Acc: 0.215
Validation loss decreased (-0.155537 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.4239237308502197
Epoch: 3, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.810 Vali Acc: 0.230 Test Loss: 1.810 Test Acc: 0.230
Validation loss decreased (-0.214797 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.43445301055908203
Epoch: 4, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.796 Vali Acc: 0.259 Test Loss: 1.796 Test Acc: 0.259
Validation loss decreased (-0.229612 --> -0.259241).  Saving model ...
Epoch: 5 cost time: 0.4565086364746094
Epoch: 5, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.776 Vali Acc: 0.293 Test Loss: 1.776 Test Acc: 0.293
Validation loss decreased (-0.259241 --> -0.292575).  Saving model ...
Epoch: 6 cost time: 0.5007357597351074
Epoch: 6, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.751 Vali Acc: 0.337 Test Loss: 1.751 Test Acc: 0.337
Validation loss decreased (-0.292575 --> -0.337020).  Saving model ...
Epoch: 7 cost time: 0.4809300899505615
Epoch: 7, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.721 Vali Acc: 0.385 Test Loss: 1.721 Test Acc: 0.385
Validation loss decreased (-0.337020 --> -0.385168).  Saving model ...
Epoch: 8 cost time: 0.49962520599365234
Epoch: 8, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.686 Vali Acc: 0.433 Test Loss: 1.686 Test Acc: 0.433
Validation loss decreased (-0.385168 --> -0.433316).  Saving model ...
Epoch: 9 cost time: 0.4656062126159668
Epoch: 9, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.647 Vali Acc: 0.478 Test Loss: 1.647 Test Acc: 0.478
Validation loss decreased (-0.433316 --> -0.477761).  Saving model ...
Epoch: 10 cost time: 0.42957472801208496
Epoch: 10, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.604 Vali Acc: 0.533 Test Loss: 1.604 Test Acc: 0.533
Validation loss decreased (-0.477761 --> -0.533317).  Saving model ...
Epoch: 11 cost time: 0.4507622718811035
Epoch: 11, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.558 Vali Acc: 0.600 Test Loss: 1.558 Test Acc: 0.600
Validation loss decreased (-0.533317 --> -0.599984).  Saving model ...
Epoch: 12 cost time: 0.5083615779876709
Epoch: 12, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.507 Vali Acc: 0.652 Test Loss: 1.507 Test Acc: 0.652
Validation loss decreased (-0.599984 --> -0.651837).  Saving model ...
Epoch: 13 cost time: 0.5164084434509277
Epoch: 13, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.454 Vali Acc: 0.722 Test Loss: 1.454 Test Acc: 0.722
Validation loss decreased (-0.651837 --> -0.722208).  Saving model ...
Epoch: 14 cost time: 0.6860659122467041
Epoch: 14, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.397 Vali Acc: 0.774 Test Loss: 1.397 Test Acc: 0.774
Validation loss decreased (-0.722208 --> -0.774060).  Saving model ...
Epoch: 15 cost time: 0.4524414539337158
Epoch: 15, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.339 Vali Acc: 0.796 Test Loss: 1.339 Test Acc: 0.796
Validation loss decreased (-0.774060 --> -0.796283).  Saving model ...
Epoch: 16 cost time: 0.5087976455688477
Epoch: 16, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.279 Vali Acc: 0.826 Test Loss: 1.279 Test Acc: 0.826
Validation loss decreased (-0.796283 --> -0.825913).  Saving model ...
Epoch: 17 cost time: 0.4606449604034424
Epoch: 17, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.217 Vali Acc: 0.863 Test Loss: 1.217 Test Acc: 0.863
Validation loss decreased (-0.825913 --> -0.862951).  Saving model ...
Epoch: 18 cost time: 0.46944451332092285
Epoch: 18, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.154 Vali Acc: 0.874 Test Loss: 1.154 Test Acc: 0.874
Validation loss decreased (-0.862951 --> -0.874063).  Saving model ...
Epoch: 19 cost time: 0.508502721786499
Epoch: 19, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.092 Vali Acc: 0.878 Test Loss: 1.092 Test Acc: 0.878
Validation loss decreased (-0.874063 --> -0.877767).  Saving model ...
Epoch: 20 cost time: 0.47233128547668457
Epoch: 20, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.030 Vali Acc: 0.885 Test Loss: 1.030 Test Acc: 0.885
Validation loss decreased (-0.877767 --> -0.885175).  Saving model ...
Epoch: 21 cost time: 0.5469629764556885
Epoch: 21, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.970 Vali Acc: 0.889 Test Loss: 0.970 Test Acc: 0.889
Validation loss decreased (-0.885175 --> -0.888879).  Saving model ...
Epoch: 22 cost time: 0.4450356960296631
Epoch: 22, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.913 Vali Acc: 0.900 Test Loss: 0.913 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899991).  Saving model ...
Epoch: 23 cost time: 0.4653761386871338
Epoch: 23, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.857 Vali Acc: 0.904 Test Loss: 0.857 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903695).  Saving model ...
Epoch: 24 cost time: 0.4357326030731201
Epoch: 24, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.804 Vali Acc: 0.915 Test Loss: 0.804 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914807).  Saving model ...
Epoch: 25 cost time: 0.5351333618164062
Epoch: 25, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.754 Vali Acc: 0.915 Test Loss: 0.754 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914807).  Saving model ...
Epoch: 26 cost time: 0.5137717723846436
Epoch: 26, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.707 Vali Acc: 0.926 Test Loss: 0.707 Test Acc: 0.926
Validation loss decreased (-0.914807 --> -0.925919).  Saving model ...
Epoch: 27 cost time: 0.5626568794250488
Epoch: 27, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.663 Vali Acc: 0.933 Test Loss: 0.663 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 28 cost time: 0.48305320739746094
Epoch: 28, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.622 Vali Acc: 0.933 Test Loss: 0.622 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 29 cost time: 0.4660162925720215
Epoch: 29, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.585 Vali Acc: 0.937 Test Loss: 0.585 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 30 cost time: 0.49263930320739746
Epoch: 30, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.551 Vali Acc: 0.937 Test Loss: 0.551 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 31 cost time: 0.45171332359313965
Epoch: 31, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.519 Vali Acc: 0.941 Test Loss: 0.519 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 32 cost time: 0.43761658668518066
Epoch: 32, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.491 Vali Acc: 0.941 Test Loss: 0.491 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 33 cost time: 0.48818230628967285
Epoch: 33, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.464 Vali Acc: 0.941 Test Loss: 0.464 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 34 cost time: 0.4792640209197998
Epoch: 34, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.440 Vali Acc: 0.941 Test Loss: 0.440 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 35 cost time: 0.45868563652038574
Epoch: 35, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.419 Vali Acc: 0.941 Test Loss: 0.419 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.5574865341186523
Epoch: 36, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.399 Vali Acc: 0.944 Test Loss: 0.399 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944440).  Saving model ...
Epoch: 37 cost time: 0.5281293392181396
Epoch: 37, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.45519423484802246
Epoch: 38, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.366 Vali Acc: 0.944 Test Loss: 0.366 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.5241107940673828
Epoch: 39, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.352 Vali Acc: 0.941 Test Loss: 0.352 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5628190040588379
Epoch: 40, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.339 Vali Acc: 0.944 Test Loss: 0.339 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 0.4833846092224121
Epoch: 41, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 42 cost time: 0.48459792137145996
Epoch: 42, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.316 Vali Acc: 0.944 Test Loss: 0.316 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.47306156158447266
Epoch: 43, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 44 cost time: 0.526165246963501
Epoch: 44, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.478670597076416
Epoch: 45, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.47664523124694824
Epoch: 46, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.282 Vali Acc: 0.948 Test Loss: 0.282 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 47 cost time: 0.4881296157836914
Epoch: 47, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.276 Vali Acc: 0.948 Test Loss: 0.276 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.4590456485748291
Epoch: 48, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.270 Vali Acc: 0.948 Test Loss: 0.270 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 49 cost time: 0.47593212127685547
Epoch: 49, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.4848031997680664
Epoch: 50, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 388998
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5564589500427246
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.740 Vali Acc: 0.204 Test Loss: 1.740 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.35893774032592773
Epoch: 2, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.713 Vali Acc: 0.230 Test Loss: 1.713 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 0.455150842666626
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.685 Vali Acc: 0.267 Test Loss: 1.685 Test Acc: 0.267
Validation loss decreased (-0.229612 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 0.3881547451019287
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.647 Vali Acc: 0.356 Test Loss: 1.647 Test Acc: 0.356
Validation loss decreased (-0.266650 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 0.39086365699768066
Epoch: 5, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.595 Vali Acc: 0.493 Test Loss: 1.595 Test Acc: 0.493
Validation loss decreased (-0.355539 --> -0.492577).  Saving model ...
Epoch: 6 cost time: 0.38912439346313477
Epoch: 6, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.533 Vali Acc: 0.670 Test Loss: 1.533 Test Acc: 0.670
Validation loss decreased (-0.492577 --> -0.670355).  Saving model ...
Epoch: 7 cost time: 0.4564661979675293
Epoch: 7, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.463 Vali Acc: 0.748 Test Loss: 1.463 Test Acc: 0.748
Validation loss decreased (-0.670355 --> -0.748134).  Saving model ...
Epoch: 8 cost time: 0.4142947196960449
Epoch: 8, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.386 Vali Acc: 0.819 Test Loss: 1.386 Test Acc: 0.819
Validation loss decreased (-0.748134 --> -0.818505).  Saving model ...
Epoch: 9 cost time: 0.38091397285461426
Epoch: 9, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.302 Vali Acc: 0.852 Test Loss: 1.302 Test Acc: 0.852
Validation loss decreased (-0.818505 --> -0.851839).  Saving model ...
Epoch: 10 cost time: 0.4241468906402588
Epoch: 10, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.214 Vali Acc: 0.856 Test Loss: 1.214 Test Acc: 0.856
Validation loss decreased (-0.851839 --> -0.855543).  Saving model ...
Epoch: 11 cost time: 0.4045538902282715
Epoch: 11, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.123 Vali Acc: 0.870 Test Loss: 1.123 Test Acc: 0.870
Validation loss decreased (-0.855543 --> -0.870359).  Saving model ...
Epoch: 12 cost time: 0.4026317596435547
Epoch: 12, Steps: 2 | Train Loss: 0.855 Vali Loss: 1.031 Vali Acc: 0.889 Test Loss: 1.031 Test Acc: 0.889
Validation loss decreased (-0.870359 --> -0.888879).  Saving model ...
Epoch: 13 cost time: 0.4342641830444336
Epoch: 13, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.939 Vali Acc: 0.893 Test Loss: 0.939 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892583).  Saving model ...
Epoch: 14 cost time: 0.3834962844848633
Epoch: 14, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.850 Vali Acc: 0.911 Test Loss: 0.850 Test Acc: 0.911
Validation loss decreased (-0.892583 --> -0.911103).  Saving model ...
Epoch: 15 cost time: 0.4287135601043701
Epoch: 15, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.763 Vali Acc: 0.922 Test Loss: 0.763 Test Acc: 0.922
Validation loss decreased (-0.911103 --> -0.922215).  Saving model ...
Epoch: 16 cost time: 0.43166089057922363
Epoch: 16, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.681 Vali Acc: 0.926 Test Loss: 0.681 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 17 cost time: 0.4529905319213867
Epoch: 17, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.605 Vali Acc: 0.930 Test Loss: 0.605 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929624).  Saving model ...
Epoch: 18 cost time: 0.4575679302215576
Epoch: 18, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.536 Vali Acc: 0.941 Test Loss: 0.536 Test Acc: 0.941
Validation loss decreased (-0.929624 --> -0.940735).  Saving model ...
Epoch: 19 cost time: 0.4436757564544678
Epoch: 19, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.475 Vali Acc: 0.948 Test Loss: 0.475 Test Acc: 0.948
Validation loss decreased (-0.940735 --> -0.948143).  Saving model ...
Epoch: 20 cost time: 0.40013980865478516
Epoch: 20, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.424 Vali Acc: 0.952 Test Loss: 0.424 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951848).  Saving model ...
Epoch: 21 cost time: 0.45804524421691895
Epoch: 21, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.379 Vali Acc: 0.948 Test Loss: 0.379 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4048166275024414
Epoch: 22, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.343 Vali Acc: 0.948 Test Loss: 0.343 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.466991662979126
Epoch: 23, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.313 Vali Acc: 0.948 Test Loss: 0.313 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.42026853561401367
Epoch: 24, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.948 Test Loss: 0.289 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4515674114227295
Epoch: 25, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.271 Vali Acc: 0.948 Test Loss: 0.271 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.3894767761230469
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.256 Vali Acc: 0.952 Test Loss: 0.256 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 27 cost time: 0.5146651268005371
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4380314350128174
Epoch: 28, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.36809229850769043
Epoch: 29, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4615437984466553
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.380615234375
Epoch: 31, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.37421441078186035
Epoch: 32, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4127681255340576
Epoch: 33, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4370594024658203
Epoch: 34, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.39968252182006836
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.385150671005249
Epoch: 36, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 152550
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7460386753082275
Epoch: 1, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.750 Vali Acc: 0.304 Test Loss: 1.750 Test Acc: 0.304
Validation loss decreased (inf --> -0.303686).  Saving model ...
Epoch: 2 cost time: 0.4499225616455078
Epoch: 2, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.725 Vali Acc: 0.393 Test Loss: 1.725 Test Acc: 0.393
Validation loss decreased (-0.303686 --> -0.392575).  Saving model ...
Epoch: 3 cost time: 0.38208723068237305
Epoch: 3, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.703 Vali Acc: 0.448 Test Loss: 1.703 Test Acc: 0.448
Validation loss decreased (-0.392575 --> -0.448131).  Saving model ...
Epoch: 4 cost time: 0.3477663993835449
Epoch: 4, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.676 Vali Acc: 0.507 Test Loss: 1.676 Test Acc: 0.507
Validation loss decreased (-0.448131 --> -0.507391).  Saving model ...
Epoch: 5 cost time: 0.38488197326660156
Epoch: 5, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.642 Vali Acc: 0.567 Test Loss: 1.642 Test Acc: 0.567
Validation loss decreased (-0.507391 --> -0.566650).  Saving model ...
Epoch: 6 cost time: 0.3956172466278076
Epoch: 6, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.600 Vali Acc: 0.622 Test Loss: 1.600 Test Acc: 0.622
Validation loss decreased (-0.566650 --> -0.622206).  Saving model ...
Epoch: 7 cost time: 0.4439711570739746
Epoch: 7, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.552 Vali Acc: 0.659 Test Loss: 1.552 Test Acc: 0.659
Validation loss decreased (-0.622206 --> -0.659244).  Saving model ...
Epoch: 8 cost time: 0.3796525001525879
Epoch: 8, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.497 Vali Acc: 0.719 Test Loss: 1.497 Test Acc: 0.719
Validation loss decreased (-0.659244 --> -0.718504).  Saving model ...
Epoch: 9 cost time: 0.39501285552978516
Epoch: 9, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.438 Vali Acc: 0.756 Test Loss: 1.438 Test Acc: 0.756
Validation loss decreased (-0.718504 --> -0.755541).  Saving model ...
Epoch: 10 cost time: 0.40627026557922363
Epoch: 10, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.373 Vali Acc: 0.778 Test Loss: 1.373 Test Acc: 0.778
Validation loss decreased (-0.755541 --> -0.777764).  Saving model ...
Epoch: 11 cost time: 0.3901631832122803
Epoch: 11, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.304 Vali Acc: 0.815 Test Loss: 1.304 Test Acc: 0.815
Validation loss decreased (-0.777764 --> -0.814802).  Saving model ...
Epoch: 12 cost time: 0.39435625076293945
Epoch: 12, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.231 Vali Acc: 0.833 Test Loss: 1.231 Test Acc: 0.833
Validation loss decreased (-0.814802 --> -0.833321).  Saving model ...
Epoch: 13 cost time: 0.4012603759765625
Epoch: 13, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.157 Vali Acc: 0.863 Test Loss: 1.157 Test Acc: 0.863
Validation loss decreased (-0.833321 --> -0.862951).  Saving model ...
Epoch: 14 cost time: 0.5013704299926758
Epoch: 14, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.081 Vali Acc: 0.893 Test Loss: 1.081 Test Acc: 0.893
Validation loss decreased (-0.862951 --> -0.892582).  Saving model ...
Epoch: 15 cost time: 0.4200468063354492
Epoch: 15, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.004 Vali Acc: 0.904 Test Loss: 1.004 Test Acc: 0.904
Validation loss decreased (-0.892582 --> -0.903694).  Saving model ...
Epoch: 16 cost time: 0.4028315544128418
Epoch: 16, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.928 Vali Acc: 0.907 Test Loss: 0.928 Test Acc: 0.907
Validation loss decreased (-0.903694 --> -0.907398).  Saving model ...
Epoch: 17 cost time: 0.41205787658691406
Epoch: 17, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.856 Vali Acc: 0.907 Test Loss: 0.856 Test Acc: 0.907
Validation loss decreased (-0.907398 --> -0.907399).  Saving model ...
Epoch: 18 cost time: 0.37130308151245117
Epoch: 18, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.787 Vali Acc: 0.915 Test Loss: 0.787 Test Acc: 0.915
Validation loss decreased (-0.907399 --> -0.914807).  Saving model ...
Epoch: 19 cost time: 0.3721437454223633
Epoch: 19, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.722 Vali Acc: 0.915 Test Loss: 0.722 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 20 cost time: 0.37370896339416504
Epoch: 20, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.661 Vali Acc: 0.922 Test Loss: 0.661 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 21 cost time: 0.39860081672668457
Epoch: 21, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.606 Vali Acc: 0.926 Test Loss: 0.606 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 22 cost time: 0.40039658546447754
Epoch: 22, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.557 Vali Acc: 0.926 Test Loss: 0.557 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 23 cost time: 0.3983159065246582
Epoch: 23, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.512 Vali Acc: 0.930 Test Loss: 0.512 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929625).  Saving model ...
Epoch: 24 cost time: 0.41991138458251953
Epoch: 24, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.473 Vali Acc: 0.930 Test Loss: 0.473 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 25 cost time: 0.39273738861083984
Epoch: 25, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.437 Vali Acc: 0.937 Test Loss: 0.437 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.3890359401702881
Epoch: 26, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.406 Vali Acc: 0.937 Test Loss: 0.406 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 27 cost time: 0.39953017234802246
Epoch: 27, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.379 Vali Acc: 0.937 Test Loss: 0.379 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 28 cost time: 0.3772010803222656
Epoch: 28, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.356 Vali Acc: 0.941 Test Loss: 0.356 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 29 cost time: 0.42226338386535645
Epoch: 29, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.334 Vali Acc: 0.941 Test Loss: 0.334 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 30 cost time: 0.40189576148986816
Epoch: 30, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.315 Vali Acc: 0.941 Test Loss: 0.315 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.3782515525817871
Epoch: 31, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.4311187267303467
Epoch: 32, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.4011414051055908
Epoch: 33, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 34 cost time: 0.37981081008911133
Epoch: 34, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.3907949924468994
Epoch: 35, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.4356095790863037
Epoch: 36, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.41267919540405273
Epoch: 37, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.4307670593261719
Epoch: 38, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.952 Test Loss: 0.234 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.3927011489868164
Epoch: 39, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.4161515235900879
Epoch: 40, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.224 Vali Acc: 0.952 Test Loss: 0.224 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.36145782470703125
Epoch: 41, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.3599843978881836
Epoch: 42, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.40808844566345215
Epoch: 43, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.3501732349395752
Epoch: 44, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.40537452697753906
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.36765551567077637
Epoch: 46, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.37204670906066895
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.44155263900756836
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.4124901294708252
Epoch: 49, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.40912938117980957
Epoch: 50, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 126502
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6990807056427002
Epoch: 1, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.698 Vali Acc: 0.344 Test Loss: 1.698 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 0.38661718368530273
Epoch: 2, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.680 Vali Acc: 0.381 Test Loss: 1.680 Test Acc: 0.381
Validation loss decreased (-0.344427 --> -0.381465).  Saving model ...
Epoch: 3 cost time: 0.3816702365875244
Epoch: 3, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.663 Vali Acc: 0.437 Test Loss: 1.663 Test Acc: 0.437
Validation loss decreased (-0.381465 --> -0.437020).  Saving model ...
Epoch: 4 cost time: 0.3876357078552246
Epoch: 4, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.646 Vali Acc: 0.474 Test Loss: 1.646 Test Acc: 0.474
Validation loss decreased (-0.437020 --> -0.474058).  Saving model ...
Epoch: 5 cost time: 0.44744253158569336
Epoch: 5, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.623 Vali Acc: 0.530 Test Loss: 1.623 Test Acc: 0.530
Validation loss decreased (-0.474058 --> -0.529613).  Saving model ...
Epoch: 6 cost time: 0.4743032455444336
Epoch: 6, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.595 Vali Acc: 0.570 Test Loss: 1.595 Test Acc: 0.570
Validation loss decreased (-0.529613 --> -0.570354).  Saving model ...
Epoch: 7 cost time: 0.4048805236816406
Epoch: 7, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.562 Vali Acc: 0.641 Test Loss: 1.562 Test Acc: 0.641
Validation loss decreased (-0.570354 --> -0.640725).  Saving model ...
Epoch: 8 cost time: 0.39008212089538574
Epoch: 8, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.524 Vali Acc: 0.693 Test Loss: 1.524 Test Acc: 0.693
Validation loss decreased (-0.640725 --> -0.692577).  Saving model ...
Epoch: 9 cost time: 0.361011266708374
Epoch: 9, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.483 Vali Acc: 0.741 Test Loss: 1.483 Test Acc: 0.741
Validation loss decreased (-0.692577 --> -0.740726).  Saving model ...
Epoch: 10 cost time: 0.4158477783203125
Epoch: 10, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.437 Vali Acc: 0.774 Test Loss: 1.437 Test Acc: 0.774
Validation loss decreased (-0.740726 --> -0.774060).  Saving model ...
Epoch: 11 cost time: 0.46169328689575195
Epoch: 11, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.388 Vali Acc: 0.807 Test Loss: 1.388 Test Acc: 0.807
Validation loss decreased (-0.774060 --> -0.807394).  Saving model ...
Epoch: 12 cost time: 0.4309244155883789
Epoch: 12, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.335 Vali Acc: 0.841 Test Loss: 1.335 Test Acc: 0.841
Validation loss decreased (-0.807394 --> -0.840727).  Saving model ...
Epoch: 13 cost time: 0.44304466247558594
Epoch: 13, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.280 Vali Acc: 0.848 Test Loss: 1.280 Test Acc: 0.848
Validation loss decreased (-0.840727 --> -0.848135).  Saving model ...
Epoch: 14 cost time: 0.4530329704284668
Epoch: 14, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.223 Vali Acc: 0.870 Test Loss: 1.223 Test Acc: 0.870
Validation loss decreased (-0.848135 --> -0.870358).  Saving model ...
Epoch: 15 cost time: 0.40074944496154785
Epoch: 15, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.165 Vali Acc: 0.878 Test Loss: 1.165 Test Acc: 0.878
Validation loss decreased (-0.870358 --> -0.877766).  Saving model ...
Epoch: 16 cost time: 0.4461507797241211
Epoch: 16, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.104 Vali Acc: 0.893 Test Loss: 1.104 Test Acc: 0.893
Validation loss decreased (-0.877766 --> -0.892582).  Saving model ...
Epoch: 17 cost time: 0.3826591968536377
Epoch: 17, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.043 Vali Acc: 0.900 Test Loss: 1.043 Test Acc: 0.900
Validation loss decreased (-0.892582 --> -0.899990).  Saving model ...
Epoch: 18 cost time: 0.3985152244567871
Epoch: 18, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.981 Vali Acc: 0.919 Test Loss: 0.981 Test Acc: 0.919
Validation loss decreased (-0.899990 --> -0.918509).  Saving model ...
Epoch: 19 cost time: 0.4198734760284424
Epoch: 19, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.920 Vali Acc: 0.919 Test Loss: 0.920 Test Acc: 0.919
Validation loss decreased (-0.918509 --> -0.918509).  Saving model ...
Epoch: 20 cost time: 0.41733431816101074
Epoch: 20, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.860 Vali Acc: 0.937 Test Loss: 0.860 Test Acc: 0.937
Validation loss decreased (-0.918509 --> -0.937028).  Saving model ...
Epoch: 21 cost time: 0.40146780014038086
Epoch: 21, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.802 Vali Acc: 0.941 Test Loss: 0.802 Test Acc: 0.941
Validation loss decreased (-0.937028 --> -0.940733).  Saving model ...
Epoch: 22 cost time: 0.40512776374816895
Epoch: 22, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.747 Vali Acc: 0.941 Test Loss: 0.747 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940733).  Saving model ...
Epoch: 23 cost time: 0.41440629959106445
Epoch: 23, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.694 Vali Acc: 0.941 Test Loss: 0.694 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940734).  Saving model ...
Epoch: 24 cost time: 0.422243595123291
Epoch: 24, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.645 Vali Acc: 0.948 Test Loss: 0.645 Test Acc: 0.948
Validation loss decreased (-0.940734 --> -0.948142).  Saving model ...
Epoch: 25 cost time: 0.403972864151001
Epoch: 25, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.599 Vali Acc: 0.952 Test Loss: 0.599 Test Acc: 0.952
Validation loss decreased (-0.948142 --> -0.951846).  Saving model ...
Epoch: 26 cost time: 0.41933298110961914
Epoch: 26, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.557 Vali Acc: 0.948 Test Loss: 0.557 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3742499351501465
Epoch: 27, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.520 Vali Acc: 0.948 Test Loss: 0.520 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.39702296257019043
Epoch: 28, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.485 Vali Acc: 0.948 Test Loss: 0.485 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.37232351303100586
Epoch: 29, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.454 Vali Acc: 0.948 Test Loss: 0.454 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.37416601181030273
Epoch: 30, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.426 Vali Acc: 0.944 Test Loss: 0.426 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.3764779567718506
Epoch: 31, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.401 Vali Acc: 0.948 Test Loss: 0.401 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.38561105728149414
Epoch: 32, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.379 Vali Acc: 0.948 Test Loss: 0.379 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.3963899612426758
Epoch: 33, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.359 Vali Acc: 0.948 Test Loss: 0.359 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.3710479736328125
Epoch: 34, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.341 Vali Acc: 0.948 Test Loss: 0.341 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5291578769683838
Epoch: 35, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.325 Vali Acc: 0.948 Test Loss: 0.325 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 118854
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.469482183456421
Epoch: 1, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.775 Vali Acc: 0.193 Test Loss: 1.775 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.4094693660736084
Epoch: 2, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.761 Vali Acc: 0.226 Test Loss: 1.761 Test Acc: 0.226
Validation loss decreased (-0.192575 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.5102107524871826
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.749 Vali Acc: 0.270 Test Loss: 1.749 Test Acc: 0.270
Validation loss decreased (-0.225908 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 0.4000229835510254
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.737 Vali Acc: 0.289 Test Loss: 1.737 Test Acc: 0.289
Validation loss decreased (-0.270353 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.39727306365966797
Epoch: 5, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.721 Vali Acc: 0.326 Test Loss: 1.721 Test Acc: 0.326
Validation loss decreased (-0.288872 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 0.4337880611419678
Epoch: 6, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.701 Vali Acc: 0.389 Test Loss: 1.701 Test Acc: 0.389
Validation loss decreased (-0.325909 --> -0.388872).  Saving model ...
Epoch: 7 cost time: 0.3795790672302246
Epoch: 7, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.678 Vali Acc: 0.444 Test Loss: 1.678 Test Acc: 0.444
Validation loss decreased (-0.388872 --> -0.444428).  Saving model ...
Epoch: 8 cost time: 0.3787047863006592
Epoch: 8, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.650 Vali Acc: 0.526 Test Loss: 1.650 Test Acc: 0.526
Validation loss decreased (-0.444428 --> -0.525909).  Saving model ...
Epoch: 9 cost time: 0.42024755477905273
Epoch: 9, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.620 Vali Acc: 0.589 Test Loss: 1.620 Test Acc: 0.589
Validation loss decreased (-0.525909 --> -0.588873).  Saving model ...
Epoch: 10 cost time: 0.4325985908508301
Epoch: 10, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.585 Vali Acc: 0.637 Test Loss: 1.585 Test Acc: 0.637
Validation loss decreased (-0.588873 --> -0.637021).  Saving model ...
Epoch: 11 cost time: 0.43047118186950684
Epoch: 11, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.548 Vali Acc: 0.663 Test Loss: 1.548 Test Acc: 0.663
Validation loss decreased (-0.637021 --> -0.662947).  Saving model ...
Epoch: 12 cost time: 0.42789196968078613
Epoch: 12, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.508 Vali Acc: 0.681 Test Loss: 1.508 Test Acc: 0.681
Validation loss decreased (-0.662947 --> -0.681466).  Saving model ...
Epoch: 13 cost time: 0.41057586669921875
Epoch: 13, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.464 Vali Acc: 0.704 Test Loss: 1.464 Test Acc: 0.704
Validation loss decreased (-0.681466 --> -0.703689).  Saving model ...
Epoch: 14 cost time: 0.41132521629333496
Epoch: 14, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.418 Vali Acc: 0.730 Test Loss: 1.418 Test Acc: 0.730
Validation loss decreased (-0.703689 --> -0.729615).  Saving model ...
Epoch: 15 cost time: 0.48731184005737305
Epoch: 15, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.370 Vali Acc: 0.752 Test Loss: 1.370 Test Acc: 0.752
Validation loss decreased (-0.729615 --> -0.751838).  Saving model ...
Epoch: 16 cost time: 0.5222344398498535
Epoch: 16, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.320 Vali Acc: 0.781 Test Loss: 1.320 Test Acc: 0.781
Validation loss decreased (-0.751838 --> -0.781468).  Saving model ...
Epoch: 17 cost time: 0.5070867538452148
Epoch: 17, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.267 Vali Acc: 0.796 Test Loss: 1.267 Test Acc: 0.796
Validation loss decreased (-0.781468 --> -0.796284).  Saving model ...
Epoch: 18 cost time: 0.5154063701629639
Epoch: 18, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.213 Vali Acc: 0.822 Test Loss: 1.213 Test Acc: 0.822
Validation loss decreased (-0.796284 --> -0.822210).  Saving model ...
Epoch: 19 cost time: 0.48737597465515137
Epoch: 19, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.158 Vali Acc: 0.841 Test Loss: 1.158 Test Acc: 0.841
Validation loss decreased (-0.822210 --> -0.840729).  Saving model ...
Epoch: 20 cost time: 0.4125709533691406
Epoch: 20, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.102 Vali Acc: 0.852 Test Loss: 1.102 Test Acc: 0.852
Validation loss decreased (-0.840729 --> -0.851841).  Saving model ...
Epoch: 21 cost time: 0.3970680236816406
Epoch: 21, Steps: 2 | Train Loss: 0.889 Vali Loss: 1.046 Vali Acc: 0.863 Test Loss: 1.046 Test Acc: 0.863
Validation loss decreased (-0.851841 --> -0.862953).  Saving model ...
Epoch: 22 cost time: 0.3954343795776367
Epoch: 22, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.990 Vali Acc: 0.881 Test Loss: 0.990 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881472).  Saving model ...
Epoch: 23 cost time: 0.392549991607666
Epoch: 23, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.936 Vali Acc: 0.885 Test Loss: 0.936 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 24 cost time: 0.3916594982147217
Epoch: 24, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.882 Vali Acc: 0.889 Test Loss: 0.882 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 25 cost time: 0.38448119163513184
Epoch: 25, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.831 Vali Acc: 0.900 Test Loss: 0.831 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 26 cost time: 0.4840536117553711
Epoch: 26, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.783 Vali Acc: 0.907 Test Loss: 0.783 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 27 cost time: 0.3974628448486328
Epoch: 27, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.737 Vali Acc: 0.907 Test Loss: 0.737 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 28 cost time: 0.45632147789001465
Epoch: 28, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.694 Vali Acc: 0.911 Test Loss: 0.694 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911104).  Saving model ...
Epoch: 29 cost time: 0.3815433979034424
Epoch: 29, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.653 Vali Acc: 0.915 Test Loss: 0.653 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 30 cost time: 0.39400243759155273
Epoch: 30, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.616 Vali Acc: 0.919 Test Loss: 0.616 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 31 cost time: 0.529210090637207
Epoch: 31, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.581 Vali Acc: 0.919 Test Loss: 0.581 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 32 cost time: 0.4564032554626465
Epoch: 32, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.550 Vali Acc: 0.922 Test Loss: 0.550 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 33 cost time: 0.4032881259918213
Epoch: 33, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 34 cost time: 0.3966407775878906
Epoch: 34, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.495 Vali Acc: 0.922 Test Loss: 0.495 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 35 cost time: 0.43614816665649414
Epoch: 35, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.471 Vali Acc: 0.919 Test Loss: 0.471 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.40343284606933594
Epoch: 36, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 37 cost time: 0.3752737045288086
Epoch: 37, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 38 cost time: 0.38498878479003906
Epoch: 38, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 39 cost time: 0.42348361015319824
Epoch: 39, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 40 cost time: 0.404491662979126
Epoch: 40, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.379 Vali Acc: 0.926 Test Loss: 0.379 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 41 cost time: 0.5142121315002441
Epoch: 41, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.366 Vali Acc: 0.926 Test Loss: 0.366 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 42 cost time: 0.3612351417541504
Epoch: 42, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.355 Vali Acc: 0.926 Test Loss: 0.355 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 43 cost time: 0.37265586853027344
Epoch: 43, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.344 Vali Acc: 0.926 Test Loss: 0.344 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 44 cost time: 0.3890950679779053
Epoch: 44, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.334 Vali Acc: 0.926 Test Loss: 0.334 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.39133572578430176
Epoch: 45, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.325 Vali Acc: 0.926 Test Loss: 0.325 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 46 cost time: 0.39688801765441895
Epoch: 46, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.317 Vali Acc: 0.926 Test Loss: 0.317 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 47 cost time: 0.34552955627441406
Epoch: 47, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 48 cost time: 0.41379880905151367
Epoch: 48, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 49 cost time: 0.39250707626342773
Epoch: 49, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 50 cost time: 0.4026825428009033
Epoch: 50, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 114310
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8294057846069336
Epoch: 1, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.741 Vali Acc: 0.207 Test Loss: 1.741 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.4028806686401367
Epoch: 2, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.728 Vali Acc: 0.226 Test Loss: 1.728 Test Acc: 0.226
Validation loss decreased (-0.207390 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.5197141170501709
Epoch: 3, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.716 Vali Acc: 0.259 Test Loss: 1.716 Test Acc: 0.259
Validation loss decreased (-0.225909 --> -0.259242).  Saving model ...
Epoch: 4 cost time: 0.39783787727355957
Epoch: 4, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.704 Vali Acc: 0.352 Test Loss: 1.704 Test Acc: 0.352
Validation loss decreased (-0.259242 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 0.36620140075683594
Epoch: 5, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.689 Vali Acc: 0.411 Test Loss: 1.689 Test Acc: 0.411
Validation loss decreased (-0.351835 --> -0.411094).  Saving model ...
Epoch: 6 cost time: 0.36193013191223145
Epoch: 6, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.670 Vali Acc: 0.470 Test Loss: 1.670 Test Acc: 0.470
Validation loss decreased (-0.411094 --> -0.470354).  Saving model ...
Epoch: 7 cost time: 0.385059118270874
Epoch: 7, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.649 Vali Acc: 0.519 Test Loss: 1.649 Test Acc: 0.519
Validation loss decreased (-0.470354 --> -0.518502).  Saving model ...
Epoch: 8 cost time: 0.3921210765838623
Epoch: 8, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.624 Vali Acc: 0.563 Test Loss: 1.624 Test Acc: 0.563
Validation loss decreased (-0.518502 --> -0.562947).  Saving model ...
Epoch: 9 cost time: 0.39291810989379883
Epoch: 9, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.597 Vali Acc: 0.622 Test Loss: 1.597 Test Acc: 0.622
Validation loss decreased (-0.562947 --> -0.622206).  Saving model ...
Epoch: 10 cost time: 0.39044189453125
Epoch: 10, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.567 Vali Acc: 0.670 Test Loss: 1.567 Test Acc: 0.670
Validation loss decreased (-0.622206 --> -0.670355).  Saving model ...
Epoch: 11 cost time: 0.4047212600708008
Epoch: 11, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.535 Vali Acc: 0.707 Test Loss: 1.535 Test Acc: 0.707
Validation loss decreased (-0.670355 --> -0.707392).  Saving model ...
Epoch: 12 cost time: 0.49321842193603516
Epoch: 12, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.501 Vali Acc: 0.752 Test Loss: 1.501 Test Acc: 0.752
Validation loss decreased (-0.707392 --> -0.751837).  Saving model ...
Epoch: 13 cost time: 0.39905285835266113
Epoch: 13, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.465 Vali Acc: 0.785 Test Loss: 1.465 Test Acc: 0.785
Validation loss decreased (-0.751837 --> -0.785171).  Saving model ...
Epoch: 14 cost time: 0.5025110244750977
Epoch: 14, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.427 Vali Acc: 0.815 Test Loss: 1.427 Test Acc: 0.815
Validation loss decreased (-0.785171 --> -0.814801).  Saving model ...
Epoch: 15 cost time: 0.4126718044281006
Epoch: 15, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.387 Vali Acc: 0.837 Test Loss: 1.387 Test Acc: 0.837
Validation loss decreased (-0.814801 --> -0.837023).  Saving model ...
Epoch: 16 cost time: 0.422199010848999
Epoch: 16, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.347 Vali Acc: 0.859 Test Loss: 1.347 Test Acc: 0.859
Validation loss decreased (-0.837023 --> -0.859246).  Saving model ...
Epoch: 17 cost time: 0.472456693649292
Epoch: 17, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.306 Vali Acc: 0.878 Test Loss: 1.306 Test Acc: 0.878
Validation loss decreased (-0.859246 --> -0.877765).  Saving model ...
Epoch: 18 cost time: 0.49425649642944336
Epoch: 18, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.263 Vali Acc: 0.881 Test Loss: 1.263 Test Acc: 0.881
Validation loss decreased (-0.877765 --> -0.881469).  Saving model ...
Epoch: 19 cost time: 0.441819429397583
Epoch: 19, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.219 Vali Acc: 0.889 Test Loss: 1.219 Test Acc: 0.889
Validation loss decreased (-0.881469 --> -0.888877).  Saving model ...
Epoch: 20 cost time: 0.42611217498779297
Epoch: 20, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.174 Vali Acc: 0.900 Test Loss: 1.174 Test Acc: 0.900
Validation loss decreased (-0.888877 --> -0.899988).  Saving model ...
Epoch: 21 cost time: 0.4517197608947754
Epoch: 21, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.129 Vali Acc: 0.900 Test Loss: 1.129 Test Acc: 0.900
Validation loss decreased (-0.899988 --> -0.899989).  Saving model ...
Epoch: 22 cost time: 0.45162296295166016
Epoch: 22, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.083 Vali Acc: 0.904 Test Loss: 1.083 Test Acc: 0.904
Validation loss decreased (-0.899989 --> -0.903693).  Saving model ...
Epoch: 23 cost time: 0.46602749824523926
Epoch: 23, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.037 Vali Acc: 0.907 Test Loss: 1.037 Test Acc: 0.907
Validation loss decreased (-0.903693 --> -0.907397).  Saving model ...
Epoch: 24 cost time: 0.40767788887023926
Epoch: 24, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.992 Vali Acc: 0.919 Test Loss: 0.992 Test Acc: 0.919
Validation loss decreased (-0.907397 --> -0.918509).  Saving model ...
Epoch: 25 cost time: 0.44940614700317383
Epoch: 25, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.947 Vali Acc: 0.926 Test Loss: 0.947 Test Acc: 0.926
Validation loss decreased (-0.918509 --> -0.925916).  Saving model ...
Epoch: 26 cost time: 0.452317476272583
Epoch: 26, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.903 Vali Acc: 0.930 Test Loss: 0.903 Test Acc: 0.930
Validation loss decreased (-0.925916 --> -0.929621).  Saving model ...
Epoch: 27 cost time: 0.4875199794769287
Epoch: 27, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.859 Vali Acc: 0.937 Test Loss: 0.859 Test Acc: 0.937
Validation loss decreased (-0.929621 --> -0.937028).  Saving model ...
Epoch: 28 cost time: 0.5232737064361572
Epoch: 28, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.817 Vali Acc: 0.937 Test Loss: 0.817 Test Acc: 0.937
Validation loss decreased (-0.937028 --> -0.937029).  Saving model ...
Epoch: 29 cost time: 0.5051064491271973
Epoch: 29, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.776 Vali Acc: 0.941 Test Loss: 0.776 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940733).  Saving model ...
Epoch: 30 cost time: 0.3985278606414795
Epoch: 30, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.737 Vali Acc: 0.941 Test Loss: 0.737 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940733).  Saving model ...
Epoch: 31 cost time: 0.5306243896484375
Epoch: 31, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.700 Vali Acc: 0.941 Test Loss: 0.700 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940734).  Saving model ...
Epoch: 32 cost time: 0.45966029167175293
Epoch: 32, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.664 Vali Acc: 0.941 Test Loss: 0.664 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940734).  Saving model ...
Epoch: 33 cost time: 0.48151063919067383
Epoch: 33, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.629 Vali Acc: 0.944 Test Loss: 0.629 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 34 cost time: 0.46472597122192383
Epoch: 34, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.597 Vali Acc: 0.956 Test Loss: 0.597 Test Acc: 0.956
Validation loss decreased (-0.944438 --> -0.955550).  Saving model ...
Epoch: 35 cost time: 0.47522974014282227
Epoch: 35, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.566 Vali Acc: 0.959 Test Loss: 0.566 Test Acc: 0.959
Validation loss decreased (-0.955550 --> -0.959254).  Saving model ...
Epoch: 36 cost time: 0.46105146408081055
Epoch: 36, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.538 Vali Acc: 0.959 Test Loss: 0.538 Test Acc: 0.959
Validation loss decreased (-0.959254 --> -0.959254).  Saving model ...
Epoch: 37 cost time: 0.4769165515899658
Epoch: 37, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.511 Vali Acc: 0.963 Test Loss: 0.511 Test Acc: 0.963
Validation loss decreased (-0.959254 --> -0.962958).  Saving model ...
Epoch: 38 cost time: 0.5302891731262207
Epoch: 38, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.486 Vali Acc: 0.967 Test Loss: 0.486 Test Acc: 0.967
Validation loss decreased (-0.962958 --> -0.966662).  Saving model ...
Epoch: 39 cost time: 0.41225218772888184
Epoch: 39, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.463 Vali Acc: 0.967 Test Loss: 0.463 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966662).  Saving model ...
Epoch: 40 cost time: 0.4010756015777588
Epoch: 40, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.441 Vali Acc: 0.967 Test Loss: 0.441 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966662).  Saving model ...
Epoch: 41 cost time: 0.3933727741241455
Epoch: 41, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.421 Vali Acc: 0.967 Test Loss: 0.421 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966662).  Saving model ...
Epoch: 42 cost time: 0.4435586929321289
Epoch: 42, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.403 Vali Acc: 0.967 Test Loss: 0.403 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966663).  Saving model ...
Epoch: 43 cost time: 0.37085819244384766
Epoch: 43, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.386 Vali Acc: 0.963 Test Loss: 0.386 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5227890014648438
Epoch: 44, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.370 Vali Acc: 0.963 Test Loss: 0.370 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.45296502113342285
Epoch: 45, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.356 Vali Acc: 0.963 Test Loss: 0.356 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.49027419090270996
Epoch: 46, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.343 Vali Acc: 0.963 Test Loss: 0.343 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5036754608154297
Epoch: 47, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.331 Vali Acc: 0.963 Test Loss: 0.331 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5060892105102539
Epoch: 48, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.320 Vali Acc: 0.963 Test Loss: 0.320 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5219569206237793
Epoch: 49, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.310 Vali Acc: 0.963 Test Loss: 0.310 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.48361754417419434
Epoch: 50, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.301 Vali Acc: 0.963 Test Loss: 0.301 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 112870
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8063304424285889
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.780 Vali Acc: 0.193 Test Loss: 1.780 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.41240525245666504
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.773 Vali Acc: 0.193 Test Loss: 1.773 Test Acc: 0.193
Validation loss decreased (-0.192575 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.368267297744751
Epoch: 3, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.767 Vali Acc: 0.200 Test Loss: 1.767 Test Acc: 0.200
Validation loss decreased (-0.192575 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.36223387718200684
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.761 Vali Acc: 0.196 Test Loss: 1.761 Test Acc: 0.196
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3715362548828125
Epoch: 5, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.753 Vali Acc: 0.219 Test Loss: 1.753 Test Acc: 0.219
Validation loss decreased (-0.199982 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.3977944850921631
Epoch: 6, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.742 Vali Acc: 0.215 Test Loss: 1.742 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.37574005126953125
Epoch: 7, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.728 Vali Acc: 0.233 Test Loss: 1.728 Test Acc: 0.233
Validation loss decreased (-0.218501 --> -0.233316).  Saving model ...
Epoch: 8 cost time: 0.48614072799682617
Epoch: 8, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.713 Vali Acc: 0.270 Test Loss: 1.713 Test Acc: 0.270
Validation loss decreased (-0.233316 --> -0.270353).  Saving model ...
Epoch: 9 cost time: 0.4011881351470947
Epoch: 9, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.695 Vali Acc: 0.322 Test Loss: 1.695 Test Acc: 0.322
Validation loss decreased (-0.270353 --> -0.322205).  Saving model ...
Epoch: 10 cost time: 0.4974637031555176
Epoch: 10, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.675 Vali Acc: 0.367 Test Loss: 1.675 Test Acc: 0.367
Validation loss decreased (-0.322205 --> -0.366650).  Saving model ...
Epoch: 11 cost time: 0.4873044490814209
Epoch: 11, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.653 Vali Acc: 0.404 Test Loss: 1.653 Test Acc: 0.404
Validation loss decreased (-0.366650 --> -0.403687).  Saving model ...
Epoch: 12 cost time: 0.4141361713409424
Epoch: 12, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.628 Vali Acc: 0.456 Test Loss: 1.628 Test Acc: 0.456
Validation loss decreased (-0.403687 --> -0.455539).  Saving model ...
Epoch: 13 cost time: 0.4316079616546631
Epoch: 13, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.602 Vali Acc: 0.489 Test Loss: 1.602 Test Acc: 0.489
Validation loss decreased (-0.455539 --> -0.488873).  Saving model ...
Epoch: 14 cost time: 0.3784196376800537
Epoch: 14, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.575 Vali Acc: 0.526 Test Loss: 1.575 Test Acc: 0.526
Validation loss decreased (-0.488873 --> -0.525910).  Saving model ...
Epoch: 15 cost time: 0.4268455505371094
Epoch: 15, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.545 Vali Acc: 0.570 Test Loss: 1.545 Test Acc: 0.570
Validation loss decreased (-0.525910 --> -0.570355).  Saving model ...
Epoch: 16 cost time: 0.5207538604736328
Epoch: 16, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.514 Vali Acc: 0.622 Test Loss: 1.514 Test Acc: 0.622
Validation loss decreased (-0.570355 --> -0.622207).  Saving model ...
Epoch: 17 cost time: 0.3893899917602539
Epoch: 17, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.481 Vali Acc: 0.685 Test Loss: 1.481 Test Acc: 0.685
Validation loss decreased (-0.622207 --> -0.685170).  Saving model ...
Epoch: 18 cost time: 0.3894386291503906
Epoch: 18, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.448 Vali Acc: 0.707 Test Loss: 1.448 Test Acc: 0.707
Validation loss decreased (-0.685170 --> -0.707393).  Saving model ...
Epoch: 19 cost time: 0.38448596000671387
Epoch: 19, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.413 Vali Acc: 0.737 Test Loss: 1.413 Test Acc: 0.737
Validation loss decreased (-0.707393 --> -0.737023).  Saving model ...
Epoch: 20 cost time: 0.4440903663635254
Epoch: 20, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.377 Vali Acc: 0.763 Test Loss: 1.377 Test Acc: 0.763
Validation loss decreased (-0.737023 --> -0.762949).  Saving model ...
Epoch: 21 cost time: 0.3971588611602783
Epoch: 21, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.340 Vali Acc: 0.770 Test Loss: 1.340 Test Acc: 0.770
Validation loss decreased (-0.762949 --> -0.770357).  Saving model ...
Epoch: 22 cost time: 0.44476914405822754
Epoch: 22, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.303 Vali Acc: 0.785 Test Loss: 1.303 Test Acc: 0.785
Validation loss decreased (-0.770357 --> -0.785172).  Saving model ...
Epoch: 23 cost time: 0.44504833221435547
Epoch: 23, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.264 Vali Acc: 0.804 Test Loss: 1.264 Test Acc: 0.804
Validation loss decreased (-0.785172 --> -0.803691).  Saving model ...
Epoch: 24 cost time: 0.4328436851501465
Epoch: 24, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.225 Vali Acc: 0.822 Test Loss: 1.225 Test Acc: 0.822
Validation loss decreased (-0.803691 --> -0.822210).  Saving model ...
Epoch: 25 cost time: 0.4240443706512451
Epoch: 25, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.186 Vali Acc: 0.837 Test Loss: 1.186 Test Acc: 0.837
Validation loss decreased (-0.822210 --> -0.837025).  Saving model ...
Epoch: 26 cost time: 0.46402931213378906
Epoch: 26, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.145 Vali Acc: 0.844 Test Loss: 1.145 Test Acc: 0.844
Validation loss decreased (-0.837025 --> -0.844433).  Saving model ...
Epoch: 27 cost time: 0.42391180992126465
Epoch: 27, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.105 Vali Acc: 0.852 Test Loss: 1.105 Test Acc: 0.852
Validation loss decreased (-0.844433 --> -0.851841).  Saving model ...
Epoch: 28 cost time: 0.3861393928527832
Epoch: 28, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.065 Vali Acc: 0.852 Test Loss: 1.065 Test Acc: 0.852
Validation loss decreased (-0.851841 --> -0.851841).  Saving model ...
Epoch: 29 cost time: 0.3977193832397461
Epoch: 29, Steps: 2 | Train Loss: 0.835 Vali Loss: 1.025 Vali Acc: 0.856 Test Loss: 1.025 Test Acc: 0.856
Validation loss decreased (-0.851841 --> -0.855545).  Saving model ...
Epoch: 30 cost time: 0.45938634872436523
Epoch: 30, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.986 Vali Acc: 0.863 Test Loss: 0.986 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
Epoch: 31 cost time: 0.42232608795166016
Epoch: 31, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.947 Vali Acc: 0.881 Test Loss: 0.947 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881472).  Saving model ...
Epoch: 32 cost time: 0.41075634956359863
Epoch: 32, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.908 Vali Acc: 0.885 Test Loss: 0.908 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 33 cost time: 0.4262704849243164
Epoch: 33, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.871 Vali Acc: 0.893 Test Loss: 0.871 Test Acc: 0.893
Validation loss decreased (-0.885176 --> -0.892584).  Saving model ...
Epoch: 34 cost time: 0.4897191524505615
Epoch: 34, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.835 Vali Acc: 0.900 Test Loss: 0.835 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 35 cost time: 0.47159361839294434
Epoch: 35, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.800 Vali Acc: 0.896 Test Loss: 0.800 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.36781978607177734
Epoch: 36, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.766 Vali Acc: 0.904 Test Loss: 0.766 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 37 cost time: 0.4308464527130127
Epoch: 37, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.733 Vali Acc: 0.907 Test Loss: 0.733 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 38 cost time: 0.42018675804138184
Epoch: 38, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.702 Vali Acc: 0.915 Test Loss: 0.702 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 39 cost time: 0.37044548988342285
Epoch: 39, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.672 Vali Acc: 0.926 Test Loss: 0.672 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925919).  Saving model ...
Epoch: 40 cost time: 0.45963144302368164
Epoch: 40, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.643 Vali Acc: 0.930 Test Loss: 0.643 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 41 cost time: 0.3670628070831299
Epoch: 41, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.617 Vali Acc: 0.926 Test Loss: 0.617 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.387587308883667
Epoch: 42, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.592 Vali Acc: 0.930 Test Loss: 0.592 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 43 cost time: 0.4319138526916504
Epoch: 43, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.568 Vali Acc: 0.933 Test Loss: 0.568 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 44 cost time: 0.4379270076751709
Epoch: 44, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.546 Vali Acc: 0.933 Test Loss: 0.546 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 45 cost time: 0.4561796188354492
Epoch: 45, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.525 Vali Acc: 0.937 Test Loss: 0.525 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 46 cost time: 0.43242359161376953
Epoch: 46, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.506 Vali Acc: 0.937 Test Loss: 0.506 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 47 cost time: 0.44966626167297363
Epoch: 47, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.488 Vali Acc: 0.937 Test Loss: 0.488 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 48 cost time: 0.40108323097229004
Epoch: 48, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.471 Vali Acc: 0.937 Test Loss: 0.471 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 49 cost time: 0.3916456699371338
Epoch: 49, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.454 Vali Acc: 0.937 Test Loss: 0.454 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 50 cost time: 0.4003880023956299
Epoch: 50, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.439 Vali Acc: 0.937 Test Loss: 0.439 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 109894
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.543199062347412
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.789 Vali Acc: 0.241 Test Loss: 1.789 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.3689422607421875
Epoch: 2, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.780 Vali Acc: 0.248 Test Loss: 1.780 Test Acc: 0.248
Validation loss decreased (-0.240723 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.3814389705657959
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.773 Vali Acc: 0.256 Test Loss: 1.773 Test Acc: 0.256
Validation loss decreased (-0.248130 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.4018707275390625
Epoch: 4, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.766 Vali Acc: 0.256 Test Loss: 1.766 Test Acc: 0.256
Validation loss decreased (-0.255538 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 0.41838836669921875
Epoch: 5, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.757 Vali Acc: 0.263 Test Loss: 1.757 Test Acc: 0.263
Validation loss decreased (-0.255538 --> -0.262945).  Saving model ...
Epoch: 6 cost time: 0.4365839958190918
Epoch: 6, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.747 Vali Acc: 0.263 Test Loss: 1.747 Test Acc: 0.263
Validation loss decreased (-0.262945 --> -0.262945).  Saving model ...
Epoch: 7 cost time: 0.47379422187805176
Epoch: 7, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.734 Vali Acc: 0.289 Test Loss: 1.734 Test Acc: 0.289
Validation loss decreased (-0.262945 --> -0.288872).  Saving model ...
Epoch: 8 cost time: 0.3750576972961426
Epoch: 8, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.720 Vali Acc: 0.296 Test Loss: 1.720 Test Acc: 0.296
Validation loss decreased (-0.288872 --> -0.296279).  Saving model ...
Epoch: 9 cost time: 0.45648646354675293
Epoch: 9, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.704 Vali Acc: 0.307 Test Loss: 1.704 Test Acc: 0.307
Validation loss decreased (-0.296279 --> -0.307390).  Saving model ...
Epoch: 10 cost time: 0.37819504737854004
Epoch: 10, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.686 Vali Acc: 0.326 Test Loss: 1.686 Test Acc: 0.326
Validation loss decreased (-0.307390 --> -0.325909).  Saving model ...
Epoch: 11 cost time: 0.46508359909057617
Epoch: 11, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.667 Vali Acc: 0.352 Test Loss: 1.667 Test Acc: 0.352
Validation loss decreased (-0.325909 --> -0.351835).  Saving model ...
Epoch: 12 cost time: 0.46756982803344727
Epoch: 12, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.646 Vali Acc: 0.389 Test Loss: 1.646 Test Acc: 0.389
Validation loss decreased (-0.351835 --> -0.388872).  Saving model ...
Epoch: 13 cost time: 0.42042016983032227
Epoch: 13, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.624 Vali Acc: 0.437 Test Loss: 1.624 Test Acc: 0.437
Validation loss decreased (-0.388872 --> -0.437021).  Saving model ...
Epoch: 14 cost time: 0.5406489372253418
Epoch: 14, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.600 Vali Acc: 0.507 Test Loss: 1.600 Test Acc: 0.507
Validation loss decreased (-0.437021 --> -0.507391).  Saving model ...
Epoch: 15 cost time: 0.3949728012084961
Epoch: 15, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.576 Vali Acc: 0.556 Test Loss: 1.576 Test Acc: 0.556
Validation loss decreased (-0.507391 --> -0.555540).  Saving model ...
Epoch: 16 cost time: 0.3872551918029785
Epoch: 16, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.550 Vali Acc: 0.593 Test Loss: 1.550 Test Acc: 0.593
Validation loss decreased (-0.555540 --> -0.592577).  Saving model ...
Epoch: 17 cost time: 0.4591660499572754
Epoch: 17, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.522 Vali Acc: 0.622 Test Loss: 1.522 Test Acc: 0.622
Validation loss decreased (-0.592577 --> -0.622207).  Saving model ...
Epoch: 18 cost time: 0.3656742572784424
Epoch: 18, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.494 Vali Acc: 0.670 Test Loss: 1.494 Test Acc: 0.670
Validation loss decreased (-0.622207 --> -0.670355).  Saving model ...
Epoch: 19 cost time: 0.48129820823669434
Epoch: 19, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.465 Vali Acc: 0.700 Test Loss: 1.465 Test Acc: 0.700
Validation loss decreased (-0.670355 --> -0.699985).  Saving model ...
Epoch: 20 cost time: 0.40314483642578125
Epoch: 20, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.435 Vali Acc: 0.744 Test Loss: 1.435 Test Acc: 0.744
Validation loss decreased (-0.699985 --> -0.744430).  Saving model ...
Epoch: 21 cost time: 0.44570136070251465
Epoch: 21, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.404 Vali Acc: 0.778 Test Loss: 1.404 Test Acc: 0.778
Validation loss decreased (-0.744430 --> -0.777764).  Saving model ...
Epoch: 22 cost time: 0.4180786609649658
Epoch: 22, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.372 Vali Acc: 0.800 Test Loss: 1.372 Test Acc: 0.800
Validation loss decreased (-0.777764 --> -0.799986).  Saving model ...
Epoch: 23 cost time: 0.43405890464782715
Epoch: 23, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.340 Vali Acc: 0.815 Test Loss: 1.340 Test Acc: 0.815
Validation loss decreased (-0.799986 --> -0.814801).  Saving model ...
Epoch: 24 cost time: 0.449084997177124
Epoch: 24, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.307 Vali Acc: 0.844 Test Loss: 1.307 Test Acc: 0.844
Validation loss decreased (-0.814801 --> -0.844431).  Saving model ...
Epoch: 25 cost time: 0.38878345489501953
Epoch: 25, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.274 Vali Acc: 0.852 Test Loss: 1.274 Test Acc: 0.852
Validation loss decreased (-0.844431 --> -0.851839).  Saving model ...
Epoch: 26 cost time: 0.41087865829467773
Epoch: 26, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.240 Vali Acc: 0.852 Test Loss: 1.240 Test Acc: 0.852
Validation loss decreased (-0.851839 --> -0.851839).  Saving model ...
Epoch: 27 cost time: 0.45222997665405273
Epoch: 27, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.206 Vali Acc: 0.867 Test Loss: 1.206 Test Acc: 0.867
Validation loss decreased (-0.851839 --> -0.866655).  Saving model ...
Epoch: 28 cost time: 0.40388941764831543
Epoch: 28, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.170 Vali Acc: 0.881 Test Loss: 1.170 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881470).  Saving model ...
Epoch: 29 cost time: 0.43941617012023926
Epoch: 29, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.135 Vali Acc: 0.885 Test Loss: 1.135 Test Acc: 0.885
Validation loss decreased (-0.881470 --> -0.885174).  Saving model ...
Epoch: 30 cost time: 0.4673197269439697
Epoch: 30, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.100 Vali Acc: 0.893 Test Loss: 1.100 Test Acc: 0.893
Validation loss decreased (-0.885174 --> -0.892582).  Saving model ...
Epoch: 31 cost time: 0.402864933013916
Epoch: 31, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.065 Vali Acc: 0.904 Test Loss: 1.065 Test Acc: 0.904
Validation loss decreased (-0.892582 --> -0.903693).  Saving model ...
Epoch: 32 cost time: 0.4251220226287842
Epoch: 32, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.029 Vali Acc: 0.904 Test Loss: 1.029 Test Acc: 0.904
Validation loss decreased (-0.903693 --> -0.903693).  Saving model ...
Epoch: 33 cost time: 0.48601722717285156
Epoch: 33, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.994 Vali Acc: 0.904 Test Loss: 0.994 Test Acc: 0.904
Validation loss decreased (-0.903693 --> -0.903694).  Saving model ...
Epoch: 34 cost time: 0.4254603385925293
Epoch: 34, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.959 Vali Acc: 0.915 Test Loss: 0.959 Test Acc: 0.915
Validation loss decreased (-0.903694 --> -0.914805).  Saving model ...
Epoch: 35 cost time: 0.4262564182281494
Epoch: 35, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.924 Vali Acc: 0.919 Test Loss: 0.924 Test Acc: 0.919
Validation loss decreased (-0.914805 --> -0.918509).  Saving model ...
Epoch: 36 cost time: 0.6198582649230957
Epoch: 36, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.890 Vali Acc: 0.919 Test Loss: 0.890 Test Acc: 0.919
Validation loss decreased (-0.918509 --> -0.918510).  Saving model ...
Epoch: 37 cost time: 0.3828451633453369
Epoch: 37, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.857 Vali Acc: 0.919 Test Loss: 0.857 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918510).  Saving model ...
Epoch: 38 cost time: 0.37320947647094727
Epoch: 38, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.824 Vali Acc: 0.919 Test Loss: 0.824 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918510).  Saving model ...
Epoch: 39 cost time: 0.3773646354675293
Epoch: 39, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.792 Vali Acc: 0.919 Test Loss: 0.792 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918511).  Saving model ...
Epoch: 40 cost time: 0.4346749782562256
Epoch: 40, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.760 Vali Acc: 0.926 Test Loss: 0.760 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925918).  Saving model ...
Epoch: 41 cost time: 0.5372326374053955
Epoch: 41, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.730 Vali Acc: 0.930 Test Loss: 0.730 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 42 cost time: 0.4000561237335205
Epoch: 42, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.701 Vali Acc: 0.930 Test Loss: 0.701 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929623).  Saving model ...
Epoch: 43 cost time: 0.4736807346343994
Epoch: 43, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.674 Vali Acc: 0.933 Test Loss: 0.674 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 44 cost time: 0.38771486282348633
Epoch: 44, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.648 Vali Acc: 0.937 Test Loss: 0.648 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 45 cost time: 0.42248058319091797
Epoch: 45, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.623 Vali Acc: 0.937 Test Loss: 0.623 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 46 cost time: 0.3858785629272461
Epoch: 46, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.599 Vali Acc: 0.933 Test Loss: 0.599 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4695396423339844
Epoch: 47, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.577 Vali Acc: 0.930 Test Loss: 0.577 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4979825019836426
Epoch: 48, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.556 Vali Acc: 0.933 Test Loss: 0.556 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.42029595375061035
Epoch: 49, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.535 Vali Acc: 0.937 Test Loss: 0.535 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 50 cost time: 0.41799020767211914
Epoch: 50, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.516 Vali Acc: 0.944 Test Loss: 0.516 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944439).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 108486
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8675117492675781
Epoch: 1, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.626 Vali Acc: 0.433 Test Loss: 1.626 Test Acc: 0.433
Validation loss decreased (inf --> -0.433317).  Saving model ...
Epoch: 2 cost time: 0.516395092010498
Epoch: 2, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.494 Vali Acc: 0.567 Test Loss: 1.494 Test Acc: 0.567
Validation loss decreased (-0.433317 --> -0.566652).  Saving model ...
Epoch: 3 cost time: 0.43489742279052734
Epoch: 3, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.246 Vali Acc: 0.811 Test Loss: 1.246 Test Acc: 0.811
Validation loss decreased (-0.566652 --> -0.811099).  Saving model ...
Epoch: 4 cost time: 0.4372367858886719
Epoch: 4, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.864 Vali Acc: 0.885 Test Loss: 0.864 Test Acc: 0.885
Validation loss decreased (-0.811099 --> -0.885177).  Saving model ...
Epoch: 5 cost time: 0.4758179187774658
Epoch: 5, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.578 Vali Acc: 0.904 Test Loss: 0.578 Test Acc: 0.904
Validation loss decreased (-0.885177 --> -0.903698).  Saving model ...
Epoch: 6 cost time: 0.43964409828186035
Epoch: 6, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.392 Vali Acc: 0.926 Test Loss: 0.392 Test Acc: 0.926
Validation loss decreased (-0.903698 --> -0.925922).  Saving model ...
Epoch: 7 cost time: 0.4760732650756836
Epoch: 7, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 8 cost time: 0.4692857265472412
Epoch: 8, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 9 cost time: 0.4941592216491699
Epoch: 9, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 10 cost time: 0.46629834175109863
Epoch: 10, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 11 cost time: 0.4198639392852783
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 12 cost time: 0.46636962890625
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 13 cost time: 0.4279327392578125
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.5501012802124023
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4553711414337158
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5067563056945801
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.47616076469421387
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.4506652355194092
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.42156338691711426
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.46862363815307617
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4544181823730469
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 22 cost time: 0.5200021266937256
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4457390308380127
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4486713409423828
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.46611547470092773
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4523153305053711
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.44669604301452637
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.48917078971862793
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.47333359718322754
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.46571803092956543
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.956 Test Loss: 0.223 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4690413475036621
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.956 Test Loss: 0.223 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1494790
model size : 5.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5609815120697021
Epoch: 1, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.724 Vali Acc: 0.307 Test Loss: 1.724 Test Acc: 0.307
Validation loss decreased (inf --> -0.307390).  Saving model ...
Epoch: 2 cost time: 0.37610864639282227
Epoch: 2, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.638 Vali Acc: 0.567 Test Loss: 1.638 Test Acc: 0.567
Validation loss decreased (-0.307390 --> -0.566650).  Saving model ...
Epoch: 3 cost time: 0.4075005054473877
Epoch: 3, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.493 Vali Acc: 0.722 Test Loss: 1.493 Test Acc: 0.722
Validation loss decreased (-0.566650 --> -0.722207).  Saving model ...
Epoch: 4 cost time: 0.36589503288269043
Epoch: 4, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.238 Vali Acc: 0.844 Test Loss: 1.238 Test Acc: 0.844
Validation loss decreased (-0.722207 --> -0.844432).  Saving model ...
Epoch: 5 cost time: 0.41310930252075195
Epoch: 5, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.964 Vali Acc: 0.919 Test Loss: 0.964 Test Acc: 0.919
Validation loss decreased (-0.844432 --> -0.918509).  Saving model ...
Epoch: 6 cost time: 0.40133118629455566
Epoch: 6, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.730 Vali Acc: 0.919 Test Loss: 0.730 Test Acc: 0.919
Validation loss decreased (-0.918509 --> -0.918511).  Saving model ...
Epoch: 7 cost time: 0.3962559700012207
Epoch: 7, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.553 Vali Acc: 0.922 Test Loss: 0.553 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922217).  Saving model ...
Epoch: 8 cost time: 0.4644815921783447
Epoch: 8, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.421 Vali Acc: 0.937 Test Loss: 0.421 Test Acc: 0.937
Validation loss decreased (-0.922217 --> -0.937033).  Saving model ...
Epoch: 9 cost time: 0.4197673797607422
Epoch: 9, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 10 cost time: 0.41828227043151855
Epoch: 10, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 11 cost time: 0.39978599548339844
Epoch: 11, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 12 cost time: 0.3838624954223633
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 13 cost time: 0.40892887115478516
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.3909413814544678
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.36148881912231445
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.3592715263366699
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.43471550941467285
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.4020366668701172
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.46214771270751953
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.35996127128601074
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.3999321460723877
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.3674657344818115
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.3538036346435547
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4605836868286133
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.4029240608215332
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4045751094818115
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.40961337089538574
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4202878475189209
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3785417079925537
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.38913750648498535
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.39562010765075684
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.3814659118652344
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.39851999282836914
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.41973352432250977
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1292550
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.715604543685913
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.761 Vali Acc: 0.256 Test Loss: 1.761 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.43430352210998535
Epoch: 2, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.686 Vali Acc: 0.322 Test Loss: 1.686 Test Acc: 0.322
Validation loss decreased (-0.255538 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 0.39884114265441895
Epoch: 3, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.577 Vali Acc: 0.426 Test Loss: 1.577 Test Acc: 0.426
Validation loss decreased (-0.322205 --> -0.425910).  Saving model ...
Epoch: 4 cost time: 0.4268054962158203
Epoch: 4, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.387 Vali Acc: 0.696 Test Loss: 1.387 Test Acc: 0.696
Validation loss decreased (-0.425910 --> -0.696282).  Saving model ...
Epoch: 5 cost time: 0.41655659675598145
Epoch: 5, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.166 Vali Acc: 0.811 Test Loss: 1.166 Test Acc: 0.811
Validation loss decreased (-0.696282 --> -0.811099).  Saving model ...
Epoch: 6 cost time: 0.37808966636657715
Epoch: 6, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.950 Vali Acc: 0.859 Test Loss: 0.950 Test Acc: 0.859
Validation loss decreased (-0.811099 --> -0.859250).  Saving model ...
Epoch: 7 cost time: 0.398909330368042
Epoch: 7, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.767 Vali Acc: 0.885 Test Loss: 0.767 Test Acc: 0.885
Validation loss decreased (-0.859250 --> -0.885178).  Saving model ...
Epoch: 8 cost time: 0.515845537185669
Epoch: 8, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.622 Vali Acc: 0.889 Test Loss: 0.622 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888883).  Saving model ...
Epoch: 9 cost time: 0.3923299312591553
Epoch: 9, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.503 Vali Acc: 0.911 Test Loss: 0.503 Test Acc: 0.911
Validation loss decreased (-0.888883 --> -0.911106).  Saving model ...
Epoch: 10 cost time: 0.409898042678833
Epoch: 10, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.414 Vali Acc: 0.919 Test Loss: 0.414 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 11 cost time: 0.42215919494628906
Epoch: 11, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.351 Vali Acc: 0.926 Test Loss: 0.351 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 12 cost time: 0.45996809005737305
Epoch: 12, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 13 cost time: 0.4344520568847656
Epoch: 13, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.4332437515258789
Epoch: 14, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.5233461856842041
Epoch: 15, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.439251184463501
Epoch: 16, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4111661911010742
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.44654107093811035
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.486375093460083
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.42775702476501465
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4254755973815918
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.44313883781433105
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4130110740661621
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4424574375152588
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1225222
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6175100803375244
Epoch: 1, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.759 Vali Acc: 0.281 Test Loss: 1.759 Test Acc: 0.281
Validation loss decreased (inf --> -0.281464).  Saving model ...
Epoch: 2 cost time: 0.43265843391418457
Epoch: 2, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.696 Vali Acc: 0.400 Test Loss: 1.696 Test Acc: 0.400
Validation loss decreased (-0.281464 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 0.47148895263671875
Epoch: 3, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.609 Vali Acc: 0.478 Test Loss: 1.609 Test Acc: 0.478
Validation loss decreased (-0.399983 --> -0.477762).  Saving model ...
Epoch: 4 cost time: 0.4180033206939697
Epoch: 4, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.461 Vali Acc: 0.674 Test Loss: 1.461 Test Acc: 0.674
Validation loss decreased (-0.477762 --> -0.674059).  Saving model ...
Epoch: 5 cost time: 0.49896883964538574
Epoch: 5, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.276 Vali Acc: 0.763 Test Loss: 1.276 Test Acc: 0.763
Validation loss decreased (-0.674059 --> -0.762950).  Saving model ...
Epoch: 6 cost time: 0.40930652618408203
Epoch: 6, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.079 Vali Acc: 0.830 Test Loss: 1.079 Test Acc: 0.830
Validation loss decreased (-0.762950 --> -0.829619).  Saving model ...
Epoch: 7 cost time: 0.433030366897583
Epoch: 7, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.893 Vali Acc: 0.874 Test Loss: 0.893 Test Acc: 0.874
Validation loss decreased (-0.829619 --> -0.874065).  Saving model ...
Epoch: 8 cost time: 0.40405988693237305
Epoch: 8, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.731 Vali Acc: 0.889 Test Loss: 0.731 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888882).  Saving model ...
Epoch: 9 cost time: 0.42089390754699707
Epoch: 9, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.592 Vali Acc: 0.904 Test Loss: 0.592 Test Acc: 0.904
Validation loss decreased (-0.888882 --> -0.903698).  Saving model ...
Epoch: 10 cost time: 0.4134209156036377
Epoch: 10, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.479 Vali Acc: 0.930 Test Loss: 0.479 Test Acc: 0.930
Validation loss decreased (-0.903698 --> -0.929625).  Saving model ...
Epoch: 11 cost time: 0.4003736972808838
Epoch: 11, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.393 Vali Acc: 0.926 Test Loss: 0.393 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4256784915924072
Epoch: 12, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 13 cost time: 0.4634733200073242
Epoch: 13, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 14 cost time: 0.4679887294769287
Epoch: 14, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.39367222785949707
Epoch: 15, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
Validation loss decreased (-0.940738 --> -0.951850).  Saving model ...
Epoch: 16 cost time: 0.4362649917602539
Epoch: 16, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.952 Test Loss: 0.213 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 17 cost time: 0.3888547420501709
Epoch: 17, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 18 cost time: 0.4227313995361328
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.4329667091369629
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.40902042388916016
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.4766693115234375
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.4452638626098633
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.46045708656311035
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.3920304775238037
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.4821610450744629
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4771733283996582
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4522128105163574
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4090564250946045
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3998730182647705
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.45143747329711914
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.3897242546081543
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.52781081199646
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4064452648162842
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.3929309844970703
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1195014
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6889572143554688
Epoch: 1, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.771 Vali Acc: 0.148 Test Loss: 1.771 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.37296223640441895
Epoch: 2, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.715 Vali Acc: 0.252 Test Loss: 1.715 Test Acc: 0.252
Validation loss decreased (-0.148130 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 0.3890056610107422
Epoch: 3, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.643 Vali Acc: 0.467 Test Loss: 1.643 Test Acc: 0.467
Validation loss decreased (-0.251835 --> -0.466650).  Saving model ...
Epoch: 4 cost time: 0.40566492080688477
Epoch: 4, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.526 Vali Acc: 0.652 Test Loss: 1.526 Test Acc: 0.652
Validation loss decreased (-0.466650 --> -0.651837).  Saving model ...
Epoch: 5 cost time: 0.4068868160247803
Epoch: 5, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.378 Vali Acc: 0.726 Test Loss: 1.378 Test Acc: 0.726
Validation loss decreased (-0.651837 --> -0.725912).  Saving model ...
Epoch: 6 cost time: 0.4154784679412842
Epoch: 6, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.208 Vali Acc: 0.807 Test Loss: 1.208 Test Acc: 0.807
Validation loss decreased (-0.725912 --> -0.807395).  Saving model ...
Epoch: 7 cost time: 0.38451337814331055
Epoch: 7, Steps: 2 | Train Loss: 0.750 Vali Loss: 1.034 Vali Acc: 0.859 Test Loss: 1.034 Test Acc: 0.859
Validation loss decreased (-0.807395 --> -0.859249).  Saving model ...
Epoch: 8 cost time: 0.4163351058959961
Epoch: 8, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.869 Vali Acc: 0.878 Test Loss: 0.869 Test Acc: 0.878
Validation loss decreased (-0.859249 --> -0.877769).  Saving model ...
Epoch: 9 cost time: 0.43114566802978516
Epoch: 9, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.727 Vali Acc: 0.896 Test Loss: 0.727 Test Acc: 0.896
Validation loss decreased (-0.877769 --> -0.896289).  Saving model ...
Epoch: 10 cost time: 0.4537975788116455
Epoch: 10, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.609 Vali Acc: 0.911 Test Loss: 0.609 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911105).  Saving model ...
Epoch: 11 cost time: 0.4053027629852295
Epoch: 11, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.509 Vali Acc: 0.919 Test Loss: 0.509 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 12 cost time: 0.43350863456726074
Epoch: 12, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 13 cost time: 0.44917893409729004
Epoch: 13, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 14 cost time: 0.4102311134338379
Epoch: 14, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.323 Vali Acc: 0.941 Test Loss: 0.323 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.3990950584411621
Epoch: 15, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.468827486038208
Epoch: 16, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3963634967803955
Epoch: 17, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.33852267265319824
Epoch: 18, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4041457176208496
Epoch: 19, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4295341968536377
Epoch: 20, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4382946491241455
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4047877788543701
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4459805488586426
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.3749876022338867
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.3760707378387451
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.37807369232177734
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.37799715995788574
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.36769938468933105
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.3857300281524658
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.4719383716583252
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.4022190570831299
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.39023542404174805
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.4028198719024658
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.39939188957214355
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.4487948417663574
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.45917606353759766
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.43478822708129883
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.44438648223876953
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.42339348793029785
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.42288780212402344
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.4373924732208252
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.3968625068664551
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 43 cost time: 0.400158166885376
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 44 cost time: 0.409527063369751
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.4735684394836426
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.43755245208740234
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4277763366699219
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.3767697811126709
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.40218019485473633
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.42922377586364746
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1177350
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6189687252044678
Epoch: 1, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.786 Vali Acc: 0.241 Test Loss: 1.786 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.42559146881103516
Epoch: 2, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.743 Vali Acc: 0.267 Test Loss: 1.743 Test Acc: 0.267
Validation loss decreased (-0.240723 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.44467806816101074
Epoch: 3, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.693 Vali Acc: 0.304 Test Loss: 1.693 Test Acc: 0.304
Validation loss decreased (-0.266649 --> -0.303687).  Saving model ...
Epoch: 4 cost time: 0.41779303550720215
Epoch: 4, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.610 Vali Acc: 0.437 Test Loss: 1.610 Test Acc: 0.437
Validation loss decreased (-0.303687 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.3865664005279541
Epoch: 5, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.501 Vali Acc: 0.559 Test Loss: 1.501 Test Acc: 0.559
Validation loss decreased (-0.437021 --> -0.559244).  Saving model ...
Epoch: 6 cost time: 0.4709172248840332
Epoch: 6, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.372 Vali Acc: 0.663 Test Loss: 1.372 Test Acc: 0.663
Validation loss decreased (-0.559244 --> -0.662949).  Saving model ...
Epoch: 7 cost time: 0.40305113792419434
Epoch: 7, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.233 Vali Acc: 0.770 Test Loss: 1.233 Test Acc: 0.770
Validation loss decreased (-0.662949 --> -0.770358).  Saving model ...
Epoch: 8 cost time: 0.40168190002441406
Epoch: 8, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.090 Vali Acc: 0.844 Test Loss: 1.090 Test Acc: 0.844
Validation loss decreased (-0.770358 --> -0.844434).  Saving model ...
Epoch: 9 cost time: 0.4414327144622803
Epoch: 9, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.952 Vali Acc: 0.896 Test Loss: 0.952 Test Acc: 0.896
Validation loss decreased (-0.844434 --> -0.896287).  Saving model ...
Epoch: 10 cost time: 0.39992666244506836
Epoch: 10, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.821 Vali Acc: 0.919 Test Loss: 0.821 Test Acc: 0.919
Validation loss decreased (-0.896287 --> -0.918510).  Saving model ...
Epoch: 11 cost time: 0.4245474338531494
Epoch: 11, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.702 Vali Acc: 0.937 Test Loss: 0.702 Test Acc: 0.937
Validation loss decreased (-0.918510 --> -0.937030).  Saving model ...
Epoch: 12 cost time: 0.4342968463897705
Epoch: 12, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.598 Vali Acc: 0.944 Test Loss: 0.598 Test Acc: 0.944
Validation loss decreased (-0.937030 --> -0.944438).  Saving model ...
Epoch: 13 cost time: 0.456223726272583
Epoch: 13, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.510 Vali Acc: 0.948 Test Loss: 0.510 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948143).  Saving model ...
Epoch: 14 cost time: 0.44409942626953125
Epoch: 14, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.439 Vali Acc: 0.952 Test Loss: 0.439 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 15 cost time: 0.45394253730773926
Epoch: 15, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.384 Vali Acc: 0.963 Test Loss: 0.384 Test Acc: 0.963
Validation loss decreased (-0.951847 --> -0.962959).  Saving model ...
Epoch: 16 cost time: 0.4161849021911621
Epoch: 16, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.339 Vali Acc: 0.963 Test Loss: 0.339 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962960).  Saving model ...
Epoch: 17 cost time: 0.3703615665435791
Epoch: 17, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.305 Vali Acc: 0.967 Test Loss: 0.305 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966664).  Saving model ...
Epoch: 18 cost time: 0.42173218727111816
Epoch: 18, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.278 Vali Acc: 0.967 Test Loss: 0.278 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 19 cost time: 0.3845102787017822
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 20 cost time: 0.44912004470825195
Epoch: 20, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.241 Vali Acc: 0.967 Test Loss: 0.241 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 21 cost time: 0.5267808437347412
Epoch: 21, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 22 cost time: 0.4325273036956787
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.967 Test Loss: 0.218 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 23 cost time: 0.4143366813659668
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 24 cost time: 0.37999582290649414
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 0.4078497886657715
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 26 cost time: 0.3719289302825928
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 27 cost time: 0.4659707546234131
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 28 cost time: 0.5066626071929932
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 29 cost time: 0.34059667587280273
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 30 cost time: 0.406078577041626
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 31 cost time: 0.3810760974884033
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 32 cost time: 0.48222947120666504
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 33 cost time: 0.4295198917388916
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 34 cost time: 0.4243133068084717
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 35 cost time: 0.41565799713134766
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 36 cost time: 0.43950724601745605
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 37 cost time: 0.404526948928833
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 38 cost time: 0.37402963638305664
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 39 cost time: 0.4096224308013916
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 40 cost time: 0.429764986038208
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 41 cost time: 0.4687066078186035
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 42 cost time: 0.41932225227355957
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.4762868881225586
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.3954300880432129
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.4148368835449219
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.41110992431640625
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 47 cost time: 0.4011693000793457
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 48 cost time: 0.41425132751464844
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 49 cost time: 0.39739251136779785
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 50 cost time: 0.39370059967041016
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 1153542
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8434760570526123
Epoch: 1, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.814 Vali Acc: 0.122 Test Loss: 1.814 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.47031593322753906
Epoch: 2, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.764 Vali Acc: 0.256 Test Loss: 1.764 Test Acc: 0.256
Validation loss decreased (-0.122204 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.3981623649597168
Epoch: 3, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.711 Vali Acc: 0.300 Test Loss: 1.711 Test Acc: 0.300
Validation loss decreased (-0.255538 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.43591904640197754
Epoch: 4, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.636 Vali Acc: 0.396 Test Loss: 1.636 Test Acc: 0.396
Validation loss decreased (-0.299983 --> -0.396280).  Saving model ...
Epoch: 5 cost time: 0.41407299041748047
Epoch: 5, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.539 Vali Acc: 0.493 Test Loss: 1.539 Test Acc: 0.493
Validation loss decreased (-0.396280 --> -0.492577).  Saving model ...
Epoch: 6 cost time: 0.4292271137237549
Epoch: 6, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.427 Vali Acc: 0.607 Test Loss: 1.427 Test Acc: 0.607
Validation loss decreased (-0.492577 --> -0.607393).  Saving model ...
Epoch: 7 cost time: 0.4204869270324707
Epoch: 7, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.305 Vali Acc: 0.700 Test Loss: 1.305 Test Acc: 0.700
Validation loss decreased (-0.607393 --> -0.699987).  Saving model ...
Epoch: 8 cost time: 0.4824953079223633
Epoch: 8, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.178 Vali Acc: 0.781 Test Loss: 1.178 Test Acc: 0.781
Validation loss decreased (-0.699987 --> -0.781470).  Saving model ...
Epoch: 9 cost time: 0.41353702545166016
Epoch: 9, Steps: 2 | Train Loss: 0.776 Vali Loss: 1.050 Vali Acc: 0.822 Test Loss: 1.050 Test Acc: 0.822
Validation loss decreased (-0.781470 --> -0.822212).  Saving model ...
Epoch: 10 cost time: 0.4144158363342285
Epoch: 10, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.926 Vali Acc: 0.848 Test Loss: 0.926 Test Acc: 0.848
Validation loss decreased (-0.822212 --> -0.848139).  Saving model ...
Epoch: 11 cost time: 0.4124617576599121
Epoch: 11, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.812 Vali Acc: 0.889 Test Loss: 0.812 Test Acc: 0.889
Validation loss decreased (-0.848139 --> -0.888881).  Saving model ...
Epoch: 12 cost time: 0.47301292419433594
Epoch: 12, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.709 Vali Acc: 0.911 Test Loss: 0.709 Test Acc: 0.911
Validation loss decreased (-0.888881 --> -0.911104).  Saving model ...
Epoch: 13 cost time: 0.4695103168487549
Epoch: 13, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.619 Vali Acc: 0.930 Test Loss: 0.619 Test Acc: 0.930
Validation loss decreased (-0.911104 --> -0.929623).  Saving model ...
Epoch: 14 cost time: 0.4155616760253906
Epoch: 14, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.542 Vali Acc: 0.937 Test Loss: 0.542 Test Acc: 0.937
Validation loss decreased (-0.929623 --> -0.937032).  Saving model ...
Epoch: 15 cost time: 0.40352725982666016
Epoch: 15, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.476 Vali Acc: 0.944 Test Loss: 0.476 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 16 cost time: 0.38573312759399414
Epoch: 16, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.422 Vali Acc: 0.952 Test Loss: 0.422 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951848).  Saving model ...
Epoch: 17 cost time: 0.42466092109680176
Epoch: 17, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.376 Vali Acc: 0.952 Test Loss: 0.376 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 18 cost time: 0.40683722496032715
Epoch: 18, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.340 Vali Acc: 0.956 Test Loss: 0.340 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 19 cost time: 0.431668758392334
Epoch: 19, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.312 Vali Acc: 0.952 Test Loss: 0.312 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3988480567932129
Epoch: 20, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.289 Vali Acc: 0.956 Test Loss: 0.289 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 21 cost time: 0.40529346466064453
Epoch: 21, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.270 Vali Acc: 0.959 Test Loss: 0.270 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 22 cost time: 0.45511817932128906
Epoch: 22, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.255 Vali Acc: 0.959 Test Loss: 0.255 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 23 cost time: 0.37630200386047363
Epoch: 23, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.243 Vali Acc: 0.959 Test Loss: 0.243 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 24 cost time: 0.3752717971801758
Epoch: 24, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 25 cost time: 0.3671107292175293
Epoch: 25, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.959 Test Loss: 0.226 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 26 cost time: 0.3939526081085205
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.4410219192504883
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 28 cost time: 0.39989662170410156
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.49625492095947266
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 30 cost time: 0.43421173095703125
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 31 cost time: 0.41673779487609863
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 32 cost time: 0.47668027877807617
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.3932168483734131
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 34 cost time: 0.4829752445220947
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.963 Test Loss: 0.195 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 35 cost time: 0.38592076301574707
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 36 cost time: 0.4014275074005127
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 37 cost time: 0.39867591857910156
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.37337613105773926
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4156460762023926
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4063560962677002
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.43570590019226074
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4077298641204834
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4592607021331787
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.4115874767303467
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.38383913040161133
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.39922475814819336
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 1142278
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6785919666290283
Epoch: 1, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.721 Vali Acc: 0.359 Test Loss: 1.721 Test Acc: 0.359
Validation loss decreased (inf --> -0.359242).  Saving model ...
Epoch: 2 cost time: 0.3570287227630615
Epoch: 2, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.629 Vali Acc: 0.533 Test Loss: 1.629 Test Acc: 0.533
Validation loss decreased (-0.359242 --> -0.533317).  Saving model ...
Epoch: 3 cost time: 0.40987634658813477
Epoch: 3, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.473 Vali Acc: 0.656 Test Loss: 1.473 Test Acc: 0.656
Validation loss decreased (-0.533317 --> -0.655541).  Saving model ...
Epoch: 4 cost time: 0.3887300491333008
Epoch: 4, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.200 Vali Acc: 0.830 Test Loss: 1.200 Test Acc: 0.830
Validation loss decreased (-0.655541 --> -0.829618).  Saving model ...
Epoch: 5 cost time: 0.4122903347015381
Epoch: 5, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.929 Vali Acc: 0.867 Test Loss: 0.929 Test Acc: 0.867
Validation loss decreased (-0.829618 --> -0.866657).  Saving model ...
Epoch: 6 cost time: 0.424877405166626
Epoch: 6, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.699 Vali Acc: 0.911 Test Loss: 0.699 Test Acc: 0.911
Validation loss decreased (-0.866657 --> -0.911104).  Saving model ...
Epoch: 7 cost time: 0.41516661643981934
Epoch: 7, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.523 Vali Acc: 0.926 Test Loss: 0.523 Test Acc: 0.926
Validation loss decreased (-0.911104 --> -0.925921).  Saving model ...
Epoch: 8 cost time: 0.4000701904296875
Epoch: 8, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 9 cost time: 0.40836405754089355
Epoch: 9, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
Validation loss decreased (-0.933329 --> -0.948145).  Saving model ...
Epoch: 10 cost time: 0.42870378494262695
Epoch: 10, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.409649133682251
Epoch: 11, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 12 cost time: 0.4109151363372803
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 13 cost time: 0.4162607192993164
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.38033342361450195
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4085044860839844
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.3923344612121582
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.38419532775878906
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.448901891708374
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.46132373809814453
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.41920924186706543
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5194656848907471
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.42220115661621094
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 485254
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6252179145812988
Epoch: 1, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.739 Vali Acc: 0.226 Test Loss: 1.739 Test Acc: 0.226
Validation loss decreased (inf --> -0.225909).  Saving model ...
Epoch: 2 cost time: 0.35209178924560547
Epoch: 2, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.680 Vali Acc: 0.385 Test Loss: 1.680 Test Acc: 0.385
Validation loss decreased (-0.225909 --> -0.385168).  Saving model ...
Epoch: 3 cost time: 0.39330101013183594
Epoch: 3, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.597 Vali Acc: 0.533 Test Loss: 1.597 Test Acc: 0.533
Validation loss decreased (-0.385168 --> -0.533317).  Saving model ...
Epoch: 4 cost time: 0.45932626724243164
Epoch: 4, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.457 Vali Acc: 0.674 Test Loss: 1.457 Test Acc: 0.674
Validation loss decreased (-0.533317 --> -0.674060).  Saving model ...
Epoch: 5 cost time: 0.41410231590270996
Epoch: 5, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.285 Vali Acc: 0.744 Test Loss: 1.285 Test Acc: 0.744
Validation loss decreased (-0.674060 --> -0.744432).  Saving model ...
Epoch: 6 cost time: 0.41777467727661133
Epoch: 6, Steps: 2 | Train Loss: 0.895 Vali Loss: 1.099 Vali Acc: 0.811 Test Loss: 1.099 Test Acc: 0.811
Validation loss decreased (-0.744432 --> -0.811100).  Saving model ...
Epoch: 7 cost time: 0.4324924945831299
Epoch: 7, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.920 Vali Acc: 0.859 Test Loss: 0.920 Test Acc: 0.859
Validation loss decreased (-0.811100 --> -0.859250).  Saving model ...
Epoch: 8 cost time: 0.38143086433410645
Epoch: 8, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.763 Vali Acc: 0.900 Test Loss: 0.763 Test Acc: 0.900
Validation loss decreased (-0.859250 --> -0.899992).  Saving model ...
Epoch: 9 cost time: 0.4092428684234619
Epoch: 9, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.630 Vali Acc: 0.904 Test Loss: 0.630 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903697).  Saving model ...
Epoch: 10 cost time: 0.37610435485839844
Epoch: 10, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.521 Vali Acc: 0.915 Test Loss: 0.521 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914810).  Saving model ...
Epoch: 11 cost time: 0.40729737281799316
Epoch: 11, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.432 Vali Acc: 0.930 Test Loss: 0.432 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929625).  Saving model ...
Epoch: 12 cost time: 0.41298675537109375
Epoch: 12, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.367 Vali Acc: 0.937 Test Loss: 0.367 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 13 cost time: 0.3974123001098633
Epoch: 13, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 14 cost time: 0.36713409423828125
Epoch: 14, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.43706750869750977
Epoch: 15, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.38834357261657715
Epoch: 16, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.40702176094055176
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 18 cost time: 0.42237329483032227
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.38575077056884766
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.38895392417907715
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.40404200553894043
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.3788027763366699
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.3868117332458496
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.38649582862854004
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.35207056999206543
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.4334867000579834
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4255216121673584
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.38713788986206055
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.3880596160888672
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.38576674461364746
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.3842766284942627
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.4370551109313965
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.3848402500152588
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.372483491897583
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.4772958755493164
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.3820302486419678
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.46144652366638184
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.36200690269470215
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.4159088134765625
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3601856231689453
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.3578367233276367
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.39618492126464844
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.36446690559387207
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.44246625900268555
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.4057505130767822
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.4348156452178955
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.38120293617248535
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.35874485969543457
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 384134
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5932621955871582
Epoch: 1, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.785 Vali Acc: 0.119 Test Loss: 1.785 Test Acc: 0.119
Validation loss decreased (inf --> -0.118501).  Saving model ...
Epoch: 2 cost time: 0.3845703601837158
Epoch: 2, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.729 Vali Acc: 0.263 Test Loss: 1.729 Test Acc: 0.263
Validation loss decreased (-0.118501 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.38886022567749023
Epoch: 3, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.663 Vali Acc: 0.389 Test Loss: 1.663 Test Acc: 0.389
Validation loss decreased (-0.262946 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 0.4082763195037842
Epoch: 4, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.561 Vali Acc: 0.570 Test Loss: 1.561 Test Acc: 0.570
Validation loss decreased (-0.388872 --> -0.570355).  Saving model ...
Epoch: 5 cost time: 0.36905813217163086
Epoch: 5, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.432 Vali Acc: 0.693 Test Loss: 1.432 Test Acc: 0.693
Validation loss decreased (-0.570355 --> -0.692578).  Saving model ...
Epoch: 6 cost time: 0.35834622383117676
Epoch: 6, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.285 Vali Acc: 0.770 Test Loss: 1.285 Test Acc: 0.770
Validation loss decreased (-0.692578 --> -0.770358).  Saving model ...
Epoch: 7 cost time: 0.37283945083618164
Epoch: 7, Steps: 2 | Train Loss: 0.895 Vali Loss: 1.135 Vali Acc: 0.819 Test Loss: 1.135 Test Acc: 0.819
Validation loss decreased (-0.770358 --> -0.818507).  Saving model ...
Epoch: 8 cost time: 0.3905670642852783
Epoch: 8, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.990 Vali Acc: 0.859 Test Loss: 0.990 Test Acc: 0.859
Validation loss decreased (-0.818507 --> -0.859249).  Saving model ...
Epoch: 9 cost time: 0.37358593940734863
Epoch: 9, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.854 Vali Acc: 0.870 Test Loss: 0.854 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870362).  Saving model ...
Epoch: 10 cost time: 0.41487932205200195
Epoch: 10, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.732 Vali Acc: 0.885 Test Loss: 0.732 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 11 cost time: 0.43523144721984863
Epoch: 11, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.628 Vali Acc: 0.896 Test Loss: 0.628 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 12 cost time: 0.3588900566101074
Epoch: 12, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.540 Vali Acc: 0.911 Test Loss: 0.540 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911106).  Saving model ...
Epoch: 13 cost time: 0.36082005500793457
Epoch: 13, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.467 Vali Acc: 0.930 Test Loss: 0.467 Test Acc: 0.930
Validation loss decreased (-0.911106 --> -0.929625).  Saving model ...
Epoch: 14 cost time: 0.3753209114074707
Epoch: 14, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.409 Vali Acc: 0.933 Test Loss: 0.409 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 15 cost time: 0.4044792652130127
Epoch: 15, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 16 cost time: 0.3881864547729492
Epoch: 16, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.327 Vali Acc: 0.937 Test Loss: 0.327 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3975245952606201
Epoch: 17, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.3515007495880127
Epoch: 18, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.36080050468444824
Epoch: 19, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.39549875259399414
Epoch: 20, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.41672658920288086
Epoch: 21, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.37163829803466797
Epoch: 22, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.36684346199035645
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.34446048736572266
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.3510751724243164
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.3570718765258789
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.3812263011932373
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.445453405380249
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.39044976234436035
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.4196162223815918
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.36786460876464844
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.3593571186065674
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.34719276428222656
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.4628257751464844
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.5057942867279053
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.37245702743530273
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.42150282859802246
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.39222025871276855
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.3890573978424072
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.41453123092651367
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.37863945960998535
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.5040230751037598
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.36864757537841797
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.3828771114349365
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.42481255531311035
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.4341316223144531
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.3513004779815674
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.3714303970336914
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.3766446113586426
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.36002039909362793
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 350470
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7138047218322754
Epoch: 1, Steps: 2 | Train Loss: 1.942 Vali Loss: 1.881 Vali Acc: 0.126 Test Loss: 1.881 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.44206881523132324
Epoch: 2, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.834 Vali Acc: 0.215 Test Loss: 1.834 Test Acc: 0.215
Validation loss decreased (-0.125907 --> -0.214796).  Saving model ...
Epoch: 3 cost time: 0.43961334228515625
Epoch: 3, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.781 Vali Acc: 0.267 Test Loss: 1.781 Test Acc: 0.267
Validation loss decreased (-0.214796 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.4719688892364502
Epoch: 4, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.700 Vali Acc: 0.389 Test Loss: 1.700 Test Acc: 0.389
Validation loss decreased (-0.266649 --> -0.388872).  Saving model ...
Epoch: 5 cost time: 0.4075922966003418
Epoch: 5, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.591 Vali Acc: 0.581 Test Loss: 1.591 Test Acc: 0.581
Validation loss decreased (-0.388872 --> -0.581466).  Saving model ...
Epoch: 6 cost time: 0.41905808448791504
Epoch: 6, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.462 Vali Acc: 0.663 Test Loss: 1.462 Test Acc: 0.663
Validation loss decreased (-0.581466 --> -0.662948).  Saving model ...
Epoch: 7 cost time: 0.3794822692871094
Epoch: 7, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.319 Vali Acc: 0.722 Test Loss: 1.319 Test Acc: 0.722
Validation loss decreased (-0.662948 --> -0.722209).  Saving model ...
Epoch: 8 cost time: 0.43819093704223633
Epoch: 8, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.173 Vali Acc: 0.785 Test Loss: 1.173 Test Acc: 0.785
Validation loss decreased (-0.722209 --> -0.785173).  Saving model ...
Epoch: 9 cost time: 0.49002885818481445
Epoch: 9, Steps: 2 | Train Loss: 0.789 Vali Loss: 1.029 Vali Acc: 0.822 Test Loss: 1.029 Test Acc: 0.822
Validation loss decreased (-0.785173 --> -0.822212).  Saving model ...
Epoch: 10 cost time: 0.43847203254699707
Epoch: 10, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.893 Vali Acc: 0.859 Test Loss: 0.893 Test Acc: 0.859
Validation loss decreased (-0.822212 --> -0.859250).  Saving model ...
Epoch: 11 cost time: 0.4004194736480713
Epoch: 11, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.771 Vali Acc: 0.885 Test Loss: 0.771 Test Acc: 0.885
Validation loss decreased (-0.859250 --> -0.885177).  Saving model ...
Epoch: 12 cost time: 0.38384175300598145
Epoch: 12, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
Validation loss decreased (-0.885177 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.4191880226135254
Epoch: 13, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.576 Vali Acc: 0.911 Test Loss: 0.576 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911105).  Saving model ...
Epoch: 14 cost time: 0.4020986557006836
Epoch: 14, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.498 Vali Acc: 0.922 Test Loss: 0.498 Test Acc: 0.922
Validation loss decreased (-0.911105 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.39646100997924805
Epoch: 15, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.436 Vali Acc: 0.926 Test Loss: 0.436 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 16 cost time: 0.4257795810699463
Epoch: 16, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.385 Vali Acc: 0.933 Test Loss: 0.385 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933329).  Saving model ...
Epoch: 17 cost time: 0.4135408401489258
Epoch: 17, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 18 cost time: 0.406630277633667
Epoch: 18, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.312 Vali Acc: 0.948 Test Loss: 0.312 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 19 cost time: 0.3598954677581787
Epoch: 19, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 20 cost time: 0.4177870750427246
Epoch: 20, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4842817783355713
Epoch: 21, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.48043036460876465
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.38001489639282227
Epoch: 23, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.49965548515319824
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.40604519844055176
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.47429823875427246
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.4430532455444336
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.4863736629486084
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.43523526191711426
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.5044927597045898
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 31 cost time: 0.4409503936767578
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.476590633392334
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.39310550689697266
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.40759801864624023
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.42380785942077637
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.44287753105163574
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.43443775177001953
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.4384434223175049
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.45946550369262695
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.40705442428588867
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.41974902153015137
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.41013002395629883
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 43 cost time: 0.5153090953826904
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.5373754501342773
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.41623854637145996
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 46 cost time: 0.3820788860321045
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.49187612533569336
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.5171916484832764
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.40390443801879883
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.4486885070800781
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 335366
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4928090572357178
Epoch: 1, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.835 Vali Acc: 0.093 Test Loss: 1.835 Test Acc: 0.093
Validation loss decreased (inf --> -0.092574).  Saving model ...
Epoch: 2 cost time: 0.46015310287475586
Epoch: 2, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.791 Vali Acc: 0.167 Test Loss: 1.791 Test Acc: 0.167
Validation loss decreased (-0.092574 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.4251542091369629
Epoch: 3, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.743 Vali Acc: 0.215 Test Loss: 1.743 Test Acc: 0.215
Validation loss decreased (-0.166649 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.43585658073425293
Epoch: 4, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.676 Vali Acc: 0.333 Test Loss: 1.676 Test Acc: 0.333
Validation loss decreased (-0.214797 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.43744325637817383
Epoch: 5, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.586 Vali Acc: 0.522 Test Loss: 1.586 Test Acc: 0.522
Validation loss decreased (-0.333317 --> -0.522206).  Saving model ...
Epoch: 6 cost time: 0.37331104278564453
Epoch: 6, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.480 Vali Acc: 0.722 Test Loss: 1.480 Test Acc: 0.722
Validation loss decreased (-0.522206 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.390636682510376
Epoch: 7, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.363 Vali Acc: 0.830 Test Loss: 1.363 Test Acc: 0.830
Validation loss decreased (-0.722207 --> -0.829616).  Saving model ...
Epoch: 8 cost time: 0.3871433734893799
Epoch: 8, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.238 Vali Acc: 0.859 Test Loss: 1.238 Test Acc: 0.859
Validation loss decreased (-0.829616 --> -0.859247).  Saving model ...
Epoch: 9 cost time: 0.43052148818969727
Epoch: 9, Steps: 2 | Train Loss: 0.851 Vali Loss: 1.110 Vali Acc: 0.893 Test Loss: 1.110 Test Acc: 0.893
Validation loss decreased (-0.859247 --> -0.892581).  Saving model ...
Epoch: 10 cost time: 0.37821125984191895
Epoch: 10, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.984 Vali Acc: 0.911 Test Loss: 0.984 Test Acc: 0.911
Validation loss decreased (-0.892581 --> -0.911101).  Saving model ...
Epoch: 11 cost time: 0.3705565929412842
Epoch: 11, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.866 Vali Acc: 0.922 Test Loss: 0.866 Test Acc: 0.922
Validation loss decreased (-0.911101 --> -0.922214).  Saving model ...
Epoch: 12 cost time: 0.4041881561279297
Epoch: 12, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.759 Vali Acc: 0.930 Test Loss: 0.759 Test Acc: 0.930
Validation loss decreased (-0.922214 --> -0.929622).  Saving model ...
Epoch: 13 cost time: 0.469545841217041
Epoch: 13, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.664 Vali Acc: 0.933 Test Loss: 0.664 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933327).  Saving model ...
Epoch: 14 cost time: 0.4130544662475586
Epoch: 14, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.580 Vali Acc: 0.937 Test Loss: 0.580 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 15 cost time: 0.41328001022338867
Epoch: 15, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.512 Vali Acc: 0.941 Test Loss: 0.512 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940736).  Saving model ...
Epoch: 16 cost time: 0.44470715522766113
Epoch: 16, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.455 Vali Acc: 0.941 Test Loss: 0.455 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 17 cost time: 0.4068286418914795
Epoch: 17, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.409 Vali Acc: 0.952 Test Loss: 0.409 Test Acc: 0.952
Validation loss decreased (-0.940736 --> -0.951848).  Saving model ...
Epoch: 18 cost time: 0.4395594596862793
Epoch: 18, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.372 Vali Acc: 0.956 Test Loss: 0.372 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 19 cost time: 0.3938438892364502
Epoch: 19, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.343 Vali Acc: 0.956 Test Loss: 0.343 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 20 cost time: 0.3978266716003418
Epoch: 20, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.319 Vali Acc: 0.956 Test Loss: 0.319 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 21 cost time: 0.43498992919921875
Epoch: 21, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.299 Vali Acc: 0.959 Test Loss: 0.299 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 22 cost time: 0.37282729148864746
Epoch: 22, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.283 Vali Acc: 0.959 Test Loss: 0.283 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 23 cost time: 0.38548922538757324
Epoch: 23, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.270 Vali Acc: 0.959 Test Loss: 0.270 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 24 cost time: 0.40193915367126465
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.259 Vali Acc: 0.959 Test Loss: 0.259 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 25 cost time: 0.3902857303619385
Epoch: 25, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.250 Vali Acc: 0.959 Test Loss: 0.250 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 26 cost time: 0.4119265079498291
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.243 Vali Acc: 0.959 Test Loss: 0.243 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.40262794494628906
Epoch: 27, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.963 Test Loss: 0.236 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 28 cost time: 0.3662745952606201
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 29 cost time: 0.4344005584716797
Epoch: 29, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 30 cost time: 0.39696741104125977
Epoch: 30, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 31 cost time: 0.43317103385925293
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.963 Test Loss: 0.220 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 32 cost time: 0.4343256950378418
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.46260809898376465
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.963 Test Loss: 0.215 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 34 cost time: 0.5126070976257324
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 35 cost time: 0.4100914001464844
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 36 cost time: 0.3586142063140869
Epoch: 36, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 37 cost time: 0.46930813789367676
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 38 cost time: 0.4398832321166992
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.967 Test Loss: 0.208 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 39 cost time: 0.49666452407836914
Epoch: 39, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 40 cost time: 0.4035508632659912
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 41 cost time: 0.39010190963745117
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 42 cost time: 0.44475531578063965
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.3944222927093506
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.4036407470703125
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.4051699638366699
Epoch: 45, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.4506855010986328
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 47 cost time: 0.43637728691101074
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 48 cost time: 0.4087564945220947
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 49 cost time: 0.3789360523223877
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 50 cost time: 0.412273645401001
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 326534
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.523855209350586
Epoch: 1, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.687 Vali Acc: 0.367 Test Loss: 1.687 Test Acc: 0.367
Validation loss decreased (inf --> -0.366650).  Saving model ...
Epoch: 2 cost time: 0.3672308921813965
Epoch: 2, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.647 Vali Acc: 0.448 Test Loss: 1.647 Test Acc: 0.448
Validation loss decreased (-0.366650 --> -0.448132).  Saving model ...
Epoch: 3 cost time: 0.40732789039611816
Epoch: 3, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.607 Vali Acc: 0.522 Test Loss: 1.607 Test Acc: 0.522
Validation loss decreased (-0.448132 --> -0.522206).  Saving model ...
Epoch: 4 cost time: 0.4196205139160156
Epoch: 4, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.556 Vali Acc: 0.596 Test Loss: 1.556 Test Acc: 0.596
Validation loss decreased (-0.522206 --> -0.596281).  Saving model ...
Epoch: 5 cost time: 0.413938045501709
Epoch: 5, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.490 Vali Acc: 0.733 Test Loss: 1.490 Test Acc: 0.733
Validation loss decreased (-0.596281 --> -0.733318).  Saving model ...
Epoch: 6 cost time: 0.4466695785522461
Epoch: 6, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.411 Vali Acc: 0.815 Test Loss: 1.411 Test Acc: 0.815
Validation loss decreased (-0.733318 --> -0.814801).  Saving model ...
Epoch: 7 cost time: 0.424760103225708
Epoch: 7, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.322 Vali Acc: 0.863 Test Loss: 1.322 Test Acc: 0.863
Validation loss decreased (-0.814801 --> -0.862950).  Saving model ...
Epoch: 8 cost time: 0.5099437236785889
Epoch: 8, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.226 Vali Acc: 0.907 Test Loss: 1.226 Test Acc: 0.907
Validation loss decreased (-0.862950 --> -0.907395).  Saving model ...
Epoch: 9 cost time: 0.43184828758239746
Epoch: 9, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.127 Vali Acc: 0.919 Test Loss: 1.127 Test Acc: 0.919
Validation loss decreased (-0.907395 --> -0.918507).  Saving model ...
Epoch: 10 cost time: 0.457216739654541
Epoch: 10, Steps: 2 | Train Loss: 0.810 Vali Loss: 1.026 Vali Acc: 0.915 Test Loss: 1.026 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.46384382247924805
Epoch: 11, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.929 Vali Acc: 0.922 Test Loss: 0.929 Test Acc: 0.922
Validation loss decreased (-0.918507 --> -0.922213).  Saving model ...
Epoch: 12 cost time: 0.40003514289855957
Epoch: 12, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.836 Vali Acc: 0.922 Test Loss: 0.836 Test Acc: 0.922
Validation loss decreased (-0.922213 --> -0.922214).  Saving model ...
Epoch: 13 cost time: 0.48195528984069824
Epoch: 13, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.751 Vali Acc: 0.922 Test Loss: 0.751 Test Acc: 0.922
Validation loss decreased (-0.922214 --> -0.922215).  Saving model ...
Epoch: 14 cost time: 0.4256107807159424
Epoch: 14, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.674 Vali Acc: 0.926 Test Loss: 0.674 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 15 cost time: 0.43290209770202637
Epoch: 15, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.607 Vali Acc: 0.926 Test Loss: 0.607 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925920).  Saving model ...
Epoch: 16 cost time: 0.45787668228149414
Epoch: 16, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.549 Vali Acc: 0.933 Test Loss: 0.549 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 17 cost time: 0.4358823299407959
Epoch: 17, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.497 Vali Acc: 0.937 Test Loss: 0.497 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 18 cost time: 0.4060332775115967
Epoch: 18, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.454 Vali Acc: 0.941 Test Loss: 0.454 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 19 cost time: 0.3859107494354248
Epoch: 19, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.418 Vali Acc: 0.941 Test Loss: 0.418 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.3997373580932617
Epoch: 20, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.387 Vali Acc: 0.944 Test Loss: 0.387 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.4085264205932617
Epoch: 21, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.362 Vali Acc: 0.944 Test Loss: 0.362 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 22 cost time: 0.37484192848205566
Epoch: 22, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 23 cost time: 0.4388117790222168
Epoch: 23, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.39223742485046387
Epoch: 24, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.305 Vali Acc: 0.956 Test Loss: 0.305 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.4384584426879883
Epoch: 25, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.292 Vali Acc: 0.956 Test Loss: 0.292 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.4219181537628174
Epoch: 26, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.282 Vali Acc: 0.956 Test Loss: 0.282 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.41654276847839355
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.273 Vali Acc: 0.956 Test Loss: 0.273 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.4382059574127197
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.265 Vali Acc: 0.963 Test Loss: 0.265 Test Acc: 0.963
Validation loss decreased (-0.955553 --> -0.962960).  Saving model ...
Epoch: 29 cost time: 0.3811361789703369
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.258 Vali Acc: 0.963 Test Loss: 0.258 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 30 cost time: 0.41504526138305664
Epoch: 30, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 31 cost time: 0.3797264099121094
Epoch: 31, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.247 Vali Acc: 0.963 Test Loss: 0.247 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 32 cost time: 0.39624929428100586
Epoch: 32, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.243 Vali Acc: 0.963 Test Loss: 0.243 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.42420029640197754
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.239 Vali Acc: 0.959 Test Loss: 0.239 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.3634829521179199
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.236 Vali Acc: 0.959 Test Loss: 0.236 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.3881969451904297
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.40898895263671875
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.959 Test Loss: 0.231 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.36221837997436523
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.959 Test Loss: 0.229 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.37836694717407227
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.959 Test Loss: 0.227 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.3742091655731201
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.959 Test Loss: 0.225 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.409515380859375
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4273693561553955
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.4595358371734619
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 314630
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7821683883666992
Epoch: 1, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.798 Vali Acc: 0.230 Test Loss: 1.798 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.45192909240722656
Epoch: 2, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.773 Vali Acc: 0.270 Test Loss: 1.773 Test Acc: 0.270
Validation loss decreased (-0.229612 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.3630039691925049
Epoch: 3, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.748 Vali Acc: 0.300 Test Loss: 1.748 Test Acc: 0.300
Validation loss decreased (-0.270353 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.37717533111572266
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.714 Vali Acc: 0.341 Test Loss: 1.714 Test Acc: 0.341
Validation loss decreased (-0.299983 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.4163529872894287
Epoch: 5, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.668 Vali Acc: 0.378 Test Loss: 1.668 Test Acc: 0.378
Validation loss decreased (-0.340724 --> -0.377761).  Saving model ...
Epoch: 6 cost time: 0.3985917568206787
Epoch: 6, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.610 Vali Acc: 0.470 Test Loss: 1.610 Test Acc: 0.470
Validation loss decreased (-0.377761 --> -0.470354).  Saving model ...
Epoch: 7 cost time: 0.44558215141296387
Epoch: 7, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.543 Vali Acc: 0.559 Test Loss: 1.543 Test Acc: 0.559
Validation loss decreased (-0.470354 --> -0.559244).  Saving model ...
Epoch: 8 cost time: 0.4303750991821289
Epoch: 8, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.468 Vali Acc: 0.619 Test Loss: 1.468 Test Acc: 0.619
Validation loss decreased (-0.559244 --> -0.618504).  Saving model ...
Epoch: 9 cost time: 0.4152045249938965
Epoch: 9, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.386 Vali Acc: 0.656 Test Loss: 1.386 Test Acc: 0.656
Validation loss decreased (-0.618504 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 0.4100034236907959
Epoch: 10, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.300 Vali Acc: 0.719 Test Loss: 1.300 Test Acc: 0.719
Validation loss decreased (-0.655542 --> -0.718506).  Saving model ...
Epoch: 11 cost time: 0.3665754795074463
Epoch: 11, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.211 Vali Acc: 0.752 Test Loss: 1.211 Test Acc: 0.752
Validation loss decreased (-0.718506 --> -0.751840).  Saving model ...
Epoch: 12 cost time: 0.4624485969543457
Epoch: 12, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.122 Vali Acc: 0.785 Test Loss: 1.122 Test Acc: 0.785
Validation loss decreased (-0.751840 --> -0.785174).  Saving model ...
Epoch: 13 cost time: 0.46848297119140625
Epoch: 13, Steps: 2 | Train Loss: 0.844 Vali Loss: 1.034 Vali Acc: 0.833 Test Loss: 1.034 Test Acc: 0.833
Validation loss decreased (-0.785174 --> -0.833323).  Saving model ...
Epoch: 14 cost time: 0.3766944408416748
Epoch: 14, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.949 Vali Acc: 0.852 Test Loss: 0.949 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 15 cost time: 0.3920104503631592
Epoch: 15, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.869 Vali Acc: 0.867 Test Loss: 0.869 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866658).  Saving model ...
Epoch: 16 cost time: 0.4587421417236328
Epoch: 16, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.794 Vali Acc: 0.889 Test Loss: 0.794 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888881).  Saving model ...
Epoch: 17 cost time: 0.3592231273651123
Epoch: 17, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.726 Vali Acc: 0.904 Test Loss: 0.726 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903696).  Saving model ...
Epoch: 18 cost time: 0.43845486640930176
Epoch: 18, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.663 Vali Acc: 0.907 Test Loss: 0.663 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907401).  Saving model ...
Epoch: 19 cost time: 0.3473334312438965
Epoch: 19, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.606 Vali Acc: 0.922 Test Loss: 0.606 Test Acc: 0.922
Validation loss decreased (-0.907401 --> -0.922216).  Saving model ...
Epoch: 20 cost time: 0.4176805019378662
Epoch: 20, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.555 Vali Acc: 0.926 Test Loss: 0.555 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 21 cost time: 0.5585873126983643
Epoch: 21, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.511 Vali Acc: 0.941 Test Loss: 0.511 Test Acc: 0.941
Validation loss decreased (-0.925920 --> -0.940736).  Saving model ...
Epoch: 22 cost time: 0.4009127616882324
Epoch: 22, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.472 Vali Acc: 0.944 Test Loss: 0.472 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 23 cost time: 0.35339832305908203
Epoch: 23, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.438 Vali Acc: 0.944 Test Loss: 0.438 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 24 cost time: 0.3681952953338623
Epoch: 24, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.410 Vali Acc: 0.944 Test Loss: 0.410 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 25 cost time: 0.3778829574584961
Epoch: 25, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.385 Vali Acc: 0.948 Test Loss: 0.385 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 26 cost time: 0.38031864166259766
Epoch: 26, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.364 Vali Acc: 0.948 Test Loss: 0.364 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.46164512634277344
Epoch: 27, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.346 Vali Acc: 0.948 Test Loss: 0.346 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.46476149559020996
Epoch: 28, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.330 Vali Acc: 0.952 Test Loss: 0.330 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 29 cost time: 0.36603736877441406
Epoch: 29, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.317 Vali Acc: 0.952 Test Loss: 0.317 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.45416951179504395
Epoch: 30, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.305 Vali Acc: 0.952 Test Loss: 0.305 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.41241908073425293
Epoch: 31, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.3839280605316162
Epoch: 32, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.4025282859802246
Epoch: 33, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.41556406021118164
Epoch: 34, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.272 Vali Acc: 0.952 Test Loss: 0.272 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.39152979850769043
Epoch: 35, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.39691972732543945
Epoch: 36, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.39249300956726074
Epoch: 37, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.3533918857574463
Epoch: 38, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.3835911750793457
Epoch: 39, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.3464698791503906
Epoch: 40, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.3928842544555664
Epoch: 41, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.40535855293273926
Epoch: 42, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4997870922088623
Epoch: 43, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4006822109222412
Epoch: 44, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.43324708938598633
Epoch: 45, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.42911672592163086
Epoch: 46, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.37842488288879395
Epoch: 47, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.952 Test Loss: 0.227 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.4366283416748047
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.952 Test Loss: 0.225 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.4224214553833008
Epoch: 49, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.4422898292541504
Epoch: 50, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 308998
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5747992992401123
Epoch: 1, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.787 Vali Acc: 0.193 Test Loss: 1.787 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.3789234161376953
Epoch: 2, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.720 Vali Acc: 0.226 Test Loss: 1.720 Test Acc: 0.226
Validation loss decreased (-0.192575 --> -0.225909).  Saving model ...
Epoch: 3 cost time: 0.4653172492980957
Epoch: 3, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.632 Vali Acc: 0.293 Test Loss: 1.632 Test Acc: 0.293
Validation loss decreased (-0.225909 --> -0.292576).  Saving model ...
Epoch: 4 cost time: 0.43381738662719727
Epoch: 4, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.486 Vali Acc: 0.574 Test Loss: 1.486 Test Acc: 0.574
Validation loss decreased (-0.292576 --> -0.574059).  Saving model ...
Epoch: 5 cost time: 0.37569689750671387
Epoch: 5, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.306 Vali Acc: 0.730 Test Loss: 1.306 Test Acc: 0.730
Validation loss decreased (-0.574059 --> -0.729617).  Saving model ...
Epoch: 6 cost time: 0.4435310363769531
Epoch: 6, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.118 Vali Acc: 0.826 Test Loss: 1.118 Test Acc: 0.826
Validation loss decreased (-0.729617 --> -0.825915).  Saving model ...
Epoch: 7 cost time: 0.37960171699523926
Epoch: 7, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.940 Vali Acc: 0.867 Test Loss: 0.940 Test Acc: 0.867
Validation loss decreased (-0.825915 --> -0.866657).  Saving model ...
Epoch: 8 cost time: 0.3729701042175293
Epoch: 8, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.784 Vali Acc: 0.878 Test Loss: 0.784 Test Acc: 0.878
Validation loss decreased (-0.866657 --> -0.877770).  Saving model ...
Epoch: 9 cost time: 0.4574260711669922
Epoch: 9, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.650 Vali Acc: 0.904 Test Loss: 0.650 Test Acc: 0.904
Validation loss decreased (-0.877770 --> -0.903697).  Saving model ...
Epoch: 10 cost time: 0.4024224281311035
Epoch: 10, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.536 Vali Acc: 0.915 Test Loss: 0.536 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914809).  Saving model ...
Epoch: 11 cost time: 0.5193493366241455
Epoch: 11, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.444 Vali Acc: 0.922 Test Loss: 0.444 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922218).  Saving model ...
Epoch: 12 cost time: 0.37964940071105957
Epoch: 12, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.374 Vali Acc: 0.926 Test Loss: 0.374 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 13 cost time: 0.39352846145629883
Epoch: 13, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 14 cost time: 0.4175095558166504
Epoch: 14, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 0.36765003204345703
Epoch: 15, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.37724947929382324
Epoch: 16, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.3963167667388916
Epoch: 17, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.38027381896972656
Epoch: 18, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4428398609161377
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.39453816413879395
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.38346362113952637
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.3742072582244873
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.4204084873199463
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.3954660892486572
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.38840723037719727
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.4054701328277588
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.4344906806945801
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.4139406681060791
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.4266974925994873
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.3888118267059326
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.4200561046600342
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.4017348289489746
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.4338104724884033
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.3841416835784912
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.36882519721984863
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.4296233654022217
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.3498382568359375
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.4281637668609619
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.3833744525909424
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.4391005039215088
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.4321904182434082
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.40487098693847656
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.3821747303009033
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4014725685119629
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.43628931045532227
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.4040226936340332
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4909844398498535
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.382749080657959
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.3987390995025635
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.36263179779052734
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 177094
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5179367065429688
Epoch: 1, Steps: 2 | Train Loss: 2.091 Vali Loss: 1.898 Vali Acc: 0.030 Test Loss: 1.898 Test Acc: 0.030
Validation loss decreased (inf --> -0.029611).  Saving model ...
Epoch: 2 cost time: 0.37906694412231445
Epoch: 2, Steps: 2 | Train Loss: 1.979 Vali Loss: 1.855 Vali Acc: 0.048 Test Loss: 1.855 Test Acc: 0.048
Validation loss decreased (-0.029611 --> -0.048130).  Saving model ...
Epoch: 3 cost time: 0.48470067977905273
Epoch: 3, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.804 Vali Acc: 0.115 Test Loss: 1.804 Test Acc: 0.115
Validation loss decreased (-0.048130 --> -0.114797).  Saving model ...
Epoch: 4 cost time: 0.3968191146850586
Epoch: 4, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.724 Vali Acc: 0.319 Test Loss: 1.724 Test Acc: 0.319
Validation loss decreased (-0.114797 --> -0.318501).  Saving model ...
Epoch: 5 cost time: 0.5049004554748535
Epoch: 5, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.618 Vali Acc: 0.474 Test Loss: 1.618 Test Acc: 0.474
Validation loss decreased (-0.318501 --> -0.474058).  Saving model ...
Epoch: 6 cost time: 0.49874305725097656
Epoch: 6, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.492 Vali Acc: 0.585 Test Loss: 1.492 Test Acc: 0.585
Validation loss decreased (-0.474058 --> -0.585170).  Saving model ...
Epoch: 7 cost time: 0.40384745597839355
Epoch: 7, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.356 Vali Acc: 0.674 Test Loss: 1.356 Test Acc: 0.674
Validation loss decreased (-0.585170 --> -0.674061).  Saving model ...
Epoch: 8 cost time: 0.38776659965515137
Epoch: 8, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.215 Vali Acc: 0.756 Test Loss: 1.215 Test Acc: 0.756
Validation loss decreased (-0.674061 --> -0.755543).  Saving model ...
Epoch: 9 cost time: 0.35532164573669434
Epoch: 9, Steps: 2 | Train Loss: 0.798 Vali Loss: 1.076 Vali Acc: 0.819 Test Loss: 1.076 Test Acc: 0.819
Validation loss decreased (-0.755543 --> -0.818508).  Saving model ...
Epoch: 10 cost time: 0.3999917507171631
Epoch: 10, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.944 Vali Acc: 0.852 Test Loss: 0.944 Test Acc: 0.852
Validation loss decreased (-0.818508 --> -0.851842).  Saving model ...
Epoch: 11 cost time: 0.4123497009277344
Epoch: 11, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.824 Vali Acc: 0.870 Test Loss: 0.824 Test Acc: 0.870
Validation loss decreased (-0.851842 --> -0.870362).  Saving model ...
Epoch: 12 cost time: 0.4044528007507324
Epoch: 12, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.718 Vali Acc: 0.878 Test Loss: 0.718 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877771).  Saving model ...
Epoch: 13 cost time: 0.40413999557495117
Epoch: 13, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.626 Vali Acc: 0.893 Test Loss: 0.626 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892586).  Saving model ...
Epoch: 14 cost time: 0.4477710723876953
Epoch: 14, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.548 Vali Acc: 0.904 Test Loss: 0.548 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903698).  Saving model ...
Epoch: 15 cost time: 0.45563650131225586
Epoch: 15, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.483 Vali Acc: 0.911 Test Loss: 0.483 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 16 cost time: 0.42363476753234863
Epoch: 16, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.431 Vali Acc: 0.911 Test Loss: 0.431 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 17 cost time: 0.4020884037017822
Epoch: 17, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.388 Vali Acc: 0.919 Test Loss: 0.388 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 18 cost time: 0.4559335708618164
Epoch: 18, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 19 cost time: 0.5285260677337646
Epoch: 19, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.327 Vali Acc: 0.926 Test Loss: 0.327 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 20 cost time: 0.47322583198547363
Epoch: 20, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.4297502040863037
Epoch: 21, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.3790316581726074
Epoch: 22, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.42497897148132324
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.3792581558227539
Epoch: 24, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.43711113929748535
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 26 cost time: 0.4213740825653076
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.4455864429473877
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.4288675785064697
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.4811673164367676
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.44548797607421875
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.4266517162322998
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.3853902816772461
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.530498743057251
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.4243769645690918
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.41598939895629883
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.419569730758667
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.441408634185791
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.38437581062316895
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.5175881385803223
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.42768001556396484
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.44138622283935547
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.4643557071685791
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.41567492485046387
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.39304137229919434
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.4185791015625
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.4310734272003174
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.44774436950683594
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.44846343994140625
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 0.41095590591430664
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.40528321266174316
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 126534
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5653445720672607
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.828 Vali Acc: 0.081 Test Loss: 1.828 Test Acc: 0.081
Validation loss decreased (inf --> -0.081463).  Saving model ...
Epoch: 2 cost time: 0.39905381202697754
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.782 Vali Acc: 0.144 Test Loss: 1.782 Test Acc: 0.144
Validation loss decreased (-0.081463 --> -0.144427).  Saving model ...
Epoch: 3 cost time: 0.36177849769592285
Epoch: 3, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.737 Vali Acc: 0.244 Test Loss: 1.737 Test Acc: 0.244
Validation loss decreased (-0.144427 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.3915073871612549
Epoch: 4, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.678 Vali Acc: 0.363 Test Loss: 1.678 Test Acc: 0.363
Validation loss decreased (-0.244427 --> -0.362946).  Saving model ...
Epoch: 5 cost time: 0.34731221199035645
Epoch: 5, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.604 Vali Acc: 0.470 Test Loss: 1.604 Test Acc: 0.470
Validation loss decreased (-0.362946 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.37609124183654785
Epoch: 6, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.515 Vali Acc: 0.604 Test Loss: 1.515 Test Acc: 0.604
Validation loss decreased (-0.470354 --> -0.603689).  Saving model ...
Epoch: 7 cost time: 0.35244226455688477
Epoch: 7, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.415 Vali Acc: 0.670 Test Loss: 1.415 Test Acc: 0.670
Validation loss decreased (-0.603689 --> -0.670356).  Saving model ...
Epoch: 8 cost time: 0.38533711433410645
Epoch: 8, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.311 Vali Acc: 0.737 Test Loss: 1.311 Test Acc: 0.737
Validation loss decreased (-0.670356 --> -0.737024).  Saving model ...
Epoch: 9 cost time: 0.34713315963745117
Epoch: 9, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.205 Vali Acc: 0.767 Test Loss: 1.205 Test Acc: 0.767
Validation loss decreased (-0.737024 --> -0.766655).  Saving model ...
Epoch: 10 cost time: 0.3250598907470703
Epoch: 10, Steps: 2 | Train Loss: 0.830 Vali Loss: 1.100 Vali Acc: 0.811 Test Loss: 1.100 Test Acc: 0.811
Validation loss decreased (-0.766655 --> -0.811100).  Saving model ...
Epoch: 11 cost time: 0.3508613109588623
Epoch: 11, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.998 Vali Acc: 0.837 Test Loss: 0.998 Test Acc: 0.837
Validation loss decreased (-0.811100 --> -0.837027).  Saving model ...
Epoch: 12 cost time: 0.41615915298461914
Epoch: 12, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.903 Vali Acc: 0.856 Test Loss: 0.903 Test Acc: 0.856
Validation loss decreased (-0.837027 --> -0.855547).  Saving model ...
Epoch: 13 cost time: 0.36078429222106934
Epoch: 13, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.815 Vali Acc: 0.867 Test Loss: 0.815 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866659).  Saving model ...
Epoch: 14 cost time: 0.3683357238769531
Epoch: 14, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.735 Vali Acc: 0.870 Test Loss: 0.735 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 15 cost time: 0.35556650161743164
Epoch: 15, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.663 Vali Acc: 0.874 Test Loss: 0.663 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 16 cost time: 0.36722373962402344
Epoch: 16, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.599 Vali Acc: 0.889 Test Loss: 0.599 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888883).  Saving model ...
Epoch: 17 cost time: 0.3855936527252197
Epoch: 17, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.545 Vali Acc: 0.893 Test Loss: 0.545 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 18 cost time: 0.3545804023742676
Epoch: 18, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.3540201187133789
Epoch: 19, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.460 Vali Acc: 0.919 Test Loss: 0.460 Test Acc: 0.919
Validation loss decreased (-0.899995 --> -0.918514).  Saving model ...
Epoch: 20 cost time: 0.36540651321411133
Epoch: 20, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.427 Vali Acc: 0.922 Test Loss: 0.427 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.35539674758911133
Epoch: 21, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.399 Vali Acc: 0.922 Test Loss: 0.399 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 22 cost time: 0.3536076545715332
Epoch: 22, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.375 Vali Acc: 0.926 Test Loss: 0.375 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.4300673007965088
Epoch: 23, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 24 cost time: 0.3640298843383789
Epoch: 24, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.338 Vali Acc: 0.930 Test Loss: 0.338 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 25 cost time: 0.38397836685180664
Epoch: 25, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 26 cost time: 0.40947675704956055
Epoch: 26, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.38190269470214844
Epoch: 27, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.47717809677124023
Epoch: 28, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.37398815155029297
Epoch: 29, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.35192370414733887
Epoch: 30, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.3344235420227051
Epoch: 31, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.3446202278137207
Epoch: 32, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.37114453315734863
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.35889172554016113
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.45108509063720703
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.351315975189209
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.35570859909057617
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.370044469833374
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3767201900482178
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.3630862236022949
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.3941948413848877
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.44278788566589355
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.390286922454834
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.37190675735473633
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.35409998893737793
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.40000462532043457
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.38087987899780273
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.32105588912963867
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.38460850715637207
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.3513834476470947
Epoch: 50, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 109702
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5045721530914307
Epoch: 1, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.891 Vali Acc: 0.159 Test Loss: 1.891 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.3816254138946533
Epoch: 2, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.860 Vali Acc: 0.189 Test Loss: 1.860 Test Acc: 0.189
Validation loss decreased (-0.159240 --> -0.188870).  Saving model ...
Epoch: 3 cost time: 0.3617401123046875
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.830 Vali Acc: 0.230 Test Loss: 1.830 Test Acc: 0.230
Validation loss decreased (-0.188870 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 0.4151144027709961
Epoch: 4, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.788 Vali Acc: 0.274 Test Loss: 1.788 Test Acc: 0.274
Validation loss decreased (-0.229611 --> -0.274056).  Saving model ...
Epoch: 5 cost time: 0.406740665435791
Epoch: 5, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.733 Vali Acc: 0.330 Test Loss: 1.733 Test Acc: 0.330
Validation loss decreased (-0.274056 --> -0.329612).  Saving model ...
Epoch: 6 cost time: 0.3912620544433594
Epoch: 6, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.666 Vali Acc: 0.500 Test Loss: 1.666 Test Acc: 0.500
Validation loss decreased (-0.329612 --> -0.499983).  Saving model ...
Epoch: 7 cost time: 0.3354945182800293
Epoch: 7, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.588 Vali Acc: 0.578 Test Loss: 1.588 Test Acc: 0.578
Validation loss decreased (-0.499983 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.33814024925231934
Epoch: 8, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.500 Vali Acc: 0.619 Test Loss: 1.500 Test Acc: 0.619
Validation loss decreased (-0.577762 --> -0.618504).  Saving model ...
Epoch: 9 cost time: 0.38092899322509766
Epoch: 9, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.403 Vali Acc: 0.663 Test Loss: 1.403 Test Acc: 0.663
Validation loss decreased (-0.618504 --> -0.662949).  Saving model ...
Epoch: 10 cost time: 0.3355262279510498
Epoch: 10, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.301 Vali Acc: 0.700 Test Loss: 1.301 Test Acc: 0.700
Validation loss decreased (-0.662949 --> -0.699987).  Saving model ...
Epoch: 11 cost time: 0.37195849418640137
Epoch: 11, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.197 Vali Acc: 0.752 Test Loss: 1.197 Test Acc: 0.752
Validation loss decreased (-0.699987 --> -0.751840).  Saving model ...
Epoch: 12 cost time: 0.36243605613708496
Epoch: 12, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.096 Vali Acc: 0.796 Test Loss: 1.096 Test Acc: 0.796
Validation loss decreased (-0.751840 --> -0.796285).  Saving model ...
Epoch: 13 cost time: 0.39438319206237793
Epoch: 13, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.999 Vali Acc: 0.811 Test Loss: 0.999 Test Acc: 0.811
Validation loss decreased (-0.796285 --> -0.811101).  Saving model ...
Epoch: 14 cost time: 0.4305591583251953
Epoch: 14, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.909 Vali Acc: 0.856 Test Loss: 0.909 Test Acc: 0.856
Validation loss decreased (-0.811101 --> -0.855546).  Saving model ...
Epoch: 15 cost time: 0.3995683193206787
Epoch: 15, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.824 Vali Acc: 0.870 Test Loss: 0.824 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870362).  Saving model ...
Epoch: 16 cost time: 0.40163469314575195
Epoch: 16, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.746 Vali Acc: 0.900 Test Loss: 0.746 Test Acc: 0.900
Validation loss decreased (-0.870362 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.3467895984649658
Epoch: 17, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.676 Vali Acc: 0.904 Test Loss: 0.676 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 18 cost time: 0.3499000072479248
Epoch: 18, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.615 Vali Acc: 0.930 Test Loss: 0.615 Test Acc: 0.930
Validation loss decreased (-0.903697 --> -0.929623).  Saving model ...
Epoch: 19 cost time: 0.4014549255371094
Epoch: 19, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.561 Vali Acc: 0.933 Test Loss: 0.561 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933328).  Saving model ...
Epoch: 20 cost time: 0.43645572662353516
Epoch: 20, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.513 Vali Acc: 0.941 Test Loss: 0.513 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 21 cost time: 0.3668484687805176
Epoch: 21, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.471 Vali Acc: 0.941 Test Loss: 0.471 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 22 cost time: 0.4079146385192871
Epoch: 22, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.435 Vali Acc: 0.944 Test Loss: 0.435 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 23 cost time: 0.38346314430236816
Epoch: 23, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.405 Vali Acc: 0.944 Test Loss: 0.405 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 24 cost time: 0.3588588237762451
Epoch: 24, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.379 Vali Acc: 0.944 Test Loss: 0.379 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 25 cost time: 0.3452792167663574
Epoch: 25, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.357 Vali Acc: 0.944 Test Loss: 0.357 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 0.39466166496276855
Epoch: 26, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.339 Vali Acc: 0.952 Test Loss: 0.339 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 27 cost time: 0.35220980644226074
Epoch: 27, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.323 Vali Acc: 0.952 Test Loss: 0.323 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 28 cost time: 0.4102137088775635
Epoch: 28, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 29 cost time: 0.3905034065246582
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.299 Vali Acc: 0.952 Test Loss: 0.299 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.3691215515136719
Epoch: 30, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.290 Vali Acc: 0.952 Test Loss: 0.290 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.3729422092437744
Epoch: 31, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.282 Vali Acc: 0.952 Test Loss: 0.282 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.38375115394592285
Epoch: 32, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.275 Vali Acc: 0.952 Test Loss: 0.275 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.3827950954437256
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.269 Vali Acc: 0.952 Test Loss: 0.269 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.36980319023132324
Epoch: 34, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.264 Vali Acc: 0.952 Test Loss: 0.264 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.3894932270050049
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.260 Vali Acc: 0.956 Test Loss: 0.260 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.33371901512145996
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.3757193088531494
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.46309995651245117
Epoch: 38, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.37459516525268555
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.3445403575897217
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.3782024383544922
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.956 Test Loss: 0.237 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.3788583278656006
Epoch: 42, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.956 Test Loss: 0.234 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.4146733283996582
Epoch: 43, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
Validation loss decreased (-0.955553 --> -0.962961).  Saving model ...
Epoch: 44 cost time: 0.3834724426269531
Epoch: 44, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.963 Test Loss: 0.229 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 45 cost time: 0.3819119930267334
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 46 cost time: 0.3454630374908447
Epoch: 46, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 47 cost time: 0.34427785873413086
Epoch: 47, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 48 cost time: 0.35825657844543457
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 49 cost time: 0.3543241024017334
Epoch: 49, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.963 Test Loss: 0.220 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 50 cost time: 0.47811245918273926
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 102150
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6208949089050293
Epoch: 1, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.774 Vali Acc: 0.096 Test Loss: 1.774 Test Acc: 0.096
Validation loss decreased (inf --> -0.096279).  Saving model ...
Epoch: 2 cost time: 0.37215566635131836
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.748 Vali Acc: 0.119 Test Loss: 1.748 Test Acc: 0.119
Validation loss decreased (-0.096279 --> -0.118501).  Saving model ...
Epoch: 3 cost time: 0.3778953552246094
Epoch: 3, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.723 Vali Acc: 0.178 Test Loss: 1.723 Test Acc: 0.178
Validation loss decreased (-0.118501 --> -0.177761).  Saving model ...
Epoch: 4 cost time: 0.37343907356262207
Epoch: 4, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.692 Vali Acc: 0.207 Test Loss: 1.692 Test Acc: 0.207
Validation loss decreased (-0.177761 --> -0.207390).  Saving model ...
Epoch: 5 cost time: 0.359130859375
Epoch: 5, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.649 Vali Acc: 0.263 Test Loss: 1.649 Test Acc: 0.263
Validation loss decreased (-0.207390 --> -0.262946).  Saving model ...
Epoch: 6 cost time: 0.37999796867370605
Epoch: 6, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.596 Vali Acc: 0.363 Test Loss: 1.596 Test Acc: 0.363
Validation loss decreased (-0.262946 --> -0.362947).  Saving model ...
Epoch: 7 cost time: 0.387265682220459
Epoch: 7, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.534 Vali Acc: 0.493 Test Loss: 1.534 Test Acc: 0.493
Validation loss decreased (-0.362947 --> -0.492577).  Saving model ...
Epoch: 8 cost time: 0.35311341285705566
Epoch: 8, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.464 Vali Acc: 0.644 Test Loss: 1.464 Test Acc: 0.644
Validation loss decreased (-0.492577 --> -0.644430).  Saving model ...
Epoch: 9 cost time: 0.4353313446044922
Epoch: 9, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.387 Vali Acc: 0.726 Test Loss: 1.387 Test Acc: 0.726
Validation loss decreased (-0.644430 --> -0.725912).  Saving model ...
Epoch: 10 cost time: 0.38668298721313477
Epoch: 10, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.306 Vali Acc: 0.759 Test Loss: 1.306 Test Acc: 0.759
Validation loss decreased (-0.725912 --> -0.759246).  Saving model ...
Epoch: 11 cost time: 0.3670494556427002
Epoch: 11, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.222 Vali Acc: 0.807 Test Loss: 1.222 Test Acc: 0.807
Validation loss decreased (-0.759246 --> -0.807395).  Saving model ...
Epoch: 12 cost time: 0.38306212425231934
Epoch: 12, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.137 Vali Acc: 0.830 Test Loss: 1.137 Test Acc: 0.830
Validation loss decreased (-0.807395 --> -0.829618).  Saving model ...
Epoch: 13 cost time: 0.3493344783782959
Epoch: 13, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.053 Vali Acc: 0.859 Test Loss: 1.053 Test Acc: 0.859
Validation loss decreased (-0.829618 --> -0.859249).  Saving model ...
Epoch: 14 cost time: 0.4341239929199219
Epoch: 14, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.970 Vali Acc: 0.878 Test Loss: 0.970 Test Acc: 0.878
Validation loss decreased (-0.859249 --> -0.877768).  Saving model ...
Epoch: 15 cost time: 0.4033620357513428
Epoch: 15, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.890 Vali Acc: 0.889 Test Loss: 0.890 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888880).  Saving model ...
Epoch: 16 cost time: 0.3876345157623291
Epoch: 16, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.816 Vali Acc: 0.911 Test Loss: 0.816 Test Acc: 0.911
Validation loss decreased (-0.888880 --> -0.911103).  Saving model ...
Epoch: 17 cost time: 0.36829495429992676
Epoch: 17, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.748 Vali Acc: 0.915 Test Loss: 0.748 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 18 cost time: 0.4115898609161377
Epoch: 18, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.685 Vali Acc: 0.926 Test Loss: 0.685 Test Acc: 0.926
Validation loss decreased (-0.914807 --> -0.925919).  Saving model ...
Epoch: 19 cost time: 0.35281991958618164
Epoch: 19, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.626 Vali Acc: 0.933 Test Loss: 0.626 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 20 cost time: 0.40381765365600586
Epoch: 20, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.575 Vali Acc: 0.930 Test Loss: 0.575 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.35353732109069824
Epoch: 21, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.529 Vali Acc: 0.930 Test Loss: 0.529 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.41069459915161133
Epoch: 22, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.487 Vali Acc: 0.937 Test Loss: 0.487 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937032).  Saving model ...
Epoch: 23 cost time: 0.3671603202819824
Epoch: 23, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.452 Vali Acc: 0.937 Test Loss: 0.452 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 24 cost time: 0.4417886734008789
Epoch: 24, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.422 Vali Acc: 0.933 Test Loss: 0.422 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.40293145179748535
Epoch: 25, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.396 Vali Acc: 0.933 Test Loss: 0.396 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.37573933601379395
Epoch: 26, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.43543577194213867
Epoch: 27, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.353 Vali Acc: 0.937 Test Loss: 0.353 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.41887903213500977
Epoch: 28, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 29 cost time: 0.36774682998657227
Epoch: 29, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.4072265625
Epoch: 30, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 31 cost time: 0.3998079299926758
Epoch: 31, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.300 Vali Acc: 0.948 Test Loss: 0.300 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.41586804389953613
Epoch: 32, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.3960421085357666
Epoch: 33, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.282 Vali Acc: 0.952 Test Loss: 0.282 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.36104679107666016
Epoch: 34, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.276 Vali Acc: 0.952 Test Loss: 0.276 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.40181851387023926
Epoch: 35, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.270 Vali Acc: 0.952 Test Loss: 0.270 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.39184093475341797
Epoch: 36, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.952 Test Loss: 0.265 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.4158499240875244
Epoch: 37, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.260 Vali Acc: 0.952 Test Loss: 0.260 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.38297581672668457
Epoch: 38, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.256 Vali Acc: 0.952 Test Loss: 0.256 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.36005616188049316
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.42187952995300293
Epoch: 40, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.36471104621887207
Epoch: 41, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.4048192501068115
Epoch: 42, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.3685317039489746
Epoch: 43, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.3787820339202881
Epoch: 44, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.237 Vali Acc: 0.956 Test Loss: 0.237 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.3536975383758545
Epoch: 45, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.41562914848327637
Epoch: 46, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.39052462577819824
Epoch: 47, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.956 Test Loss: 0.230 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.38262248039245605
Epoch: 48, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.42566561698913574
Epoch: 49, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.4182407855987549
Epoch: 50, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 97734
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.587873935699463
Epoch: 1, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.778 Vali Acc: 0.219 Test Loss: 1.778 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.35521554946899414
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.753 Vali Acc: 0.296 Test Loss: 1.753 Test Acc: 0.296
Validation loss decreased (-0.218501 --> -0.296279).  Saving model ...
Epoch: 3 cost time: 0.36677074432373047
Epoch: 3, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.732 Vali Acc: 0.352 Test Loss: 1.732 Test Acc: 0.352
Validation loss decreased (-0.296279 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.3578047752380371
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.709 Vali Acc: 0.393 Test Loss: 1.709 Test Acc: 0.393
Validation loss decreased (-0.351835 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.40722060203552246
Epoch: 5, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.677 Vali Acc: 0.444 Test Loss: 1.677 Test Acc: 0.444
Validation loss decreased (-0.392576 --> -0.444428).  Saving model ...
Epoch: 6 cost time: 0.38744258880615234
Epoch: 6, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.639 Vali Acc: 0.478 Test Loss: 1.639 Test Acc: 0.478
Validation loss decreased (-0.444428 --> -0.477761).  Saving model ...
Epoch: 7 cost time: 0.33301258087158203
Epoch: 7, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.594 Vali Acc: 0.519 Test Loss: 1.594 Test Acc: 0.519
Validation loss decreased (-0.477761 --> -0.518503).  Saving model ...
Epoch: 8 cost time: 0.3511948585510254
Epoch: 8, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.544 Vali Acc: 0.563 Test Loss: 1.544 Test Acc: 0.563
Validation loss decreased (-0.518503 --> -0.562948).  Saving model ...
Epoch: 9 cost time: 0.3508927822113037
Epoch: 9, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.488 Vali Acc: 0.567 Test Loss: 1.488 Test Acc: 0.567
Validation loss decreased (-0.562948 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.3300299644470215
Epoch: 10, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.429 Vali Acc: 0.589 Test Loss: 1.429 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.3976917266845703
Epoch: 11, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.367 Vali Acc: 0.622 Test Loss: 1.367 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622209).  Saving model ...
Epoch: 12 cost time: 0.377819299697876
Epoch: 12, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.303 Vali Acc: 0.685 Test Loss: 1.303 Test Acc: 0.685
Validation loss decreased (-0.622209 --> -0.685172).  Saving model ...
Epoch: 13 cost time: 0.3524932861328125
Epoch: 13, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.238 Vali Acc: 0.733 Test Loss: 1.238 Test Acc: 0.733
Validation loss decreased (-0.685172 --> -0.733321).  Saving model ...
Epoch: 14 cost time: 0.3817555904388428
Epoch: 14, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.172 Vali Acc: 0.778 Test Loss: 1.172 Test Acc: 0.778
Validation loss decreased (-0.733321 --> -0.777766).  Saving model ...
Epoch: 15 cost time: 0.4023876190185547
Epoch: 15, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.107 Vali Acc: 0.815 Test Loss: 1.107 Test Acc: 0.815
Validation loss decreased (-0.777766 --> -0.814804).  Saving model ...
Epoch: 16 cost time: 0.3627448081970215
Epoch: 16, Steps: 2 | Train Loss: 0.883 Vali Loss: 1.044 Vali Acc: 0.830 Test Loss: 1.044 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829619).  Saving model ...
Epoch: 17 cost time: 0.37401270866394043
Epoch: 17, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.982 Vali Acc: 0.856 Test Loss: 0.982 Test Acc: 0.856
Validation loss decreased (-0.829619 --> -0.855546).  Saving model ...
Epoch: 18 cost time: 0.4035356044769287
Epoch: 18, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.922 Vali Acc: 0.870 Test Loss: 0.922 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870361).  Saving model ...
Epoch: 19 cost time: 0.35117554664611816
Epoch: 19, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.865 Vali Acc: 0.874 Test Loss: 0.865 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 20 cost time: 0.3601229190826416
Epoch: 20, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.811 Vali Acc: 0.889 Test Loss: 0.811 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888881).  Saving model ...
Epoch: 21 cost time: 0.4618265628814697
Epoch: 21, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.759 Vali Acc: 0.904 Test Loss: 0.759 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903696).  Saving model ...
Epoch: 22 cost time: 0.35666942596435547
Epoch: 22, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.711 Vali Acc: 0.911 Test Loss: 0.711 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 23 cost time: 0.37130260467529297
Epoch: 23, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.666 Vali Acc: 0.915 Test Loss: 0.666 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 24 cost time: 0.3597714900970459
Epoch: 24, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.624 Vali Acc: 0.915 Test Loss: 0.624 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 25 cost time: 0.37789106369018555
Epoch: 25, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.587 Vali Acc: 0.922 Test Loss: 0.587 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922216).  Saving model ...
Epoch: 26 cost time: 0.39946484565734863
Epoch: 26, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.552 Vali Acc: 0.922 Test Loss: 0.552 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 27 cost time: 0.3458669185638428
Epoch: 27, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.522 Vali Acc: 0.926 Test Loss: 0.522 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 0.3848097324371338
Epoch: 28, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.495 Vali Acc: 0.937 Test Loss: 0.495 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937032).  Saving model ...
Epoch: 29 cost time: 0.5680685043334961
Epoch: 29, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.470 Vali Acc: 0.941 Test Loss: 0.470 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 30 cost time: 0.37160682678222656
Epoch: 30, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.448 Vali Acc: 0.941 Test Loss: 0.448 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 31 cost time: 0.40660858154296875
Epoch: 31, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.428 Vali Acc: 0.941 Test Loss: 0.428 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 32 cost time: 0.38784241676330566
Epoch: 32, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.410 Vali Acc: 0.941 Test Loss: 0.410 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 33 cost time: 0.355344295501709
Epoch: 33, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.395 Vali Acc: 0.941 Test Loss: 0.395 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 34 cost time: 0.4587891101837158
Epoch: 34, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.381 Vali Acc: 0.944 Test Loss: 0.381 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 35 cost time: 0.34972286224365234
Epoch: 35, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.39447474479675293
Epoch: 36, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.358 Vali Acc: 0.944 Test Loss: 0.358 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.3701133728027344
Epoch: 37, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.348 Vali Acc: 0.948 Test Loss: 0.348 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.4773228168487549
Epoch: 38, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.339 Vali Acc: 0.948 Test Loss: 0.339 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 39 cost time: 0.3399817943572998
Epoch: 39, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.330 Vali Acc: 0.948 Test Loss: 0.330 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 40 cost time: 0.40094947814941406
Epoch: 40, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.323 Vali Acc: 0.948 Test Loss: 0.323 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 41 cost time: 0.38582491874694824
Epoch: 41, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.316 Vali Acc: 0.952 Test Loss: 0.316 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.3657824993133545
Epoch: 42, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.4173398017883301
Epoch: 43, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.304 Vali Acc: 0.952 Test Loss: 0.304 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.3472867012023926
Epoch: 44, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.299 Vali Acc: 0.952 Test Loss: 0.299 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 45 cost time: 0.37812256813049316
Epoch: 45, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.295 Vali Acc: 0.952 Test Loss: 0.295 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 46 cost time: 0.42603278160095215
Epoch: 46, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.290 Vali Acc: 0.952 Test Loss: 0.290 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 47 cost time: 0.4369988441467285
Epoch: 47, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4462916851043701
Epoch: 48, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.283 Vali Acc: 0.948 Test Loss: 0.283 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.3894186019897461
Epoch: 49, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.40070509910583496
Epoch: 50, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.277 Vali Acc: 0.948 Test Loss: 0.277 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 91782
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6490254402160645
Epoch: 1, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.764 Vali Acc: 0.244 Test Loss: 1.764 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.4479331970214844
Epoch: 2, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.747 Vali Acc: 0.278 Test Loss: 1.747 Test Acc: 0.278
Validation loss decreased (-0.244427 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.34258174896240234
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.732 Vali Acc: 0.293 Test Loss: 1.732 Test Acc: 0.293
Validation loss decreased (-0.277760 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.3648955821990967
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.717 Vali Acc: 0.319 Test Loss: 1.717 Test Acc: 0.319
Validation loss decreased (-0.292575 --> -0.318501).  Saving model ...
Epoch: 5 cost time: 0.3785233497619629
Epoch: 5, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.695 Vali Acc: 0.344 Test Loss: 1.695 Test Acc: 0.344
Validation loss decreased (-0.318501 --> -0.344427).  Saving model ...
Epoch: 6 cost time: 0.4053962230682373
Epoch: 6, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.666 Vali Acc: 0.367 Test Loss: 1.666 Test Acc: 0.367
Validation loss decreased (-0.344427 --> -0.366650).  Saving model ...
Epoch: 7 cost time: 0.4002189636230469
Epoch: 7, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.632 Vali Acc: 0.407 Test Loss: 1.632 Test Acc: 0.407
Validation loss decreased (-0.366650 --> -0.407391).  Saving model ...
Epoch: 8 cost time: 0.407454252243042
Epoch: 8, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.592 Vali Acc: 0.456 Test Loss: 1.592 Test Acc: 0.456
Validation loss decreased (-0.407391 --> -0.455540).  Saving model ...
Epoch: 9 cost time: 0.36603736877441406
Epoch: 9, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.547 Vali Acc: 0.485 Test Loss: 1.547 Test Acc: 0.485
Validation loss decreased (-0.455540 --> -0.485170).  Saving model ...
Epoch: 10 cost time: 0.36388468742370605
Epoch: 10, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.498 Vali Acc: 0.567 Test Loss: 1.498 Test Acc: 0.567
Validation loss decreased (-0.485170 --> -0.566652).  Saving model ...
Epoch: 11 cost time: 0.3416588306427002
Epoch: 11, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.444 Vali Acc: 0.626 Test Loss: 1.444 Test Acc: 0.626
Validation loss decreased (-0.566652 --> -0.625911).  Saving model ...
Epoch: 12 cost time: 0.33989500999450684
Epoch: 12, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.388 Vali Acc: 0.689 Test Loss: 1.388 Test Acc: 0.689
Validation loss decreased (-0.625911 --> -0.688875).  Saving model ...
Epoch: 13 cost time: 0.3643510341644287
Epoch: 13, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.329 Vali Acc: 0.719 Test Loss: 1.329 Test Acc: 0.719
Validation loss decreased (-0.688875 --> -0.718505).  Saving model ...
Epoch: 14 cost time: 0.4035506248474121
Epoch: 14, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.269 Vali Acc: 0.759 Test Loss: 1.269 Test Acc: 0.759
Validation loss decreased (-0.718505 --> -0.759247).  Saving model ...
Epoch: 15 cost time: 0.4129006862640381
Epoch: 15, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.208 Vali Acc: 0.778 Test Loss: 1.208 Test Acc: 0.778
Validation loss decreased (-0.759247 --> -0.777766).  Saving model ...
Epoch: 16 cost time: 0.36946749687194824
Epoch: 16, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.146 Vali Acc: 0.796 Test Loss: 1.146 Test Acc: 0.796
Validation loss decreased (-0.777766 --> -0.796285).  Saving model ...
Epoch: 17 cost time: 0.35239148139953613
Epoch: 17, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.085 Vali Acc: 0.830 Test Loss: 1.085 Test Acc: 0.830
Validation loss decreased (-0.796285 --> -0.829619).  Saving model ...
Epoch: 18 cost time: 0.34981679916381836
Epoch: 18, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.027 Vali Acc: 0.833 Test Loss: 1.027 Test Acc: 0.833
Validation loss decreased (-0.829619 --> -0.833323).  Saving model ...
Epoch: 19 cost time: 0.3804643154144287
Epoch: 19, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.970 Vali Acc: 0.852 Test Loss: 0.970 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 20 cost time: 0.36744165420532227
Epoch: 20, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.915 Vali Acc: 0.867 Test Loss: 0.915 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866658).  Saving model ...
Epoch: 21 cost time: 0.3541300296783447
Epoch: 21, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.863 Vali Acc: 0.874 Test Loss: 0.863 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874065).  Saving model ...
Epoch: 22 cost time: 0.402141809463501
Epoch: 22, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.814 Vali Acc: 0.878 Test Loss: 0.814 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877770).  Saving model ...
Epoch: 23 cost time: 0.41715097427368164
Epoch: 23, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.767 Vali Acc: 0.878 Test Loss: 0.767 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 24 cost time: 0.367218017578125
Epoch: 24, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.723 Vali Acc: 0.893 Test Loss: 0.723 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892585).  Saving model ...
Epoch: 25 cost time: 0.35456061363220215
Epoch: 25, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 0.4118328094482422
Epoch: 26, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.646 Vali Acc: 0.904 Test Loss: 0.646 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 27 cost time: 0.3643457889556885
Epoch: 27, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.613 Vali Acc: 0.907 Test Loss: 0.613 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 28 cost time: 0.36759352684020996
Epoch: 28, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.582 Vali Acc: 0.919 Test Loss: 0.582 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 29 cost time: 0.3613460063934326
Epoch: 29, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.554 Vali Acc: 0.919 Test Loss: 0.554 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 30 cost time: 0.3931457996368408
Epoch: 30, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.529 Vali Acc: 0.926 Test Loss: 0.529 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 31 cost time: 0.3961338996887207
Epoch: 31, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.506 Vali Acc: 0.926 Test Loss: 0.506 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 32 cost time: 0.39147233963012695
Epoch: 32, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.485 Vali Acc: 0.926 Test Loss: 0.485 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 33 cost time: 0.40716981887817383
Epoch: 33, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.466 Vali Acc: 0.933 Test Loss: 0.466 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.35970616340637207
Epoch: 34, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.449 Vali Acc: 0.937 Test Loss: 0.449 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 35 cost time: 0.3768746852874756
Epoch: 35, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.433 Vali Acc: 0.937 Test Loss: 0.433 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 36 cost time: 0.35506367683410645
Epoch: 36, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.419 Vali Acc: 0.937 Test Loss: 0.419 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.35082316398620605
Epoch: 37, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.406 Vali Acc: 0.933 Test Loss: 0.406 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.456035852432251
Epoch: 38, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 39 cost time: 0.3666682243347168
Epoch: 39, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.383 Vali Acc: 0.941 Test Loss: 0.383 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 40 cost time: 0.38190364837646484
Epoch: 40, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.373 Vali Acc: 0.941 Test Loss: 0.373 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.4403700828552246
Epoch: 41, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.364 Vali Acc: 0.944 Test Loss: 0.364 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 42 cost time: 0.37511563301086426
Epoch: 42, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.355 Vali Acc: 0.948 Test Loss: 0.355 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 43 cost time: 0.3712730407714844
Epoch: 43, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.348 Vali Acc: 0.948 Test Loss: 0.348 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 44 cost time: 0.3491499423980713
Epoch: 44, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.340 Vali Acc: 0.948 Test Loss: 0.340 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 45 cost time: 0.34542012214660645
Epoch: 45, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 46 cost time: 0.3560948371887207
Epoch: 46, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.328 Vali Acc: 0.948 Test Loss: 0.328 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 47 cost time: 0.3858211040496826
Epoch: 47, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.323 Vali Acc: 0.948 Test Loss: 0.323 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.39994311332702637
Epoch: 48, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.317 Vali Acc: 0.948 Test Loss: 0.317 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 49 cost time: 0.35396671295166016
Epoch: 49, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.312 Vali Acc: 0.952 Test Loss: 0.312 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 50 cost time: 0.4194324016571045
Epoch: 50, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.307 Vali Acc: 0.956 Test Loss: 0.307 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955552).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 88966
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6284995079040527
Epoch: 1, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.711 Vali Acc: 0.241 Test Loss: 1.711 Test Acc: 0.241
Validation loss decreased (inf --> -0.240724).  Saving model ...
Epoch: 2 cost time: 0.3643786907196045
Epoch: 2, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.665 Vali Acc: 0.307 Test Loss: 1.665 Test Acc: 0.307
Validation loss decreased (-0.240724 --> -0.307391).  Saving model ...
Epoch: 3 cost time: 0.4412388801574707
Epoch: 3, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.614 Vali Acc: 0.404 Test Loss: 1.614 Test Acc: 0.404
Validation loss decreased (-0.307391 --> -0.403688).  Saving model ...
Epoch: 4 cost time: 0.38437867164611816
Epoch: 4, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.536 Vali Acc: 0.552 Test Loss: 1.536 Test Acc: 0.552
Validation loss decreased (-0.403688 --> -0.551836).  Saving model ...
Epoch: 5 cost time: 0.3880734443664551
Epoch: 5, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.436 Vali Acc: 0.648 Test Loss: 1.436 Test Acc: 0.648
Validation loss decreased (-0.551836 --> -0.648134).  Saving model ...
Epoch: 6 cost time: 0.3613133430480957
Epoch: 6, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.320 Vali Acc: 0.689 Test Loss: 1.320 Test Acc: 0.689
Validation loss decreased (-0.648134 --> -0.688876).  Saving model ...
Epoch: 7 cost time: 0.3665030002593994
Epoch: 7, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.195 Vali Acc: 0.767 Test Loss: 1.195 Test Acc: 0.767
Validation loss decreased (-0.688876 --> -0.766655).  Saving model ...
Epoch: 8 cost time: 0.3539142608642578
Epoch: 8, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.069 Vali Acc: 0.837 Test Loss: 1.069 Test Acc: 0.837
Validation loss decreased (-0.766655 --> -0.837026).  Saving model ...
Epoch: 9 cost time: 0.3586907386779785
Epoch: 9, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.944 Vali Acc: 0.881 Test Loss: 0.944 Test Acc: 0.881
Validation loss decreased (-0.837026 --> -0.881472).  Saving model ...
Epoch: 10 cost time: 0.35819077491760254
Epoch: 10, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.828 Vali Acc: 0.893 Test Loss: 0.828 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 11 cost time: 0.33409905433654785
Epoch: 11, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.722 Vali Acc: 0.904 Test Loss: 0.722 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903696).  Saving model ...
Epoch: 12 cost time: 0.34909486770629883
Epoch: 12, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.628 Vali Acc: 0.922 Test Loss: 0.628 Test Acc: 0.922
Validation loss decreased (-0.903696 --> -0.922216).  Saving model ...
Epoch: 13 cost time: 0.35837864875793457
Epoch: 13, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.548 Vali Acc: 0.933 Test Loss: 0.548 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 14 cost time: 0.3339216709136963
Epoch: 14, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.480 Vali Acc: 0.933 Test Loss: 0.480 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 15 cost time: 0.37032532691955566
Epoch: 15, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.423 Vali Acc: 0.933 Test Loss: 0.423 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 16 cost time: 0.45789337158203125
Epoch: 16, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.376 Vali Acc: 0.941 Test Loss: 0.376 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 17 cost time: 0.35947585105895996
Epoch: 17, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.339 Vali Acc: 0.937 Test Loss: 0.339 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.36322689056396484
Epoch: 18, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.4821054935455322
Epoch: 19, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.283 Vali Acc: 0.948 Test Loss: 0.283 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948145).  Saving model ...
Epoch: 20 cost time: 0.5054032802581787
Epoch: 20, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.34963560104370117
Epoch: 21, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.3558990955352783
Epoch: 22, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.35365796089172363
Epoch: 23, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.3898029327392578
Epoch: 24, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.34768223762512207
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.3640718460083008
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.3567688465118408
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.39244866371154785
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.38225245475769043
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.3708627223968506
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.37833094596862793
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.34834837913513184
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.3549187183380127
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.4938833713531494
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.3471558094024658
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.3389394283294678
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.37610912322998047
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.3691439628601074
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.3599109649658203
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.3670029640197754
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.3625664710998535
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.33448266983032227
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.36875033378601074
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.3567667007446289
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.4485454559326172
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.41045689582824707
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.4223825931549072
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.37198662757873535
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.35057520866394043
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.35042333602905273
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 72166
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5197947025299072
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.778 Vali Acc: 0.226 Test Loss: 1.778 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.392437219619751
Epoch: 2, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.743 Vali Acc: 0.293 Test Loss: 1.743 Test Acc: 0.293
Validation loss decreased (-0.225908 --> -0.292575).  Saving model ...
Epoch: 3 cost time: 0.3735971450805664
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.710 Vali Acc: 0.348 Test Loss: 1.710 Test Acc: 0.348
Validation loss decreased (-0.292575 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.33932065963745117
Epoch: 4, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.667 Vali Acc: 0.422 Test Loss: 1.667 Test Acc: 0.422
Validation loss decreased (-0.348131 --> -0.422206).  Saving model ...
Epoch: 5 cost time: 0.35040783882141113
Epoch: 5, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.612 Vali Acc: 0.470 Test Loss: 1.612 Test Acc: 0.470
Validation loss decreased (-0.422206 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.3568751811981201
Epoch: 6, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.545 Vali Acc: 0.519 Test Loss: 1.545 Test Acc: 0.519
Validation loss decreased (-0.470354 --> -0.518503).  Saving model ...
Epoch: 7 cost time: 0.41309142112731934
Epoch: 7, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.469 Vali Acc: 0.581 Test Loss: 1.469 Test Acc: 0.581
Validation loss decreased (-0.518503 --> -0.581467).  Saving model ...
Epoch: 8 cost time: 0.46937012672424316
Epoch: 8, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.386 Vali Acc: 0.652 Test Loss: 1.386 Test Acc: 0.652
Validation loss decreased (-0.581467 --> -0.651838).  Saving model ...
Epoch: 9 cost time: 0.46374082565307617
Epoch: 9, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.296 Vali Acc: 0.722 Test Loss: 1.296 Test Acc: 0.722
Validation loss decreased (-0.651838 --> -0.722209).  Saving model ...
Epoch: 10 cost time: 0.36670589447021484
Epoch: 10, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.203 Vali Acc: 0.774 Test Loss: 1.203 Test Acc: 0.774
Validation loss decreased (-0.722209 --> -0.774062).  Saving model ...
Epoch: 11 cost time: 0.39734339714050293
Epoch: 11, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.111 Vali Acc: 0.807 Test Loss: 1.111 Test Acc: 0.807
Validation loss decreased (-0.774062 --> -0.807396).  Saving model ...
Epoch: 12 cost time: 0.3592705726623535
Epoch: 12, Steps: 2 | Train Loss: 0.768 Vali Loss: 1.019 Vali Acc: 0.837 Test Loss: 1.019 Test Acc: 0.837
Validation loss decreased (-0.807396 --> -0.837027).  Saving model ...
Epoch: 13 cost time: 0.41049861907958984
Epoch: 13, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.930 Vali Acc: 0.859 Test Loss: 0.930 Test Acc: 0.859
Validation loss decreased (-0.837027 --> -0.859250).  Saving model ...
Epoch: 14 cost time: 0.3439033031463623
Epoch: 14, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.846 Vali Acc: 0.885 Test Loss: 0.846 Test Acc: 0.885
Validation loss decreased (-0.859250 --> -0.885177).  Saving model ...
Epoch: 15 cost time: 0.3594248294830322
Epoch: 15, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.769 Vali Acc: 0.896 Test Loss: 0.769 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 16 cost time: 0.40317797660827637
Epoch: 16, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.698 Vali Acc: 0.907 Test Loss: 0.698 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907400).  Saving model ...
Epoch: 17 cost time: 0.3550426959991455
Epoch: 17, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.634 Vali Acc: 0.915 Test Loss: 0.634 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 18 cost time: 0.3744363784790039
Epoch: 18, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.576 Vali Acc: 0.915 Test Loss: 0.576 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 19 cost time: 0.37621116638183594
Epoch: 19, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.526 Vali Acc: 0.919 Test Loss: 0.526 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 20 cost time: 0.36282849311828613
Epoch: 20, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.483 Vali Acc: 0.922 Test Loss: 0.483 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 21 cost time: 0.3924679756164551
Epoch: 21, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.446 Vali Acc: 0.930 Test Loss: 0.446 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 22 cost time: 0.3525230884552002
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.414 Vali Acc: 0.933 Test Loss: 0.414 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 23 cost time: 0.34532713890075684
Epoch: 23, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.39540743827819824
Epoch: 24, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 25 cost time: 0.4074521064758301
Epoch: 25, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.344 Vali Acc: 0.937 Test Loss: 0.344 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.3363831043243408
Epoch: 26, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 27 cost time: 0.3440573215484619
Epoch: 27, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.3468332290649414
Epoch: 28, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 29 cost time: 0.3611607551574707
Epoch: 29, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.3450131416320801
Epoch: 30, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.3589615821838379
Epoch: 31, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.34281229972839355
Epoch: 32, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.35410499572753906
Epoch: 33, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.3374898433685303
Epoch: 34, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.3935368061065674
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.40445613861083984
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.33695054054260254
Epoch: 37, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.3868110179901123
Epoch: 38, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.3467841148376465
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.34219813346862793
Epoch: 40, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.3490123748779297
Epoch: 41, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 46886
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.446866750717163
Epoch: 1, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.741 Vali Acc: 0.322 Test Loss: 1.741 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.42157435417175293
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.713 Vali Acc: 0.333 Test Loss: 1.713 Test Acc: 0.333
Validation loss decreased (-0.322205 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.40451884269714355
Epoch: 3, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.688 Vali Acc: 0.344 Test Loss: 1.688 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344428).  Saving model ...
Epoch: 4 cost time: 0.42023587226867676
Epoch: 4, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.659 Vali Acc: 0.341 Test Loss: 1.659 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.36932802200317383
Epoch: 5, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.620 Vali Acc: 0.367 Test Loss: 1.620 Test Acc: 0.367
Validation loss decreased (-0.344428 --> -0.366650).  Saving model ...
Epoch: 6 cost time: 0.3626430034637451
Epoch: 6, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.574 Vali Acc: 0.404 Test Loss: 1.574 Test Acc: 0.404
Validation loss decreased (-0.366650 --> -0.403688).  Saving model ...
Epoch: 7 cost time: 0.40619468688964844
Epoch: 7, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.522 Vali Acc: 0.463 Test Loss: 1.522 Test Acc: 0.463
Validation loss decreased (-0.403688 --> -0.462948).  Saving model ...
Epoch: 8 cost time: 0.37296628952026367
Epoch: 8, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.463 Vali Acc: 0.515 Test Loss: 1.463 Test Acc: 0.515
Validation loss decreased (-0.462948 --> -0.514800).  Saving model ...
Epoch: 9 cost time: 0.4566333293914795
Epoch: 9, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.400 Vali Acc: 0.581 Test Loss: 1.400 Test Acc: 0.581
Validation loss decreased (-0.514800 --> -0.581467).  Saving model ...
Epoch: 10 cost time: 0.35089564323425293
Epoch: 10, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.334 Vali Acc: 0.659 Test Loss: 1.334 Test Acc: 0.659
Validation loss decreased (-0.581467 --> -0.659246).  Saving model ...
Epoch: 11 cost time: 0.3394956588745117
Epoch: 11, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.266 Vali Acc: 0.719 Test Loss: 1.266 Test Acc: 0.719
Validation loss decreased (-0.659246 --> -0.718506).  Saving model ...
Epoch: 12 cost time: 0.3617095947265625
Epoch: 12, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.198 Vali Acc: 0.778 Test Loss: 1.198 Test Acc: 0.778
Validation loss decreased (-0.718506 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 0.3867497444152832
Epoch: 13, Steps: 2 | Train Loss: 0.970 Vali Loss: 1.129 Vali Acc: 0.815 Test Loss: 1.129 Test Acc: 0.815
Validation loss decreased (-0.777766 --> -0.814804).  Saving model ...
Epoch: 14 cost time: 0.39072179794311523
Epoch: 14, Steps: 2 | Train Loss: 0.853 Vali Loss: 1.062 Vali Acc: 0.856 Test Loss: 1.062 Test Acc: 0.856
Validation loss decreased (-0.814804 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.3241267204284668
Epoch: 15, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.996 Vali Acc: 0.881 Test Loss: 0.996 Test Acc: 0.881
Validation loss decreased (-0.855545 --> -0.881472).  Saving model ...
Epoch: 16 cost time: 0.3423752784729004
Epoch: 16, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.934 Vali Acc: 0.889 Test Loss: 0.934 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888880).  Saving model ...
Epoch: 17 cost time: 0.3387746810913086
Epoch: 17, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.874 Vali Acc: 0.896 Test Loss: 0.874 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 18 cost time: 0.39652538299560547
Epoch: 18, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.817 Vali Acc: 0.911 Test Loss: 0.817 Test Acc: 0.911
Validation loss decreased (-0.896288 --> -0.911103).  Saving model ...
Epoch: 19 cost time: 0.37407445907592773
Epoch: 19, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.763 Vali Acc: 0.915 Test Loss: 0.763 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 20 cost time: 0.34758758544921875
Epoch: 20, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.712 Vali Acc: 0.922 Test Loss: 0.712 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.33177733421325684
Epoch: 21, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.664 Vali Acc: 0.926 Test Loss: 0.664 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 22 cost time: 0.3601548671722412
Epoch: 22, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.620 Vali Acc: 0.930 Test Loss: 0.620 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 23 cost time: 0.47769927978515625
Epoch: 23, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.580 Vali Acc: 0.930 Test Loss: 0.580 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.4276890754699707
Epoch: 24, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.544 Vali Acc: 0.930 Test Loss: 0.544 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 25 cost time: 0.3476417064666748
Epoch: 25, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.513 Vali Acc: 0.937 Test Loss: 0.513 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 26 cost time: 0.34288454055786133
Epoch: 26, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.484 Vali Acc: 0.933 Test Loss: 0.484 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3491349220275879
Epoch: 27, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.459 Vali Acc: 0.937 Test Loss: 0.459 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 28 cost time: 0.34574460983276367
Epoch: 28, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.437 Vali Acc: 0.941 Test Loss: 0.437 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 29 cost time: 0.351032018661499
Epoch: 29, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.417 Vali Acc: 0.941 Test Loss: 0.417 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 30 cost time: 0.3255271911621094
Epoch: 30, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.400 Vali Acc: 0.941 Test Loss: 0.400 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 31 cost time: 0.4029850959777832
Epoch: 31, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.384 Vali Acc: 0.944 Test Loss: 0.384 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.3916959762573242
Epoch: 32, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.371 Vali Acc: 0.944 Test Loss: 0.371 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 33 cost time: 0.40937113761901855
Epoch: 33, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 34 cost time: 0.35040879249572754
Epoch: 34, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 35 cost time: 0.38465285301208496
Epoch: 35, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.34816551208496094
Epoch: 36, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.3788776397705078
Epoch: 37, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.3490180969238281
Epoch: 38, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.36682939529418945
Epoch: 39, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.4046213626861572
Epoch: 40, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 0.39313817024230957
Epoch: 41, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 42 cost time: 0.36218714714050293
Epoch: 42, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.33589696884155273
Epoch: 43, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.3581061363220215
Epoch: 44, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.33122944831848145
Epoch: 45, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.3761615753173828
Epoch: 46, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.3392329216003418
Epoch: 47, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.46913957595825195
Epoch: 48, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.3595268726348877
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.428469181060791
Epoch: 50, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 38470
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.3911867141723633
Epoch: 1, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.711 Vali Acc: 0.348 Test Loss: 1.711 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 0.366030216217041
Epoch: 2, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.683 Vali Acc: 0.393 Test Loss: 1.683 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392576).  Saving model ...
Epoch: 3 cost time: 0.4894089698791504
Epoch: 3, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.657 Vali Acc: 0.422 Test Loss: 1.657 Test Acc: 0.422
Validation loss decreased (-0.392576 --> -0.422206).  Saving model ...
Epoch: 4 cost time: 0.3217451572418213
Epoch: 4, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.629 Vali Acc: 0.481 Test Loss: 1.629 Test Acc: 0.481
Validation loss decreased (-0.422206 --> -0.481465).  Saving model ...
Epoch: 5 cost time: 0.3261847496032715
Epoch: 5, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.594 Vali Acc: 0.537 Test Loss: 1.594 Test Acc: 0.537
Validation loss decreased (-0.481465 --> -0.537021).  Saving model ...
Epoch: 6 cost time: 0.31540799140930176
Epoch: 6, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.554 Vali Acc: 0.567 Test Loss: 1.554 Test Acc: 0.567
Validation loss decreased (-0.537021 --> -0.566651).  Saving model ...
Epoch: 7 cost time: 0.3450627326965332
Epoch: 7, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.509 Vali Acc: 0.596 Test Loss: 1.509 Test Acc: 0.596
Validation loss decreased (-0.566651 --> -0.596281).  Saving model ...
Epoch: 8 cost time: 0.3167574405670166
Epoch: 8, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.459 Vali Acc: 0.622 Test Loss: 1.459 Test Acc: 0.622
Validation loss decreased (-0.596281 --> -0.622208).  Saving model ...
Epoch: 9 cost time: 0.31165099143981934
Epoch: 9, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.404 Vali Acc: 0.659 Test Loss: 1.404 Test Acc: 0.659
Validation loss decreased (-0.622208 --> -0.659245).  Saving model ...
Epoch: 10 cost time: 0.3180813789367676
Epoch: 10, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.346 Vali Acc: 0.685 Test Loss: 1.346 Test Acc: 0.685
Validation loss decreased (-0.659245 --> -0.685172).  Saving model ...
Epoch: 11 cost time: 0.46361541748046875
Epoch: 11, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.287 Vali Acc: 0.726 Test Loss: 1.287 Test Acc: 0.726
Validation loss decreased (-0.685172 --> -0.725913).  Saving model ...
Epoch: 12 cost time: 0.3362441062927246
Epoch: 12, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.226 Vali Acc: 0.774 Test Loss: 1.226 Test Acc: 0.774
Validation loss decreased (-0.725913 --> -0.774062).  Saving model ...
Epoch: 13 cost time: 0.3957939147949219
Epoch: 13, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.165 Vali Acc: 0.800 Test Loss: 1.165 Test Acc: 0.800
Validation loss decreased (-0.774062 --> -0.799988).  Saving model ...
Epoch: 14 cost time: 0.33876609802246094
Epoch: 14, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.105 Vali Acc: 0.826 Test Loss: 1.105 Test Acc: 0.826
Validation loss decreased (-0.799988 --> -0.825915).  Saving model ...
Epoch: 15 cost time: 0.3111886978149414
Epoch: 15, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.046 Vali Acc: 0.833 Test Loss: 1.046 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833323).  Saving model ...
Epoch: 16 cost time: 0.34198713302612305
Epoch: 16, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.989 Vali Acc: 0.848 Test Loss: 0.989 Test Acc: 0.848
Validation loss decreased (-0.833323 --> -0.848138).  Saving model ...
Epoch: 17 cost time: 0.33656930923461914
Epoch: 17, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.932 Vali Acc: 0.867 Test Loss: 0.932 Test Acc: 0.867
Validation loss decreased (-0.848138 --> -0.866657).  Saving model ...
Epoch: 18 cost time: 0.340681791305542
Epoch: 18, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.878 Vali Acc: 0.885 Test Loss: 0.878 Test Acc: 0.885
Validation loss decreased (-0.866657 --> -0.885176).  Saving model ...
Epoch: 19 cost time: 0.3888554573059082
Epoch: 19, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.826 Vali Acc: 0.904 Test Loss: 0.826 Test Acc: 0.904
Validation loss decreased (-0.885176 --> -0.903695).  Saving model ...
Epoch: 20 cost time: 0.35568666458129883
Epoch: 20, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.776 Vali Acc: 0.922 Test Loss: 0.776 Test Acc: 0.922
Validation loss decreased (-0.903695 --> -0.922214).  Saving model ...
Epoch: 21 cost time: 0.37755632400512695
Epoch: 21, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.729 Vali Acc: 0.930 Test Loss: 0.729 Test Acc: 0.930
Validation loss decreased (-0.922214 --> -0.929622).  Saving model ...
Epoch: 22 cost time: 0.35998082160949707
Epoch: 22, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.685 Vali Acc: 0.937 Test Loss: 0.685 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937030).  Saving model ...
Epoch: 23 cost time: 0.36231446266174316
Epoch: 23, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.644 Vali Acc: 0.941 Test Loss: 0.644 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940734).  Saving model ...
Epoch: 24 cost time: 0.3337078094482422
Epoch: 24, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.607 Vali Acc: 0.937 Test Loss: 0.607 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.334578275680542
Epoch: 25, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.573 Vali Acc: 0.941 Test Loss: 0.573 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 26 cost time: 0.35694313049316406
Epoch: 26, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.542 Vali Acc: 0.944 Test Loss: 0.542 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 27 cost time: 0.34141016006469727
Epoch: 27, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.515 Vali Acc: 0.948 Test Loss: 0.515 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 28 cost time: 0.33616113662719727
Epoch: 28, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.491 Vali Acc: 0.948 Test Loss: 0.491 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 29 cost time: 0.345259428024292
Epoch: 29, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.469 Vali Acc: 0.948 Test Loss: 0.469 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 30 cost time: 0.32486534118652344
Epoch: 30, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.449 Vali Acc: 0.952 Test Loss: 0.449 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 31 cost time: 0.3663601875305176
Epoch: 31, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.431 Vali Acc: 0.948 Test Loss: 0.431 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.3607826232910156
Epoch: 32, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.415 Vali Acc: 0.948 Test Loss: 0.415 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.371478796005249
Epoch: 33, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.401 Vali Acc: 0.948 Test Loss: 0.401 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.34459638595581055
Epoch: 34, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.387 Vali Acc: 0.952 Test Loss: 0.387 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 35 cost time: 0.32714200019836426
Epoch: 35, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.375 Vali Acc: 0.956 Test Loss: 0.375 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 36 cost time: 0.3400743007659912
Epoch: 36, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.365 Vali Acc: 0.956 Test Loss: 0.365 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 37 cost time: 0.36675000190734863
Epoch: 37, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.355 Vali Acc: 0.959 Test Loss: 0.355 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 38 cost time: 0.3527557849884033
Epoch: 38, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.346 Vali Acc: 0.959 Test Loss: 0.346 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 39 cost time: 0.32686662673950195
Epoch: 39, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.338 Vali Acc: 0.959 Test Loss: 0.338 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 40 cost time: 0.38161587715148926
Epoch: 40, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.330 Vali Acc: 0.959 Test Loss: 0.330 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 41 cost time: 0.3680760860443115
Epoch: 41, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.324 Vali Acc: 0.959 Test Loss: 0.324 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 42 cost time: 0.3683040142059326
Epoch: 42, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.317 Vali Acc: 0.959 Test Loss: 0.317 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 43 cost time: 0.35817599296569824
Epoch: 43, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.311 Vali Acc: 0.959 Test Loss: 0.311 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 44 cost time: 0.33260059356689453
Epoch: 44, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.306 Vali Acc: 0.959 Test Loss: 0.306 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 45 cost time: 0.3323795795440674
Epoch: 45, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.301 Vali Acc: 0.959 Test Loss: 0.301 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 46 cost time: 0.34222984313964844
Epoch: 46, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.296 Vali Acc: 0.959 Test Loss: 0.296 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 47 cost time: 0.3690452575683594
Epoch: 47, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.291 Vali Acc: 0.959 Test Loss: 0.291 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 48 cost time: 0.34188079833984375
Epoch: 48, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.287 Vali Acc: 0.956 Test Loss: 0.287 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.3484776020050049
Epoch: 49, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.283 Vali Acc: 0.956 Test Loss: 0.283 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4134082794189453
Epoch: 50, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.280 Vali Acc: 0.956 Test Loss: 0.280 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 34694
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.464937448501587
Epoch: 1, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.739 Vali Acc: 0.281 Test Loss: 1.739 Test Acc: 0.281
Validation loss decreased (inf --> -0.281464).  Saving model ...
Epoch: 2 cost time: 0.3526160717010498
Epoch: 2, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.716 Vali Acc: 0.311 Test Loss: 1.716 Test Acc: 0.311
Validation loss decreased (-0.281464 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 0.38923144340515137
Epoch: 3, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.697 Vali Acc: 0.319 Test Loss: 1.697 Test Acc: 0.319
Validation loss decreased (-0.311094 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.39597105979919434
Epoch: 4, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.677 Vali Acc: 0.352 Test Loss: 1.677 Test Acc: 0.352
Validation loss decreased (-0.318502 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 0.3885014057159424
Epoch: 5, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.651 Vali Acc: 0.370 Test Loss: 1.651 Test Acc: 0.370
Validation loss decreased (-0.351835 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 0.3423631191253662
Epoch: 6, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.620 Vali Acc: 0.426 Test Loss: 1.620 Test Acc: 0.426
Validation loss decreased (-0.370354 --> -0.425910).  Saving model ...
Epoch: 7 cost time: 0.411043643951416
Epoch: 7, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.585 Vali Acc: 0.459 Test Loss: 1.585 Test Acc: 0.459
Validation loss decreased (-0.425910 --> -0.459243).  Saving model ...
Epoch: 8 cost time: 0.34390926361083984
Epoch: 8, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.545 Vali Acc: 0.496 Test Loss: 1.545 Test Acc: 0.496
Validation loss decreased (-0.459243 --> -0.496281).  Saving model ...
Epoch: 9 cost time: 0.3833951950073242
Epoch: 9, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.501 Vali Acc: 0.522 Test Loss: 1.501 Test Acc: 0.522
Validation loss decreased (-0.496281 --> -0.522207).  Saving model ...
Epoch: 10 cost time: 0.4192368984222412
Epoch: 10, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.455 Vali Acc: 0.574 Test Loss: 1.455 Test Acc: 0.574
Validation loss decreased (-0.522207 --> -0.574060).  Saving model ...
Epoch: 11 cost time: 0.40946340560913086
Epoch: 11, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.406 Vali Acc: 0.607 Test Loss: 1.406 Test Acc: 0.607
Validation loss decreased (-0.574060 --> -0.607393).  Saving model ...
Epoch: 12 cost time: 0.43495607376098633
Epoch: 12, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.355 Vali Acc: 0.663 Test Loss: 1.355 Test Acc: 0.663
Validation loss decreased (-0.607393 --> -0.662949).  Saving model ...
Epoch: 13 cost time: 0.4197838306427002
Epoch: 13, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.303 Vali Acc: 0.689 Test Loss: 1.303 Test Acc: 0.689
Validation loss decreased (-0.662949 --> -0.688876).  Saving model ...
Epoch: 14 cost time: 0.4167602062225342
Epoch: 14, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.251 Vali Acc: 0.707 Test Loss: 1.251 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707395).  Saving model ...
Epoch: 15 cost time: 0.3935122489929199
Epoch: 15, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.199 Vali Acc: 0.741 Test Loss: 1.199 Test Acc: 0.741
Validation loss decreased (-0.707395 --> -0.740729).  Saving model ...
Epoch: 16 cost time: 0.4135751724243164
Epoch: 16, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.148 Vali Acc: 0.774 Test Loss: 1.148 Test Acc: 0.774
Validation loss decreased (-0.740729 --> -0.774063).  Saving model ...
Epoch: 17 cost time: 0.42958712577819824
Epoch: 17, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.096 Vali Acc: 0.793 Test Loss: 1.096 Test Acc: 0.793
Validation loss decreased (-0.774063 --> -0.792582).  Saving model ...
Epoch: 18 cost time: 0.4062957763671875
Epoch: 18, Steps: 2 | Train Loss: 0.904 Vali Loss: 1.045 Vali Acc: 0.811 Test Loss: 1.045 Test Acc: 0.811
Validation loss decreased (-0.792582 --> -0.811101).  Saving model ...
Epoch: 19 cost time: 0.4226233959197998
Epoch: 19, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.994 Vali Acc: 0.822 Test Loss: 0.994 Test Acc: 0.822
Validation loss decreased (-0.811101 --> -0.822212).  Saving model ...
Epoch: 20 cost time: 0.42648744583129883
Epoch: 20, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.946 Vali Acc: 0.830 Test Loss: 0.946 Test Acc: 0.830
Validation loss decreased (-0.822212 --> -0.829620).  Saving model ...
Epoch: 21 cost time: 0.41733527183532715
Epoch: 21, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.899 Vali Acc: 0.841 Test Loss: 0.899 Test Acc: 0.841
Validation loss decreased (-0.829620 --> -0.840732).  Saving model ...
Epoch: 22 cost time: 0.40607380867004395
Epoch: 22, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.853 Vali Acc: 0.874 Test Loss: 0.853 Test Acc: 0.874
Validation loss decreased (-0.840732 --> -0.874066).  Saving model ...
Epoch: 23 cost time: 0.4652273654937744
Epoch: 23, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.810 Vali Acc: 0.893 Test Loss: 0.810 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892584).  Saving model ...
Epoch: 24 cost time: 0.39307236671447754
Epoch: 24, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.769 Vali Acc: 0.896 Test Loss: 0.769 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896289).  Saving model ...
Epoch: 25 cost time: 0.4099867343902588
Epoch: 25, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.729 Vali Acc: 0.915 Test Loss: 0.729 Test Acc: 0.915
Validation loss decreased (-0.896289 --> -0.914808).  Saving model ...
Epoch: 26 cost time: 0.4254615306854248
Epoch: 26, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.693 Vali Acc: 0.915 Test Loss: 0.693 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 27 cost time: 0.3787264823913574
Epoch: 27, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.659 Vali Acc: 0.919 Test Loss: 0.659 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 28 cost time: 0.42844438552856445
Epoch: 28, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.628 Vali Acc: 0.922 Test Loss: 0.628 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 29 cost time: 0.44466567039489746
Epoch: 29, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.599 Vali Acc: 0.930 Test Loss: 0.599 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 30 cost time: 0.4190545082092285
Epoch: 30, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.572 Vali Acc: 0.930 Test Loss: 0.572 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 31 cost time: 0.4553680419921875
Epoch: 31, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.547 Vali Acc: 0.930 Test Loss: 0.547 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 32 cost time: 0.41500282287597656
Epoch: 32, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.525 Vali Acc: 0.930 Test Loss: 0.525 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 33 cost time: 0.396942138671875
Epoch: 33, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.505 Vali Acc: 0.930 Test Loss: 0.505 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 34 cost time: 0.39455723762512207
Epoch: 34, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.486 Vali Acc: 0.930 Test Loss: 0.486 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 35 cost time: 0.4147329330444336
Epoch: 35, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.469 Vali Acc: 0.933 Test Loss: 0.469 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 36 cost time: 0.3788423538208008
Epoch: 36, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.454 Vali Acc: 0.937 Test Loss: 0.454 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937032).  Saving model ...
Epoch: 37 cost time: 0.4166882038116455
Epoch: 37, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.440 Vali Acc: 0.937 Test Loss: 0.440 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.4336512088775635
Epoch: 38, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.427 Vali Acc: 0.937 Test Loss: 0.427 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 39 cost time: 0.4076814651489258
Epoch: 39, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.414 Vali Acc: 0.944 Test Loss: 0.414 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944440).  Saving model ...
Epoch: 40 cost time: 0.38729047775268555
Epoch: 40, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.403 Vali Acc: 0.944 Test Loss: 0.403 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 41 cost time: 0.3963429927825928
Epoch: 41, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.393 Vali Acc: 0.944 Test Loss: 0.393 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 42 cost time: 0.4040665626525879
Epoch: 42, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.384 Vali Acc: 0.944 Test Loss: 0.384 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.39505934715270996
Epoch: 43, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.375 Vali Acc: 0.941 Test Loss: 0.375 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.47896456718444824
Epoch: 44, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.368 Vali Acc: 0.941 Test Loss: 0.368 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.43346643447875977
Epoch: 45, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.360 Vali Acc: 0.941 Test Loss: 0.360 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5130131244659424
Epoch: 46, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.34779906272888184
Epoch: 47, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.347 Vali Acc: 0.941 Test Loss: 0.347 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4035170078277588
Epoch: 48, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.402803897857666
Epoch: 49, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.40032315254211426
Epoch: 50, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.330 Vali Acc: 0.941 Test Loss: 0.330 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 32486
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.3461613655090332
Epoch: 1, Steps: 2 | Train Loss: 2.034 Vali Loss: 1.892 Vali Acc: 0.004 Test Loss: 1.892 Test Acc: 0.004
Validation loss decreased (inf --> -0.003685).  Saving model ...
Epoch: 2 cost time: 0.3156161308288574
Epoch: 2, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.879 Vali Acc: 0.007 Test Loss: 1.879 Test Acc: 0.007
Validation loss decreased (-0.003685 --> -0.007389).  Saving model ...
Epoch: 3 cost time: 0.32129454612731934
Epoch: 3, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.870 Vali Acc: 0.015 Test Loss: 1.870 Test Acc: 0.015
Validation loss decreased (-0.007389 --> -0.014796).  Saving model ...
Epoch: 4 cost time: 0.3087143898010254
Epoch: 4, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.862 Vali Acc: 0.022 Test Loss: 1.862 Test Acc: 0.022
Validation loss decreased (-0.014796 --> -0.022204).  Saving model ...
Epoch: 5 cost time: 0.3241117000579834
Epoch: 5, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.851 Vali Acc: 0.041 Test Loss: 1.851 Test Acc: 0.041
Validation loss decreased (-0.022204 --> -0.040722).  Saving model ...
Epoch: 6 cost time: 0.34230756759643555
Epoch: 6, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.835 Vali Acc: 0.044 Test Loss: 1.835 Test Acc: 0.044
Validation loss decreased (-0.040722 --> -0.044426).  Saving model ...
Epoch: 7 cost time: 0.3157076835632324
Epoch: 7, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.816 Vali Acc: 0.074 Test Loss: 1.816 Test Acc: 0.074
Validation loss decreased (-0.044426 --> -0.074056).  Saving model ...
Epoch: 8 cost time: 0.3122081756591797
Epoch: 8, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.794 Vali Acc: 0.100 Test Loss: 1.794 Test Acc: 0.100
Validation loss decreased (-0.074056 --> -0.099982).  Saving model ...
Epoch: 9 cost time: 0.302243709564209
Epoch: 9, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.768 Vali Acc: 0.144 Test Loss: 1.768 Test Acc: 0.144
Validation loss decreased (-0.099982 --> -0.144427).  Saving model ...
Epoch: 10 cost time: 0.3067178726196289
Epoch: 10, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.739 Vali Acc: 0.204 Test Loss: 1.739 Test Acc: 0.204
Validation loss decreased (-0.144427 --> -0.203686).  Saving model ...
Epoch: 11 cost time: 0.39309239387512207
Epoch: 11, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.706 Vali Acc: 0.256 Test Loss: 1.706 Test Acc: 0.256
Validation loss decreased (-0.203686 --> -0.255538).  Saving model ...
Epoch: 12 cost time: 0.3341481685638428
Epoch: 12, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.671 Vali Acc: 0.315 Test Loss: 1.671 Test Acc: 0.315
Validation loss decreased (-0.255538 --> -0.314798).  Saving model ...
Epoch: 13 cost time: 0.3713696002960205
Epoch: 13, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.633 Vali Acc: 0.374 Test Loss: 1.633 Test Acc: 0.374
Validation loss decreased (-0.314798 --> -0.374058).  Saving model ...
Epoch: 14 cost time: 0.336864709854126
Epoch: 14, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.594 Vali Acc: 0.437 Test Loss: 1.594 Test Acc: 0.437
Validation loss decreased (-0.374058 --> -0.437021).  Saving model ...
Epoch: 15 cost time: 0.32017946243286133
Epoch: 15, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.553 Vali Acc: 0.478 Test Loss: 1.553 Test Acc: 0.478
Validation loss decreased (-0.437021 --> -0.477762).  Saving model ...
Epoch: 16 cost time: 0.3308980464935303
Epoch: 16, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.511 Vali Acc: 0.511 Test Loss: 1.511 Test Acc: 0.511
Validation loss decreased (-0.477762 --> -0.511096).  Saving model ...
Epoch: 17 cost time: 0.31990694999694824
Epoch: 17, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.467 Vali Acc: 0.556 Test Loss: 1.467 Test Acc: 0.556
Validation loss decreased (-0.511096 --> -0.555541).  Saving model ...
Epoch: 18 cost time: 0.3214876651763916
Epoch: 18, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.423 Vali Acc: 0.589 Test Loss: 1.423 Test Acc: 0.589
Validation loss decreased (-0.555541 --> -0.588875).  Saving model ...
Epoch: 19 cost time: 0.3357727527618408
Epoch: 19, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.378 Vali Acc: 0.622 Test Loss: 1.378 Test Acc: 0.622
Validation loss decreased (-0.588875 --> -0.622208).  Saving model ...
Epoch: 20 cost time: 0.3275613784790039
Epoch: 20, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.333 Vali Acc: 0.652 Test Loss: 1.333 Test Acc: 0.652
Validation loss decreased (-0.622208 --> -0.651839).  Saving model ...
Epoch: 21 cost time: 0.33456850051879883
Epoch: 21, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.287 Vali Acc: 0.670 Test Loss: 1.287 Test Acc: 0.670
Validation loss decreased (-0.651839 --> -0.670358).  Saving model ...
Epoch: 22 cost time: 0.3417627811431885
Epoch: 22, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.241 Vali Acc: 0.693 Test Loss: 1.241 Test Acc: 0.693
Validation loss decreased (-0.670358 --> -0.692580).  Saving model ...
Epoch: 23 cost time: 0.36832523345947266
Epoch: 23, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.196 Vali Acc: 0.719 Test Loss: 1.196 Test Acc: 0.719
Validation loss decreased (-0.692580 --> -0.718507).  Saving model ...
Epoch: 24 cost time: 0.32570672035217285
Epoch: 24, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.151 Vali Acc: 0.744 Test Loss: 1.151 Test Acc: 0.744
Validation loss decreased (-0.718507 --> -0.744433).  Saving model ...
Epoch: 25 cost time: 0.32811927795410156
Epoch: 25, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.106 Vali Acc: 0.752 Test Loss: 1.106 Test Acc: 0.752
Validation loss decreased (-0.744433 --> -0.751841).  Saving model ...
Epoch: 26 cost time: 0.36983489990234375
Epoch: 26, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.063 Vali Acc: 0.796 Test Loss: 1.063 Test Acc: 0.796
Validation loss decreased (-0.751841 --> -0.796286).  Saving model ...
Epoch: 27 cost time: 0.33512163162231445
Epoch: 27, Steps: 2 | Train Loss: 0.855 Vali Loss: 1.020 Vali Acc: 0.815 Test Loss: 1.020 Test Acc: 0.815
Validation loss decreased (-0.796286 --> -0.814805).  Saving model ...
Epoch: 28 cost time: 0.37244391441345215
Epoch: 28, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.978 Vali Acc: 0.830 Test Loss: 0.978 Test Acc: 0.830
Validation loss decreased (-0.814805 --> -0.829620).  Saving model ...
Epoch: 29 cost time: 0.3488647937774658
Epoch: 29, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.937 Vali Acc: 0.841 Test Loss: 0.937 Test Acc: 0.841
Validation loss decreased (-0.829620 --> -0.840731).  Saving model ...
Epoch: 30 cost time: 0.3129856586456299
Epoch: 30, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.898 Vali Acc: 0.859 Test Loss: 0.898 Test Acc: 0.859
Validation loss decreased (-0.840731 --> -0.859250).  Saving model ...
Epoch: 31 cost time: 0.3201026916503906
Epoch: 31, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.861 Vali Acc: 0.867 Test Loss: 0.861 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 32 cost time: 0.3891937732696533
Epoch: 32, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.826 Vali Acc: 0.874 Test Loss: 0.826 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 33 cost time: 0.39594101905822754
Epoch: 33, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.792 Vali Acc: 0.881 Test Loss: 0.792 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 34 cost time: 0.32413244247436523
Epoch: 34, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.760 Vali Acc: 0.881 Test Loss: 0.760 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
Epoch: 35 cost time: 0.32433295249938965
Epoch: 35, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.731 Vali Acc: 0.881 Test Loss: 0.731 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
Epoch: 36 cost time: 0.4524192810058594
Epoch: 36, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.704 Vali Acc: 0.889 Test Loss: 0.704 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 37 cost time: 0.33841729164123535
Epoch: 37, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.679 Vali Acc: 0.896 Test Loss: 0.679 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 38 cost time: 0.3458435535430908
Epoch: 38, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.655 Vali Acc: 0.911 Test Loss: 0.655 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 39 cost time: 0.4118790626525879
Epoch: 39, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.633 Vali Acc: 0.919 Test Loss: 0.633 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918512).  Saving model ...
Epoch: 40 cost time: 0.3837242126464844
Epoch: 40, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.612 Vali Acc: 0.919 Test Loss: 0.612 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 41 cost time: 0.304276704788208
Epoch: 41, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.593 Vali Acc: 0.919 Test Loss: 0.593 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 42 cost time: 0.36728358268737793
Epoch: 42, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.576 Vali Acc: 0.919 Test Loss: 0.576 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 43 cost time: 0.34000587463378906
Epoch: 43, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.560 Vali Acc: 0.922 Test Loss: 0.560 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 44 cost time: 0.36526989936828613
Epoch: 44, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.544 Vali Acc: 0.926 Test Loss: 0.544 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925920).  Saving model ...
Epoch: 45 cost time: 0.39940905570983887
Epoch: 45, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.529 Vali Acc: 0.926 Test Loss: 0.529 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 46 cost time: 0.459975004196167
Epoch: 46, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.516 Vali Acc: 0.926 Test Loss: 0.516 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 47 cost time: 0.3471095561981201
Epoch: 47, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.503 Vali Acc: 0.930 Test Loss: 0.503 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 48 cost time: 0.32886409759521484
Epoch: 48, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.491 Vali Acc: 0.933 Test Loss: 0.491 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933328).  Saving model ...
Epoch: 49 cost time: 0.36465954780578613
Epoch: 49, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.480 Vali Acc: 0.937 Test Loss: 0.480 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 50 cost time: 0.35266780853271484
Epoch: 50, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.469 Vali Acc: 0.937 Test Loss: 0.469 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 29510
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5692217350006104
Epoch: 1, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.840 Vali Acc: 0.167 Test Loss: 1.840 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.3414289951324463
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.829 Vali Acc: 0.167 Test Loss: 1.829 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.33200907707214355
Epoch: 3, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.822 Vali Acc: 0.148 Test Loss: 1.822 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3216853141784668
Epoch: 4, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.816 Vali Acc: 0.159 Test Loss: 1.816 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.33043956756591797
Epoch: 5, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.807 Vali Acc: 0.185 Test Loss: 1.807 Test Acc: 0.185
Validation loss decreased (-0.166648 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.3270111083984375
Epoch: 6, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.794 Vali Acc: 0.204 Test Loss: 1.794 Test Acc: 0.204
Validation loss decreased (-0.185167 --> -0.203686).  Saving model ...
Epoch: 7 cost time: 0.3481416702270508
Epoch: 7, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.779 Vali Acc: 0.244 Test Loss: 1.779 Test Acc: 0.244
Validation loss decreased (-0.203686 --> -0.244427).  Saving model ...
Epoch: 8 cost time: 0.34035730361938477
Epoch: 8, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.761 Vali Acc: 0.270 Test Loss: 1.761 Test Acc: 0.270
Validation loss decreased (-0.244427 --> -0.270353).  Saving model ...
Epoch: 9 cost time: 0.34013962745666504
Epoch: 9, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.740 Vali Acc: 0.289 Test Loss: 1.740 Test Acc: 0.289
Validation loss decreased (-0.270353 --> -0.288871).  Saving model ...
Epoch: 10 cost time: 0.35577392578125
Epoch: 10, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.716 Vali Acc: 0.322 Test Loss: 1.716 Test Acc: 0.322
Validation loss decreased (-0.288871 --> -0.322205).  Saving model ...
Epoch: 11 cost time: 0.3579525947570801
Epoch: 11, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.689 Vali Acc: 0.344 Test Loss: 1.689 Test Acc: 0.344
Validation loss decreased (-0.322205 --> -0.344428).  Saving model ...
Epoch: 12 cost time: 0.32531118392944336
Epoch: 12, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.661 Vali Acc: 0.363 Test Loss: 1.661 Test Acc: 0.363
Validation loss decreased (-0.344428 --> -0.362946).  Saving model ...
Epoch: 13 cost time: 0.3469521999359131
Epoch: 13, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.630 Vali Acc: 0.419 Test Loss: 1.630 Test Acc: 0.419
Validation loss decreased (-0.362946 --> -0.418502).  Saving model ...
Epoch: 14 cost time: 0.33374929428100586
Epoch: 14, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.597 Vali Acc: 0.433 Test Loss: 1.597 Test Acc: 0.433
Validation loss decreased (-0.418502 --> -0.433317).  Saving model ...
Epoch: 15 cost time: 0.33209681510925293
Epoch: 15, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.563 Vali Acc: 0.463 Test Loss: 1.563 Test Acc: 0.463
Validation loss decreased (-0.433317 --> -0.462947).  Saving model ...
Epoch: 16 cost time: 0.3426649570465088
Epoch: 16, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.528 Vali Acc: 0.511 Test Loss: 1.528 Test Acc: 0.511
Validation loss decreased (-0.462947 --> -0.511096).  Saving model ...
Epoch: 17 cost time: 0.3587522506713867
Epoch: 17, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.491 Vali Acc: 0.544 Test Loss: 1.491 Test Acc: 0.544
Validation loss decreased (-0.511096 --> -0.544430).  Saving model ...
Epoch: 18 cost time: 0.34763002395629883
Epoch: 18, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.453 Vali Acc: 0.593 Test Loss: 1.453 Test Acc: 0.593
Validation loss decreased (-0.544430 --> -0.592578).  Saving model ...
Epoch: 19 cost time: 0.3585245609283447
Epoch: 19, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.414 Vali Acc: 0.641 Test Loss: 1.414 Test Acc: 0.641
Validation loss decreased (-0.592578 --> -0.640727).  Saving model ...
Epoch: 20 cost time: 0.33203935623168945
Epoch: 20, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.375 Vali Acc: 0.681 Test Loss: 1.375 Test Acc: 0.681
Validation loss decreased (-0.640727 --> -0.681468).  Saving model ...
Epoch: 21 cost time: 0.3320455551147461
Epoch: 21, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.335 Vali Acc: 0.700 Test Loss: 1.335 Test Acc: 0.700
Validation loss decreased (-0.681468 --> -0.699987).  Saving model ...
Epoch: 22 cost time: 0.3360764980316162
Epoch: 22, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.295 Vali Acc: 0.722 Test Loss: 1.295 Test Acc: 0.722
Validation loss decreased (-0.699987 --> -0.722209).  Saving model ...
Epoch: 23 cost time: 0.43316197395324707
Epoch: 23, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.255 Vali Acc: 0.744 Test Loss: 1.255 Test Acc: 0.744
Validation loss decreased (-0.722209 --> -0.744432).  Saving model ...
Epoch: 24 cost time: 0.3253133296966553
Epoch: 24, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.215 Vali Acc: 0.774 Test Loss: 1.215 Test Acc: 0.774
Validation loss decreased (-0.744432 --> -0.774062).  Saving model ...
Epoch: 25 cost time: 0.32753467559814453
Epoch: 25, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.176 Vali Acc: 0.789 Test Loss: 1.176 Test Acc: 0.789
Validation loss decreased (-0.774062 --> -0.788877).  Saving model ...
Epoch: 26 cost time: 0.35642337799072266
Epoch: 26, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.136 Vali Acc: 0.804 Test Loss: 1.136 Test Acc: 0.804
Validation loss decreased (-0.788877 --> -0.803692).  Saving model ...
Epoch: 27 cost time: 0.3626062870025635
Epoch: 27, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.098 Vali Acc: 0.837 Test Loss: 1.098 Test Acc: 0.837
Validation loss decreased (-0.803692 --> -0.837026).  Saving model ...
Epoch: 28 cost time: 0.37448811531066895
Epoch: 28, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.061 Vali Acc: 0.848 Test Loss: 1.061 Test Acc: 0.848
Validation loss decreased (-0.837026 --> -0.848138).  Saving model ...
Epoch: 29 cost time: 0.3218116760253906
Epoch: 29, Steps: 2 | Train Loss: 0.856 Vali Loss: 1.024 Vali Acc: 0.852 Test Loss: 1.024 Test Acc: 0.852
Validation loss decreased (-0.848138 --> -0.851842).  Saving model ...
Epoch: 30 cost time: 0.3352210521697998
Epoch: 30, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.988 Vali Acc: 0.863 Test Loss: 0.988 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 31 cost time: 0.3704080581665039
Epoch: 31, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.953 Vali Acc: 0.867 Test Loss: 0.953 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 32 cost time: 0.3198542594909668
Epoch: 32, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.920 Vali Acc: 0.863 Test Loss: 0.920 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.32256102561950684
Epoch: 33, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.888 Vali Acc: 0.867 Test Loss: 0.888 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866658).  Saving model ...
Epoch: 34 cost time: 0.34888792037963867
Epoch: 34, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.857 Vali Acc: 0.867 Test Loss: 0.857 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 35 cost time: 0.3335540294647217
Epoch: 35, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.828 Vali Acc: 0.878 Test Loss: 0.828 Test Acc: 0.878
Validation loss decreased (-0.866658 --> -0.877769).  Saving model ...
Epoch: 36 cost time: 0.3490288257598877
Epoch: 36, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.801 Vali Acc: 0.878 Test Loss: 0.801 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 37 cost time: 0.3651261329650879
Epoch: 37, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.775 Vali Acc: 0.881 Test Loss: 0.775 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 38 cost time: 0.3571186065673828
Epoch: 38, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.751 Vali Acc: 0.885 Test Loss: 0.751 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 39 cost time: 0.34034204483032227
Epoch: 39, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.727 Vali Acc: 0.885 Test Loss: 0.727 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 40 cost time: 0.3178069591522217
Epoch: 40, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.705 Vali Acc: 0.893 Test Loss: 0.705 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 41 cost time: 0.32943010330200195
Epoch: 41, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.684 Vali Acc: 0.893 Test Loss: 0.684 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 42 cost time: 0.3666083812713623
Epoch: 42, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.664 Vali Acc: 0.893 Test Loss: 0.664 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 43 cost time: 0.3405325412750244
Epoch: 43, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 0.34052205085754395
Epoch: 44, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.628 Vali Acc: 0.904 Test Loss: 0.628 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903697).  Saving model ...
Epoch: 45 cost time: 0.391937255859375
Epoch: 45, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.611 Vali Acc: 0.911 Test Loss: 0.611 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 46 cost time: 0.33988142013549805
Epoch: 46, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.596 Vali Acc: 0.919 Test Loss: 0.596 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 47 cost time: 0.3331890106201172
Epoch: 47, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.581 Vali Acc: 0.922 Test Loss: 0.581 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922216).  Saving model ...
Epoch: 48 cost time: 0.31265997886657715
Epoch: 48, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.567 Vali Acc: 0.922 Test Loss: 0.567 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 49 cost time: 0.3424055576324463
Epoch: 49, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.554 Vali Acc: 0.922 Test Loss: 0.554 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 50 cost time: 0.3211228847503662
Epoch: 50, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.542 Vali Acc: 0.930 Test Loss: 0.542 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929624).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 28102
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5887861251831055
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.784 Vali Acc: 0.193 Test Loss: 1.784 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.33870410919189453
Epoch: 2, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.774 Vali Acc: 0.215 Test Loss: 1.774 Test Acc: 0.215
Validation loss decreased (-0.192575 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.3676130771636963
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.761 Vali Acc: 0.248 Test Loss: 1.761 Test Acc: 0.248
Validation loss decreased (-0.214797 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.37346315383911133
Epoch: 4, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.738 Vali Acc: 0.374 Test Loss: 1.738 Test Acc: 0.374
Validation loss decreased (-0.248131 --> -0.374057).  Saving model ...
Epoch: 5 cost time: 0.3782076835632324
Epoch: 5, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.706 Vali Acc: 0.474 Test Loss: 1.706 Test Acc: 0.474
Validation loss decreased (-0.374057 --> -0.474057).  Saving model ...
Epoch: 6 cost time: 0.3582117557525635
Epoch: 6, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.663 Vali Acc: 0.589 Test Loss: 1.663 Test Acc: 0.589
Validation loss decreased (-0.474057 --> -0.588872).  Saving model ...
Epoch: 7 cost time: 0.3926715850830078
Epoch: 7, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.609 Vali Acc: 0.659 Test Loss: 1.609 Test Acc: 0.659
Validation loss decreased (-0.588872 --> -0.659243).  Saving model ...
Epoch: 8 cost time: 0.36878395080566406
Epoch: 8, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.543 Vali Acc: 0.719 Test Loss: 1.543 Test Acc: 0.719
Validation loss decreased (-0.659243 --> -0.718503).  Saving model ...
Epoch: 9 cost time: 0.3732297420501709
Epoch: 9, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.467 Vali Acc: 0.781 Test Loss: 1.467 Test Acc: 0.781
Validation loss decreased (-0.718503 --> -0.781467).  Saving model ...
Epoch: 10 cost time: 0.36974239349365234
Epoch: 10, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.380 Vali Acc: 0.859 Test Loss: 1.380 Test Acc: 0.859
Validation loss decreased (-0.781467 --> -0.859245).  Saving model ...
Epoch: 11 cost time: 0.4422340393066406
Epoch: 11, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.285 Vali Acc: 0.893 Test Loss: 1.285 Test Acc: 0.893
Validation loss decreased (-0.859245 --> -0.892580).  Saving model ...
Epoch: 12 cost time: 0.3714921474456787
Epoch: 12, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.182 Vali Acc: 0.885 Test Loss: 1.182 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.36546778678894043
Epoch: 13, Steps: 2 | Train Loss: 0.867 Vali Loss: 1.074 Vali Acc: 0.911 Test Loss: 1.074 Test Acc: 0.911
Validation loss decreased (-0.892580 --> -0.911100).  Saving model ...
Epoch: 14 cost time: 0.35735440254211426
Epoch: 14, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.963 Vali Acc: 0.930 Test Loss: 0.963 Test Acc: 0.930
Validation loss decreased (-0.911100 --> -0.929620).  Saving model ...
Epoch: 15 cost time: 0.36775946617126465
Epoch: 15, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.854 Vali Acc: 0.933 Test Loss: 0.854 Test Acc: 0.933
Validation loss decreased (-0.929620 --> -0.933325).  Saving model ...
Epoch: 16 cost time: 0.3464012145996094
Epoch: 16, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.747 Vali Acc: 0.933 Test Loss: 0.747 Test Acc: 0.933
Validation loss decreased (-0.933325 --> -0.933326).  Saving model ...
Epoch: 17 cost time: 0.36873507499694824
Epoch: 17, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.647 Vali Acc: 0.937 Test Loss: 0.647 Test Acc: 0.937
Validation loss decreased (-0.933326 --> -0.937031).  Saving model ...
Epoch: 18 cost time: 0.40830326080322266
Epoch: 18, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.556 Vali Acc: 0.948 Test Loss: 0.556 Test Acc: 0.948
Validation loss decreased (-0.937031 --> -0.948143).  Saving model ...
Epoch: 19 cost time: 0.3562288284301758
Epoch: 19, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.475 Vali Acc: 0.952 Test Loss: 0.475 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 20 cost time: 0.3638124465942383
Epoch: 20, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.407 Vali Acc: 0.963 Test Loss: 0.407 Test Acc: 0.963
Validation loss decreased (-0.951847 --> -0.962959).  Saving model ...
Epoch: 21 cost time: 0.3524744510650635
Epoch: 21, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.354 Vali Acc: 0.956 Test Loss: 0.354 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.350311279296875
Epoch: 22, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.311 Vali Acc: 0.956 Test Loss: 0.311 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3685915470123291
Epoch: 23, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.278 Vali Acc: 0.959 Test Loss: 0.278 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3814206123352051
Epoch: 24, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.253 Vali Acc: 0.963 Test Loss: 0.253 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962960).  Saving model ...
Epoch: 25 cost time: 0.3666365146636963
Epoch: 25, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.233 Vali Acc: 0.959 Test Loss: 0.233 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.36425161361694336
Epoch: 26, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.38042116165161133
Epoch: 27, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.33689212799072266
Epoch: 28, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3815174102783203
Epoch: 29, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.37267065048217773
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.39858317375183105
Epoch: 31, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962961).  Saving model ...
Epoch: 32 cost time: 0.3648853302001953
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.3518047332763672
Epoch: 33, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 34 cost time: 0.4100472927093506
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 35 cost time: 0.3566765785217285
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 36 cost time: 0.40375661849975586
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 37 cost time: 0.39914727210998535
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.37211012840270996
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.3814055919647217
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.34973955154418945
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.3586599826812744
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.3876798152923584
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.354672908782959
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.39005136489868164
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.37169599533081055
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.3794863224029541
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 276198
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.3483684062957764
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.779 Vali Acc: 0.241 Test Loss: 1.779 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.3397495746612549
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.769 Vali Acc: 0.270 Test Loss: 1.769 Test Acc: 0.270
Validation loss decreased (-0.240723 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.3441171646118164
Epoch: 3, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.759 Vali Acc: 0.281 Test Loss: 1.759 Test Acc: 0.281
Validation loss decreased (-0.270353 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.40274930000305176
Epoch: 4, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.745 Vali Acc: 0.296 Test Loss: 1.745 Test Acc: 0.296
Validation loss decreased (-0.281464 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.36159181594848633
Epoch: 5, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.726 Vali Acc: 0.356 Test Loss: 1.726 Test Acc: 0.356
Validation loss decreased (-0.296279 --> -0.355538).  Saving model ...
Epoch: 6 cost time: 0.35753369331359863
Epoch: 6, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.701 Vali Acc: 0.393 Test Loss: 1.701 Test Acc: 0.393
Validation loss decreased (-0.355538 --> -0.392576).  Saving model ...
Epoch: 7 cost time: 0.35634469985961914
Epoch: 7, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.670 Vali Acc: 0.433 Test Loss: 1.670 Test Acc: 0.433
Validation loss decreased (-0.392576 --> -0.433317).  Saving model ...
Epoch: 8 cost time: 0.38039207458496094
Epoch: 8, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.633 Vali Acc: 0.541 Test Loss: 1.633 Test Acc: 0.541
Validation loss decreased (-0.433317 --> -0.540724).  Saving model ...
Epoch: 9 cost time: 0.3630547523498535
Epoch: 9, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.591 Vali Acc: 0.633 Test Loss: 1.591 Test Acc: 0.633
Validation loss decreased (-0.540724 --> -0.633317).  Saving model ...
Epoch: 10 cost time: 0.37048959732055664
Epoch: 10, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.543 Vali Acc: 0.693 Test Loss: 1.543 Test Acc: 0.693
Validation loss decreased (-0.633317 --> -0.692577).  Saving model ...
Epoch: 11 cost time: 0.3604762554168701
Epoch: 11, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.489 Vali Acc: 0.748 Test Loss: 1.489 Test Acc: 0.748
Validation loss decreased (-0.692577 --> -0.748133).  Saving model ...
Epoch: 12 cost time: 0.400315523147583
Epoch: 12, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.430 Vali Acc: 0.781 Test Loss: 1.430 Test Acc: 0.781
Validation loss decreased (-0.748133 --> -0.781467).  Saving model ...
Epoch: 13 cost time: 0.360196590423584
Epoch: 13, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.365 Vali Acc: 0.804 Test Loss: 1.365 Test Acc: 0.804
Validation loss decreased (-0.781467 --> -0.803690).  Saving model ...
Epoch: 14 cost time: 0.3446333408355713
Epoch: 14, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.297 Vali Acc: 0.822 Test Loss: 1.297 Test Acc: 0.822
Validation loss decreased (-0.803690 --> -0.822209).  Saving model ...
Epoch: 15 cost time: 0.3692166805267334
Epoch: 15, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.223 Vali Acc: 0.837 Test Loss: 1.223 Test Acc: 0.837
Validation loss decreased (-0.822209 --> -0.837025).  Saving model ...
Epoch: 16 cost time: 0.34694528579711914
Epoch: 16, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.147 Vali Acc: 0.848 Test Loss: 1.147 Test Acc: 0.848
Validation loss decreased (-0.837025 --> -0.848137).  Saving model ...
Epoch: 17 cost time: 0.4149158000946045
Epoch: 17, Steps: 2 | Train Loss: 0.847 Vali Loss: 1.070 Vali Acc: 0.859 Test Loss: 1.070 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859249).  Saving model ...
Epoch: 18 cost time: 0.363262414932251
Epoch: 18, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.993 Vali Acc: 0.859 Test Loss: 0.993 Test Acc: 0.859
Validation loss decreased (-0.859249 --> -0.859249).  Saving model ...
Epoch: 19 cost time: 0.37574076652526855
Epoch: 19, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.916 Vali Acc: 0.889 Test Loss: 0.916 Test Acc: 0.889
Validation loss decreased (-0.859249 --> -0.888880).  Saving model ...
Epoch: 20 cost time: 0.4215836524963379
Epoch: 20, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.842 Vali Acc: 0.885 Test Loss: 0.842 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.3466649055480957
Epoch: 21, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.771 Vali Acc: 0.896 Test Loss: 0.771 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896289).  Saving model ...
Epoch: 22 cost time: 0.36891627311706543
Epoch: 22, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.704 Vali Acc: 0.907 Test Loss: 0.704 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907400).  Saving model ...
Epoch: 23 cost time: 0.3215513229370117
Epoch: 23, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.642 Vali Acc: 0.907 Test Loss: 0.642 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 24 cost time: 0.3578917980194092
Epoch: 24, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.588 Vali Acc: 0.911 Test Loss: 0.588 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 25 cost time: 0.37149524688720703
Epoch: 25, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.539 Vali Acc: 0.915 Test Loss: 0.539 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 26 cost time: 0.34604382514953613
Epoch: 26, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.496 Vali Acc: 0.911 Test Loss: 0.496 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.34546875953674316
Epoch: 27, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.458 Vali Acc: 0.911 Test Loss: 0.458 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.353867769241333
Epoch: 28, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914811).  Saving model ...
Epoch: 29 cost time: 0.3658280372619629
Epoch: 29, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 30 cost time: 0.38564467430114746
Epoch: 30, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.369 Vali Acc: 0.926 Test Loss: 0.369 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.3688030242919922
Epoch: 31, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.3940458297729492
Epoch: 32, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.327 Vali Acc: 0.926 Test Loss: 0.327 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 33 cost time: 0.32694220542907715
Epoch: 33, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 34 cost time: 0.3420391082763672
Epoch: 34, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.34253931045532227
Epoch: 35, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.35090041160583496
Epoch: 36, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.35094547271728516
Epoch: 37, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.3471062183380127
Epoch: 38, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.36718082427978516
Epoch: 39, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.3727138042449951
Epoch: 40, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.414034366607666
Epoch: 41, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4792647361755371
Epoch: 42, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.3605039119720459
Epoch: 43, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 248614
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6338918209075928
Epoch: 1, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.794 Vali Acc: 0.285 Test Loss: 1.794 Test Acc: 0.285
Validation loss decreased (inf --> -0.285167).  Saving model ...
Epoch: 2 cost time: 0.3545858860015869
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.778 Vali Acc: 0.311 Test Loss: 1.778 Test Acc: 0.311
Validation loss decreased (-0.285167 --> -0.311093).  Saving model ...
Epoch: 3 cost time: 0.4047222137451172
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.762 Vali Acc: 0.322 Test Loss: 1.762 Test Acc: 0.322
Validation loss decreased (-0.311093 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.3882269859313965
Epoch: 4, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.745 Vali Acc: 0.356 Test Loss: 1.745 Test Acc: 0.356
Validation loss decreased (-0.322205 --> -0.355538).  Saving model ...
Epoch: 5 cost time: 0.37302279472351074
Epoch: 5, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.722 Vali Acc: 0.378 Test Loss: 1.722 Test Acc: 0.378
Validation loss decreased (-0.355538 --> -0.377761).  Saving model ...
Epoch: 6 cost time: 0.4029548168182373
Epoch: 6, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.696 Vali Acc: 0.411 Test Loss: 1.696 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411094).  Saving model ...
Epoch: 7 cost time: 0.35503292083740234
Epoch: 7, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.665 Vali Acc: 0.430 Test Loss: 1.665 Test Acc: 0.430
Validation loss decreased (-0.411094 --> -0.429613).  Saving model ...
Epoch: 8 cost time: 0.37644386291503906
Epoch: 8, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.629 Vali Acc: 0.507 Test Loss: 1.629 Test Acc: 0.507
Validation loss decreased (-0.429613 --> -0.507391).  Saving model ...
Epoch: 9 cost time: 0.36409854888916016
Epoch: 9, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.590 Vali Acc: 0.622 Test Loss: 1.590 Test Acc: 0.622
Validation loss decreased (-0.507391 --> -0.622206).  Saving model ...
Epoch: 10 cost time: 0.38059473037719727
Epoch: 10, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.546 Vali Acc: 0.696 Test Loss: 1.546 Test Acc: 0.696
Validation loss decreased (-0.622206 --> -0.696281).  Saving model ...
Epoch: 11 cost time: 0.3561415672302246
Epoch: 11, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.497 Vali Acc: 0.759 Test Loss: 1.497 Test Acc: 0.759
Validation loss decreased (-0.696281 --> -0.759244).  Saving model ...
Epoch: 12 cost time: 0.407726526260376
Epoch: 12, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.446 Vali Acc: 0.819 Test Loss: 1.446 Test Acc: 0.819
Validation loss decreased (-0.759244 --> -0.818504).  Saving model ...
Epoch: 13 cost time: 0.35810351371765137
Epoch: 13, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.390 Vali Acc: 0.870 Test Loss: 1.390 Test Acc: 0.870
Validation loss decreased (-0.818504 --> -0.870356).  Saving model ...
Epoch: 14 cost time: 0.3446042537689209
Epoch: 14, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.330 Vali Acc: 0.896 Test Loss: 1.330 Test Acc: 0.896
Validation loss decreased (-0.870356 --> -0.896283).  Saving model ...
Epoch: 15 cost time: 0.38745784759521484
Epoch: 15, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.265 Vali Acc: 0.911 Test Loss: 1.265 Test Acc: 0.911
Validation loss decreased (-0.896283 --> -0.911098).  Saving model ...
Epoch: 16 cost time: 0.36897754669189453
Epoch: 16, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.198 Vali Acc: 0.919 Test Loss: 1.198 Test Acc: 0.919
Validation loss decreased (-0.911098 --> -0.918507).  Saving model ...
Epoch: 17 cost time: 0.39174485206604004
Epoch: 17, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.129 Vali Acc: 0.915 Test Loss: 1.129 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3820338249206543
Epoch: 18, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.060 Vali Acc: 0.926 Test Loss: 1.060 Test Acc: 0.926
Validation loss decreased (-0.918507 --> -0.925915).  Saving model ...
Epoch: 19 cost time: 0.37795400619506836
Epoch: 19, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.990 Vali Acc: 0.933 Test Loss: 0.990 Test Acc: 0.933
Validation loss decreased (-0.925915 --> -0.933323).  Saving model ...
Epoch: 20 cost time: 0.37972474098205566
Epoch: 20, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.919 Vali Acc: 0.933 Test Loss: 0.919 Test Acc: 0.933
Validation loss decreased (-0.933323 --> -0.933324).  Saving model ...
Epoch: 21 cost time: 0.33943772315979004
Epoch: 21, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.848 Vali Acc: 0.933 Test Loss: 0.848 Test Acc: 0.933
Validation loss decreased (-0.933324 --> -0.933325).  Saving model ...
Epoch: 22 cost time: 0.3630661964416504
Epoch: 22, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.780 Vali Acc: 0.937 Test Loss: 0.780 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937029).  Saving model ...
Epoch: 23 cost time: 0.3508031368255615
Epoch: 23, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.714 Vali Acc: 0.930 Test Loss: 0.714 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.35106778144836426
Epoch: 24, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.653 Vali Acc: 0.941 Test Loss: 0.653 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940734).  Saving model ...
Epoch: 25 cost time: 0.3931427001953125
Epoch: 25, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.598 Vali Acc: 0.937 Test Loss: 0.598 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.38282012939453125
Epoch: 26, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.547 Vali Acc: 0.941 Test Loss: 0.547 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 27 cost time: 0.36835718154907227
Epoch: 27, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.502 Vali Acc: 0.937 Test Loss: 0.502 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.37544679641723633
Epoch: 28, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.461 Vali Acc: 0.944 Test Loss: 0.461 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944440).  Saving model ...
Epoch: 29 cost time: 0.3865978717803955
Epoch: 29, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.426 Vali Acc: 0.944 Test Loss: 0.426 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 30 cost time: 0.35341548919677734
Epoch: 30, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.394 Vali Acc: 0.944 Test Loss: 0.394 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 31 cost time: 0.37101006507873535
Epoch: 31, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.367 Vali Acc: 0.952 Test Loss: 0.367 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 32 cost time: 0.35646963119506836
Epoch: 32, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.343 Vali Acc: 0.952 Test Loss: 0.343 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 33 cost time: 0.40073633193969727
Epoch: 33, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.322 Vali Acc: 0.952 Test Loss: 0.322 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.44022512435913086
Epoch: 34, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.303 Vali Acc: 0.952 Test Loss: 0.303 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.3525421619415283
Epoch: 35, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.3340115547180176
Epoch: 36, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.3311452865600586
Epoch: 37, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.261 Vali Acc: 0.952 Test Loss: 0.261 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.3478372097015381
Epoch: 38, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.251 Vali Acc: 0.952 Test Loss: 0.251 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.3917229175567627
Epoch: 39, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.36156558990478516
Epoch: 40, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.235 Vali Acc: 0.952 Test Loss: 0.235 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.39048218727111816
Epoch: 41, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.38833165168762207
Epoch: 42, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4092874526977539
Epoch: 43, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.40734434127807617
Epoch: 44, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.41967344284057617
Epoch: 45, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.3678112030029297
Epoch: 46, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.42632222175598145
Epoch: 47, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.39816856384277344
Epoch: 48, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.4969942569732666
Epoch: 49, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.3491480350494385
Epoch: 50, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 242502
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4434027671813965
Epoch: 1, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.781 Vali Acc: 0.148 Test Loss: 1.781 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.35303282737731934
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.773 Vali Acc: 0.159 Test Loss: 1.773 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159242).  Saving model ...
Epoch: 3 cost time: 0.39823365211486816
Epoch: 3, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.766 Vali Acc: 0.163 Test Loss: 1.766 Test Acc: 0.163
Validation loss decreased (-0.159242 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.48610591888427734
Epoch: 4, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.757 Vali Acc: 0.181 Test Loss: 1.757 Test Acc: 0.181
Validation loss decreased (-0.162945 --> -0.181464).  Saving model ...
Epoch: 5 cost time: 0.4026002883911133
Epoch: 5, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.745 Vali Acc: 0.211 Test Loss: 1.745 Test Acc: 0.211
Validation loss decreased (-0.181464 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 0.39421725273132324
Epoch: 6, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.729 Vali Acc: 0.248 Test Loss: 1.729 Test Acc: 0.248
Validation loss decreased (-0.211094 --> -0.248131).  Saving model ...
Epoch: 7 cost time: 0.41994619369506836
Epoch: 7, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.710 Vali Acc: 0.293 Test Loss: 1.710 Test Acc: 0.293
Validation loss decreased (-0.248131 --> -0.292575).  Saving model ...
Epoch: 8 cost time: 0.39468836784362793
Epoch: 8, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.687 Vali Acc: 0.407 Test Loss: 1.687 Test Acc: 0.407
Validation loss decreased (-0.292575 --> -0.407391).  Saving model ...
Epoch: 9 cost time: 0.3829171657562256
Epoch: 9, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.660 Vali Acc: 0.522 Test Loss: 1.660 Test Acc: 0.522
Validation loss decreased (-0.407391 --> -0.522206).  Saving model ...
Epoch: 10 cost time: 0.38616204261779785
Epoch: 10, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.629 Vali Acc: 0.585 Test Loss: 1.629 Test Acc: 0.585
Validation loss decreased (-0.522206 --> -0.585169).  Saving model ...
Epoch: 11 cost time: 0.42772817611694336
Epoch: 11, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.594 Vali Acc: 0.663 Test Loss: 1.594 Test Acc: 0.663
Validation loss decreased (-0.585169 --> -0.662947).  Saving model ...
Epoch: 12 cost time: 0.38451075553894043
Epoch: 12, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.556 Vali Acc: 0.711 Test Loss: 1.556 Test Acc: 0.711
Validation loss decreased (-0.662947 --> -0.711096).  Saving model ...
Epoch: 13 cost time: 0.36942505836486816
Epoch: 13, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.515 Vali Acc: 0.763 Test Loss: 1.515 Test Acc: 0.763
Validation loss decreased (-0.711096 --> -0.762948).  Saving model ...
Epoch: 14 cost time: 0.4091353416442871
Epoch: 14, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.471 Vali Acc: 0.789 Test Loss: 1.471 Test Acc: 0.789
Validation loss decreased (-0.762948 --> -0.788874).  Saving model ...
Epoch: 15 cost time: 0.3731396198272705
Epoch: 15, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.424 Vali Acc: 0.819 Test Loss: 1.424 Test Acc: 0.819
Validation loss decreased (-0.788874 --> -0.818504).  Saving model ...
Epoch: 16 cost time: 0.3795738220214844
Epoch: 16, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.373 Vali Acc: 0.856 Test Loss: 1.373 Test Acc: 0.856
Validation loss decreased (-0.818504 --> -0.855542).  Saving model ...
Epoch: 17 cost time: 0.390791654586792
Epoch: 17, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.320 Vali Acc: 0.878 Test Loss: 1.320 Test Acc: 0.878
Validation loss decreased (-0.855542 --> -0.877765).  Saving model ...
Epoch: 18 cost time: 0.3564491271972656
Epoch: 18, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.265 Vali Acc: 0.889 Test Loss: 1.265 Test Acc: 0.889
Validation loss decreased (-0.877765 --> -0.888876).  Saving model ...
Epoch: 19 cost time: 0.3843269348144531
Epoch: 19, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.208 Vali Acc: 0.904 Test Loss: 1.208 Test Acc: 0.904
Validation loss decreased (-0.888876 --> -0.903692).  Saving model ...
Epoch: 20 cost time: 0.3787083625793457
Epoch: 20, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.149 Vali Acc: 0.915 Test Loss: 1.149 Test Acc: 0.915
Validation loss decreased (-0.903692 --> -0.914803).  Saving model ...
Epoch: 21 cost time: 0.4071950912475586
Epoch: 21, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.090 Vali Acc: 0.915 Test Loss: 1.090 Test Acc: 0.915
Validation loss decreased (-0.914803 --> -0.914804).  Saving model ...
Epoch: 22 cost time: 0.4038107395172119
Epoch: 22, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.031 Vali Acc: 0.915 Test Loss: 1.031 Test Acc: 0.915
Validation loss decreased (-0.914804 --> -0.914805).  Saving model ...
Epoch: 23 cost time: 0.4564857482910156
Epoch: 23, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.973 Vali Acc: 0.919 Test Loss: 0.973 Test Acc: 0.919
Validation loss decreased (-0.914805 --> -0.918509).  Saving model ...
Epoch: 24 cost time: 0.4058868885040283
Epoch: 24, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.917 Vali Acc: 0.922 Test Loss: 0.917 Test Acc: 0.922
Validation loss decreased (-0.918509 --> -0.922213).  Saving model ...
Epoch: 25 cost time: 0.3661997318267822
Epoch: 25, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.863 Vali Acc: 0.922 Test Loss: 0.863 Test Acc: 0.922
Validation loss decreased (-0.922213 --> -0.922214).  Saving model ...
Epoch: 26 cost time: 0.3550567626953125
Epoch: 26, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.812 Vali Acc: 0.926 Test Loss: 0.812 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925918).  Saving model ...
Epoch: 27 cost time: 0.39094018936157227
Epoch: 27, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.763 Vali Acc: 0.930 Test Loss: 0.763 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 28 cost time: 0.4937138557434082
Epoch: 28, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.719 Vali Acc: 0.926 Test Loss: 0.719 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.41939377784729004
Epoch: 29, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.677 Vali Acc: 0.926 Test Loss: 0.677 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.3580760955810547
Epoch: 30, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.637 Vali Acc: 0.926 Test Loss: 0.637 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.368436336517334
Epoch: 31, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.602 Vali Acc: 0.930 Test Loss: 0.602 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929624).  Saving model ...
Epoch: 32 cost time: 0.4212818145751953
Epoch: 32, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.570 Vali Acc: 0.930 Test Loss: 0.570 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 33 cost time: 0.42762088775634766
Epoch: 33, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.540 Vali Acc: 0.930 Test Loss: 0.540 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 34 cost time: 0.41276001930236816
Epoch: 34, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.514 Vali Acc: 0.933 Test Loss: 0.514 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 35 cost time: 0.37804484367370605
Epoch: 35, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.490 Vali Acc: 0.937 Test Loss: 0.490 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 36 cost time: 0.3835299015045166
Epoch: 36, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.467 Vali Acc: 0.944 Test Loss: 0.467 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 37 cost time: 0.4192488193511963
Epoch: 37, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.446 Vali Acc: 0.944 Test Loss: 0.446 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 38 cost time: 0.436981201171875
Epoch: 38, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.427 Vali Acc: 0.944 Test Loss: 0.427 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 39 cost time: 0.3523571491241455
Epoch: 39, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.410 Vali Acc: 0.948 Test Loss: 0.410 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 40 cost time: 0.3609912395477295
Epoch: 40, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.394 Vali Acc: 0.952 Test Loss: 0.394 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 41 cost time: 0.4257392883300781
Epoch: 41, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.380 Vali Acc: 0.952 Test Loss: 0.380 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 42 cost time: 0.40483903884887695
Epoch: 42, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.366 Vali Acc: 0.952 Test Loss: 0.366 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 43 cost time: 0.3666245937347412
Epoch: 43, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.353 Vali Acc: 0.956 Test Loss: 0.353 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 44 cost time: 0.36652135848999023
Epoch: 44, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.341 Vali Acc: 0.956 Test Loss: 0.341 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 45 cost time: 0.4856603145599365
Epoch: 45, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.330 Vali Acc: 0.956 Test Loss: 0.330 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 46 cost time: 0.3941013813018799
Epoch: 46, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.321 Vali Acc: 0.956 Test Loss: 0.321 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 47 cost time: 0.38900136947631836
Epoch: 47, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.312 Vali Acc: 0.959 Test Loss: 0.312 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 48 cost time: 0.3685324192047119
Epoch: 48, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.304 Vali Acc: 0.959 Test Loss: 0.304 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 49 cost time: 0.36463356018066406
Epoch: 49, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.297 Vali Acc: 0.959 Test Loss: 0.297 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 50 cost time: 0.4117424488067627
Epoch: 50, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.291 Vali Acc: 0.959 Test Loss: 0.291 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 236422
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6394660472869873
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.793 Vali Acc: 0.167 Test Loss: 1.793 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.46714019775390625
Epoch: 2, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.787 Vali Acc: 0.200 Test Loss: 1.787 Test Acc: 0.200
Validation loss decreased (-0.166649 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.38959503173828125
Epoch: 3, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.781 Vali Acc: 0.244 Test Loss: 1.781 Test Acc: 0.244
Validation loss decreased (-0.199982 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.3787393569946289
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.773 Vali Acc: 0.307 Test Loss: 1.773 Test Acc: 0.307
Validation loss decreased (-0.244427 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.38532352447509766
Epoch: 5, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.761 Vali Acc: 0.348 Test Loss: 1.761 Test Acc: 0.348
Validation loss decreased (-0.307390 --> -0.348131).  Saving model ...
Epoch: 6 cost time: 0.3810238838195801
Epoch: 6, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.744 Vali Acc: 0.393 Test Loss: 1.744 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392575).  Saving model ...
Epoch: 7 cost time: 0.3705918788909912
Epoch: 7, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.724 Vali Acc: 0.452 Test Loss: 1.724 Test Acc: 0.452
Validation loss decreased (-0.392575 --> -0.451835).  Saving model ...
Epoch: 8 cost time: 0.36748576164245605
Epoch: 8, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.700 Vali Acc: 0.533 Test Loss: 1.700 Test Acc: 0.533
Validation loss decreased (-0.451835 --> -0.533316).  Saving model ...
Epoch: 9 cost time: 0.399259090423584
Epoch: 9, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.672 Vali Acc: 0.615 Test Loss: 1.672 Test Acc: 0.615
Validation loss decreased (-0.533316 --> -0.614798).  Saving model ...
Epoch: 10 cost time: 0.38787126541137695
Epoch: 10, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.641 Vali Acc: 0.633 Test Loss: 1.641 Test Acc: 0.633
Validation loss decreased (-0.614798 --> -0.633317).  Saving model ...
Epoch: 11 cost time: 0.40122222900390625
Epoch: 11, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.606 Vali Acc: 0.656 Test Loss: 1.606 Test Acc: 0.656
Validation loss decreased (-0.633317 --> -0.655539).  Saving model ...
Epoch: 12 cost time: 0.36550164222717285
Epoch: 12, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.568 Vali Acc: 0.707 Test Loss: 1.568 Test Acc: 0.707
Validation loss decreased (-0.655539 --> -0.707392).  Saving model ...
Epoch: 13 cost time: 0.407928466796875
Epoch: 13, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.528 Vali Acc: 0.741 Test Loss: 1.528 Test Acc: 0.741
Validation loss decreased (-0.707392 --> -0.740725).  Saving model ...
Epoch: 14 cost time: 0.4082915782928467
Epoch: 14, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.484 Vali Acc: 0.781 Test Loss: 1.484 Test Acc: 0.781
Validation loss decreased (-0.740725 --> -0.781467).  Saving model ...
Epoch: 15 cost time: 0.3743727207183838
Epoch: 15, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.438 Vali Acc: 0.819 Test Loss: 1.438 Test Acc: 0.819
Validation loss decreased (-0.781467 --> -0.818504).  Saving model ...
Epoch: 16 cost time: 0.3547098636627197
Epoch: 16, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.389 Vali Acc: 0.833 Test Loss: 1.389 Test Acc: 0.833
Validation loss decreased (-0.818504 --> -0.833319).  Saving model ...
Epoch: 17 cost time: 0.49356675148010254
Epoch: 17, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.337 Vali Acc: 0.841 Test Loss: 1.337 Test Acc: 0.841
Validation loss decreased (-0.833319 --> -0.840727).  Saving model ...
Epoch: 18 cost time: 0.38614940643310547
Epoch: 18, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.283 Vali Acc: 0.852 Test Loss: 1.283 Test Acc: 0.852
Validation loss decreased (-0.840727 --> -0.851839).  Saving model ...
Epoch: 19 cost time: 0.5099880695343018
Epoch: 19, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.228 Vali Acc: 0.863 Test Loss: 1.228 Test Acc: 0.863
Validation loss decreased (-0.851839 --> -0.862951).  Saving model ...
Epoch: 20 cost time: 0.37760019302368164
Epoch: 20, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.171 Vali Acc: 0.863 Test Loss: 1.171 Test Acc: 0.863
Validation loss decreased (-0.862951 --> -0.862951).  Saving model ...
Epoch: 21 cost time: 0.38700318336486816
Epoch: 21, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.113 Vali Acc: 0.878 Test Loss: 1.113 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877767).  Saving model ...
Epoch: 22 cost time: 0.4435431957244873
Epoch: 22, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.055 Vali Acc: 0.881 Test Loss: 1.055 Test Acc: 0.881
Validation loss decreased (-0.877767 --> -0.881471).  Saving model ...
Epoch: 23 cost time: 0.39286017417907715
Epoch: 23, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.997 Vali Acc: 0.889 Test Loss: 0.997 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888879).  Saving model ...
Epoch: 24 cost time: 0.43980908393859863
Epoch: 24, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.939 Vali Acc: 0.900 Test Loss: 0.939 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899991).  Saving model ...
Epoch: 25 cost time: 0.40467405319213867
Epoch: 25, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.883 Vali Acc: 0.904 Test Loss: 0.883 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903695).  Saving model ...
Epoch: 26 cost time: 0.4324953556060791
Epoch: 26, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.829 Vali Acc: 0.915 Test Loss: 0.829 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914807).  Saving model ...
Epoch: 27 cost time: 0.3838949203491211
Epoch: 27, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.777 Vali Acc: 0.919 Test Loss: 0.777 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 28 cost time: 0.3919801712036133
Epoch: 28, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.728 Vali Acc: 0.919 Test Loss: 0.728 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 29 cost time: 0.36264848709106445
Epoch: 29, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.682 Vali Acc: 0.919 Test Loss: 0.682 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918512).  Saving model ...
Epoch: 30 cost time: 0.37041234970092773
Epoch: 30, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.639 Vali Acc: 0.926 Test Loss: 0.639 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 31 cost time: 0.3880348205566406
Epoch: 31, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.598 Vali Acc: 0.930 Test Loss: 0.598 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 32 cost time: 0.40661168098449707
Epoch: 32, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.561 Vali Acc: 0.930 Test Loss: 0.561 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 33 cost time: 0.4159700870513916
Epoch: 33, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.527 Vali Acc: 0.933 Test Loss: 0.527 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 34 cost time: 0.374408483505249
Epoch: 34, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.496 Vali Acc: 0.944 Test Loss: 0.496 Test Acc: 0.944
Validation loss decreased (-0.933328 --> -0.944439).  Saving model ...
Epoch: 35 cost time: 0.41263723373413086
Epoch: 35, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.468 Vali Acc: 0.944 Test Loss: 0.468 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 36 cost time: 0.36731481552124023
Epoch: 36, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.442 Vali Acc: 0.944 Test Loss: 0.442 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 37 cost time: 0.414905309677124
Epoch: 37, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.419 Vali Acc: 0.944 Test Loss: 0.419 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 38 cost time: 0.42888307571411133
Epoch: 38, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.399 Vali Acc: 0.944 Test Loss: 0.399 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 39 cost time: 0.4091603755950928
Epoch: 39, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.380 Vali Acc: 0.944 Test Loss: 0.380 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.36252403259277344
Epoch: 40, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.362 Vali Acc: 0.952 Test Loss: 0.362 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 41 cost time: 0.36850714683532715
Epoch: 41, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.347 Vali Acc: 0.952 Test Loss: 0.347 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 42 cost time: 0.365917444229126
Epoch: 42, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.333 Vali Acc: 0.952 Test Loss: 0.333 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.3943960666656494
Epoch: 43, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.320 Vali Acc: 0.952 Test Loss: 0.320 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.4420197010040283
Epoch: 44, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.309 Vali Acc: 0.956 Test Loss: 0.309 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955552).  Saving model ...
Epoch: 45 cost time: 0.44008660316467285
Epoch: 45, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.299 Vali Acc: 0.956 Test Loss: 0.299 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.42253541946411133
Epoch: 46, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.290 Vali Acc: 0.956 Test Loss: 0.290 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.47284722328186035
Epoch: 47, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.3879811763763428
Epoch: 48, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.274 Vali Acc: 0.956 Test Loss: 0.274 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.479046106338501
Epoch: 49, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.266 Vali Acc: 0.956 Test Loss: 0.266 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.4276580810546875
Epoch: 50, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.260 Vali Acc: 0.956 Test Loss: 0.260 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 236518
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4546713829040527
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.813 Vali Acc: 0.144 Test Loss: 1.813 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.3538932800292969
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.810 Vali Acc: 0.133 Test Loss: 1.810 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4095020294189453
Epoch: 3, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.807 Vali Acc: 0.130 Test Loss: 1.807 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.36751699447631836
Epoch: 4, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.802 Vali Acc: 0.107 Test Loss: 1.802 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4068753719329834
Epoch: 5, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.795 Vali Acc: 0.096 Test Loss: 1.795 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.42013120651245117
Epoch: 6, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.785 Vali Acc: 0.111 Test Loss: 1.785 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3637261390686035
Epoch: 7, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.772 Vali Acc: 0.141 Test Loss: 1.772 Test Acc: 0.141
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4140286445617676
Epoch: 8, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.755 Vali Acc: 0.226 Test Loss: 1.755 Test Acc: 0.226
Validation loss decreased (-0.144426 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.41058969497680664
Epoch: 9, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.735 Vali Acc: 0.267 Test Loss: 1.735 Test Acc: 0.267
Validation loss decreased (-0.225908 --> -0.266649).  Saving model ...
Epoch: 10 cost time: 0.4211559295654297
Epoch: 10, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.712 Vali Acc: 0.304 Test Loss: 1.712 Test Acc: 0.304
Validation loss decreased (-0.266649 --> -0.303687).  Saving model ...
Epoch: 11 cost time: 0.3675680160522461
Epoch: 11, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.685 Vali Acc: 0.337 Test Loss: 1.685 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337020).  Saving model ...
Epoch: 12 cost time: 0.38880467414855957
Epoch: 12, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.656 Vali Acc: 0.396 Test Loss: 1.656 Test Acc: 0.396
Validation loss decreased (-0.337020 --> -0.396280).  Saving model ...
Epoch: 13 cost time: 0.4393961429595947
Epoch: 13, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.623 Vali Acc: 0.515 Test Loss: 1.623 Test Acc: 0.515
Validation loss decreased (-0.396280 --> -0.514799).  Saving model ...
Epoch: 14 cost time: 0.39894747734069824
Epoch: 14, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.587 Vali Acc: 0.596 Test Loss: 1.587 Test Acc: 0.596
Validation loss decreased (-0.514799 --> -0.596280).  Saving model ...
Epoch: 15 cost time: 0.40023207664489746
Epoch: 15, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.549 Vali Acc: 0.637 Test Loss: 1.549 Test Acc: 0.637
Validation loss decreased (-0.596280 --> -0.637022).  Saving model ...
Epoch: 16 cost time: 0.37958335876464844
Epoch: 16, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.509 Vali Acc: 0.656 Test Loss: 1.509 Test Acc: 0.656
Validation loss decreased (-0.637022 --> -0.655540).  Saving model ...
Epoch: 17 cost time: 0.4138321876525879
Epoch: 17, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.468 Vali Acc: 0.693 Test Loss: 1.468 Test Acc: 0.693
Validation loss decreased (-0.655540 --> -0.692578).  Saving model ...
Epoch: 18 cost time: 0.38287878036499023
Epoch: 18, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.423 Vali Acc: 0.726 Test Loss: 1.423 Test Acc: 0.726
Validation loss decreased (-0.692578 --> -0.725912).  Saving model ...
Epoch: 19 cost time: 0.4374823570251465
Epoch: 19, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.378 Vali Acc: 0.759 Test Loss: 1.378 Test Acc: 0.759
Validation loss decreased (-0.725912 --> -0.759245).  Saving model ...
Epoch: 20 cost time: 0.3794369697570801
Epoch: 20, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.331 Vali Acc: 0.789 Test Loss: 1.331 Test Acc: 0.789
Validation loss decreased (-0.759245 --> -0.788876).  Saving model ...
Epoch: 21 cost time: 0.38260698318481445
Epoch: 21, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.283 Vali Acc: 0.804 Test Loss: 1.283 Test Acc: 0.804
Validation loss decreased (-0.788876 --> -0.803691).  Saving model ...
Epoch: 22 cost time: 0.40703845024108887
Epoch: 22, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.235 Vali Acc: 0.811 Test Loss: 1.235 Test Acc: 0.811
Validation loss decreased (-0.803691 --> -0.811099).  Saving model ...
Epoch: 23 cost time: 0.38137388229370117
Epoch: 23, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.186 Vali Acc: 0.819 Test Loss: 1.186 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818507).  Saving model ...
Epoch: 24 cost time: 0.38670945167541504
Epoch: 24, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.136 Vali Acc: 0.837 Test Loss: 1.136 Test Acc: 0.837
Validation loss decreased (-0.818507 --> -0.837026).  Saving model ...
Epoch: 25 cost time: 0.4260237216949463
Epoch: 25, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.087 Vali Acc: 0.863 Test Loss: 1.087 Test Acc: 0.863
Validation loss decreased (-0.837026 --> -0.862952).  Saving model ...
Epoch: 26 cost time: 0.37469482421875
Epoch: 26, Steps: 2 | Train Loss: 0.812 Vali Loss: 1.038 Vali Acc: 0.867 Test Loss: 1.038 Test Acc: 0.867
Validation loss decreased (-0.862952 --> -0.866656).  Saving model ...
Epoch: 27 cost time: 0.3992576599121094
Epoch: 27, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.991 Vali Acc: 0.870 Test Loss: 0.991 Test Acc: 0.870
Validation loss decreased (-0.866656 --> -0.870360).  Saving model ...
Epoch: 28 cost time: 0.38884949684143066
Epoch: 28, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.943 Vali Acc: 0.881 Test Loss: 0.943 Test Acc: 0.881
Validation loss decreased (-0.870360 --> -0.881472).  Saving model ...
Epoch: 29 cost time: 0.37947750091552734
Epoch: 29, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.899 Vali Acc: 0.885 Test Loss: 0.899 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 30 cost time: 0.4066436290740967
Epoch: 30, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.855 Vali Acc: 0.885 Test Loss: 0.855 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885177).  Saving model ...
Epoch: 31 cost time: 0.38297009468078613
Epoch: 31, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.813 Vali Acc: 0.893 Test Loss: 0.813 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892584).  Saving model ...
Epoch: 32 cost time: 0.37943410873413086
Epoch: 32, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.773 Vali Acc: 0.896 Test Loss: 0.773 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896289).  Saving model ...
Epoch: 33 cost time: 0.3942382335662842
Epoch: 33, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.735 Vali Acc: 0.900 Test Loss: 0.735 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 34 cost time: 0.36285996437072754
Epoch: 34, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.699 Vali Acc: 0.900 Test Loss: 0.699 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 35 cost time: 0.39572739601135254
Epoch: 35, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.664 Vali Acc: 0.904 Test Loss: 0.664 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 36 cost time: 0.4289872646331787
Epoch: 36, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.632 Vali Acc: 0.907 Test Loss: 0.632 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 37 cost time: 0.3497638702392578
Epoch: 37, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.602 Vali Acc: 0.911 Test Loss: 0.602 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 38 cost time: 0.3712913990020752
Epoch: 38, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.574 Vali Acc: 0.911 Test Loss: 0.574 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 39 cost time: 0.4298417568206787
Epoch: 39, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.548 Vali Acc: 0.919 Test Loss: 0.548 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 40 cost time: 0.38900041580200195
Epoch: 40, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.524 Vali Acc: 0.919 Test Loss: 0.524 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 41 cost time: 0.40616703033447266
Epoch: 41, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.502 Vali Acc: 0.919 Test Loss: 0.502 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 42 cost time: 0.3981814384460449
Epoch: 42, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.481 Vali Acc: 0.919 Test Loss: 0.481 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 43 cost time: 0.38175106048583984
Epoch: 43, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.462 Vali Acc: 0.919 Test Loss: 0.462 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 44 cost time: 0.3972315788269043
Epoch: 44, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.445 Vali Acc: 0.919 Test Loss: 0.445 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 45 cost time: 0.4055449962615967
Epoch: 45, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 46 cost time: 0.3919534683227539
Epoch: 46, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.415 Vali Acc: 0.926 Test Loss: 0.415 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 47 cost time: 0.38898754119873047
Epoch: 47, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.401 Vali Acc: 0.933 Test Loss: 0.401 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933329).  Saving model ...
Epoch: 48 cost time: 0.46850061416625977
Epoch: 48, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 49 cost time: 0.3880319595336914
Epoch: 49, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 50 cost time: 0.3659024238586426
Epoch: 50, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.366 Vali Acc: 0.937 Test Loss: 0.366 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 233542
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4903802871704102
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.780 Vali Acc: 0.167 Test Loss: 1.780 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.3692929744720459
Epoch: 2, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.774 Vali Acc: 0.167 Test Loss: 1.774 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.4056727886199951
Epoch: 3, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.769 Vali Acc: 0.163 Test Loss: 1.769 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.45020103454589844
Epoch: 4, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.762 Vali Acc: 0.167 Test Loss: 1.762 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 0.3767709732055664
Epoch: 5, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.752 Vali Acc: 0.178 Test Loss: 1.752 Test Acc: 0.178
Validation loss decreased (-0.166649 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 0.37986159324645996
Epoch: 6, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.740 Vali Acc: 0.200 Test Loss: 1.740 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 0.44642019271850586
Epoch: 7, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.725 Vali Acc: 0.230 Test Loss: 1.725 Test Acc: 0.230
Validation loss decreased (-0.199983 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 0.4796123504638672
Epoch: 8, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.708 Vali Acc: 0.259 Test Loss: 1.708 Test Acc: 0.259
Validation loss decreased (-0.229612 --> -0.259242).  Saving model ...
Epoch: 9 cost time: 0.4037752151489258
Epoch: 9, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.688 Vali Acc: 0.304 Test Loss: 1.688 Test Acc: 0.304
Validation loss decreased (-0.259242 --> -0.303687).  Saving model ...
Epoch: 10 cost time: 0.36254215240478516
Epoch: 10, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.665 Vali Acc: 0.359 Test Loss: 1.665 Test Acc: 0.359
Validation loss decreased (-0.303687 --> -0.359243).  Saving model ...
Epoch: 11 cost time: 0.3755228519439697
Epoch: 11, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.639 Vali Acc: 0.426 Test Loss: 1.639 Test Acc: 0.426
Validation loss decreased (-0.359243 --> -0.425910).  Saving model ...
Epoch: 12 cost time: 0.39649057388305664
Epoch: 12, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.612 Vali Acc: 0.556 Test Loss: 1.612 Test Acc: 0.556
Validation loss decreased (-0.425910 --> -0.555539).  Saving model ...
Epoch: 13 cost time: 0.45511651039123535
Epoch: 13, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.583 Vali Acc: 0.589 Test Loss: 1.583 Test Acc: 0.589
Validation loss decreased (-0.555539 --> -0.588873).  Saving model ...
Epoch: 14 cost time: 0.3933398723602295
Epoch: 14, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.553 Vali Acc: 0.630 Test Loss: 1.553 Test Acc: 0.630
Validation loss decreased (-0.588873 --> -0.629614).  Saving model ...
Epoch: 15 cost time: 0.4506349563598633
Epoch: 15, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.521 Vali Acc: 0.667 Test Loss: 1.521 Test Acc: 0.667
Validation loss decreased (-0.629614 --> -0.666651).  Saving model ...
Epoch: 16 cost time: 0.3922238349914551
Epoch: 16, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.488 Vali Acc: 0.711 Test Loss: 1.488 Test Acc: 0.711
Validation loss decreased (-0.666651 --> -0.711096).  Saving model ...
Epoch: 17 cost time: 0.3920607566833496
Epoch: 17, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.453 Vali Acc: 0.730 Test Loss: 1.453 Test Acc: 0.730
Validation loss decreased (-0.711096 --> -0.729615).  Saving model ...
Epoch: 18 cost time: 0.3999664783477783
Epoch: 18, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.417 Vali Acc: 0.763 Test Loss: 1.417 Test Acc: 0.763
Validation loss decreased (-0.729615 --> -0.762949).  Saving model ...
Epoch: 19 cost time: 0.4081130027770996
Epoch: 19, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.380 Vali Acc: 0.781 Test Loss: 1.380 Test Acc: 0.781
Validation loss decreased (-0.762949 --> -0.781468).  Saving model ...
Epoch: 20 cost time: 0.3894526958465576
Epoch: 20, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.344 Vali Acc: 0.804 Test Loss: 1.344 Test Acc: 0.804
Validation loss decreased (-0.781468 --> -0.803690).  Saving model ...
Epoch: 21 cost time: 0.40983128547668457
Epoch: 21, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.306 Vali Acc: 0.811 Test Loss: 1.306 Test Acc: 0.811
Validation loss decreased (-0.803690 --> -0.811098).  Saving model ...
Epoch: 22 cost time: 0.3855769634246826
Epoch: 22, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.268 Vali Acc: 0.841 Test Loss: 1.268 Test Acc: 0.841
Validation loss decreased (-0.811098 --> -0.840728).  Saving model ...
Epoch: 23 cost time: 0.39629292488098145
Epoch: 23, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.229 Vali Acc: 0.848 Test Loss: 1.229 Test Acc: 0.848
Validation loss decreased (-0.840728 --> -0.848136).  Saving model ...
Epoch: 24 cost time: 0.42295289039611816
Epoch: 24, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.190 Vali Acc: 0.870 Test Loss: 1.190 Test Acc: 0.870
Validation loss decreased (-0.848136 --> -0.870358).  Saving model ...
Epoch: 25 cost time: 0.38219451904296875
Epoch: 25, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.151 Vali Acc: 0.881 Test Loss: 1.151 Test Acc: 0.881
Validation loss decreased (-0.870358 --> -0.881470).  Saving model ...
Epoch: 26 cost time: 0.3958926200866699
Epoch: 26, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.112 Vali Acc: 0.889 Test Loss: 1.112 Test Acc: 0.889
Validation loss decreased (-0.881470 --> -0.888878).  Saving model ...
Epoch: 27 cost time: 0.4310152530670166
Epoch: 27, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.074 Vali Acc: 0.889 Test Loss: 1.074 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888878).  Saving model ...
Epoch: 28 cost time: 0.45205092430114746
Epoch: 28, Steps: 2 | Train Loss: 0.849 Vali Loss: 1.035 Vali Acc: 0.896 Test Loss: 1.035 Test Acc: 0.896
Validation loss decreased (-0.888878 --> -0.896286).  Saving model ...
Epoch: 29 cost time: 0.4340791702270508
Epoch: 29, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.997 Vali Acc: 0.907 Test Loss: 0.997 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907397).  Saving model ...
Epoch: 30 cost time: 0.3843398094177246
Epoch: 30, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.960 Vali Acc: 0.900 Test Loss: 0.960 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4248943328857422
Epoch: 31, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.925 Vali Acc: 0.911 Test Loss: 0.925 Test Acc: 0.911
Validation loss decreased (-0.907397 --> -0.911102).  Saving model ...
Epoch: 32 cost time: 0.39536333084106445
Epoch: 32, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.889 Vali Acc: 0.915 Test Loss: 0.889 Test Acc: 0.915
Validation loss decreased (-0.911102 --> -0.914806).  Saving model ...
Epoch: 33 cost time: 0.4300074577331543
Epoch: 33, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.855 Vali Acc: 0.915 Test Loss: 0.855 Test Acc: 0.915
Validation loss decreased (-0.914806 --> -0.914806).  Saving model ...
Epoch: 34 cost time: 0.4695134162902832
Epoch: 34, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.821 Vali Acc: 0.919 Test Loss: 0.821 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918510).  Saving model ...
Epoch: 35 cost time: 0.37098264694213867
Epoch: 35, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.788 Vali Acc: 0.919 Test Loss: 0.788 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918511).  Saving model ...
Epoch: 36 cost time: 0.3953516483306885
Epoch: 36, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.756 Vali Acc: 0.922 Test Loss: 0.756 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922215).  Saving model ...
Epoch: 37 cost time: 0.3806614875793457
Epoch: 37, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.726 Vali Acc: 0.922 Test Loss: 0.726 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922215).  Saving model ...
Epoch: 38 cost time: 0.38924360275268555
Epoch: 38, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.696 Vali Acc: 0.922 Test Loss: 0.696 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922215).  Saving model ...
Epoch: 39 cost time: 0.3907017707824707
Epoch: 39, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.669 Vali Acc: 0.922 Test Loss: 0.669 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 40 cost time: 0.3812565803527832
Epoch: 40, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.642 Vali Acc: 0.930 Test Loss: 0.642 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929623).  Saving model ...
Epoch: 41 cost time: 0.39604663848876953
Epoch: 41, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.617 Vali Acc: 0.930 Test Loss: 0.617 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 42 cost time: 0.3895845413208008
Epoch: 42, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.594 Vali Acc: 0.930 Test Loss: 0.594 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 43 cost time: 0.4274618625640869
Epoch: 43, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.571 Vali Acc: 0.930 Test Loss: 0.571 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 44 cost time: 0.3684256076812744
Epoch: 44, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.550 Vali Acc: 0.930 Test Loss: 0.550 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 45 cost time: 0.44210219383239746
Epoch: 45, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.530 Vali Acc: 0.930 Test Loss: 0.530 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 46 cost time: 0.3814976215362549
Epoch: 46, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.511 Vali Acc: 0.930 Test Loss: 0.511 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 47 cost time: 0.4069652557373047
Epoch: 47, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.494 Vali Acc: 0.933 Test Loss: 0.494 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933328).  Saving model ...
Epoch: 48 cost time: 0.4460422992706299
Epoch: 48, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.478 Vali Acc: 0.937 Test Loss: 0.478 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 49 cost time: 0.3961944580078125
Epoch: 49, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.462 Vali Acc: 0.937 Test Loss: 0.462 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 50 cost time: 0.3732645511627197
Epoch: 50, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.448 Vali Acc: 0.941 Test Loss: 0.448 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 230598
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4926238059997559
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.777 Vali Acc: 0.178 Test Loss: 1.777 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.395352840423584
Epoch: 2, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.766 Vali Acc: 0.204 Test Loss: 1.766 Test Acc: 0.204
Validation loss decreased (-0.177760 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.41771364212036133
Epoch: 3, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.752 Vali Acc: 0.274 Test Loss: 1.752 Test Acc: 0.274
Validation loss decreased (-0.203686 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.4222245216369629
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.729 Vali Acc: 0.400 Test Loss: 1.729 Test Acc: 0.400
Validation loss decreased (-0.274057 --> -0.399983).  Saving model ...
Epoch: 5 cost time: 0.43814563751220703
Epoch: 5, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.697 Vali Acc: 0.611 Test Loss: 1.697 Test Acc: 0.611
Validation loss decreased (-0.399983 --> -0.611094).  Saving model ...
Epoch: 6 cost time: 0.41024160385131836
Epoch: 6, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.656 Vali Acc: 0.722 Test Loss: 1.656 Test Acc: 0.722
Validation loss decreased (-0.611094 --> -0.722206).  Saving model ...
Epoch: 7 cost time: 0.44613122940063477
Epoch: 7, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.605 Vali Acc: 0.778 Test Loss: 1.605 Test Acc: 0.778
Validation loss decreased (-0.722206 --> -0.777762).  Saving model ...
Epoch: 8 cost time: 0.4253673553466797
Epoch: 8, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.546 Vali Acc: 0.793 Test Loss: 1.546 Test Acc: 0.793
Validation loss decreased (-0.777762 --> -0.792577).  Saving model ...
Epoch: 9 cost time: 0.35601282119750977
Epoch: 9, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.478 Vali Acc: 0.815 Test Loss: 1.478 Test Acc: 0.815
Validation loss decreased (-0.792577 --> -0.814800).  Saving model ...
Epoch: 10 cost time: 0.3718733787536621
Epoch: 10, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.400 Vali Acc: 0.822 Test Loss: 1.400 Test Acc: 0.822
Validation loss decreased (-0.814800 --> -0.822208).  Saving model ...
Epoch: 11 cost time: 0.39002084732055664
Epoch: 11, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.313 Vali Acc: 0.848 Test Loss: 1.313 Test Acc: 0.848
Validation loss decreased (-0.822208 --> -0.848135).  Saving model ...
Epoch: 12 cost time: 0.3755481243133545
Epoch: 12, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.219 Vali Acc: 0.874 Test Loss: 1.219 Test Acc: 0.874
Validation loss decreased (-0.848135 --> -0.874062).  Saving model ...
Epoch: 13 cost time: 0.38422322273254395
Epoch: 13, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.118 Vali Acc: 0.911 Test Loss: 1.118 Test Acc: 0.911
Validation loss decreased (-0.874062 --> -0.911100).  Saving model ...
Epoch: 14 cost time: 0.3839070796966553
Epoch: 14, Steps: 2 | Train Loss: 0.762 Vali Loss: 1.012 Vali Acc: 0.922 Test Loss: 1.012 Test Acc: 0.922
Validation loss decreased (-0.911100 --> -0.922212).  Saving model ...
Epoch: 15 cost time: 0.34855127334594727
Epoch: 15, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.902 Vali Acc: 0.930 Test Loss: 0.902 Test Acc: 0.930
Validation loss decreased (-0.922212 --> -0.929621).  Saving model ...
Epoch: 16 cost time: 0.3846566677093506
Epoch: 16, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.793 Vali Acc: 0.933 Test Loss: 0.793 Test Acc: 0.933
Validation loss decreased (-0.929621 --> -0.933325).  Saving model ...
Epoch: 17 cost time: 0.37548351287841797
Epoch: 17, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.691 Vali Acc: 0.937 Test Loss: 0.691 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937030).  Saving model ...
Epoch: 18 cost time: 0.37107062339782715
Epoch: 18, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.597 Vali Acc: 0.944 Test Loss: 0.597 Test Acc: 0.944
Validation loss decreased (-0.937030 --> -0.944438).  Saving model ...
Epoch: 19 cost time: 0.3822743892669678
Epoch: 19, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.515 Vali Acc: 0.948 Test Loss: 0.515 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948143).  Saving model ...
Epoch: 20 cost time: 0.40845513343811035
Epoch: 20, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.445 Vali Acc: 0.948 Test Loss: 0.445 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 21 cost time: 0.41210412979125977
Epoch: 21, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.384 Vali Acc: 0.948 Test Loss: 0.384 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 22 cost time: 0.38974785804748535
Epoch: 22, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.3983418941497803
Epoch: 23, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.43067240715026855
Epoch: 24, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 25 cost time: 0.38421082496643066
Epoch: 25, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.47519588470458984
Epoch: 26, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.4201977252960205
Epoch: 27, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.3538954257965088
Epoch: 28, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.38893556594848633
Epoch: 29, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.35858821868896484
Epoch: 30, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.3790600299835205
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.41082310676574707
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.3986361026763916
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.39669275283813477
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.39340829849243164
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.39858484268188477
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.38463711738586426
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.3976759910583496
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3825798034667969
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.36643290519714355
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.38396596908569336
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.38562893867492676
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.3964569568634033
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.35149717330932617
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.36548423767089844
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.4044358730316162
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.36132168769836426
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 272614
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4249310493469238
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.757 Vali Acc: 0.241 Test Loss: 1.757 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.342989444732666
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.747 Vali Acc: 0.307 Test Loss: 1.747 Test Acc: 0.307
Validation loss decreased (-0.240723 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.3505251407623291
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.737 Vali Acc: 0.326 Test Loss: 1.737 Test Acc: 0.326
Validation loss decreased (-0.307390 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.3742825984954834
Epoch: 4, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.722 Vali Acc: 0.385 Test Loss: 1.722 Test Acc: 0.385
Validation loss decreased (-0.325909 --> -0.385168).  Saving model ...
Epoch: 5 cost time: 0.4153435230255127
Epoch: 5, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.703 Vali Acc: 0.430 Test Loss: 1.703 Test Acc: 0.430
Validation loss decreased (-0.385168 --> -0.429613).  Saving model ...
Epoch: 6 cost time: 0.3660752773284912
Epoch: 6, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.679 Vali Acc: 0.507 Test Loss: 1.679 Test Acc: 0.507
Validation loss decreased (-0.429613 --> -0.507391).  Saving model ...
Epoch: 7 cost time: 0.4157285690307617
Epoch: 7, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.648 Vali Acc: 0.570 Test Loss: 1.648 Test Acc: 0.570
Validation loss decreased (-0.507391 --> -0.570354).  Saving model ...
Epoch: 8 cost time: 0.4442167282104492
Epoch: 8, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.612 Vali Acc: 0.637 Test Loss: 1.612 Test Acc: 0.637
Validation loss decreased (-0.570354 --> -0.637021).  Saving model ...
Epoch: 9 cost time: 0.4099698066711426
Epoch: 9, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.570 Vali Acc: 0.730 Test Loss: 1.570 Test Acc: 0.730
Validation loss decreased (-0.637021 --> -0.729614).  Saving model ...
Epoch: 10 cost time: 0.37699151039123535
Epoch: 10, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.522 Vali Acc: 0.763 Test Loss: 1.522 Test Acc: 0.763
Validation loss decreased (-0.729614 --> -0.762948).  Saving model ...
Epoch: 11 cost time: 0.36188697814941406
Epoch: 11, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.468 Vali Acc: 0.822 Test Loss: 1.468 Test Acc: 0.822
Validation loss decreased (-0.762948 --> -0.822208).  Saving model ...
Epoch: 12 cost time: 0.35306882858276367
Epoch: 12, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.408 Vali Acc: 0.848 Test Loss: 1.408 Test Acc: 0.848
Validation loss decreased (-0.822208 --> -0.848134).  Saving model ...
Epoch: 13 cost time: 0.37436914443969727
Epoch: 13, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.343 Vali Acc: 0.874 Test Loss: 1.343 Test Acc: 0.874
Validation loss decreased (-0.848134 --> -0.874061).  Saving model ...
Epoch: 14 cost time: 0.4130592346191406
Epoch: 14, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.273 Vali Acc: 0.878 Test Loss: 1.273 Test Acc: 0.878
Validation loss decreased (-0.874061 --> -0.877765).  Saving model ...
Epoch: 15 cost time: 0.3746604919433594
Epoch: 15, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.200 Vali Acc: 0.885 Test Loss: 1.200 Test Acc: 0.885
Validation loss decreased (-0.877765 --> -0.885173).  Saving model ...
Epoch: 16 cost time: 0.4077942371368408
Epoch: 16, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.123 Vali Acc: 0.893 Test Loss: 1.123 Test Acc: 0.893
Validation loss decreased (-0.885173 --> -0.892581).  Saving model ...
Epoch: 17 cost time: 0.43971848487854004
Epoch: 17, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.045 Vali Acc: 0.904 Test Loss: 1.045 Test Acc: 0.904
Validation loss decreased (-0.892581 --> -0.903693).  Saving model ...
Epoch: 18 cost time: 0.3673830032348633
Epoch: 18, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.966 Vali Acc: 0.911 Test Loss: 0.966 Test Acc: 0.911
Validation loss decreased (-0.903693 --> -0.911101).  Saving model ...
Epoch: 19 cost time: 0.3496248722076416
Epoch: 19, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.887 Vali Acc: 0.919 Test Loss: 0.887 Test Acc: 0.919
Validation loss decreased (-0.911101 --> -0.918510).  Saving model ...
Epoch: 20 cost time: 0.37325406074523926
Epoch: 20, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.811 Vali Acc: 0.919 Test Loss: 0.811 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918510).  Saving model ...
Epoch: 21 cost time: 0.3929471969604492
Epoch: 21, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.738 Vali Acc: 0.919 Test Loss: 0.738 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918511).  Saving model ...
Epoch: 22 cost time: 0.44140124320983887
Epoch: 22, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.670 Vali Acc: 0.915 Test Loss: 0.670 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4215431213378906
Epoch: 23, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.606 Vali Acc: 0.919 Test Loss: 0.606 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918512).  Saving model ...
Epoch: 24 cost time: 0.41576290130615234
Epoch: 24, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.549 Vali Acc: 0.919 Test Loss: 0.549 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.3946220874786377
Epoch: 25, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.498 Vali Acc: 0.919 Test Loss: 0.498 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 26 cost time: 0.38681507110595703
Epoch: 26, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.454 Vali Acc: 0.922 Test Loss: 0.454 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 27 cost time: 0.40551161766052246
Epoch: 27, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.416 Vali Acc: 0.926 Test Loss: 0.416 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.4859449863433838
Epoch: 28, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.383 Vali Acc: 0.933 Test Loss: 0.383 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.41745662689208984
Epoch: 29, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.354 Vali Acc: 0.933 Test Loss: 0.354 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.39650869369506836
Epoch: 30, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.43228721618652344
Epoch: 31, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.4579946994781494
Epoch: 32, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.291 Vali Acc: 0.937 Test Loss: 0.291 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.48268723487854004
Epoch: 33, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.4353296756744385
Epoch: 34, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.38327765464782715
Epoch: 35, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.42466235160827637
Epoch: 36, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.42122554779052734
Epoch: 37, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.4209935665130615
Epoch: 38, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.41794800758361816
Epoch: 39, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.37610435485839844
Epoch: 40, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.46738171577453613
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4188418388366699
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.42189955711364746
Epoch: 43, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.42736363410949707
Epoch: 44, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.37870121002197266
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.4062511920928955
Epoch: 46, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.40231871604919434
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.3942298889160156
Epoch: 48, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4369015693664551
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.42087626457214355
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 245030
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4697189331054688
Epoch: 1, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.809 Vali Acc: 0.200 Test Loss: 1.809 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.38791847229003906
Epoch: 2, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.799 Vali Acc: 0.226 Test Loss: 1.799 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.41089653968811035
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.789 Vali Acc: 0.263 Test Loss: 1.789 Test Acc: 0.263
Validation loss decreased (-0.225908 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 0.3949699401855469
Epoch: 4, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.776 Vali Acc: 0.337 Test Loss: 1.776 Test Acc: 0.337
Validation loss decreased (-0.262945 --> -0.337019).  Saving model ...
Epoch: 5 cost time: 0.3942301273345947
Epoch: 5, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.760 Vali Acc: 0.381 Test Loss: 1.760 Test Acc: 0.381
Validation loss decreased (-0.337019 --> -0.381464).  Saving model ...
Epoch: 6 cost time: 0.36818599700927734
Epoch: 6, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.739 Vali Acc: 0.404 Test Loss: 1.739 Test Acc: 0.404
Validation loss decreased (-0.381464 --> -0.403686).  Saving model ...
Epoch: 7 cost time: 0.4357273578643799
Epoch: 7, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.714 Vali Acc: 0.404 Test Loss: 1.714 Test Acc: 0.404
Validation loss decreased (-0.403686 --> -0.403687).  Saving model ...
Epoch: 8 cost time: 0.38326573371887207
Epoch: 8, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.685 Vali Acc: 0.422 Test Loss: 1.685 Test Acc: 0.422
Validation loss decreased (-0.403687 --> -0.422205).  Saving model ...
Epoch: 9 cost time: 0.42502856254577637
Epoch: 9, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.652 Vali Acc: 0.433 Test Loss: 1.652 Test Acc: 0.433
Validation loss decreased (-0.422205 --> -0.433317).  Saving model ...
Epoch: 10 cost time: 0.4027690887451172
Epoch: 10, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.615 Vali Acc: 0.507 Test Loss: 1.615 Test Acc: 0.507
Validation loss decreased (-0.433317 --> -0.507391).  Saving model ...
Epoch: 11 cost time: 0.37864089012145996
Epoch: 11, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.574 Vali Acc: 0.596 Test Loss: 1.574 Test Acc: 0.596
Validation loss decreased (-0.507391 --> -0.596281).  Saving model ...
Epoch: 12 cost time: 0.3854334354400635
Epoch: 12, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.530 Vali Acc: 0.715 Test Loss: 1.530 Test Acc: 0.715
Validation loss decreased (-0.596281 --> -0.714800).  Saving model ...
Epoch: 13 cost time: 0.412416934967041
Epoch: 13, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.481 Vali Acc: 0.804 Test Loss: 1.481 Test Acc: 0.804
Validation loss decreased (-0.714800 --> -0.803689).  Saving model ...
Epoch: 14 cost time: 0.41094470024108887
Epoch: 14, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.429 Vali Acc: 0.807 Test Loss: 1.429 Test Acc: 0.807
Validation loss decreased (-0.803689 --> -0.807393).  Saving model ...
Epoch: 15 cost time: 0.42771339416503906
Epoch: 15, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.374 Vali Acc: 0.837 Test Loss: 1.374 Test Acc: 0.837
Validation loss decreased (-0.807393 --> -0.837023).  Saving model ...
Epoch: 16 cost time: 0.3758273124694824
Epoch: 16, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.314 Vali Acc: 0.856 Test Loss: 1.314 Test Acc: 0.856
Validation loss decreased (-0.837023 --> -0.855542).  Saving model ...
Epoch: 17 cost time: 0.40369510650634766
Epoch: 17, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.252 Vali Acc: 0.874 Test Loss: 1.252 Test Acc: 0.874
Validation loss decreased (-0.855542 --> -0.874062).  Saving model ...
Epoch: 18 cost time: 0.4527730941772461
Epoch: 18, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.187 Vali Acc: 0.878 Test Loss: 1.187 Test Acc: 0.878
Validation loss decreased (-0.874062 --> -0.877766).  Saving model ...
Epoch: 19 cost time: 0.3744852542877197
Epoch: 19, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.119 Vali Acc: 0.885 Test Loss: 1.119 Test Acc: 0.885
Validation loss decreased (-0.877766 --> -0.885174).  Saving model ...
Epoch: 20 cost time: 0.3911278247833252
Epoch: 20, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.048 Vali Acc: 0.885 Test Loss: 1.048 Test Acc: 0.885
Validation loss decreased (-0.885174 --> -0.885175).  Saving model ...
Epoch: 21 cost time: 0.38857388496398926
Epoch: 21, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.977 Vali Acc: 0.893 Test Loss: 0.977 Test Acc: 0.893
Validation loss decreased (-0.885175 --> -0.892583).  Saving model ...
Epoch: 22 cost time: 0.43251848220825195
Epoch: 22, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.906 Vali Acc: 0.896 Test Loss: 0.906 Test Acc: 0.896
Validation loss decreased (-0.892583 --> -0.896287).  Saving model ...
Epoch: 23 cost time: 0.3838307857513428
Epoch: 23, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.836 Vali Acc: 0.919 Test Loss: 0.836 Test Acc: 0.919
Validation loss decreased (-0.896287 --> -0.918510).  Saving model ...
Epoch: 24 cost time: 0.38681960105895996
Epoch: 24, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.770 Vali Acc: 0.930 Test Loss: 0.770 Test Acc: 0.930
Validation loss decreased (-0.918510 --> -0.929622).  Saving model ...
Epoch: 25 cost time: 0.4181349277496338
Epoch: 25, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.708 Vali Acc: 0.933 Test Loss: 0.708 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933326).  Saving model ...
Epoch: 26 cost time: 0.3763556480407715
Epoch: 26, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.650 Vali Acc: 0.933 Test Loss: 0.650 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933327).  Saving model ...
Epoch: 27 cost time: 0.3765583038330078
Epoch: 27, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.599 Vali Acc: 0.937 Test Loss: 0.599 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 28 cost time: 0.3798692226409912
Epoch: 28, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.551 Vali Acc: 0.937 Test Loss: 0.551 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 29 cost time: 0.43796539306640625
Epoch: 29, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.509 Vali Acc: 0.941 Test Loss: 0.509 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 30 cost time: 0.4541323184967041
Epoch: 30, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.473 Vali Acc: 0.941 Test Loss: 0.473 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 31 cost time: 0.403350830078125
Epoch: 31, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.440 Vali Acc: 0.941 Test Loss: 0.440 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 32 cost time: 0.3930220603942871
Epoch: 32, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.411 Vali Acc: 0.941 Test Loss: 0.411 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 33 cost time: 0.4087967872619629
Epoch: 33, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.385 Vali Acc: 0.944 Test Loss: 0.385 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 34 cost time: 0.35251665115356445
Epoch: 34, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.363 Vali Acc: 0.952 Test Loss: 0.363 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 35 cost time: 0.4365522861480713
Epoch: 35, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.343 Vali Acc: 0.952 Test Loss: 0.343 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 36 cost time: 0.38390398025512695
Epoch: 36, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.325 Vali Acc: 0.952 Test Loss: 0.325 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.37803173065185547
Epoch: 37, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.4029262065887451
Epoch: 38, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.297 Vali Acc: 0.952 Test Loss: 0.297 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.3728606700897217
Epoch: 39, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.285 Vali Acc: 0.952 Test Loss: 0.285 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.3811147212982178
Epoch: 40, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.275 Vali Acc: 0.952 Test Loss: 0.275 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.3969552516937256
Epoch: 41, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.4035496711730957
Epoch: 42, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.259 Vali Acc: 0.952 Test Loss: 0.259 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.3931126594543457
Epoch: 43, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.253 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.3881947994232178
Epoch: 44, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.247 Vali Acc: 0.952 Test Loss: 0.247 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 45 cost time: 0.3720719814300537
Epoch: 45, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.241 Vali Acc: 0.952 Test Loss: 0.241 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 46 cost time: 0.48003649711608887
Epoch: 46, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 47 cost time: 0.38235998153686523
Epoch: 47, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.3778958320617676
Epoch: 48, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.4608128070831299
Epoch: 49, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.223 Vali Acc: 0.956 Test Loss: 0.223 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.36879754066467285
Epoch: 50, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 238918
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5543594360351562
Epoch: 1, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.779 Vali Acc: 0.167 Test Loss: 1.779 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.44274377822875977
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.771 Vali Acc: 0.167 Test Loss: 1.771 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.3974728584289551
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.762 Vali Acc: 0.167 Test Loss: 1.762 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.3941152095794678
Epoch: 4, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.751 Vali Acc: 0.170 Test Loss: 1.751 Test Acc: 0.170
Validation loss decreased (-0.166649 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.39318037033081055
Epoch: 5, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.736 Vali Acc: 0.181 Test Loss: 1.736 Test Acc: 0.181
Validation loss decreased (-0.170353 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.4663114547729492
Epoch: 6, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.717 Vali Acc: 0.215 Test Loss: 1.717 Test Acc: 0.215
Validation loss decreased (-0.181464 --> -0.214798).  Saving model ...
Epoch: 7 cost time: 0.36232876777648926
Epoch: 7, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.695 Vali Acc: 0.307 Test Loss: 1.695 Test Acc: 0.307
Validation loss decreased (-0.214798 --> -0.307390).  Saving model ...
Epoch: 8 cost time: 0.355654239654541
Epoch: 8, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.668 Vali Acc: 0.463 Test Loss: 1.668 Test Acc: 0.463
Validation loss decreased (-0.307390 --> -0.462946).  Saving model ...
Epoch: 9 cost time: 0.48236536979675293
Epoch: 9, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.638 Vali Acc: 0.541 Test Loss: 1.638 Test Acc: 0.541
Validation loss decreased (-0.462946 --> -0.540724).  Saving model ...
Epoch: 10 cost time: 0.38299131393432617
Epoch: 10, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.604 Vali Acc: 0.607 Test Loss: 1.604 Test Acc: 0.607
Validation loss decreased (-0.540724 --> -0.607391).  Saving model ...
Epoch: 11 cost time: 0.492933988571167
Epoch: 11, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.567 Vali Acc: 0.685 Test Loss: 1.567 Test Acc: 0.685
Validation loss decreased (-0.607391 --> -0.685170).  Saving model ...
Epoch: 12 cost time: 0.4432551860809326
Epoch: 12, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.525 Vali Acc: 0.763 Test Loss: 1.525 Test Acc: 0.763
Validation loss decreased (-0.685170 --> -0.762948).  Saving model ...
Epoch: 13 cost time: 0.41063404083251953
Epoch: 13, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.481 Vali Acc: 0.800 Test Loss: 1.481 Test Acc: 0.800
Validation loss decreased (-0.762948 --> -0.799985).  Saving model ...
Epoch: 14 cost time: 0.47495603561401367
Epoch: 14, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.433 Vali Acc: 0.822 Test Loss: 1.433 Test Acc: 0.822
Validation loss decreased (-0.799985 --> -0.822208).  Saving model ...
Epoch: 15 cost time: 0.5201587677001953
Epoch: 15, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.383 Vali Acc: 0.833 Test Loss: 1.383 Test Acc: 0.833
Validation loss decreased (-0.822208 --> -0.833319).  Saving model ...
Epoch: 16 cost time: 0.48458147048950195
Epoch: 16, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.331 Vali Acc: 0.848 Test Loss: 1.331 Test Acc: 0.848
Validation loss decreased (-0.833319 --> -0.848135).  Saving model ...
Epoch: 17 cost time: 0.4367244243621826
Epoch: 17, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.276 Vali Acc: 0.859 Test Loss: 1.276 Test Acc: 0.859
Validation loss decreased (-0.848135 --> -0.859246).  Saving model ...
Epoch: 18 cost time: 0.4649014472961426
Epoch: 18, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.220 Vali Acc: 0.870 Test Loss: 1.220 Test Acc: 0.870
Validation loss decreased (-0.859246 --> -0.870358).  Saving model ...
Epoch: 19 cost time: 0.4911332130432129
Epoch: 19, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.162 Vali Acc: 0.874 Test Loss: 1.162 Test Acc: 0.874
Validation loss decreased (-0.870358 --> -0.874062).  Saving model ...
Epoch: 20 cost time: 0.38318586349487305
Epoch: 20, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.103 Vali Acc: 0.878 Test Loss: 1.103 Test Acc: 0.878
Validation loss decreased (-0.874062 --> -0.877767).  Saving model ...
Epoch: 21 cost time: 0.44673633575439453
Epoch: 21, Steps: 2 | Train Loss: 0.875 Vali Loss: 1.045 Vali Acc: 0.889 Test Loss: 1.045 Test Acc: 0.889
Validation loss decreased (-0.877767 --> -0.888878).  Saving model ...
Epoch: 22 cost time: 0.43407249450683594
Epoch: 22, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.987 Vali Acc: 0.889 Test Loss: 0.987 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888879).  Saving model ...
Epoch: 23 cost time: 0.4711921215057373
Epoch: 23, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.931 Vali Acc: 0.893 Test Loss: 0.931 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892583).  Saving model ...
Epoch: 24 cost time: 0.4730093479156494
Epoch: 24, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.877 Vali Acc: 0.893 Test Loss: 0.877 Test Acc: 0.893
Validation loss decreased (-0.892583 --> -0.892584).  Saving model ...
Epoch: 25 cost time: 0.4451169967651367
Epoch: 25, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.825 Vali Acc: 0.889 Test Loss: 0.825 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4893665313720703
Epoch: 26, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.775 Vali Acc: 0.889 Test Loss: 0.775 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4571239948272705
Epoch: 27, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.729 Vali Acc: 0.896 Test Loss: 0.729 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896289).  Saving model ...
Epoch: 28 cost time: 0.44815659523010254
Epoch: 28, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.685 Vali Acc: 0.907 Test Loss: 0.685 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 29 cost time: 0.45430946350097656
Epoch: 29, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.643 Vali Acc: 0.907 Test Loss: 0.643 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 30 cost time: 0.47778797149658203
Epoch: 30, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.605 Vali Acc: 0.919 Test Loss: 0.605 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918512).  Saving model ...
Epoch: 31 cost time: 0.44926881790161133
Epoch: 31, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.571 Vali Acc: 0.922 Test Loss: 0.571 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922217).  Saving model ...
Epoch: 32 cost time: 0.5254628658294678
Epoch: 32, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.539 Vali Acc: 0.922 Test Loss: 0.539 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 33 cost time: 0.4251713752746582
Epoch: 33, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.510 Vali Acc: 0.922 Test Loss: 0.510 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 34 cost time: 0.46494603157043457
Epoch: 34, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.483 Vali Acc: 0.919 Test Loss: 0.483 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.44624853134155273
Epoch: 35, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.459 Vali Acc: 0.919 Test Loss: 0.459 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5056028366088867
Epoch: 36, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.436 Vali Acc: 0.919 Test Loss: 0.436 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.49541306495666504
Epoch: 37, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 38 cost time: 0.42491912841796875
Epoch: 38, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 39 cost time: 0.4468355178833008
Epoch: 39, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.381 Vali Acc: 0.933 Test Loss: 0.381 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 0.47602367401123047
Epoch: 40, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.365 Vali Acc: 0.937 Test Loss: 0.365 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937033).  Saving model ...
Epoch: 41 cost time: 0.45441126823425293
Epoch: 41, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.351 Vali Acc: 0.941 Test Loss: 0.351 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.40123486518859863
Epoch: 42, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.338 Vali Acc: 0.944 Test Loss: 0.338 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.42429018020629883
Epoch: 43, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.327 Vali Acc: 0.948 Test Loss: 0.327 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 44 cost time: 0.3461794853210449
Epoch: 44, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.317 Vali Acc: 0.948 Test Loss: 0.317 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 45 cost time: 0.4082221984863281
Epoch: 45, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.308 Vali Acc: 0.952 Test Loss: 0.308 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 46 cost time: 0.44664907455444336
Epoch: 46, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.301 Vali Acc: 0.952 Test Loss: 0.301 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 47 cost time: 0.45691633224487305
Epoch: 47, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.294 Vali Acc: 0.952 Test Loss: 0.294 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 48 cost time: 0.42441868782043457
Epoch: 48, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.288 Vali Acc: 0.952 Test Loss: 0.288 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 49 cost time: 0.4386613368988037
Epoch: 49, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.282 Vali Acc: 0.952 Test Loss: 0.282 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 50 cost time: 0.4749903678894043
Epoch: 50, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.277 Vali Acc: 0.952 Test Loss: 0.277 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 232838
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4665963649749756
Epoch: 1, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.808 Vali Acc: 0.163 Test Loss: 1.808 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.3578462600708008
Epoch: 2, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.802 Vali Acc: 0.163 Test Loss: 1.802 Test Acc: 0.163
Validation loss decreased (-0.162945 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.3507053852081299
Epoch: 3, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.795 Vali Acc: 0.163 Test Loss: 1.795 Test Acc: 0.163
Validation loss decreased (-0.162945 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.3719625473022461
Epoch: 4, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.787 Vali Acc: 0.163 Test Loss: 1.787 Test Acc: 0.163
Validation loss decreased (-0.162945 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.37342214584350586
Epoch: 5, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.774 Vali Acc: 0.159 Test Loss: 1.774 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.38257288932800293
Epoch: 6, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.758 Vali Acc: 0.167 Test Loss: 1.758 Test Acc: 0.167
Validation loss decreased (-0.162945 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 0.3500654697418213
Epoch: 7, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.737 Vali Acc: 0.193 Test Loss: 1.737 Test Acc: 0.193
Validation loss decreased (-0.166649 --> -0.192575).  Saving model ...
Epoch: 8 cost time: 0.380429744720459
Epoch: 8, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.713 Vali Acc: 0.259 Test Loss: 1.713 Test Acc: 0.259
Validation loss decreased (-0.192575 --> -0.259242).  Saving model ...
Epoch: 9 cost time: 0.3524205684661865
Epoch: 9, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.685 Vali Acc: 0.381 Test Loss: 1.685 Test Acc: 0.381
Validation loss decreased (-0.259242 --> -0.381465).  Saving model ...
Epoch: 10 cost time: 0.3686082363128662
Epoch: 10, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.653 Vali Acc: 0.530 Test Loss: 1.653 Test Acc: 0.530
Validation loss decreased (-0.381465 --> -0.529613).  Saving model ...
Epoch: 11 cost time: 0.3648045063018799
Epoch: 11, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.618 Vali Acc: 0.607 Test Loss: 1.618 Test Acc: 0.607
Validation loss decreased (-0.529613 --> -0.607391).  Saving model ...
Epoch: 12 cost time: 0.44214344024658203
Epoch: 12, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.581 Vali Acc: 0.674 Test Loss: 1.581 Test Acc: 0.674
Validation loss decreased (-0.607391 --> -0.674058).  Saving model ...
Epoch: 13 cost time: 0.34008312225341797
Epoch: 13, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.540 Vali Acc: 0.763 Test Loss: 1.540 Test Acc: 0.763
Validation loss decreased (-0.674058 --> -0.762948).  Saving model ...
Epoch: 14 cost time: 0.349743127822876
Epoch: 14, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.496 Vali Acc: 0.819 Test Loss: 1.496 Test Acc: 0.819
Validation loss decreased (-0.762948 --> -0.818504).  Saving model ...
Epoch: 15 cost time: 0.35117053985595703
Epoch: 15, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.449 Vali Acc: 0.856 Test Loss: 1.449 Test Acc: 0.856
Validation loss decreased (-0.818504 --> -0.855541).  Saving model ...
Epoch: 16 cost time: 0.32427549362182617
Epoch: 16, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.400 Vali Acc: 0.870 Test Loss: 1.400 Test Acc: 0.870
Validation loss decreased (-0.855541 --> -0.870356).  Saving model ...
Epoch: 17 cost time: 0.36030149459838867
Epoch: 17, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.349 Vali Acc: 0.893 Test Loss: 1.349 Test Acc: 0.893
Validation loss decreased (-0.870356 --> -0.892579).  Saving model ...
Epoch: 18 cost time: 0.4643690586090088
Epoch: 18, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.296 Vali Acc: 0.915 Test Loss: 1.296 Test Acc: 0.915
Validation loss decreased (-0.892579 --> -0.914802).  Saving model ...
Epoch: 19 cost time: 0.39484548568725586
Epoch: 19, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.240 Vali Acc: 0.919 Test Loss: 1.240 Test Acc: 0.919
Validation loss decreased (-0.914802 --> -0.918506).  Saving model ...
Epoch: 20 cost time: 0.4240593910217285
Epoch: 20, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.182 Vali Acc: 0.930 Test Loss: 1.182 Test Acc: 0.930
Validation loss decreased (-0.918506 --> -0.929618).  Saving model ...
Epoch: 21 cost time: 0.35858941078186035
Epoch: 21, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.124 Vali Acc: 0.937 Test Loss: 1.124 Test Acc: 0.937
Validation loss decreased (-0.929618 --> -0.937026).  Saving model ...
Epoch: 22 cost time: 0.3520972728729248
Epoch: 22, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.065 Vali Acc: 0.944 Test Loss: 1.065 Test Acc: 0.944
Validation loss decreased (-0.937026 --> -0.944434).  Saving model ...
Epoch: 23 cost time: 0.482302188873291
Epoch: 23, Steps: 2 | Train Loss: 0.832 Vali Loss: 1.006 Vali Acc: 0.944 Test Loss: 1.006 Test Acc: 0.944
Validation loss decreased (-0.944434 --> -0.944434).  Saving model ...
Epoch: 24 cost time: 0.38616323471069336
Epoch: 24, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.947 Vali Acc: 0.944 Test Loss: 0.947 Test Acc: 0.944
Validation loss decreased (-0.944434 --> -0.944435).  Saving model ...
Epoch: 25 cost time: 0.3359038829803467
Epoch: 25, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.889 Vali Acc: 0.944 Test Loss: 0.889 Test Acc: 0.944
Validation loss decreased (-0.944435 --> -0.944436).  Saving model ...
Epoch: 26 cost time: 0.3360109329223633
Epoch: 26, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.834 Vali Acc: 0.944 Test Loss: 0.834 Test Acc: 0.944
Validation loss decreased (-0.944436 --> -0.944436).  Saving model ...
Epoch: 27 cost time: 0.32994890213012695
Epoch: 27, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.780 Vali Acc: 0.944 Test Loss: 0.780 Test Acc: 0.944
Validation loss decreased (-0.944436 --> -0.944437).  Saving model ...
Epoch: 28 cost time: 0.3589811325073242
Epoch: 28, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.729 Vali Acc: 0.948 Test Loss: 0.729 Test Acc: 0.948
Validation loss decreased (-0.944437 --> -0.948141).  Saving model ...
Epoch: 29 cost time: 0.3713414669036865
Epoch: 29, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.681 Vali Acc: 0.948 Test Loss: 0.681 Test Acc: 0.948
Validation loss decreased (-0.948141 --> -0.948141).  Saving model ...
Epoch: 30 cost time: 0.3947138786315918
Epoch: 30, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.636 Vali Acc: 0.952 Test Loss: 0.636 Test Acc: 0.952
Validation loss decreased (-0.948141 --> -0.951845).  Saving model ...
Epoch: 31 cost time: 0.38516855239868164
Epoch: 31, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.595 Vali Acc: 0.952 Test Loss: 0.595 Test Acc: 0.952
Validation loss decreased (-0.951845 --> -0.951846).  Saving model ...
Epoch: 32 cost time: 0.36069655418395996
Epoch: 32, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.557 Vali Acc: 0.952 Test Loss: 0.557 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951846).  Saving model ...
Epoch: 33 cost time: 0.33967041969299316
Epoch: 33, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.522 Vali Acc: 0.952 Test Loss: 0.522 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951847).  Saving model ...
Epoch: 34 cost time: 0.3619675636291504
Epoch: 34, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.490 Vali Acc: 0.952 Test Loss: 0.490 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
Epoch: 35 cost time: 0.3839702606201172
Epoch: 35, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.462 Vali Acc: 0.952 Test Loss: 0.462 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
Epoch: 36 cost time: 0.3812985420227051
Epoch: 36, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.436 Vali Acc: 0.959 Test Loss: 0.436 Test Acc: 0.959
Validation loss decreased (-0.951847 --> -0.959255).  Saving model ...
Epoch: 37 cost time: 0.3610038757324219
Epoch: 37, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.413 Vali Acc: 0.959 Test Loss: 0.413 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959255).  Saving model ...
Epoch: 38 cost time: 0.32677364349365234
Epoch: 38, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.392 Vali Acc: 0.963 Test Loss: 0.392 Test Acc: 0.963
Validation loss decreased (-0.959255 --> -0.962959).  Saving model ...
Epoch: 39 cost time: 0.3683021068572998
Epoch: 39, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.373 Vali Acc: 0.963 Test Loss: 0.373 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962959).  Saving model ...
Epoch: 40 cost time: 0.347912073135376
Epoch: 40, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.357 Vali Acc: 0.963 Test Loss: 0.357 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962959).  Saving model ...
Epoch: 41 cost time: 0.3917856216430664
Epoch: 41, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.341 Vali Acc: 0.963 Test Loss: 0.341 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962960).  Saving model ...
Epoch: 42 cost time: 0.3878018856048584
Epoch: 42, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.327 Vali Acc: 0.963 Test Loss: 0.327 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 43 cost time: 0.38056468963623047
Epoch: 43, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.315 Vali Acc: 0.967 Test Loss: 0.315 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966664).  Saving model ...
Epoch: 44 cost time: 0.36304569244384766
Epoch: 44, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.304 Vali Acc: 0.967 Test Loss: 0.304 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 45 cost time: 0.3933839797973633
Epoch: 45, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.294 Vali Acc: 0.967 Test Loss: 0.294 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 46 cost time: 0.37423086166381836
Epoch: 46, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.285 Vali Acc: 0.970 Test Loss: 0.285 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.970368).  Saving model ...
Epoch: 47 cost time: 0.35953474044799805
Epoch: 47, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.276 Vali Acc: 0.970 Test Loss: 0.276 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 48 cost time: 0.3451051712036133
Epoch: 48, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.269 Vali Acc: 0.967 Test Loss: 0.269 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.35195136070251465
Epoch: 49, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.263 Vali Acc: 0.967 Test Loss: 0.263 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.33618664741516113
Epoch: 50, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.256 Vali Acc: 0.967 Test Loss: 0.256 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9703703703703703
model parameter : 232934
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4739799499511719
Epoch: 1, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.794 Vali Acc: 0.156 Test Loss: 1.794 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.4158284664154053
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.788 Vali Acc: 0.167 Test Loss: 1.788 Test Acc: 0.167
Validation loss decreased (-0.155538 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.3523123264312744
Epoch: 3, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.781 Vali Acc: 0.174 Test Loss: 1.781 Test Acc: 0.174
Validation loss decreased (-0.166649 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 0.36596202850341797
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.774 Vali Acc: 0.193 Test Loss: 1.774 Test Acc: 0.193
Validation loss decreased (-0.174056 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.38054990768432617
Epoch: 5, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.763 Vali Acc: 0.233 Test Loss: 1.763 Test Acc: 0.233
Validation loss decreased (-0.192575 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 0.3659534454345703
Epoch: 6, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.749 Vali Acc: 0.270 Test Loss: 1.749 Test Acc: 0.270
Validation loss decreased (-0.233316 --> -0.270353).  Saving model ...
Epoch: 7 cost time: 0.357588529586792
Epoch: 7, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.732 Vali Acc: 0.300 Test Loss: 1.732 Test Acc: 0.300
Validation loss decreased (-0.270353 --> -0.299983).  Saving model ...
Epoch: 8 cost time: 0.3898754119873047
Epoch: 8, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.712 Vali Acc: 0.367 Test Loss: 1.712 Test Acc: 0.367
Validation loss decreased (-0.299983 --> -0.366650).  Saving model ...
Epoch: 9 cost time: 0.3686983585357666
Epoch: 9, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.688 Vali Acc: 0.430 Test Loss: 1.688 Test Acc: 0.430
Validation loss decreased (-0.366650 --> -0.429613).  Saving model ...
Epoch: 10 cost time: 0.3598520755767822
Epoch: 10, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.662 Vali Acc: 0.496 Test Loss: 1.662 Test Acc: 0.496
Validation loss decreased (-0.429613 --> -0.496280).  Saving model ...
Epoch: 11 cost time: 0.33034372329711914
Epoch: 11, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.632 Vali Acc: 0.559 Test Loss: 1.632 Test Acc: 0.559
Validation loss decreased (-0.496280 --> -0.559243).  Saving model ...
Epoch: 12 cost time: 0.43111205101013184
Epoch: 12, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.599 Vali Acc: 0.648 Test Loss: 1.599 Test Acc: 0.648
Validation loss decreased (-0.559243 --> -0.648132).  Saving model ...
Epoch: 13 cost time: 0.3694443702697754
Epoch: 13, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.564 Vali Acc: 0.722 Test Loss: 1.564 Test Acc: 0.722
Validation loss decreased (-0.648132 --> -0.722207).  Saving model ...
Epoch: 14 cost time: 0.3709859848022461
Epoch: 14, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.526 Vali Acc: 0.756 Test Loss: 1.526 Test Acc: 0.756
Validation loss decreased (-0.722207 --> -0.755540).  Saving model ...
Epoch: 15 cost time: 0.3830909729003906
Epoch: 15, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.486 Vali Acc: 0.796 Test Loss: 1.486 Test Acc: 0.796
Validation loss decreased (-0.755540 --> -0.796281).  Saving model ...
Epoch: 16 cost time: 0.4030795097351074
Epoch: 16, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.443 Vali Acc: 0.815 Test Loss: 1.443 Test Acc: 0.815
Validation loss decreased (-0.796281 --> -0.814800).  Saving model ...
Epoch: 17 cost time: 0.3504951000213623
Epoch: 17, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.399 Vali Acc: 0.844 Test Loss: 1.399 Test Acc: 0.844
Validation loss decreased (-0.814800 --> -0.844430).  Saving model ...
Epoch: 18 cost time: 0.36462831497192383
Epoch: 18, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.353 Vali Acc: 0.856 Test Loss: 1.353 Test Acc: 0.856
Validation loss decreased (-0.844430 --> -0.855542).  Saving model ...
Epoch: 19 cost time: 0.3493664264678955
Epoch: 19, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.306 Vali Acc: 0.867 Test Loss: 1.306 Test Acc: 0.867
Validation loss decreased (-0.855542 --> -0.866654).  Saving model ...
Epoch: 20 cost time: 0.3831164836883545
Epoch: 20, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.258 Vali Acc: 0.878 Test Loss: 1.258 Test Acc: 0.878
Validation loss decreased (-0.866654 --> -0.877765).  Saving model ...
Epoch: 21 cost time: 0.3707914352416992
Epoch: 21, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.210 Vali Acc: 0.893 Test Loss: 1.210 Test Acc: 0.893
Validation loss decreased (-0.877765 --> -0.892580).  Saving model ...
Epoch: 22 cost time: 0.37260961532592773
Epoch: 22, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.160 Vali Acc: 0.896 Test Loss: 1.160 Test Acc: 0.896
Validation loss decreased (-0.892580 --> -0.896285).  Saving model ...
Epoch: 23 cost time: 0.3625314235687256
Epoch: 23, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.111 Vali Acc: 0.900 Test Loss: 1.111 Test Acc: 0.900
Validation loss decreased (-0.896285 --> -0.899989).  Saving model ...
Epoch: 24 cost time: 0.3735184669494629
Epoch: 24, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.061 Vali Acc: 0.900 Test Loss: 1.061 Test Acc: 0.900
Validation loss decreased (-0.899989 --> -0.899989).  Saving model ...
Epoch: 25 cost time: 0.3605172634124756
Epoch: 25, Steps: 2 | Train Loss: 0.821 Vali Loss: 1.014 Vali Acc: 0.896 Test Loss: 1.014 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4380054473876953
Epoch: 26, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.966 Vali Acc: 0.896 Test Loss: 0.966 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.3510599136352539
Epoch: 27, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.919 Vali Acc: 0.904 Test Loss: 0.919 Test Acc: 0.904
Validation loss decreased (-0.899989 --> -0.903695).  Saving model ...
Epoch: 28 cost time: 0.37632107734680176
Epoch: 28, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.873 Vali Acc: 0.911 Test Loss: 0.873 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911102).  Saving model ...
Epoch: 29 cost time: 0.3825047016143799
Epoch: 29, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.829 Vali Acc: 0.907 Test Loss: 0.829 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.35571837425231934
Epoch: 30, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.787 Vali Acc: 0.915 Test Loss: 0.787 Test Acc: 0.915
Validation loss decreased (-0.911102 --> -0.914807).  Saving model ...
Epoch: 31 cost time: 0.3858354091644287
Epoch: 31, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.747 Vali Acc: 0.922 Test Loss: 0.747 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 32 cost time: 0.3696098327636719
Epoch: 32, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.708 Vali Acc: 0.926 Test Loss: 0.708 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 33 cost time: 0.42273521423339844
Epoch: 33, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.672 Vali Acc: 0.926 Test Loss: 0.672 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925919).  Saving model ...
Epoch: 34 cost time: 0.38452696800231934
Epoch: 34, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.637 Vali Acc: 0.930 Test Loss: 0.637 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 35 cost time: 0.3552052974700928
Epoch: 35, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.605 Vali Acc: 0.926 Test Loss: 0.605 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.37043213844299316
Epoch: 36, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.574 Vali Acc: 0.930 Test Loss: 0.574 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 37 cost time: 0.3682067394256592
Epoch: 37, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.547 Vali Acc: 0.926 Test Loss: 0.547 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4122014045715332
Epoch: 38, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.520 Vali Acc: 0.930 Test Loss: 0.520 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 39 cost time: 0.3804926872253418
Epoch: 39, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.496 Vali Acc: 0.933 Test Loss: 0.496 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 40 cost time: 0.40563225746154785
Epoch: 40, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.474 Vali Acc: 0.933 Test Loss: 0.474 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 0.4031097888946533
Epoch: 41, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.453 Vali Acc: 0.933 Test Loss: 0.453 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 42 cost time: 0.35076451301574707
Epoch: 42, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.434 Vali Acc: 0.941 Test Loss: 0.434 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940736).  Saving model ...
Epoch: 43 cost time: 0.43594980239868164
Epoch: 43, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.416 Vali Acc: 0.941 Test Loss: 0.416 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 44 cost time: 0.35327816009521484
Epoch: 44, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.400 Vali Acc: 0.948 Test Loss: 0.400 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948144).  Saving model ...
Epoch: 45 cost time: 0.37911486625671387
Epoch: 45, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.386 Vali Acc: 0.948 Test Loss: 0.386 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 46 cost time: 0.3911283016204834
Epoch: 46, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.374 Vali Acc: 0.948 Test Loss: 0.374 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 47 cost time: 0.35469818115234375
Epoch: 47, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.362 Vali Acc: 0.948 Test Loss: 0.362 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.32825660705566406
Epoch: 48, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 49 cost time: 0.3616325855255127
Epoch: 49, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.341 Vali Acc: 0.948 Test Loss: 0.341 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 50 cost time: 0.360065221786499
Epoch: 50, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.331 Vali Acc: 0.948 Test Loss: 0.331 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 229958
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.503951072692871
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.802 Vali Acc: 0.078 Test Loss: 1.802 Test Acc: 0.078
Validation loss decreased (inf --> -0.077760).  Saving model ...
Epoch: 2 cost time: 0.40065526962280273
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.799 Vali Acc: 0.074 Test Loss: 1.799 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.467456579208374
Epoch: 3, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.795 Vali Acc: 0.093 Test Loss: 1.795 Test Acc: 0.093
Validation loss decreased (-0.077760 --> -0.092575).  Saving model ...
Epoch: 4 cost time: 0.3891026973724365
Epoch: 4, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.789 Vali Acc: 0.096 Test Loss: 1.789 Test Acc: 0.096
Validation loss decreased (-0.092575 --> -0.096278).  Saving model ...
Epoch: 5 cost time: 0.4221940040588379
Epoch: 5, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.781 Vali Acc: 0.115 Test Loss: 1.781 Test Acc: 0.115
Validation loss decreased (-0.096278 --> -0.114797).  Saving model ...
Epoch: 6 cost time: 0.46131134033203125
Epoch: 6, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.770 Vali Acc: 0.130 Test Loss: 1.770 Test Acc: 0.130
Validation loss decreased (-0.114797 --> -0.129612).  Saving model ...
Epoch: 7 cost time: 0.3598175048828125
Epoch: 7, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.756 Vali Acc: 0.200 Test Loss: 1.756 Test Acc: 0.200
Validation loss decreased (-0.129612 --> -0.199982).  Saving model ...
Epoch: 8 cost time: 0.370769739151001
Epoch: 8, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.739 Vali Acc: 0.248 Test Loss: 1.739 Test Acc: 0.248
Validation loss decreased (-0.199982 --> -0.248131).  Saving model ...
Epoch: 9 cost time: 0.38536858558654785
Epoch: 9, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.719 Vali Acc: 0.315 Test Loss: 1.719 Test Acc: 0.315
Validation loss decreased (-0.248131 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.3884732723236084
Epoch: 10, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.696 Vali Acc: 0.367 Test Loss: 1.696 Test Acc: 0.367
Validation loss decreased (-0.314798 --> -0.366650).  Saving model ...
Epoch: 11 cost time: 0.3741004467010498
Epoch: 11, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.670 Vali Acc: 0.430 Test Loss: 1.670 Test Acc: 0.430
Validation loss decreased (-0.366650 --> -0.429613).  Saving model ...
Epoch: 12 cost time: 0.3608729839324951
Epoch: 12, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.642 Vali Acc: 0.485 Test Loss: 1.642 Test Acc: 0.485
Validation loss decreased (-0.429613 --> -0.485169).  Saving model ...
Epoch: 13 cost time: 0.3695211410522461
Epoch: 13, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.611 Vali Acc: 0.544 Test Loss: 1.611 Test Acc: 0.544
Validation loss decreased (-0.485169 --> -0.544428).  Saving model ...
Epoch: 14 cost time: 0.3664729595184326
Epoch: 14, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.579 Vali Acc: 0.563 Test Loss: 1.579 Test Acc: 0.563
Validation loss decreased (-0.544428 --> -0.562947).  Saving model ...
Epoch: 15 cost time: 0.37857770919799805
Epoch: 15, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.545 Vali Acc: 0.630 Test Loss: 1.545 Test Acc: 0.630
Validation loss decreased (-0.562947 --> -0.629614).  Saving model ...
Epoch: 16 cost time: 0.4182562828063965
Epoch: 16, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.509 Vali Acc: 0.667 Test Loss: 1.509 Test Acc: 0.667
Validation loss decreased (-0.629614 --> -0.666652).  Saving model ...
Epoch: 17 cost time: 0.3762695789337158
Epoch: 17, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.472 Vali Acc: 0.715 Test Loss: 1.472 Test Acc: 0.715
Validation loss decreased (-0.666652 --> -0.714800).  Saving model ...
Epoch: 18 cost time: 0.3646118640899658
Epoch: 18, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.434 Vali Acc: 0.744 Test Loss: 1.434 Test Acc: 0.744
Validation loss decreased (-0.714800 --> -0.744430).  Saving model ...
Epoch: 19 cost time: 0.3546285629272461
Epoch: 19, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.396 Vali Acc: 0.778 Test Loss: 1.396 Test Acc: 0.778
Validation loss decreased (-0.744430 --> -0.777764).  Saving model ...
Epoch: 20 cost time: 0.49938368797302246
Epoch: 20, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.356 Vali Acc: 0.793 Test Loss: 1.356 Test Acc: 0.793
Validation loss decreased (-0.777764 --> -0.792579).  Saving model ...
Epoch: 21 cost time: 0.356520414352417
Epoch: 21, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.317 Vali Acc: 0.807 Test Loss: 1.317 Test Acc: 0.807
Validation loss decreased (-0.792579 --> -0.807394).  Saving model ...
Epoch: 22 cost time: 0.4422929286956787
Epoch: 22, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.277 Vali Acc: 0.819 Test Loss: 1.277 Test Acc: 0.819
Validation loss decreased (-0.807394 --> -0.818506).  Saving model ...
Epoch: 23 cost time: 0.4511861801147461
Epoch: 23, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.237 Vali Acc: 0.833 Test Loss: 1.237 Test Acc: 0.833
Validation loss decreased (-0.818506 --> -0.833321).  Saving model ...
Epoch: 24 cost time: 0.3681204319000244
Epoch: 24, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.196 Vali Acc: 0.833 Test Loss: 1.196 Test Acc: 0.833
Validation loss decreased (-0.833321 --> -0.833321).  Saving model ...
Epoch: 25 cost time: 0.35742878913879395
Epoch: 25, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.156 Vali Acc: 0.848 Test Loss: 1.156 Test Acc: 0.848
Validation loss decreased (-0.833321 --> -0.848137).  Saving model ...
Epoch: 26 cost time: 0.36842823028564453
Epoch: 26, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.117 Vali Acc: 0.852 Test Loss: 1.117 Test Acc: 0.852
Validation loss decreased (-0.848137 --> -0.851841).  Saving model ...
Epoch: 27 cost time: 0.36469173431396484
Epoch: 27, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.078 Vali Acc: 0.852 Test Loss: 1.078 Test Acc: 0.852
Validation loss decreased (-0.851841 --> -0.851841).  Saving model ...
Epoch: 28 cost time: 0.3846547603607178
Epoch: 28, Steps: 2 | Train Loss: 0.827 Vali Loss: 1.039 Vali Acc: 0.863 Test Loss: 1.039 Test Acc: 0.863
Validation loss decreased (-0.851841 --> -0.862953).  Saving model ...
Epoch: 29 cost time: 0.38735127449035645
Epoch: 29, Steps: 2 | Train Loss: 0.800 Vali Loss: 1.001 Vali Acc: 0.867 Test Loss: 1.001 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 30 cost time: 0.37048840522766113
Epoch: 30, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.964 Vali Acc: 0.874 Test Loss: 0.964 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874064).  Saving model ...
Epoch: 31 cost time: 0.38158702850341797
Epoch: 31, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.928 Vali Acc: 0.881 Test Loss: 0.928 Test Acc: 0.881
Validation loss decreased (-0.874064 --> -0.881472).  Saving model ...
Epoch: 32 cost time: 0.4343688488006592
Epoch: 32, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.894 Vali Acc: 0.889 Test Loss: 0.894 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888880).  Saving model ...
Epoch: 33 cost time: 0.38018798828125
Epoch: 33, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.860 Vali Acc: 0.896 Test Loss: 0.860 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 34 cost time: 0.4197239875793457
Epoch: 34, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.827 Vali Acc: 0.896 Test Loss: 0.827 Test Acc: 0.896
Validation loss decreased (-0.896288 --> -0.896288).  Saving model ...
Epoch: 35 cost time: 0.3953242301940918
Epoch: 35, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.796 Vali Acc: 0.896 Test Loss: 0.796 Test Acc: 0.896
Validation loss decreased (-0.896288 --> -0.896288).  Saving model ...
Epoch: 36 cost time: 0.4138364791870117
Epoch: 36, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.766 Vali Acc: 0.900 Test Loss: 0.766 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899992).  Saving model ...
Epoch: 37 cost time: 0.4551997184753418
Epoch: 37, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 38 cost time: 0.3344120979309082
Epoch: 38, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.710 Vali Acc: 0.900 Test Loss: 0.710 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 39 cost time: 0.35282206535339355
Epoch: 39, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 40 cost time: 0.3699924945831299
Epoch: 40, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.658 Vali Acc: 0.915 Test Loss: 0.658 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914808).  Saving model ...
Epoch: 41 cost time: 0.36742663383483887
Epoch: 41, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.634 Vali Acc: 0.922 Test Loss: 0.634 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 42 cost time: 0.38459038734436035
Epoch: 42, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.611 Vali Acc: 0.922 Test Loss: 0.611 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 43 cost time: 0.38377904891967773
Epoch: 43, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.590 Vali Acc: 0.926 Test Loss: 0.590 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 44 cost time: 0.3725755214691162
Epoch: 44, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.571 Vali Acc: 0.926 Test Loss: 0.571 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 45 cost time: 0.36768555641174316
Epoch: 45, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.552 Vali Acc: 0.926 Test Loss: 0.552 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 46 cost time: 0.4185659885406494
Epoch: 46, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.534 Vali Acc: 0.926 Test Loss: 0.534 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 47 cost time: 0.3656158447265625
Epoch: 47, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.517 Vali Acc: 0.937 Test Loss: 0.517 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937032).  Saving model ...
Epoch: 48 cost time: 0.368884801864624
Epoch: 48, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.501 Vali Acc: 0.937 Test Loss: 0.501 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 49 cost time: 0.3368871212005615
Epoch: 49, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.487 Vali Acc: 0.937 Test Loss: 0.487 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 50 cost time: 0.4336071014404297
Epoch: 50, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.473 Vali Acc: 0.937 Test Loss: 0.473 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 227014
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4301555156707764
Epoch: 1, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.763 Vali Acc: 0.326 Test Loss: 1.763 Test Acc: 0.326
Validation loss decreased (inf --> -0.325908).  Saving model ...
Epoch: 2 cost time: 0.4180934429168701
Epoch: 2, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.712 Vali Acc: 0.367 Test Loss: 1.712 Test Acc: 0.367
Validation loss decreased (-0.325908 --> -0.366650).  Saving model ...
Epoch: 3 cost time: 0.3747830390930176
Epoch: 3, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.637 Vali Acc: 0.470 Test Loss: 1.637 Test Acc: 0.470
Validation loss decreased (-0.366650 --> -0.470354).  Saving model ...
Epoch: 4 cost time: 0.3241465091705322
Epoch: 4, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.503 Vali Acc: 0.778 Test Loss: 1.503 Test Acc: 0.778
Validation loss decreased (-0.470354 --> -0.777763).  Saving model ...
Epoch: 5 cost time: 0.3258380889892578
Epoch: 5, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.334 Vali Acc: 0.848 Test Loss: 1.334 Test Acc: 0.848
Validation loss decreased (-0.777763 --> -0.848135).  Saving model ...
Epoch: 6 cost time: 0.39978671073913574
Epoch: 6, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.143 Vali Acc: 0.889 Test Loss: 1.143 Test Acc: 0.889
Validation loss decreased (-0.848135 --> -0.888877).  Saving model ...
Epoch: 7 cost time: 0.3991823196411133
Epoch: 7, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.945 Vali Acc: 0.904 Test Loss: 0.945 Test Acc: 0.904
Validation loss decreased (-0.888877 --> -0.903694).  Saving model ...
Epoch: 8 cost time: 0.3446338176727295
Epoch: 8, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.760 Vali Acc: 0.919 Test Loss: 0.760 Test Acc: 0.919
Validation loss decreased (-0.903694 --> -0.918511).  Saving model ...
Epoch: 9 cost time: 0.36649084091186523
Epoch: 9, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.596 Vali Acc: 0.922 Test Loss: 0.596 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 10 cost time: 0.36416125297546387
Epoch: 10, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.466 Vali Acc: 0.933 Test Loss: 0.466 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933329).  Saving model ...
Epoch: 11 cost time: 0.3519306182861328
Epoch: 11, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.366 Vali Acc: 0.944 Test Loss: 0.366 Test Acc: 0.944
Validation loss decreased (-0.933329 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.31085968017578125
Epoch: 12, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.35324573516845703
Epoch: 13, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3308074474334717
Epoch: 14, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3322579860687256
Epoch: 15, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.32888054847717285
Epoch: 16, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.30243420600891113
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.3501434326171875
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.34638142585754395
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.34871721267700195
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.33567285537719727
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.3399181365966797
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.31893110275268555
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.35016584396362305
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.3500831127166748
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.35933399200439453
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.3415646553039551
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.356046199798584
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.356320858001709
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.33638858795166016
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.32987356185913086
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 977798
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.3888776302337646
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.789 Vali Acc: 0.104 Test Loss: 1.789 Test Acc: 0.104
Validation loss decreased (inf --> -0.103686).  Saving model ...
Epoch: 2 cost time: 0.3888084888458252
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.748 Vali Acc: 0.211 Test Loss: 1.748 Test Acc: 0.211
Validation loss decreased (-0.103686 --> -0.211094).  Saving model ...
Epoch: 3 cost time: 0.3289949893951416
Epoch: 3, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.697 Vali Acc: 0.352 Test Loss: 1.697 Test Acc: 0.352
Validation loss decreased (-0.211094 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.34935426712036133
Epoch: 4, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.614 Vali Acc: 0.570 Test Loss: 1.614 Test Acc: 0.570
Validation loss decreased (-0.351835 --> -0.570354).  Saving model ...
Epoch: 5 cost time: 0.31779003143310547
Epoch: 5, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.505 Vali Acc: 0.689 Test Loss: 1.505 Test Acc: 0.689
Validation loss decreased (-0.570354 --> -0.688874).  Saving model ...
Epoch: 6 cost time: 0.34922122955322266
Epoch: 6, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.376 Vali Acc: 0.759 Test Loss: 1.376 Test Acc: 0.759
Validation loss decreased (-0.688874 --> -0.759245).  Saving model ...
Epoch: 7 cost time: 0.32769179344177246
Epoch: 7, Steps: 2 | Train Loss: 1.038 Vali Loss: 1.235 Vali Acc: 0.796 Test Loss: 1.235 Test Acc: 0.796
Validation loss decreased (-0.759245 --> -0.796284).  Saving model ...
Epoch: 8 cost time: 0.38130855560302734
Epoch: 8, Steps: 2 | Train Loss: 0.850 Vali Loss: 1.087 Vali Acc: 0.848 Test Loss: 1.087 Test Acc: 0.848
Validation loss decreased (-0.796284 --> -0.848137).  Saving model ...
Epoch: 9 cost time: 0.4159972667694092
Epoch: 9, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.940 Vali Acc: 0.870 Test Loss: 0.940 Test Acc: 0.870
Validation loss decreased (-0.848137 --> -0.870361).  Saving model ...
Epoch: 10 cost time: 0.34978342056274414
Epoch: 10, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.799 Vali Acc: 0.885 Test Loss: 0.799 Test Acc: 0.885
Validation loss decreased (-0.870361 --> -0.885177).  Saving model ...
Epoch: 11 cost time: 0.34493446350097656
Epoch: 11, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.670 Vali Acc: 0.904 Test Loss: 0.670 Test Acc: 0.904
Validation loss decreased (-0.885177 --> -0.903697).  Saving model ...
Epoch: 12 cost time: 0.38348841667175293
Epoch: 12, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.557 Vali Acc: 0.919 Test Loss: 0.557 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 13 cost time: 0.3714311122894287
Epoch: 13, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.468 Vali Acc: 0.919 Test Loss: 0.468 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 14 cost time: 0.39224672317504883
Epoch: 14, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 15 cost time: 0.34801697731018066
Epoch: 15, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.333 Vali Acc: 0.926 Test Loss: 0.333 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.3451216220855713
Epoch: 16, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 17 cost time: 0.34453797340393066
Epoch: 17, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.379626989364624
Epoch: 18, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.3581256866455078
Epoch: 19, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.3419322967529297
Epoch: 20, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.3651254177093506
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.35500335693359375
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.33850860595703125
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.3836674690246582
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.3644876480102539
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.44808101654052734
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.3510713577270508
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.3706042766571045
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.3587830066680908
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.34508824348449707
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.3430635929107666
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.3567924499511719
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.3795959949493408
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.3598906993865967
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.3546633720397949
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4813110828399658
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.38099050521850586
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.3825416564941406
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.36635756492614746
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 873606
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4920527935028076
Epoch: 1, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.788 Vali Acc: 0.233 Test Loss: 1.788 Test Acc: 0.233
Validation loss decreased (inf --> -0.233315).  Saving model ...
Epoch: 2 cost time: 0.36524152755737305
Epoch: 2, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.758 Vali Acc: 0.285 Test Loss: 1.758 Test Acc: 0.285
Validation loss decreased (-0.233315 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.3700706958770752
Epoch: 3, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.720 Vali Acc: 0.341 Test Loss: 1.720 Test Acc: 0.341
Validation loss decreased (-0.285168 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.3789536952972412
Epoch: 4, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.659 Vali Acc: 0.456 Test Loss: 1.659 Test Acc: 0.456
Validation loss decreased (-0.340724 --> -0.455539).  Saving model ...
Epoch: 5 cost time: 0.4405691623687744
Epoch: 5, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.581 Vali Acc: 0.581 Test Loss: 1.581 Test Acc: 0.581
Validation loss decreased (-0.455539 --> -0.581466).  Saving model ...
Epoch: 6 cost time: 0.35741400718688965
Epoch: 6, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.487 Vali Acc: 0.722 Test Loss: 1.487 Test Acc: 0.722
Validation loss decreased (-0.581466 --> -0.722207).  Saving model ...
Epoch: 7 cost time: 0.3855621814727783
Epoch: 7, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.379 Vali Acc: 0.767 Test Loss: 1.379 Test Acc: 0.767
Validation loss decreased (-0.722207 --> -0.766653).  Saving model ...
Epoch: 8 cost time: 0.3527848720550537
Epoch: 8, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.261 Vali Acc: 0.804 Test Loss: 1.261 Test Acc: 0.804
Validation loss decreased (-0.766653 --> -0.803691).  Saving model ...
Epoch: 9 cost time: 0.35462212562561035
Epoch: 9, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.136 Vali Acc: 0.830 Test Loss: 1.136 Test Acc: 0.830
Validation loss decreased (-0.803691 --> -0.829618).  Saving model ...
Epoch: 10 cost time: 0.3774421215057373
Epoch: 10, Steps: 2 | Train Loss: 0.801 Vali Loss: 1.008 Vali Acc: 0.856 Test Loss: 1.008 Test Acc: 0.856
Validation loss decreased (-0.829618 --> -0.855545).  Saving model ...
Epoch: 11 cost time: 0.36638736724853516
Epoch: 11, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.884 Vali Acc: 0.874 Test Loss: 0.884 Test Acc: 0.874
Validation loss decreased (-0.855545 --> -0.874065).  Saving model ...
Epoch: 12 cost time: 0.38102221488952637
Epoch: 12, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.765 Vali Acc: 0.900 Test Loss: 0.765 Test Acc: 0.900
Validation loss decreased (-0.874065 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 0.35094332695007324
Epoch: 13, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.657 Vali Acc: 0.915 Test Loss: 0.657 Test Acc: 0.915
Validation loss decreased (-0.899992 --> -0.914808).  Saving model ...
Epoch: 14 cost time: 0.36992669105529785
Epoch: 14, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.560 Vali Acc: 0.919 Test Loss: 0.560 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918513).  Saving model ...
Epoch: 15 cost time: 0.37099575996398926
Epoch: 15, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.476 Vali Acc: 0.915 Test Loss: 0.476 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4457368850708008
Epoch: 16, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.406 Vali Acc: 0.926 Test Loss: 0.406 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925922).  Saving model ...
Epoch: 17 cost time: 0.35871124267578125
Epoch: 17, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.349 Vali Acc: 0.933 Test Loss: 0.349 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.38852453231811523
Epoch: 18, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 0.3757925033569336
Epoch: 19, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.3775339126586914
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.4297013282775879
Epoch: 21, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4108901023864746
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.3654286861419678
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.35893845558166504
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.37493205070495605
Epoch: 25, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.3891148567199707
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.39456605911254883
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.3803679943084717
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.4461324214935303
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.3754291534423828
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.39253950119018555
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.3751981258392334
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.39052891731262207
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.3983597755432129
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.39418506622314453
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.39467549324035645
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.3447692394256592
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.3721048831939697
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.4082167148590088
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.42025279998779297
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.4649643898010254
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.38208580017089844
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.40205955505371094
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.3896658420562744
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.3934619426727295
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.42133474349975586
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.39180779457092285
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.3775327205657959
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.41777467727661133
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.38822126388549805
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 843014
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5038540363311768
Epoch: 1, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.716 Vali Acc: 0.330 Test Loss: 1.716 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.4152700901031494
Epoch: 2, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.686 Vali Acc: 0.363 Test Loss: 1.686 Test Acc: 0.363
Validation loss decreased (-0.329612 --> -0.362946).  Saving model ...
Epoch: 3 cost time: 0.38578248023986816
Epoch: 3, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.653 Vali Acc: 0.426 Test Loss: 1.653 Test Acc: 0.426
Validation loss decreased (-0.362946 --> -0.425909).  Saving model ...
Epoch: 4 cost time: 0.4075942039489746
Epoch: 4, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.601 Vali Acc: 0.563 Test Loss: 1.601 Test Acc: 0.563
Validation loss decreased (-0.425909 --> -0.562947).  Saving model ...
Epoch: 5 cost time: 0.4442317485809326
Epoch: 5, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.534 Vali Acc: 0.689 Test Loss: 1.534 Test Acc: 0.689
Validation loss decreased (-0.562947 --> -0.688874).  Saving model ...
Epoch: 6 cost time: 0.42755675315856934
Epoch: 6, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.453 Vali Acc: 0.744 Test Loss: 1.453 Test Acc: 0.744
Validation loss decreased (-0.688874 --> -0.744430).  Saving model ...
Epoch: 7 cost time: 0.43548011779785156
Epoch: 7, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.361 Vali Acc: 0.796 Test Loss: 1.361 Test Acc: 0.796
Validation loss decreased (-0.744430 --> -0.796283).  Saving model ...
Epoch: 8 cost time: 0.4377281665802002
Epoch: 8, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.262 Vali Acc: 0.852 Test Loss: 1.262 Test Acc: 0.852
Validation loss decreased (-0.796283 --> -0.851839).  Saving model ...
Epoch: 9 cost time: 0.483234167098999
Epoch: 9, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.156 Vali Acc: 0.889 Test Loss: 1.156 Test Acc: 0.889
Validation loss decreased (-0.851839 --> -0.888877).  Saving model ...
Epoch: 10 cost time: 0.4382054805755615
Epoch: 10, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.049 Vali Acc: 0.926 Test Loss: 1.049 Test Acc: 0.926
Validation loss decreased (-0.888877 --> -0.925915).  Saving model ...
Epoch: 11 cost time: 0.410353422164917
Epoch: 11, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.942 Vali Acc: 0.933 Test Loss: 0.942 Test Acc: 0.933
Validation loss decreased (-0.925915 --> -0.933324).  Saving model ...
Epoch: 12 cost time: 0.5097746849060059
Epoch: 12, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.837 Vali Acc: 0.937 Test Loss: 0.837 Test Acc: 0.937
Validation loss decreased (-0.933324 --> -0.937029).  Saving model ...
Epoch: 13 cost time: 0.4140641689300537
Epoch: 13, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.736 Vali Acc: 0.952 Test Loss: 0.736 Test Acc: 0.952
Validation loss decreased (-0.937029 --> -0.951844).  Saving model ...
Epoch: 14 cost time: 0.46090221405029297
Epoch: 14, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.642 Vali Acc: 0.948 Test Loss: 0.642 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4036738872528076
Epoch: 15, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.559 Vali Acc: 0.956 Test Loss: 0.559 Test Acc: 0.956
Validation loss decreased (-0.951844 --> -0.955550).  Saving model ...
Epoch: 16 cost time: 0.38771748542785645
Epoch: 16, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.485 Vali Acc: 0.952 Test Loss: 0.485 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.47853517532348633
Epoch: 17, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.422 Vali Acc: 0.952 Test Loss: 0.422 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.43979358673095703
Epoch: 18, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.370 Vali Acc: 0.952 Test Loss: 0.370 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4394822120666504
Epoch: 19, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.329 Vali Acc: 0.952 Test Loss: 0.329 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4536621570587158
Epoch: 20, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.293 Vali Acc: 0.952 Test Loss: 0.293 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.43755388259887695
Epoch: 21, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4165523052215576
Epoch: 22, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955553).  Saving model ...
Epoch: 23 cost time: 0.4551222324371338
Epoch: 23, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 24 cost time: 0.416273832321167
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.43547511100769043
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4375641345977783
Epoch: 26, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.41858530044555664
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.41985464096069336
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4009699821472168
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.38289928436279297
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.40160489082336426
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.3734924793243408
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.3965189456939697
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 824838
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.639197587966919
Epoch: 1, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.830 Vali Acc: 0.133 Test Loss: 1.830 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.43845438957214355
Epoch: 2, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.812 Vali Acc: 0.174 Test Loss: 1.812 Test Acc: 0.174
Validation loss decreased (-0.133315 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.40688443183898926
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.788 Vali Acc: 0.196 Test Loss: 1.788 Test Acc: 0.196
Validation loss decreased (-0.174056 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.41556859016418457
Epoch: 4, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.750 Vali Acc: 0.248 Test Loss: 1.750 Test Acc: 0.248
Validation loss decreased (-0.196278 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.39801549911499023
Epoch: 5, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.695 Vali Acc: 0.311 Test Loss: 1.695 Test Acc: 0.311
Validation loss decreased (-0.248131 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 0.4077162742614746
Epoch: 6, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.627 Vali Acc: 0.537 Test Loss: 1.627 Test Acc: 0.537
Validation loss decreased (-0.311094 --> -0.537021).  Saving model ...
Epoch: 7 cost time: 0.4644889831542969
Epoch: 7, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.546 Vali Acc: 0.633 Test Loss: 1.546 Test Acc: 0.633
Validation loss decreased (-0.537021 --> -0.633318).  Saving model ...
Epoch: 8 cost time: 0.41533565521240234
Epoch: 8, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.455 Vali Acc: 0.752 Test Loss: 1.455 Test Acc: 0.752
Validation loss decreased (-0.633318 --> -0.751837).  Saving model ...
Epoch: 9 cost time: 0.40213990211486816
Epoch: 9, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.355 Vali Acc: 0.844 Test Loss: 1.355 Test Acc: 0.844
Validation loss decreased (-0.751837 --> -0.844431).  Saving model ...
Epoch: 10 cost time: 0.413362979888916
Epoch: 10, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.247 Vali Acc: 0.874 Test Loss: 1.247 Test Acc: 0.874
Validation loss decreased (-0.844431 --> -0.874062).  Saving model ...
Epoch: 11 cost time: 0.4287738800048828
Epoch: 11, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.135 Vali Acc: 0.893 Test Loss: 1.135 Test Acc: 0.893
Validation loss decreased (-0.874062 --> -0.892581).  Saving model ...
Epoch: 12 cost time: 0.4035837650299072
Epoch: 12, Steps: 2 | Train Loss: 0.756 Vali Loss: 1.021 Vali Acc: 0.904 Test Loss: 1.021 Test Acc: 0.904
Validation loss decreased (-0.892581 --> -0.903693).  Saving model ...
Epoch: 13 cost time: 0.40366506576538086
Epoch: 13, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.908 Vali Acc: 0.907 Test Loss: 0.908 Test Acc: 0.907
Validation loss decreased (-0.903693 --> -0.907398).  Saving model ...
Epoch: 14 cost time: 0.5225608348846436
Epoch: 14, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.800 Vali Acc: 0.915 Test Loss: 0.800 Test Acc: 0.915
Validation loss decreased (-0.907398 --> -0.914807).  Saving model ...
Epoch: 15 cost time: 0.4617938995361328
Epoch: 15, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.701 Vali Acc: 0.915 Test Loss: 0.701 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 16 cost time: 0.42699766159057617
Epoch: 16, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.612 Vali Acc: 0.915 Test Loss: 0.612 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 17 cost time: 0.40303564071655273
Epoch: 17, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.535 Vali Acc: 0.915 Test Loss: 0.535 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 18 cost time: 0.4023396968841553
Epoch: 18, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.472 Vali Acc: 0.919 Test Loss: 0.472 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918514).  Saving model ...
Epoch: 19 cost time: 0.412400484085083
Epoch: 19, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.421 Vali Acc: 0.922 Test Loss: 0.421 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 20 cost time: 0.42069363594055176
Epoch: 20, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 21 cost time: 0.44023728370666504
Epoch: 21, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.340 Vali Acc: 0.926 Test Loss: 0.340 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.4194793701171875
Epoch: 22, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.4499387741088867
Epoch: 23, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.43461084365844727
Epoch: 24, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 0.42206478118896484
Epoch: 25, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.439678430557251
Epoch: 26, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.937035 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.4544694423675537
Epoch: 27, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.4671347141265869
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.42371535301208496
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.44643616676330566
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.4235975742340088
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.42902565002441406
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.44086623191833496
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4423642158508301
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.42702698707580566
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.4481527805328369
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.3741035461425781
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4149355888366699
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.43355655670166016
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.46300292015075684
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4043571949005127
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 819078
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.733513355255127
Epoch: 1, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.767 Vali Acc: 0.085 Test Loss: 1.767 Test Acc: 0.085
Validation loss decreased (inf --> -0.085168).  Saving model ...
Epoch: 2 cost time: 0.4133317470550537
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.747 Vali Acc: 0.126 Test Loss: 1.747 Test Acc: 0.126
Validation loss decreased (-0.085168 --> -0.125908).  Saving model ...
Epoch: 3 cost time: 0.4085695743560791
Epoch: 3, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.726 Vali Acc: 0.215 Test Loss: 1.726 Test Acc: 0.215
Validation loss decreased (-0.125908 --> -0.214798).  Saving model ...
Epoch: 4 cost time: 0.4209785461425781
Epoch: 4, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.694 Vali Acc: 0.289 Test Loss: 1.694 Test Acc: 0.289
Validation loss decreased (-0.214798 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.451160192489624
Epoch: 5, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.651 Vali Acc: 0.470 Test Loss: 1.651 Test Acc: 0.470
Validation loss decreased (-0.288872 --> -0.470354).  Saving model ...
Epoch: 6 cost time: 0.43878817558288574
Epoch: 6, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.596 Vali Acc: 0.622 Test Loss: 1.596 Test Acc: 0.622
Validation loss decreased (-0.470354 --> -0.622206).  Saving model ...
Epoch: 7 cost time: 0.46689724922180176
Epoch: 7, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.534 Vali Acc: 0.726 Test Loss: 1.534 Test Acc: 0.726
Validation loss decreased (-0.622206 --> -0.725911).  Saving model ...
Epoch: 8 cost time: 0.4290177822113037
Epoch: 8, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.462 Vali Acc: 0.800 Test Loss: 1.462 Test Acc: 0.800
Validation loss decreased (-0.725911 --> -0.799985).  Saving model ...
Epoch: 9 cost time: 0.4237639904022217
Epoch: 9, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.380 Vali Acc: 0.863 Test Loss: 1.380 Test Acc: 0.863
Validation loss decreased (-0.799985 --> -0.862949).  Saving model ...
Epoch: 10 cost time: 0.4137144088745117
Epoch: 10, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.293 Vali Acc: 0.893 Test Loss: 1.293 Test Acc: 0.893
Validation loss decreased (-0.862949 --> -0.892580).  Saving model ...
Epoch: 11 cost time: 0.3976759910583496
Epoch: 11, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.200 Vali Acc: 0.922 Test Loss: 1.200 Test Acc: 0.922
Validation loss decreased (-0.892580 --> -0.922210).  Saving model ...
Epoch: 12 cost time: 0.4289259910583496
Epoch: 12, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.102 Vali Acc: 0.937 Test Loss: 1.102 Test Acc: 0.937
Validation loss decreased (-0.922210 --> -0.937026).  Saving model ...
Epoch: 13 cost time: 0.4532136917114258
Epoch: 13, Steps: 2 | Train Loss: 0.805 Vali Loss: 1.003 Vali Acc: 0.937 Test Loss: 1.003 Test Acc: 0.937
Validation loss decreased (-0.937026 --> -0.937027).  Saving model ...
Epoch: 14 cost time: 0.4094219207763672
Epoch: 14, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.905 Vali Acc: 0.941 Test Loss: 0.905 Test Acc: 0.941
Validation loss decreased (-0.937027 --> -0.940732).  Saving model ...
Epoch: 15 cost time: 0.40987086296081543
Epoch: 15, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.810 Vali Acc: 0.944 Test Loss: 0.810 Test Acc: 0.944
Validation loss decreased (-0.940732 --> -0.944436).  Saving model ...
Epoch: 16 cost time: 0.3984673023223877
Epoch: 16, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.720 Vali Acc: 0.948 Test Loss: 0.720 Test Acc: 0.948
Validation loss decreased (-0.944436 --> -0.948141).  Saving model ...
Epoch: 17 cost time: 0.369199275970459
Epoch: 17, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.638 Vali Acc: 0.952 Test Loss: 0.638 Test Acc: 0.952
Validation loss decreased (-0.948141 --> -0.951845).  Saving model ...
Epoch: 18 cost time: 0.41002488136291504
Epoch: 18, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.565 Vali Acc: 0.948 Test Loss: 0.565 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3861875534057617
Epoch: 19, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.502 Vali Acc: 0.952 Test Loss: 0.502 Test Acc: 0.952
Validation loss decreased (-0.951845 --> -0.951847).  Saving model ...
Epoch: 20 cost time: 0.4151647090911865
Epoch: 20, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.447 Vali Acc: 0.952 Test Loss: 0.447 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
Epoch: 21 cost time: 0.3956773281097412
Epoch: 21, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.401 Vali Acc: 0.952 Test Loss: 0.401 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 22 cost time: 0.4782834053039551
Epoch: 22, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.363 Vali Acc: 0.956 Test Loss: 0.363 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 23 cost time: 0.41197681427001953
Epoch: 23, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.332 Vali Acc: 0.956 Test Loss: 0.332 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 24 cost time: 0.43334174156188965
Epoch: 24, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.956 Test Loss: 0.307 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 25 cost time: 0.43351006507873535
Epoch: 25, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.286 Vali Acc: 0.956 Test Loss: 0.286 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.4027385711669922
Epoch: 26, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.268 Vali Acc: 0.952 Test Loss: 0.268 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4021129608154297
Epoch: 27, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.252 Vali Acc: 0.959 Test Loss: 0.252 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 28 cost time: 0.41881561279296875
Epoch: 28, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.238 Vali Acc: 0.959 Test Loss: 0.238 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 29 cost time: 0.40589451789855957
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.227 Vali Acc: 0.959 Test Loss: 0.227 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.41104722023010254
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.4119405746459961
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.40228748321533203
Epoch: 32, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 33 cost time: 0.413942813873291
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 34 cost time: 0.4146294593811035
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.3960385322570801
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4368612766265869
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.41665077209472656
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.43183016777038574
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.39370203018188477
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4534292221069336
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.45635271072387695
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.47439002990722656
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959258).  Saving model ...
Epoch: 43 cost time: 0.5200772285461426
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 44 cost time: 0.48250746726989746
Epoch: 44, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 45 cost time: 0.47392988204956055
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 46 cost time: 0.500952959060669
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 47 cost time: 0.47315359115600586
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 48 cost time: 0.4911036491394043
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 49 cost time: 0.46036481857299805
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 50 cost time: 0.5228536128997803
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.959258 --> -0.962961).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 807174
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.660789966583252
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.801 Vali Acc: 0.170 Test Loss: 1.801 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.40015077590942383
Epoch: 2, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.783 Vali Acc: 0.200 Test Loss: 1.783 Test Acc: 0.200
Validation loss decreased (-0.170352 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.41882967948913574
Epoch: 3, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.764 Vali Acc: 0.230 Test Loss: 1.764 Test Acc: 0.230
Validation loss decreased (-0.199982 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.4081704616546631
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.734 Vali Acc: 0.326 Test Loss: 1.734 Test Acc: 0.326
Validation loss decreased (-0.229612 --> -0.325909).  Saving model ...
Epoch: 5 cost time: 0.40448665618896484
Epoch: 5, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.693 Vali Acc: 0.441 Test Loss: 1.693 Test Acc: 0.441
Validation loss decreased (-0.325909 --> -0.440724).  Saving model ...
Epoch: 6 cost time: 0.42159557342529297
Epoch: 6, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.641 Vali Acc: 0.519 Test Loss: 1.641 Test Acc: 0.519
Validation loss decreased (-0.440724 --> -0.518502).  Saving model ...
Epoch: 7 cost time: 0.4291837215423584
Epoch: 7, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.581 Vali Acc: 0.615 Test Loss: 1.581 Test Acc: 0.615
Validation loss decreased (-0.518502 --> -0.614799).  Saving model ...
Epoch: 8 cost time: 0.41122913360595703
Epoch: 8, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.514 Vali Acc: 0.696 Test Loss: 1.514 Test Acc: 0.696
Validation loss decreased (-0.614799 --> -0.696281).  Saving model ...
Epoch: 9 cost time: 0.38167405128479004
Epoch: 9, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.439 Vali Acc: 0.781 Test Loss: 1.439 Test Acc: 0.781
Validation loss decreased (-0.696281 --> -0.781467).  Saving model ...
Epoch: 10 cost time: 0.44146251678466797
Epoch: 10, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.356 Vali Acc: 0.822 Test Loss: 1.356 Test Acc: 0.822
Validation loss decreased (-0.781467 --> -0.822209).  Saving model ...
Epoch: 11 cost time: 0.43859148025512695
Epoch: 11, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.269 Vali Acc: 0.859 Test Loss: 1.269 Test Acc: 0.859
Validation loss decreased (-0.822209 --> -0.859247).  Saving model ...
Epoch: 12 cost time: 0.41548705101013184
Epoch: 12, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.179 Vali Acc: 0.893 Test Loss: 1.179 Test Acc: 0.893
Validation loss decreased (-0.859247 --> -0.892581).  Saving model ...
Epoch: 13 cost time: 0.37762904167175293
Epoch: 13, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.086 Vali Acc: 0.896 Test Loss: 1.086 Test Acc: 0.896
Validation loss decreased (-0.892581 --> -0.896285).  Saving model ...
Epoch: 14 cost time: 0.36219191551208496
Epoch: 14, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.994 Vali Acc: 0.904 Test Loss: 0.994 Test Acc: 0.904
Validation loss decreased (-0.896285 --> -0.903694).  Saving model ...
Epoch: 15 cost time: 0.4033980369567871
Epoch: 15, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.903 Vali Acc: 0.919 Test Loss: 0.903 Test Acc: 0.919
Validation loss decreased (-0.903694 --> -0.918509).  Saving model ...
Epoch: 16 cost time: 0.41448068618774414
Epoch: 16, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.815 Vali Acc: 0.937 Test Loss: 0.815 Test Acc: 0.937
Validation loss decreased (-0.918509 --> -0.937029).  Saving model ...
Epoch: 17 cost time: 0.38552427291870117
Epoch: 17, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.733 Vali Acc: 0.937 Test Loss: 0.733 Test Acc: 0.937
Validation loss decreased (-0.937029 --> -0.937030).  Saving model ...
Epoch: 18 cost time: 0.3742706775665283
Epoch: 18, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.658 Vali Acc: 0.941 Test Loss: 0.658 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940734).  Saving model ...
Epoch: 19 cost time: 0.38488292694091797
Epoch: 19, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.590 Vali Acc: 0.944 Test Loss: 0.590 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944439).  Saving model ...
Epoch: 20 cost time: 0.4481620788574219
Epoch: 20, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.532 Vali Acc: 0.941 Test Loss: 0.532 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.46002721786499023
Epoch: 21, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.481 Vali Acc: 0.941 Test Loss: 0.481 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.42849206924438477
Epoch: 22, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.436 Vali Acc: 0.944 Test Loss: 0.436 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 23 cost time: 0.4451792240142822
Epoch: 23, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.398 Vali Acc: 0.948 Test Loss: 0.398 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 24 cost time: 0.4119839668273926
Epoch: 24, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.365 Vali Acc: 0.963 Test Loss: 0.365 Test Acc: 0.963
Validation loss decreased (-0.948144 --> -0.962959).  Saving model ...
Epoch: 25 cost time: 0.4547138214111328
Epoch: 25, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.337 Vali Acc: 0.963 Test Loss: 0.337 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962960).  Saving model ...
Epoch: 26 cost time: 0.4536278247833252
Epoch: 26, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.312 Vali Acc: 0.963 Test Loss: 0.312 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 27 cost time: 0.5204858779907227
Epoch: 27, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.292 Vali Acc: 0.963 Test Loss: 0.292 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 28 cost time: 0.5787794589996338
Epoch: 28, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.273 Vali Acc: 0.967 Test Loss: 0.273 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966664).  Saving model ...
Epoch: 29 cost time: 0.5552823543548584
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 30 cost time: 0.42984604835510254
Epoch: 30, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.246 Vali Acc: 0.967 Test Loss: 0.246 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 31 cost time: 0.4562668800354004
Epoch: 31, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.967 Test Loss: 0.236 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 32 cost time: 0.4126932621002197
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 33 cost time: 0.45565128326416016
Epoch: 33, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.967 Test Loss: 0.221 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 34 cost time: 0.4430403709411621
Epoch: 34, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 35 cost time: 0.5055055618286133
Epoch: 35, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 36 cost time: 0.4965360164642334
Epoch: 36, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 37 cost time: 0.4694712162017822
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 38 cost time: 0.45978784561157227
Epoch: 38, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 39 cost time: 0.4934217929840088
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 40 cost time: 0.4493753910064697
Epoch: 40, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 41 cost time: 0.4383819103240967
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 42 cost time: 0.44008517265319824
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.41544127464294434
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.4265134334564209
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.4128265380859375
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.44846677780151367
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 47 cost time: 0.4395575523376465
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 48 cost time: 0.43532419204711914
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 49 cost time: 0.4355766773223877
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 50 cost time: 0.47921299934387207
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 801542
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6454644203186035
Epoch: 1, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.726 Vali Acc: 0.415 Test Loss: 1.726 Test Acc: 0.415
Validation loss decreased (inf --> -0.414798).  Saving model ...
Epoch: 2 cost time: 0.3681514263153076
Epoch: 2, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.681 Vali Acc: 0.463 Test Loss: 1.681 Test Acc: 0.463
Validation loss decreased (-0.414798 --> -0.462946).  Saving model ...
Epoch: 3 cost time: 0.3791921138763428
Epoch: 3, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.627 Vali Acc: 0.511 Test Loss: 1.627 Test Acc: 0.511
Validation loss decreased (-0.462946 --> -0.511095).  Saving model ...
Epoch: 4 cost time: 0.37816786766052246
Epoch: 4, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.546 Vali Acc: 0.619 Test Loss: 1.546 Test Acc: 0.619
Validation loss decreased (-0.511095 --> -0.618503).  Saving model ...
Epoch: 5 cost time: 0.40009570121765137
Epoch: 5, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.443 Vali Acc: 0.726 Test Loss: 1.443 Test Acc: 0.726
Validation loss decreased (-0.618503 --> -0.725911).  Saving model ...
Epoch: 6 cost time: 0.4011812210083008
Epoch: 6, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.323 Vali Acc: 0.822 Test Loss: 1.323 Test Acc: 0.822
Validation loss decreased (-0.725911 --> -0.822209).  Saving model ...
Epoch: 7 cost time: 0.38086867332458496
Epoch: 7, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.194 Vali Acc: 0.867 Test Loss: 1.194 Test Acc: 0.867
Validation loss decreased (-0.822209 --> -0.866655).  Saving model ...
Epoch: 8 cost time: 0.4121417999267578
Epoch: 8, Steps: 2 | Train Loss: 0.809 Vali Loss: 1.062 Vali Acc: 0.863 Test Loss: 1.062 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.3835287094116211
Epoch: 9, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.933 Vali Acc: 0.896 Test Loss: 0.933 Test Acc: 0.896
Validation loss decreased (-0.866655 --> -0.896287).  Saving model ...
Epoch: 10 cost time: 0.40396976470947266
Epoch: 10, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.809 Vali Acc: 0.915 Test Loss: 0.809 Test Acc: 0.915
Validation loss decreased (-0.896287 --> -0.914807).  Saving model ...
Epoch: 11 cost time: 0.4144284725189209
Epoch: 11, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.692 Vali Acc: 0.922 Test Loss: 0.692 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 12 cost time: 0.43184471130371094
Epoch: 12, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.590 Vali Acc: 0.922 Test Loss: 0.590 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 13 cost time: 0.3718888759613037
Epoch: 13, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.502 Vali Acc: 0.926 Test Loss: 0.502 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925921).  Saving model ...
Epoch: 14 cost time: 0.4024672508239746
Epoch: 14, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.427 Vali Acc: 0.933 Test Loss: 0.427 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 15 cost time: 0.3770120143890381
Epoch: 15, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.366 Vali Acc: 0.937 Test Loss: 0.366 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 16 cost time: 0.37498998641967773
Epoch: 16, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.319 Vali Acc: 0.933 Test Loss: 0.319 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3956623077392578
Epoch: 17, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 18 cost time: 0.37801647186279297
Epoch: 18, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3811640739440918
Epoch: 19, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.37915802001953125
Epoch: 20, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.39447450637817383
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.3917503356933594
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.4206278324127197
Epoch: 23, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.409104585647583
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.3797144889831543
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.40877413749694824
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.3775825500488281
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.40661191940307617
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.42418456077575684
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.38118600845336914
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.37012767791748047
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4144771099090576
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.40506982803344727
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.45760154724121094
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.45274877548217773
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.380922794342041
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.39482712745666504
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.41237902641296387
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4745216369628906
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.40137767791748047
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4064652919769287
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.39312148094177246
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 308678
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5743756294250488
Epoch: 1, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.751 Vali Acc: 0.233 Test Loss: 1.751 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.36317992210388184
Epoch: 2, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.718 Vali Acc: 0.344 Test Loss: 1.718 Test Acc: 0.344
Validation loss decreased (-0.233316 --> -0.344427).  Saving model ...
Epoch: 3 cost time: 0.3547680377960205
Epoch: 3, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.686 Vali Acc: 0.478 Test Loss: 1.686 Test Acc: 0.478
Validation loss decreased (-0.344427 --> -0.477761).  Saving model ...
Epoch: 4 cost time: 0.3535430431365967
Epoch: 4, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.643 Vali Acc: 0.600 Test Loss: 1.643 Test Acc: 0.600
Validation loss decreased (-0.477761 --> -0.599984).  Saving model ...
Epoch: 5 cost time: 0.34258484840393066
Epoch: 5, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.585 Vali Acc: 0.689 Test Loss: 1.585 Test Acc: 0.689
Validation loss decreased (-0.599984 --> -0.688873).  Saving model ...
Epoch: 6 cost time: 0.351578950881958
Epoch: 6, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.516 Vali Acc: 0.741 Test Loss: 1.516 Test Acc: 0.741
Validation loss decreased (-0.688873 --> -0.740726).  Saving model ...
Epoch: 7 cost time: 0.4136338233947754
Epoch: 7, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.438 Vali Acc: 0.774 Test Loss: 1.438 Test Acc: 0.774
Validation loss decreased (-0.740726 --> -0.774060).  Saving model ...
Epoch: 8 cost time: 0.3750121593475342
Epoch: 8, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.352 Vali Acc: 0.841 Test Loss: 1.352 Test Acc: 0.841
Validation loss decreased (-0.774060 --> -0.840727).  Saving model ...
Epoch: 9 cost time: 0.34368300437927246
Epoch: 9, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.260 Vali Acc: 0.878 Test Loss: 1.260 Test Acc: 0.878
Validation loss decreased (-0.840727 --> -0.877765).  Saving model ...
Epoch: 10 cost time: 0.3565702438354492
Epoch: 10, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.161 Vali Acc: 0.889 Test Loss: 1.161 Test Acc: 0.889
Validation loss decreased (-0.877765 --> -0.888877).  Saving model ...
Epoch: 11 cost time: 0.38515257835388184
Epoch: 11, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.061 Vali Acc: 0.893 Test Loss: 1.061 Test Acc: 0.893
Validation loss decreased (-0.888877 --> -0.892582).  Saving model ...
Epoch: 12 cost time: 0.34984707832336426
Epoch: 12, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.960 Vali Acc: 0.919 Test Loss: 0.960 Test Acc: 0.919
Validation loss decreased (-0.892582 --> -0.918509).  Saving model ...
Epoch: 13 cost time: 0.324246883392334
Epoch: 13, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.862 Vali Acc: 0.919 Test Loss: 0.862 Test Acc: 0.919
Validation loss decreased (-0.918509 --> -0.918510).  Saving model ...
Epoch: 14 cost time: 0.3629624843597412
Epoch: 14, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.767 Vali Acc: 0.922 Test Loss: 0.767 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922215).  Saving model ...
Epoch: 15 cost time: 0.34975743293762207
Epoch: 15, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.679 Vali Acc: 0.926 Test Loss: 0.679 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 16 cost time: 0.3438129425048828
Epoch: 16, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.598 Vali Acc: 0.930 Test Loss: 0.598 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929624).  Saving model ...
Epoch: 17 cost time: 0.39339709281921387
Epoch: 17, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.524 Vali Acc: 0.930 Test Loss: 0.524 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 18 cost time: 0.35032153129577637
Epoch: 18, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.460 Vali Acc: 0.937 Test Loss: 0.460 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 19 cost time: 0.3769071102142334
Epoch: 19, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.408 Vali Acc: 0.930 Test Loss: 0.408 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3501427173614502
Epoch: 20, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.3809816837310791
Epoch: 21, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.35239076614379883
Epoch: 22, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.36754775047302246
Epoch: 23, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.35323500633239746
Epoch: 24, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.3841245174407959
Epoch: 25, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 0.3480067253112793
Epoch: 26, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.3640134334564209
Epoch: 27, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.34964656829833984
Epoch: 28, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.38753223419189453
Epoch: 29, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.40459394454956055
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.3539743423461914
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.3670196533203125
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.3632352352142334
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.3502175807952881
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.3357975482940674
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 256582
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.559903860092163
Epoch: 1, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.808 Vali Acc: 0.296 Test Loss: 1.808 Test Acc: 0.296
Validation loss decreased (inf --> -0.296278).  Saving model ...
Epoch: 2 cost time: 0.3755354881286621
Epoch: 2, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.781 Vali Acc: 0.341 Test Loss: 1.781 Test Acc: 0.341
Validation loss decreased (-0.296278 --> -0.340723).  Saving model ...
Epoch: 3 cost time: 0.3774442672729492
Epoch: 3, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.756 Vali Acc: 0.359 Test Loss: 1.756 Test Acc: 0.359
Validation loss decreased (-0.340723 --> -0.359242).  Saving model ...
Epoch: 4 cost time: 0.3970329761505127
Epoch: 4, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.724 Vali Acc: 0.385 Test Loss: 1.724 Test Acc: 0.385
Validation loss decreased (-0.359242 --> -0.385168).  Saving model ...
Epoch: 5 cost time: 0.39673471450805664
Epoch: 5, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.682 Vali Acc: 0.422 Test Loss: 1.682 Test Acc: 0.422
Validation loss decreased (-0.385168 --> -0.422205).  Saving model ...
Epoch: 6 cost time: 0.410297155380249
Epoch: 6, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.630 Vali Acc: 0.433 Test Loss: 1.630 Test Acc: 0.433
Validation loss decreased (-0.422205 --> -0.433317).  Saving model ...
Epoch: 7 cost time: 0.4025688171386719
Epoch: 7, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.571 Vali Acc: 0.463 Test Loss: 1.571 Test Acc: 0.463
Validation loss decreased (-0.433317 --> -0.462947).  Saving model ...
Epoch: 8 cost time: 0.43320798873901367
Epoch: 8, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.503 Vali Acc: 0.507 Test Loss: 1.503 Test Acc: 0.507
Validation loss decreased (-0.462947 --> -0.507392).  Saving model ...
Epoch: 9 cost time: 0.41899561882019043
Epoch: 9, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.429 Vali Acc: 0.567 Test Loss: 1.429 Test Acc: 0.567
Validation loss decreased (-0.507392 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.4136829376220703
Epoch: 10, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.348 Vali Acc: 0.622 Test Loss: 1.348 Test Acc: 0.622
Validation loss decreased (-0.566652 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 0.38908982276916504
Epoch: 11, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.264 Vali Acc: 0.670 Test Loss: 1.264 Test Acc: 0.670
Validation loss decreased (-0.622209 --> -0.670358).  Saving model ...
Epoch: 12 cost time: 0.40674710273742676
Epoch: 12, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.177 Vali Acc: 0.756 Test Loss: 1.177 Test Acc: 0.756
Validation loss decreased (-0.670358 --> -0.755544).  Saving model ...
Epoch: 13 cost time: 0.40645599365234375
Epoch: 13, Steps: 2 | Train Loss: 0.844 Vali Loss: 1.090 Vali Acc: 0.804 Test Loss: 1.090 Test Acc: 0.804
Validation loss decreased (-0.755544 --> -0.803693).  Saving model ...
Epoch: 14 cost time: 0.47849559783935547
Epoch: 14, Steps: 2 | Train Loss: 0.737 Vali Loss: 1.003 Vali Acc: 0.844 Test Loss: 1.003 Test Acc: 0.844
Validation loss decreased (-0.803693 --> -0.844434).  Saving model ...
Epoch: 15 cost time: 0.4453403949737549
Epoch: 15, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.919 Vali Acc: 0.863 Test Loss: 0.919 Test Acc: 0.863
Validation loss decreased (-0.844434 --> -0.862954).  Saving model ...
Epoch: 16 cost time: 0.39438629150390625
Epoch: 16, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.835 Vali Acc: 0.885 Test Loss: 0.835 Test Acc: 0.885
Validation loss decreased (-0.862954 --> -0.885177).  Saving model ...
Epoch: 17 cost time: 0.3807981014251709
Epoch: 17, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.757 Vali Acc: 0.896 Test Loss: 0.757 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 18 cost time: 0.47275304794311523
Epoch: 18, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.682 Vali Acc: 0.904 Test Loss: 0.682 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903697).  Saving model ...
Epoch: 19 cost time: 0.388120174407959
Epoch: 19, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.3849914073944092
Epoch: 20, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.548 Vali Acc: 0.904 Test Loss: 0.548 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 21 cost time: 0.4619576930999756
Epoch: 21, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.492 Vali Acc: 0.911 Test Loss: 0.492 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 22 cost time: 0.41503334045410156
Epoch: 22, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.442 Vali Acc: 0.919 Test Loss: 0.442 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 23 cost time: 0.4005882740020752
Epoch: 23, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 24 cost time: 0.4470255374908447
Epoch: 24, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.366 Vali Acc: 0.922 Test Loss: 0.366 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.42728686332702637
Epoch: 25, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 0.38967013359069824
Epoch: 26, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 27 cost time: 0.40890979766845703
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.3707911968231201
Epoch: 28, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.4819786548614502
Epoch: 29, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.372100830078125
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4154841899871826
Epoch: 31, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4280893802642822
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4177088737487793
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.4373619556427002
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.3693244457244873
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.3958604335784912
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.3724820613861084
Epoch: 37, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.38465285301208496
Epoch: 38, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 241286
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7534294128417969
Epoch: 1, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.753 Vali Acc: 0.330 Test Loss: 1.753 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.37413477897644043
Epoch: 2, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.732 Vali Acc: 0.352 Test Loss: 1.732 Test Acc: 0.352
Validation loss decreased (-0.329612 --> -0.351835).  Saving model ...
Epoch: 3 cost time: 0.377169132232666
Epoch: 3, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.713 Vali Acc: 0.359 Test Loss: 1.713 Test Acc: 0.359
Validation loss decreased (-0.351835 --> -0.359242).  Saving model ...
Epoch: 4 cost time: 0.372927188873291
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.689 Vali Acc: 0.419 Test Loss: 1.689 Test Acc: 0.419
Validation loss decreased (-0.359242 --> -0.418502).  Saving model ...
Epoch: 5 cost time: 0.3470427989959717
Epoch: 5, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.656 Vali Acc: 0.448 Test Loss: 1.656 Test Acc: 0.448
Validation loss decreased (-0.418502 --> -0.448132).  Saving model ...
Epoch: 6 cost time: 0.38458704948425293
Epoch: 6, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.617 Vali Acc: 0.496 Test Loss: 1.617 Test Acc: 0.496
Validation loss decreased (-0.448132 --> -0.496280).  Saving model ...
Epoch: 7 cost time: 0.3479955196380615
Epoch: 7, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.570 Vali Acc: 0.533 Test Loss: 1.570 Test Acc: 0.533
Validation loss decreased (-0.496280 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 0.3732738494873047
Epoch: 8, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.517 Vali Acc: 0.596 Test Loss: 1.517 Test Acc: 0.596
Validation loss decreased (-0.533318 --> -0.596281).  Saving model ...
Epoch: 9 cost time: 0.3818964958190918
Epoch: 9, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.458 Vali Acc: 0.667 Test Loss: 1.458 Test Acc: 0.667
Validation loss decreased (-0.596281 --> -0.666652).  Saving model ...
Epoch: 10 cost time: 0.35439229011535645
Epoch: 10, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.395 Vali Acc: 0.711 Test Loss: 1.395 Test Acc: 0.711
Validation loss decreased (-0.666652 --> -0.711097).  Saving model ...
Epoch: 11 cost time: 0.38405585289001465
Epoch: 11, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.327 Vali Acc: 0.759 Test Loss: 1.327 Test Acc: 0.759
Validation loss decreased (-0.711097 --> -0.759246).  Saving model ...
Epoch: 12 cost time: 0.37108755111694336
Epoch: 12, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.254 Vali Acc: 0.815 Test Loss: 1.254 Test Acc: 0.815
Validation loss decreased (-0.759246 --> -0.814802).  Saving model ...
Epoch: 13 cost time: 0.4253826141357422
Epoch: 13, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.178 Vali Acc: 0.848 Test Loss: 1.178 Test Acc: 0.848
Validation loss decreased (-0.814802 --> -0.848136).  Saving model ...
Epoch: 14 cost time: 0.35179972648620605
Epoch: 14, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.100 Vali Acc: 0.874 Test Loss: 1.100 Test Acc: 0.874
Validation loss decreased (-0.848136 --> -0.874063).  Saving model ...
Epoch: 15 cost time: 0.3782384395599365
Epoch: 15, Steps: 2 | Train Loss: 0.841 Vali Loss: 1.021 Vali Acc: 0.896 Test Loss: 1.021 Test Acc: 0.896
Validation loss decreased (-0.874063 --> -0.896286).  Saving model ...
Epoch: 16 cost time: 0.4069850444793701
Epoch: 16, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.943 Vali Acc: 0.900 Test Loss: 0.943 Test Acc: 0.900
Validation loss decreased (-0.896286 --> -0.899991).  Saving model ...
Epoch: 17 cost time: 0.3792893886566162
Epoch: 17, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.867 Vali Acc: 0.911 Test Loss: 0.867 Test Acc: 0.911
Validation loss decreased (-0.899991 --> -0.911102).  Saving model ...
Epoch: 18 cost time: 0.3718297481536865
Epoch: 18, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.794 Vali Acc: 0.915 Test Loss: 0.794 Test Acc: 0.915
Validation loss decreased (-0.911102 --> -0.914807).  Saving model ...
Epoch: 19 cost time: 0.3956482410430908
Epoch: 19, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.723 Vali Acc: 0.926 Test Loss: 0.723 Test Acc: 0.926
Validation loss decreased (-0.914807 --> -0.925919).  Saving model ...
Epoch: 20 cost time: 0.3813815116882324
Epoch: 20, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.656 Vali Acc: 0.937 Test Loss: 0.656 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937030).  Saving model ...
Epoch: 21 cost time: 0.3656277656555176
Epoch: 21, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.595 Vali Acc: 0.937 Test Loss: 0.595 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 22 cost time: 0.3622474670410156
Epoch: 22, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.540 Vali Acc: 0.937 Test Loss: 0.540 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 23 cost time: 0.37918949127197266
Epoch: 23, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.490 Vali Acc: 0.937 Test Loss: 0.490 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 24 cost time: 0.3588070869445801
Epoch: 24, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.446 Vali Acc: 0.941 Test Loss: 0.446 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 25 cost time: 0.3995025157928467
Epoch: 25, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.409 Vali Acc: 0.944 Test Loss: 0.409 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 26 cost time: 0.34347057342529297
Epoch: 26, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.376 Vali Acc: 0.948 Test Loss: 0.376 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 27 cost time: 0.3774590492248535
Epoch: 27, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.347 Vali Acc: 0.952 Test Loss: 0.347 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 28 cost time: 0.37645936012268066
Epoch: 28, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.323 Vali Acc: 0.952 Test Loss: 0.323 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 29 cost time: 0.38945603370666504
Epoch: 29, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.303 Vali Acc: 0.952 Test Loss: 0.303 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.3910062313079834
Epoch: 30, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.287 Vali Acc: 0.952 Test Loss: 0.287 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.3708949089050293
Epoch: 31, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.272 Vali Acc: 0.952 Test Loss: 0.272 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.3515968322753906
Epoch: 32, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.260 Vali Acc: 0.952 Test Loss: 0.260 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.39144062995910645
Epoch: 33, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.44162654876708984
Epoch: 34, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.3712890148162842
Epoch: 35, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.46789050102233887
Epoch: 36, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.38411927223205566
Epoch: 37, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.39498186111450195
Epoch: 38, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.3711259365081787
Epoch: 39, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.3683137893676758
Epoch: 40, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.3801381587982178
Epoch: 41, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.42041945457458496
Epoch: 42, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.3723890781402588
Epoch: 43, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.38434267044067383
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.3886244297027588
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 232198
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7101075649261475
Epoch: 1, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.751 Vali Acc: 0.233 Test Loss: 1.751 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.3687160015106201
Epoch: 2, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.733 Vali Acc: 0.285 Test Loss: 1.733 Test Acc: 0.285
Validation loss decreased (-0.233316 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.3856778144836426
Epoch: 3, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.716 Vali Acc: 0.341 Test Loss: 1.716 Test Acc: 0.341
Validation loss decreased (-0.285168 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.37477588653564453
Epoch: 4, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.694 Vali Acc: 0.426 Test Loss: 1.694 Test Acc: 0.426
Validation loss decreased (-0.340724 --> -0.425909).  Saving model ...
Epoch: 5 cost time: 0.3553347587585449
Epoch: 5, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.665 Vali Acc: 0.511 Test Loss: 1.665 Test Acc: 0.511
Validation loss decreased (-0.425909 --> -0.511094).  Saving model ...
Epoch: 6 cost time: 0.4357941150665283
Epoch: 6, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.630 Vali Acc: 0.604 Test Loss: 1.630 Test Acc: 0.604
Validation loss decreased (-0.511094 --> -0.603687).  Saving model ...
Epoch: 7 cost time: 0.4050941467285156
Epoch: 7, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.589 Vali Acc: 0.652 Test Loss: 1.589 Test Acc: 0.652
Validation loss decreased (-0.603687 --> -0.651836).  Saving model ...
Epoch: 8 cost time: 0.3890235424041748
Epoch: 8, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.544 Vali Acc: 0.719 Test Loss: 1.544 Test Acc: 0.719
Validation loss decreased (-0.651836 --> -0.718503).  Saving model ...
Epoch: 9 cost time: 0.38126468658447266
Epoch: 9, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.493 Vali Acc: 0.778 Test Loss: 1.493 Test Acc: 0.778
Validation loss decreased (-0.718503 --> -0.777763).  Saving model ...
Epoch: 10 cost time: 0.34590816497802734
Epoch: 10, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.438 Vali Acc: 0.830 Test Loss: 1.438 Test Acc: 0.830
Validation loss decreased (-0.777763 --> -0.829615).  Saving model ...
Epoch: 11 cost time: 0.3584129810333252
Epoch: 11, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.379 Vali Acc: 0.844 Test Loss: 1.379 Test Acc: 0.844
Validation loss decreased (-0.829615 --> -0.844431).  Saving model ...
Epoch: 12 cost time: 0.38555264472961426
Epoch: 12, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.315 Vali Acc: 0.881 Test Loss: 1.315 Test Acc: 0.881
Validation loss decreased (-0.844431 --> -0.881468).  Saving model ...
Epoch: 13 cost time: 0.3452115058898926
Epoch: 13, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.248 Vali Acc: 0.907 Test Loss: 1.248 Test Acc: 0.907
Validation loss decreased (-0.881468 --> -0.907395).  Saving model ...
Epoch: 14 cost time: 0.44561338424682617
Epoch: 14, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.178 Vali Acc: 0.907 Test Loss: 1.178 Test Acc: 0.907
Validation loss decreased (-0.907395 --> -0.907396).  Saving model ...
Epoch: 15 cost time: 0.3479282855987549
Epoch: 15, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.108 Vali Acc: 0.926 Test Loss: 1.108 Test Acc: 0.926
Validation loss decreased (-0.907396 --> -0.925915).  Saving model ...
Epoch: 16 cost time: 0.3484501838684082
Epoch: 16, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.035 Vali Acc: 0.926 Test Loss: 1.035 Test Acc: 0.926
Validation loss decreased (-0.925915 --> -0.925916).  Saving model ...
Epoch: 17 cost time: 0.34012341499328613
Epoch: 17, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.963 Vali Acc: 0.926 Test Loss: 0.963 Test Acc: 0.926
Validation loss decreased (-0.925916 --> -0.925916).  Saving model ...
Epoch: 18 cost time: 0.39435362815856934
Epoch: 18, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.891 Vali Acc: 0.930 Test Loss: 0.891 Test Acc: 0.930
Validation loss decreased (-0.925916 --> -0.929621).  Saving model ...
Epoch: 19 cost time: 0.3599588871002197
Epoch: 19, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.821 Vali Acc: 0.930 Test Loss: 0.821 Test Acc: 0.930
Validation loss decreased (-0.929621 --> -0.929621).  Saving model ...
Epoch: 20 cost time: 0.4035019874572754
Epoch: 20, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.752 Vali Acc: 0.933 Test Loss: 0.752 Test Acc: 0.933
Validation loss decreased (-0.929621 --> -0.933326).  Saving model ...
Epoch: 21 cost time: 0.457838773727417
Epoch: 21, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.689 Vali Acc: 0.933 Test Loss: 0.689 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933326).  Saving model ...
Epoch: 22 cost time: 0.4138209819793701
Epoch: 22, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.628 Vali Acc: 0.933 Test Loss: 0.628 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933327).  Saving model ...
Epoch: 23 cost time: 0.37127089500427246
Epoch: 23, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.573 Vali Acc: 0.933 Test Loss: 0.573 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 24 cost time: 0.4193267822265625
Epoch: 24, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.523 Vali Acc: 0.941 Test Loss: 0.523 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 25 cost time: 0.38176608085632324
Epoch: 25, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.479 Vali Acc: 0.941 Test Loss: 0.479 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 26 cost time: 0.4636402130126953
Epoch: 26, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.440 Vali Acc: 0.941 Test Loss: 0.440 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 27 cost time: 0.4017353057861328
Epoch: 27, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.405 Vali Acc: 0.944 Test Loss: 0.405 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 28 cost time: 0.40865039825439453
Epoch: 28, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.375 Vali Acc: 0.948 Test Loss: 0.375 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 29 cost time: 0.4720747470855713
Epoch: 29, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.348 Vali Acc: 0.948 Test Loss: 0.348 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 30 cost time: 0.4595177173614502
Epoch: 30, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.325 Vali Acc: 0.948 Test Loss: 0.325 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 31 cost time: 0.39625978469848633
Epoch: 31, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.305 Vali Acc: 0.948 Test Loss: 0.305 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.398334264755249
Epoch: 32, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.288 Vali Acc: 0.952 Test Loss: 0.288 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.39994168281555176
Epoch: 33, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.273 Vali Acc: 0.956 Test Loss: 0.273 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 34 cost time: 0.42781829833984375
Epoch: 34, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.260 Vali Acc: 0.959 Test Loss: 0.260 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.42461585998535156
Epoch: 35, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.249 Vali Acc: 0.959 Test Loss: 0.249 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 36 cost time: 0.408858060836792
Epoch: 36, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 37 cost time: 0.42256736755371094
Epoch: 37, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 38 cost time: 0.43210482597351074
Epoch: 38, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.225 Vali Acc: 0.959 Test Loss: 0.225 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 39 cost time: 0.4116222858428955
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 40 cost time: 0.4336555004119873
Epoch: 40, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.959 Test Loss: 0.213 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.409822940826416
Epoch: 41, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.423001766204834
Epoch: 42, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 43 cost time: 0.40041208267211914
Epoch: 43, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.466001033782959
Epoch: 44, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 45 cost time: 0.39733147621154785
Epoch: 45, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 46 cost time: 0.5067343711853027
Epoch: 46, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 47 cost time: 0.425947904586792
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 48 cost time: 0.40123629570007324
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 49 cost time: 0.42909789085388184
Epoch: 49, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 50 cost time: 0.47985196113586426
Epoch: 50, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 229318
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.614595651626587
Epoch: 1, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.786 Vali Acc: 0.167 Test Loss: 1.786 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.38713526725769043
Epoch: 2, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.768 Vali Acc: 0.189 Test Loss: 1.768 Test Acc: 0.189
Validation loss decreased (-0.166649 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.4179654121398926
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.753 Vali Acc: 0.196 Test Loss: 1.753 Test Acc: 0.196
Validation loss decreased (-0.188871 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.39195990562438965
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.737 Vali Acc: 0.230 Test Loss: 1.737 Test Acc: 0.230
Validation loss decreased (-0.196279 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.37645530700683594
Epoch: 5, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.714 Vali Acc: 0.341 Test Loss: 1.714 Test Acc: 0.341
Validation loss decreased (-0.229612 --> -0.340724).  Saving model ...
Epoch: 6 cost time: 0.3742799758911133
Epoch: 6, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.687 Vali Acc: 0.400 Test Loss: 1.687 Test Acc: 0.400
Validation loss decreased (-0.340724 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 0.4334118366241455
Epoch: 7, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.655 Vali Acc: 0.422 Test Loss: 1.655 Test Acc: 0.422
Validation loss decreased (-0.399983 --> -0.422206).  Saving model ...
Epoch: 8 cost time: 0.36174702644348145
Epoch: 8, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.618 Vali Acc: 0.448 Test Loss: 1.618 Test Acc: 0.448
Validation loss decreased (-0.422206 --> -0.448132).  Saving model ...
Epoch: 9 cost time: 0.37709832191467285
Epoch: 9, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.578 Vali Acc: 0.489 Test Loss: 1.578 Test Acc: 0.489
Validation loss decreased (-0.448132 --> -0.488873).  Saving model ...
Epoch: 10 cost time: 0.37295031547546387
Epoch: 10, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.533 Vali Acc: 0.548 Test Loss: 1.533 Test Acc: 0.548
Validation loss decreased (-0.488873 --> -0.548133).  Saving model ...
Epoch: 11 cost time: 0.39097166061401367
Epoch: 11, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.484 Vali Acc: 0.652 Test Loss: 1.484 Test Acc: 0.652
Validation loss decreased (-0.548133 --> -0.651837).  Saving model ...
Epoch: 12 cost time: 0.3562030792236328
Epoch: 12, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.432 Vali Acc: 0.726 Test Loss: 1.432 Test Acc: 0.726
Validation loss decreased (-0.651837 --> -0.725912).  Saving model ...
Epoch: 13 cost time: 0.44211578369140625
Epoch: 13, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.378 Vali Acc: 0.796 Test Loss: 1.378 Test Acc: 0.796
Validation loss decreased (-0.725912 --> -0.796283).  Saving model ...
Epoch: 14 cost time: 0.3926372528076172
Epoch: 14, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.321 Vali Acc: 0.837 Test Loss: 1.321 Test Acc: 0.837
Validation loss decreased (-0.796283 --> -0.837024).  Saving model ...
Epoch: 15 cost time: 0.37909674644470215
Epoch: 15, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.262 Vali Acc: 0.859 Test Loss: 1.262 Test Acc: 0.859
Validation loss decreased (-0.837024 --> -0.859247).  Saving model ...
Epoch: 16 cost time: 0.3934211730957031
Epoch: 16, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.201 Vali Acc: 0.867 Test Loss: 1.201 Test Acc: 0.867
Validation loss decreased (-0.859247 --> -0.866655).  Saving model ...
Epoch: 17 cost time: 0.408644437789917
Epoch: 17, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.138 Vali Acc: 0.881 Test Loss: 1.138 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881470).  Saving model ...
Epoch: 18 cost time: 0.4088144302368164
Epoch: 18, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.076 Vali Acc: 0.907 Test Loss: 1.076 Test Acc: 0.907
Validation loss decreased (-0.881470 --> -0.907397).  Saving model ...
Epoch: 19 cost time: 0.369304895401001
Epoch: 19, Steps: 2 | Train Loss: 0.831 Vali Loss: 1.013 Vali Acc: 0.911 Test Loss: 1.013 Test Acc: 0.911
Validation loss decreased (-0.907397 --> -0.911101).  Saving model ...
Epoch: 20 cost time: 0.43263673782348633
Epoch: 20, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.950 Vali Acc: 0.911 Test Loss: 0.950 Test Acc: 0.911
Validation loss decreased (-0.911101 --> -0.911102).  Saving model ...
Epoch: 21 cost time: 0.38034629821777344
Epoch: 21, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.888 Vali Acc: 0.919 Test Loss: 0.888 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918510).  Saving model ...
Epoch: 22 cost time: 0.38607048988342285
Epoch: 22, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.829 Vali Acc: 0.919 Test Loss: 0.829 Test Acc: 0.919
Validation loss decreased (-0.918510 --> -0.918510).  Saving model ...
Epoch: 23 cost time: 0.4067690372467041
Epoch: 23, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.773 Vali Acc: 0.926 Test Loss: 0.773 Test Acc: 0.926
Validation loss decreased (-0.918510 --> -0.925918).  Saving model ...
Epoch: 24 cost time: 0.3968799114227295
Epoch: 24, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.720 Vali Acc: 0.922 Test Loss: 0.720 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4332258701324463
Epoch: 25, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.671 Vali Acc: 0.933 Test Loss: 0.671 Test Acc: 0.933
Validation loss decreased (-0.925918 --> -0.933327).  Saving model ...
Epoch: 26 cost time: 0.4307520389556885
Epoch: 26, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.625 Vali Acc: 0.937 Test Loss: 0.625 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 27 cost time: 0.4234805107116699
Epoch: 27, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.583 Vali Acc: 0.937 Test Loss: 0.583 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 28 cost time: 0.4227263927459717
Epoch: 28, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.545 Vali Acc: 0.937 Test Loss: 0.545 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 29 cost time: 0.41650962829589844
Epoch: 29, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.512 Vali Acc: 0.933 Test Loss: 0.512 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.3928804397583008
Epoch: 30, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.481 Vali Acc: 0.937 Test Loss: 0.481 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 31 cost time: 0.4214041233062744
Epoch: 31, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.454 Vali Acc: 0.941 Test Loss: 0.454 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 32 cost time: 0.43157124519348145
Epoch: 32, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.429 Vali Acc: 0.933 Test Loss: 0.429 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.37766361236572266
Epoch: 33, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.407 Vali Acc: 0.933 Test Loss: 0.407 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4498767852783203
Epoch: 34, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.386 Vali Acc: 0.941 Test Loss: 0.386 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.42453908920288086
Epoch: 35, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.367 Vali Acc: 0.944 Test Loss: 0.367 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.3963737487792969
Epoch: 36, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.351 Vali Acc: 0.944 Test Loss: 0.351 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.3976893424987793
Epoch: 37, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.336 Vali Acc: 0.944 Test Loss: 0.336 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.37726879119873047
Epoch: 38, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.324 Vali Acc: 0.944 Test Loss: 0.324 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.4023170471191406
Epoch: 39, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.40340471267700195
Epoch: 40, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 0.43167853355407715
Epoch: 41, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.41337060928344727
Epoch: 42, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4272139072418213
Epoch: 43, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5005767345428467
Epoch: 44, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.41727304458618164
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.4052727222442627
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.3793025016784668
Epoch: 47, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.3853895664215088
Epoch: 48, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.4279787540435791
Epoch: 49, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.45127344131469727
Epoch: 50, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 223366
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6931006908416748
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.779 Vali Acc: 0.230 Test Loss: 1.779 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.3697175979614258
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.765 Vali Acc: 0.278 Test Loss: 1.765 Test Acc: 0.278
Validation loss decreased (-0.229612 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.40175914764404297
Epoch: 3, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.752 Vali Acc: 0.307 Test Loss: 1.752 Test Acc: 0.307
Validation loss decreased (-0.277760 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.40303564071655273
Epoch: 4, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.738 Vali Acc: 0.352 Test Loss: 1.738 Test Acc: 0.352
Validation loss decreased (-0.307390 --> -0.351834).  Saving model ...
Epoch: 5 cost time: 0.38849759101867676
Epoch: 5, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.718 Vali Acc: 0.389 Test Loss: 1.718 Test Acc: 0.389
Validation loss decreased (-0.351834 --> -0.388872).  Saving model ...
Epoch: 6 cost time: 0.41475820541381836
Epoch: 6, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.693 Vali Acc: 0.448 Test Loss: 1.693 Test Acc: 0.448
Validation loss decreased (-0.388872 --> -0.448131).  Saving model ...
Epoch: 7 cost time: 0.3827219009399414
Epoch: 7, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.663 Vali Acc: 0.493 Test Loss: 1.663 Test Acc: 0.493
Validation loss decreased (-0.448131 --> -0.492576).  Saving model ...
Epoch: 8 cost time: 0.38344573974609375
Epoch: 8, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.629 Vali Acc: 0.526 Test Loss: 1.629 Test Acc: 0.526
Validation loss decreased (-0.492576 --> -0.525910).  Saving model ...
Epoch: 9 cost time: 0.4204285144805908
Epoch: 9, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.590 Vali Acc: 0.570 Test Loss: 1.590 Test Acc: 0.570
Validation loss decreased (-0.525910 --> -0.570354).  Saving model ...
Epoch: 10 cost time: 0.3909718990325928
Epoch: 10, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.547 Vali Acc: 0.652 Test Loss: 1.547 Test Acc: 0.652
Validation loss decreased (-0.570354 --> -0.651836).  Saving model ...
Epoch: 11 cost time: 0.38146305084228516
Epoch: 11, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.501 Vali Acc: 0.693 Test Loss: 1.501 Test Acc: 0.693
Validation loss decreased (-0.651836 --> -0.692578).  Saving model ...
Epoch: 12 cost time: 0.4106419086456299
Epoch: 12, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.452 Vali Acc: 0.707 Test Loss: 1.452 Test Acc: 0.707
Validation loss decreased (-0.692578 --> -0.707393).  Saving model ...
Epoch: 13 cost time: 0.3899695873260498
Epoch: 13, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.401 Vali Acc: 0.763 Test Loss: 1.401 Test Acc: 0.763
Validation loss decreased (-0.707393 --> -0.762949).  Saving model ...
Epoch: 14 cost time: 0.3823232650756836
Epoch: 14, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.347 Vali Acc: 0.804 Test Loss: 1.347 Test Acc: 0.804
Validation loss decreased (-0.762949 --> -0.803690).  Saving model ...
Epoch: 15 cost time: 0.4212367534637451
Epoch: 15, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.291 Vali Acc: 0.833 Test Loss: 1.291 Test Acc: 0.833
Validation loss decreased (-0.803690 --> -0.833320).  Saving model ...
Epoch: 16 cost time: 0.3975057601928711
Epoch: 16, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.233 Vali Acc: 0.859 Test Loss: 1.233 Test Acc: 0.859
Validation loss decreased (-0.833320 --> -0.859247).  Saving model ...
Epoch: 17 cost time: 0.41834330558776855
Epoch: 17, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.175 Vali Acc: 0.874 Test Loss: 1.175 Test Acc: 0.874
Validation loss decreased (-0.859247 --> -0.874062).  Saving model ...
Epoch: 18 cost time: 0.3984346389770508
Epoch: 18, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.115 Vali Acc: 0.878 Test Loss: 1.115 Test Acc: 0.878
Validation loss decreased (-0.874062 --> -0.877767).  Saving model ...
Epoch: 19 cost time: 0.3933401107788086
Epoch: 19, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.055 Vali Acc: 0.881 Test Loss: 1.055 Test Acc: 0.881
Validation loss decreased (-0.877767 --> -0.881471).  Saving model ...
Epoch: 20 cost time: 0.41905832290649414
Epoch: 20, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.996 Vali Acc: 0.889 Test Loss: 0.996 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888879).  Saving model ...
Epoch: 21 cost time: 0.4071826934814453
Epoch: 21, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.938 Vali Acc: 0.889 Test Loss: 0.938 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888880).  Saving model ...
Epoch: 22 cost time: 0.38003969192504883
Epoch: 22, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.882 Vali Acc: 0.904 Test Loss: 0.882 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903695).  Saving model ...
Epoch: 23 cost time: 0.4226818084716797
Epoch: 23, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.829 Vali Acc: 0.904 Test Loss: 0.829 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903695).  Saving model ...
Epoch: 24 cost time: 0.4037914276123047
Epoch: 24, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.777 Vali Acc: 0.904 Test Loss: 0.777 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903696).  Saving model ...
Epoch: 25 cost time: 0.35864782333374023
Epoch: 25, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.728 Vali Acc: 0.911 Test Loss: 0.728 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 26 cost time: 0.37364625930786133
Epoch: 26, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.682 Vali Acc: 0.919 Test Loss: 0.682 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 27 cost time: 0.38844752311706543
Epoch: 27, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.639 Vali Acc: 0.922 Test Loss: 0.639 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 28 cost time: 0.4627056121826172
Epoch: 28, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.599 Vali Acc: 0.922 Test Loss: 0.599 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 29 cost time: 0.47893691062927246
Epoch: 29, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.563 Vali Acc: 0.922 Test Loss: 0.563 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 30 cost time: 0.476804256439209
Epoch: 30, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.530 Vali Acc: 0.930 Test Loss: 0.530 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929624).  Saving model ...
Epoch: 31 cost time: 0.48955321311950684
Epoch: 31, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.500 Vali Acc: 0.933 Test Loss: 0.500 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 32 cost time: 0.47004270553588867
Epoch: 32, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.472 Vali Acc: 0.933 Test Loss: 0.472 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 33 cost time: 0.4194037914276123
Epoch: 33, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.448 Vali Acc: 0.933 Test Loss: 0.448 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.4535093307495117
Epoch: 34, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.37413883209228516
Epoch: 35, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.404 Vali Acc: 0.930 Test Loss: 0.404 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.41831469535827637
Epoch: 36, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.386 Vali Acc: 0.937 Test Loss: 0.386 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.4320647716522217
Epoch: 37, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.369 Vali Acc: 0.941 Test Loss: 0.369 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 38 cost time: 0.4148068428039551
Epoch: 38, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.354 Vali Acc: 0.937 Test Loss: 0.354 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.44733142852783203
Epoch: 39, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 40 cost time: 0.41367411613464355
Epoch: 40, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.327 Vali Acc: 0.937 Test Loss: 0.327 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.40099024772644043
Epoch: 41, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.42693400382995605
Epoch: 42, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4263439178466797
Epoch: 43, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4103093147277832
Epoch: 44, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.397125244140625
Epoch: 45, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4058105945587158
Epoch: 46, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.4301455020904541
Epoch: 47, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.43730950355529785
Epoch: 48, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4257650375366211
Epoch: 49, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.42276787757873535
Epoch: 50, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 220550
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.74690842628479
Epoch: 1, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.752 Vali Acc: 0.244 Test Loss: 1.752 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.4879746437072754
Epoch: 2, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.723 Vali Acc: 0.333 Test Loss: 1.723 Test Acc: 0.333
Validation loss decreased (-0.244427 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.4163949489593506
Epoch: 3, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.693 Vali Acc: 0.437 Test Loss: 1.693 Test Acc: 0.437
Validation loss decreased (-0.333316 --> -0.437020).  Saving model ...
Epoch: 4 cost time: 0.3956749439239502
Epoch: 4, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.653 Vali Acc: 0.541 Test Loss: 1.653 Test Acc: 0.541
Validation loss decreased (-0.437020 --> -0.540724).  Saving model ...
Epoch: 5 cost time: 0.42795228958129883
Epoch: 5, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.601 Vali Acc: 0.622 Test Loss: 1.601 Test Acc: 0.622
Validation loss decreased (-0.540724 --> -0.622206).  Saving model ...
Epoch: 6 cost time: 0.4213392734527588
Epoch: 6, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.540 Vali Acc: 0.670 Test Loss: 1.540 Test Acc: 0.670
Validation loss decreased (-0.622206 --> -0.670355).  Saving model ...
Epoch: 7 cost time: 0.4563121795654297
Epoch: 7, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.470 Vali Acc: 0.711 Test Loss: 1.470 Test Acc: 0.711
Validation loss decreased (-0.670355 --> -0.711096).  Saving model ...
Epoch: 8 cost time: 0.4083881378173828
Epoch: 8, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.392 Vali Acc: 0.748 Test Loss: 1.392 Test Acc: 0.748
Validation loss decreased (-0.711096 --> -0.748134).  Saving model ...
Epoch: 9 cost time: 0.4606199264526367
Epoch: 9, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.306 Vali Acc: 0.793 Test Loss: 1.306 Test Acc: 0.793
Validation loss decreased (-0.748134 --> -0.792580).  Saving model ...
Epoch: 10 cost time: 0.3944680690765381
Epoch: 10, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.215 Vali Acc: 0.819 Test Loss: 1.215 Test Acc: 0.819
Validation loss decreased (-0.792580 --> -0.818506).  Saving model ...
Epoch: 11 cost time: 0.42492008209228516
Epoch: 11, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.121 Vali Acc: 0.841 Test Loss: 1.121 Test Acc: 0.841
Validation loss decreased (-0.818506 --> -0.840730).  Saving model ...
Epoch: 12 cost time: 0.38767242431640625
Epoch: 12, Steps: 2 | Train Loss: 0.829 Vali Loss: 1.026 Vali Acc: 0.848 Test Loss: 1.026 Test Acc: 0.848
Validation loss decreased (-0.840730 --> -0.848138).  Saving model ...
Epoch: 13 cost time: 0.414717435836792
Epoch: 13, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.933 Vali Acc: 0.867 Test Loss: 0.933 Test Acc: 0.867
Validation loss decreased (-0.848138 --> -0.866657).  Saving model ...
Epoch: 14 cost time: 0.4211618900299072
Epoch: 14, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.840 Vali Acc: 0.889 Test Loss: 0.840 Test Acc: 0.889
Validation loss decreased (-0.866657 --> -0.888880).  Saving model ...
Epoch: 15 cost time: 0.41907382011413574
Epoch: 15, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.752 Vali Acc: 0.896 Test Loss: 0.752 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896289).  Saving model ...
Epoch: 16 cost time: 0.4840521812438965
Epoch: 16, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.667 Vali Acc: 0.907 Test Loss: 0.667 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 17 cost time: 0.40108275413513184
Epoch: 17, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.590 Vali Acc: 0.911 Test Loss: 0.590 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 18 cost time: 0.38114118576049805
Epoch: 18, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.522 Vali Acc: 0.926 Test Loss: 0.522 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 19 cost time: 0.38581252098083496
Epoch: 19, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.463 Vali Acc: 0.926 Test Loss: 0.463 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 20 cost time: 0.4077460765838623
Epoch: 20, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.413 Vali Acc: 0.926 Test Loss: 0.413 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.41130876541137695
Epoch: 21, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.372 Vali Acc: 0.926 Test Loss: 0.372 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.395338773727417
Epoch: 22, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.336 Vali Acc: 0.926 Test Loss: 0.336 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.38330554962158203
Epoch: 23, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.4387056827545166
Epoch: 24, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.39951348304748535
Epoch: 25, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.40044403076171875
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.41122984886169434
Epoch: 27, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.3820364475250244
Epoch: 28, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.42284584045410156
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.40664100646972656
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.3804154396057129
Epoch: 31, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.4124324321746826
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.40462636947631836
Epoch: 33, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.41518664360046387
Epoch: 34, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.4121537208557129
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 36 cost time: 0.39287424087524414
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 37 cost time: 0.3880727291107178
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 38 cost time: 0.44205570220947266
Epoch: 38, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 39 cost time: 0.42101502418518066
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 40 cost time: 0.41867637634277344
Epoch: 40, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.3746812343597412
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.3824117183685303
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959258).  Saving model ...
Epoch: 43 cost time: 0.36296629905700684
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 44 cost time: 0.38565874099731445
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 45 cost time: 0.38863468170166016
Epoch: 45, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 46 cost time: 0.39556360244750977
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 47 cost time: 0.39551258087158203
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 48 cost time: 0.47241854667663574
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 49 cost time: 0.3922262191772461
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 50 cost time: 0.45122504234313965
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 109286
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5511908531188965
Epoch: 1, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.785 Vali Acc: 0.137 Test Loss: 1.785 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.3572375774383545
Epoch: 2, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.766 Vali Acc: 0.181 Test Loss: 1.766 Test Acc: 0.181
Validation loss decreased (-0.137019 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.3671700954437256
Epoch: 3, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.749 Vali Acc: 0.193 Test Loss: 1.749 Test Acc: 0.193
Validation loss decreased (-0.181464 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 0.36177730560302734
Epoch: 4, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.728 Vali Acc: 0.226 Test Loss: 1.728 Test Acc: 0.226
Validation loss decreased (-0.192575 --> -0.225909).  Saving model ...
Epoch: 5 cost time: 0.4051685333251953
Epoch: 5, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.699 Vali Acc: 0.248 Test Loss: 1.699 Test Acc: 0.248
Validation loss decreased (-0.225909 --> -0.248131).  Saving model ...
Epoch: 6 cost time: 0.3977537155151367
Epoch: 6, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.663 Vali Acc: 0.333 Test Loss: 1.663 Test Acc: 0.333
Validation loss decreased (-0.248131 --> -0.333317).  Saving model ...
Epoch: 7 cost time: 0.38049888610839844
Epoch: 7, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.619 Vali Acc: 0.419 Test Loss: 1.619 Test Acc: 0.419
Validation loss decreased (-0.333317 --> -0.418502).  Saving model ...
Epoch: 8 cost time: 0.3534114360809326
Epoch: 8, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.570 Vali Acc: 0.570 Test Loss: 1.570 Test Acc: 0.570
Validation loss decreased (-0.418502 --> -0.570355).  Saving model ...
Epoch: 9 cost time: 0.3609614372253418
Epoch: 9, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.516 Vali Acc: 0.685 Test Loss: 1.516 Test Acc: 0.685
Validation loss decreased (-0.570355 --> -0.685170).  Saving model ...
Epoch: 10 cost time: 0.34970521926879883
Epoch: 10, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.458 Vali Acc: 0.737 Test Loss: 1.458 Test Acc: 0.737
Validation loss decreased (-0.685170 --> -0.737022).  Saving model ...
Epoch: 11 cost time: 0.3332393169403076
Epoch: 11, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.396 Vali Acc: 0.774 Test Loss: 1.396 Test Acc: 0.774
Validation loss decreased (-0.737022 --> -0.774060).  Saving model ...
Epoch: 12 cost time: 0.36838531494140625
Epoch: 12, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.331 Vali Acc: 0.807 Test Loss: 1.331 Test Acc: 0.807
Validation loss decreased (-0.774060 --> -0.807394).  Saving model ...
Epoch: 13 cost time: 0.48836231231689453
Epoch: 13, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.261 Vali Acc: 0.837 Test Loss: 1.261 Test Acc: 0.837
Validation loss decreased (-0.807394 --> -0.837024).  Saving model ...
Epoch: 14 cost time: 0.40263867378234863
Epoch: 14, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.190 Vali Acc: 0.859 Test Loss: 1.190 Test Acc: 0.859
Validation loss decreased (-0.837024 --> -0.859247).  Saving model ...
Epoch: 15 cost time: 0.4027876853942871
Epoch: 15, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.117 Vali Acc: 0.900 Test Loss: 1.117 Test Acc: 0.900
Validation loss decreased (-0.859247 --> -0.899989).  Saving model ...
Epoch: 16 cost time: 0.3524494171142578
Epoch: 16, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.044 Vali Acc: 0.904 Test Loss: 1.044 Test Acc: 0.904
Validation loss decreased (-0.899989 --> -0.903693).  Saving model ...
Epoch: 17 cost time: 0.35582923889160156
Epoch: 17, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.973 Vali Acc: 0.915 Test Loss: 0.973 Test Acc: 0.915
Validation loss decreased (-0.903693 --> -0.914805).  Saving model ...
Epoch: 18 cost time: 0.3912174701690674
Epoch: 18, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.903 Vali Acc: 0.915 Test Loss: 0.903 Test Acc: 0.915
Validation loss decreased (-0.914805 --> -0.914806).  Saving model ...
Epoch: 19 cost time: 0.3645946979522705
Epoch: 19, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.834 Vali Acc: 0.922 Test Loss: 0.834 Test Acc: 0.922
Validation loss decreased (-0.914806 --> -0.922214).  Saving model ...
Epoch: 20 cost time: 0.36490774154663086
Epoch: 20, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.767 Vali Acc: 0.926 Test Loss: 0.767 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925918).  Saving model ...
Epoch: 21 cost time: 0.3511161804199219
Epoch: 21, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.706 Vali Acc: 0.930 Test Loss: 0.706 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929623).  Saving model ...
Epoch: 22 cost time: 0.3581111431121826
Epoch: 22, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.648 Vali Acc: 0.933 Test Loss: 0.648 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 23 cost time: 0.36205554008483887
Epoch: 23, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.595 Vali Acc: 0.930 Test Loss: 0.595 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3773782253265381
Epoch: 24, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.546 Vali Acc: 0.933 Test Loss: 0.546 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 25 cost time: 0.3579676151275635
Epoch: 25, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.503 Vali Acc: 0.933 Test Loss: 0.503 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 26 cost time: 0.3520171642303467
Epoch: 26, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.463 Vali Acc: 0.937 Test Loss: 0.463 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 27 cost time: 0.42389607429504395
Epoch: 27, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.429 Vali Acc: 0.937 Test Loss: 0.429 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 28 cost time: 0.3960683345794678
Epoch: 28, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.399 Vali Acc: 0.937 Test Loss: 0.399 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 29 cost time: 0.38382506370544434
Epoch: 29, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.372 Vali Acc: 0.937 Test Loss: 0.372 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.37678956985473633
Epoch: 30, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.349 Vali Acc: 0.941 Test Loss: 0.349 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 31 cost time: 0.37432384490966797
Epoch: 31, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.328 Vali Acc: 0.944 Test Loss: 0.328 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.3703799247741699
Epoch: 32, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 33 cost time: 0.40180253982543945
Epoch: 33, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4407930374145508
Epoch: 34, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4375298023223877
Epoch: 35, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.420900821685791
Epoch: 36, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.37154626846313477
Epoch: 37, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3643524646759033
Epoch: 38, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.385042667388916
Epoch: 39, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.38232994079589844
Epoch: 40, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.3760838508605957
Epoch: 41, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.35294628143310547
Epoch: 42, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 83238
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6313080787658691
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.840 Vali Acc: 0.200 Test Loss: 1.840 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.35068702697753906
Epoch: 2, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.821 Vali Acc: 0.237 Test Loss: 1.821 Test Acc: 0.237
Validation loss decreased (-0.199982 --> -0.237019).  Saving model ...
Epoch: 3 cost time: 0.37274742126464844
Epoch: 3, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.806 Vali Acc: 0.259 Test Loss: 1.806 Test Acc: 0.259
Validation loss decreased (-0.237019 --> -0.259241).  Saving model ...
Epoch: 4 cost time: 0.38219571113586426
Epoch: 4, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.791 Vali Acc: 0.274 Test Loss: 1.791 Test Acc: 0.274
Validation loss decreased (-0.259241 --> -0.274056).  Saving model ...
Epoch: 5 cost time: 0.3689119815826416
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.770 Vali Acc: 0.307 Test Loss: 1.770 Test Acc: 0.307
Validation loss decreased (-0.274056 --> -0.307390).  Saving model ...
Epoch: 6 cost time: 0.37870144844055176
Epoch: 6, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.745 Vali Acc: 0.344 Test Loss: 1.745 Test Acc: 0.344
Validation loss decreased (-0.307390 --> -0.344427).  Saving model ...
Epoch: 7 cost time: 0.3576085567474365
Epoch: 7, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.715 Vali Acc: 0.356 Test Loss: 1.715 Test Acc: 0.356
Validation loss decreased (-0.344427 --> -0.355538).  Saving model ...
Epoch: 8 cost time: 0.40722036361694336
Epoch: 8, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.680 Vali Acc: 0.378 Test Loss: 1.680 Test Acc: 0.378
Validation loss decreased (-0.355538 --> -0.377761).  Saving model ...
Epoch: 9 cost time: 0.3337984085083008
Epoch: 9, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.641 Vali Acc: 0.393 Test Loss: 1.641 Test Acc: 0.393
Validation loss decreased (-0.377761 --> -0.392576).  Saving model ...
Epoch: 10 cost time: 0.3797340393066406
Epoch: 10, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.598 Vali Acc: 0.463 Test Loss: 1.598 Test Acc: 0.463
Validation loss decreased (-0.392576 --> -0.462947).  Saving model ...
Epoch: 11 cost time: 0.3509678840637207
Epoch: 11, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.552 Vali Acc: 0.548 Test Loss: 1.552 Test Acc: 0.548
Validation loss decreased (-0.462947 --> -0.548133).  Saving model ...
Epoch: 12 cost time: 0.3694491386413574
Epoch: 12, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.502 Vali Acc: 0.615 Test Loss: 1.502 Test Acc: 0.615
Validation loss decreased (-0.548133 --> -0.614800).  Saving model ...
Epoch: 13 cost time: 0.36482858657836914
Epoch: 13, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.450 Vali Acc: 0.667 Test Loss: 1.450 Test Acc: 0.667
Validation loss decreased (-0.614800 --> -0.666652).  Saving model ...
Epoch: 14 cost time: 0.4827570915222168
Epoch: 14, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.395 Vali Acc: 0.704 Test Loss: 1.395 Test Acc: 0.704
Validation loss decreased (-0.666652 --> -0.703690).  Saving model ...
Epoch: 15 cost time: 0.43541979789733887
Epoch: 15, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.340 Vali Acc: 0.741 Test Loss: 1.340 Test Acc: 0.741
Validation loss decreased (-0.703690 --> -0.740727).  Saving model ...
Epoch: 16 cost time: 0.3508756160736084
Epoch: 16, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.283 Vali Acc: 0.767 Test Loss: 1.283 Test Acc: 0.767
Validation loss decreased (-0.740727 --> -0.766654).  Saving model ...
Epoch: 17 cost time: 0.37889647483825684
Epoch: 17, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.223 Vali Acc: 0.811 Test Loss: 1.223 Test Acc: 0.811
Validation loss decreased (-0.766654 --> -0.811099).  Saving model ...
Epoch: 18 cost time: 0.42171239852905273
Epoch: 18, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.163 Vali Acc: 0.822 Test Loss: 1.163 Test Acc: 0.822
Validation loss decreased (-0.811099 --> -0.822211).  Saving model ...
Epoch: 19 cost time: 0.35384607315063477
Epoch: 19, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.101 Vali Acc: 0.844 Test Loss: 1.101 Test Acc: 0.844
Validation loss decreased (-0.822211 --> -0.844433).  Saving model ...
Epoch: 20 cost time: 0.3570389747619629
Epoch: 20, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.039 Vali Acc: 0.856 Test Loss: 1.039 Test Acc: 0.856
Validation loss decreased (-0.844433 --> -0.855545).  Saving model ...
Epoch: 21 cost time: 0.3154008388519287
Epoch: 21, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.977 Vali Acc: 0.870 Test Loss: 0.977 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 22 cost time: 0.3561239242553711
Epoch: 22, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.916 Vali Acc: 0.885 Test Loss: 0.916 Test Acc: 0.885
Validation loss decreased (-0.870361 --> -0.885176).  Saving model ...
Epoch: 23 cost time: 0.34572672843933105
Epoch: 23, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.856 Vali Acc: 0.896 Test Loss: 0.856 Test Acc: 0.896
Validation loss decreased (-0.885176 --> -0.896288).  Saving model ...
Epoch: 24 cost time: 0.3461298942565918
Epoch: 24, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.797 Vali Acc: 0.904 Test Loss: 0.797 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903696).  Saving model ...
Epoch: 25 cost time: 0.4100077152252197
Epoch: 25, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.742 Vali Acc: 0.907 Test Loss: 0.742 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 26 cost time: 0.34502625465393066
Epoch: 26, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.690 Vali Acc: 0.919 Test Loss: 0.690 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 27 cost time: 0.3329315185546875
Epoch: 27, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.642 Vali Acc: 0.930 Test Loss: 0.642 Test Acc: 0.930
Validation loss decreased (-0.918512 --> -0.929623).  Saving model ...
Epoch: 28 cost time: 0.38916683197021484
Epoch: 28, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.598 Vali Acc: 0.937 Test Loss: 0.598 Test Acc: 0.937
Validation loss decreased (-0.929623 --> -0.937031).  Saving model ...
Epoch: 29 cost time: 0.3260033130645752
Epoch: 29, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.558 Vali Acc: 0.937 Test Loss: 0.558 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 30 cost time: 0.33359456062316895
Epoch: 30, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.521 Vali Acc: 0.941 Test Loss: 0.521 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940736).  Saving model ...
Epoch: 31 cost time: 0.33298349380493164
Epoch: 31, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.488 Vali Acc: 0.944 Test Loss: 0.488 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 32 cost time: 0.3708994388580322
Epoch: 32, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.459 Vali Acc: 0.944 Test Loss: 0.459 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 33 cost time: 0.42017650604248047
Epoch: 33, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.433 Vali Acc: 0.944 Test Loss: 0.433 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 34 cost time: 0.4022383689880371
Epoch: 34, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.410 Vali Acc: 0.944 Test Loss: 0.410 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 35 cost time: 0.37919068336486816
Epoch: 35, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.388 Vali Acc: 0.944 Test Loss: 0.388 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.3769817352294922
Epoch: 36, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.3557898998260498
Epoch: 37, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.352 Vali Acc: 0.944 Test Loss: 0.352 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.34096550941467285
Epoch: 38, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.337 Vali Acc: 0.952 Test Loss: 0.337 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 39 cost time: 0.34238529205322266
Epoch: 39, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.323 Vali Acc: 0.952 Test Loss: 0.323 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.34472036361694336
Epoch: 40, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.311 Vali Acc: 0.952 Test Loss: 0.311 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.38296055793762207
Epoch: 41, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.3397490978240967
Epoch: 42, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.291 Vali Acc: 0.956 Test Loss: 0.291 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.3709297180175781
Epoch: 43, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.282 Vali Acc: 0.956 Test Loss: 0.282 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 44 cost time: 0.3424546718597412
Epoch: 44, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.275 Vali Acc: 0.956 Test Loss: 0.275 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.3527202606201172
Epoch: 45, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.268 Vali Acc: 0.956 Test Loss: 0.268 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.35798168182373047
Epoch: 46, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.262 Vali Acc: 0.956 Test Loss: 0.262 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.383303165435791
Epoch: 47, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.256 Vali Acc: 0.956 Test Loss: 0.256 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.4069516658782959
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.34250545501708984
Epoch: 49, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.3872981071472168
Epoch: 50, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 75590
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5702908039093018
Epoch: 1, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.814 Vali Acc: 0.074 Test Loss: 1.814 Test Acc: 0.074
Validation loss decreased (inf --> -0.074056).  Saving model ...
Epoch: 2 cost time: 0.43270301818847656
Epoch: 2, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.803 Vali Acc: 0.089 Test Loss: 1.803 Test Acc: 0.089
Validation loss decreased (-0.074056 --> -0.088871).  Saving model ...
Epoch: 3 cost time: 0.3882622718811035
Epoch: 3, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.795 Vali Acc: 0.100 Test Loss: 1.795 Test Acc: 0.100
Validation loss decreased (-0.088871 --> -0.099982).  Saving model ...
Epoch: 4 cost time: 0.3376779556274414
Epoch: 4, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.786 Vali Acc: 0.115 Test Loss: 1.786 Test Acc: 0.115
Validation loss decreased (-0.099982 --> -0.114797).  Saving model ...
Epoch: 5 cost time: 0.38140273094177246
Epoch: 5, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.773 Vali Acc: 0.130 Test Loss: 1.773 Test Acc: 0.130
Validation loss decreased (-0.114797 --> -0.129612).  Saving model ...
Epoch: 6 cost time: 0.3689768314361572
Epoch: 6, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.756 Vali Acc: 0.215 Test Loss: 1.756 Test Acc: 0.215
Validation loss decreased (-0.129612 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.4054098129272461
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.735 Vali Acc: 0.296 Test Loss: 1.735 Test Acc: 0.296
Validation loss decreased (-0.214797 --> -0.296279).  Saving model ...
Epoch: 8 cost time: 0.4186069965362549
Epoch: 8, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.711 Vali Acc: 0.356 Test Loss: 1.711 Test Acc: 0.356
Validation loss decreased (-0.296279 --> -0.355538).  Saving model ...
Epoch: 9 cost time: 0.39097094535827637
Epoch: 9, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.683 Vali Acc: 0.389 Test Loss: 1.683 Test Acc: 0.389
Validation loss decreased (-0.355538 --> -0.388872).  Saving model ...
Epoch: 10 cost time: 0.37723350524902344
Epoch: 10, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.651 Vali Acc: 0.437 Test Loss: 1.651 Test Acc: 0.437
Validation loss decreased (-0.388872 --> -0.437021).  Saving model ...
Epoch: 11 cost time: 0.3610405921936035
Epoch: 11, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.615 Vali Acc: 0.519 Test Loss: 1.615 Test Acc: 0.519
Validation loss decreased (-0.437021 --> -0.518502).  Saving model ...
Epoch: 12 cost time: 0.3560645580291748
Epoch: 12, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.577 Vali Acc: 0.574 Test Loss: 1.577 Test Acc: 0.574
Validation loss decreased (-0.518502 --> -0.574058).  Saving model ...
Epoch: 13 cost time: 0.38121581077575684
Epoch: 13, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.536 Vali Acc: 0.619 Test Loss: 1.536 Test Acc: 0.619
Validation loss decreased (-0.574058 --> -0.618503).  Saving model ...
Epoch: 14 cost time: 0.3566782474517822
Epoch: 14, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.493 Vali Acc: 0.644 Test Loss: 1.493 Test Acc: 0.644
Validation loss decreased (-0.618503 --> -0.644430).  Saving model ...
Epoch: 15 cost time: 0.3444504737854004
Epoch: 15, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.447 Vali Acc: 0.689 Test Loss: 1.447 Test Acc: 0.689
Validation loss decreased (-0.644430 --> -0.688874).  Saving model ...
Epoch: 16 cost time: 0.3702096939086914
Epoch: 16, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.399 Vali Acc: 0.719 Test Loss: 1.399 Test Acc: 0.719
Validation loss decreased (-0.688874 --> -0.718505).  Saving model ...
Epoch: 17 cost time: 0.4048454761505127
Epoch: 17, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.350 Vali Acc: 0.756 Test Loss: 1.350 Test Acc: 0.756
Validation loss decreased (-0.718505 --> -0.755542).  Saving model ...
Epoch: 18 cost time: 0.3652608394622803
Epoch: 18, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.298 Vali Acc: 0.785 Test Loss: 1.298 Test Acc: 0.785
Validation loss decreased (-0.755542 --> -0.785172).  Saving model ...
Epoch: 19 cost time: 0.3695371150970459
Epoch: 19, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.245 Vali Acc: 0.807 Test Loss: 1.245 Test Acc: 0.807
Validation loss decreased (-0.785172 --> -0.807395).  Saving model ...
Epoch: 20 cost time: 0.3544607162475586
Epoch: 20, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.191 Vali Acc: 0.841 Test Loss: 1.191 Test Acc: 0.841
Validation loss decreased (-0.807395 --> -0.840729).  Saving model ...
Epoch: 21 cost time: 0.38899731636047363
Epoch: 21, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.135 Vali Acc: 0.852 Test Loss: 1.135 Test Acc: 0.852
Validation loss decreased (-0.840729 --> -0.851841).  Saving model ...
Epoch: 22 cost time: 0.3844871520996094
Epoch: 22, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.079 Vali Acc: 0.870 Test Loss: 1.079 Test Acc: 0.870
Validation loss decreased (-0.851841 --> -0.870360).  Saving model ...
Epoch: 23 cost time: 0.4153621196746826
Epoch: 23, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.023 Vali Acc: 0.885 Test Loss: 1.023 Test Acc: 0.885
Validation loss decreased (-0.870360 --> -0.885175).  Saving model ...
Epoch: 24 cost time: 0.3802065849304199
Epoch: 24, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.968 Vali Acc: 0.904 Test Loss: 0.968 Test Acc: 0.904
Validation loss decreased (-0.885175 --> -0.903694).  Saving model ...
Epoch: 25 cost time: 0.3742842674255371
Epoch: 25, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.915 Vali Acc: 0.911 Test Loss: 0.915 Test Acc: 0.911
Validation loss decreased (-0.903694 --> -0.911102).  Saving model ...
Epoch: 26 cost time: 0.39150071144104004
Epoch: 26, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.863 Vali Acc: 0.915 Test Loss: 0.863 Test Acc: 0.915
Validation loss decreased (-0.911102 --> -0.914806).  Saving model ...
Epoch: 27 cost time: 0.37386393547058105
Epoch: 27, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.813 Vali Acc: 0.930 Test Loss: 0.813 Test Acc: 0.930
Validation loss decreased (-0.914806 --> -0.929621).  Saving model ...
Epoch: 28 cost time: 0.37932872772216797
Epoch: 28, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.765 Vali Acc: 0.933 Test Loss: 0.765 Test Acc: 0.933
Validation loss decreased (-0.929621 --> -0.933326).  Saving model ...
Epoch: 29 cost time: 0.3808143138885498
Epoch: 29, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.720 Vali Acc: 0.937 Test Loss: 0.720 Test Acc: 0.937
Validation loss decreased (-0.933326 --> -0.937030).  Saving model ...
Epoch: 30 cost time: 0.3677186965942383
Epoch: 30, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.677 Vali Acc: 0.937 Test Loss: 0.677 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937030).  Saving model ...
Epoch: 31 cost time: 0.39667582511901855
Epoch: 31, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.637 Vali Acc: 0.937 Test Loss: 0.637 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 32 cost time: 0.38299989700317383
Epoch: 32, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.599 Vali Acc: 0.937 Test Loss: 0.599 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 33 cost time: 0.35711026191711426
Epoch: 33, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.564 Vali Acc: 0.933 Test Loss: 0.564 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4025294780731201
Epoch: 34, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.532 Vali Acc: 0.930 Test Loss: 0.532 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4307253360748291
Epoch: 35, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.502 Vali Acc: 0.930 Test Loss: 0.502 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.37482786178588867
Epoch: 36, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.475 Vali Acc: 0.930 Test Loss: 0.475 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3693227767944336
Epoch: 37, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.451 Vali Acc: 0.930 Test Loss: 0.451 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3788471221923828
Epoch: 38, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.428 Vali Acc: 0.933 Test Loss: 0.428 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.38626885414123535
Epoch: 39, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.408 Vali Acc: 0.933 Test Loss: 0.408 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.39656758308410645
Epoch: 40, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.44013023376464844
Epoch: 41, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.371 Vali Acc: 0.933 Test Loss: 0.371 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.48551273345947266
Epoch: 42, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.38158273696899414
Epoch: 43, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.385117769241333
Epoch: 44, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.328 Vali Acc: 0.937 Test Loss: 0.328 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 45 cost time: 0.47346997261047363
Epoch: 45, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 46 cost time: 0.35828089714050293
Epoch: 46, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 47 cost time: 0.3839890956878662
Epoch: 47, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 48 cost time: 0.4315457344055176
Epoch: 48, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.48313474655151367
Epoch: 49, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 50 cost time: 0.3809928894042969
Epoch: 50, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 71046
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7863669395446777
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.790 Vali Acc: 0.119 Test Loss: 1.790 Test Acc: 0.119
Validation loss decreased (inf --> -0.118501).  Saving model ...
Epoch: 2 cost time: 0.429394006729126
Epoch: 2, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.778 Vali Acc: 0.122 Test Loss: 1.778 Test Acc: 0.122
Validation loss decreased (-0.118501 --> -0.122204).  Saving model ...
Epoch: 3 cost time: 0.5266258716583252
Epoch: 3, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.768 Vali Acc: 0.133 Test Loss: 1.768 Test Acc: 0.133
Validation loss decreased (-0.122204 --> -0.133316).  Saving model ...
Epoch: 4 cost time: 0.38782167434692383
Epoch: 4, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.759 Vali Acc: 0.141 Test Loss: 1.759 Test Acc: 0.141
Validation loss decreased (-0.133316 --> -0.140723).  Saving model ...
Epoch: 5 cost time: 0.4326205253601074
Epoch: 5, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.746 Vali Acc: 0.133 Test Loss: 1.746 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.47028279304504395
Epoch: 6, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.731 Vali Acc: 0.156 Test Loss: 1.731 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155538).  Saving model ...
Epoch: 7 cost time: 0.3764841556549072
Epoch: 7, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.713 Vali Acc: 0.204 Test Loss: 1.713 Test Acc: 0.204
Validation loss decreased (-0.155538 --> -0.203687).  Saving model ...
Epoch: 8 cost time: 0.3708643913269043
Epoch: 8, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.692 Vali Acc: 0.274 Test Loss: 1.692 Test Acc: 0.274
Validation loss decreased (-0.203687 --> -0.274057).  Saving model ...
Epoch: 9 cost time: 0.41581153869628906
Epoch: 9, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.668 Vali Acc: 0.326 Test Loss: 1.668 Test Acc: 0.326
Validation loss decreased (-0.274057 --> -0.325909).  Saving model ...
Epoch: 10 cost time: 0.4394261837005615
Epoch: 10, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.642 Vali Acc: 0.400 Test Loss: 1.642 Test Acc: 0.400
Validation loss decreased (-0.325909 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.37226152420043945
Epoch: 11, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.614 Vali Acc: 0.459 Test Loss: 1.614 Test Acc: 0.459
Validation loss decreased (-0.399984 --> -0.459243).  Saving model ...
Epoch: 12 cost time: 0.36385536193847656
Epoch: 12, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.584 Vali Acc: 0.526 Test Loss: 1.584 Test Acc: 0.526
Validation loss decreased (-0.459243 --> -0.525910).  Saving model ...
Epoch: 13 cost time: 0.39336156845092773
Epoch: 13, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.551 Vali Acc: 0.578 Test Loss: 1.551 Test Acc: 0.578
Validation loss decreased (-0.525910 --> -0.577762).  Saving model ...
Epoch: 14 cost time: 0.42763352394104004
Epoch: 14, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.515 Vali Acc: 0.626 Test Loss: 1.515 Test Acc: 0.626
Validation loss decreased (-0.577762 --> -0.625911).  Saving model ...
Epoch: 15 cost time: 0.45275044441223145
Epoch: 15, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.478 Vali Acc: 0.670 Test Loss: 1.478 Test Acc: 0.670
Validation loss decreased (-0.625911 --> -0.670356).  Saving model ...
Epoch: 16 cost time: 0.3967916965484619
Epoch: 16, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.440 Vali Acc: 0.704 Test Loss: 1.440 Test Acc: 0.704
Validation loss decreased (-0.670356 --> -0.703689).  Saving model ...
Epoch: 17 cost time: 0.3891282081604004
Epoch: 17, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.400 Vali Acc: 0.752 Test Loss: 1.400 Test Acc: 0.752
Validation loss decreased (-0.703689 --> -0.751838).  Saving model ...
Epoch: 18 cost time: 0.4482302665710449
Epoch: 18, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.358 Vali Acc: 0.774 Test Loss: 1.358 Test Acc: 0.774
Validation loss decreased (-0.751838 --> -0.774060).  Saving model ...
Epoch: 19 cost time: 0.3959834575653076
Epoch: 19, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.315 Vali Acc: 0.804 Test Loss: 1.315 Test Acc: 0.804
Validation loss decreased (-0.774060 --> -0.803691).  Saving model ...
Epoch: 20 cost time: 0.411665678024292
Epoch: 20, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.271 Vali Acc: 0.811 Test Loss: 1.271 Test Acc: 0.811
Validation loss decreased (-0.803691 --> -0.811098).  Saving model ...
Epoch: 21 cost time: 0.445056676864624
Epoch: 21, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.227 Vali Acc: 0.830 Test Loss: 1.227 Test Acc: 0.830
Validation loss decreased (-0.811098 --> -0.829617).  Saving model ...
Epoch: 22 cost time: 0.3891897201538086
Epoch: 22, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.181 Vali Acc: 0.841 Test Loss: 1.181 Test Acc: 0.841
Validation loss decreased (-0.829617 --> -0.840729).  Saving model ...
Epoch: 23 cost time: 0.3835110664367676
Epoch: 23, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.135 Vali Acc: 0.856 Test Loss: 1.135 Test Acc: 0.856
Validation loss decreased (-0.840729 --> -0.855544).  Saving model ...
Epoch: 24 cost time: 0.47800207138061523
Epoch: 24, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.087 Vali Acc: 0.859 Test Loss: 1.087 Test Acc: 0.859
Validation loss decreased (-0.855544 --> -0.859248).  Saving model ...
Epoch: 25 cost time: 0.38558173179626465
Epoch: 25, Steps: 2 | Train Loss: 0.900 Vali Loss: 1.041 Vali Acc: 0.867 Test Loss: 1.041 Test Acc: 0.867
Validation loss decreased (-0.859248 --> -0.866656).  Saving model ...
Epoch: 26 cost time: 0.500929594039917
Epoch: 26, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.994 Vali Acc: 0.870 Test Loss: 0.994 Test Acc: 0.870
Validation loss decreased (-0.866656 --> -0.870360).  Saving model ...
Epoch: 27 cost time: 0.45784735679626465
Epoch: 27, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.948 Vali Acc: 0.878 Test Loss: 0.948 Test Acc: 0.878
Validation loss decreased (-0.870360 --> -0.877768).  Saving model ...
Epoch: 28 cost time: 0.3840339183807373
Epoch: 28, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.903 Vali Acc: 0.889 Test Loss: 0.903 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888880).  Saving model ...
Epoch: 29 cost time: 0.3953993320465088
Epoch: 29, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.859 Vali Acc: 0.893 Test Loss: 0.859 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 30 cost time: 0.4235200881958008
Epoch: 30, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.816 Vali Acc: 0.896 Test Loss: 0.816 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896288).  Saving model ...
Epoch: 31 cost time: 0.4345986843109131
Epoch: 31, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.774 Vali Acc: 0.907 Test Loss: 0.774 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 32 cost time: 0.36759161949157715
Epoch: 32, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.735 Vali Acc: 0.907 Test Loss: 0.735 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 33 cost time: 0.4054758548736572
Epoch: 33, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.697 Vali Acc: 0.915 Test Loss: 0.697 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 34 cost time: 0.5557186603546143
Epoch: 34, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.661 Vali Acc: 0.919 Test Loss: 0.661 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 35 cost time: 0.37949156761169434
Epoch: 35, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.627 Vali Acc: 0.926 Test Loss: 0.627 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 36 cost time: 0.40846872329711914
Epoch: 36, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.595 Vali Acc: 0.926 Test Loss: 0.595 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 37 cost time: 0.3815793991088867
Epoch: 37, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.565 Vali Acc: 0.926 Test Loss: 0.565 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 38 cost time: 0.3724935054779053
Epoch: 38, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.537 Vali Acc: 0.930 Test Loss: 0.537 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 39 cost time: 0.3685488700866699
Epoch: 39, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.512 Vali Acc: 0.930 Test Loss: 0.512 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 40 cost time: 0.42850613594055176
Epoch: 40, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.487 Vali Acc: 0.930 Test Loss: 0.487 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 41 cost time: 0.3862931728363037
Epoch: 41, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.465 Vali Acc: 0.933 Test Loss: 0.465 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 42 cost time: 0.4618358612060547
Epoch: 42, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.445 Vali Acc: 0.941 Test Loss: 0.445 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940736).  Saving model ...
Epoch: 43 cost time: 0.365924596786499
Epoch: 43, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.426 Vali Acc: 0.941 Test Loss: 0.426 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 44 cost time: 0.3775956630706787
Epoch: 44, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.408 Vali Acc: 0.944 Test Loss: 0.408 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 45 cost time: 0.37010884284973145
Epoch: 45, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.392 Vali Acc: 0.944 Test Loss: 0.392 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.44759631156921387
Epoch: 46, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.377 Vali Acc: 0.944 Test Loss: 0.377 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 47 cost time: 0.3743770122528076
Epoch: 47, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.363 Vali Acc: 0.948 Test Loss: 0.363 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.48862385749816895
Epoch: 48, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 49 cost time: 0.3647780418395996
Epoch: 49, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.339 Vali Acc: 0.948 Test Loss: 0.339 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 50 cost time: 0.36159729957580566
Epoch: 50, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.328 Vali Acc: 0.948 Test Loss: 0.328 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 69606
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.511960506439209
Epoch: 1, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.804 Vali Acc: 0.107 Test Loss: 1.804 Test Acc: 0.107
Validation loss decreased (inf --> -0.107389).  Saving model ...
Epoch: 2 cost time: 0.37171173095703125
Epoch: 2, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.796 Vali Acc: 0.133 Test Loss: 1.796 Test Acc: 0.133
Validation loss decreased (-0.107389 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.40802502632141113
Epoch: 3, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.789 Vali Acc: 0.174 Test Loss: 1.789 Test Acc: 0.174
Validation loss decreased (-0.133315 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 0.3871190547943115
Epoch: 4, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.782 Vali Acc: 0.204 Test Loss: 1.782 Test Acc: 0.204
Validation loss decreased (-0.174056 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.35489821434020996
Epoch: 5, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.773 Vali Acc: 0.252 Test Loss: 1.773 Test Acc: 0.252
Validation loss decreased (-0.203686 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 0.34248805046081543
Epoch: 6, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.761 Vali Acc: 0.285 Test Loss: 1.761 Test Acc: 0.285
Validation loss decreased (-0.251834 --> -0.285168).  Saving model ...
Epoch: 7 cost time: 0.34468913078308105
Epoch: 7, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.747 Vali Acc: 0.326 Test Loss: 1.747 Test Acc: 0.326
Validation loss decreased (-0.285168 --> -0.325908).  Saving model ...
Epoch: 8 cost time: 0.3577909469604492
Epoch: 8, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.731 Vali Acc: 0.396 Test Loss: 1.731 Test Acc: 0.396
Validation loss decreased (-0.325908 --> -0.396279).  Saving model ...
Epoch: 9 cost time: 0.3748960494995117
Epoch: 9, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.713 Vali Acc: 0.448 Test Loss: 1.713 Test Acc: 0.448
Validation loss decreased (-0.396279 --> -0.448131).  Saving model ...
Epoch: 10 cost time: 0.3779919147491455
Epoch: 10, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.692 Vali Acc: 0.496 Test Loss: 1.692 Test Acc: 0.496
Validation loss decreased (-0.448131 --> -0.496279).  Saving model ...
Epoch: 11 cost time: 0.38118934631347656
Epoch: 11, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.671 Vali Acc: 0.530 Test Loss: 1.671 Test Acc: 0.530
Validation loss decreased (-0.496279 --> -0.529613).  Saving model ...
Epoch: 12 cost time: 0.366379976272583
Epoch: 12, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.647 Vali Acc: 0.548 Test Loss: 1.647 Test Acc: 0.548
Validation loss decreased (-0.529613 --> -0.548132).  Saving model ...
Epoch: 13 cost time: 0.4038276672363281
Epoch: 13, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.621 Vali Acc: 0.567 Test Loss: 1.621 Test Acc: 0.567
Validation loss decreased (-0.548132 --> -0.566650).  Saving model ...
Epoch: 14 cost time: 0.40001583099365234
Epoch: 14, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.594 Vali Acc: 0.596 Test Loss: 1.594 Test Acc: 0.596
Validation loss decreased (-0.566650 --> -0.596280).  Saving model ...
Epoch: 15 cost time: 0.37334585189819336
Epoch: 15, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.565 Vali Acc: 0.633 Test Loss: 1.565 Test Acc: 0.633
Validation loss decreased (-0.596280 --> -0.633318).  Saving model ...
Epoch: 16 cost time: 0.3833341598510742
Epoch: 16, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.535 Vali Acc: 0.644 Test Loss: 1.535 Test Acc: 0.644
Validation loss decreased (-0.633318 --> -0.644429).  Saving model ...
Epoch: 17 cost time: 0.3837003707885742
Epoch: 17, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.504 Vali Acc: 0.678 Test Loss: 1.504 Test Acc: 0.678
Validation loss decreased (-0.644429 --> -0.677763).  Saving model ...
Epoch: 18 cost time: 0.3915996551513672
Epoch: 18, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.472 Vali Acc: 0.707 Test Loss: 1.472 Test Acc: 0.707
Validation loss decreased (-0.677763 --> -0.707393).  Saving model ...
Epoch: 19 cost time: 0.39853787422180176
Epoch: 19, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.438 Vali Acc: 0.711 Test Loss: 1.438 Test Acc: 0.711
Validation loss decreased (-0.707393 --> -0.711097).  Saving model ...
Epoch: 20 cost time: 0.4716165065765381
Epoch: 20, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.404 Vali Acc: 0.756 Test Loss: 1.404 Test Acc: 0.756
Validation loss decreased (-0.711097 --> -0.755542).  Saving model ...
Epoch: 21 cost time: 0.37724876403808594
Epoch: 21, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.369 Vali Acc: 0.793 Test Loss: 1.369 Test Acc: 0.793
Validation loss decreased (-0.755542 --> -0.792579).  Saving model ...
Epoch: 22 cost time: 0.374192476272583
Epoch: 22, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.333 Vali Acc: 0.819 Test Loss: 1.333 Test Acc: 0.819
Validation loss decreased (-0.792579 --> -0.818505).  Saving model ...
Epoch: 23 cost time: 0.389650821685791
Epoch: 23, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.297 Vali Acc: 0.830 Test Loss: 1.297 Test Acc: 0.830
Validation loss decreased (-0.818505 --> -0.829617).  Saving model ...
Epoch: 24 cost time: 0.4384148120880127
Epoch: 24, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.260 Vali Acc: 0.837 Test Loss: 1.260 Test Acc: 0.837
Validation loss decreased (-0.829617 --> -0.837024).  Saving model ...
Epoch: 25 cost time: 0.43932604789733887
Epoch: 25, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.222 Vali Acc: 0.856 Test Loss: 1.222 Test Acc: 0.856
Validation loss decreased (-0.837024 --> -0.855543).  Saving model ...
Epoch: 26 cost time: 0.412827730178833
Epoch: 26, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.184 Vali Acc: 0.859 Test Loss: 1.184 Test Acc: 0.859
Validation loss decreased (-0.855543 --> -0.859247).  Saving model ...
Epoch: 27 cost time: 0.47852063179016113
Epoch: 27, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.145 Vali Acc: 0.870 Test Loss: 1.145 Test Acc: 0.870
Validation loss decreased (-0.859247 --> -0.870359).  Saving model ...
Epoch: 28 cost time: 0.38759279251098633
Epoch: 28, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.107 Vali Acc: 0.885 Test Loss: 1.107 Test Acc: 0.885
Validation loss decreased (-0.870359 --> -0.885174).  Saving model ...
Epoch: 29 cost time: 0.4062011241912842
Epoch: 29, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.068 Vali Acc: 0.896 Test Loss: 1.068 Test Acc: 0.896
Validation loss decreased (-0.885174 --> -0.896286).  Saving model ...
Epoch: 30 cost time: 0.3673708438873291
Epoch: 30, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.029 Vali Acc: 0.907 Test Loss: 1.029 Test Acc: 0.907
Validation loss decreased (-0.896286 --> -0.907397).  Saving model ...
Epoch: 31 cost time: 0.4460127353668213
Epoch: 31, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.990 Vali Acc: 0.911 Test Loss: 0.990 Test Acc: 0.911
Validation loss decreased (-0.907397 --> -0.911101).  Saving model ...
Epoch: 32 cost time: 0.35298728942871094
Epoch: 32, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.952 Vali Acc: 0.915 Test Loss: 0.952 Test Acc: 0.915
Validation loss decreased (-0.911101 --> -0.914805).  Saving model ...
Epoch: 33 cost time: 0.37036585807800293
Epoch: 33, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.915 Vali Acc: 0.919 Test Loss: 0.915 Test Acc: 0.919
Validation loss decreased (-0.914805 --> -0.918509).  Saving model ...
Epoch: 34 cost time: 0.3663668632507324
Epoch: 34, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.878 Vali Acc: 0.922 Test Loss: 0.878 Test Acc: 0.922
Validation loss decreased (-0.918509 --> -0.922213).  Saving model ...
Epoch: 35 cost time: 0.45827698707580566
Epoch: 35, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.842 Vali Acc: 0.922 Test Loss: 0.842 Test Acc: 0.922
Validation loss decreased (-0.922213 --> -0.922214).  Saving model ...
Epoch: 36 cost time: 0.36192989349365234
Epoch: 36, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.807 Vali Acc: 0.922 Test Loss: 0.807 Test Acc: 0.922
Validation loss decreased (-0.922214 --> -0.922214).  Saving model ...
Epoch: 37 cost time: 0.427978515625
Epoch: 37, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.774 Vali Acc: 0.922 Test Loss: 0.774 Test Acc: 0.922
Validation loss decreased (-0.922214 --> -0.922214).  Saving model ...
Epoch: 38 cost time: 0.3829472064971924
Epoch: 38, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.741 Vali Acc: 0.926 Test Loss: 0.741 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925919).  Saving model ...
Epoch: 39 cost time: 0.38750338554382324
Epoch: 39, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.710 Vali Acc: 0.933 Test Loss: 0.710 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933326).  Saving model ...
Epoch: 40 cost time: 0.41456127166748047
Epoch: 40, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.680 Vali Acc: 0.926 Test Loss: 0.680 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4196178913116455
Epoch: 41, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.652 Vali Acc: 0.926 Test Loss: 0.652 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.3985118865966797
Epoch: 42, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.625 Vali Acc: 0.926 Test Loss: 0.625 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.39623117446899414
Epoch: 43, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.599 Vali Acc: 0.930 Test Loss: 0.599 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.40737128257751465
Epoch: 44, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.575 Vali Acc: 0.930 Test Loss: 0.575 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.37984275817871094
Epoch: 45, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.552 Vali Acc: 0.937 Test Loss: 0.552 Test Acc: 0.937
Validation loss decreased (-0.933326 --> -0.937032).  Saving model ...
Epoch: 46 cost time: 0.379565954208374
Epoch: 46, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.530 Vali Acc: 0.937 Test Loss: 0.530 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 47 cost time: 0.4344208240509033
Epoch: 47, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.510 Vali Acc: 0.937 Test Loss: 0.510 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 48 cost time: 0.3887033462524414
Epoch: 48, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.491 Vali Acc: 0.941 Test Loss: 0.491 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 49 cost time: 0.43640899658203125
Epoch: 49, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 50 cost time: 0.36330342292785645
Epoch: 50, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.456 Vali Acc: 0.944 Test Loss: 0.456 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 66630
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5010921955108643
Epoch: 1, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.802 Vali Acc: 0.115 Test Loss: 1.802 Test Acc: 0.115
Validation loss decreased (inf --> -0.114797).  Saving model ...
Epoch: 2 cost time: 0.3755321502685547
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.794 Vali Acc: 0.133 Test Loss: 1.794 Test Acc: 0.133
Validation loss decreased (-0.114797 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.48379039764404297
Epoch: 3, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.788 Vali Acc: 0.148 Test Loss: 1.788 Test Acc: 0.148
Validation loss decreased (-0.133315 --> -0.148130).  Saving model ...
Epoch: 4 cost time: 0.3668968677520752
Epoch: 4, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.783 Vali Acc: 0.163 Test Loss: 1.783 Test Acc: 0.163
Validation loss decreased (-0.148130 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.3888885974884033
Epoch: 5, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.775 Vali Acc: 0.174 Test Loss: 1.775 Test Acc: 0.174
Validation loss decreased (-0.162945 --> -0.174056).  Saving model ...
Epoch: 6 cost time: 0.42833566665649414
Epoch: 6, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.765 Vali Acc: 0.185 Test Loss: 1.765 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.42215585708618164
Epoch: 7, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.753 Vali Acc: 0.241 Test Loss: 1.753 Test Acc: 0.241
Validation loss decreased (-0.185168 --> -0.240723).  Saving model ...
Epoch: 8 cost time: 0.3581199645996094
Epoch: 8, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.738 Vali Acc: 0.281 Test Loss: 1.738 Test Acc: 0.281
Validation loss decreased (-0.240723 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 0.37460994720458984
Epoch: 9, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.722 Vali Acc: 0.311 Test Loss: 1.722 Test Acc: 0.311
Validation loss decreased (-0.281464 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.3620798587799072
Epoch: 10, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.704 Vali Acc: 0.378 Test Loss: 1.704 Test Acc: 0.378
Validation loss decreased (-0.311094 --> -0.377761).  Saving model ...
Epoch: 11 cost time: 0.473879337310791
Epoch: 11, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.684 Vali Acc: 0.411 Test Loss: 1.684 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411094).  Saving model ...
Epoch: 12 cost time: 0.3793182373046875
Epoch: 12, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.662 Vali Acc: 0.456 Test Loss: 1.662 Test Acc: 0.456
Validation loss decreased (-0.411094 --> -0.455539).  Saving model ...
Epoch: 13 cost time: 0.41043853759765625
Epoch: 13, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.638 Vali Acc: 0.511 Test Loss: 1.638 Test Acc: 0.511
Validation loss decreased (-0.455539 --> -0.511095).  Saving model ...
Epoch: 14 cost time: 0.38610124588012695
Epoch: 14, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.613 Vali Acc: 0.530 Test Loss: 1.613 Test Acc: 0.530
Validation loss decreased (-0.511095 --> -0.529613).  Saving model ...
Epoch: 15 cost time: 0.3525705337524414
Epoch: 15, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.587 Vali Acc: 0.567 Test Loss: 1.587 Test Acc: 0.567
Validation loss decreased (-0.529613 --> -0.566651).  Saving model ...
Epoch: 16 cost time: 0.3768434524536133
Epoch: 16, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.559 Vali Acc: 0.626 Test Loss: 1.559 Test Acc: 0.626
Validation loss decreased (-0.566651 --> -0.625910).  Saving model ...
Epoch: 17 cost time: 0.370302677154541
Epoch: 17, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.530 Vali Acc: 0.659 Test Loss: 1.530 Test Acc: 0.659
Validation loss decreased (-0.625910 --> -0.659244).  Saving model ...
Epoch: 18 cost time: 0.3850128650665283
Epoch: 18, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.500 Vali Acc: 0.704 Test Loss: 1.500 Test Acc: 0.704
Validation loss decreased (-0.659244 --> -0.703689).  Saving model ...
Epoch: 19 cost time: 0.35299205780029297
Epoch: 19, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.470 Vali Acc: 0.741 Test Loss: 1.470 Test Acc: 0.741
Validation loss decreased (-0.703689 --> -0.740726).  Saving model ...
Epoch: 20 cost time: 0.38857221603393555
Epoch: 20, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.438 Vali Acc: 0.763 Test Loss: 1.438 Test Acc: 0.763
Validation loss decreased (-0.740726 --> -0.762949).  Saving model ...
Epoch: 21 cost time: 0.38184213638305664
Epoch: 21, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.406 Vali Acc: 0.778 Test Loss: 1.406 Test Acc: 0.778
Validation loss decreased (-0.762949 --> -0.777764).  Saving model ...
Epoch: 22 cost time: 0.412503719329834
Epoch: 22, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.372 Vali Acc: 0.800 Test Loss: 1.372 Test Acc: 0.800
Validation loss decreased (-0.777764 --> -0.799986).  Saving model ...
Epoch: 23 cost time: 0.37529826164245605
Epoch: 23, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.339 Vali Acc: 0.811 Test Loss: 1.339 Test Acc: 0.811
Validation loss decreased (-0.799986 --> -0.811098).  Saving model ...
Epoch: 24 cost time: 0.3835272789001465
Epoch: 24, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.304 Vali Acc: 0.815 Test Loss: 1.304 Test Acc: 0.815
Validation loss decreased (-0.811098 --> -0.814802).  Saving model ...
Epoch: 25 cost time: 0.3567163944244385
Epoch: 25, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.269 Vali Acc: 0.826 Test Loss: 1.269 Test Acc: 0.826
Validation loss decreased (-0.814802 --> -0.825913).  Saving model ...
Epoch: 26 cost time: 0.504525899887085
Epoch: 26, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.234 Vali Acc: 0.841 Test Loss: 1.234 Test Acc: 0.841
Validation loss decreased (-0.825913 --> -0.840728).  Saving model ...
Epoch: 27 cost time: 0.37422680854797363
Epoch: 27, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.199 Vali Acc: 0.833 Test Loss: 1.199 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.34295177459716797
Epoch: 28, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.164 Vali Acc: 0.841 Test Loss: 1.164 Test Acc: 0.841
Validation loss decreased (-0.840728 --> -0.840729).  Saving model ...
Epoch: 29 cost time: 0.40990734100341797
Epoch: 29, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.129 Vali Acc: 0.848 Test Loss: 1.129 Test Acc: 0.848
Validation loss decreased (-0.840729 --> -0.848137).  Saving model ...
Epoch: 30 cost time: 0.39520764350891113
Epoch: 30, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.093 Vali Acc: 0.859 Test Loss: 1.093 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859248).  Saving model ...
Epoch: 31 cost time: 0.4056565761566162
Epoch: 31, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.058 Vali Acc: 0.863 Test Loss: 1.058 Test Acc: 0.863
Validation loss decreased (-0.859248 --> -0.862952).  Saving model ...
Epoch: 32 cost time: 0.35027623176574707
Epoch: 32, Steps: 2 | Train Loss: 0.874 Vali Loss: 1.023 Vali Acc: 0.867 Test Loss: 1.023 Test Acc: 0.867
Validation loss decreased (-0.862952 --> -0.866656).  Saving model ...
Epoch: 33 cost time: 0.40233373641967773
Epoch: 33, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.987 Vali Acc: 0.874 Test Loss: 0.987 Test Acc: 0.874
Validation loss decreased (-0.866656 --> -0.874064).  Saving model ...
Epoch: 34 cost time: 0.4261484146118164
Epoch: 34, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.953 Vali Acc: 0.878 Test Loss: 0.953 Test Acc: 0.878
Validation loss decreased (-0.874064 --> -0.877768).  Saving model ...
Epoch: 35 cost time: 0.37883758544921875
Epoch: 35, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.919 Vali Acc: 0.889 Test Loss: 0.919 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888880).  Saving model ...
Epoch: 36 cost time: 0.5169675350189209
Epoch: 36, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.885 Vali Acc: 0.893 Test Loss: 0.885 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 37 cost time: 0.35008859634399414
Epoch: 37, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.852 Vali Acc: 0.893 Test Loss: 0.852 Test Acc: 0.893
Validation loss decreased (-0.892584 --> -0.892584).  Saving model ...
Epoch: 38 cost time: 0.3873147964477539
Epoch: 38, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.820 Vali Acc: 0.896 Test Loss: 0.820 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896288).  Saving model ...
Epoch: 39 cost time: 0.3921234607696533
Epoch: 39, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.789 Vali Acc: 0.904 Test Loss: 0.789 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903696).  Saving model ...
Epoch: 40 cost time: 0.36359739303588867
Epoch: 40, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.759 Vali Acc: 0.904 Test Loss: 0.759 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 41 cost time: 0.433422327041626
Epoch: 41, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.730 Vali Acc: 0.915 Test Loss: 0.730 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 42 cost time: 0.41908860206604004
Epoch: 42, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.701 Vali Acc: 0.915 Test Loss: 0.701 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 43 cost time: 0.39026331901550293
Epoch: 43, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.675 Vali Acc: 0.915 Test Loss: 0.675 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 44 cost time: 0.43270349502563477
Epoch: 44, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.649 Vali Acc: 0.922 Test Loss: 0.649 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 45 cost time: 0.3703598976135254
Epoch: 45, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.624 Vali Acc: 0.922 Test Loss: 0.624 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 46 cost time: 0.4002799987792969
Epoch: 46, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.600 Vali Acc: 0.926 Test Loss: 0.600 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 47 cost time: 0.3675415515899658
Epoch: 47, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.578 Vali Acc: 0.926 Test Loss: 0.578 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 48 cost time: 0.4026923179626465
Epoch: 48, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.557 Vali Acc: 0.933 Test Loss: 0.557 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 49 cost time: 0.40627026557922363
Epoch: 49, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.537 Vali Acc: 0.933 Test Loss: 0.537 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 50 cost time: 0.3951404094696045
Epoch: 50, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.519 Vali Acc: 0.933 Test Loss: 0.519 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 65222
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6865239143371582
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.761 Vali Acc: 0.256 Test Loss: 1.761 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.42833948135375977
Epoch: 2, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.703 Vali Acc: 0.326 Test Loss: 1.703 Test Acc: 0.326
Validation loss decreased (-0.255538 --> -0.325909).  Saving model ...
Epoch: 3 cost time: 0.41914892196655273
Epoch: 3, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.619 Vali Acc: 0.626 Test Loss: 1.619 Test Acc: 0.626
Validation loss decreased (-0.325909 --> -0.625910).  Saving model ...
Epoch: 4 cost time: 0.46584534645080566
Epoch: 4, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.471 Vali Acc: 0.822 Test Loss: 1.471 Test Acc: 0.822
Validation loss decreased (-0.625910 --> -0.822208).  Saving model ...
Epoch: 5 cost time: 0.4861307144165039
Epoch: 5, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.288 Vali Acc: 0.870 Test Loss: 1.288 Test Acc: 0.870
Validation loss decreased (-0.822208 --> -0.870357).  Saving model ...
Epoch: 6 cost time: 0.4678688049316406
Epoch: 6, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.092 Vali Acc: 0.896 Test Loss: 1.092 Test Acc: 0.896
Validation loss decreased (-0.870357 --> -0.896285).  Saving model ...
Epoch: 7 cost time: 0.4839291572570801
Epoch: 7, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.896 Vali Acc: 0.926 Test Loss: 0.896 Test Acc: 0.926
Validation loss decreased (-0.896285 --> -0.925917).  Saving model ...
Epoch: 8 cost time: 0.4261012077331543
Epoch: 8, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.717 Vali Acc: 0.937 Test Loss: 0.717 Test Acc: 0.937
Validation loss decreased (-0.925917 --> -0.937030).  Saving model ...
Epoch: 9 cost time: 0.5040302276611328
Epoch: 9, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.565 Vali Acc: 0.944 Test Loss: 0.565 Test Acc: 0.944
Validation loss decreased (-0.937030 --> -0.944439).  Saving model ...
Epoch: 10 cost time: 0.43107008934020996
Epoch: 10, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.442 Vali Acc: 0.944 Test Loss: 0.442 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 11 cost time: 0.41138172149658203
Epoch: 11, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 12 cost time: 0.42780232429504395
Epoch: 12, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.274 Vali Acc: 0.952 Test Loss: 0.274 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951849).  Saving model ...
Epoch: 13 cost time: 0.4476144313812256
Epoch: 13, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.959 Test Loss: 0.228 Test Acc: 0.959
Validation loss decreased (-0.951849 --> -0.959257).  Saving model ...
Epoch: 14 cost time: 0.4771394729614258
Epoch: 14, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 15 cost time: 0.4816110134124756
Epoch: 15, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.441819429397583
Epoch: 16, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.558478832244873
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4419691562652588
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4110293388366699
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4566078186035156
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3953721523284912
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.42743635177612305
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4920985698699951
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4559297561645508
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 971654
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7348663806915283
Epoch: 1, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.743 Vali Acc: 0.163 Test Loss: 1.743 Test Acc: 0.163
Validation loss decreased (inf --> -0.162946).  Saving model ...
Epoch: 2 cost time: 0.47958898544311523
Epoch: 2, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.700 Vali Acc: 0.348 Test Loss: 1.700 Test Acc: 0.348
Validation loss decreased (-0.162946 --> -0.348131).  Saving model ...
Epoch: 3 cost time: 0.43813228607177734
Epoch: 3, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.648 Vali Acc: 0.541 Test Loss: 1.648 Test Acc: 0.541
Validation loss decreased (-0.348131 --> -0.540724).  Saving model ...
Epoch: 4 cost time: 0.4717235565185547
Epoch: 4, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.561 Vali Acc: 0.763 Test Loss: 1.561 Test Acc: 0.763
Validation loss decreased (-0.540724 --> -0.762947).  Saving model ...
Epoch: 5 cost time: 0.423337459564209
Epoch: 5, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.449 Vali Acc: 0.852 Test Loss: 1.449 Test Acc: 0.852
Validation loss decreased (-0.762947 --> -0.851837).  Saving model ...
Epoch: 6 cost time: 0.4773256778717041
Epoch: 6, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.315 Vali Acc: 0.878 Test Loss: 1.315 Test Acc: 0.878
Validation loss decreased (-0.851837 --> -0.877765).  Saving model ...
Epoch: 7 cost time: 0.49233365058898926
Epoch: 7, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.169 Vali Acc: 0.870 Test Loss: 1.169 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4157881736755371
Epoch: 8, Steps: 2 | Train Loss: 0.807 Vali Loss: 1.018 Vali Acc: 0.893 Test Loss: 1.018 Test Acc: 0.893
Validation loss decreased (-0.877765 --> -0.892582).  Saving model ...
Epoch: 9 cost time: 0.43743109703063965
Epoch: 9, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.868 Vali Acc: 0.911 Test Loss: 0.868 Test Acc: 0.911
Validation loss decreased (-0.892582 --> -0.911102).  Saving model ...
Epoch: 10 cost time: 0.4778938293457031
Epoch: 10, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.727 Vali Acc: 0.907 Test Loss: 0.727 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4981825351715088
Epoch: 11, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.602 Vali Acc: 0.926 Test Loss: 0.602 Test Acc: 0.926
Validation loss decreased (-0.911102 --> -0.925920).  Saving model ...
Epoch: 12 cost time: 0.49413371086120605
Epoch: 12, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.492 Vali Acc: 0.933 Test Loss: 0.492 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 13 cost time: 0.4509899616241455
Epoch: 13, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.404 Vali Acc: 0.933 Test Loss: 0.404 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 14 cost time: 0.43685173988342285
Epoch: 14, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.337 Vali Acc: 0.933 Test Loss: 0.337 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 0.43697071075439453
Epoch: 15, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.48387861251831055
Epoch: 16, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.5006551742553711
Epoch: 17, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.4501376152038574
Epoch: 18, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.45125341415405273
Epoch: 19, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.4876062870025635
Epoch: 20, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.4454634189605713
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.45331430435180664
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.4551882743835449
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.4563558101654053
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.4318265914916992
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.4219546318054199
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.4799513816833496
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.4850919246673584
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.492936372756958
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.4774923324584961
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.4641087055206299
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.4803793430328369
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.4643721580505371
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.45232462882995605
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.4537198543548584
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4927349090576172
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5022523403167725
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.47763729095458984
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.43626856803894043
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.44771337509155273
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4663710594177246
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4314730167388916
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4831719398498535
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4802265167236328
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 867462
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7980988025665283
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.758 Vali Acc: 0.248 Test Loss: 1.758 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 0.5920660495758057
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.728 Vali Acc: 0.281 Test Loss: 1.728 Test Acc: 0.281
Validation loss decreased (-0.248131 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.45609402656555176
Epoch: 3, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.690 Vali Acc: 0.341 Test Loss: 1.690 Test Acc: 0.341
Validation loss decreased (-0.281464 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.6203129291534424
Epoch: 4, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.629 Vali Acc: 0.463 Test Loss: 1.629 Test Acc: 0.463
Validation loss decreased (-0.340724 --> -0.462947).  Saving model ...
Epoch: 5 cost time: 0.4778451919555664
Epoch: 5, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.549 Vali Acc: 0.622 Test Loss: 1.549 Test Acc: 0.622
Validation loss decreased (-0.462947 --> -0.622207).  Saving model ...
Epoch: 6 cost time: 0.49857020378112793
Epoch: 6, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.452 Vali Acc: 0.744 Test Loss: 1.452 Test Acc: 0.744
Validation loss decreased (-0.622207 --> -0.744430).  Saving model ...
Epoch: 7 cost time: 0.5428485870361328
Epoch: 7, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.342 Vali Acc: 0.811 Test Loss: 1.342 Test Acc: 0.811
Validation loss decreased (-0.744430 --> -0.811098).  Saving model ...
Epoch: 8 cost time: 0.5314996242523193
Epoch: 8, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.222 Vali Acc: 0.856 Test Loss: 1.222 Test Acc: 0.856
Validation loss decreased (-0.811098 --> -0.855543).  Saving model ...
Epoch: 9 cost time: 0.48308467864990234
Epoch: 9, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.097 Vali Acc: 0.904 Test Loss: 1.097 Test Acc: 0.904
Validation loss decreased (-0.855543 --> -0.903693).  Saving model ...
Epoch: 10 cost time: 0.47628140449523926
Epoch: 10, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.971 Vali Acc: 0.915 Test Loss: 0.971 Test Acc: 0.915
Validation loss decreased (-0.903693 --> -0.914805).  Saving model ...
Epoch: 11 cost time: 0.5976157188415527
Epoch: 11, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.846 Vali Acc: 0.930 Test Loss: 0.846 Test Acc: 0.930
Validation loss decreased (-0.914805 --> -0.929621).  Saving model ...
Epoch: 12 cost time: 0.49867868423461914
Epoch: 12, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.729 Vali Acc: 0.941 Test Loss: 0.729 Test Acc: 0.941
Validation loss decreased (-0.929621 --> -0.940733).  Saving model ...
Epoch: 13 cost time: 0.51381516456604
Epoch: 13, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.622 Vali Acc: 0.952 Test Loss: 0.622 Test Acc: 0.952
Validation loss decreased (-0.940733 --> -0.951846).  Saving model ...
Epoch: 14 cost time: 0.45201921463012695
Epoch: 14, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.529 Vali Acc: 0.944 Test Loss: 0.529 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5031814575195312
Epoch: 15, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.452 Vali Acc: 0.937 Test Loss: 0.452 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5071399211883545
Epoch: 16, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.389 Vali Acc: 0.937 Test Loss: 0.389 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.48412036895751953
Epoch: 17, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.339 Vali Acc: 0.937 Test Loss: 0.339 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5025207996368408
Epoch: 18, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5049850940704346
Epoch: 19, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5310080051422119
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.47493672370910645
Epoch: 21, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.5254719257354736
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.49007201194763184
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.550471305847168
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 0.4877798557281494
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 0.48775410652160645
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.4754204750061035
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.5041954517364502
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.48545193672180176
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.46897363662719727
Epoch: 30, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.5217201709747314
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.5044527053833008
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.4751300811767578
Epoch: 33, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.48583054542541504
Epoch: 34, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4886820316314697
Epoch: 35, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4803347587585449
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4845895767211914
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5179793834686279
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5327200889587402
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4586007595062256
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.48830723762512207
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5632917881011963
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4938955307006836
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 836870
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7799897193908691
Epoch: 1, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.763 Vali Acc: 0.315 Test Loss: 1.763 Test Acc: 0.315
Validation loss decreased (inf --> -0.314797).  Saving model ...
Epoch: 2 cost time: 0.4459505081176758
Epoch: 2, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.740 Vali Acc: 0.333 Test Loss: 1.740 Test Acc: 0.333
Validation loss decreased (-0.314797 --> -0.333316).  Saving model ...
Epoch: 3 cost time: 0.5147178173065186
Epoch: 3, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.711 Vali Acc: 0.437 Test Loss: 1.711 Test Acc: 0.437
Validation loss decreased (-0.333316 --> -0.437020).  Saving model ...
Epoch: 4 cost time: 0.44440674781799316
Epoch: 4, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.665 Vali Acc: 0.552 Test Loss: 1.665 Test Acc: 0.552
Validation loss decreased (-0.437020 --> -0.551835).  Saving model ...
Epoch: 5 cost time: 0.4507131576538086
Epoch: 5, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.602 Vali Acc: 0.593 Test Loss: 1.602 Test Acc: 0.593
Validation loss decreased (-0.551835 --> -0.592577).  Saving model ...
Epoch: 6 cost time: 0.48438549041748047
Epoch: 6, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.524 Vali Acc: 0.619 Test Loss: 1.524 Test Acc: 0.619
Validation loss decreased (-0.592577 --> -0.618503).  Saving model ...
Epoch: 7 cost time: 0.4702494144439697
Epoch: 7, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.432 Vali Acc: 0.659 Test Loss: 1.432 Test Acc: 0.659
Validation loss decreased (-0.618503 --> -0.659245).  Saving model ...
Epoch: 8 cost time: 0.4834589958190918
Epoch: 8, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.331 Vali Acc: 0.685 Test Loss: 1.331 Test Acc: 0.685
Validation loss decreased (-0.659245 --> -0.685172).  Saving model ...
Epoch: 9 cost time: 0.42706823348999023
Epoch: 9, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.221 Vali Acc: 0.770 Test Loss: 1.221 Test Acc: 0.770
Validation loss decreased (-0.685172 --> -0.770358).  Saving model ...
Epoch: 10 cost time: 0.46599507331848145
Epoch: 10, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.106 Vali Acc: 0.833 Test Loss: 1.106 Test Acc: 0.833
Validation loss decreased (-0.770358 --> -0.833322).  Saving model ...
Epoch: 11 cost time: 0.44887328147888184
Epoch: 11, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.990 Vali Acc: 0.907 Test Loss: 0.990 Test Acc: 0.907
Validation loss decreased (-0.833322 --> -0.907398).  Saving model ...
Epoch: 12 cost time: 0.48577046394348145
Epoch: 12, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.875 Vali Acc: 0.919 Test Loss: 0.875 Test Acc: 0.919
Validation loss decreased (-0.907398 --> -0.918510).  Saving model ...
Epoch: 13 cost time: 0.45087599754333496
Epoch: 13, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.766 Vali Acc: 0.922 Test Loss: 0.766 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922215).  Saving model ...
Epoch: 14 cost time: 0.4352850914001465
Epoch: 14, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.667 Vali Acc: 0.926 Test Loss: 0.667 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 15 cost time: 0.40367722511291504
Epoch: 15, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.578 Vali Acc: 0.922 Test Loss: 0.578 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4215822219848633
Epoch: 16, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.499 Vali Acc: 0.926 Test Loss: 0.499 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925921).  Saving model ...
Epoch: 17 cost time: 0.5211379528045654
Epoch: 17, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.434 Vali Acc: 0.930 Test Loss: 0.434 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 0.4503762722015381
Epoch: 18, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 0.48047804832458496
Epoch: 19, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.4691340923309326
Epoch: 20, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 21 cost time: 0.458282470703125
Epoch: 21, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 22 cost time: 0.49953293800354004
Epoch: 22, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 23 cost time: 0.46207594871520996
Epoch: 23, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.4914510250091553
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.445054292678833
Epoch: 25, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.4501500129699707
Epoch: 26, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.4445505142211914
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.4590919017791748
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.5454006195068359
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.5195374488830566
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.45099782943725586
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.4727442264556885
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.4543306827545166
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.4334561824798584
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.4706711769104004
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.5028917789459229
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.4842824935913086
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.4298217296600342
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.4691131114959717
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.4492838382720947
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.4442026615142822
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.4371328353881836
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.5070397853851318
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.4769406318664551
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.48144960403442383
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.4378931522369385
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.4439990520477295
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.5219297409057617
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4928874969482422
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.48768091201782227
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 818694
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7576615810394287
Epoch: 1, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.786 Vali Acc: 0.222 Test Loss: 1.786 Test Acc: 0.222
Validation loss decreased (inf --> -0.222204).  Saving model ...
Epoch: 2 cost time: 0.45678138732910156
Epoch: 2, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.761 Vali Acc: 0.278 Test Loss: 1.761 Test Acc: 0.278
Validation loss decreased (-0.222204 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.4275522232055664
Epoch: 3, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.733 Vali Acc: 0.319 Test Loss: 1.733 Test Acc: 0.319
Validation loss decreased (-0.277760 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.4542117118835449
Epoch: 4, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.690 Vali Acc: 0.504 Test Loss: 1.690 Test Acc: 0.504
Validation loss decreased (-0.318501 --> -0.503687).  Saving model ...
Epoch: 5 cost time: 0.45915651321411133
Epoch: 5, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.632 Vali Acc: 0.567 Test Loss: 1.632 Test Acc: 0.567
Validation loss decreased (-0.503687 --> -0.566650).  Saving model ...
Epoch: 6 cost time: 0.44733262062072754
Epoch: 6, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.559 Vali Acc: 0.607 Test Loss: 1.559 Test Acc: 0.607
Validation loss decreased (-0.566650 --> -0.607392).  Saving model ...
Epoch: 7 cost time: 0.4625096321105957
Epoch: 7, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.474 Vali Acc: 0.700 Test Loss: 1.474 Test Acc: 0.700
Validation loss decreased (-0.607392 --> -0.699985).  Saving model ...
Epoch: 8 cost time: 0.4583280086517334
Epoch: 8, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.379 Vali Acc: 0.793 Test Loss: 1.379 Test Acc: 0.793
Validation loss decreased (-0.699985 --> -0.792579).  Saving model ...
Epoch: 9 cost time: 0.5562474727630615
Epoch: 9, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.278 Vali Acc: 0.837 Test Loss: 1.278 Test Acc: 0.837
Validation loss decreased (-0.792579 --> -0.837024).  Saving model ...
Epoch: 10 cost time: 0.42174243927001953
Epoch: 10, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.171 Vali Acc: 0.863 Test Loss: 1.171 Test Acc: 0.863
Validation loss decreased (-0.837024 --> -0.862951).  Saving model ...
Epoch: 11 cost time: 0.5137057304382324
Epoch: 11, Steps: 2 | Train Loss: 0.818 Vali Loss: 1.063 Vali Acc: 0.889 Test Loss: 1.063 Test Acc: 0.889
Validation loss decreased (-0.862951 --> -0.888878).  Saving model ...
Epoch: 12 cost time: 0.43584680557250977
Epoch: 12, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.954 Vali Acc: 0.893 Test Loss: 0.954 Test Acc: 0.893
Validation loss decreased (-0.888878 --> -0.892583).  Saving model ...
Epoch: 13 cost time: 0.4444594383239746
Epoch: 13, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.847 Vali Acc: 0.900 Test Loss: 0.847 Test Acc: 0.900
Validation loss decreased (-0.892583 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.45319604873657227
Epoch: 14, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.750 Vali Acc: 0.907 Test Loss: 0.750 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 15 cost time: 0.46303892135620117
Epoch: 15, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.659 Vali Acc: 0.919 Test Loss: 0.659 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918512).  Saving model ...
Epoch: 16 cost time: 0.42316579818725586
Epoch: 16, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.577 Vali Acc: 0.926 Test Loss: 0.577 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 17 cost time: 0.4110586643218994
Epoch: 17, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.503 Vali Acc: 0.933 Test Loss: 0.503 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 18 cost time: 0.4820587635040283
Epoch: 18, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.441 Vali Acc: 0.937 Test Loss: 0.441 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 0.4022786617279053
Epoch: 19, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.390 Vali Acc: 0.941 Test Loss: 0.390 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.49815964698791504
Epoch: 20, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 21 cost time: 0.4423179626464844
Epoch: 21, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 22 cost time: 0.4314408302307129
Epoch: 22, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.44902515411376953
Epoch: 23, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.4226837158203125
Epoch: 24, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.43495917320251465
Epoch: 25, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.5009069442749023
Epoch: 26, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.43558168411254883
Epoch: 27, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.4384005069732666
Epoch: 28, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.4164869785308838
Epoch: 29, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.447002649307251
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.45094990730285645
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.41151881217956543
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.4472694396972656
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.43226027488708496
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.4123961925506592
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.43679022789001465
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5076475143432617
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.45543622970581055
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.4756193161010742
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.468402624130249
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.4334113597869873
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.49709439277648926
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 43 cost time: 0.46573972702026367
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 44 cost time: 0.461533784866333
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.45313119888305664
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.43887996673583984
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 47 cost time: 0.43659162521362305
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.4658794403076172
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.467850923538208
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.44495725631713867
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 812934
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.759385585784912
Epoch: 1, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.767 Vali Acc: 0.230 Test Loss: 1.767 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.43662214279174805
Epoch: 2, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.744 Vali Acc: 0.270 Test Loss: 1.744 Test Acc: 0.270
Validation loss decreased (-0.229612 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.39690542221069336
Epoch: 3, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.719 Vali Acc: 0.330 Test Loss: 1.719 Test Acc: 0.330
Validation loss decreased (-0.270353 --> -0.329612).  Saving model ...
Epoch: 4 cost time: 0.5100517272949219
Epoch: 4, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.683 Vali Acc: 0.393 Test Loss: 1.683 Test Acc: 0.393
Validation loss decreased (-0.329612 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.41112184524536133
Epoch: 5, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.636 Vali Acc: 0.496 Test Loss: 1.636 Test Acc: 0.496
Validation loss decreased (-0.392576 --> -0.496280).  Saving model ...
Epoch: 6 cost time: 0.4652373790740967
Epoch: 6, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.579 Vali Acc: 0.581 Test Loss: 1.579 Test Acc: 0.581
Validation loss decreased (-0.496280 --> -0.581466).  Saving model ...
Epoch: 7 cost time: 0.42694973945617676
Epoch: 7, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.512 Vali Acc: 0.678 Test Loss: 1.512 Test Acc: 0.678
Validation loss decreased (-0.581466 --> -0.677763).  Saving model ...
Epoch: 8 cost time: 0.45861124992370605
Epoch: 8, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.437 Vali Acc: 0.719 Test Loss: 1.437 Test Acc: 0.719
Validation loss decreased (-0.677763 --> -0.718504).  Saving model ...
Epoch: 9 cost time: 0.4537196159362793
Epoch: 9, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.355 Vali Acc: 0.793 Test Loss: 1.355 Test Acc: 0.793
Validation loss decreased (-0.718504 --> -0.792579).  Saving model ...
Epoch: 10 cost time: 0.457383394241333
Epoch: 10, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.268 Vali Acc: 0.852 Test Loss: 1.268 Test Acc: 0.852
Validation loss decreased (-0.792579 --> -0.851839).  Saving model ...
Epoch: 11 cost time: 0.47564101219177246
Epoch: 11, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.176 Vali Acc: 0.874 Test Loss: 1.176 Test Acc: 0.874
Validation loss decreased (-0.851839 --> -0.874062).  Saving model ...
Epoch: 12 cost time: 0.4133174419403076
Epoch: 12, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.081 Vali Acc: 0.896 Test Loss: 1.081 Test Acc: 0.896
Validation loss decreased (-0.874062 --> -0.896285).  Saving model ...
Epoch: 13 cost time: 0.416790246963501
Epoch: 13, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.985 Vali Acc: 0.907 Test Loss: 0.985 Test Acc: 0.907
Validation loss decreased (-0.896285 --> -0.907398).  Saving model ...
Epoch: 14 cost time: 0.4836575984954834
Epoch: 14, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.890 Vali Acc: 0.919 Test Loss: 0.890 Test Acc: 0.919
Validation loss decreased (-0.907398 --> -0.918510).  Saving model ...
Epoch: 15 cost time: 0.42948436737060547
Epoch: 15, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.798 Vali Acc: 0.933 Test Loss: 0.798 Test Acc: 0.933
Validation loss decreased (-0.918510 --> -0.933325).  Saving model ...
Epoch: 16 cost time: 0.4472789764404297
Epoch: 16, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.711 Vali Acc: 0.937 Test Loss: 0.711 Test Acc: 0.937
Validation loss decreased (-0.933325 --> -0.937030).  Saving model ...
Epoch: 17 cost time: 0.41625046730041504
Epoch: 17, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.631 Vali Acc: 0.937 Test Loss: 0.631 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 18 cost time: 0.4630398750305176
Epoch: 18, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.561 Vali Acc: 0.941 Test Loss: 0.561 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 19 cost time: 0.46082186698913574
Epoch: 19, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.500 Vali Acc: 0.944 Test Loss: 0.500 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 20 cost time: 0.44085144996643066
Epoch: 20, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.447 Vali Acc: 0.948 Test Loss: 0.447 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948144).  Saving model ...
Epoch: 21 cost time: 0.49933910369873047
Epoch: 21, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.403 Vali Acc: 0.948 Test Loss: 0.403 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 22 cost time: 0.447587251663208
Epoch: 22, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.366 Vali Acc: 0.948 Test Loss: 0.366 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 23 cost time: 0.43689584732055664
Epoch: 23, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.4609665870666504
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.308 Vali Acc: 0.952 Test Loss: 0.308 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 0.39597654342651367
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.286 Vali Acc: 0.952 Test Loss: 0.286 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.42445945739746094
Epoch: 26, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.269 Vali Acc: 0.956 Test Loss: 0.269 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.4464242458343506
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.956 Test Loss: 0.254 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.40150904655456543
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.241 Vali Acc: 0.956 Test Loss: 0.241 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.49324965476989746
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.956 Test Loss: 0.230 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.46692538261413574
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 31 cost time: 0.43807077407836914
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.4388549327850342
Epoch: 32, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 33 cost time: 0.40749263763427734
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 34 cost time: 0.4207756519317627
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.46424055099487305
Epoch: 35, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 36 cost time: 0.44292426109313965
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 37 cost time: 0.42565464973449707
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 38 cost time: 0.546065092086792
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 39 cost time: 0.4215066432952881
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 40 cost time: 0.4003415107727051
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 41 cost time: 0.45999646186828613
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 42 cost time: 0.44398951530456543
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.4356958866119385
Epoch: 43, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.44938206672668457
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.43910956382751465
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.4355156421661377
Epoch: 46, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 47 cost time: 0.4453556537628174
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.48164844512939453
Epoch: 48, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4470829963684082
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.40644335746765137
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 801030
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7669031620025635
Epoch: 1, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.813 Vali Acc: 0.159 Test Loss: 1.813 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.4392678737640381
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.796 Vali Acc: 0.167 Test Loss: 1.796 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.45426225662231445
Epoch: 3, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.777 Vali Acc: 0.170 Test Loss: 1.777 Test Acc: 0.170
Validation loss decreased (-0.166649 --> -0.170353).  Saving model ...
Epoch: 4 cost time: 0.43616724014282227
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.748 Vali Acc: 0.193 Test Loss: 1.748 Test Acc: 0.193
Validation loss decreased (-0.170353 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.4226870536804199
Epoch: 5, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.708 Vali Acc: 0.215 Test Loss: 1.708 Test Acc: 0.215
Validation loss decreased (-0.192575 --> -0.214798).  Saving model ...
Epoch: 6 cost time: 0.41889142990112305
Epoch: 6, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.658 Vali Acc: 0.437 Test Loss: 1.658 Test Acc: 0.437
Validation loss decreased (-0.214798 --> -0.437020).  Saving model ...
Epoch: 7 cost time: 0.4617455005645752
Epoch: 7, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.599 Vali Acc: 0.611 Test Loss: 1.599 Test Acc: 0.611
Validation loss decreased (-0.437020 --> -0.611095).  Saving model ...
Epoch: 8 cost time: 0.4154179096221924
Epoch: 8, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.530 Vali Acc: 0.707 Test Loss: 1.530 Test Acc: 0.707
Validation loss decreased (-0.611095 --> -0.707392).  Saving model ...
Epoch: 9 cost time: 0.42803025245666504
Epoch: 9, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.455 Vali Acc: 0.774 Test Loss: 1.455 Test Acc: 0.774
Validation loss decreased (-0.707392 --> -0.774060).  Saving model ...
Epoch: 10 cost time: 0.418245792388916
Epoch: 10, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.374 Vali Acc: 0.830 Test Loss: 1.374 Test Acc: 0.830
Validation loss decreased (-0.774060 --> -0.829616).  Saving model ...
Epoch: 11 cost time: 0.43967556953430176
Epoch: 11, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.287 Vali Acc: 0.863 Test Loss: 1.287 Test Acc: 0.863
Validation loss decreased (-0.829616 --> -0.862950).  Saving model ...
Epoch: 12 cost time: 0.456096887588501
Epoch: 12, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.198 Vali Acc: 0.889 Test Loss: 1.198 Test Acc: 0.889
Validation loss decreased (-0.862950 --> -0.888877).  Saving model ...
Epoch: 13 cost time: 0.43004441261291504
Epoch: 13, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.107 Vali Acc: 0.893 Test Loss: 1.107 Test Acc: 0.893
Validation loss decreased (-0.888877 --> -0.892582).  Saving model ...
Epoch: 14 cost time: 0.46771693229675293
Epoch: 14, Steps: 2 | Train Loss: 0.791 Vali Loss: 1.016 Vali Acc: 0.915 Test Loss: 1.016 Test Acc: 0.915
Validation loss decreased (-0.892582 --> -0.914805).  Saving model ...
Epoch: 15 cost time: 0.4065735340118408
Epoch: 15, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.927 Vali Acc: 0.926 Test Loss: 0.927 Test Acc: 0.926
Validation loss decreased (-0.914805 --> -0.925917).  Saving model ...
Epoch: 16 cost time: 0.42805933952331543
Epoch: 16, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.839 Vali Acc: 0.933 Test Loss: 0.839 Test Acc: 0.933
Validation loss decreased (-0.925917 --> -0.933325).  Saving model ...
Epoch: 17 cost time: 0.41272544860839844
Epoch: 17, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.755 Vali Acc: 0.944 Test Loss: 0.755 Test Acc: 0.944
Validation loss decreased (-0.933325 --> -0.944437).  Saving model ...
Epoch: 18 cost time: 0.40978121757507324
Epoch: 18, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.677 Vali Acc: 0.948 Test Loss: 0.677 Test Acc: 0.948
Validation loss decreased (-0.944437 --> -0.948141).  Saving model ...
Epoch: 19 cost time: 0.4342646598815918
Epoch: 19, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.607 Vali Acc: 0.948 Test Loss: 0.607 Test Acc: 0.948
Validation loss decreased (-0.948141 --> -0.948142).  Saving model ...
Epoch: 20 cost time: 0.41623568534851074
Epoch: 20, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.546 Vali Acc: 0.948 Test Loss: 0.546 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948143).  Saving model ...
Epoch: 21 cost time: 0.42597222328186035
Epoch: 21, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.492 Vali Acc: 0.956 Test Loss: 0.492 Test Acc: 0.956
Validation loss decreased (-0.948143 --> -0.955551).  Saving model ...
Epoch: 22 cost time: 0.4661386013031006
Epoch: 22, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.445 Vali Acc: 0.959 Test Loss: 0.445 Test Acc: 0.959
Validation loss decreased (-0.955551 --> -0.959255).  Saving model ...
Epoch: 23 cost time: 0.4833259582519531
Epoch: 23, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.406 Vali Acc: 0.959 Test Loss: 0.406 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959255).  Saving model ...
Epoch: 24 cost time: 0.4973640441894531
Epoch: 24, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.372 Vali Acc: 0.959 Test Loss: 0.372 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959256).  Saving model ...
Epoch: 25 cost time: 0.4715874195098877
Epoch: 25, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.343 Vali Acc: 0.963 Test Loss: 0.343 Test Acc: 0.963
Validation loss decreased (-0.959256 --> -0.962960).  Saving model ...
Epoch: 26 cost time: 0.42392897605895996
Epoch: 26, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.318 Vali Acc: 0.963 Test Loss: 0.318 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 27 cost time: 0.4095466136932373
Epoch: 27, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.297 Vali Acc: 0.967 Test Loss: 0.297 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966664).  Saving model ...
Epoch: 28 cost time: 0.421586275100708
Epoch: 28, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.278 Vali Acc: 0.967 Test Loss: 0.278 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 29 cost time: 0.4111621379852295
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.263 Vali Acc: 0.967 Test Loss: 0.263 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 30 cost time: 0.398270845413208
Epoch: 30, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.250 Vali Acc: 0.967 Test Loss: 0.250 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 31 cost time: 0.4210221767425537
Epoch: 31, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.967 Test Loss: 0.239 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 32 cost time: 0.45493078231811523
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.230 Vali Acc: 0.967 Test Loss: 0.230 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 33 cost time: 0.41693735122680664
Epoch: 33, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 34 cost time: 0.43291807174682617
Epoch: 34, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.970 Test Loss: 0.215 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.970368).  Saving model ...
Epoch: 35 cost time: 0.40224146842956543
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 36 cost time: 0.46158599853515625
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.205 Vali Acc: 0.970 Test Loss: 0.205 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 37 cost time: 0.4275848865509033
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 38 cost time: 0.4022212028503418
Epoch: 38, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 39 cost time: 0.407397985458374
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.970 Test Loss: 0.193 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 40 cost time: 0.4802980422973633
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 41 cost time: 0.42703914642333984
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 42 cost time: 0.399738073348999
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970369).  Saving model ...
Epoch: 43 cost time: 0.4179880619049072
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 44 cost time: 0.5124256610870361
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 45 cost time: 0.4566822052001953
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 46 cost time: 0.4301590919494629
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 47 cost time: 0.4426093101501465
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 48 cost time: 0.4714851379394531
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 49 cost time: 0.4345874786376953
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 50 cost time: 0.4231586456298828
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9703703703703703
model parameter : 795398
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.787470817565918
Epoch: 1, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.789 Vali Acc: 0.367 Test Loss: 1.789 Test Acc: 0.367
Validation loss decreased (inf --> -0.366649).  Saving model ...
Epoch: 2 cost time: 0.4058198928833008
Epoch: 2, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.746 Vali Acc: 0.430 Test Loss: 1.746 Test Acc: 0.430
Validation loss decreased (-0.366649 --> -0.429612).  Saving model ...
Epoch: 3 cost time: 0.39144206047058105
Epoch: 3, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.696 Vali Acc: 0.463 Test Loss: 1.696 Test Acc: 0.463
Validation loss decreased (-0.429612 --> -0.462946).  Saving model ...
Epoch: 4 cost time: 0.4527122974395752
Epoch: 4, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.621 Vali Acc: 0.500 Test Loss: 1.621 Test Acc: 0.500
Validation loss decreased (-0.462946 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 0.384737491607666
Epoch: 5, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.522 Vali Acc: 0.589 Test Loss: 1.522 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588874).  Saving model ...
Epoch: 6 cost time: 0.4499175548553467
Epoch: 6, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.403 Vali Acc: 0.759 Test Loss: 1.403 Test Acc: 0.759
Validation loss decreased (-0.588874 --> -0.759245).  Saving model ...
Epoch: 7 cost time: 0.40725159645080566
Epoch: 7, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.269 Vali Acc: 0.878 Test Loss: 1.269 Test Acc: 0.878
Validation loss decreased (-0.759245 --> -0.877765).  Saving model ...
Epoch: 8 cost time: 0.4003586769104004
Epoch: 8, Steps: 2 | Train Loss: 0.907 Vali Loss: 1.129 Vali Acc: 0.904 Test Loss: 1.129 Test Acc: 0.904
Validation loss decreased (-0.877765 --> -0.903692).  Saving model ...
Epoch: 9 cost time: 0.38869285583496094
Epoch: 9, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.988 Vali Acc: 0.911 Test Loss: 0.988 Test Acc: 0.911
Validation loss decreased (-0.903692 --> -0.911101).  Saving model ...
Epoch: 10 cost time: 0.4078633785247803
Epoch: 10, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.852 Vali Acc: 0.937 Test Loss: 0.852 Test Acc: 0.937
Validation loss decreased (-0.911101 --> -0.937029).  Saving model ...
Epoch: 11 cost time: 0.4267394542694092
Epoch: 11, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.726 Vali Acc: 0.941 Test Loss: 0.726 Test Acc: 0.941
Validation loss decreased (-0.937029 --> -0.940733).  Saving model ...
Epoch: 12 cost time: 0.38996315002441406
Epoch: 12, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.616 Vali Acc: 0.948 Test Loss: 0.616 Test Acc: 0.948
Validation loss decreased (-0.940733 --> -0.948142).  Saving model ...
Epoch: 13 cost time: 0.3913114070892334
Epoch: 13, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.518 Vali Acc: 0.941 Test Loss: 0.518 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.41878485679626465
Epoch: 14, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.434 Vali Acc: 0.941 Test Loss: 0.434 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.43930602073669434
Epoch: 15, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.370 Vali Acc: 0.926 Test Loss: 0.370 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4602072238922119
Epoch: 16, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4808049201965332
Epoch: 17, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.42778778076171875
Epoch: 18, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4480586051940918
Epoch: 19, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.39388465881347656
Epoch: 20, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.36254405975341797
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.40711522102355957
Epoch: 22, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.38861083984375
Epoch: 23, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.49077939987182617
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.4170706272125244
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.3852272033691406
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.3952322006225586
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.3925356864929199
Epoch: 28, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.5033938884735107
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.5677659511566162
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.4258418083190918
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.45444631576538086
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.952 Test Loss: 0.158 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.4617767333984375
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.952 Test Loss: 0.158 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.41989731788635254
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.5567386150360107
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.39934253692626953
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.4217338562011719
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.40607619285583496
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.519641637802124
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.4599332809448242
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.4116666316986084
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.3758106231689453
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.3975670337677002
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.39041757583618164
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.42653369903564453
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.460294246673584
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4343724250793457
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5107762813568115
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.5281050205230713
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.5158305168151855
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 305606
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7404427528381348
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.805 Vali Acc: 0.185 Test Loss: 1.805 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.3970944881439209
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.779 Vali Acc: 0.189 Test Loss: 1.779 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.5308403968811035
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.752 Vali Acc: 0.200 Test Loss: 1.752 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.38349246978759766
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.713 Vali Acc: 0.248 Test Loss: 1.713 Test Acc: 0.248
Validation loss decreased (-0.199982 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.4331822395324707
Epoch: 5, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.659 Vali Acc: 0.389 Test Loss: 1.659 Test Acc: 0.389
Validation loss decreased (-0.248131 --> -0.388872).  Saving model ...
Epoch: 6 cost time: 0.40876221656799316
Epoch: 6, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.594 Vali Acc: 0.574 Test Loss: 1.594 Test Acc: 0.574
Validation loss decreased (-0.388872 --> -0.574058).  Saving model ...
Epoch: 7 cost time: 0.41968846321105957
Epoch: 7, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.516 Vali Acc: 0.670 Test Loss: 1.516 Test Acc: 0.670
Validation loss decreased (-0.574058 --> -0.670355).  Saving model ...
Epoch: 8 cost time: 0.40746331214904785
Epoch: 8, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.429 Vali Acc: 0.770 Test Loss: 1.429 Test Acc: 0.770
Validation loss decreased (-0.670355 --> -0.770356).  Saving model ...
Epoch: 9 cost time: 0.41980481147766113
Epoch: 9, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.332 Vali Acc: 0.815 Test Loss: 1.332 Test Acc: 0.815
Validation loss decreased (-0.770356 --> -0.814801).  Saving model ...
Epoch: 10 cost time: 0.3932063579559326
Epoch: 10, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.228 Vali Acc: 0.863 Test Loss: 1.228 Test Acc: 0.863
Validation loss decreased (-0.814801 --> -0.862951).  Saving model ...
Epoch: 11 cost time: 0.41054725646972656
Epoch: 11, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.121 Vali Acc: 0.867 Test Loss: 1.121 Test Acc: 0.867
Validation loss decreased (-0.862951 --> -0.866655).  Saving model ...
Epoch: 12 cost time: 0.43762755393981934
Epoch: 12, Steps: 2 | Train Loss: 0.805 Vali Loss: 1.015 Vali Acc: 0.881 Test Loss: 1.015 Test Acc: 0.881
Validation loss decreased (-0.866655 --> -0.881471).  Saving model ...
Epoch: 13 cost time: 0.4281277656555176
Epoch: 13, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.910 Vali Acc: 0.907 Test Loss: 0.910 Test Acc: 0.907
Validation loss decreased (-0.881471 --> -0.907398).  Saving model ...
Epoch: 14 cost time: 0.3998382091522217
Epoch: 14, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.808 Vali Acc: 0.911 Test Loss: 0.808 Test Acc: 0.911
Validation loss decreased (-0.907398 --> -0.911103).  Saving model ...
Epoch: 15 cost time: 0.44109368324279785
Epoch: 15, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.715 Vali Acc: 0.904 Test Loss: 0.715 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.41004014015197754
Epoch: 16, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.629 Vali Acc: 0.900 Test Loss: 0.629 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.42160534858703613
Epoch: 17, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.41692304611206055
Epoch: 18, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.486 Vali Acc: 0.904 Test Loss: 0.486 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.40169739723205566
Epoch: 19, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911107).  Saving model ...
Epoch: 20 cost time: 0.4284694194793701
Epoch: 20, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.40770697593688965
Epoch: 21, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.4259066581726074
Epoch: 22, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.4792466163635254
Epoch: 23, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.47068166732788086
Epoch: 24, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.4078657627105713
Epoch: 25, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.49779796600341797
Epoch: 26, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.42490386962890625
Epoch: 27, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.45880794525146484
Epoch: 28, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.46533894538879395
Epoch: 29, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.4241368770599365
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.42653346061706543
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.4644474983215332
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5182263851165771
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.45640039443969727
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.43826746940612793
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5342807769775391
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.39499878883361816
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.4309666156768799
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.4370601177215576
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.4290344715118408
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.44872212409973145
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.4388265609741211
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.4229466915130615
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.41196727752685547
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.4099557399749756
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 46 cost time: 0.4648144245147705
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 47 cost time: 0.4449574947357178
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.3890407085418701
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 49 cost time: 0.43538713455200195
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.5457429885864258
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 253510
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7676689624786377
Epoch: 1, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.782 Vali Acc: 0.237 Test Loss: 1.782 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.3927171230316162
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.754 Vali Acc: 0.307 Test Loss: 1.754 Test Acc: 0.307
Validation loss decreased (-0.237019 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.4411466121673584
Epoch: 3, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.729 Vali Acc: 0.356 Test Loss: 1.729 Test Acc: 0.356
Validation loss decreased (-0.307390 --> -0.355538).  Saving model ...
Epoch: 4 cost time: 0.4208219051361084
Epoch: 4, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.697 Vali Acc: 0.441 Test Loss: 1.697 Test Acc: 0.441
Validation loss decreased (-0.355538 --> -0.440724).  Saving model ...
Epoch: 5 cost time: 0.4070582389831543
Epoch: 5, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.654 Vali Acc: 0.593 Test Loss: 1.654 Test Acc: 0.593
Validation loss decreased (-0.440724 --> -0.592576).  Saving model ...
Epoch: 6 cost time: 0.46309947967529297
Epoch: 6, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.602 Vali Acc: 0.700 Test Loss: 1.602 Test Acc: 0.700
Validation loss decreased (-0.592576 --> -0.699984).  Saving model ...
Epoch: 7 cost time: 0.5101752281188965
Epoch: 7, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.542 Vali Acc: 0.744 Test Loss: 1.542 Test Acc: 0.744
Validation loss decreased (-0.699984 --> -0.744429).  Saving model ...
Epoch: 8 cost time: 0.4141499996185303
Epoch: 8, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.473 Vali Acc: 0.785 Test Loss: 1.473 Test Acc: 0.785
Validation loss decreased (-0.744429 --> -0.785170).  Saving model ...
Epoch: 9 cost time: 0.38519811630249023
Epoch: 9, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.399 Vali Acc: 0.822 Test Loss: 1.399 Test Acc: 0.822
Validation loss decreased (-0.785170 --> -0.822208).  Saving model ...
Epoch: 10 cost time: 0.43074512481689453
Epoch: 10, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.319 Vali Acc: 0.859 Test Loss: 1.319 Test Acc: 0.859
Validation loss decreased (-0.822208 --> -0.859246).  Saving model ...
Epoch: 11 cost time: 0.4397165775299072
Epoch: 11, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.235 Vali Acc: 0.867 Test Loss: 1.235 Test Acc: 0.867
Validation loss decreased (-0.859246 --> -0.866654).  Saving model ...
Epoch: 12 cost time: 0.390228271484375
Epoch: 12, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.146 Vali Acc: 0.889 Test Loss: 1.146 Test Acc: 0.889
Validation loss decreased (-0.866654 --> -0.888877).  Saving model ...
Epoch: 13 cost time: 0.43326282501220703
Epoch: 13, Steps: 2 | Train Loss: 0.840 Vali Loss: 1.058 Vali Acc: 0.896 Test Loss: 1.058 Test Acc: 0.896
Validation loss decreased (-0.888877 --> -0.896286).  Saving model ...
Epoch: 14 cost time: 0.4212644100189209
Epoch: 14, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.969 Vali Acc: 0.900 Test Loss: 0.969 Test Acc: 0.900
Validation loss decreased (-0.896286 --> -0.899990).  Saving model ...
Epoch: 15 cost time: 0.36308956146240234
Epoch: 15, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.881 Vali Acc: 0.911 Test Loss: 0.881 Test Acc: 0.911
Validation loss decreased (-0.899990 --> -0.911102).  Saving model ...
Epoch: 16 cost time: 0.3756382465362549
Epoch: 16, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.796 Vali Acc: 0.919 Test Loss: 0.796 Test Acc: 0.919
Validation loss decreased (-0.911102 --> -0.918511).  Saving model ...
Epoch: 17 cost time: 0.38243722915649414
Epoch: 17, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.714 Vali Acc: 0.919 Test Loss: 0.714 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 18 cost time: 0.39690256118774414
Epoch: 18, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.637 Vali Acc: 0.922 Test Loss: 0.637 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 19 cost time: 0.3917207717895508
Epoch: 19, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.567 Vali Acc: 0.926 Test Loss: 0.567 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 20 cost time: 0.48768138885498047
Epoch: 20, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.507 Vali Acc: 0.926 Test Loss: 0.507 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 21 cost time: 0.3891277313232422
Epoch: 21, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.454 Vali Acc: 0.926 Test Loss: 0.454 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 22 cost time: 0.39730048179626465
Epoch: 22, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.408 Vali Acc: 0.933 Test Loss: 0.408 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 23 cost time: 0.3719518184661865
Epoch: 23, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.371 Vali Acc: 0.933 Test Loss: 0.371 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 24 cost time: 0.4180457592010498
Epoch: 24, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.4029726982116699
Epoch: 25, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 0.38366198539733887
Epoch: 26, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.295 Vali Acc: 0.941 Test Loss: 0.295 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.38764214515686035
Epoch: 27, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.3695704936981201
Epoch: 28, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.38492298126220703
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.38767194747924805
Epoch: 30, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.37561607360839844
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.5012919902801514
Epoch: 32, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4649224281311035
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.39269065856933594
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.3822970390319824
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.3997347354888916
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.397200345993042
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.41493701934814453
Epoch: 38, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.4487321376800537
Epoch: 39, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.40845608711242676
Epoch: 40, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.39162516593933105
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.42555975914001465
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.5243024826049805
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.46405839920043945
Epoch: 44, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.3594701290130615
Epoch: 45, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.4694957733154297
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.4382622241973877
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.369326114654541
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.3939361572265625
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.4824862480163574
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 238214
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6753194332122803
Epoch: 1, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.772 Vali Acc: 0.137 Test Loss: 1.772 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.42657470703125
Epoch: 2, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.753 Vali Acc: 0.144 Test Loss: 1.753 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144427).  Saving model ...
Epoch: 3 cost time: 0.4005589485168457
Epoch: 3, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.735 Vali Acc: 0.174 Test Loss: 1.735 Test Acc: 0.174
Validation loss decreased (-0.144427 --> -0.174057).  Saving model ...
Epoch: 4 cost time: 0.4525322914123535
Epoch: 4, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.712 Vali Acc: 0.219 Test Loss: 1.712 Test Acc: 0.219
Validation loss decreased (-0.174057 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 0.5137603282928467
Epoch: 5, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.681 Vali Acc: 0.293 Test Loss: 1.681 Test Acc: 0.293
Validation loss decreased (-0.218501 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.4076247215270996
Epoch: 6, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.645 Vali Acc: 0.404 Test Loss: 1.645 Test Acc: 0.404
Validation loss decreased (-0.292576 --> -0.403687).  Saving model ...
Epoch: 7 cost time: 0.37070488929748535
Epoch: 7, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.601 Vali Acc: 0.533 Test Loss: 1.601 Test Acc: 0.533
Validation loss decreased (-0.403687 --> -0.533317).  Saving model ...
Epoch: 8 cost time: 0.37773609161376953
Epoch: 8, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.551 Vali Acc: 0.641 Test Loss: 1.551 Test Acc: 0.641
Validation loss decreased (-0.533317 --> -0.640725).  Saving model ...
Epoch: 9 cost time: 0.3793799877166748
Epoch: 9, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.494 Vali Acc: 0.696 Test Loss: 1.494 Test Acc: 0.696
Validation loss decreased (-0.640725 --> -0.696281).  Saving model ...
Epoch: 10 cost time: 0.41338396072387695
Epoch: 10, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.431 Vali Acc: 0.752 Test Loss: 1.431 Test Acc: 0.752
Validation loss decreased (-0.696281 --> -0.751838).  Saving model ...
Epoch: 11 cost time: 0.378864049911499
Epoch: 11, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.363 Vali Acc: 0.785 Test Loss: 1.363 Test Acc: 0.785
Validation loss decreased (-0.751838 --> -0.785172).  Saving model ...
Epoch: 12 cost time: 0.4315762519836426
Epoch: 12, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.289 Vali Acc: 0.841 Test Loss: 1.289 Test Acc: 0.841
Validation loss decreased (-0.785172 --> -0.840728).  Saving model ...
Epoch: 13 cost time: 0.39479780197143555
Epoch: 13, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.212 Vali Acc: 0.863 Test Loss: 1.212 Test Acc: 0.863
Validation loss decreased (-0.840728 --> -0.862951).  Saving model ...
Epoch: 14 cost time: 0.43739867210388184
Epoch: 14, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.133 Vali Acc: 0.881 Test Loss: 1.133 Test Acc: 0.881
Validation loss decreased (-0.862951 --> -0.881470).  Saving model ...
Epoch: 15 cost time: 0.4110260009765625
Epoch: 15, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.051 Vali Acc: 0.893 Test Loss: 1.051 Test Acc: 0.893
Validation loss decreased (-0.881470 --> -0.892582).  Saving model ...
Epoch: 16 cost time: 0.387082576751709
Epoch: 16, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.969 Vali Acc: 0.893 Test Loss: 0.969 Test Acc: 0.893
Validation loss decreased (-0.892582 --> -0.892583).  Saving model ...
Epoch: 17 cost time: 0.40825438499450684
Epoch: 17, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.889 Vali Acc: 0.907 Test Loss: 0.889 Test Acc: 0.907
Validation loss decreased (-0.892583 --> -0.907399).  Saving model ...
Epoch: 18 cost time: 0.3696613311767578
Epoch: 18, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.812 Vali Acc: 0.915 Test Loss: 0.812 Test Acc: 0.915
Validation loss decreased (-0.907399 --> -0.914807).  Saving model ...
Epoch: 19 cost time: 0.37679100036621094
Epoch: 19, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.739 Vali Acc: 0.915 Test Loss: 0.739 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914807).  Saving model ...
Epoch: 20 cost time: 0.37862491607666016
Epoch: 20, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.670 Vali Acc: 0.919 Test Loss: 0.670 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918512).  Saving model ...
Epoch: 21 cost time: 0.3979671001434326
Epoch: 21, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.607 Vali Acc: 0.933 Test Loss: 0.607 Test Acc: 0.933
Validation loss decreased (-0.918512 --> -0.933327).  Saving model ...
Epoch: 22 cost time: 0.39345335960388184
Epoch: 22, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.550 Vali Acc: 0.937 Test Loss: 0.550 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937032).  Saving model ...
Epoch: 23 cost time: 0.4072451591491699
Epoch: 23, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.500 Vali Acc: 0.948 Test Loss: 0.500 Test Acc: 0.948
Validation loss decreased (-0.937032 --> -0.948143).  Saving model ...
Epoch: 24 cost time: 0.4270167350769043
Epoch: 24, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.456 Vali Acc: 0.952 Test Loss: 0.456 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 25 cost time: 0.544365406036377
Epoch: 25, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.417 Vali Acc: 0.952 Test Loss: 0.417 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 26 cost time: 0.43268299102783203
Epoch: 26, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.384 Vali Acc: 0.948 Test Loss: 0.384 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5292384624481201
Epoch: 27, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.356 Vali Acc: 0.948 Test Loss: 0.356 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4419064521789551
Epoch: 28, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4273984432220459
Epoch: 29, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.45442628860473633
Epoch: 30, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.486588716506958
Epoch: 31, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.4107048511505127
Epoch: 32, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4520416259765625
Epoch: 33, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.4178042411804199
Epoch: 34, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.48509955406188965
Epoch: 35, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 229126
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.583069086074829
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.788 Vali Acc: 0.130 Test Loss: 1.788 Test Acc: 0.130
Validation loss decreased (inf --> -0.129612).  Saving model ...
Epoch: 2 cost time: 0.3975400924682617
Epoch: 2, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.773 Vali Acc: 0.181 Test Loss: 1.773 Test Acc: 0.181
Validation loss decreased (-0.129612 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.45213961601257324
Epoch: 3, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.758 Vali Acc: 0.237 Test Loss: 1.758 Test Acc: 0.237
Validation loss decreased (-0.181464 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.4055025577545166
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.739 Vali Acc: 0.296 Test Loss: 1.739 Test Acc: 0.296
Validation loss decreased (-0.237019 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.4110221862792969
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.713 Vali Acc: 0.374 Test Loss: 1.713 Test Acc: 0.374
Validation loss decreased (-0.296279 --> -0.374057).  Saving model ...
Epoch: 6 cost time: 0.35851049423217773
Epoch: 6, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.680 Vali Acc: 0.541 Test Loss: 1.680 Test Acc: 0.541
Validation loss decreased (-0.374057 --> -0.540724).  Saving model ...
Epoch: 7 cost time: 0.4268934726715088
Epoch: 7, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.642 Vali Acc: 0.619 Test Loss: 1.642 Test Acc: 0.619
Validation loss decreased (-0.540724 --> -0.618502).  Saving model ...
Epoch: 8 cost time: 0.44580817222595215
Epoch: 8, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.597 Vali Acc: 0.704 Test Loss: 1.597 Test Acc: 0.704
Validation loss decreased (-0.618502 --> -0.703688).  Saving model ...
Epoch: 9 cost time: 0.4495503902435303
Epoch: 9, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.548 Vali Acc: 0.752 Test Loss: 1.548 Test Acc: 0.752
Validation loss decreased (-0.703688 --> -0.751836).  Saving model ...
Epoch: 10 cost time: 0.3719785213470459
Epoch: 10, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.494 Vali Acc: 0.789 Test Loss: 1.494 Test Acc: 0.789
Validation loss decreased (-0.751836 --> -0.788874).  Saving model ...
Epoch: 11 cost time: 0.41296815872192383
Epoch: 11, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.436 Vali Acc: 0.815 Test Loss: 1.436 Test Acc: 0.815
Validation loss decreased (-0.788874 --> -0.814800).  Saving model ...
Epoch: 12 cost time: 0.382800817489624
Epoch: 12, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.375 Vali Acc: 0.830 Test Loss: 1.375 Test Acc: 0.830
Validation loss decreased (-0.814800 --> -0.829616).  Saving model ...
Epoch: 13 cost time: 0.39678382873535156
Epoch: 13, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.312 Vali Acc: 0.841 Test Loss: 1.312 Test Acc: 0.841
Validation loss decreased (-0.829616 --> -0.840728).  Saving model ...
Epoch: 14 cost time: 0.35374951362609863
Epoch: 14, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.245 Vali Acc: 0.852 Test Loss: 1.245 Test Acc: 0.852
Validation loss decreased (-0.840728 --> -0.851839).  Saving model ...
Epoch: 15 cost time: 0.4198601245880127
Epoch: 15, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.177 Vali Acc: 0.878 Test Loss: 1.177 Test Acc: 0.878
Validation loss decreased (-0.851839 --> -0.877766).  Saving model ...
Epoch: 16 cost time: 0.3920767307281494
Epoch: 16, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.105 Vali Acc: 0.885 Test Loss: 1.105 Test Acc: 0.885
Validation loss decreased (-0.877766 --> -0.885174).  Saving model ...
Epoch: 17 cost time: 0.400040864944458
Epoch: 17, Steps: 2 | Train Loss: 0.808 Vali Loss: 1.032 Vali Acc: 0.900 Test Loss: 1.032 Test Acc: 0.900
Validation loss decreased (-0.885174 --> -0.899990).  Saving model ...
Epoch: 18 cost time: 0.40326642990112305
Epoch: 18, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.959 Vali Acc: 0.904 Test Loss: 0.959 Test Acc: 0.904
Validation loss decreased (-0.899990 --> -0.903694).  Saving model ...
Epoch: 19 cost time: 0.4058711528778076
Epoch: 19, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.888 Vali Acc: 0.926 Test Loss: 0.888 Test Acc: 0.926
Validation loss decreased (-0.903694 --> -0.925917).  Saving model ...
Epoch: 20 cost time: 0.3724989891052246
Epoch: 20, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.818 Vali Acc: 0.926 Test Loss: 0.818 Test Acc: 0.926
Validation loss decreased (-0.925917 --> -0.925918).  Saving model ...
Epoch: 21 cost time: 0.4326188564300537
Epoch: 21, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.752 Vali Acc: 0.926 Test Loss: 0.752 Test Acc: 0.926
Validation loss decreased (-0.925918 --> -0.925918).  Saving model ...
Epoch: 22 cost time: 0.41083693504333496
Epoch: 22, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.690 Vali Acc: 0.933 Test Loss: 0.690 Test Acc: 0.933
Validation loss decreased (-0.925918 --> -0.933326).  Saving model ...
Epoch: 23 cost time: 0.3709244728088379
Epoch: 23, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.631 Vali Acc: 0.937 Test Loss: 0.631 Test Acc: 0.937
Validation loss decreased (-0.933326 --> -0.937031).  Saving model ...
Epoch: 24 cost time: 0.3773484230041504
Epoch: 24, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.579 Vali Acc: 0.948 Test Loss: 0.579 Test Acc: 0.948
Validation loss decreased (-0.937031 --> -0.948142).  Saving model ...
Epoch: 25 cost time: 0.37860751152038574
Epoch: 25, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.531 Vali Acc: 0.948 Test Loss: 0.531 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948143).  Saving model ...
Epoch: 26 cost time: 0.3794081211090088
Epoch: 26, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.489 Vali Acc: 0.948 Test Loss: 0.489 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 27 cost time: 0.4810953140258789
Epoch: 27, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.453 Vali Acc: 0.948 Test Loss: 0.453 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 28 cost time: 0.41220974922180176
Epoch: 28, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.422 Vali Acc: 0.948 Test Loss: 0.422 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 29 cost time: 0.40764403343200684
Epoch: 29, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.394 Vali Acc: 0.948 Test Loss: 0.394 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 30 cost time: 0.3944253921508789
Epoch: 30, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.369 Vali Acc: 0.948 Test Loss: 0.369 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 31 cost time: 0.3633105754852295
Epoch: 31, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.348 Vali Acc: 0.948 Test Loss: 0.348 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.47132158279418945
Epoch: 32, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.328 Vali Acc: 0.948 Test Loss: 0.328 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.40427064895629883
Epoch: 33, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.312 Vali Acc: 0.948 Test Loss: 0.312 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 34 cost time: 0.3746767044067383
Epoch: 34, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.297 Vali Acc: 0.948 Test Loss: 0.297 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 35 cost time: 0.5393075942993164
Epoch: 35, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 36 cost time: 0.40770459175109863
Epoch: 36, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.39832234382629395
Epoch: 37, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.263 Vali Acc: 0.956 Test Loss: 0.263 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.4886143207550049
Epoch: 38, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.254 Vali Acc: 0.956 Test Loss: 0.254 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.3993535041809082
Epoch: 39, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.4529421329498291
Epoch: 40, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.4099388122558594
Epoch: 41, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.956 Test Loss: 0.234 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 42 cost time: 0.4178628921508789
Epoch: 42, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 43 cost time: 0.4229757785797119
Epoch: 43, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.4115560054779053
Epoch: 44, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.4356966018676758
Epoch: 45, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 46 cost time: 0.4605228900909424
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.213 Vali Acc: 0.959 Test Loss: 0.213 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.40170955657958984
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.4032096862792969
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.36825060844421387
Epoch: 49, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.49815821647644043
Epoch: 50, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 226246
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8009686470031738
Epoch: 1, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.749 Vali Acc: 0.215 Test Loss: 1.749 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.42357349395751953
Epoch: 2, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.735 Vali Acc: 0.241 Test Loss: 1.735 Test Acc: 0.241
Validation loss decreased (-0.214797 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.4112405776977539
Epoch: 3, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.723 Vali Acc: 0.278 Test Loss: 1.723 Test Acc: 0.278
Validation loss decreased (-0.240723 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.42151975631713867
Epoch: 4, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.707 Vali Acc: 0.296 Test Loss: 1.707 Test Acc: 0.296
Validation loss decreased (-0.277761 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.386721134185791
Epoch: 5, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.687 Vali Acc: 0.348 Test Loss: 1.687 Test Acc: 0.348
Validation loss decreased (-0.296279 --> -0.348131).  Saving model ...
Epoch: 6 cost time: 0.4371917247772217
Epoch: 6, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.661 Vali Acc: 0.407 Test Loss: 1.661 Test Acc: 0.407
Validation loss decreased (-0.348131 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 0.44318079948425293
Epoch: 7, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.630 Vali Acc: 0.489 Test Loss: 1.630 Test Acc: 0.489
Validation loss decreased (-0.407391 --> -0.488873).  Saving model ...
Epoch: 8 cost time: 0.3920247554779053
Epoch: 8, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.595 Vali Acc: 0.537 Test Loss: 1.595 Test Acc: 0.537
Validation loss decreased (-0.488873 --> -0.537021).  Saving model ...
Epoch: 9 cost time: 0.4283132553100586
Epoch: 9, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.555 Vali Acc: 0.574 Test Loss: 1.555 Test Acc: 0.574
Validation loss decreased (-0.537021 --> -0.574059).  Saving model ...
Epoch: 10 cost time: 0.40671539306640625
Epoch: 10, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.511 Vali Acc: 0.626 Test Loss: 1.511 Test Acc: 0.626
Validation loss decreased (-0.574059 --> -0.625911).  Saving model ...
Epoch: 11 cost time: 0.4254162311553955
Epoch: 11, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.462 Vali Acc: 0.696 Test Loss: 1.462 Test Acc: 0.696
Validation loss decreased (-0.625911 --> -0.696282).  Saving model ...
Epoch: 12 cost time: 0.42818522453308105
Epoch: 12, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.411 Vali Acc: 0.737 Test Loss: 1.411 Test Acc: 0.737
Validation loss decreased (-0.696282 --> -0.737023).  Saving model ...
Epoch: 13 cost time: 0.48860931396484375
Epoch: 13, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.357 Vali Acc: 0.774 Test Loss: 1.357 Test Acc: 0.774
Validation loss decreased (-0.737023 --> -0.774061).  Saving model ...
Epoch: 14 cost time: 0.432633638381958
Epoch: 14, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.300 Vali Acc: 0.826 Test Loss: 1.300 Test Acc: 0.826
Validation loss decreased (-0.774061 --> -0.825913).  Saving model ...
Epoch: 15 cost time: 0.424807071685791
Epoch: 15, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.241 Vali Acc: 0.878 Test Loss: 1.241 Test Acc: 0.878
Validation loss decreased (-0.825913 --> -0.877765).  Saving model ...
Epoch: 16 cost time: 0.421550989151001
Epoch: 16, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.181 Vali Acc: 0.893 Test Loss: 1.181 Test Acc: 0.893
Validation loss decreased (-0.877765 --> -0.892581).  Saving model ...
Epoch: 17 cost time: 0.40302062034606934
Epoch: 17, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.121 Vali Acc: 0.900 Test Loss: 1.121 Test Acc: 0.900
Validation loss decreased (-0.892581 --> -0.899989).  Saving model ...
Epoch: 18 cost time: 0.38182544708251953
Epoch: 18, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.061 Vali Acc: 0.907 Test Loss: 1.061 Test Acc: 0.907
Validation loss decreased (-0.899989 --> -0.907397).  Saving model ...
Epoch: 19 cost time: 0.4445936679840088
Epoch: 19, Steps: 2 | Train Loss: 0.843 Vali Loss: 1.001 Vali Acc: 0.907 Test Loss: 1.001 Test Acc: 0.907
Validation loss decreased (-0.907397 --> -0.907397).  Saving model ...
Epoch: 20 cost time: 0.3808104991912842
Epoch: 20, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.942 Vali Acc: 0.907 Test Loss: 0.942 Test Acc: 0.907
Validation loss decreased (-0.907397 --> -0.907398).  Saving model ...
Epoch: 21 cost time: 0.41849207878112793
Epoch: 21, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.884 Vali Acc: 0.915 Test Loss: 0.884 Test Acc: 0.915
Validation loss decreased (-0.907398 --> -0.914806).  Saving model ...
Epoch: 22 cost time: 0.37175679206848145
Epoch: 22, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.827 Vali Acc: 0.930 Test Loss: 0.827 Test Acc: 0.930
Validation loss decreased (-0.914806 --> -0.929621).  Saving model ...
Epoch: 23 cost time: 0.34491944313049316
Epoch: 23, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.773 Vali Acc: 0.941 Test Loss: 0.773 Test Acc: 0.941
Validation loss decreased (-0.929621 --> -0.940733).  Saving model ...
Epoch: 24 cost time: 0.35912251472473145
Epoch: 24, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.720 Vali Acc: 0.941 Test Loss: 0.720 Test Acc: 0.941
Validation loss decreased (-0.940733 --> -0.940734).  Saving model ...
Epoch: 25 cost time: 0.4307882785797119
Epoch: 25, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.671 Vali Acc: 0.948 Test Loss: 0.671 Test Acc: 0.948
Validation loss decreased (-0.940734 --> -0.948141).  Saving model ...
Epoch: 26 cost time: 0.4043276309967041
Epoch: 26, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.625 Vali Acc: 0.948 Test Loss: 0.625 Test Acc: 0.948
Validation loss decreased (-0.948141 --> -0.948142).  Saving model ...
Epoch: 27 cost time: 0.4008617401123047
Epoch: 27, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.583 Vali Acc: 0.948 Test Loss: 0.583 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948142).  Saving model ...
Epoch: 28 cost time: 0.6174883842468262
Epoch: 28, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.544 Vali Acc: 0.948 Test Loss: 0.544 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948143).  Saving model ...
Epoch: 29 cost time: 0.4264242649078369
Epoch: 29, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.510 Vali Acc: 0.952 Test Loss: 0.510 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 30 cost time: 0.43059372901916504
Epoch: 30, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.478 Vali Acc: 0.948 Test Loss: 0.478 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.39231443405151367
Epoch: 31, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.450 Vali Acc: 0.948 Test Loss: 0.450 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.39434123039245605
Epoch: 32, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.425 Vali Acc: 0.948 Test Loss: 0.425 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4011101722717285
Epoch: 33, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.402 Vali Acc: 0.948 Test Loss: 0.402 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.422191858291626
Epoch: 34, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.381 Vali Acc: 0.948 Test Loss: 0.381 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.37539148330688477
Epoch: 35, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.362 Vali Acc: 0.948 Test Loss: 0.362 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.43299317359924316
Epoch: 36, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.346 Vali Acc: 0.948 Test Loss: 0.346 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.45127224922180176
Epoch: 37, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.331 Vali Acc: 0.952 Test Loss: 0.331 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.451397180557251
Epoch: 38, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.318 Vali Acc: 0.952 Test Loss: 0.318 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.4118316173553467
Epoch: 39, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.306 Vali Acc: 0.956 Test Loss: 0.306 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.3962538242340088
Epoch: 40, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.295 Vali Acc: 0.956 Test Loss: 0.295 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 41 cost time: 0.42475461959838867
Epoch: 41, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.285 Vali Acc: 0.959 Test Loss: 0.285 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959256).  Saving model ...
Epoch: 42 cost time: 0.4073188304901123
Epoch: 42, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.277 Vali Acc: 0.959 Test Loss: 0.277 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 43 cost time: 0.37954258918762207
Epoch: 43, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.270 Vali Acc: 0.959 Test Loss: 0.270 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.4152250289916992
Epoch: 44, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.263 Vali Acc: 0.959 Test Loss: 0.263 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.40456223487854004
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.257 Vali Acc: 0.959 Test Loss: 0.257 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 46 cost time: 0.4256894588470459
Epoch: 46, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.252 Vali Acc: 0.959 Test Loss: 0.252 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.38772106170654297
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.959 Test Loss: 0.247 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.3800313472747803
Epoch: 48, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.40466904640197754
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.959 Test Loss: 0.238 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.37252116203308105
Epoch: 50, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 220294
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.648940086364746
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.795 Vali Acc: 0.148 Test Loss: 1.795 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.44229817390441895
Epoch: 2, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.781 Vali Acc: 0.193 Test Loss: 1.781 Test Acc: 0.193
Validation loss decreased (-0.148130 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.3847222328186035
Epoch: 3, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.769 Vali Acc: 0.211 Test Loss: 1.769 Test Acc: 0.211
Validation loss decreased (-0.192575 --> -0.211093).  Saving model ...
Epoch: 4 cost time: 0.3914790153503418
Epoch: 4, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.755 Vali Acc: 0.226 Test Loss: 1.755 Test Acc: 0.226
Validation loss decreased (-0.211093 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 0.45006418228149414
Epoch: 5, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.735 Vali Acc: 0.300 Test Loss: 1.735 Test Acc: 0.300
Validation loss decreased (-0.225908 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 0.4172964096069336
Epoch: 6, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.711 Vali Acc: 0.374 Test Loss: 1.711 Test Acc: 0.374
Validation loss decreased (-0.299983 --> -0.374057).  Saving model ...
Epoch: 7 cost time: 0.442624568939209
Epoch: 7, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.683 Vali Acc: 0.493 Test Loss: 1.683 Test Acc: 0.493
Validation loss decreased (-0.374057 --> -0.492576).  Saving model ...
Epoch: 8 cost time: 0.487628698348999
Epoch: 8, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.651 Vali Acc: 0.559 Test Loss: 1.651 Test Acc: 0.559
Validation loss decreased (-0.492576 --> -0.559243).  Saving model ...
Epoch: 9 cost time: 0.3937644958496094
Epoch: 9, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.614 Vali Acc: 0.604 Test Loss: 1.614 Test Acc: 0.604
Validation loss decreased (-0.559243 --> -0.603688).  Saving model ...
Epoch: 10 cost time: 0.47220945358276367
Epoch: 10, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.573 Vali Acc: 0.630 Test Loss: 1.573 Test Acc: 0.630
Validation loss decreased (-0.603688 --> -0.629614).  Saving model ...
Epoch: 11 cost time: 0.4974350929260254
Epoch: 11, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.528 Vali Acc: 0.674 Test Loss: 1.528 Test Acc: 0.674
Validation loss decreased (-0.629614 --> -0.674059).  Saving model ...
Epoch: 12 cost time: 0.38994359970092773
Epoch: 12, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.479 Vali Acc: 0.700 Test Loss: 1.479 Test Acc: 0.700
Validation loss decreased (-0.674059 --> -0.699985).  Saving model ...
Epoch: 13 cost time: 0.47742223739624023
Epoch: 13, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.427 Vali Acc: 0.744 Test Loss: 1.427 Test Acc: 0.744
Validation loss decreased (-0.699985 --> -0.744430).  Saving model ...
Epoch: 14 cost time: 0.4106929302215576
Epoch: 14, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.373 Vali Acc: 0.748 Test Loss: 1.373 Test Acc: 0.748
Validation loss decreased (-0.744430 --> -0.748134).  Saving model ...
Epoch: 15 cost time: 0.3842349052429199
Epoch: 15, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.317 Vali Acc: 0.781 Test Loss: 1.317 Test Acc: 0.781
Validation loss decreased (-0.748134 --> -0.781468).  Saving model ...
Epoch: 16 cost time: 0.3763926029205322
Epoch: 16, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.259 Vali Acc: 0.800 Test Loss: 1.259 Test Acc: 0.800
Validation loss decreased (-0.781468 --> -0.799987).  Saving model ...
Epoch: 17 cost time: 0.5363199710845947
Epoch: 17, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.200 Vali Acc: 0.811 Test Loss: 1.200 Test Acc: 0.811
Validation loss decreased (-0.799987 --> -0.811099).  Saving model ...
Epoch: 18 cost time: 0.45613980293273926
Epoch: 18, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.140 Vali Acc: 0.833 Test Loss: 1.140 Test Acc: 0.833
Validation loss decreased (-0.811099 --> -0.833322).  Saving model ...
Epoch: 19 cost time: 0.40592169761657715
Epoch: 19, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.080 Vali Acc: 0.848 Test Loss: 1.080 Test Acc: 0.848
Validation loss decreased (-0.833322 --> -0.848137).  Saving model ...
Epoch: 20 cost time: 0.40711045265197754
Epoch: 20, Steps: 2 | Train Loss: 0.848 Vali Loss: 1.022 Vali Acc: 0.863 Test Loss: 1.022 Test Acc: 0.863
Validation loss decreased (-0.848137 --> -0.862953).  Saving model ...
Epoch: 21 cost time: 0.3871617317199707
Epoch: 21, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.963 Vali Acc: 0.885 Test Loss: 0.963 Test Acc: 0.885
Validation loss decreased (-0.862953 --> -0.885176).  Saving model ...
Epoch: 22 cost time: 0.44978976249694824
Epoch: 22, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.907 Vali Acc: 0.900 Test Loss: 0.907 Test Acc: 0.900
Validation loss decreased (-0.885176 --> -0.899991).  Saving model ...
Epoch: 23 cost time: 0.4093468189239502
Epoch: 23, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.853 Vali Acc: 0.904 Test Loss: 0.853 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903695).  Saving model ...
Epoch: 24 cost time: 0.4777181148529053
Epoch: 24, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.802 Vali Acc: 0.904 Test Loss: 0.802 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903696).  Saving model ...
Epoch: 25 cost time: 0.38863348960876465
Epoch: 25, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.753 Vali Acc: 0.904 Test Loss: 0.753 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 26 cost time: 0.39959168434143066
Epoch: 26, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.707 Vali Acc: 0.904 Test Loss: 0.707 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 27 cost time: 0.4595813751220703
Epoch: 27, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.664 Vali Acc: 0.911 Test Loss: 0.664 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911104).  Saving model ...
Epoch: 28 cost time: 0.4133412837982178
Epoch: 28, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.623 Vali Acc: 0.911 Test Loss: 0.623 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 29 cost time: 0.5235941410064697
Epoch: 29, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.587 Vali Acc: 0.915 Test Loss: 0.587 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 30 cost time: 0.4277994632720947
Epoch: 30, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.553 Vali Acc: 0.919 Test Loss: 0.553 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 31 cost time: 0.5260355472564697
Epoch: 31, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 32 cost time: 0.4848463535308838
Epoch: 32, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.492 Vali Acc: 0.926 Test Loss: 0.492 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 33 cost time: 0.46328306198120117
Epoch: 33, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.466 Vali Acc: 0.926 Test Loss: 0.466 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 34 cost time: 0.4458019733428955
Epoch: 34, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.442 Vali Acc: 0.933 Test Loss: 0.442 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.4039492607116699
Epoch: 35, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.420 Vali Acc: 0.937 Test Loss: 0.420 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 36 cost time: 0.42853379249572754
Epoch: 36, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.400 Vali Acc: 0.937 Test Loss: 0.400 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.40691399574279785
Epoch: 37, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.383 Vali Acc: 0.937 Test Loss: 0.383 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.4060840606689453
Epoch: 38, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.367 Vali Acc: 0.937 Test Loss: 0.367 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 39 cost time: 0.45961451530456543
Epoch: 39, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.353 Vali Acc: 0.944 Test Loss: 0.353 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.47208333015441895
Epoch: 40, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 41 cost time: 0.3778872489929199
Epoch: 41, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.327 Vali Acc: 0.944 Test Loss: 0.327 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 42 cost time: 0.39182496070861816
Epoch: 42, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.317 Vali Acc: 0.944 Test Loss: 0.317 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 43 cost time: 0.4623231887817383
Epoch: 43, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 44 cost time: 0.4174630641937256
Epoch: 44, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.4159510135650635
Epoch: 45, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.4269707202911377
Epoch: 46, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.284 Vali Acc: 0.944 Test Loss: 0.284 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.4659891128540039
Epoch: 47, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4261927604675293
Epoch: 48, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4228801727294922
Epoch: 49, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4606161117553711
Epoch: 50, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 217478
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7292580604553223
Epoch: 1, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.778 Vali Acc: 0.226 Test Loss: 1.778 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.3906285762786865
Epoch: 2, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.747 Vali Acc: 0.244 Test Loss: 1.747 Test Acc: 0.244
Validation loss decreased (-0.225908 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 0.43697643280029297
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.718 Vali Acc: 0.311 Test Loss: 1.718 Test Acc: 0.311
Validation loss decreased (-0.244427 --> -0.311094).  Saving model ...
Epoch: 4 cost time: 0.4234330654144287
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.677 Vali Acc: 0.385 Test Loss: 1.677 Test Acc: 0.385
Validation loss decreased (-0.311094 --> -0.385168).  Saving model ...
Epoch: 5 cost time: 0.44182872772216797
Epoch: 5, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.625 Vali Acc: 0.485 Test Loss: 1.625 Test Acc: 0.485
Validation loss decreased (-0.385168 --> -0.485169).  Saving model ...
Epoch: 6 cost time: 0.36383557319641113
Epoch: 6, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.562 Vali Acc: 0.674 Test Loss: 1.562 Test Acc: 0.674
Validation loss decreased (-0.485169 --> -0.674058).  Saving model ...
Epoch: 7 cost time: 0.4001438617706299
Epoch: 7, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.490 Vali Acc: 0.789 Test Loss: 1.490 Test Acc: 0.789
Validation loss decreased (-0.674058 --> -0.788874).  Saving model ...
Epoch: 8 cost time: 0.44986462593078613
Epoch: 8, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.412 Vali Acc: 0.856 Test Loss: 1.412 Test Acc: 0.856
Validation loss decreased (-0.788874 --> -0.855541).  Saving model ...
Epoch: 9 cost time: 0.36460375785827637
Epoch: 9, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.327 Vali Acc: 0.881 Test Loss: 1.327 Test Acc: 0.881
Validation loss decreased (-0.855541 --> -0.881468).  Saving model ...
Epoch: 10 cost time: 0.39037203788757324
Epoch: 10, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.237 Vali Acc: 0.919 Test Loss: 1.237 Test Acc: 0.919
Validation loss decreased (-0.881468 --> -0.918506).  Saving model ...
Epoch: 11 cost time: 0.3932020664215088
Epoch: 11, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.145 Vali Acc: 0.922 Test Loss: 1.145 Test Acc: 0.922
Validation loss decreased (-0.918506 --> -0.922211).  Saving model ...
Epoch: 12 cost time: 0.4114201068878174
Epoch: 12, Steps: 2 | Train Loss: 0.884 Vali Loss: 1.050 Vali Acc: 0.933 Test Loss: 1.050 Test Acc: 0.933
Validation loss decreased (-0.922211 --> -0.933323).  Saving model ...
Epoch: 13 cost time: 0.39483094215393066
Epoch: 13, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.956 Vali Acc: 0.926 Test Loss: 0.956 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3706231117248535
Epoch: 14, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.863 Vali Acc: 0.930 Test Loss: 0.863 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.37776875495910645
Epoch: 15, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.773 Vali Acc: 0.930 Test Loss: 0.773 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4648618698120117
Epoch: 16, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.688 Vali Acc: 0.933 Test Loss: 0.688 Test Acc: 0.933
Validation loss decreased (-0.933323 --> -0.933326).  Saving model ...
Epoch: 17 cost time: 0.3929460048675537
Epoch: 17, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.609 Vali Acc: 0.948 Test Loss: 0.609 Test Acc: 0.948
Validation loss decreased (-0.933326 --> -0.948142).  Saving model ...
Epoch: 18 cost time: 0.3702547550201416
Epoch: 18, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.539 Vali Acc: 0.948 Test Loss: 0.539 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948143).  Saving model ...
Epoch: 19 cost time: 0.4662177562713623
Epoch: 19, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.478 Vali Acc: 0.948 Test Loss: 0.478 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 20 cost time: 0.37581849098205566
Epoch: 20, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.425 Vali Acc: 0.952 Test Loss: 0.425 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951848).  Saving model ...
Epoch: 21 cost time: 0.38911867141723633
Epoch: 21, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.381 Vali Acc: 0.952 Test Loss: 0.381 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 22 cost time: 0.36887049674987793
Epoch: 22, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.42113256454467773
Epoch: 23, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4035773277282715
Epoch: 24, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5009195804595947
Epoch: 25, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.3676424026489258
Epoch: 26, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.3693256378173828
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.3490877151489258
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.37479543685913086
Epoch: 29, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.42063355445861816
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.3860447406768799
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.4114696979522705
Epoch: 32, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.3681764602661133
Epoch: 33, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.397047758102417
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.3846304416656494
Epoch: 35, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.3735792636871338
Epoch: 36, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.3743247985839844
Epoch: 37, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.38367486000061035
Epoch: 38, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.3912980556488037
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.40790438652038574
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.38686275482177734
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4378397464752197
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 43 cost time: 0.4026038646697998
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 44 cost time: 0.4052267074584961
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 45 cost time: 0.42900967597961426
Epoch: 45, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4067530632019043
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.3727738857269287
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.3557736873626709
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.42084717750549316
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 50 cost time: 0.4195864200592041
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 107750
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.682438611984253
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.763 Vali Acc: 0.211 Test Loss: 1.763 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.41623854637145996
Epoch: 2, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.739 Vali Acc: 0.256 Test Loss: 1.739 Test Acc: 0.256
Validation loss decreased (-0.211093 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.40116214752197266
Epoch: 3, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.718 Vali Acc: 0.278 Test Loss: 1.718 Test Acc: 0.278
Validation loss decreased (-0.255538 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.46713685989379883
Epoch: 4, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.693 Vali Acc: 0.307 Test Loss: 1.693 Test Acc: 0.307
Validation loss decreased (-0.277761 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.3776676654815674
Epoch: 5, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.661 Vali Acc: 0.352 Test Loss: 1.661 Test Acc: 0.352
Validation loss decreased (-0.307390 --> -0.351835).  Saving model ...
Epoch: 6 cost time: 0.35974955558776855
Epoch: 6, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.621 Vali Acc: 0.496 Test Loss: 1.621 Test Acc: 0.496
Validation loss decreased (-0.351835 --> -0.496280).  Saving model ...
Epoch: 7 cost time: 0.4203934669494629
Epoch: 7, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.575 Vali Acc: 0.619 Test Loss: 1.575 Test Acc: 0.619
Validation loss decreased (-0.496280 --> -0.618503).  Saving model ...
Epoch: 8 cost time: 0.409595251083374
Epoch: 8, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.524 Vali Acc: 0.678 Test Loss: 1.524 Test Acc: 0.678
Validation loss decreased (-0.618503 --> -0.677763).  Saving model ...
Epoch: 9 cost time: 0.4070713520050049
Epoch: 9, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.467 Vali Acc: 0.741 Test Loss: 1.467 Test Acc: 0.741
Validation loss decreased (-0.677763 --> -0.740726).  Saving model ...
Epoch: 10 cost time: 0.4669783115386963
Epoch: 10, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.407 Vali Acc: 0.778 Test Loss: 1.407 Test Acc: 0.778
Validation loss decreased (-0.740726 --> -0.777764).  Saving model ...
Epoch: 11 cost time: 0.39161086082458496
Epoch: 11, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.342 Vali Acc: 0.822 Test Loss: 1.342 Test Acc: 0.822
Validation loss decreased (-0.777764 --> -0.822209).  Saving model ...
Epoch: 12 cost time: 0.37213945388793945
Epoch: 12, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.276 Vali Acc: 0.848 Test Loss: 1.276 Test Acc: 0.848
Validation loss decreased (-0.822209 --> -0.848135).  Saving model ...
Epoch: 13 cost time: 0.390380859375
Epoch: 13, Steps: 2 | Train Loss: 1.045 Vali Loss: 1.207 Vali Acc: 0.870 Test Loss: 1.207 Test Acc: 0.870
Validation loss decreased (-0.848135 --> -0.870358).  Saving model ...
Epoch: 14 cost time: 0.35689830780029297
Epoch: 14, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.138 Vali Acc: 0.878 Test Loss: 1.138 Test Acc: 0.878
Validation loss decreased (-0.870358 --> -0.877766).  Saving model ...
Epoch: 15 cost time: 0.3725590705871582
Epoch: 15, Steps: 2 | Train Loss: 0.894 Vali Loss: 1.067 Vali Acc: 0.893 Test Loss: 1.067 Test Acc: 0.893
Validation loss decreased (-0.877766 --> -0.892582).  Saving model ...
Epoch: 16 cost time: 0.3769497871398926
Epoch: 16, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.996 Vali Acc: 0.896 Test Loss: 0.996 Test Acc: 0.896
Validation loss decreased (-0.892582 --> -0.896286).  Saving model ...
Epoch: 17 cost time: 0.43168210983276367
Epoch: 17, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.927 Vali Acc: 0.900 Test Loss: 0.927 Test Acc: 0.900
Validation loss decreased (-0.896286 --> -0.899991).  Saving model ...
Epoch: 18 cost time: 0.3424673080444336
Epoch: 18, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.860 Vali Acc: 0.907 Test Loss: 0.860 Test Acc: 0.907
Validation loss decreased (-0.899991 --> -0.907399).  Saving model ...
Epoch: 19 cost time: 0.33596372604370117
Epoch: 19, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.795 Vali Acc: 0.907 Test Loss: 0.795 Test Acc: 0.907
Validation loss decreased (-0.907399 --> -0.907399).  Saving model ...
Epoch: 20 cost time: 0.41620588302612305
Epoch: 20, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.733 Vali Acc: 0.915 Test Loss: 0.733 Test Acc: 0.915
Validation loss decreased (-0.907399 --> -0.914807).  Saving model ...
Epoch: 21 cost time: 0.3614199161529541
Epoch: 21, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.674 Vali Acc: 0.915 Test Loss: 0.674 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 22 cost time: 0.4058041572570801
Epoch: 22, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.619 Vali Acc: 0.926 Test Loss: 0.619 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 23 cost time: 0.37452054023742676
Epoch: 23, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.567 Vali Acc: 0.930 Test Loss: 0.567 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.43459296226501465
Epoch: 24, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.522 Vali Acc: 0.930 Test Loss: 0.522 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 25 cost time: 0.3750619888305664
Epoch: 25, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.480 Vali Acc: 0.933 Test Loss: 0.480 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933329).  Saving model ...
Epoch: 26 cost time: 0.42905664443969727
Epoch: 26, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.444 Vali Acc: 0.933 Test Loss: 0.444 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 27 cost time: 0.3881831169128418
Epoch: 27, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.412 Vali Acc: 0.933 Test Loss: 0.412 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 28 cost time: 0.370741605758667
Epoch: 28, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 29 cost time: 0.46109604835510254
Epoch: 29, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.361 Vali Acc: 0.937 Test Loss: 0.361 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.36152124404907227
Epoch: 30, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 31 cost time: 0.36208367347717285
Epoch: 31, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5180094242095947
Epoch: 32, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.352203369140625
Epoch: 33, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.41204047203063965
Epoch: 34, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.4068746566772461
Epoch: 35, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.3893141746520996
Epoch: 36, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.3833918571472168
Epoch: 37, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.4324805736541748
Epoch: 38, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.41935205459594727
Epoch: 39, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.3912835121154785
Epoch: 40, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.36070871353149414
Epoch: 41, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.3594489097595215
Epoch: 42, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.3737516403198242
Epoch: 43, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.36290502548217773
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.4026656150817871
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.948 Test Loss: 0.220 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.3739314079284668
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.41499948501586914
Epoch: 47, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.43114185333251953
Epoch: 48, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.3749382495880127
Epoch: 49, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4063742160797119
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 81702
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5503950119018555
Epoch: 1, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.721 Vali Acc: 0.330 Test Loss: 1.721 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.4389939308166504
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.703 Vali Acc: 0.374 Test Loss: 1.703 Test Acc: 0.374
Validation loss decreased (-0.329612 --> -0.374057).  Saving model ...
Epoch: 3 cost time: 0.3342468738555908
Epoch: 3, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.688 Vali Acc: 0.407 Test Loss: 1.688 Test Acc: 0.407
Validation loss decreased (-0.374057 --> -0.407391).  Saving model ...
Epoch: 4 cost time: 0.3837568759918213
Epoch: 4, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.672 Vali Acc: 0.459 Test Loss: 1.672 Test Acc: 0.459
Validation loss decreased (-0.407391 --> -0.459243).  Saving model ...
Epoch: 5 cost time: 0.3533437252044678
Epoch: 5, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.650 Vali Acc: 0.500 Test Loss: 1.650 Test Acc: 0.500
Validation loss decreased (-0.459243 --> -0.499984).  Saving model ...
Epoch: 6 cost time: 0.3575127124786377
Epoch: 6, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.622 Vali Acc: 0.533 Test Loss: 1.622 Test Acc: 0.533
Validation loss decreased (-0.499984 --> -0.533317).  Saving model ...
Epoch: 7 cost time: 0.3479030132293701
Epoch: 7, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.590 Vali Acc: 0.581 Test Loss: 1.590 Test Acc: 0.581
Validation loss decreased (-0.533317 --> -0.581466).  Saving model ...
Epoch: 8 cost time: 0.39328598976135254
Epoch: 8, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.553 Vali Acc: 0.626 Test Loss: 1.553 Test Acc: 0.626
Validation loss decreased (-0.581466 --> -0.625910).  Saving model ...
Epoch: 9 cost time: 0.39977574348449707
Epoch: 9, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.513 Vali Acc: 0.685 Test Loss: 1.513 Test Acc: 0.685
Validation loss decreased (-0.625910 --> -0.685170).  Saving model ...
Epoch: 10 cost time: 0.347353458404541
Epoch: 10, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.468 Vali Acc: 0.719 Test Loss: 1.468 Test Acc: 0.719
Validation loss decreased (-0.685170 --> -0.718504).  Saving model ...
Epoch: 11 cost time: 0.36531543731689453
Epoch: 11, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.420 Vali Acc: 0.733 Test Loss: 1.420 Test Acc: 0.733
Validation loss decreased (-0.718504 --> -0.733319).  Saving model ...
Epoch: 12 cost time: 0.3553345203399658
Epoch: 12, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.370 Vali Acc: 0.763 Test Loss: 1.370 Test Acc: 0.763
Validation loss decreased (-0.733319 --> -0.762949).  Saving model ...
Epoch: 13 cost time: 0.4381837844848633
Epoch: 13, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.317 Vali Acc: 0.781 Test Loss: 1.317 Test Acc: 0.781
Validation loss decreased (-0.762949 --> -0.781468).  Saving model ...
Epoch: 14 cost time: 0.32507920265197754
Epoch: 14, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.262 Vali Acc: 0.800 Test Loss: 1.262 Test Acc: 0.800
Validation loss decreased (-0.781468 --> -0.799987).  Saving model ...
Epoch: 15 cost time: 0.321521520614624
Epoch: 15, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.204 Vali Acc: 0.811 Test Loss: 1.204 Test Acc: 0.811
Validation loss decreased (-0.799987 --> -0.811099).  Saving model ...
Epoch: 16 cost time: 0.36078643798828125
Epoch: 16, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.144 Vali Acc: 0.844 Test Loss: 1.144 Test Acc: 0.844
Validation loss decreased (-0.811099 --> -0.844433).  Saving model ...
Epoch: 17 cost time: 0.3364112377166748
Epoch: 17, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.082 Vali Acc: 0.852 Test Loss: 1.082 Test Acc: 0.852
Validation loss decreased (-0.844433 --> -0.851841).  Saving model ...
Epoch: 18 cost time: 0.3633604049682617
Epoch: 18, Steps: 2 | Train Loss: 0.902 Vali Loss: 1.021 Vali Acc: 0.852 Test Loss: 1.021 Test Acc: 0.852
Validation loss decreased (-0.851841 --> -0.851842).  Saving model ...
Epoch: 19 cost time: 0.345212459564209
Epoch: 19, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.961 Vali Acc: 0.874 Test Loss: 0.961 Test Acc: 0.874
Validation loss decreased (-0.851842 --> -0.874064).  Saving model ...
Epoch: 20 cost time: 0.33309507369995117
Epoch: 20, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.902 Vali Acc: 0.889 Test Loss: 0.902 Test Acc: 0.889
Validation loss decreased (-0.874064 --> -0.888880).  Saving model ...
Epoch: 21 cost time: 0.38770484924316406
Epoch: 21, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.844 Vali Acc: 0.904 Test Loss: 0.844 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903695).  Saving model ...
Epoch: 22 cost time: 0.3407011032104492
Epoch: 22, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.788 Vali Acc: 0.911 Test Loss: 0.788 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911103).  Saving model ...
Epoch: 23 cost time: 0.3899083137512207
Epoch: 23, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.735 Vali Acc: 0.915 Test Loss: 0.735 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 24 cost time: 0.33121371269226074
Epoch: 24, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.686 Vali Acc: 0.907 Test Loss: 0.686 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.39087533950805664
Epoch: 25, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.639 Vali Acc: 0.907 Test Loss: 0.639 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.3289639949798584
Epoch: 26, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.595 Vali Acc: 0.922 Test Loss: 0.595 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922216).  Saving model ...
Epoch: 27 cost time: 0.4509124755859375
Epoch: 27, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.556 Vali Acc: 0.926 Test Loss: 0.556 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 28 cost time: 0.3366844654083252
Epoch: 28, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.519 Vali Acc: 0.941 Test Loss: 0.519 Test Acc: 0.941
Validation loss decreased (-0.925920 --> -0.940736).  Saving model ...
Epoch: 29 cost time: 0.35915350914001465
Epoch: 29, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.486 Vali Acc: 0.944 Test Loss: 0.486 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 30 cost time: 0.3346850872039795
Epoch: 30, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.455 Vali Acc: 0.944 Test Loss: 0.455 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 31 cost time: 0.3887507915496826
Epoch: 31, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.428 Vali Acc: 0.944 Test Loss: 0.428 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 32 cost time: 0.3620119094848633
Epoch: 32, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.403 Vali Acc: 0.948 Test Loss: 0.403 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 33 cost time: 0.34947919845581055
Epoch: 33, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.381 Vali Acc: 0.948 Test Loss: 0.381 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 34 cost time: 0.3811221122741699
Epoch: 34, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.361 Vali Acc: 0.948 Test Loss: 0.361 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 35 cost time: 0.37123918533325195
Epoch: 35, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.344 Vali Acc: 0.948 Test Loss: 0.344 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 36 cost time: 0.35239720344543457
Epoch: 36, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.329 Vali Acc: 0.948 Test Loss: 0.329 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 37 cost time: 0.41300201416015625
Epoch: 37, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.32379865646362305
Epoch: 38, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4223358631134033
Epoch: 39, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.42038416862487793
Epoch: 40, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.38944482803344727
Epoch: 41, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.37801170349121094
Epoch: 42, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.3879718780517578
Epoch: 43, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.39838218688964844
Epoch: 44, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.3328244686126709
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.340484619140625
Epoch: 46, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 74054
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6464743614196777
Epoch: 1, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.765 Vali Acc: 0.270 Test Loss: 1.765 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.4129641056060791
Epoch: 2, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.750 Vali Acc: 0.319 Test Loss: 1.750 Test Acc: 0.319
Validation loss decreased (-0.270353 --> -0.318501).  Saving model ...
Epoch: 3 cost time: 0.4258580207824707
Epoch: 3, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.737 Vali Acc: 0.374 Test Loss: 1.737 Test Acc: 0.374
Validation loss decreased (-0.318501 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.35859060287475586
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.724 Vali Acc: 0.411 Test Loss: 1.724 Test Acc: 0.411
Validation loss decreased (-0.374057 --> -0.411094).  Saving model ...
Epoch: 5 cost time: 0.4479210376739502
Epoch: 5, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.706 Vali Acc: 0.474 Test Loss: 1.706 Test Acc: 0.474
Validation loss decreased (-0.411094 --> -0.474057).  Saving model ...
Epoch: 6 cost time: 0.367875337600708
Epoch: 6, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.684 Vali Acc: 0.504 Test Loss: 1.684 Test Acc: 0.504
Validation loss decreased (-0.474057 --> -0.503687).  Saving model ...
Epoch: 7 cost time: 0.39942026138305664
Epoch: 7, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.659 Vali Acc: 0.570 Test Loss: 1.659 Test Acc: 0.570
Validation loss decreased (-0.503687 --> -0.570354).  Saving model ...
Epoch: 8 cost time: 0.3939485549926758
Epoch: 8, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.629 Vali Acc: 0.633 Test Loss: 1.629 Test Acc: 0.633
Validation loss decreased (-0.570354 --> -0.633317).  Saving model ...
Epoch: 9 cost time: 0.37899184226989746
Epoch: 9, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.596 Vali Acc: 0.674 Test Loss: 1.596 Test Acc: 0.674
Validation loss decreased (-0.633317 --> -0.674058).  Saving model ...
Epoch: 10 cost time: 0.38016700744628906
Epoch: 10, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.559 Vali Acc: 0.711 Test Loss: 1.559 Test Acc: 0.711
Validation loss decreased (-0.674058 --> -0.711096).  Saving model ...
Epoch: 11 cost time: 0.37511253356933594
Epoch: 11, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.520 Vali Acc: 0.744 Test Loss: 1.520 Test Acc: 0.744
Validation loss decreased (-0.711096 --> -0.744429).  Saving model ...
Epoch: 12 cost time: 0.43894171714782715
Epoch: 12, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.478 Vali Acc: 0.774 Test Loss: 1.478 Test Acc: 0.774
Validation loss decreased (-0.744429 --> -0.774059).  Saving model ...
Epoch: 13 cost time: 0.4000082015991211
Epoch: 13, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.434 Vali Acc: 0.785 Test Loss: 1.434 Test Acc: 0.785
Validation loss decreased (-0.774059 --> -0.785171).  Saving model ...
Epoch: 14 cost time: 0.4169430732727051
Epoch: 14, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.387 Vali Acc: 0.807 Test Loss: 1.387 Test Acc: 0.807
Validation loss decreased (-0.785171 --> -0.807394).  Saving model ...
Epoch: 15 cost time: 0.35991573333740234
Epoch: 15, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.339 Vali Acc: 0.841 Test Loss: 1.339 Test Acc: 0.841
Validation loss decreased (-0.807394 --> -0.840727).  Saving model ...
Epoch: 16 cost time: 0.4021263122558594
Epoch: 16, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.288 Vali Acc: 0.856 Test Loss: 1.288 Test Acc: 0.856
Validation loss decreased (-0.840727 --> -0.855543).  Saving model ...
Epoch: 17 cost time: 0.40801024436950684
Epoch: 17, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.238 Vali Acc: 0.867 Test Loss: 1.238 Test Acc: 0.867
Validation loss decreased (-0.855543 --> -0.866654).  Saving model ...
Epoch: 18 cost time: 0.35334300994873047
Epoch: 18, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.186 Vali Acc: 0.870 Test Loss: 1.186 Test Acc: 0.870
Validation loss decreased (-0.866654 --> -0.870359).  Saving model ...
Epoch: 19 cost time: 0.4352271556854248
Epoch: 19, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.133 Vali Acc: 0.874 Test Loss: 1.133 Test Acc: 0.874
Validation loss decreased (-0.870359 --> -0.874063).  Saving model ...
Epoch: 20 cost time: 0.3783750534057617
Epoch: 20, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.079 Vali Acc: 0.881 Test Loss: 1.079 Test Acc: 0.881
Validation loss decreased (-0.874063 --> -0.881471).  Saving model ...
Epoch: 21 cost time: 0.4902634620666504
Epoch: 21, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.025 Vali Acc: 0.889 Test Loss: 1.025 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888879).  Saving model ...
Epoch: 22 cost time: 0.3667917251586914
Epoch: 22, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.972 Vali Acc: 0.893 Test Loss: 0.972 Test Acc: 0.893
Validation loss decreased (-0.888879 --> -0.892583).  Saving model ...
Epoch: 23 cost time: 0.4235396385192871
Epoch: 23, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.920 Vali Acc: 0.889 Test Loss: 0.920 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.38318634033203125
Epoch: 24, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.868 Vali Acc: 0.889 Test Loss: 0.868 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.40353894233703613
Epoch: 25, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.819 Vali Acc: 0.889 Test Loss: 0.819 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.435258150100708
Epoch: 26, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.771 Vali Acc: 0.896 Test Loss: 0.771 Test Acc: 0.896
Validation loss decreased (-0.892583 --> -0.896289).  Saving model ...
Epoch: 27 cost time: 0.3670315742492676
Epoch: 27, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.726 Vali Acc: 0.896 Test Loss: 0.726 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896289).  Saving model ...
Epoch: 28 cost time: 0.4091477394104004
Epoch: 28, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.4008800983428955
Epoch: 29, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.643 Vali Acc: 0.907 Test Loss: 0.643 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 30 cost time: 0.36617136001586914
Epoch: 30, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.607 Vali Acc: 0.907 Test Loss: 0.607 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 31 cost time: 0.40497541427612305
Epoch: 31, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.573 Vali Acc: 0.907 Test Loss: 0.573 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 32 cost time: 0.3869798183441162
Epoch: 32, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.541 Vali Acc: 0.915 Test Loss: 0.541 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 33 cost time: 0.427997350692749
Epoch: 33, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.513 Vali Acc: 0.915 Test Loss: 0.513 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 34 cost time: 0.3599395751953125
Epoch: 34, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.486 Vali Acc: 0.919 Test Loss: 0.486 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 35 cost time: 0.4487121105194092
Epoch: 35, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.462 Vali Acc: 0.922 Test Loss: 0.462 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 36 cost time: 0.4118926525115967
Epoch: 36, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.440 Vali Acc: 0.922 Test Loss: 0.440 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 37 cost time: 0.3622620105743408
Epoch: 37, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.420 Vali Acc: 0.926 Test Loss: 0.420 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 38 cost time: 0.3991076946258545
Epoch: 38, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4479176998138428
Epoch: 39, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.385 Vali Acc: 0.926 Test Loss: 0.385 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 40 cost time: 0.3632204532623291
Epoch: 40, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 41 cost time: 0.4831666946411133
Epoch: 41, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 42 cost time: 0.41346073150634766
Epoch: 42, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.343 Vali Acc: 0.933 Test Loss: 0.343 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 43 cost time: 0.36821818351745605
Epoch: 43, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 44 cost time: 0.38748764991760254
Epoch: 44, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 45 cost time: 0.4600186347961426
Epoch: 45, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 46 cost time: 0.3813183307647705
Epoch: 46, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 47 cost time: 0.3970835208892822
Epoch: 47, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 48 cost time: 0.39827680587768555
Epoch: 48, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 49 cost time: 0.36569929122924805
Epoch: 49, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.3699626922607422
Epoch: 50, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 69510
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.566948413848877
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.815 Vali Acc: 0.111 Test Loss: 1.815 Test Acc: 0.111
Validation loss decreased (inf --> -0.111093).  Saving model ...
Epoch: 2 cost time: 0.3705470561981201
Epoch: 2, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.807 Vali Acc: 0.104 Test Loss: 1.807 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4457671642303467
Epoch: 3, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.799 Vali Acc: 0.096 Test Loss: 1.799 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4461953639984131
Epoch: 4, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.791 Vali Acc: 0.096 Test Loss: 1.791 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3884146213531494
Epoch: 5, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.780 Vali Acc: 0.089 Test Loss: 1.780 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.455364465713501
Epoch: 6, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.765 Vali Acc: 0.119 Test Loss: 1.765 Test Acc: 0.119
Validation loss decreased (-0.111093 --> -0.118501).  Saving model ...
Epoch: 7 cost time: 0.4500095844268799
Epoch: 7, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.747 Vali Acc: 0.185 Test Loss: 1.747 Test Acc: 0.185
Validation loss decreased (-0.118501 --> -0.185168).  Saving model ...
Epoch: 8 cost time: 0.42282891273498535
Epoch: 8, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.726 Vali Acc: 0.278 Test Loss: 1.726 Test Acc: 0.278
Validation loss decreased (-0.185168 --> -0.277761).  Saving model ...
Epoch: 9 cost time: 0.36525511741638184
Epoch: 9, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.704 Vali Acc: 0.363 Test Loss: 1.704 Test Acc: 0.363
Validation loss decreased (-0.277761 --> -0.362946).  Saving model ...
Epoch: 10 cost time: 0.4176054000854492
Epoch: 10, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.678 Vali Acc: 0.407 Test Loss: 1.678 Test Acc: 0.407
Validation loss decreased (-0.362946 --> -0.407391).  Saving model ...
Epoch: 11 cost time: 0.4313082695007324
Epoch: 11, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.650 Vali Acc: 0.456 Test Loss: 1.650 Test Acc: 0.456
Validation loss decreased (-0.407391 --> -0.455539).  Saving model ...
Epoch: 12 cost time: 0.4417741298675537
Epoch: 12, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.621 Vali Acc: 0.537 Test Loss: 1.621 Test Acc: 0.537
Validation loss decreased (-0.455539 --> -0.537021).  Saving model ...
Epoch: 13 cost time: 0.41449832916259766
Epoch: 13, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.590 Vali Acc: 0.626 Test Loss: 1.590 Test Acc: 0.626
Validation loss decreased (-0.537021 --> -0.625910).  Saving model ...
Epoch: 14 cost time: 0.3676137924194336
Epoch: 14, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.558 Vali Acc: 0.659 Test Loss: 1.558 Test Acc: 0.659
Validation loss decreased (-0.625910 --> -0.659244).  Saving model ...
Epoch: 15 cost time: 0.35574793815612793
Epoch: 15, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.524 Vali Acc: 0.696 Test Loss: 1.524 Test Acc: 0.696
Validation loss decreased (-0.659244 --> -0.696281).  Saving model ...
Epoch: 16 cost time: 0.4191162586212158
Epoch: 16, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.489 Vali Acc: 0.741 Test Loss: 1.489 Test Acc: 0.741
Validation loss decreased (-0.696281 --> -0.740726).  Saving model ...
Epoch: 17 cost time: 0.3840506076812744
Epoch: 17, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.452 Vali Acc: 0.793 Test Loss: 1.452 Test Acc: 0.793
Validation loss decreased (-0.740726 --> -0.792578).  Saving model ...
Epoch: 18 cost time: 0.3968508243560791
Epoch: 18, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.413 Vali Acc: 0.793 Test Loss: 1.413 Test Acc: 0.793
Validation loss decreased (-0.792578 --> -0.792578).  Saving model ...
Epoch: 19 cost time: 0.39047884941101074
Epoch: 19, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.372 Vali Acc: 0.822 Test Loss: 1.372 Test Acc: 0.822
Validation loss decreased (-0.792578 --> -0.822208).  Saving model ...
Epoch: 20 cost time: 0.38611721992492676
Epoch: 20, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.331 Vali Acc: 0.856 Test Loss: 1.331 Test Acc: 0.856
Validation loss decreased (-0.822208 --> -0.855542).  Saving model ...
Epoch: 21 cost time: 0.40219783782958984
Epoch: 21, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.288 Vali Acc: 0.881 Test Loss: 1.288 Test Acc: 0.881
Validation loss decreased (-0.855542 --> -0.881469).  Saving model ...
Epoch: 22 cost time: 0.4019813537597656
Epoch: 22, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.244 Vali Acc: 0.893 Test Loss: 1.244 Test Acc: 0.893
Validation loss decreased (-0.881469 --> -0.892580).  Saving model ...
Epoch: 23 cost time: 0.37453484535217285
Epoch: 23, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.200 Vali Acc: 0.900 Test Loss: 1.200 Test Acc: 0.900
Validation loss decreased (-0.892580 --> -0.899988).  Saving model ...
Epoch: 24 cost time: 0.42122650146484375
Epoch: 24, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.156 Vali Acc: 0.915 Test Loss: 1.156 Test Acc: 0.915
Validation loss decreased (-0.899988 --> -0.914803).  Saving model ...
Epoch: 25 cost time: 0.39348506927490234
Epoch: 25, Steps: 2 | Train Loss: 0.950 Vali Loss: 1.111 Vali Acc: 0.930 Test Loss: 1.111 Test Acc: 0.930
Validation loss decreased (-0.914803 --> -0.929619).  Saving model ...
Epoch: 26 cost time: 0.39934849739074707
Epoch: 26, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.065 Vali Acc: 0.937 Test Loss: 1.065 Test Acc: 0.937
Validation loss decreased (-0.929619 --> -0.937026).  Saving model ...
Epoch: 27 cost time: 0.39212536811828613
Epoch: 27, Steps: 2 | Train Loss: 0.858 Vali Loss: 1.019 Vali Acc: 0.944 Test Loss: 1.019 Test Acc: 0.944
Validation loss decreased (-0.937026 --> -0.944434).  Saving model ...
Epoch: 28 cost time: 0.3981907367706299
Epoch: 28, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.974 Vali Acc: 0.944 Test Loss: 0.974 Test Acc: 0.944
Validation loss decreased (-0.944434 --> -0.944435).  Saving model ...
Epoch: 29 cost time: 0.36179447174072266
Epoch: 29, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.929 Vali Acc: 0.948 Test Loss: 0.929 Test Acc: 0.948
Validation loss decreased (-0.944435 --> -0.948139).  Saving model ...
Epoch: 30 cost time: 0.3595011234283447
Epoch: 30, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.886 Vali Acc: 0.948 Test Loss: 0.886 Test Acc: 0.948
Validation loss decreased (-0.948139 --> -0.948139).  Saving model ...
Epoch: 31 cost time: 0.41423630714416504
Epoch: 31, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.842 Vali Acc: 0.948 Test Loss: 0.842 Test Acc: 0.948
Validation loss decreased (-0.948139 --> -0.948140).  Saving model ...
Epoch: 32 cost time: 0.42567992210388184
Epoch: 32, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.801 Vali Acc: 0.948 Test Loss: 0.801 Test Acc: 0.948
Validation loss decreased (-0.948140 --> -0.948140).  Saving model ...
Epoch: 33 cost time: 0.38117504119873047
Epoch: 33, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.761 Vali Acc: 0.956 Test Loss: 0.761 Test Acc: 0.956
Validation loss decreased (-0.948140 --> -0.955548).  Saving model ...
Epoch: 34 cost time: 0.4572765827178955
Epoch: 34, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.722 Vali Acc: 0.956 Test Loss: 0.722 Test Acc: 0.956
Validation loss decreased (-0.955548 --> -0.955548).  Saving model ...
Epoch: 35 cost time: 0.402132511138916
Epoch: 35, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.686 Vali Acc: 0.956 Test Loss: 0.686 Test Acc: 0.956
Validation loss decreased (-0.955548 --> -0.955549).  Saving model ...
Epoch: 36 cost time: 0.3780207633972168
Epoch: 36, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.651 Vali Acc: 0.956 Test Loss: 0.651 Test Acc: 0.956
Validation loss decreased (-0.955549 --> -0.955549).  Saving model ...
Epoch: 37 cost time: 0.378737211227417
Epoch: 37, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.618 Vali Acc: 0.956 Test Loss: 0.618 Test Acc: 0.956
Validation loss decreased (-0.955549 --> -0.955549).  Saving model ...
Epoch: 38 cost time: 0.3624584674835205
Epoch: 38, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.587 Vali Acc: 0.956 Test Loss: 0.587 Test Acc: 0.956
Validation loss decreased (-0.955549 --> -0.955550).  Saving model ...
Epoch: 39 cost time: 0.3675563335418701
Epoch: 39, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.558 Vali Acc: 0.956 Test Loss: 0.558 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955550).  Saving model ...
Epoch: 40 cost time: 0.41661500930786133
Epoch: 40, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.532 Vali Acc: 0.956 Test Loss: 0.532 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955550).  Saving model ...
Epoch: 41 cost time: 0.4122154712677002
Epoch: 41, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.506 Vali Acc: 0.956 Test Loss: 0.506 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955550).  Saving model ...
Epoch: 42 cost time: 0.4435253143310547
Epoch: 42, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.483 Vali Acc: 0.956 Test Loss: 0.483 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955551).  Saving model ...
Epoch: 43 cost time: 0.3735051155090332
Epoch: 43, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.461 Vali Acc: 0.956 Test Loss: 0.461 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 44 cost time: 0.36606669425964355
Epoch: 44, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.441 Vali Acc: 0.956 Test Loss: 0.441 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 45 cost time: 0.37953853607177734
Epoch: 45, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.422 Vali Acc: 0.959 Test Loss: 0.422 Test Acc: 0.959
Validation loss decreased (-0.955551 --> -0.959255).  Saving model ...
Epoch: 46 cost time: 0.3650999069213867
Epoch: 46, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.406 Vali Acc: 0.956 Test Loss: 0.406 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.3623015880584717
Epoch: 47, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.390 Vali Acc: 0.956 Test Loss: 0.390 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.3793509006500244
Epoch: 48, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.375 Vali Acc: 0.956 Test Loss: 0.375 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.3918650150299072
Epoch: 49, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.362 Vali Acc: 0.956 Test Loss: 0.362 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.43440985679626465
Epoch: 50, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.350 Vali Acc: 0.956 Test Loss: 0.350 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 68070
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5119829177856445
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.793 Vali Acc: 0.156 Test Loss: 1.793 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.359177827835083
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.785 Vali Acc: 0.159 Test Loss: 1.785 Test Acc: 0.159
Validation loss decreased (-0.155538 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.3643667697906494
Epoch: 3, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.778 Vali Acc: 0.163 Test Loss: 1.778 Test Acc: 0.163
Validation loss decreased (-0.159241 --> -0.162945).  Saving model ...
Epoch: 4 cost time: 0.367969274520874
Epoch: 4, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.772 Vali Acc: 0.163 Test Loss: 1.772 Test Acc: 0.163
Validation loss decreased (-0.162945 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.3460676670074463
Epoch: 5, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.763 Vali Acc: 0.174 Test Loss: 1.763 Test Acc: 0.174
Validation loss decreased (-0.162945 --> -0.174056).  Saving model ...
Epoch: 6 cost time: 0.3427753448486328
Epoch: 6, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.752 Vali Acc: 0.181 Test Loss: 1.752 Test Acc: 0.181
Validation loss decreased (-0.174056 --> -0.181464).  Saving model ...
Epoch: 7 cost time: 0.42893052101135254
Epoch: 7, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.739 Vali Acc: 0.204 Test Loss: 1.739 Test Acc: 0.204
Validation loss decreased (-0.181464 --> -0.203686).  Saving model ...
Epoch: 8 cost time: 0.3604695796966553
Epoch: 8, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.723 Vali Acc: 0.237 Test Loss: 1.723 Test Acc: 0.237
Validation loss decreased (-0.203686 --> -0.237020).  Saving model ...
Epoch: 9 cost time: 0.3951146602630615
Epoch: 9, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.706 Vali Acc: 0.259 Test Loss: 1.706 Test Acc: 0.259
Validation loss decreased (-0.237020 --> -0.259242).  Saving model ...
Epoch: 10 cost time: 0.4375929832458496
Epoch: 10, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.686 Vali Acc: 0.278 Test Loss: 1.686 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277761).  Saving model ...
Epoch: 11 cost time: 0.34561705589294434
Epoch: 11, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.665 Vali Acc: 0.356 Test Loss: 1.665 Test Acc: 0.356
Validation loss decreased (-0.277761 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.35721492767333984
Epoch: 12, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.641 Vali Acc: 0.463 Test Loss: 1.641 Test Acc: 0.463
Validation loss decreased (-0.355539 --> -0.462947).  Saving model ...
Epoch: 13 cost time: 0.4624016284942627
Epoch: 13, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.616 Vali Acc: 0.544 Test Loss: 1.616 Test Acc: 0.544
Validation loss decreased (-0.462947 --> -0.544428).  Saving model ...
Epoch: 14 cost time: 0.3993959426879883
Epoch: 14, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.588 Vali Acc: 0.585 Test Loss: 1.588 Test Acc: 0.585
Validation loss decreased (-0.544428 --> -0.585169).  Saving model ...
Epoch: 15 cost time: 0.391495943069458
Epoch: 15, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.560 Vali Acc: 0.630 Test Loss: 1.560 Test Acc: 0.630
Validation loss decreased (-0.585169 --> -0.629614).  Saving model ...
Epoch: 16 cost time: 0.36270570755004883
Epoch: 16, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.530 Vali Acc: 0.656 Test Loss: 1.530 Test Acc: 0.656
Validation loss decreased (-0.629614 --> -0.655540).  Saving model ...
Epoch: 17 cost time: 0.36513233184814453
Epoch: 17, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.499 Vali Acc: 0.689 Test Loss: 1.499 Test Acc: 0.689
Validation loss decreased (-0.655540 --> -0.688874).  Saving model ...
Epoch: 18 cost time: 0.4049673080444336
Epoch: 18, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.467 Vali Acc: 0.722 Test Loss: 1.467 Test Acc: 0.722
Validation loss decreased (-0.688874 --> -0.722208).  Saving model ...
Epoch: 19 cost time: 0.4559640884399414
Epoch: 19, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.433 Vali Acc: 0.756 Test Loss: 1.433 Test Acc: 0.756
Validation loss decreased (-0.722208 --> -0.755541).  Saving model ...
Epoch: 20 cost time: 0.4041438102722168
Epoch: 20, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.398 Vali Acc: 0.781 Test Loss: 1.398 Test Acc: 0.781
Validation loss decreased (-0.755541 --> -0.781467).  Saving model ...
Epoch: 21 cost time: 0.4072146415710449
Epoch: 21, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.362 Vali Acc: 0.796 Test Loss: 1.362 Test Acc: 0.796
Validation loss decreased (-0.781467 --> -0.796283).  Saving model ...
Epoch: 22 cost time: 0.4753713607788086
Epoch: 22, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.325 Vali Acc: 0.837 Test Loss: 1.325 Test Acc: 0.837
Validation loss decreased (-0.796283 --> -0.837024).  Saving model ...
Epoch: 23 cost time: 0.37669992446899414
Epoch: 23, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.287 Vali Acc: 0.841 Test Loss: 1.287 Test Acc: 0.841
Validation loss decreased (-0.837024 --> -0.840728).  Saving model ...
Epoch: 24 cost time: 0.42147088050842285
Epoch: 24, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.249 Vali Acc: 0.859 Test Loss: 1.249 Test Acc: 0.859
Validation loss decreased (-0.840728 --> -0.859247).  Saving model ...
Epoch: 25 cost time: 0.37854909896850586
Epoch: 25, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.209 Vali Acc: 0.870 Test Loss: 1.209 Test Acc: 0.870
Validation loss decreased (-0.859247 --> -0.870358).  Saving model ...
Epoch: 26 cost time: 0.34920310974121094
Epoch: 26, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.169 Vali Acc: 0.874 Test Loss: 1.169 Test Acc: 0.874
Validation loss decreased (-0.870358 --> -0.874062).  Saving model ...
Epoch: 27 cost time: 0.3894314765930176
Epoch: 27, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.129 Vali Acc: 0.881 Test Loss: 1.129 Test Acc: 0.881
Validation loss decreased (-0.874062 --> -0.881470).  Saving model ...
Epoch: 28 cost time: 0.4786546230316162
Epoch: 28, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.089 Vali Acc: 0.885 Test Loss: 1.089 Test Acc: 0.885
Validation loss decreased (-0.881470 --> -0.885174).  Saving model ...
Epoch: 29 cost time: 0.4436299800872803
Epoch: 29, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.048 Vali Acc: 0.893 Test Loss: 1.048 Test Acc: 0.893
Validation loss decreased (-0.885174 --> -0.892582).  Saving model ...
Epoch: 30 cost time: 0.3853733539581299
Epoch: 30, Steps: 2 | Train Loss: 0.833 Vali Loss: 1.008 Vali Acc: 0.900 Test Loss: 1.008 Test Acc: 0.900
Validation loss decreased (-0.892582 --> -0.899990).  Saving model ...
Epoch: 31 cost time: 0.3553919792175293
Epoch: 31, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.968 Vali Acc: 0.907 Test Loss: 0.968 Test Acc: 0.907
Validation loss decreased (-0.899990 --> -0.907398).  Saving model ...
Epoch: 32 cost time: 0.37650203704833984
Epoch: 32, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.929 Vali Acc: 0.915 Test Loss: 0.929 Test Acc: 0.915
Validation loss decreased (-0.907398 --> -0.914806).  Saving model ...
Epoch: 33 cost time: 0.35318446159362793
Epoch: 33, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.890 Vali Acc: 0.922 Test Loss: 0.890 Test Acc: 0.922
Validation loss decreased (-0.914806 --> -0.922213).  Saving model ...
Epoch: 34 cost time: 0.4359452724456787
Epoch: 34, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.853 Vali Acc: 0.922 Test Loss: 0.853 Test Acc: 0.922
Validation loss decreased (-0.922213 --> -0.922214).  Saving model ...
Epoch: 35 cost time: 0.40480518341064453
Epoch: 35, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.816 Vali Acc: 0.926 Test Loss: 0.816 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925918).  Saving model ...
Epoch: 36 cost time: 0.3981938362121582
Epoch: 36, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.780 Vali Acc: 0.926 Test Loss: 0.780 Test Acc: 0.926
Validation loss decreased (-0.925918 --> -0.925918).  Saving model ...
Epoch: 37 cost time: 0.44946742057800293
Epoch: 37, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.746 Vali Acc: 0.930 Test Loss: 0.746 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929622).  Saving model ...
Epoch: 38 cost time: 0.3810741901397705
Epoch: 38, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.713 Vali Acc: 0.937 Test Loss: 0.713 Test Acc: 0.937
Validation loss decreased (-0.929622 --> -0.937030).  Saving model ...
Epoch: 39 cost time: 0.3663146495819092
Epoch: 39, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.683 Vali Acc: 0.937 Test Loss: 0.683 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937030).  Saving model ...
Epoch: 40 cost time: 0.36768341064453125
Epoch: 40, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.653 Vali Acc: 0.937 Test Loss: 0.653 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 41 cost time: 0.37782883644104004
Epoch: 41, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.626 Vali Acc: 0.941 Test Loss: 0.626 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940734).  Saving model ...
Epoch: 42 cost time: 0.37451910972595215
Epoch: 42, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.600 Vali Acc: 0.944 Test Loss: 0.600 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 43 cost time: 0.535698652267456
Epoch: 43, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.575 Vali Acc: 0.948 Test Loss: 0.575 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948142).  Saving model ...
Epoch: 44 cost time: 0.3920161724090576
Epoch: 44, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.552 Vali Acc: 0.948 Test Loss: 0.552 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948143).  Saving model ...
Epoch: 45 cost time: 0.46208739280700684
Epoch: 45, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.530 Vali Acc: 0.948 Test Loss: 0.530 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 46 cost time: 0.41665220260620117
Epoch: 46, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.510 Vali Acc: 0.952 Test Loss: 0.510 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 47 cost time: 0.38773059844970703
Epoch: 47, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.490 Vali Acc: 0.948 Test Loss: 0.490 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.3749117851257324
Epoch: 48, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.472 Vali Acc: 0.948 Test Loss: 0.472 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.37171220779418945
Epoch: 49, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.455 Vali Acc: 0.948 Test Loss: 0.455 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.375415563583374
Epoch: 50, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.440 Vali Acc: 0.952 Test Loss: 0.440 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 65094
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6197164058685303
Epoch: 1, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.779 Vali Acc: 0.196 Test Loss: 1.779 Test Acc: 0.196
Validation loss decreased (inf --> -0.196279).  Saving model ...
Epoch: 2 cost time: 0.45983386039733887
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.769 Vali Acc: 0.200 Test Loss: 1.769 Test Acc: 0.200
Validation loss decreased (-0.196279 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.3579590320587158
Epoch: 3, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.760 Vali Acc: 0.204 Test Loss: 1.760 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.4437904357910156
Epoch: 4, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.752 Vali Acc: 0.219 Test Loss: 1.752 Test Acc: 0.219
Validation loss decreased (-0.203686 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 0.507606029510498
Epoch: 5, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.741 Vali Acc: 0.256 Test Loss: 1.741 Test Acc: 0.256
Validation loss decreased (-0.218501 --> -0.255538).  Saving model ...
Epoch: 6 cost time: 0.38280415534973145
Epoch: 6, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.728 Vali Acc: 0.307 Test Loss: 1.728 Test Acc: 0.307
Validation loss decreased (-0.255538 --> -0.307390).  Saving model ...
Epoch: 7 cost time: 0.36261940002441406
Epoch: 7, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.714 Vali Acc: 0.352 Test Loss: 1.714 Test Acc: 0.352
Validation loss decreased (-0.307390 --> -0.351835).  Saving model ...
Epoch: 8 cost time: 0.38544154167175293
Epoch: 8, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.697 Vali Acc: 0.389 Test Loss: 1.697 Test Acc: 0.389
Validation loss decreased (-0.351835 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 0.4289829730987549
Epoch: 9, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.679 Vali Acc: 0.441 Test Loss: 1.679 Test Acc: 0.441
Validation loss decreased (-0.388872 --> -0.440724).  Saving model ...
Epoch: 10 cost time: 0.42909979820251465
Epoch: 10, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.659 Vali Acc: 0.481 Test Loss: 1.659 Test Acc: 0.481
Validation loss decreased (-0.440724 --> -0.481465).  Saving model ...
Epoch: 11 cost time: 0.4490807056427002
Epoch: 11, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.637 Vali Acc: 0.567 Test Loss: 1.637 Test Acc: 0.567
Validation loss decreased (-0.481465 --> -0.566650).  Saving model ...
Epoch: 12 cost time: 0.45111703872680664
Epoch: 12, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.614 Vali Acc: 0.607 Test Loss: 1.614 Test Acc: 0.607
Validation loss decreased (-0.566650 --> -0.607391).  Saving model ...
Epoch: 13 cost time: 0.45565032958984375
Epoch: 13, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.589 Vali Acc: 0.670 Test Loss: 1.589 Test Acc: 0.670
Validation loss decreased (-0.607391 --> -0.670354).  Saving model ...
Epoch: 14 cost time: 0.39847707748413086
Epoch: 14, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.563 Vali Acc: 0.685 Test Loss: 1.563 Test Acc: 0.685
Validation loss decreased (-0.670354 --> -0.685170).  Saving model ...
Epoch: 15 cost time: 0.3860509395599365
Epoch: 15, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.536 Vali Acc: 0.730 Test Loss: 1.536 Test Acc: 0.730
Validation loss decreased (-0.685170 --> -0.729614).  Saving model ...
Epoch: 16 cost time: 0.43929195404052734
Epoch: 16, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.508 Vali Acc: 0.748 Test Loss: 1.508 Test Acc: 0.748
Validation loss decreased (-0.729614 --> -0.748133).  Saving model ...
Epoch: 17 cost time: 0.380859375
Epoch: 17, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.479 Vali Acc: 0.763 Test Loss: 1.479 Test Acc: 0.763
Validation loss decreased (-0.748133 --> -0.762948).  Saving model ...
Epoch: 18 cost time: 0.37856483459472656
Epoch: 18, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.449 Vali Acc: 0.778 Test Loss: 1.449 Test Acc: 0.778
Validation loss decreased (-0.762948 --> -0.777763).  Saving model ...
Epoch: 19 cost time: 0.40120387077331543
Epoch: 19, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.419 Vali Acc: 0.793 Test Loss: 1.419 Test Acc: 0.793
Validation loss decreased (-0.777763 --> -0.792578).  Saving model ...
Epoch: 20 cost time: 0.4165964126586914
Epoch: 20, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.388 Vali Acc: 0.800 Test Loss: 1.388 Test Acc: 0.800
Validation loss decreased (-0.792578 --> -0.799986).  Saving model ...
Epoch: 21 cost time: 0.3688347339630127
Epoch: 21, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.356 Vali Acc: 0.819 Test Loss: 1.356 Test Acc: 0.819
Validation loss decreased (-0.799986 --> -0.818505).  Saving model ...
Epoch: 22 cost time: 0.3685479164123535
Epoch: 22, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.323 Vali Acc: 0.826 Test Loss: 1.323 Test Acc: 0.826
Validation loss decreased (-0.818505 --> -0.825913).  Saving model ...
Epoch: 23 cost time: 0.4202449321746826
Epoch: 23, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.290 Vali Acc: 0.826 Test Loss: 1.290 Test Acc: 0.826
Validation loss decreased (-0.825913 --> -0.825913).  Saving model ...
Epoch: 24 cost time: 0.4253218173980713
Epoch: 24, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.256 Vali Acc: 0.844 Test Loss: 1.256 Test Acc: 0.844
Validation loss decreased (-0.825913 --> -0.844432).  Saving model ...
Epoch: 25 cost time: 0.36411452293395996
Epoch: 25, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.222 Vali Acc: 0.848 Test Loss: 1.222 Test Acc: 0.848
Validation loss decreased (-0.844432 --> -0.848136).  Saving model ...
Epoch: 26 cost time: 0.3834688663482666
Epoch: 26, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.187 Vali Acc: 0.856 Test Loss: 1.187 Test Acc: 0.856
Validation loss decreased (-0.848136 --> -0.855544).  Saving model ...
Epoch: 27 cost time: 0.4317011833190918
Epoch: 27, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.152 Vali Acc: 0.867 Test Loss: 1.152 Test Acc: 0.867
Validation loss decreased (-0.855544 --> -0.866655).  Saving model ...
Epoch: 28 cost time: 0.47454404830932617
Epoch: 28, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.117 Vali Acc: 0.870 Test Loss: 1.117 Test Acc: 0.870
Validation loss decreased (-0.866655 --> -0.870359).  Saving model ...
Epoch: 29 cost time: 0.3821585178375244
Epoch: 29, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.083 Vali Acc: 0.881 Test Loss: 1.083 Test Acc: 0.881
Validation loss decreased (-0.870359 --> -0.881471).  Saving model ...
Epoch: 30 cost time: 0.3920783996582031
Epoch: 30, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.048 Vali Acc: 0.889 Test Loss: 1.048 Test Acc: 0.889
Validation loss decreased (-0.881471 --> -0.888878).  Saving model ...
Epoch: 31 cost time: 0.3942747116088867
Epoch: 31, Steps: 2 | Train Loss: 0.898 Vali Loss: 1.013 Vali Acc: 0.904 Test Loss: 1.013 Test Acc: 0.904
Validation loss decreased (-0.888878 --> -0.903694).  Saving model ...
Epoch: 32 cost time: 0.3826868534088135
Epoch: 32, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.979 Vali Acc: 0.904 Test Loss: 0.979 Test Acc: 0.904
Validation loss decreased (-0.903694 --> -0.903694).  Saving model ...
Epoch: 33 cost time: 0.37578320503234863
Epoch: 33, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.945 Vali Acc: 0.904 Test Loss: 0.945 Test Acc: 0.904
Validation loss decreased (-0.903694 --> -0.903694).  Saving model ...
Epoch: 34 cost time: 0.4316866397857666
Epoch: 34, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.911 Vali Acc: 0.904 Test Loss: 0.911 Test Acc: 0.904
Validation loss decreased (-0.903694 --> -0.903695).  Saving model ...
Epoch: 35 cost time: 0.39495182037353516
Epoch: 35, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.877 Vali Acc: 0.911 Test Loss: 0.877 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911102).  Saving model ...
Epoch: 36 cost time: 0.3920004367828369
Epoch: 36, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.845 Vali Acc: 0.915 Test Loss: 0.845 Test Acc: 0.915
Validation loss decreased (-0.911102 --> -0.914806).  Saving model ...
Epoch: 37 cost time: 0.38058900833129883
Epoch: 37, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.814 Vali Acc: 0.922 Test Loss: 0.814 Test Acc: 0.922
Validation loss decreased (-0.914806 --> -0.922214).  Saving model ...
Epoch: 38 cost time: 0.3772246837615967
Epoch: 38, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.784 Vali Acc: 0.919 Test Loss: 0.784 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3770146369934082
Epoch: 39, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.754 Vali Acc: 0.922 Test Loss: 0.754 Test Acc: 0.922
Validation loss decreased (-0.922214 --> -0.922215).  Saving model ...
Epoch: 40 cost time: 0.4426605701446533
Epoch: 40, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.725 Vali Acc: 0.922 Test Loss: 0.725 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922215).  Saving model ...
Epoch: 41 cost time: 0.41311001777648926
Epoch: 41, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.697 Vali Acc: 0.922 Test Loss: 0.697 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922215).  Saving model ...
Epoch: 42 cost time: 0.3931427001953125
Epoch: 42, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.671 Vali Acc: 0.922 Test Loss: 0.671 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 43 cost time: 0.394240140914917
Epoch: 43, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.645 Vali Acc: 0.922 Test Loss: 0.645 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 44 cost time: 0.4267444610595703
Epoch: 44, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.621 Vali Acc: 0.922 Test Loss: 0.621 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 45 cost time: 0.38340187072753906
Epoch: 45, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.597 Vali Acc: 0.930 Test Loss: 0.597 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 46 cost time: 0.3429379463195801
Epoch: 46, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.576 Vali Acc: 0.930 Test Loss: 0.576 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 47 cost time: 0.38884401321411133
Epoch: 47, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.555 Vali Acc: 0.930 Test Loss: 0.555 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 48 cost time: 0.4224722385406494
Epoch: 48, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.535 Vali Acc: 0.933 Test Loss: 0.535 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 49 cost time: 0.36978745460510254
Epoch: 49, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.516 Vali Acc: 0.930 Test Loss: 0.516 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.3935225009918213
Epoch: 50, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.498 Vali Acc: 0.937 Test Loss: 0.498 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 63686
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7358992099761963
Epoch: 1, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.682 Vali Acc: 0.333 Test Loss: 1.682 Test Acc: 0.333
Validation loss decreased (inf --> -0.333317).  Saving model ...
Epoch: 2 cost time: 0.4520535469055176
Epoch: 2, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.550 Vali Acc: 0.500 Test Loss: 1.550 Test Acc: 0.500
Validation loss decreased (-0.333317 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.4846665859222412
Epoch: 3, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.296 Vali Acc: 0.700 Test Loss: 1.296 Test Acc: 0.700
Validation loss decreased (-0.499985 --> -0.699987).  Saving model ...
Epoch: 4 cost time: 0.40078306198120117
Epoch: 4, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.897 Vali Acc: 0.833 Test Loss: 0.897 Test Acc: 0.833
Validation loss decreased (-0.699987 --> -0.833324).  Saving model ...
Epoch: 5 cost time: 0.39613890647888184
Epoch: 5, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.612 Vali Acc: 0.870 Test Loss: 0.612 Test Acc: 0.870
Validation loss decreased (-0.833324 --> -0.870364).  Saving model ...
Epoch: 6 cost time: 0.4113469123840332
Epoch: 6, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.426 Vali Acc: 0.904 Test Loss: 0.426 Test Acc: 0.904
Validation loss decreased (-0.870364 --> -0.903699).  Saving model ...
Epoch: 7 cost time: 0.42032527923583984
Epoch: 7, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.903699 --> -0.937034).  Saving model ...
Epoch: 8 cost time: 0.3982701301574707
Epoch: 8, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 9 cost time: 0.4143080711364746
Epoch: 9, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 10 cost time: 0.40756797790527344
Epoch: 10, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 11 cost time: 0.4035491943359375
Epoch: 11, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.45095038414001465
Epoch: 12, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5081281661987305
Epoch: 13, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4533364772796631
Epoch: 14, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.41936612129211426
Epoch: 15, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4520390033721924
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.4661433696746826
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4231445789337158
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4467740058898926
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.43605756759643555
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.44489240646362305
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.4390232563018799
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 23 cost time: 0.4180917739868164
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.48829150199890137
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.46114397048950195
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4100837707519531
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.41381096839904785
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.40402960777282715
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4362468719482422
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.46065330505371094
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.956 Test Loss: 0.230 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.42439961433410645
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4030489921569824
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.232 Vali Acc: 0.956 Test Loss: 0.232 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 960262
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.586202621459961
Epoch: 1, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.719 Vali Acc: 0.237 Test Loss: 1.719 Test Acc: 0.237
Validation loss decreased (inf --> -0.237020).  Saving model ...
Epoch: 2 cost time: 0.38912272453308105
Epoch: 2, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.634 Vali Acc: 0.374 Test Loss: 1.634 Test Acc: 0.374
Validation loss decreased (-0.237020 --> -0.374058).  Saving model ...
Epoch: 3 cost time: 0.36764979362487793
Epoch: 3, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.495 Vali Acc: 0.596 Test Loss: 1.495 Test Acc: 0.596
Validation loss decreased (-0.374058 --> -0.596281).  Saving model ...
Epoch: 4 cost time: 0.39928245544433594
Epoch: 4, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.250 Vali Acc: 0.759 Test Loss: 1.250 Test Acc: 0.759
Validation loss decreased (-0.596281 --> -0.759247).  Saving model ...
Epoch: 5 cost time: 0.4086627960205078
Epoch: 5, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.983 Vali Acc: 0.848 Test Loss: 0.983 Test Acc: 0.848
Validation loss decreased (-0.759247 --> -0.848138).  Saving model ...
Epoch: 6 cost time: 0.37792372703552246
Epoch: 6, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.744 Vali Acc: 0.907 Test Loss: 0.744 Test Acc: 0.907
Validation loss decreased (-0.848138 --> -0.907400).  Saving model ...
Epoch: 7 cost time: 0.5534887313842773
Epoch: 7, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.562 Vali Acc: 0.930 Test Loss: 0.562 Test Acc: 0.930
Validation loss decreased (-0.907400 --> -0.929624).  Saving model ...
Epoch: 8 cost time: 0.4055309295654297
Epoch: 8, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.427 Vali Acc: 0.933 Test Loss: 0.427 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933329).  Saving model ...
Epoch: 9 cost time: 0.37362217903137207
Epoch: 9, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.37781381607055664
Epoch: 10, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937034).  Saving model ...
Epoch: 11 cost time: 0.3768472671508789
Epoch: 11, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 12 cost time: 0.4038271903991699
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.39828038215637207
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4084031581878662
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4102356433868408
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 16 cost time: 0.3426682949066162
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 17 cost time: 0.38374781608581543
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.39125871658325195
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.3834216594696045
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.39414477348327637
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.39056992530822754
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.41280698776245117
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.41411852836608887
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.3873422145843506
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.37769484519958496
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4315810203552246
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.4220271110534668
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.429628849029541
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.42091894149780273
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.39579248428344727
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4552948474884033
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.39177942276000977
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.3955521583557129
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.42089295387268066
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.46813273429870605
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.41701817512512207
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 758022
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6449191570281982
Epoch: 1, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.777 Vali Acc: 0.270 Test Loss: 1.777 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.3919548988342285
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.704 Vali Acc: 0.344 Test Loss: 1.704 Test Acc: 0.344
Validation loss decreased (-0.270353 --> -0.344427).  Saving model ...
Epoch: 3 cost time: 0.37940025329589844
Epoch: 3, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.599 Vali Acc: 0.467 Test Loss: 1.599 Test Acc: 0.467
Validation loss decreased (-0.344427 --> -0.466651).  Saving model ...
Epoch: 4 cost time: 0.39842987060546875
Epoch: 4, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.418 Vali Acc: 0.785 Test Loss: 1.418 Test Acc: 0.785
Validation loss decreased (-0.466651 --> -0.785171).  Saving model ...
Epoch: 5 cost time: 0.42227888107299805
Epoch: 5, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.203 Vali Acc: 0.867 Test Loss: 1.203 Test Acc: 0.867
Validation loss decreased (-0.785171 --> -0.866655).  Saving model ...
Epoch: 6 cost time: 0.36756372451782227
Epoch: 6, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.984 Vali Acc: 0.893 Test Loss: 0.984 Test Acc: 0.893
Validation loss decreased (-0.866655 --> -0.892583).  Saving model ...
Epoch: 7 cost time: 0.4442770481109619
Epoch: 7, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.793 Vali Acc: 0.907 Test Loss: 0.793 Test Acc: 0.907
Validation loss decreased (-0.892583 --> -0.907399).  Saving model ...
Epoch: 8 cost time: 0.37498974800109863
Epoch: 8, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.634 Vali Acc: 0.930 Test Loss: 0.634 Test Acc: 0.930
Validation loss decreased (-0.907399 --> -0.929623).  Saving model ...
Epoch: 9 cost time: 0.38844966888427734
Epoch: 9, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.510 Vali Acc: 0.926 Test Loss: 0.510 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.38831424713134766
Epoch: 10, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.415 Vali Acc: 0.926 Test Loss: 0.415 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.46867942810058594
Epoch: 11, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.346 Vali Acc: 0.933 Test Loss: 0.346 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933330).  Saving model ...
Epoch: 12 cost time: 0.39582252502441406
Epoch: 12, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.40938520431518555
Epoch: 13, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.40006017684936523
Epoch: 14, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4488942623138428
Epoch: 15, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.4709765911102295
Epoch: 16, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.3848702907562256
Epoch: 17, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.4139888286590576
Epoch: 18, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.4315831661224365
Epoch: 19, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.4077188968658447
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.39899182319641113
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.4654364585876465
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.4726269245147705
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.4570174217224121
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.41142845153808594
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.5213990211486816
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.46789073944091797
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.4485657215118408
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.4181556701660156
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.37141847610473633
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.43955039978027344
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4251277446746826
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4131278991699219
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.4044196605682373
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.4194626808166504
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.36397743225097656
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4565579891204834
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4379854202270508
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4195842742919922
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4078023433685303
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.39610767364501953
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4063851833343506
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.44417595863342285
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4526972770690918
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 690694
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6260738372802734
Epoch: 1, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.806 Vali Acc: 0.219 Test Loss: 1.806 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 0.4983949661254883
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.739 Vali Acc: 0.344 Test Loss: 1.739 Test Acc: 0.344
Validation loss decreased (-0.218500 --> -0.344427).  Saving model ...
Epoch: 3 cost time: 0.430511474609375
Epoch: 3, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.653 Vali Acc: 0.396 Test Loss: 1.653 Test Acc: 0.396
Validation loss decreased (-0.344427 --> -0.396280).  Saving model ...
Epoch: 4 cost time: 0.42070770263671875
Epoch: 4, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.508 Vali Acc: 0.515 Test Loss: 1.508 Test Acc: 0.515
Validation loss decreased (-0.396280 --> -0.514800).  Saving model ...
Epoch: 5 cost time: 0.42880725860595703
Epoch: 5, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.330 Vali Acc: 0.663 Test Loss: 1.330 Test Acc: 0.663
Validation loss decreased (-0.514800 --> -0.662950).  Saving model ...
Epoch: 6 cost time: 0.4433903694152832
Epoch: 6, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.138 Vali Acc: 0.767 Test Loss: 1.138 Test Acc: 0.767
Validation loss decreased (-0.662950 --> -0.766655).  Saving model ...
Epoch: 7 cost time: 0.4847266674041748
Epoch: 7, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.949 Vali Acc: 0.841 Test Loss: 0.949 Test Acc: 0.841
Validation loss decreased (-0.766655 --> -0.840731).  Saving model ...
Epoch: 8 cost time: 0.4118154048919678
Epoch: 8, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.780 Vali Acc: 0.885 Test Loss: 0.780 Test Acc: 0.885
Validation loss decreased (-0.840731 --> -0.885177).  Saving model ...
Epoch: 9 cost time: 0.41261982917785645
Epoch: 9, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.637 Vali Acc: 0.915 Test Loss: 0.637 Test Acc: 0.915
Validation loss decreased (-0.885177 --> -0.914808).  Saving model ...
Epoch: 10 cost time: 0.41489744186401367
Epoch: 10, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.520 Vali Acc: 0.922 Test Loss: 0.520 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922217).  Saving model ...
Epoch: 11 cost time: 0.45189332962036133
Epoch: 11, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.429 Vali Acc: 0.941 Test Loss: 0.429 Test Acc: 0.941
Validation loss decreased (-0.922217 --> -0.940736).  Saving model ...
Epoch: 12 cost time: 0.38971900939941406
Epoch: 12, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.360 Vali Acc: 0.941 Test Loss: 0.360 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 13 cost time: 0.40803027153015137
Epoch: 13, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 14 cost time: 0.4130828380584717
Epoch: 14, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.42653632164001465
Epoch: 15, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 16 cost time: 0.43778038024902344
Epoch: 16, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 17 cost time: 0.3976869583129883
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.952 Test Loss: 0.215 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 18 cost time: 0.39403820037841797
Epoch: 18, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.39640092849731445
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.4081287384033203
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.44268035888671875
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.416074275970459
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.4965629577636719
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.5627210140228271
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.40351319313049316
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.5051651000976562
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.4593322277069092
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.4484264850616455
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.498232364654541
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.420149564743042
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.40055179595947266
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4076883792877197
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.4417390823364258
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.414827823638916
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.416823148727417
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.4145047664642334
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.4435267448425293
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.3614826202392578
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.4148859977722168
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.40980005264282227
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 41 cost time: 0.37029075622558594
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.37457966804504395
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4119875431060791
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.3890500068664551
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.426253080368042
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.3706939220428467
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.4133181571960449
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.41155433654785156
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5386297702789307
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.4254796504974365
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 660486
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5936644077301025
Epoch: 1, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.683 Vali Acc: 0.378 Test Loss: 1.683 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.37329769134521484
Epoch: 2, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.627 Vali Acc: 0.456 Test Loss: 1.627 Test Acc: 0.456
Validation loss decreased (-0.377761 --> -0.455539).  Saving model ...
Epoch: 3 cost time: 0.4051837921142578
Epoch: 3, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.557 Vali Acc: 0.515 Test Loss: 1.557 Test Acc: 0.515
Validation loss decreased (-0.455539 --> -0.514799).  Saving model ...
Epoch: 4 cost time: 0.5030622482299805
Epoch: 4, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.445 Vali Acc: 0.637 Test Loss: 1.445 Test Acc: 0.637
Validation loss decreased (-0.514799 --> -0.637023).  Saving model ...
Epoch: 5 cost time: 0.39042162895202637
Epoch: 5, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.305 Vali Acc: 0.689 Test Loss: 1.305 Test Acc: 0.689
Validation loss decreased (-0.637023 --> -0.688876).  Saving model ...
Epoch: 6 cost time: 0.4072132110595703
Epoch: 6, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.152 Vali Acc: 0.767 Test Loss: 1.152 Test Acc: 0.767
Validation loss decreased (-0.688876 --> -0.766655).  Saving model ...
Epoch: 7 cost time: 0.37520623207092285
Epoch: 7, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.998 Vali Acc: 0.852 Test Loss: 0.998 Test Acc: 0.852
Validation loss decreased (-0.766655 --> -0.851842).  Saving model ...
Epoch: 8 cost time: 0.40198493003845215
Epoch: 8, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.855 Vali Acc: 0.889 Test Loss: 0.855 Test Acc: 0.889
Validation loss decreased (-0.851842 --> -0.888880).  Saving model ...
Epoch: 9 cost time: 0.3690774440765381
Epoch: 9, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.726 Vali Acc: 0.904 Test Loss: 0.726 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903696).  Saving model ...
Epoch: 10 cost time: 0.3852696418762207
Epoch: 10, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.613 Vali Acc: 0.919 Test Loss: 0.613 Test Acc: 0.919
Validation loss decreased (-0.903696 --> -0.918512).  Saving model ...
Epoch: 11 cost time: 0.47757935523986816
Epoch: 11, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.518 Vali Acc: 0.930 Test Loss: 0.518 Test Acc: 0.930
Validation loss decreased (-0.918512 --> -0.929624).  Saving model ...
Epoch: 12 cost time: 0.38951563835144043
Epoch: 12, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 13 cost time: 0.33875060081481934
Epoch: 13, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.376 Vali Acc: 0.937 Test Loss: 0.376 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 14 cost time: 0.36893749237060547
Epoch: 14, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.326 Vali Acc: 0.948 Test Loss: 0.326 Test Acc: 0.948
Validation loss decreased (-0.937033 --> -0.948145).  Saving model ...
Epoch: 15 cost time: 0.3614163398742676
Epoch: 15, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.290 Vali Acc: 0.956 Test Loss: 0.290 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 16 cost time: 0.391132116317749
Epoch: 16, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.263 Vali Acc: 0.963 Test Loss: 0.263 Test Acc: 0.963
Validation loss decreased (-0.955553 --> -0.962960).  Saving model ...
Epoch: 17 cost time: 0.42737722396850586
Epoch: 17, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.244 Vali Acc: 0.963 Test Loss: 0.244 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962961).  Saving model ...
Epoch: 18 cost time: 0.35656261444091797
Epoch: 18, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.3954281806945801
Epoch: 19, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3780684471130371
Epoch: 20, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.959 Test Loss: 0.215 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.37015724182128906
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.3479597568511963
Epoch: 22, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.44249582290649414
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.40096449851989746
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.3875865936279297
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.3815455436706543
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.37863588333129883
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 642822
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5842454433441162
Epoch: 1, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.807 Vali Acc: 0.152 Test Loss: 1.807 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 0.3845236301422119
Epoch: 2, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.753 Vali Acc: 0.219 Test Loss: 1.753 Test Acc: 0.219
Validation loss decreased (-0.151834 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.4073905944824219
Epoch: 3, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.694 Vali Acc: 0.278 Test Loss: 1.694 Test Acc: 0.278
Validation loss decreased (-0.218501 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.37174487113952637
Epoch: 4, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.606 Vali Acc: 0.363 Test Loss: 1.606 Test Acc: 0.363
Validation loss decreased (-0.277761 --> -0.362947).  Saving model ...
Epoch: 5 cost time: 0.3934304714202881
Epoch: 5, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.491 Vali Acc: 0.537 Test Loss: 1.491 Test Acc: 0.537
Validation loss decreased (-0.362947 --> -0.537022).  Saving model ...
Epoch: 6 cost time: 0.4099392890930176
Epoch: 6, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.357 Vali Acc: 0.689 Test Loss: 1.357 Test Acc: 0.689
Validation loss decreased (-0.537022 --> -0.688875).  Saving model ...
Epoch: 7 cost time: 0.3663523197174072
Epoch: 7, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.213 Vali Acc: 0.763 Test Loss: 1.213 Test Acc: 0.763
Validation loss decreased (-0.688875 --> -0.762951).  Saving model ...
Epoch: 8 cost time: 0.39933133125305176
Epoch: 8, Steps: 2 | Train Loss: 0.834 Vali Loss: 1.067 Vali Acc: 0.819 Test Loss: 1.067 Test Acc: 0.819
Validation loss decreased (-0.762951 --> -0.818508).  Saving model ...
Epoch: 9 cost time: 0.39173269271850586
Epoch: 9, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.926 Vali Acc: 0.874 Test Loss: 0.926 Test Acc: 0.874
Validation loss decreased (-0.818508 --> -0.874065).  Saving model ...
Epoch: 10 cost time: 0.3935823440551758
Epoch: 10, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.796 Vali Acc: 0.889 Test Loss: 0.796 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888881).  Saving model ...
Epoch: 11 cost time: 0.39779186248779297
Epoch: 11, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.683 Vali Acc: 0.911 Test Loss: 0.683 Test Acc: 0.911
Validation loss decreased (-0.888881 --> -0.911104).  Saving model ...
Epoch: 12 cost time: 0.3887357711791992
Epoch: 12, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.586 Vali Acc: 0.911 Test Loss: 0.586 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 13 cost time: 0.3758840560913086
Epoch: 13, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.506 Vali Acc: 0.919 Test Loss: 0.506 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.36261415481567383
Epoch: 14, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.440 Vali Acc: 0.919 Test Loss: 0.440 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 15 cost time: 0.3675243854522705
Epoch: 15, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 16 cost time: 0.39255833625793457
Epoch: 16, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
Validation loss decreased (-0.922218 --> -0.937034).  Saving model ...
Epoch: 17 cost time: 0.430755615234375
Epoch: 17, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 18 cost time: 0.4069690704345703
Epoch: 18, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
Validation loss decreased (-0.937034 --> -0.948145).  Saving model ...
Epoch: 19 cost time: 0.41961026191711426
Epoch: 19, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.268 Vali Acc: 0.952 Test Loss: 0.268 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 20 cost time: 0.40721869468688965
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.252 Vali Acc: 0.956 Test Loss: 0.252 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 21 cost time: 0.42710065841674805
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 22 cost time: 0.4979746341705322
Epoch: 22, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.456784725189209
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.952 Test Loss: 0.222 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4326636791229248
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.41138648986816406
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.3838508129119873
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.46840858459472656
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.46326446533203125
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4361538887023926
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.41375732421875
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.43833351135253906
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.472491979598999
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.44076967239379883
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.47790050506591797
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.4110872745513916
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.46991825103759766
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.4596729278564453
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.4085116386413574
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.4139719009399414
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.4147942066192627
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.4334421157836914
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.42328381538391113
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 43 cost time: 0.42880702018737793
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 44 cost time: 0.4096240997314453
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.4050636291503906
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.46497392654418945
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 47 cost time: 0.4351961612701416
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.4421427249908447
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.4223775863647461
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.4419686794281006
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 619014
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.765622854232788
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.755 Vali Acc: 0.174 Test Loss: 1.755 Test Acc: 0.174
Validation loss decreased (inf --> -0.174057).  Saving model ...
Epoch: 2 cost time: 0.4562258720397949
Epoch: 2, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.709 Vali Acc: 0.230 Test Loss: 1.709 Test Acc: 0.230
Validation loss decreased (-0.174057 --> -0.229613).  Saving model ...
Epoch: 3 cost time: 0.3661198616027832
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.658 Vali Acc: 0.315 Test Loss: 1.658 Test Acc: 0.315
Validation loss decreased (-0.229613 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.4284646511077881
Epoch: 4, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.584 Vali Acc: 0.519 Test Loss: 1.584 Test Acc: 0.519
Validation loss decreased (-0.314798 --> -0.518503).  Saving model ...
Epoch: 5 cost time: 0.3791053295135498
Epoch: 5, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.489 Vali Acc: 0.615 Test Loss: 1.489 Test Acc: 0.615
Validation loss decreased (-0.518503 --> -0.614800).  Saving model ...
Epoch: 6 cost time: 0.3713696002960205
Epoch: 6, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.376 Vali Acc: 0.715 Test Loss: 1.376 Test Acc: 0.715
Validation loss decreased (-0.614800 --> -0.714801).  Saving model ...
Epoch: 7 cost time: 0.37900376319885254
Epoch: 7, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.251 Vali Acc: 0.770 Test Loss: 1.251 Test Acc: 0.770
Validation loss decreased (-0.714801 --> -0.770358).  Saving model ...
Epoch: 8 cost time: 0.3712940216064453
Epoch: 8, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.121 Vali Acc: 0.844 Test Loss: 1.121 Test Acc: 0.844
Validation loss decreased (-0.770358 --> -0.844433).  Saving model ...
Epoch: 9 cost time: 0.3878951072692871
Epoch: 9, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.994 Vali Acc: 0.881 Test Loss: 0.994 Test Acc: 0.881
Validation loss decreased (-0.844433 --> -0.881472).  Saving model ...
Epoch: 10 cost time: 0.40347719192504883
Epoch: 10, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.875 Vali Acc: 0.904 Test Loss: 0.875 Test Acc: 0.904
Validation loss decreased (-0.881472 --> -0.903695).  Saving model ...
Epoch: 11 cost time: 0.43377208709716797
Epoch: 11, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.768 Vali Acc: 0.930 Test Loss: 0.768 Test Acc: 0.930
Validation loss decreased (-0.903695 --> -0.929622).  Saving model ...
Epoch: 12 cost time: 0.3776237964630127
Epoch: 12, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.671 Vali Acc: 0.933 Test Loss: 0.671 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933327).  Saving model ...
Epoch: 13 cost time: 0.37902402877807617
Epoch: 13, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.586 Vali Acc: 0.933 Test Loss: 0.586 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 14 cost time: 0.404421329498291
Epoch: 14, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.513 Vali Acc: 0.937 Test Loss: 0.513 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937032).  Saving model ...
Epoch: 15 cost time: 0.3596832752227783
Epoch: 15, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.451 Vali Acc: 0.937 Test Loss: 0.451 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 16 cost time: 0.44380712509155273
Epoch: 16, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.399 Vali Acc: 0.948 Test Loss: 0.399 Test Acc: 0.948
Validation loss decreased (-0.937033 --> -0.948144).  Saving model ...
Epoch: 17 cost time: 0.36615681648254395
Epoch: 17, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5214409828186035
Epoch: 18, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 19 cost time: 0.36165356636047363
Epoch: 19, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.292 Vali Acc: 0.948 Test Loss: 0.292 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 20 cost time: 0.3859226703643799
Epoch: 20, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.270 Vali Acc: 0.948 Test Loss: 0.270 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 21 cost time: 0.3902158737182617
Epoch: 21, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 22 cost time: 0.35535764694213867
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 23 cost time: 0.4049551486968994
Epoch: 23, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.4260540008544922
Epoch: 24, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.42721104621887207
Epoch: 25, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.41045069694519043
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.38095784187316895
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.3783142566680908
Epoch: 28, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.40344691276550293
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 30 cost time: 0.4500761032104492
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 31 cost time: 0.3815114498138428
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.392956018447876
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 33 cost time: 0.4295830726623535
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 34 cost time: 0.4316411018371582
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 35 cost time: 0.4309258460998535
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 36 cost time: 0.3982710838317871
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 37 cost time: 0.48953866958618164
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 38 cost time: 0.490936279296875
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 39 cost time: 0.54443359375
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 40 cost time: 0.40346789360046387
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 41 cost time: 0.41675353050231934
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 42 cost time: 0.46356987953186035
Epoch: 42, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.3944082260131836
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.38420677185058594
Epoch: 44, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.970369).  Saving model ...
Epoch: 45 cost time: 0.3506138324737549
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 46 cost time: 0.4664900302886963
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 47 cost time: 0.4397711753845215
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 48 cost time: 0.5320148468017578
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 49 cost time: 0.5174474716186523
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
Epoch: 50 cost time: 0.391298770904541
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.970369 --> -0.970369).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9703703703703703
model parameter : 607750
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6754980087280273
Epoch: 1, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.824 Vali Acc: 0.152 Test Loss: 1.824 Test Acc: 0.152
Validation loss decreased (inf --> -0.151834).  Saving model ...
Epoch: 2 cost time: 0.383648157119751
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.730 Vali Acc: 0.241 Test Loss: 1.730 Test Acc: 0.241
Validation loss decreased (-0.151834 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.4647376537322998
Epoch: 3, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.572 Vali Acc: 0.493 Test Loss: 1.572 Test Acc: 0.493
Validation loss decreased (-0.240723 --> -0.492577).  Saving model ...
Epoch: 4 cost time: 0.4232454299926758
Epoch: 4, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.290 Vali Acc: 0.781 Test Loss: 1.290 Test Acc: 0.781
Validation loss decreased (-0.492577 --> -0.781469).  Saving model ...
Epoch: 5 cost time: 0.39390110969543457
Epoch: 5, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.989 Vali Acc: 0.878 Test Loss: 0.989 Test Acc: 0.878
Validation loss decreased (-0.781469 --> -0.877768).  Saving model ...
Epoch: 6 cost time: 0.43625903129577637
Epoch: 6, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.735 Vali Acc: 0.922 Test Loss: 0.735 Test Acc: 0.922
Validation loss decreased (-0.877768 --> -0.922215).  Saving model ...
Epoch: 7 cost time: 0.38524365425109863
Epoch: 7, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.548 Vali Acc: 0.907 Test Loss: 0.548 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3781704902648926
Epoch: 8, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.409 Vali Acc: 0.948 Test Loss: 0.409 Test Acc: 0.948
Validation loss decreased (-0.922215 --> -0.948144).  Saving model ...
Epoch: 9 cost time: 0.4505629539489746
Epoch: 9, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4050002098083496
Epoch: 10, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4311552047729492
Epoch: 11, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.45655226707458496
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948146).  Saving model ...
Epoch: 13 cost time: 0.561180830001831
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 14 cost time: 0.40016865730285645
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 15 cost time: 0.3625798225402832
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 16 cost time: 0.3622586727142334
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 17 cost time: 0.4220597743988037
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 0.39887428283691406
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 19 cost time: 0.37707972526550293
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.43883609771728516
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.39487409591674805
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.42205381393432617
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4047396183013916
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4010045528411865
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3721659183502197
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4483315944671631
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.41440629959106445
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4028646945953369
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 349062
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5840651988983154
Epoch: 1, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.674 Vali Acc: 0.285 Test Loss: 1.674 Test Acc: 0.285
Validation loss decreased (inf --> -0.285168).  Saving model ...
Epoch: 2 cost time: 0.37168216705322266
Epoch: 2, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.612 Vali Acc: 0.381 Test Loss: 1.612 Test Acc: 0.381
Validation loss decreased (-0.285168 --> -0.381465).  Saving model ...
Epoch: 3 cost time: 0.3783376216888428
Epoch: 3, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.530 Vali Acc: 0.485 Test Loss: 1.530 Test Acc: 0.485
Validation loss decreased (-0.381465 --> -0.485170).  Saving model ...
Epoch: 4 cost time: 0.4460020065307617
Epoch: 4, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.399 Vali Acc: 0.581 Test Loss: 1.399 Test Acc: 0.581
Validation loss decreased (-0.485170 --> -0.581467).  Saving model ...
Epoch: 5 cost time: 0.3828151226043701
Epoch: 5, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.240 Vali Acc: 0.685 Test Loss: 1.240 Test Acc: 0.685
Validation loss decreased (-0.581467 --> -0.685173).  Saving model ...
Epoch: 6 cost time: 0.39986467361450195
Epoch: 6, Steps: 2 | Train Loss: 0.797 Vali Loss: 1.067 Vali Acc: 0.804 Test Loss: 1.067 Test Acc: 0.804
Validation loss decreased (-0.685173 --> -0.803693).  Saving model ...
Epoch: 7 cost time: 0.36441707611083984
Epoch: 7, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.900 Vali Acc: 0.859 Test Loss: 0.900 Test Acc: 0.859
Validation loss decreased (-0.803693 --> -0.859250).  Saving model ...
Epoch: 8 cost time: 0.39470958709716797
Epoch: 8, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.751 Vali Acc: 0.893 Test Loss: 0.751 Test Acc: 0.893
Validation loss decreased (-0.859250 --> -0.892585).  Saving model ...
Epoch: 9 cost time: 0.41053318977355957
Epoch: 9, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.625 Vali Acc: 0.907 Test Loss: 0.625 Test Acc: 0.907
Validation loss decreased (-0.892585 --> -0.907401).  Saving model ...
Epoch: 10 cost time: 0.38566040992736816
Epoch: 10, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.520 Vali Acc: 0.919 Test Loss: 0.520 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 11 cost time: 0.41638612747192383
Epoch: 11, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.436 Vali Acc: 0.922 Test Loss: 0.436 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 12 cost time: 0.36125802993774414
Epoch: 12, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.370 Vali Acc: 0.930 Test Loss: 0.370 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 13 cost time: 0.45934152603149414
Epoch: 13, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.323 Vali Acc: 0.930 Test Loss: 0.323 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 14 cost time: 0.3607301712036133
Epoch: 14, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 15 cost time: 0.38603639602661133
Epoch: 15, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.4538743495941162
Epoch: 16, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.3928241729736328
Epoch: 17, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.48609471321105957
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.40569353103637695
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.42454957962036133
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.4205596446990967
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.41974925994873047
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.39229893684387207
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.3708655834197998
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.4863853454589844
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.4792482852935791
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.3845245838165283
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.37241101264953613
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.37975645065307617
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.41714954376220703
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.406080961227417
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.43262791633605957
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.397050142288208
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.454913854598999
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.43420863151550293
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.43292665481567383
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4359591007232666
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4309265613555908
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.40200042724609375
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.39650583267211914
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.39858484268188477
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.48714160919189453
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.44434261322021484
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 247942
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9519240856170654
Epoch: 1, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.825 Vali Acc: 0.096 Test Loss: 1.825 Test Acc: 0.096
Validation loss decreased (inf --> -0.096278).  Saving model ...
Epoch: 2 cost time: 0.3729255199432373
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.773 Vali Acc: 0.144 Test Loss: 1.773 Test Acc: 0.144
Validation loss decreased (-0.096278 --> -0.144427).  Saving model ...
Epoch: 3 cost time: 0.383805513381958
Epoch: 3, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.710 Vali Acc: 0.233 Test Loss: 1.710 Test Acc: 0.233
Validation loss decreased (-0.144427 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.3960292339324951
Epoch: 4, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.610 Vali Acc: 0.430 Test Loss: 1.610 Test Acc: 0.430
Validation loss decreased (-0.233316 --> -0.429614).  Saving model ...
Epoch: 5 cost time: 0.4011237621307373
Epoch: 5, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.483 Vali Acc: 0.567 Test Loss: 1.483 Test Acc: 0.567
Validation loss decreased (-0.429614 --> -0.566652).  Saving model ...
Epoch: 6 cost time: 0.4097578525543213
Epoch: 6, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.337 Vali Acc: 0.667 Test Loss: 1.337 Test Acc: 0.667
Validation loss decreased (-0.566652 --> -0.666653).  Saving model ...
Epoch: 7 cost time: 0.41150760650634766
Epoch: 7, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.185 Vali Acc: 0.748 Test Loss: 1.185 Test Acc: 0.748
Validation loss decreased (-0.666653 --> -0.748136).  Saving model ...
Epoch: 8 cost time: 0.41974472999572754
Epoch: 8, Steps: 2 | Train Loss: 0.726 Vali Loss: 1.034 Vali Acc: 0.819 Test Loss: 1.034 Test Acc: 0.819
Validation loss decreased (-0.748136 --> -0.818508).  Saving model ...
Epoch: 9 cost time: 0.3725094795227051
Epoch: 9, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.894 Vali Acc: 0.870 Test Loss: 0.894 Test Acc: 0.870
Validation loss decreased (-0.818508 --> -0.870361).  Saving model ...
Epoch: 10 cost time: 0.47104454040527344
Epoch: 10, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.768 Vali Acc: 0.885 Test Loss: 0.768 Test Acc: 0.885
Validation loss decreased (-0.870361 --> -0.885178).  Saving model ...
Epoch: 11 cost time: 0.3936772346496582
Epoch: 11, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.656 Vali Acc: 0.915 Test Loss: 0.656 Test Acc: 0.915
Validation loss decreased (-0.885178 --> -0.914808).  Saving model ...
Epoch: 12 cost time: 0.40891551971435547
Epoch: 12, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.559 Vali Acc: 0.922 Test Loss: 0.559 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922217).  Saving model ...
Epoch: 13 cost time: 0.405684232711792
Epoch: 13, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.478 Vali Acc: 0.930 Test Loss: 0.478 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 14 cost time: 0.39379310607910156
Epoch: 14, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.412 Vali Acc: 0.933 Test Loss: 0.412 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 15 cost time: 0.3898308277130127
Epoch: 15, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 16 cost time: 0.4016900062561035
Epoch: 16, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.397784948348999
Epoch: 17, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.284 Vali Acc: 0.952 Test Loss: 0.284 Test Acc: 0.952
Validation loss decreased (-0.940738 --> -0.951849).  Saving model ...
Epoch: 18 cost time: 0.4281880855560303
Epoch: 18, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.260 Vali Acc: 0.952 Test Loss: 0.260 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 19 cost time: 0.4164552688598633
Epoch: 19, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.242 Vali Acc: 0.956 Test Loss: 0.242 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 20 cost time: 0.4118824005126953
Epoch: 20, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 21 cost time: 0.47358274459838867
Epoch: 21, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 22 cost time: 0.40514397621154785
Epoch: 22, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 23 cost time: 0.39623475074768066
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 24 cost time: 0.4683840274810791
Epoch: 24, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 25 cost time: 0.3685276508331299
Epoch: 25, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 26 cost time: 0.45482730865478516
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.40370845794677734
Epoch: 27, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 28 cost time: 0.4110863208770752
Epoch: 28, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.42304325103759766
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.3775758743286133
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4842672348022461
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.37214088439941406
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.37906622886657715
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.37540340423583984
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4159214496612549
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4304008483886719
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4774301052093506
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 214278
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.682075023651123
Epoch: 1, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.822 Vali Acc: 0.163 Test Loss: 1.822 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.3807220458984375
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.777 Vali Acc: 0.189 Test Loss: 1.777 Test Acc: 0.189
Validation loss decreased (-0.162945 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.37937068939208984
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.723 Vali Acc: 0.259 Test Loss: 1.723 Test Acc: 0.259
Validation loss decreased (-0.188871 --> -0.259242).  Saving model ...
Epoch: 4 cost time: 0.3874664306640625
Epoch: 4, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.643 Vali Acc: 0.381 Test Loss: 1.643 Test Acc: 0.381
Validation loss decreased (-0.259242 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 0.38277339935302734
Epoch: 5, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.537 Vali Acc: 0.448 Test Loss: 1.537 Test Acc: 0.448
Validation loss decreased (-0.381465 --> -0.448133).  Saving model ...
Epoch: 6 cost time: 0.3887300491333008
Epoch: 6, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.414 Vali Acc: 0.556 Test Loss: 1.414 Test Acc: 0.556
Validation loss decreased (-0.448133 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 0.4061245918273926
Epoch: 7, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.281 Vali Acc: 0.685 Test Loss: 1.281 Test Acc: 0.685
Validation loss decreased (-0.555541 --> -0.685172).  Saving model ...
Epoch: 8 cost time: 0.38418054580688477
Epoch: 8, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.143 Vali Acc: 0.781 Test Loss: 1.143 Test Acc: 0.781
Validation loss decreased (-0.685172 --> -0.781470).  Saving model ...
Epoch: 9 cost time: 0.3677976131439209
Epoch: 9, Steps: 2 | Train Loss: 0.741 Vali Loss: 1.006 Vali Acc: 0.819 Test Loss: 1.006 Test Acc: 0.819
Validation loss decreased (-0.781470 --> -0.818508).  Saving model ...
Epoch: 10 cost time: 0.3714029788970947
Epoch: 10, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.877 Vali Acc: 0.856 Test Loss: 0.877 Test Acc: 0.856
Validation loss decreased (-0.818508 --> -0.855547).  Saving model ...
Epoch: 11 cost time: 0.3999755382537842
Epoch: 11, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.760 Vali Acc: 0.881 Test Loss: 0.760 Test Acc: 0.881
Validation loss decreased (-0.855547 --> -0.881474).  Saving model ...
Epoch: 12 cost time: 0.39374518394470215
Epoch: 12, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.660 Vali Acc: 0.911 Test Loss: 0.660 Test Acc: 0.911
Validation loss decreased (-0.881474 --> -0.911105).  Saving model ...
Epoch: 13 cost time: 0.37836551666259766
Epoch: 13, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.573 Vali Acc: 0.922 Test Loss: 0.573 Test Acc: 0.922
Validation loss decreased (-0.911105 --> -0.922216).  Saving model ...
Epoch: 14 cost time: 0.38634228706359863
Epoch: 14, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.500 Vali Acc: 0.922 Test Loss: 0.500 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.3900160789489746
Epoch: 15, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 16 cost time: 0.470883846282959
Epoch: 16, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.394 Vali Acc: 0.926 Test Loss: 0.394 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 17 cost time: 0.4366028308868408
Epoch: 17, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.487231969833374
Epoch: 18, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 19 cost time: 0.381622314453125
Epoch: 19, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 20 cost time: 0.37752556800842285
Epoch: 20, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 21 cost time: 0.3788464069366455
Epoch: 21, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.3904690742492676
Epoch: 22, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.3919351100921631
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.4066901206970215
Epoch: 24, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.41860508918762207
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.41557812690734863
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.3828299045562744
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.4099771976470947
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.213 Vali Acc: 0.952 Test Loss: 0.213 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.3892230987548828
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.38414645195007324
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.3864881992340088
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.5085659027099609
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.3896968364715576
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.3885517120361328
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.43543219566345215
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.3792538642883301
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.4838740825653076
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.46671271324157715
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.4492018222808838
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.3819615840911865
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.4117279052734375
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.39844727516174316
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.3844118118286133
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.3681011199951172
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.42185187339782715
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.45108962059020996
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.4034879207611084
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.3924221992492676
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.40921711921691895
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.4081995487213135
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 199174
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8890540599822998
Epoch: 1, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.728 Vali Acc: 0.322 Test Loss: 1.728 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.37492942810058594
Epoch: 2, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.689 Vali Acc: 0.374 Test Loss: 1.689 Test Acc: 0.374
Validation loss decreased (-0.322205 --> -0.374057).  Saving model ...
Epoch: 3 cost time: 0.3780968189239502
Epoch: 3, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.647 Vali Acc: 0.411 Test Loss: 1.647 Test Acc: 0.411
Validation loss decreased (-0.374057 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 0.3899848461151123
Epoch: 4, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.586 Vali Acc: 0.467 Test Loss: 1.586 Test Acc: 0.467
Validation loss decreased (-0.411095 --> -0.466651).  Saving model ...
Epoch: 5 cost time: 0.370255708694458
Epoch: 5, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.506 Vali Acc: 0.519 Test Loss: 1.506 Test Acc: 0.519
Validation loss decreased (-0.466651 --> -0.518503).  Saving model ...
Epoch: 6 cost time: 0.36673784255981445
Epoch: 6, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.411 Vali Acc: 0.581 Test Loss: 1.411 Test Acc: 0.581
Validation loss decreased (-0.518503 --> -0.581467).  Saving model ...
Epoch: 7 cost time: 0.35965490341186523
Epoch: 7, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.305 Vali Acc: 0.663 Test Loss: 1.305 Test Acc: 0.663
Validation loss decreased (-0.581467 --> -0.662950).  Saving model ...
Epoch: 8 cost time: 0.38315868377685547
Epoch: 8, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.192 Vali Acc: 0.756 Test Loss: 1.192 Test Acc: 0.756
Validation loss decreased (-0.662950 --> -0.755544).  Saving model ...
Epoch: 9 cost time: 0.3562486171722412
Epoch: 9, Steps: 2 | Train Loss: 0.848 Vali Loss: 1.075 Vali Acc: 0.804 Test Loss: 1.075 Test Acc: 0.804
Validation loss decreased (-0.755544 --> -0.803693).  Saving model ...
Epoch: 10 cost time: 0.40296173095703125
Epoch: 10, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.959 Vali Acc: 0.852 Test Loss: 0.959 Test Acc: 0.852
Validation loss decreased (-0.803693 --> -0.851842).  Saving model ...
Epoch: 11 cost time: 0.39157915115356445
Epoch: 11, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.848 Vali Acc: 0.896 Test Loss: 0.848 Test Acc: 0.896
Validation loss decreased (-0.851842 --> -0.896288).  Saving model ...
Epoch: 12 cost time: 0.377042293548584
Epoch: 12, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.746 Vali Acc: 0.911 Test Loss: 0.746 Test Acc: 0.911
Validation loss decreased (-0.896288 --> -0.911104).  Saving model ...
Epoch: 13 cost time: 0.46698451042175293
Epoch: 13, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.654 Vali Acc: 0.937 Test Loss: 0.654 Test Acc: 0.937
Validation loss decreased (-0.911104 --> -0.937030).  Saving model ...
Epoch: 14 cost time: 0.37972140312194824
Epoch: 14, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.574 Vali Acc: 0.944 Test Loss: 0.574 Test Acc: 0.944
Validation loss decreased (-0.937030 --> -0.944439).  Saving model ...
Epoch: 15 cost time: 0.36620163917541504
Epoch: 15, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.506 Vali Acc: 0.952 Test Loss: 0.506 Test Acc: 0.952
Validation loss decreased (-0.944439 --> -0.951847).  Saving model ...
Epoch: 16 cost time: 0.35273098945617676
Epoch: 16, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.447 Vali Acc: 0.948 Test Loss: 0.447 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4079749584197998
Epoch: 17, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.400 Vali Acc: 0.952 Test Loss: 0.400 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 18 cost time: 0.40945911407470703
Epoch: 18, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.363 Vali Acc: 0.952 Test Loss: 0.363 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 19 cost time: 0.3805375099182129
Epoch: 19, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.332 Vali Acc: 0.956 Test Loss: 0.332 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 20 cost time: 0.4494054317474365
Epoch: 20, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.307 Vali Acc: 0.956 Test Loss: 0.307 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 21 cost time: 0.40293359756469727
Epoch: 21, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.286 Vali Acc: 0.956 Test Loss: 0.286 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 22 cost time: 0.36357545852661133
Epoch: 22, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.270 Vali Acc: 0.956 Test Loss: 0.270 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 23 cost time: 0.38442564010620117
Epoch: 23, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.257 Vali Acc: 0.956 Test Loss: 0.257 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 24 cost time: 0.41138410568237305
Epoch: 24, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.956 Test Loss: 0.246 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 25 cost time: 0.40401458740234375
Epoch: 25, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.956 Test Loss: 0.237 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 26 cost time: 0.379749059677124
Epoch: 26, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.230 Vali Acc: 0.956 Test Loss: 0.230 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.36627936363220215
Epoch: 27, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.43137478828430176
Epoch: 28, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.4216623306274414
Epoch: 29, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.36852550506591797
Epoch: 30, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 31 cost time: 0.39704442024230957
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.956 Test Loss: 0.209 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 32 cost time: 0.40862298011779785
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 33 cost time: 0.43833327293395996
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.35885143280029297
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.44109416007995605
Epoch: 35, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 0.38263916969299316
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.3806123733520508
Epoch: 37, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 0.3556208610534668
Epoch: 38, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 39 cost time: 0.38042140007019043
Epoch: 39, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.34018778800964355
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.3633129596710205
Epoch: 41, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.3754308223724365
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 43 cost time: 0.3948636054992676
Epoch: 43, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 44 cost time: 0.40241217613220215
Epoch: 44, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.45580172538757324
Epoch: 45, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 46 cost time: 0.464047908782959
Epoch: 46, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 47 cost time: 0.4658827781677246
Epoch: 47, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.42063164710998535
Epoch: 48, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.41094374656677246
Epoch: 49, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.4300687313079834
Epoch: 50, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 190342
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5662856101989746
Epoch: 1, Steps: 2 | Train Loss: 1.983 Vali Loss: 1.859 Vali Acc: 0.148 Test Loss: 1.859 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.37210702896118164
Epoch: 2, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.830 Vali Acc: 0.200 Test Loss: 1.830 Test Acc: 0.200
Validation loss decreased (-0.148130 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.3600292205810547
Epoch: 3, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.801 Vali Acc: 0.241 Test Loss: 1.801 Test Acc: 0.241
Validation loss decreased (-0.199982 --> -0.240723).  Saving model ...
Epoch: 4 cost time: 0.3816690444946289
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.761 Vali Acc: 0.300 Test Loss: 1.761 Test Acc: 0.300
Validation loss decreased (-0.240723 --> -0.299982).  Saving model ...
Epoch: 5 cost time: 0.373645544052124
Epoch: 5, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.707 Vali Acc: 0.367 Test Loss: 1.707 Test Acc: 0.367
Validation loss decreased (-0.299982 --> -0.366650).  Saving model ...
Epoch: 6 cost time: 0.3781719207763672
Epoch: 6, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.639 Vali Acc: 0.422 Test Loss: 1.639 Test Acc: 0.422
Validation loss decreased (-0.366650 --> -0.422206).  Saving model ...
Epoch: 7 cost time: 0.38804030418395996
Epoch: 7, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.558 Vali Acc: 0.474 Test Loss: 1.558 Test Acc: 0.474
Validation loss decreased (-0.422206 --> -0.474058).  Saving model ...
Epoch: 8 cost time: 0.41107678413391113
Epoch: 8, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.466 Vali Acc: 0.548 Test Loss: 1.466 Test Acc: 0.548
Validation loss decreased (-0.474058 --> -0.548133).  Saving model ...
Epoch: 9 cost time: 0.365614652633667
Epoch: 9, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.366 Vali Acc: 0.615 Test Loss: 1.366 Test Acc: 0.615
Validation loss decreased (-0.548133 --> -0.614801).  Saving model ...
Epoch: 10 cost time: 0.40055418014526367
Epoch: 10, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.263 Vali Acc: 0.719 Test Loss: 1.263 Test Acc: 0.719
Validation loss decreased (-0.614801 --> -0.718506).  Saving model ...
Epoch: 11 cost time: 0.4317197799682617
Epoch: 11, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.156 Vali Acc: 0.774 Test Loss: 1.156 Test Acc: 0.774
Validation loss decreased (-0.718506 --> -0.774063).  Saving model ...
Epoch: 12 cost time: 0.3767120838165283
Epoch: 12, Steps: 2 | Train Loss: 0.757 Vali Loss: 1.052 Vali Acc: 0.815 Test Loss: 1.052 Test Acc: 0.815
Validation loss decreased (-0.774063 --> -0.814804).  Saving model ...
Epoch: 13 cost time: 0.4385075569152832
Epoch: 13, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.952 Vali Acc: 0.844 Test Loss: 0.952 Test Acc: 0.844
Validation loss decreased (-0.814804 --> -0.844435).  Saving model ...
Epoch: 14 cost time: 0.3654327392578125
Epoch: 14, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.858 Vali Acc: 0.874 Test Loss: 0.858 Test Acc: 0.874
Validation loss decreased (-0.844435 --> -0.874065).  Saving model ...
Epoch: 15 cost time: 0.4026968479156494
Epoch: 15, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.774 Vali Acc: 0.885 Test Loss: 0.774 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885177).  Saving model ...
Epoch: 16 cost time: 0.3573751449584961
Epoch: 16, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.696 Vali Acc: 0.885 Test Loss: 0.696 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885178).  Saving model ...
Epoch: 17 cost time: 0.41991281509399414
Epoch: 17, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.626 Vali Acc: 0.893 Test Loss: 0.626 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 18 cost time: 0.3909337520599365
Epoch: 18, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.566 Vali Acc: 0.904 Test Loss: 0.566 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903698).  Saving model ...
Epoch: 19 cost time: 0.3873748779296875
Epoch: 19, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 20 cost time: 0.4240236282348633
Epoch: 20, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.469 Vali Acc: 0.919 Test Loss: 0.469 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 21 cost time: 0.3577232360839844
Epoch: 21, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.431 Vali Acc: 0.926 Test Loss: 0.431 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.3788144588470459
Epoch: 22, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 0.38329172134399414
Epoch: 23, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.372 Vali Acc: 0.926 Test Loss: 0.372 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 24 cost time: 0.3671998977661133
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.351 Vali Acc: 0.930 Test Loss: 0.351 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 25 cost time: 0.39133167266845703
Epoch: 25, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.333 Vali Acc: 0.933 Test Loss: 0.333 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 26 cost time: 0.4342949390411377
Epoch: 26, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 27 cost time: 0.39104366302490234
Epoch: 27, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.39748430252075195
Epoch: 28, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 29 cost time: 0.40880727767944336
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 30 cost time: 0.3964238166809082
Epoch: 30, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.279 Vali Acc: 0.944 Test Loss: 0.279 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.3637356758117676
Epoch: 31, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.39581990242004395
Epoch: 32, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.3575770854949951
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.262 Vali Acc: 0.948 Test Loss: 0.262 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.36414265632629395
Epoch: 34, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.259 Vali Acc: 0.952 Test Loss: 0.259 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.4663505554199219
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.255 Vali Acc: 0.952 Test Loss: 0.255 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.37849903106689453
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.41323041915893555
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.4286792278289795
Epoch: 38, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.246 Vali Acc: 0.952 Test Loss: 0.246 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.38144969940185547
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.244 Vali Acc: 0.952 Test Loss: 0.244 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.38272666931152344
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.952 Test Loss: 0.241 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.4026346206665039
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.3924522399902344
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.952 Test Loss: 0.237 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.40615415573120117
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.235 Vali Acc: 0.952 Test Loss: 0.235 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.36348986625671387
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.3916962146759033
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.956 Test Loss: 0.231 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.419421911239624
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.4095420837402344
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.39068126678466797
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.3730127811431885
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.36432409286499023
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.223 Vali Acc: 0.956 Test Loss: 0.223 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 178438
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4895312786102295
Epoch: 1, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.809 Vali Acc: 0.244 Test Loss: 1.809 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 0.3612637519836426
Epoch: 2, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.780 Vali Acc: 0.256 Test Loss: 1.780 Test Acc: 0.256
Validation loss decreased (-0.244426 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.37371087074279785
Epoch: 3, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.753 Vali Acc: 0.307 Test Loss: 1.753 Test Acc: 0.307
Validation loss decreased (-0.255538 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.3486192226409912
Epoch: 4, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.718 Vali Acc: 0.341 Test Loss: 1.718 Test Acc: 0.341
Validation loss decreased (-0.307390 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.3793509006500244
Epoch: 5, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.671 Vali Acc: 0.422 Test Loss: 1.671 Test Acc: 0.422
Validation loss decreased (-0.340724 --> -0.422206).  Saving model ...
Epoch: 6 cost time: 0.3604698181152344
Epoch: 6, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.612 Vali Acc: 0.526 Test Loss: 1.612 Test Acc: 0.526
Validation loss decreased (-0.422206 --> -0.525910).  Saving model ...
Epoch: 7 cost time: 0.39053821563720703
Epoch: 7, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.545 Vali Acc: 0.578 Test Loss: 1.545 Test Acc: 0.578
Validation loss decreased (-0.525910 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.40950751304626465
Epoch: 8, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.470 Vali Acc: 0.644 Test Loss: 1.470 Test Acc: 0.644
Validation loss decreased (-0.577762 --> -0.644430).  Saving model ...
Epoch: 9 cost time: 0.36834144592285156
Epoch: 9, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.389 Vali Acc: 0.656 Test Loss: 1.389 Test Acc: 0.656
Validation loss decreased (-0.644430 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 0.3736989498138428
Epoch: 10, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.306 Vali Acc: 0.681 Test Loss: 1.306 Test Acc: 0.681
Validation loss decreased (-0.655542 --> -0.681468).  Saving model ...
Epoch: 11 cost time: 0.351804256439209
Epoch: 11, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.219 Vali Acc: 0.722 Test Loss: 1.219 Test Acc: 0.722
Validation loss decreased (-0.681468 --> -0.722210).  Saving model ...
Epoch: 12 cost time: 0.3471336364746094
Epoch: 12, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.132 Vali Acc: 0.759 Test Loss: 1.132 Test Acc: 0.759
Validation loss decreased (-0.722210 --> -0.759248).  Saving model ...
Epoch: 13 cost time: 0.3487517833709717
Epoch: 13, Steps: 2 | Train Loss: 0.859 Vali Loss: 1.045 Vali Acc: 0.781 Test Loss: 1.045 Test Acc: 0.781
Validation loss decreased (-0.759248 --> -0.781471).  Saving model ...
Epoch: 14 cost time: 0.3562345504760742
Epoch: 14, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.964 Vali Acc: 0.800 Test Loss: 0.964 Test Acc: 0.800
Validation loss decreased (-0.781471 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 0.35652971267700195
Epoch: 15, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.886 Vali Acc: 0.830 Test Loss: 0.886 Test Acc: 0.830
Validation loss decreased (-0.799990 --> -0.829621).  Saving model ...
Epoch: 16 cost time: 0.3467588424682617
Epoch: 16, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.813 Vali Acc: 0.852 Test Loss: 0.813 Test Acc: 0.852
Validation loss decreased (-0.829621 --> -0.851844).  Saving model ...
Epoch: 17 cost time: 0.4415581226348877
Epoch: 17, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.745 Vali Acc: 0.863 Test Loss: 0.745 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862956).  Saving model ...
Epoch: 18 cost time: 0.3599226474761963
Epoch: 18, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.684 Vali Acc: 0.878 Test Loss: 0.684 Test Acc: 0.878
Validation loss decreased (-0.862956 --> -0.877771).  Saving model ...
Epoch: 19 cost time: 0.3488655090332031
Epoch: 19, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.628 Vali Acc: 0.889 Test Loss: 0.628 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 0.39179325103759766
Epoch: 20, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.578 Vali Acc: 0.907 Test Loss: 0.578 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907402).  Saving model ...
Epoch: 21 cost time: 0.4006984233856201
Epoch: 21, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.533 Vali Acc: 0.915 Test Loss: 0.533 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 22 cost time: 0.4064505100250244
Epoch: 22, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.493 Vali Acc: 0.919 Test Loss: 0.493 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918514).  Saving model ...
Epoch: 23 cost time: 0.37108325958251953
Epoch: 23, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.459 Vali Acc: 0.915 Test Loss: 0.459 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.38672304153442383
Epoch: 24, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 25 cost time: 0.3868248462677002
Epoch: 25, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.404 Vali Acc: 0.926 Test Loss: 0.404 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 26 cost time: 0.3777191638946533
Epoch: 26, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 27 cost time: 0.3964564800262451
Epoch: 27, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.365 Vali Acc: 0.933 Test Loss: 0.365 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 28 cost time: 0.3579368591308594
Epoch: 28, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.349 Vali Acc: 0.937 Test Loss: 0.349 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 29 cost time: 0.4137418270111084
Epoch: 29, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.336 Vali Acc: 0.937 Test Loss: 0.336 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.4733123779296875
Epoch: 30, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.3462059497833252
Epoch: 31, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.3574373722076416
Epoch: 32, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 33 cost time: 0.347137451171875
Epoch: 33, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.297 Vali Acc: 0.948 Test Loss: 0.297 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 34 cost time: 0.4660642147064209
Epoch: 34, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.290 Vali Acc: 0.952 Test Loss: 0.290 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.3853003978729248
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.283 Vali Acc: 0.956 Test Loss: 0.283 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.39791417121887207
Epoch: 36, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.277 Vali Acc: 0.956 Test Loss: 0.277 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.4334747791290283
Epoch: 37, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.272 Vali Acc: 0.956 Test Loss: 0.272 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.46416711807250977
Epoch: 38, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.267 Vali Acc: 0.956 Test Loss: 0.267 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.3805363178253174
Epoch: 39, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.263 Vali Acc: 0.956 Test Loss: 0.263 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 0.3696763515472412
Epoch: 40, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.259 Vali Acc: 0.959 Test Loss: 0.259 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 41 cost time: 0.35344457626342773
Epoch: 41, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.256 Vali Acc: 0.959 Test Loss: 0.256 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 42 cost time: 0.3551607131958008
Epoch: 42, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.253 Vali Acc: 0.959 Test Loss: 0.253 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 43 cost time: 0.3887157440185547
Epoch: 43, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.250 Vali Acc: 0.959 Test Loss: 0.250 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 44 cost time: 0.3690767288208008
Epoch: 44, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.247 Vali Acc: 0.959 Test Loss: 0.247 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 45 cost time: 0.362321138381958
Epoch: 45, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.245 Vali Acc: 0.959 Test Loss: 0.245 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 46 cost time: 0.34671521186828613
Epoch: 46, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.243 Vali Acc: 0.959 Test Loss: 0.243 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 47 cost time: 0.4209151268005371
Epoch: 47, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.241 Vali Acc: 0.959 Test Loss: 0.241 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 48 cost time: 0.35039806365966797
Epoch: 48, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.239 Vali Acc: 0.959 Test Loss: 0.239 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 49 cost time: 0.39699363708496094
Epoch: 49, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.959 Test Loss: 0.237 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 50 cost time: 0.3737525939941406
Epoch: 50, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.236 Vali Acc: 0.959 Test Loss: 0.236 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 172806
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4225690364837646
Epoch: 1, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.772 Vali Acc: 0.115 Test Loss: 1.772 Test Acc: 0.115
Validation loss decreased (inf --> -0.114797).  Saving model ...
Epoch: 2 cost time: 0.3547403812408447
Epoch: 2, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.704 Vali Acc: 0.222 Test Loss: 1.704 Test Acc: 0.222
Validation loss decreased (-0.114797 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.3401174545288086
Epoch: 3, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.614 Vali Acc: 0.507 Test Loss: 1.614 Test Acc: 0.507
Validation loss decreased (-0.222205 --> -0.507391).  Saving model ...
Epoch: 4 cost time: 0.3192570209503174
Epoch: 4, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.465 Vali Acc: 0.670 Test Loss: 1.465 Test Acc: 0.670
Validation loss decreased (-0.507391 --> -0.670356).  Saving model ...
Epoch: 5 cost time: 0.36728429794311523
Epoch: 5, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.283 Vali Acc: 0.767 Test Loss: 1.283 Test Acc: 0.767
Validation loss decreased (-0.670356 --> -0.766654).  Saving model ...
Epoch: 6 cost time: 0.3331418037414551
Epoch: 6, Steps: 2 | Train Loss: 0.842 Vali Loss: 1.089 Vali Acc: 0.819 Test Loss: 1.089 Test Acc: 0.819
Validation loss decreased (-0.766654 --> -0.818508).  Saving model ...
Epoch: 7 cost time: 0.3380763530731201
Epoch: 7, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.906 Vali Acc: 0.870 Test Loss: 0.906 Test Acc: 0.870
Validation loss decreased (-0.818508 --> -0.870361).  Saving model ...
Epoch: 8 cost time: 0.3119232654571533
Epoch: 8, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.750 Vali Acc: 0.889 Test Loss: 0.750 Test Acc: 0.889
Validation loss decreased (-0.870361 --> -0.888881).  Saving model ...
Epoch: 9 cost time: 0.39063119888305664
Epoch: 9, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.621 Vali Acc: 0.904 Test Loss: 0.621 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903697).  Saving model ...
Epoch: 10 cost time: 0.3642454147338867
Epoch: 10, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.514 Vali Acc: 0.911 Test Loss: 0.514 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911106).  Saving model ...
Epoch: 11 cost time: 0.35318779945373535
Epoch: 11, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.427 Vali Acc: 0.915 Test Loss: 0.427 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914811).  Saving model ...
Epoch: 12 cost time: 0.3798508644104004
Epoch: 12, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 13 cost time: 0.4320104122161865
Epoch: 13, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 14 cost time: 0.3874995708465576
Epoch: 14, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 15 cost time: 0.3585066795349121
Epoch: 15, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.34841322898864746
Epoch: 16, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.35474133491516113
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 18 cost time: 0.34704065322875977
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 19 cost time: 0.3522827625274658
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 20 cost time: 0.31789469718933105
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 0.379253625869751
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.3880171775817871
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.3305087089538574
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.36406803131103516
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.3813943862915039
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.3516883850097656
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.3540527820587158
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.43825340270996094
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.48390984535217285
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.40192151069641113
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.36682891845703125
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.3570597171783447
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.3759481906890869
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.34220242500305176
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.3804311752319336
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.36005187034606934
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.3431060314178467
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.40305137634277344
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.34908223152160645
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.39893555641174316
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.4272730350494385
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.3446683883666992
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.41896939277648926
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.5327951908111572
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.3625047206878662
Epoch: 45, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.3798089027404785
Epoch: 46, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.36448168754577637
Epoch: 47, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.37274599075317383
Epoch: 48, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.3772125244140625
Epoch: 49, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.3554961681365967
Epoch: 50, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 141766
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6935889720916748
Epoch: 1, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.753 Vali Acc: 0.226 Test Loss: 1.753 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.3307657241821289
Epoch: 2, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.710 Vali Acc: 0.322 Test Loss: 1.710 Test Acc: 0.322
Validation loss decreased (-0.225908 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 0.36826610565185547
Epoch: 3, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.661 Vali Acc: 0.396 Test Loss: 1.661 Test Acc: 0.396
Validation loss decreased (-0.322205 --> -0.396280).  Saving model ...
Epoch: 4 cost time: 0.3699924945831299
Epoch: 4, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.588 Vali Acc: 0.474 Test Loss: 1.588 Test Acc: 0.474
Validation loss decreased (-0.396280 --> -0.474058).  Saving model ...
Epoch: 5 cost time: 0.3608255386352539
Epoch: 5, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.491 Vali Acc: 0.541 Test Loss: 1.491 Test Acc: 0.541
Validation loss decreased (-0.474058 --> -0.540726).  Saving model ...
Epoch: 6 cost time: 0.3558981418609619
Epoch: 6, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.374 Vali Acc: 0.604 Test Loss: 1.374 Test Acc: 0.604
Validation loss decreased (-0.540726 --> -0.603690).  Saving model ...
Epoch: 7 cost time: 0.44868898391723633
Epoch: 7, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.247 Vali Acc: 0.681 Test Loss: 1.247 Test Acc: 0.681
Validation loss decreased (-0.603690 --> -0.681469).  Saving model ...
Epoch: 8 cost time: 0.3413705825805664
Epoch: 8, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.115 Vali Acc: 0.793 Test Loss: 1.115 Test Acc: 0.793
Validation loss decreased (-0.681469 --> -0.792581).  Saving model ...
Epoch: 9 cost time: 0.36741209030151367
Epoch: 9, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.988 Vali Acc: 0.852 Test Loss: 0.988 Test Acc: 0.852
Validation loss decreased (-0.792581 --> -0.851842).  Saving model ...
Epoch: 10 cost time: 0.3520243167877197
Epoch: 10, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.870 Vali Acc: 0.881 Test Loss: 0.870 Test Acc: 0.881
Validation loss decreased (-0.851842 --> -0.881473).  Saving model ...
Epoch: 11 cost time: 0.35921359062194824
Epoch: 11, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.762 Vali Acc: 0.885 Test Loss: 0.762 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885178).  Saving model ...
Epoch: 12 cost time: 0.346301794052124
Epoch: 12, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.666 Vali Acc: 0.904 Test Loss: 0.666 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 13 cost time: 0.3162839412689209
Epoch: 13, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.580 Vali Acc: 0.911 Test Loss: 0.580 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 14 cost time: 0.5196869373321533
Epoch: 14, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.508 Vali Acc: 0.919 Test Loss: 0.508 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 15 cost time: 0.4006996154785156
Epoch: 15, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.449 Vali Acc: 0.926 Test Loss: 0.449 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.3852829933166504
Epoch: 16, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.403 Vali Acc: 0.919 Test Loss: 0.403 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.37722182273864746
Epoch: 17, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.362 Vali Acc: 0.933 Test Loss: 0.362 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.3634662628173828
Epoch: 18, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 19 cost time: 0.37972378730773926
Epoch: 19, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 20 cost time: 0.33750247955322266
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.41646265983581543
Epoch: 21, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.41147446632385254
Epoch: 22, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.3485879898071289
Epoch: 23, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.3965108394622803
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.3855159282684326
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.3595750331878662
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.3818051815032959
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3800375461578369
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.3868749141693115
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.3361508846282959
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.3665435314178467
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.36900782585144043
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.43207716941833496
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.37796449661254883
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.3790273666381836
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.37472963333129883
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.3833646774291992
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.37391138076782227
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 39 cost time: 0.39258551597595215
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.36678600311279297
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4022068977355957
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.35689830780029297
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.3380248546600342
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.3493833541870117
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.34220027923583984
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.3778824806213379
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.37230658531188965
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.4134242534637451
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.3891105651855469
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 50 cost time: 0.4758002758026123
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 91206
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5702080726623535
Epoch: 1, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.740 Vali Acc: 0.330 Test Loss: 1.740 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.40529870986938477
Epoch: 2, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.697 Vali Acc: 0.363 Test Loss: 1.697 Test Acc: 0.363
Validation loss decreased (-0.329612 --> -0.362946).  Saving model ...
Epoch: 3 cost time: 0.4028053283691406
Epoch: 3, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.654 Vali Acc: 0.419 Test Loss: 1.654 Test Acc: 0.419
Validation loss decreased (-0.362946 --> -0.418502).  Saving model ...
Epoch: 4 cost time: 0.37160420417785645
Epoch: 4, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.597 Vali Acc: 0.467 Test Loss: 1.597 Test Acc: 0.467
Validation loss decreased (-0.418502 --> -0.466651).  Saving model ...
Epoch: 5 cost time: 0.39867353439331055
Epoch: 5, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.523 Vali Acc: 0.530 Test Loss: 1.523 Test Acc: 0.530
Validation loss decreased (-0.466651 --> -0.529614).  Saving model ...
Epoch: 6 cost time: 0.3817603588104248
Epoch: 6, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.435 Vali Acc: 0.630 Test Loss: 1.435 Test Acc: 0.630
Validation loss decreased (-0.529614 --> -0.629615).  Saving model ...
Epoch: 7 cost time: 0.4066472053527832
Epoch: 7, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.337 Vali Acc: 0.719 Test Loss: 1.337 Test Acc: 0.719
Validation loss decreased (-0.629615 --> -0.718505).  Saving model ...
Epoch: 8 cost time: 0.3707878589630127
Epoch: 8, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.233 Vali Acc: 0.763 Test Loss: 1.233 Test Acc: 0.763
Validation loss decreased (-0.718505 --> -0.762951).  Saving model ...
Epoch: 9 cost time: 0.38634634017944336
Epoch: 9, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.125 Vali Acc: 0.819 Test Loss: 1.125 Test Acc: 0.819
Validation loss decreased (-0.762951 --> -0.818507).  Saving model ...
Epoch: 10 cost time: 0.3604278564453125
Epoch: 10, Steps: 2 | Train Loss: 0.838 Vali Loss: 1.020 Vali Acc: 0.833 Test Loss: 1.020 Test Acc: 0.833
Validation loss decreased (-0.818507 --> -0.833323).  Saving model ...
Epoch: 11 cost time: 0.38217711448669434
Epoch: 11, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.918 Vali Acc: 0.874 Test Loss: 0.918 Test Acc: 0.874
Validation loss decreased (-0.833323 --> -0.874065).  Saving model ...
Epoch: 12 cost time: 0.391085147857666
Epoch: 12, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.821 Vali Acc: 0.904 Test Loss: 0.821 Test Acc: 0.904
Validation loss decreased (-0.874065 --> -0.903695).  Saving model ...
Epoch: 13 cost time: 0.37031078338623047
Epoch: 13, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.732 Vali Acc: 0.915 Test Loss: 0.732 Test Acc: 0.915
Validation loss decreased (-0.903695 --> -0.914807).  Saving model ...
Epoch: 14 cost time: 0.41654396057128906
Epoch: 14, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.653 Vali Acc: 0.919 Test Loss: 0.653 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918512).  Saving model ...
Epoch: 15 cost time: 0.3815467357635498
Epoch: 15, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.584 Vali Acc: 0.926 Test Loss: 0.584 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 16 cost time: 0.3582577705383301
Epoch: 16, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.523 Vali Acc: 0.930 Test Loss: 0.523 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 17 cost time: 0.4153294563293457
Epoch: 17, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.469 Vali Acc: 0.937 Test Loss: 0.469 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 18 cost time: 0.40170741081237793
Epoch: 18, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.424 Vali Acc: 0.944 Test Loss: 0.424 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 19 cost time: 0.3589286804199219
Epoch: 19, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.386 Vali Acc: 0.944 Test Loss: 0.386 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.37967681884765625
Epoch: 20, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.355 Vali Acc: 0.948 Test Loss: 0.355 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 21 cost time: 0.4022836685180664
Epoch: 21, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.329 Vali Acc: 0.948 Test Loss: 0.329 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.43048787117004395
Epoch: 22, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 23 cost time: 0.4595310688018799
Epoch: 23, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.40137529373168945
Epoch: 24, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.276 Vali Acc: 0.948 Test Loss: 0.276 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 25 cost time: 0.439363956451416
Epoch: 25, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.4287993907928467
Epoch: 26, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 27 cost time: 0.43511438369750977
Epoch: 27, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.247 Vali Acc: 0.952 Test Loss: 0.247 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 28 cost time: 0.380756139755249
Epoch: 28, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 29 cost time: 0.42049598693847656
Epoch: 29, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.952 Test Loss: 0.235 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.40460968017578125
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.43656134605407715
Epoch: 31, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.227 Vali Acc: 0.952 Test Loss: 0.227 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.4323146343231201
Epoch: 32, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.424238920211792
Epoch: 33, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 0.4363837242126465
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.42073726654052734
Epoch: 35, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.43312931060791016
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.45493483543395996
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.4062473773956299
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.46292543411254883
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.4325225353240967
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.45189356803894043
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.4199528694152832
Epoch: 42, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.42260122299194336
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.5382370948791504
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.45634913444519043
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.42795872688293457
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.44446301460266113
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.3882122039794922
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.40981101989746094
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.3989531993865967
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 74374
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.666954755783081
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.781 Vali Acc: 0.130 Test Loss: 1.781 Test Acc: 0.130
Validation loss decreased (inf --> -0.129612).  Saving model ...
Epoch: 2 cost time: 0.33864307403564453
Epoch: 2, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.746 Vali Acc: 0.159 Test Loss: 1.746 Test Acc: 0.159
Validation loss decreased (-0.129612 --> -0.159242).  Saving model ...
Epoch: 3 cost time: 0.3446807861328125
Epoch: 3, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.713 Vali Acc: 0.244 Test Loss: 1.713 Test Acc: 0.244
Validation loss decreased (-0.159242 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.34569430351257324
Epoch: 4, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.671 Vali Acc: 0.333 Test Loss: 1.671 Test Acc: 0.333
Validation loss decreased (-0.244427 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.34972596168518066
Epoch: 5, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.616 Vali Acc: 0.433 Test Loss: 1.616 Test Acc: 0.433
Validation loss decreased (-0.333317 --> -0.433317).  Saving model ...
Epoch: 6 cost time: 0.39125657081604004
Epoch: 6, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.550 Vali Acc: 0.504 Test Loss: 1.550 Test Acc: 0.504
Validation loss decreased (-0.433317 --> -0.503688).  Saving model ...
Epoch: 7 cost time: 0.3830444812774658
Epoch: 7, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.474 Vali Acc: 0.556 Test Loss: 1.474 Test Acc: 0.556
Validation loss decreased (-0.503688 --> -0.555541).  Saving model ...
Epoch: 8 cost time: 0.3548140525817871
Epoch: 8, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
Validation loss decreased (-0.555541 --> -0.581468).  Saving model ...
Epoch: 9 cost time: 0.3623530864715576
Epoch: 9, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.304 Vali Acc: 0.659 Test Loss: 1.304 Test Acc: 0.659
Validation loss decreased (-0.581468 --> -0.659246).  Saving model ...
Epoch: 10 cost time: 0.3438878059387207
Epoch: 10, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.213 Vali Acc: 0.719 Test Loss: 1.213 Test Acc: 0.719
Validation loss decreased (-0.659246 --> -0.718506).  Saving model ...
Epoch: 11 cost time: 0.37271738052368164
Epoch: 11, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.122 Vali Acc: 0.774 Test Loss: 1.122 Test Acc: 0.774
Validation loss decreased (-0.718506 --> -0.774063).  Saving model ...
Epoch: 12 cost time: 0.3493318557739258
Epoch: 12, Steps: 2 | Train Loss: 0.906 Vali Loss: 1.031 Vali Acc: 0.822 Test Loss: 1.031 Test Acc: 0.822
Validation loss decreased (-0.774063 --> -0.822212).  Saving model ...
Epoch: 13 cost time: 0.3431060314178467
Epoch: 13, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.944 Vali Acc: 0.852 Test Loss: 0.944 Test Acc: 0.852
Validation loss decreased (-0.822212 --> -0.851842).  Saving model ...
Epoch: 14 cost time: 0.3397634029388428
Epoch: 14, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.862 Vali Acc: 0.889 Test Loss: 0.862 Test Acc: 0.889
Validation loss decreased (-0.851842 --> -0.888880).  Saving model ...
Epoch: 15 cost time: 0.34387636184692383
Epoch: 15, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.787 Vali Acc: 0.900 Test Loss: 0.787 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.3382875919342041
Epoch: 16, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.718 Vali Acc: 0.922 Test Loss: 0.718 Test Acc: 0.922
Validation loss decreased (-0.899992 --> -0.922215).  Saving model ...
Epoch: 17 cost time: 0.37369775772094727
Epoch: 17, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.654 Vali Acc: 0.926 Test Loss: 0.654 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 18 cost time: 0.3218083381652832
Epoch: 18, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.598 Vali Acc: 0.922 Test Loss: 0.598 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.37193727493286133
Epoch: 19, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.546 Vali Acc: 0.922 Test Loss: 0.546 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.38287353515625
Epoch: 20, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.502 Vali Acc: 0.922 Test Loss: 0.502 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.39476537704467773
Epoch: 21, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.462 Vali Acc: 0.922 Test Loss: 0.462 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.37487149238586426
Epoch: 22, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.427 Vali Acc: 0.933 Test Loss: 0.427 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933329).  Saving model ...
Epoch: 23 cost time: 0.40526747703552246
Epoch: 23, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.397 Vali Acc: 0.937 Test Loss: 0.397 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 24 cost time: 0.35593724250793457
Epoch: 24, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.372 Vali Acc: 0.941 Test Loss: 0.372 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 25 cost time: 0.33729004859924316
Epoch: 25, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.350 Vali Acc: 0.944 Test Loss: 0.350 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 0.3601827621459961
Epoch: 26, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.332 Vali Acc: 0.944 Test Loss: 0.332 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 0.3514561653137207
Epoch: 27, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3995368480682373
Epoch: 28, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.33547091484069824
Epoch: 29, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.3834991455078125
Epoch: 30, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.3432943820953369
Epoch: 31, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.36379432678222656
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.38901233673095703
Epoch: 33, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.37989306449890137
Epoch: 34, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4144096374511719
Epoch: 35, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.3525407314300537
Epoch: 36, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.36655712127685547
Epoch: 37, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.3299548625946045
Epoch: 38, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.3590579032897949
Epoch: 39, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.3379974365234375
Epoch: 40, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.3882157802581787
Epoch: 41, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.33991050720214844
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.38413143157958984
Epoch: 43, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.3473024368286133
Epoch: 44, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.3358776569366455
Epoch: 45, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.225 Vali Acc: 0.952 Test Loss: 0.225 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.35769128799438477
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.35405921936035156
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.3698756694793701
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.3820774555206299
Epoch: 49, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.35393381118774414
Epoch: 50, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 66822
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.63161301612854
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.774 Vali Acc: 0.219 Test Loss: 1.774 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.39154744148254395
Epoch: 2, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.743 Vali Acc: 0.270 Test Loss: 1.743 Test Acc: 0.270
Validation loss decreased (-0.218501 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.36739420890808105
Epoch: 3, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.713 Vali Acc: 0.307 Test Loss: 1.713 Test Acc: 0.307
Validation loss decreased (-0.270353 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.3573882579803467
Epoch: 4, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.677 Vali Acc: 0.352 Test Loss: 1.677 Test Acc: 0.352
Validation loss decreased (-0.307390 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 0.3546020984649658
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.630 Vali Acc: 0.419 Test Loss: 1.630 Test Acc: 0.419
Validation loss decreased (-0.351835 --> -0.418502).  Saving model ...
Epoch: 6 cost time: 0.370743989944458
Epoch: 6, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.574 Vali Acc: 0.500 Test Loss: 1.574 Test Acc: 0.500
Validation loss decreased (-0.418502 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 0.3725876808166504
Epoch: 7, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.508 Vali Acc: 0.596 Test Loss: 1.508 Test Acc: 0.596
Validation loss decreased (-0.499984 --> -0.596281).  Saving model ...
Epoch: 8 cost time: 0.37408900260925293
Epoch: 8, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.435 Vali Acc: 0.667 Test Loss: 1.435 Test Acc: 0.667
Validation loss decreased (-0.596281 --> -0.666652).  Saving model ...
Epoch: 9 cost time: 0.3605170249938965
Epoch: 9, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.357 Vali Acc: 0.722 Test Loss: 1.357 Test Acc: 0.722
Validation loss decreased (-0.666652 --> -0.722209).  Saving model ...
Epoch: 10 cost time: 0.38267970085144043
Epoch: 10, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.275 Vali Acc: 0.759 Test Loss: 1.275 Test Acc: 0.759
Validation loss decreased (-0.722209 --> -0.759247).  Saving model ...
Epoch: 11 cost time: 0.43592238426208496
Epoch: 11, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.193 Vali Acc: 0.796 Test Loss: 1.193 Test Acc: 0.796
Validation loss decreased (-0.759247 --> -0.796284).  Saving model ...
Epoch: 12 cost time: 0.35744738578796387
Epoch: 12, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.110 Vali Acc: 0.819 Test Loss: 1.110 Test Acc: 0.819
Validation loss decreased (-0.796284 --> -0.818507).  Saving model ...
Epoch: 13 cost time: 0.3560488224029541
Epoch: 13, Steps: 2 | Train Loss: 0.870 Vali Loss: 1.028 Vali Acc: 0.863 Test Loss: 1.028 Test Acc: 0.863
Validation loss decreased (-0.818507 --> -0.862953).  Saving model ...
Epoch: 14 cost time: 0.3496429920196533
Epoch: 14, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.948 Vali Acc: 0.878 Test Loss: 0.948 Test Acc: 0.878
Validation loss decreased (-0.862953 --> -0.877768).  Saving model ...
Epoch: 15 cost time: 0.3459458351135254
Epoch: 15, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.872 Vali Acc: 0.896 Test Loss: 0.872 Test Acc: 0.896
Validation loss decreased (-0.877768 --> -0.896288).  Saving model ...
Epoch: 16 cost time: 0.354111909866333
Epoch: 16, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.801 Vali Acc: 0.919 Test Loss: 0.801 Test Acc: 0.919
Validation loss decreased (-0.896288 --> -0.918511).  Saving model ...
Epoch: 17 cost time: 0.3862593173980713
Epoch: 17, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.735 Vali Acc: 0.926 Test Loss: 0.735 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 18 cost time: 0.3655672073364258
Epoch: 18, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.675 Vali Acc: 0.922 Test Loss: 0.675 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.37881946563720703
Epoch: 19, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.621 Vali Acc: 0.937 Test Loss: 0.621 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937031).  Saving model ...
Epoch: 20 cost time: 0.3669264316558838
Epoch: 20, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.571 Vali Acc: 0.941 Test Loss: 0.571 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 21 cost time: 0.4181346893310547
Epoch: 21, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.528 Vali Acc: 0.941 Test Loss: 0.528 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 22 cost time: 0.3584458827972412
Epoch: 22, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.489 Vali Acc: 0.952 Test Loss: 0.489 Test Acc: 0.952
Validation loss decreased (-0.940735 --> -0.951847).  Saving model ...
Epoch: 23 cost time: 0.4369995594024658
Epoch: 23, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.454 Vali Acc: 0.948 Test Loss: 0.454 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.400188684463501
Epoch: 24, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.423 Vali Acc: 0.944 Test Loss: 0.423 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.35161352157592773
Epoch: 25, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.396 Vali Acc: 0.948 Test Loss: 0.396 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.37364673614501953
Epoch: 26, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.373 Vali Acc: 0.948 Test Loss: 0.373 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.3919055461883545
Epoch: 27, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.353 Vali Acc: 0.952 Test Loss: 0.353 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951848).  Saving model ...
Epoch: 28 cost time: 0.3699803352355957
Epoch: 28, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.337 Vali Acc: 0.952 Test Loss: 0.337 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 29 cost time: 0.3568251132965088
Epoch: 29, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.322 Vali Acc: 0.952 Test Loss: 0.322 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 30 cost time: 0.357926607131958
Epoch: 30, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.952 Test Loss: 0.310 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.41396474838256836
Epoch: 31, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.300 Vali Acc: 0.952 Test Loss: 0.300 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.4293990135192871
Epoch: 32, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.291 Vali Acc: 0.952 Test Loss: 0.291 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 33 cost time: 0.35308194160461426
Epoch: 33, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.283 Vali Acc: 0.952 Test Loss: 0.283 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.408203125
Epoch: 34, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.275 Vali Acc: 0.952 Test Loss: 0.275 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.3705618381500244
Epoch: 35, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.269 Vali Acc: 0.952 Test Loss: 0.269 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.47344255447387695
Epoch: 36, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.4372062683105469
Epoch: 37, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.258 Vali Acc: 0.952 Test Loss: 0.258 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.3549041748046875
Epoch: 38, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.37841296195983887
Epoch: 39, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.3727898597717285
Epoch: 40, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.246 Vali Acc: 0.952 Test Loss: 0.246 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.36639857292175293
Epoch: 41, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.243 Vali Acc: 0.952 Test Loss: 0.243 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.36603403091430664
Epoch: 42, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.4035649299621582
Epoch: 43, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.952 Test Loss: 0.237 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.366391658782959
Epoch: 44, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.952 Test Loss: 0.234 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.38378405570983887
Epoch: 45, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.3501927852630615
Epoch: 46, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.3732912540435791
Epoch: 47, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4115610122680664
Epoch: 48, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.38490915298461914
Epoch: 49, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.3749864101409912
Epoch: 50, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 62406
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6719002723693848
Epoch: 1, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.904 Vali Acc: 0.041 Test Loss: 1.904 Test Acc: 0.041
Validation loss decreased (inf --> -0.040722).  Saving model ...
Epoch: 2 cost time: 0.39738011360168457
Epoch: 2, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.881 Vali Acc: 0.056 Test Loss: 1.881 Test Acc: 0.056
Validation loss decreased (-0.040722 --> -0.055537).  Saving model ...
Epoch: 3 cost time: 0.3907129764556885
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.862 Vali Acc: 0.089 Test Loss: 1.862 Test Acc: 0.089
Validation loss decreased (-0.055537 --> -0.088870).  Saving model ...
Epoch: 4 cost time: 0.4306654930114746
Epoch: 4, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.840 Vali Acc: 0.130 Test Loss: 1.840 Test Acc: 0.130
Validation loss decreased (-0.088870 --> -0.129611).  Saving model ...
Epoch: 5 cost time: 0.4091379642486572
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.811 Vali Acc: 0.170 Test Loss: 1.811 Test Acc: 0.170
Validation loss decreased (-0.129611 --> -0.170352).  Saving model ...
Epoch: 6 cost time: 0.4111623764038086
Epoch: 6, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.774 Vali Acc: 0.219 Test Loss: 1.774 Test Acc: 0.219
Validation loss decreased (-0.170352 --> -0.218501).  Saving model ...
Epoch: 7 cost time: 0.37856554985046387
Epoch: 7, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.730 Vali Acc: 0.311 Test Loss: 1.730 Test Acc: 0.311
Validation loss decreased (-0.218501 --> -0.311094).  Saving model ...
Epoch: 8 cost time: 0.4415555000305176
Epoch: 8, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.679 Vali Acc: 0.393 Test Loss: 1.679 Test Acc: 0.393
Validation loss decreased (-0.311094 --> -0.392576).  Saving model ...
Epoch: 9 cost time: 0.42639970779418945
Epoch: 9, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.623 Vali Acc: 0.470 Test Loss: 1.623 Test Acc: 0.470
Validation loss decreased (-0.392576 --> -0.470354).  Saving model ...
Epoch: 10 cost time: 0.3584268093109131
Epoch: 10, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.561 Vali Acc: 0.522 Test Loss: 1.561 Test Acc: 0.522
Validation loss decreased (-0.470354 --> -0.522207).  Saving model ...
Epoch: 11 cost time: 0.37850427627563477
Epoch: 11, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.496 Vali Acc: 0.570 Test Loss: 1.496 Test Acc: 0.570
Validation loss decreased (-0.522207 --> -0.570355).  Saving model ...
Epoch: 12 cost time: 0.3564143180847168
Epoch: 12, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.427 Vali Acc: 0.641 Test Loss: 1.427 Test Acc: 0.641
Validation loss decreased (-0.570355 --> -0.640726).  Saving model ...
Epoch: 13 cost time: 0.396869421005249
Epoch: 13, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.357 Vali Acc: 0.667 Test Loss: 1.357 Test Acc: 0.667
Validation loss decreased (-0.640726 --> -0.666653).  Saving model ...
Epoch: 14 cost time: 0.3791999816894531
Epoch: 14, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.286 Vali Acc: 0.704 Test Loss: 1.286 Test Acc: 0.704
Validation loss decreased (-0.666653 --> -0.703691).  Saving model ...
Epoch: 15 cost time: 0.3918166160583496
Epoch: 15, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.214 Vali Acc: 0.722 Test Loss: 1.214 Test Acc: 0.722
Validation loss decreased (-0.703691 --> -0.722210).  Saving model ...
Epoch: 16 cost time: 0.3722975254058838
Epoch: 16, Steps: 2 | Train Loss: 0.893 Vali Loss: 1.143 Vali Acc: 0.759 Test Loss: 1.143 Test Acc: 0.759
Validation loss decreased (-0.722210 --> -0.759248).  Saving model ...
Epoch: 17 cost time: 0.4195866584777832
Epoch: 17, Steps: 2 | Train Loss: 0.786 Vali Loss: 1.075 Vali Acc: 0.785 Test Loss: 1.075 Test Acc: 0.785
Validation loss decreased (-0.759248 --> -0.785174).  Saving model ...
Epoch: 18 cost time: 0.40177011489868164
Epoch: 18, Steps: 2 | Train Loss: 0.754 Vali Loss: 1.008 Vali Acc: 0.804 Test Loss: 1.008 Test Acc: 0.804
Validation loss decreased (-0.785174 --> -0.803694).  Saving model ...
Epoch: 19 cost time: 0.4235231876373291
Epoch: 19, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.943 Vali Acc: 0.844 Test Loss: 0.943 Test Acc: 0.844
Validation loss decreased (-0.803694 --> -0.844435).  Saving model ...
Epoch: 20 cost time: 0.39647364616394043
Epoch: 20, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.883 Vali Acc: 0.856 Test Loss: 0.883 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855547).  Saving model ...
Epoch: 21 cost time: 0.3863089084625244
Epoch: 21, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.827 Vali Acc: 0.867 Test Loss: 0.827 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866658).  Saving model ...
Epoch: 22 cost time: 0.38775205612182617
Epoch: 22, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.774 Vali Acc: 0.874 Test Loss: 0.774 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 23 cost time: 0.4229140281677246
Epoch: 23, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.725 Vali Acc: 0.893 Test Loss: 0.725 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892585).  Saving model ...
Epoch: 24 cost time: 0.3764073848724365
Epoch: 24, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.681 Vali Acc: 0.900 Test Loss: 0.681 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 0.38901710510253906
Epoch: 25, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.641 Vali Acc: 0.904 Test Loss: 0.641 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 26 cost time: 0.3901207447052002
Epoch: 26, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.604 Vali Acc: 0.907 Test Loss: 0.604 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 27 cost time: 0.3754572868347168
Epoch: 27, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.571 Vali Acc: 0.919 Test Loss: 0.571 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 28 cost time: 0.42538022994995117
Epoch: 28, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.541 Vali Acc: 0.926 Test Loss: 0.541 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 29 cost time: 0.3616523742675781
Epoch: 29, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.516 Vali Acc: 0.926 Test Loss: 0.516 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 30 cost time: 0.38739681243896484
Epoch: 30, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.492 Vali Acc: 0.930 Test Loss: 0.492 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 31 cost time: 0.36805152893066406
Epoch: 31, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.472 Vali Acc: 0.933 Test Loss: 0.472 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 32 cost time: 0.4221537113189697
Epoch: 32, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.454 Vali Acc: 0.933 Test Loss: 0.454 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 33 cost time: 0.3760030269622803
Epoch: 33, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.438 Vali Acc: 0.933 Test Loss: 0.438 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.41919875144958496
Epoch: 34, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.424 Vali Acc: 0.933 Test Loss: 0.424 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.42665600776672363
Epoch: 35, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.410 Vali Acc: 0.937 Test Loss: 0.410 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 36 cost time: 0.394700288772583
Epoch: 36, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.397 Vali Acc: 0.937 Test Loss: 0.397 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.4329702854156494
Epoch: 37, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.386 Vali Acc: 0.937 Test Loss: 0.386 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 38 cost time: 0.39019083976745605
Epoch: 38, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.376 Vali Acc: 0.937 Test Loss: 0.376 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 39 cost time: 0.3885989189147949
Epoch: 39, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.367 Vali Acc: 0.937 Test Loss: 0.367 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 40 cost time: 0.38026857376098633
Epoch: 40, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.360 Vali Acc: 0.941 Test Loss: 0.360 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.38749122619628906
Epoch: 41, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.352 Vali Acc: 0.941 Test Loss: 0.352 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.4019162654876709
Epoch: 42, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.346 Vali Acc: 0.937 Test Loss: 0.346 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.37976741790771484
Epoch: 43, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.340 Vali Acc: 0.937 Test Loss: 0.340 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.42150068283081055
Epoch: 44, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.335 Vali Acc: 0.937 Test Loss: 0.335 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.43434762954711914
Epoch: 45, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.330 Vali Acc: 0.933 Test Loss: 0.330 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.39658379554748535
Epoch: 46, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 47 cost time: 0.40679216384887695
Epoch: 47, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.321 Vali Acc: 0.941 Test Loss: 0.321 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.40620875358581543
Epoch: 48, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.3831183910369873
Epoch: 49, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 50 cost time: 0.3902411460876465
Epoch: 50, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 56454
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6411807537078857
Epoch: 1, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.812 Vali Acc: 0.226 Test Loss: 1.812 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.381633996963501
Epoch: 2, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.794 Vali Acc: 0.252 Test Loss: 1.794 Test Acc: 0.252
Validation loss decreased (-0.225908 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.4071497917175293
Epoch: 3, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.779 Vali Acc: 0.304 Test Loss: 1.779 Test Acc: 0.304
Validation loss decreased (-0.251834 --> -0.303686).  Saving model ...
Epoch: 4 cost time: 0.34731197357177734
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.763 Vali Acc: 0.330 Test Loss: 1.763 Test Acc: 0.330
Validation loss decreased (-0.303686 --> -0.329612).  Saving model ...
Epoch: 5 cost time: 0.3733348846435547
Epoch: 5, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.740 Vali Acc: 0.359 Test Loss: 1.740 Test Acc: 0.359
Validation loss decreased (-0.329612 --> -0.359242).  Saving model ...
Epoch: 6 cost time: 0.3458993434906006
Epoch: 6, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.710 Vali Acc: 0.378 Test Loss: 1.710 Test Acc: 0.378
Validation loss decreased (-0.359242 --> -0.377761).  Saving model ...
Epoch: 7 cost time: 0.3938629627227783
Epoch: 7, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.674 Vali Acc: 0.415 Test Loss: 1.674 Test Acc: 0.415
Validation loss decreased (-0.377761 --> -0.414798).  Saving model ...
Epoch: 8 cost time: 0.44006896018981934
Epoch: 8, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.633 Vali Acc: 0.448 Test Loss: 1.633 Test Acc: 0.448
Validation loss decreased (-0.414798 --> -0.448132).  Saving model ...
Epoch: 9 cost time: 0.39005041122436523
Epoch: 9, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.587 Vali Acc: 0.481 Test Loss: 1.587 Test Acc: 0.481
Validation loss decreased (-0.448132 --> -0.481466).  Saving model ...
Epoch: 10 cost time: 0.41050291061401367
Epoch: 10, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.536 Vali Acc: 0.507 Test Loss: 1.536 Test Acc: 0.507
Validation loss decreased (-0.481466 --> -0.507392).  Saving model ...
Epoch: 11 cost time: 0.40984654426574707
Epoch: 11, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.483 Vali Acc: 0.537 Test Loss: 1.483 Test Acc: 0.537
Validation loss decreased (-0.507392 --> -0.537022).  Saving model ...
Epoch: 12 cost time: 0.3595137596130371
Epoch: 12, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.427 Vali Acc: 0.563 Test Loss: 1.427 Test Acc: 0.563
Validation loss decreased (-0.537022 --> -0.562949).  Saving model ...
Epoch: 13 cost time: 0.3635563850402832
Epoch: 13, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.369 Vali Acc: 0.622 Test Loss: 1.369 Test Acc: 0.622
Validation loss decreased (-0.562949 --> -0.622209).  Saving model ...
Epoch: 14 cost time: 0.3664412498474121
Epoch: 14, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.310 Vali Acc: 0.659 Test Loss: 1.310 Test Acc: 0.659
Validation loss decreased (-0.622209 --> -0.659246).  Saving model ...
Epoch: 15 cost time: 0.5101637840270996
Epoch: 15, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.251 Vali Acc: 0.748 Test Loss: 1.251 Test Acc: 0.748
Validation loss decreased (-0.659246 --> -0.748136).  Saving model ...
Epoch: 16 cost time: 0.38274669647216797
Epoch: 16, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.192 Vali Acc: 0.781 Test Loss: 1.192 Test Acc: 0.781
Validation loss decreased (-0.748136 --> -0.781470).  Saving model ...
Epoch: 17 cost time: 0.38133668899536133
Epoch: 17, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.135 Vali Acc: 0.815 Test Loss: 1.135 Test Acc: 0.815
Validation loss decreased (-0.781470 --> -0.814803).  Saving model ...
Epoch: 18 cost time: 0.4106459617614746
Epoch: 18, Steps: 2 | Train Loss: 0.870 Vali Loss: 1.077 Vali Acc: 0.837 Test Loss: 1.077 Test Acc: 0.837
Validation loss decreased (-0.814803 --> -0.837026).  Saving model ...
Epoch: 19 cost time: 0.3657221794128418
Epoch: 19, Steps: 2 | Train Loss: 0.829 Vali Loss: 1.022 Vali Acc: 0.852 Test Loss: 1.022 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851842).  Saving model ...
Epoch: 20 cost time: 0.38259196281433105
Epoch: 20, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.969 Vali Acc: 0.867 Test Loss: 0.969 Test Acc: 0.867
Validation loss decreased (-0.851842 --> -0.866657).  Saving model ...
Epoch: 21 cost time: 0.4022395610809326
Epoch: 21, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.918 Vali Acc: 0.878 Test Loss: 0.918 Test Acc: 0.878
Validation loss decreased (-0.866657 --> -0.877769).  Saving model ...
Epoch: 22 cost time: 0.4050905704498291
Epoch: 22, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.869 Vali Acc: 0.893 Test Loss: 0.869 Test Acc: 0.893
Validation loss decreased (-0.877769 --> -0.892584).  Saving model ...
Epoch: 23 cost time: 0.4320852756500244
Epoch: 23, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.824 Vali Acc: 0.904 Test Loss: 0.824 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903695).  Saving model ...
Epoch: 24 cost time: 0.41017675399780273
Epoch: 24, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.780 Vali Acc: 0.907 Test Loss: 0.780 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907400).  Saving model ...
Epoch: 25 cost time: 0.37950944900512695
Epoch: 25, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.738 Vali Acc: 0.915 Test Loss: 0.738 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914807).  Saving model ...
Epoch: 26 cost time: 0.3912222385406494
Epoch: 26, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.700 Vali Acc: 0.919 Test Loss: 0.700 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918512).  Saving model ...
Epoch: 27 cost time: 0.43544459342956543
Epoch: 27, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.665 Vali Acc: 0.919 Test Loss: 0.665 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 28 cost time: 0.39658045768737793
Epoch: 28, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.632 Vali Acc: 0.930 Test Loss: 0.632 Test Acc: 0.930
Validation loss decreased (-0.918512 --> -0.929623).  Saving model ...
Epoch: 29 cost time: 0.40535688400268555
Epoch: 29, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.602 Vali Acc: 0.933 Test Loss: 0.602 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 30 cost time: 0.4018068313598633
Epoch: 30, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.574 Vali Acc: 0.933 Test Loss: 0.574 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 31 cost time: 0.3923072814941406
Epoch: 31, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.549 Vali Acc: 0.933 Test Loss: 0.549 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 32 cost time: 0.40267467498779297
Epoch: 32, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.527 Vali Acc: 0.933 Test Loss: 0.527 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 33 cost time: 0.3790440559387207
Epoch: 33, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.506 Vali Acc: 0.933 Test Loss: 0.506 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 34 cost time: 0.40006017684936523
Epoch: 34, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.487 Vali Acc: 0.933 Test Loss: 0.487 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 35 cost time: 0.38873791694641113
Epoch: 35, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.470 Vali Acc: 0.933 Test Loss: 0.470 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 36 cost time: 0.40096449851989746
Epoch: 36, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.454 Vali Acc: 0.933 Test Loss: 0.454 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 0.43525099754333496
Epoch: 37, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.440 Vali Acc: 0.933 Test Loss: 0.440 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.446897029876709
Epoch: 38, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.427 Vali Acc: 0.933 Test Loss: 0.427 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.3952353000640869
Epoch: 39, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.414 Vali Acc: 0.933 Test Loss: 0.414 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 40 cost time: 0.42484354972839355
Epoch: 40, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.404 Vali Acc: 0.933 Test Loss: 0.404 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 41 cost time: 0.39376020431518555
Epoch: 41, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 42 cost time: 0.4279954433441162
Epoch: 42, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.385 Vali Acc: 0.933 Test Loss: 0.385 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 43 cost time: 0.4431471824645996
Epoch: 43, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.377 Vali Acc: 0.933 Test Loss: 0.377 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 44 cost time: 0.44464945793151855
Epoch: 44, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.3608286380767822
Epoch: 45, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.362 Vali Acc: 0.930 Test Loss: 0.362 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.3589777946472168
Epoch: 46, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4238724708557129
Epoch: 47, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.4117774963378906
Epoch: 48, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4009578227996826
Epoch: 49, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.338 Vali Acc: 0.930 Test Loss: 0.338 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.49521803855895996
Epoch: 50, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.333 Vali Acc: 0.930 Test Loss: 0.333 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 53638
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5800044536590576
Epoch: 1, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.802 Vali Acc: 0.230 Test Loss: 1.802 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.351093053817749
Epoch: 2, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.751 Vali Acc: 0.263 Test Loss: 1.751 Test Acc: 0.263
Validation loss decreased (-0.229612 --> -0.262945).  Saving model ...
Epoch: 3 cost time: 0.3849925994873047
Epoch: 3, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.698 Vali Acc: 0.296 Test Loss: 1.698 Test Acc: 0.296
Validation loss decreased (-0.262945 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 0.32094693183898926
Epoch: 4, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.621 Vali Acc: 0.322 Test Loss: 1.621 Test Acc: 0.322
Validation loss decreased (-0.296279 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 0.32343125343322754
Epoch: 5, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.520 Vali Acc: 0.396 Test Loss: 1.520 Test Acc: 0.396
Validation loss decreased (-0.322206 --> -0.396281).  Saving model ...
Epoch: 6 cost time: 0.3236086368560791
Epoch: 6, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.401 Vali Acc: 0.485 Test Loss: 1.401 Test Acc: 0.485
Validation loss decreased (-0.396281 --> -0.485171).  Saving model ...
Epoch: 7 cost time: 0.3467895984649658
Epoch: 7, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.273 Vali Acc: 0.585 Test Loss: 1.273 Test Acc: 0.585
Validation loss decreased (-0.485171 --> -0.585172).  Saving model ...
Epoch: 8 cost time: 0.4350566864013672
Epoch: 8, Steps: 2 | Train Loss: 0.932 Vali Loss: 1.142 Vali Acc: 0.719 Test Loss: 1.142 Test Acc: 0.719
Validation loss decreased (-0.585172 --> -0.718507).  Saving model ...
Epoch: 9 cost time: 0.3988685607910156
Epoch: 9, Steps: 2 | Train Loss: 0.781 Vali Loss: 1.014 Vali Acc: 0.796 Test Loss: 1.014 Test Acc: 0.796
Validation loss decreased (-0.718507 --> -0.796286).  Saving model ...
Epoch: 10 cost time: 0.4046480655670166
Epoch: 10, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.893 Vali Acc: 0.822 Test Loss: 0.893 Test Acc: 0.822
Validation loss decreased (-0.796286 --> -0.822213).  Saving model ...
Epoch: 11 cost time: 0.5116636753082275
Epoch: 11, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.780 Vali Acc: 0.863 Test Loss: 0.780 Test Acc: 0.863
Validation loss decreased (-0.822213 --> -0.862955).  Saving model ...
Epoch: 12 cost time: 0.38721227645874023
Epoch: 12, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.680 Vali Acc: 0.900 Test Loss: 0.680 Test Acc: 0.900
Validation loss decreased (-0.862955 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.41722869873046875
Epoch: 13, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.591 Vali Acc: 0.919 Test Loss: 0.591 Test Acc: 0.919
Validation loss decreased (-0.899993 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.38311219215393066
Epoch: 14, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.517 Vali Acc: 0.922 Test Loss: 0.517 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.42404651641845703
Epoch: 15, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.451 Vali Acc: 0.930 Test Loss: 0.451 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 16 cost time: 0.40932416915893555
Epoch: 16, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.398 Vali Acc: 0.941 Test Loss: 0.398 Test Acc: 0.941
Validation loss decreased (-0.929625 --> -0.940737).  Saving model ...
Epoch: 17 cost time: 0.4746229648590088
Epoch: 17, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 18 cost time: 0.3587150573730469
Epoch: 18, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 19 cost time: 0.39676690101623535
Epoch: 19, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.4187009334564209
Epoch: 20, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.3859059810638428
Epoch: 21, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42487239837646484
Epoch: 22, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3942697048187256
Epoch: 23, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.3666388988494873
Epoch: 24, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4326744079589844
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4306976795196533
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3619649410247803
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.3541862964630127
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.38547396659851074
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.3982045650482178
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.43366432189941406
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.38689541816711426
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.3848268985748291
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.3715994358062744
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.3961026668548584
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.42682743072509766
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.3763761520385742
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.39968109130859375
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.3778257369995117
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.5155010223388672
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.3752858638763428
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.4035191535949707
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.4354588985443115
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.40717434883117676
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.4968140125274658
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.33506226539611816
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.42778825759887695
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.39259982109069824
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.4510536193847656
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.38611698150634766
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps2_str1_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 62694
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.563328504562378
Epoch: 1, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.823 Vali Acc: 0.159 Test Loss: 1.823 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.39038848876953125
Epoch: 2, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.797 Vali Acc: 0.185 Test Loss: 1.797 Test Acc: 0.185
Validation loss decreased (-0.159241 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.4486076831817627
Epoch: 3, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.771 Vali Acc: 0.207 Test Loss: 1.771 Test Acc: 0.207
Validation loss decreased (-0.185167 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.4030880928039551
Epoch: 4, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.736 Vali Acc: 0.256 Test Loss: 1.736 Test Acc: 0.256
Validation loss decreased (-0.207390 --> -0.255538).  Saving model ...
Epoch: 5 cost time: 0.341489315032959
Epoch: 5, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.687 Vali Acc: 0.359 Test Loss: 1.687 Test Acc: 0.359
Validation loss decreased (-0.255538 --> -0.359242).  Saving model ...
Epoch: 6 cost time: 0.3821232318878174
Epoch: 6, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.626 Vali Acc: 0.467 Test Loss: 1.626 Test Acc: 0.467
Validation loss decreased (-0.359242 --> -0.466650).  Saving model ...
Epoch: 7 cost time: 0.3667452335357666
Epoch: 7, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.555 Vali Acc: 0.533 Test Loss: 1.555 Test Acc: 0.533
Validation loss decreased (-0.466650 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 0.35501742362976074
Epoch: 8, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.474 Vali Acc: 0.589 Test Loss: 1.474 Test Acc: 0.589
Validation loss decreased (-0.533318 --> -0.588874).  Saving model ...
Epoch: 9 cost time: 0.3836390972137451
Epoch: 9, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.385 Vali Acc: 0.641 Test Loss: 1.385 Test Acc: 0.641
Validation loss decreased (-0.588874 --> -0.640727).  Saving model ...
Epoch: 10 cost time: 0.380690336227417
Epoch: 10, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.292 Vali Acc: 0.685 Test Loss: 1.292 Test Acc: 0.685
Validation loss decreased (-0.640727 --> -0.685172).  Saving model ...
Epoch: 11 cost time: 0.3551909923553467
Epoch: 11, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.197 Vali Acc: 0.756 Test Loss: 1.197 Test Acc: 0.756
Validation loss decreased (-0.685172 --> -0.755544).  Saving model ...
Epoch: 12 cost time: 0.3848278522491455
Epoch: 12, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.104 Vali Acc: 0.826 Test Loss: 1.104 Test Acc: 0.826
Validation loss decreased (-0.755544 --> -0.825915).  Saving model ...
Epoch: 13 cost time: 0.3590667247772217
Epoch: 13, Steps: 2 | Train Loss: 0.816 Vali Loss: 1.013 Vali Acc: 0.859 Test Loss: 1.013 Test Acc: 0.859
Validation loss decreased (-0.825915 --> -0.859249).  Saving model ...
Epoch: 14 cost time: 0.5435068607330322
Epoch: 14, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.927 Vali Acc: 0.889 Test Loss: 0.927 Test Acc: 0.889
Validation loss decreased (-0.859249 --> -0.888880).  Saving model ...
Epoch: 15 cost time: 0.41345691680908203
Epoch: 15, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.848 Vali Acc: 0.885 Test Loss: 0.848 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.35344481468200684
Epoch: 16, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.774 Vali Acc: 0.900 Test Loss: 0.774 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.4064621925354004
Epoch: 17, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.705 Vali Acc: 0.900 Test Loss: 0.705 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.3381650447845459
Epoch: 18, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.642 Vali Acc: 0.904 Test Loss: 0.642 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 19 cost time: 0.3751497268676758
Epoch: 19, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.584 Vali Acc: 0.919 Test Loss: 0.584 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 20 cost time: 0.34171628952026367
Epoch: 20, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.533 Vali Acc: 0.926 Test Loss: 0.533 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 21 cost time: 0.34780216217041016
Epoch: 21, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.489 Vali Acc: 0.926 Test Loss: 0.489 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 22 cost time: 0.3823575973510742
Epoch: 22, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.451 Vali Acc: 0.926 Test Loss: 0.451 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 23 cost time: 0.37268757820129395
Epoch: 23, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.418 Vali Acc: 0.930 Test Loss: 0.418 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 24 cost time: 0.3365199565887451
Epoch: 24, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 25 cost time: 0.414752721786499
Epoch: 25, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.366 Vali Acc: 0.933 Test Loss: 0.366 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.3916904926300049
Epoch: 26, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.347 Vali Acc: 0.933 Test Loss: 0.347 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.3962721824645996
Epoch: 27, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.34543538093566895
Epoch: 28, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.40533947944641113
Epoch: 29, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.36666321754455566
Epoch: 30, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.33297038078308105
Epoch: 31, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 32 cost time: 0.35405468940734863
Epoch: 32, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.3811976909637451
Epoch: 33, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.4186108112335205
Epoch: 34, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.387223482131958
Epoch: 35, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.3122437000274658
Epoch: 36, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.3688468933105469
Epoch: 37, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.3390777111053467
Epoch: 38, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.32793521881103516
Epoch: 39, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.3951902389526367
Epoch: 40, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.4358961582183838
Epoch: 41, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.3525967597961426
Epoch: 42, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.3974623680114746
Epoch: 43, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.3578183650970459
Epoch: 44, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.3235301971435547
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.32616567611694336
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.3686535358428955
Epoch: 47, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.32265543937683105
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.34599828720092773
Epoch: 49, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.3706185817718506
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 37414
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.572920560836792
Epoch: 1, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.820 Vali Acc: 0.119 Test Loss: 1.820 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.3934311866760254
Epoch: 2, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.782 Vali Acc: 0.193 Test Loss: 1.782 Test Acc: 0.193
Validation loss decreased (-0.118500 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.41773271560668945
Epoch: 3, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.749 Vali Acc: 0.233 Test Loss: 1.749 Test Acc: 0.233
Validation loss decreased (-0.192575 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.4312458038330078
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.715 Vali Acc: 0.267 Test Loss: 1.715 Test Acc: 0.267
Validation loss decreased (-0.233316 --> -0.266650).  Saving model ...
Epoch: 5 cost time: 0.40007972717285156
Epoch: 5, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.672 Vali Acc: 0.322 Test Loss: 1.672 Test Acc: 0.322
Validation loss decreased (-0.266650 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 0.4128141403198242
Epoch: 6, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.620 Vali Acc: 0.359 Test Loss: 1.620 Test Acc: 0.359
Validation loss decreased (-0.322206 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 0.40857839584350586
Epoch: 7, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.561 Vali Acc: 0.448 Test Loss: 1.561 Test Acc: 0.448
Validation loss decreased (-0.359243 --> -0.448133).  Saving model ...
Epoch: 8 cost time: 0.41905903816223145
Epoch: 8, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.496 Vali Acc: 0.596 Test Loss: 1.496 Test Acc: 0.596
Validation loss decreased (-0.448133 --> -0.596281).  Saving model ...
Epoch: 9 cost time: 0.467087984085083
Epoch: 9, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.428 Vali Acc: 0.648 Test Loss: 1.428 Test Acc: 0.648
Validation loss decreased (-0.596281 --> -0.648134).  Saving model ...
Epoch: 10 cost time: 0.41179490089416504
Epoch: 10, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.357 Vali Acc: 0.744 Test Loss: 1.357 Test Acc: 0.744
Validation loss decreased (-0.648134 --> -0.744431).  Saving model ...
Epoch: 11 cost time: 0.43363022804260254
Epoch: 11, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.283 Vali Acc: 0.785 Test Loss: 1.283 Test Acc: 0.785
Validation loss decreased (-0.744431 --> -0.785172).  Saving model ...
Epoch: 12 cost time: 0.3795294761657715
Epoch: 12, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.209 Vali Acc: 0.811 Test Loss: 1.209 Test Acc: 0.811
Validation loss decreased (-0.785172 --> -0.811099).  Saving model ...
Epoch: 13 cost time: 0.4266970157623291
Epoch: 13, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.135 Vali Acc: 0.822 Test Loss: 1.135 Test Acc: 0.822
Validation loss decreased (-0.811099 --> -0.822211).  Saving model ...
Epoch: 14 cost time: 0.45398449897766113
Epoch: 14, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.062 Vali Acc: 0.830 Test Loss: 1.062 Test Acc: 0.830
Validation loss decreased (-0.822211 --> -0.829619).  Saving model ...
Epoch: 15 cost time: 0.4109315872192383
Epoch: 15, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.992 Vali Acc: 0.856 Test Loss: 0.992 Test Acc: 0.856
Validation loss decreased (-0.829619 --> -0.855546).  Saving model ...
Epoch: 16 cost time: 0.3822476863861084
Epoch: 16, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.926 Vali Acc: 0.878 Test Loss: 0.926 Test Acc: 0.878
Validation loss decreased (-0.855546 --> -0.877769).  Saving model ...
Epoch: 17 cost time: 0.4388856887817383
Epoch: 17, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.863 Vali Acc: 0.874 Test Loss: 0.863 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4152352809906006
Epoch: 18, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.805 Vali Acc: 0.885 Test Loss: 0.805 Test Acc: 0.885
Validation loss decreased (-0.877769 --> -0.885177).  Saving model ...
Epoch: 19 cost time: 0.484332799911499
Epoch: 19, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.750 Vali Acc: 0.889 Test Loss: 0.750 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 20 cost time: 0.4104268550872803
Epoch: 20, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.699 Vali Acc: 0.911 Test Loss: 0.699 Test Acc: 0.911
Validation loss decreased (-0.888881 --> -0.911104).  Saving model ...
Epoch: 21 cost time: 0.4320790767669678
Epoch: 21, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.651 Vali Acc: 0.919 Test Loss: 0.651 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 22 cost time: 0.40261149406433105
Epoch: 22, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.607 Vali Acc: 0.922 Test Loss: 0.607 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 23 cost time: 0.4130730628967285
Epoch: 23, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.567 Vali Acc: 0.930 Test Loss: 0.567 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.4430091381072998
Epoch: 24, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.531 Vali Acc: 0.933 Test Loss: 0.531 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 25 cost time: 0.40764474868774414
Epoch: 25, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.499 Vali Acc: 0.937 Test Loss: 0.499 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 26 cost time: 0.45540714263916016
Epoch: 26, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.471 Vali Acc: 0.937 Test Loss: 0.471 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 27 cost time: 0.41454577445983887
Epoch: 27, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.445 Vali Acc: 0.937 Test Loss: 0.445 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 28 cost time: 0.4367678165435791
Epoch: 28, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.423 Vali Acc: 0.937 Test Loss: 0.423 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 29 cost time: 0.4670848846435547
Epoch: 29, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.404 Vali Acc: 0.937 Test Loss: 0.404 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.43780088424682617
Epoch: 30, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.387 Vali Acc: 0.937 Test Loss: 0.387 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 31 cost time: 0.43143415451049805
Epoch: 31, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.371 Vali Acc: 0.941 Test Loss: 0.371 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 32 cost time: 0.4379909038543701
Epoch: 32, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 33 cost time: 0.451171875
Epoch: 33, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.346 Vali Acc: 0.941 Test Loss: 0.346 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 34 cost time: 0.43603086471557617
Epoch: 34, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.4721963405609131
Epoch: 35, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.468045711517334
Epoch: 36, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.41775989532470703
Epoch: 37, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.4518275260925293
Epoch: 38, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.303 Vali Acc: 0.944 Test Loss: 0.303 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.4801623821258545
Epoch: 39, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 40 cost time: 0.4316127300262451
Epoch: 40, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4145224094390869
Epoch: 41, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.4519002437591553
Epoch: 42, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.42934083938598633
Epoch: 43, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.45296740531921387
Epoch: 44, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.46028947830200195
Epoch: 45, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.4237067699432373
Epoch: 46, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.45082998275756836
Epoch: 47, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.43393969535827637
Epoch: 48, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4276134967803955
Epoch: 49, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.47074007987976074
Epoch: 50, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 28998
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.488173484802246
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.802 Vali Acc: 0.207 Test Loss: 1.802 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.3362143039703369
Epoch: 2, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.779 Vali Acc: 0.230 Test Loss: 1.779 Test Acc: 0.230
Validation loss decreased (-0.207389 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 0.34745097160339355
Epoch: 3, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.758 Vali Acc: 0.267 Test Loss: 1.758 Test Acc: 0.267
Validation loss decreased (-0.229612 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.36218738555908203
Epoch: 4, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.735 Vali Acc: 0.341 Test Loss: 1.735 Test Acc: 0.341
Validation loss decreased (-0.266649 --> -0.340723).  Saving model ...
Epoch: 5 cost time: 0.35590553283691406
Epoch: 5, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.704 Vali Acc: 0.396 Test Loss: 1.704 Test Acc: 0.396
Validation loss decreased (-0.340723 --> -0.396279).  Saving model ...
Epoch: 6 cost time: 0.40634655952453613
Epoch: 6, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.666 Vali Acc: 0.422 Test Loss: 1.666 Test Acc: 0.422
Validation loss decreased (-0.396279 --> -0.422206).  Saving model ...
Epoch: 7 cost time: 0.4372715950012207
Epoch: 7, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.621 Vali Acc: 0.452 Test Loss: 1.621 Test Acc: 0.452
Validation loss decreased (-0.422206 --> -0.451836).  Saving model ...
Epoch: 8 cost time: 0.44199562072753906
Epoch: 8, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.571 Vali Acc: 0.485 Test Loss: 1.571 Test Acc: 0.485
Validation loss decreased (-0.451836 --> -0.485169).  Saving model ...
Epoch: 9 cost time: 0.4003136157989502
Epoch: 9, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.515 Vali Acc: 0.507 Test Loss: 1.515 Test Acc: 0.507
Validation loss decreased (-0.485169 --> -0.507392).  Saving model ...
Epoch: 10 cost time: 0.34990692138671875
Epoch: 10, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.455 Vali Acc: 0.541 Test Loss: 1.455 Test Acc: 0.541
Validation loss decreased (-0.507392 --> -0.540726).  Saving model ...
Epoch: 11 cost time: 0.4040191173553467
Epoch: 11, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.394 Vali Acc: 0.604 Test Loss: 1.394 Test Acc: 0.604
Validation loss decreased (-0.540726 --> -0.603690).  Saving model ...
Epoch: 12 cost time: 0.47614073753356934
Epoch: 12, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.330 Vali Acc: 0.670 Test Loss: 1.330 Test Acc: 0.670
Validation loss decreased (-0.603690 --> -0.670357).  Saving model ...
Epoch: 13 cost time: 0.47829318046569824
Epoch: 13, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.264 Vali Acc: 0.715 Test Loss: 1.264 Test Acc: 0.715
Validation loss decreased (-0.670357 --> -0.714802).  Saving model ...
Epoch: 14 cost time: 0.468151330947876
Epoch: 14, Steps: 2 | Train Loss: 1.014 Vali Loss: 1.199 Vali Acc: 0.767 Test Loss: 1.199 Test Acc: 0.767
Validation loss decreased (-0.714802 --> -0.766655).  Saving model ...
Epoch: 15 cost time: 0.4533994197845459
Epoch: 15, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.135 Vali Acc: 0.807 Test Loss: 1.135 Test Acc: 0.807
Validation loss decreased (-0.766655 --> -0.807396).  Saving model ...
Epoch: 16 cost time: 0.4726078510284424
Epoch: 16, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.072 Vali Acc: 0.833 Test Loss: 1.072 Test Acc: 0.833
Validation loss decreased (-0.807396 --> -0.833323).  Saving model ...
Epoch: 17 cost time: 0.43842411041259766
Epoch: 17, Steps: 2 | Train Loss: 0.788 Vali Loss: 1.011 Vali Acc: 0.852 Test Loss: 1.011 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 18 cost time: 0.4630873203277588
Epoch: 18, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.952 Vali Acc: 0.870 Test Loss: 0.952 Test Acc: 0.870
Validation loss decreased (-0.851842 --> -0.870361).  Saving model ...
Epoch: 19 cost time: 0.4364173412322998
Epoch: 19, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.896 Vali Acc: 0.893 Test Loss: 0.896 Test Acc: 0.893
Validation loss decreased (-0.870361 --> -0.892584).  Saving model ...
Epoch: 20 cost time: 0.463346004486084
Epoch: 20, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.844 Vali Acc: 0.889 Test Loss: 0.844 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.45203590393066406
Epoch: 21, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.794 Vali Acc: 0.900 Test Loss: 0.794 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 22 cost time: 0.4410817623138428
Epoch: 22, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.746 Vali Acc: 0.915 Test Loss: 0.746 Test Acc: 0.915
Validation loss decreased (-0.899992 --> -0.914807).  Saving model ...
Epoch: 23 cost time: 0.4662775993347168
Epoch: 23, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.702 Vali Acc: 0.919 Test Loss: 0.702 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918512).  Saving model ...
Epoch: 24 cost time: 0.4269700050354004
Epoch: 24, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.660 Vali Acc: 0.926 Test Loss: 0.660 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925919).  Saving model ...
Epoch: 25 cost time: 0.47347521781921387
Epoch: 25, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.622 Vali Acc: 0.930 Test Loss: 0.622 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 26 cost time: 0.3830835819244385
Epoch: 26, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.586 Vali Acc: 0.933 Test Loss: 0.586 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933327).  Saving model ...
Epoch: 27 cost time: 0.45353221893310547
Epoch: 27, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.555 Vali Acc: 0.941 Test Loss: 0.555 Test Acc: 0.941
Validation loss decreased (-0.933327 --> -0.940735).  Saving model ...
Epoch: 28 cost time: 0.4342467784881592
Epoch: 28, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.527 Vali Acc: 0.944 Test Loss: 0.527 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 29 cost time: 0.4350872039794922
Epoch: 29, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.501 Vali Acc: 0.944 Test Loss: 0.501 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944439).  Saving model ...
Epoch: 30 cost time: 0.390988826751709
Epoch: 30, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.478 Vali Acc: 0.948 Test Loss: 0.478 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 31 cost time: 0.413097620010376
Epoch: 31, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.458 Vali Acc: 0.948 Test Loss: 0.458 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 32 cost time: 0.40560078620910645
Epoch: 32, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.439 Vali Acc: 0.948 Test Loss: 0.439 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 33 cost time: 0.4182717800140381
Epoch: 33, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.422 Vali Acc: 0.956 Test Loss: 0.422 Test Acc: 0.956
Validation loss decreased (-0.948144 --> -0.955551).  Saving model ...
Epoch: 34 cost time: 0.428377628326416
Epoch: 34, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.408 Vali Acc: 0.956 Test Loss: 0.408 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 35 cost time: 0.39182376861572266
Epoch: 35, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.395 Vali Acc: 0.952 Test Loss: 0.395 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.42424678802490234
Epoch: 36, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.383 Vali Acc: 0.952 Test Loss: 0.383 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.42063212394714355
Epoch: 37, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.372 Vali Acc: 0.952 Test Loss: 0.372 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.440371036529541
Epoch: 38, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.362 Vali Acc: 0.956 Test Loss: 0.362 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955552).  Saving model ...
Epoch: 39 cost time: 0.40952301025390625
Epoch: 39, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.353 Vali Acc: 0.959 Test Loss: 0.353 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 40 cost time: 0.43988966941833496
Epoch: 40, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.345 Vali Acc: 0.959 Test Loss: 0.345 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 41 cost time: 0.4549107551574707
Epoch: 41, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.337 Vali Acc: 0.959 Test Loss: 0.337 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 42 cost time: 0.4493520259857178
Epoch: 42, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.330 Vali Acc: 0.959 Test Loss: 0.330 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 43 cost time: 0.42018866539001465
Epoch: 43, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.323 Vali Acc: 0.959 Test Loss: 0.323 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 44 cost time: 0.4137716293334961
Epoch: 44, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.317 Vali Acc: 0.959 Test Loss: 0.317 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 45 cost time: 0.4452176094055176
Epoch: 45, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.311 Vali Acc: 0.959 Test Loss: 0.311 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 46 cost time: 0.468111515045166
Epoch: 46, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.306 Vali Acc: 0.959 Test Loss: 0.306 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 47 cost time: 0.45167064666748047
Epoch: 47, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.301 Vali Acc: 0.956 Test Loss: 0.301 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.40612196922302246
Epoch: 48, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.296 Vali Acc: 0.956 Test Loss: 0.296 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4261515140533447
Epoch: 49, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.291 Vali Acc: 0.959 Test Loss: 0.291 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 50 cost time: 0.4100196361541748
Epoch: 50, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.287 Vali Acc: 0.959 Test Loss: 0.287 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps7_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 25222
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7411293983459473
Epoch: 1, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.774 Vali Acc: 0.156 Test Loss: 1.774 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.3503577709197998
Epoch: 2, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.756 Vali Acc: 0.167 Test Loss: 1.756 Test Acc: 0.167
Validation loss decreased (-0.155538 --> -0.166649).  Saving model ...
Epoch: 3 cost time: 0.3514900207519531
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.740 Vali Acc: 0.181 Test Loss: 1.740 Test Acc: 0.181
Validation loss decreased (-0.166649 --> -0.181464).  Saving model ...
Epoch: 4 cost time: 0.38472914695739746
Epoch: 4, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.725 Vali Acc: 0.215 Test Loss: 1.725 Test Acc: 0.215
Validation loss decreased (-0.181464 --> -0.214798).  Saving model ...
Epoch: 5 cost time: 0.3746175765991211
Epoch: 5, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.703 Vali Acc: 0.248 Test Loss: 1.703 Test Acc: 0.248
Validation loss decreased (-0.214798 --> -0.248131).  Saving model ...
Epoch: 6 cost time: 0.3482792377471924
Epoch: 6, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.677 Vali Acc: 0.296 Test Loss: 1.677 Test Acc: 0.296
Validation loss decreased (-0.248131 --> -0.296280).  Saving model ...
Epoch: 7 cost time: 0.4778876304626465
Epoch: 7, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.645 Vali Acc: 0.344 Test Loss: 1.645 Test Acc: 0.344
Validation loss decreased (-0.296280 --> -0.344428).  Saving model ...
Epoch: 8 cost time: 0.3663194179534912
Epoch: 8, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.609 Vali Acc: 0.404 Test Loss: 1.609 Test Acc: 0.404
Validation loss decreased (-0.344428 --> -0.403688).  Saving model ...
Epoch: 9 cost time: 0.40475988388061523
Epoch: 9, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.569 Vali Acc: 0.481 Test Loss: 1.569 Test Acc: 0.481
Validation loss decreased (-0.403688 --> -0.481466).  Saving model ...
Epoch: 10 cost time: 0.39900684356689453
Epoch: 10, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.524 Vali Acc: 0.526 Test Loss: 1.524 Test Acc: 0.526
Validation loss decreased (-0.481466 --> -0.525911).  Saving model ...
Epoch: 11 cost time: 0.37264537811279297
Epoch: 11, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.476 Vali Acc: 0.581 Test Loss: 1.476 Test Acc: 0.581
Validation loss decreased (-0.525911 --> -0.581467).  Saving model ...
Epoch: 12 cost time: 0.34853219985961914
Epoch: 12, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.425 Vali Acc: 0.641 Test Loss: 1.425 Test Acc: 0.641
Validation loss decreased (-0.581467 --> -0.640726).  Saving model ...
Epoch: 13 cost time: 0.4890170097351074
Epoch: 13, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.372 Vali Acc: 0.670 Test Loss: 1.372 Test Acc: 0.670
Validation loss decreased (-0.640726 --> -0.670357).  Saving model ...
Epoch: 14 cost time: 0.3701009750366211
Epoch: 14, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.317 Vali Acc: 0.715 Test Loss: 1.317 Test Acc: 0.715
Validation loss decreased (-0.670357 --> -0.714802).  Saving model ...
Epoch: 15 cost time: 0.39705395698547363
Epoch: 15, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.262 Vali Acc: 0.752 Test Loss: 1.262 Test Acc: 0.752
Validation loss decreased (-0.714802 --> -0.751839).  Saving model ...
Epoch: 16 cost time: 0.35170698165893555
Epoch: 16, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.207 Vali Acc: 0.793 Test Loss: 1.207 Test Acc: 0.793
Validation loss decreased (-0.751839 --> -0.792581).  Saving model ...
Epoch: 17 cost time: 0.40129756927490234
Epoch: 17, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.152 Vali Acc: 0.819 Test Loss: 1.152 Test Acc: 0.819
Validation loss decreased (-0.792581 --> -0.818507).  Saving model ...
Epoch: 18 cost time: 0.4731416702270508
Epoch: 18, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.098 Vali Acc: 0.830 Test Loss: 1.098 Test Acc: 0.830
Validation loss decreased (-0.818507 --> -0.829619).  Saving model ...
Epoch: 19 cost time: 0.3800778388977051
Epoch: 19, Steps: 2 | Train Loss: 0.864 Vali Loss: 1.045 Vali Acc: 0.848 Test Loss: 1.045 Test Acc: 0.848
Validation loss decreased (-0.829619 --> -0.848138).  Saving model ...
Epoch: 20 cost time: 0.3554682731628418
Epoch: 20, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.993 Vali Acc: 0.867 Test Loss: 0.993 Test Acc: 0.867
Validation loss decreased (-0.848138 --> -0.866657).  Saving model ...
Epoch: 21 cost time: 0.43422508239746094
Epoch: 21, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.944 Vali Acc: 0.874 Test Loss: 0.944 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 22 cost time: 0.3564419746398926
Epoch: 22, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.896 Vali Acc: 0.881 Test Loss: 0.896 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 23 cost time: 0.3616976737976074
Epoch: 23, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.851 Vali Acc: 0.889 Test Loss: 0.851 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888880).  Saving model ...
Epoch: 24 cost time: 0.4485759735107422
Epoch: 24, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.808 Vali Acc: 0.896 Test Loss: 0.808 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 25 cost time: 0.38616466522216797
Epoch: 25, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.767 Vali Acc: 0.904 Test Loss: 0.767 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903696).  Saving model ...
Epoch: 26 cost time: 0.40450429916381836
Epoch: 26, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.730 Vali Acc: 0.904 Test Loss: 0.730 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 27 cost time: 0.5410239696502686
Epoch: 27, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.694 Vali Acc: 0.907 Test Loss: 0.694 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 28 cost time: 0.39232850074768066
Epoch: 28, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.662 Vali Acc: 0.915 Test Loss: 0.662 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 29 cost time: 0.44777369499206543
Epoch: 29, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.632 Vali Acc: 0.915 Test Loss: 0.632 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 30 cost time: 0.3808629512786865
Epoch: 30, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.604 Vali Acc: 0.919 Test Loss: 0.604 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 31 cost time: 0.34770989418029785
Epoch: 31, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.578 Vali Acc: 0.922 Test Loss: 0.578 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 32 cost time: 0.3696615695953369
Epoch: 32, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.554 Vali Acc: 0.930 Test Loss: 0.554 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 33 cost time: 0.37450718879699707
Epoch: 33, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.533 Vali Acc: 0.930 Test Loss: 0.533 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 34 cost time: 0.35961318016052246
Epoch: 34, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.513 Vali Acc: 0.930 Test Loss: 0.513 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 35 cost time: 0.3364698886871338
Epoch: 35, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.495 Vali Acc: 0.930 Test Loss: 0.495 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 36 cost time: 0.33595895767211914
Epoch: 36, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.479 Vali Acc: 0.933 Test Loss: 0.479 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 37 cost time: 0.39974212646484375
Epoch: 37, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.463 Vali Acc: 0.933 Test Loss: 0.463 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 0.43309593200683594
Epoch: 38, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.449 Vali Acc: 0.933 Test Loss: 0.449 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.4065079689025879
Epoch: 39, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.437 Vali Acc: 0.937 Test Loss: 0.437 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 40 cost time: 0.3616297245025635
Epoch: 40, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.425 Vali Acc: 0.937 Test Loss: 0.425 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 41 cost time: 0.49696803092956543
Epoch: 41, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.414 Vali Acc: 0.941 Test Loss: 0.414 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 0.39189839363098145
Epoch: 42, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.405 Vali Acc: 0.941 Test Loss: 0.405 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.3612353801727295
Epoch: 43, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.396 Vali Acc: 0.941 Test Loss: 0.396 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 44 cost time: 0.4025278091430664
Epoch: 44, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.388 Vali Acc: 0.941 Test Loss: 0.388 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 45 cost time: 0.36873865127563477
Epoch: 45, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.380 Vali Acc: 0.948 Test Loss: 0.380 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948144).  Saving model ...
Epoch: 46 cost time: 0.3419969081878662
Epoch: 46, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.372 Vali Acc: 0.948 Test Loss: 0.372 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 47 cost time: 0.3543558120727539
Epoch: 47, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.365 Vali Acc: 0.948 Test Loss: 0.365 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 48 cost time: 0.3981153964996338
Epoch: 48, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.359 Vali Acc: 0.944 Test Loss: 0.359 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.3496510982513428
Epoch: 49, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.353 Vali Acc: 0.944 Test Loss: 0.353 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.3627192974090576
Epoch: 50, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 23014
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.519721269607544
Epoch: 1, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.731 Vali Acc: 0.293 Test Loss: 1.731 Test Acc: 0.293
Validation loss decreased (inf --> -0.292575).  Saving model ...
Epoch: 2 cost time: 0.36234164237976074
Epoch: 2, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.713 Vali Acc: 0.322 Test Loss: 1.713 Test Acc: 0.322
Validation loss decreased (-0.292575 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 0.3500704765319824
Epoch: 3, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.699 Vali Acc: 0.374 Test Loss: 1.699 Test Acc: 0.374
Validation loss decreased (-0.322205 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.3476533889770508
Epoch: 4, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.685 Vali Acc: 0.393 Test Loss: 1.685 Test Acc: 0.393
Validation loss decreased (-0.374057 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.3427872657775879
Epoch: 5, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.667 Vali Acc: 0.415 Test Loss: 1.667 Test Acc: 0.415
Validation loss decreased (-0.392576 --> -0.414798).  Saving model ...
Epoch: 6 cost time: 0.3430635929107666
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.646 Vali Acc: 0.456 Test Loss: 1.646 Test Acc: 0.456
Validation loss decreased (-0.414798 --> -0.455539).  Saving model ...
Epoch: 7 cost time: 0.3482396602630615
Epoch: 7, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.621 Vali Acc: 0.478 Test Loss: 1.621 Test Acc: 0.478
Validation loss decreased (-0.455539 --> -0.477762).  Saving model ...
Epoch: 8 cost time: 0.38605570793151855
Epoch: 8, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.593 Vali Acc: 0.515 Test Loss: 1.593 Test Acc: 0.515
Validation loss decreased (-0.477762 --> -0.514799).  Saving model ...
Epoch: 9 cost time: 0.36238646507263184
Epoch: 9, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.563 Vali Acc: 0.537 Test Loss: 1.563 Test Acc: 0.537
Validation loss decreased (-0.514799 --> -0.537021).  Saving model ...
Epoch: 10 cost time: 0.424149751663208
Epoch: 10, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.529 Vali Acc: 0.563 Test Loss: 1.529 Test Acc: 0.563
Validation loss decreased (-0.537021 --> -0.562948).  Saving model ...
Epoch: 11 cost time: 0.3638617992401123
Epoch: 11, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.493 Vali Acc: 0.585 Test Loss: 1.493 Test Acc: 0.585
Validation loss decreased (-0.562948 --> -0.585170).  Saving model ...
Epoch: 12 cost time: 0.3828568458557129
Epoch: 12, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.456 Vali Acc: 0.600 Test Loss: 1.456 Test Acc: 0.600
Validation loss decreased (-0.585170 --> -0.599985).  Saving model ...
Epoch: 13 cost time: 0.34276795387268066
Epoch: 13, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.417 Vali Acc: 0.630 Test Loss: 1.417 Test Acc: 0.630
Validation loss decreased (-0.599985 --> -0.629615).  Saving model ...
Epoch: 14 cost time: 0.38895273208618164
Epoch: 14, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.376 Vali Acc: 0.659 Test Loss: 1.376 Test Acc: 0.659
Validation loss decreased (-0.629615 --> -0.659245).  Saving model ...
Epoch: 15 cost time: 0.34128355979919434
Epoch: 15, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.335 Vali Acc: 0.685 Test Loss: 1.335 Test Acc: 0.685
Validation loss decreased (-0.659245 --> -0.685172).  Saving model ...
Epoch: 16 cost time: 0.36066102981567383
Epoch: 16, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.292 Vali Acc: 0.707 Test Loss: 1.292 Test Acc: 0.707
Validation loss decreased (-0.685172 --> -0.707394).  Saving model ...
Epoch: 17 cost time: 0.3801267147064209
Epoch: 17, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.249 Vali Acc: 0.730 Test Loss: 1.249 Test Acc: 0.730
Validation loss decreased (-0.707394 --> -0.729617).  Saving model ...
Epoch: 18 cost time: 0.34038686752319336
Epoch: 18, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.207 Vali Acc: 0.752 Test Loss: 1.207 Test Acc: 0.752
Validation loss decreased (-0.729617 --> -0.751840).  Saving model ...
Epoch: 19 cost time: 0.3342409133911133
Epoch: 19, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.164 Vali Acc: 0.789 Test Loss: 1.164 Test Acc: 0.789
Validation loss decreased (-0.751840 --> -0.788877).  Saving model ...
Epoch: 20 cost time: 0.3471970558166504
Epoch: 20, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.122 Vali Acc: 0.822 Test Loss: 1.122 Test Acc: 0.822
Validation loss decreased (-0.788877 --> -0.822211).  Saving model ...
Epoch: 21 cost time: 0.3528463840484619
Epoch: 21, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.080 Vali Acc: 0.837 Test Loss: 1.080 Test Acc: 0.837
Validation loss decreased (-0.822211 --> -0.837026).  Saving model ...
Epoch: 22 cost time: 0.3532559871673584
Epoch: 22, Steps: 2 | Train Loss: 0.883 Vali Loss: 1.040 Vali Acc: 0.848 Test Loss: 1.040 Test Acc: 0.848
Validation loss decreased (-0.837026 --> -0.848138).  Saving model ...
Epoch: 23 cost time: 0.3405723571777344
Epoch: 23, Steps: 2 | Train Loss: 0.864 Vali Loss: 1.000 Vali Acc: 0.859 Test Loss: 1.000 Test Acc: 0.859
Validation loss decreased (-0.848138 --> -0.859249).  Saving model ...
Epoch: 24 cost time: 0.3555316925048828
Epoch: 24, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.961 Vali Acc: 0.874 Test Loss: 0.961 Test Acc: 0.874
Validation loss decreased (-0.859249 --> -0.874064).  Saving model ...
Epoch: 25 cost time: 0.3561863899230957
Epoch: 25, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.922 Vali Acc: 0.885 Test Loss: 0.922 Test Acc: 0.885
Validation loss decreased (-0.874064 --> -0.885176).  Saving model ...
Epoch: 26 cost time: 0.3543415069580078
Epoch: 26, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.885 Vali Acc: 0.893 Test Loss: 0.885 Test Acc: 0.893
Validation loss decreased (-0.885176 --> -0.892584).  Saving model ...
Epoch: 27 cost time: 0.36669111251831055
Epoch: 27, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.849 Vali Acc: 0.900 Test Loss: 0.849 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 28 cost time: 0.34822750091552734
Epoch: 28, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.814 Vali Acc: 0.900 Test Loss: 0.814 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 29 cost time: 0.34942150115966797
Epoch: 29, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.781 Vali Acc: 0.907 Test Loss: 0.781 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 30 cost time: 0.346264123916626
Epoch: 30, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.750 Vali Acc: 0.915 Test Loss: 0.750 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914807).  Saving model ...
Epoch: 31 cost time: 0.3669016361236572
Epoch: 31, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.720 Vali Acc: 0.915 Test Loss: 0.720 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 32 cost time: 0.36159396171569824
Epoch: 32, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.692 Vali Acc: 0.915 Test Loss: 0.692 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 33 cost time: 0.35695624351501465
Epoch: 33, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.667 Vali Acc: 0.919 Test Loss: 0.667 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 34 cost time: 0.3555605411529541
Epoch: 34, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.643 Vali Acc: 0.919 Test Loss: 0.643 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 35 cost time: 0.360382080078125
Epoch: 35, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.620 Vali Acc: 0.919 Test Loss: 0.620 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 36 cost time: 0.35112786293029785
Epoch: 36, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.600 Vali Acc: 0.922 Test Loss: 0.600 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 37 cost time: 0.3885471820831299
Epoch: 37, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.581 Vali Acc: 0.926 Test Loss: 0.581 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 38 cost time: 0.32087230682373047
Epoch: 38, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.563 Vali Acc: 0.926 Test Loss: 0.563 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 39 cost time: 0.3741164207458496
Epoch: 39, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.546 Vali Acc: 0.930 Test Loss: 0.546 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 40 cost time: 0.3507051467895508
Epoch: 40, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.531 Vali Acc: 0.930 Test Loss: 0.531 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 41 cost time: 0.3506331443786621
Epoch: 41, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.517 Vali Acc: 0.937 Test Loss: 0.517 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 42 cost time: 0.40815234184265137
Epoch: 42, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.504 Vali Acc: 0.941 Test Loss: 0.504 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 43 cost time: 0.3418540954589844
Epoch: 43, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.491 Vali Acc: 0.941 Test Loss: 0.491 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 44 cost time: 0.33577823638916016
Epoch: 44, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.479 Vali Acc: 0.944 Test Loss: 0.479 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 45 cost time: 0.3638274669647217
Epoch: 45, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.467 Vali Acc: 0.944 Test Loss: 0.467 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 46 cost time: 0.3297727108001709
Epoch: 46, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.457 Vali Acc: 0.948 Test Loss: 0.457 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 47 cost time: 0.36174678802490234
Epoch: 47, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.447 Vali Acc: 0.948 Test Loss: 0.447 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 48 cost time: 0.35041356086730957
Epoch: 48, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.438 Vali Acc: 0.948 Test Loss: 0.438 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 49 cost time: 0.3420841693878174
Epoch: 49, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.429 Vali Acc: 0.948 Test Loss: 0.429 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 50 cost time: 0.38387370109558105
Epoch: 50, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.421 Vali Acc: 0.948 Test Loss: 0.421 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps13_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 20038
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5338199138641357
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.834 Vali Acc: 0.100 Test Loss: 1.834 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 0.38216662406921387
Epoch: 2, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.824 Vali Acc: 0.104 Test Loss: 1.824 Test Acc: 0.104
Validation loss decreased (-0.099982 --> -0.103685).  Saving model ...
Epoch: 3 cost time: 0.36958789825439453
Epoch: 3, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.818 Vali Acc: 0.104 Test Loss: 1.818 Test Acc: 0.104
Validation loss decreased (-0.103685 --> -0.103686).  Saving model ...
Epoch: 4 cost time: 0.5102767944335938
Epoch: 4, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.813 Vali Acc: 0.100 Test Loss: 1.813 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3883934020996094
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.804 Vali Acc: 0.104 Test Loss: 1.804 Test Acc: 0.104
Validation loss decreased (-0.103686 --> -0.103686).  Saving model ...
Epoch: 6 cost time: 0.360914945602417
Epoch: 6, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.793 Vali Acc: 0.130 Test Loss: 1.793 Test Acc: 0.130
Validation loss decreased (-0.103686 --> -0.129612).  Saving model ...
Epoch: 7 cost time: 0.37471795082092285
Epoch: 7, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.779 Vali Acc: 0.152 Test Loss: 1.779 Test Acc: 0.152
Validation loss decreased (-0.129612 --> -0.151834).  Saving model ...
Epoch: 8 cost time: 0.48708033561706543
Epoch: 8, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.762 Vali Acc: 0.167 Test Loss: 1.762 Test Acc: 0.167
Validation loss decreased (-0.151834 --> -0.166649).  Saving model ...
Epoch: 9 cost time: 0.36929941177368164
Epoch: 9, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.742 Vali Acc: 0.196 Test Loss: 1.742 Test Acc: 0.196
Validation loss decreased (-0.166649 --> -0.196279).  Saving model ...
Epoch: 10 cost time: 0.3481941223144531
Epoch: 10, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.719 Vali Acc: 0.233 Test Loss: 1.719 Test Acc: 0.233
Validation loss decreased (-0.196279 --> -0.233316).  Saving model ...
Epoch: 11 cost time: 0.35696911811828613
Epoch: 11, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.693 Vali Acc: 0.267 Test Loss: 1.693 Test Acc: 0.267
Validation loss decreased (-0.233316 --> -0.266650).  Saving model ...
Epoch: 12 cost time: 0.3501756191253662
Epoch: 12, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.666 Vali Acc: 0.315 Test Loss: 1.666 Test Acc: 0.315
Validation loss decreased (-0.266650 --> -0.314798).  Saving model ...
Epoch: 13 cost time: 0.35512304306030273
Epoch: 13, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.635 Vali Acc: 0.344 Test Loss: 1.635 Test Acc: 0.344
Validation loss decreased (-0.314798 --> -0.344428).  Saving model ...
Epoch: 14 cost time: 0.33227968215942383
Epoch: 14, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.603 Vali Acc: 0.374 Test Loss: 1.603 Test Acc: 0.374
Validation loss decreased (-0.344428 --> -0.374058).  Saving model ...
Epoch: 15 cost time: 0.3378314971923828
Epoch: 15, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.570 Vali Acc: 0.389 Test Loss: 1.570 Test Acc: 0.389
Validation loss decreased (-0.374058 --> -0.388873).  Saving model ...
Epoch: 16 cost time: 0.3649251461029053
Epoch: 16, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.534 Vali Acc: 0.426 Test Loss: 1.534 Test Acc: 0.426
Validation loss decreased (-0.388873 --> -0.425911).  Saving model ...
Epoch: 17 cost time: 0.3948671817779541
Epoch: 17, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.498 Vali Acc: 0.456 Test Loss: 1.498 Test Acc: 0.456
Validation loss decreased (-0.425911 --> -0.455541).  Saving model ...
Epoch: 18 cost time: 0.44814372062683105
Epoch: 18, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.461 Vali Acc: 0.481 Test Loss: 1.461 Test Acc: 0.481
Validation loss decreased (-0.455541 --> -0.481467).  Saving model ...
Epoch: 19 cost time: 0.36661744117736816
Epoch: 19, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.423 Vali Acc: 0.530 Test Loss: 1.423 Test Acc: 0.530
Validation loss decreased (-0.481467 --> -0.529615).  Saving model ...
Epoch: 20 cost time: 0.3592984676361084
Epoch: 20, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.384 Vali Acc: 0.563 Test Loss: 1.384 Test Acc: 0.563
Validation loss decreased (-0.529615 --> -0.562949).  Saving model ...
Epoch: 21 cost time: 0.3553140163421631
Epoch: 21, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.346 Vali Acc: 0.600 Test Loss: 1.346 Test Acc: 0.600
Validation loss decreased (-0.562949 --> -0.599987).  Saving model ...
Epoch: 22 cost time: 0.3635427951812744
Epoch: 22, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.308 Vali Acc: 0.626 Test Loss: 1.308 Test Acc: 0.626
Validation loss decreased (-0.599987 --> -0.625913).  Saving model ...
Epoch: 23 cost time: 0.3656778335571289
Epoch: 23, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.270 Vali Acc: 0.648 Test Loss: 1.270 Test Acc: 0.648
Validation loss decreased (-0.625913 --> -0.648135).  Saving model ...
Epoch: 24 cost time: 0.3574557304382324
Epoch: 24, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.232 Vali Acc: 0.693 Test Loss: 1.232 Test Acc: 0.693
Validation loss decreased (-0.648135 --> -0.692580).  Saving model ...
Epoch: 25 cost time: 0.35398340225219727
Epoch: 25, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.194 Vali Acc: 0.715 Test Loss: 1.194 Test Acc: 0.715
Validation loss decreased (-0.692580 --> -0.714803).  Saving model ...
Epoch: 26 cost time: 0.3762080669403076
Epoch: 26, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.156 Vali Acc: 0.741 Test Loss: 1.156 Test Acc: 0.741
Validation loss decreased (-0.714803 --> -0.740729).  Saving model ...
Epoch: 27 cost time: 0.4681997299194336
Epoch: 27, Steps: 2 | Train Loss: 0.967 Vali Loss: 1.119 Vali Acc: 0.767 Test Loss: 1.119 Test Acc: 0.767
Validation loss decreased (-0.740729 --> -0.766655).  Saving model ...
Epoch: 28 cost time: 0.38688039779663086
Epoch: 28, Steps: 2 | Train Loss: 0.876 Vali Loss: 1.081 Vali Acc: 0.800 Test Loss: 1.081 Test Acc: 0.800
Validation loss decreased (-0.766655 --> -0.799989).  Saving model ...
Epoch: 29 cost time: 0.3892800807952881
Epoch: 29, Steps: 2 | Train Loss: 0.822 Vali Loss: 1.045 Vali Acc: 0.819 Test Loss: 1.045 Test Acc: 0.819
Validation loss decreased (-0.799989 --> -0.818508).  Saving model ...
Epoch: 30 cost time: 0.35764265060424805
Epoch: 30, Steps: 2 | Train Loss: 0.829 Vali Loss: 1.009 Vali Acc: 0.837 Test Loss: 1.009 Test Acc: 0.837
Validation loss decreased (-0.818508 --> -0.837027).  Saving model ...
Epoch: 31 cost time: 0.3625214099884033
Epoch: 31, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.975 Vali Acc: 0.844 Test Loss: 0.975 Test Acc: 0.844
Validation loss decreased (-0.837027 --> -0.844435).  Saving model ...
Epoch: 32 cost time: 0.3959972858428955
Epoch: 32, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.941 Vali Acc: 0.859 Test Loss: 0.941 Test Acc: 0.859
Validation loss decreased (-0.844435 --> -0.859250).  Saving model ...
Epoch: 33 cost time: 0.3896164894104004
Epoch: 33, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.910 Vali Acc: 0.863 Test Loss: 0.910 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862954).  Saving model ...
Epoch: 34 cost time: 0.37503886222839355
Epoch: 34, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.879 Vali Acc: 0.874 Test Loss: 0.879 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874065).  Saving model ...
Epoch: 35 cost time: 0.3876807689666748
Epoch: 35, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.851 Vali Acc: 0.893 Test Loss: 0.851 Test Acc: 0.893
Validation loss decreased (-0.874065 --> -0.892584).  Saving model ...
Epoch: 36 cost time: 0.36137962341308594
Epoch: 36, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.823 Vali Acc: 0.893 Test Loss: 0.823 Test Acc: 0.893
Validation loss decreased (-0.892584 --> -0.892584).  Saving model ...
Epoch: 37 cost time: 0.3928706645965576
Epoch: 37, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.798 Vali Acc: 0.896 Test Loss: 0.798 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896288).  Saving model ...
Epoch: 38 cost time: 0.37778449058532715
Epoch: 38, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.773 Vali Acc: 0.900 Test Loss: 0.773 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899992).  Saving model ...
Epoch: 39 cost time: 0.35117387771606445
Epoch: 39, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.750 Vali Acc: 0.904 Test Loss: 0.750 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 40 cost time: 0.43891263008117676
Epoch: 40, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.728 Vali Acc: 0.911 Test Loss: 0.728 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 41 cost time: 0.358351469039917
Epoch: 41, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.708 Vali Acc: 0.911 Test Loss: 0.708 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 42 cost time: 0.36823415756225586
Epoch: 42, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.689 Vali Acc: 0.915 Test Loss: 0.689 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 43 cost time: 0.4071319103240967
Epoch: 43, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.670 Vali Acc: 0.915 Test Loss: 0.670 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 44 cost time: 0.3568434715270996
Epoch: 44, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.653 Vali Acc: 0.915 Test Loss: 0.653 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 45 cost time: 0.3667113780975342
Epoch: 45, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.637 Vali Acc: 0.915 Test Loss: 0.637 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 46 cost time: 0.35809898376464844
Epoch: 46, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.621 Vali Acc: 0.915 Test Loss: 0.621 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 47 cost time: 0.41477131843566895
Epoch: 47, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.607 Vali Acc: 0.919 Test Loss: 0.607 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918512).  Saving model ...
Epoch: 48 cost time: 0.37120985984802246
Epoch: 48, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.592 Vali Acc: 0.919 Test Loss: 0.592 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 49 cost time: 0.356215238571167
Epoch: 49, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.579 Vali Acc: 0.919 Test Loss: 0.579 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 50 cost time: 0.37860989570617676
Epoch: 50, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.567 Vali Acc: 0.926 Test Loss: 0.567 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925920).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ModernTCN_UEA_ftM_sl65_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps17_str9_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 18630
model size : 0.09MB
